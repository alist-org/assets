var Vh=Object.defineProperty,Hh=Object.defineProperties;var Kh=Object.getOwnPropertyDescriptors;var fu=Object.getOwnPropertySymbols;var Gh=Object.prototype.hasOwnProperty,Yh=Object.prototype.propertyIsEnumerable;var du=(s,e,r)=>e in s?Vh(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,mt=(s,e)=>{for(var r in e||(e={}))Gh.call(e,r)&&du(s,r,e[r]);if(fu)for(var r of fu(e))Yh.call(e,r)&&du(s,r,e[r]);return s},bt=(s,e)=>Hh(s,Kh(e));var er=(s,e,r)=>new Promise((i,t)=>{var n=f=>{try{o(r.next(f))}catch(h){t(h)}},a=f=>{try{o(r.throw(f))}catch(h){t(h)}},o=f=>f.done?i(f.value):Promise.resolve(f.value).then(n,a);o((r=r.apply(s,e)).next())});import{ae as Mt,r as Ye,ad as Mn,an as Eo,ao as cu,R as q,J as se,l as Xh,j as kn,am as hu,n as Xi,C as Zi,H as Ra,s as Nn,ap as Er,t as Zh,v as Qh,V as _o,p as pu,G as _r,y as xo,u as Jh,aq as qh,a8 as ep,ar as tp,af as Ca,o as rp,a4 as ip,a5 as np,E as ap,a6 as sp,a7 as op,L as lp,as as up,aj as Qi}from"./vendor.dd75dc04.js";import{a as fp}from"./clsx.m.c6439cc2.js";import{I as $r,R as dp,i as cp,S as hp}from"./index.esm.ab722768.js";import{e as ui,q as Pa,u as pp,_ as vp,s as mp}from"./index.ac1da2e5.js";import{u as gp}from"./useTitle.2fc49172.js";import"./index.98f0b294.js";import"./copy-clip.08e8f9de.js";var Ji={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function r(){for(var i=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!!n){var a=typeof n;if(a==="string"||a==="number")i.push(n);else if(Array.isArray(n)){if(n.length){var o=r.apply(null,n);o&&i.push(o)}}else if(a==="object")if(n.toString===Object.prototype.toString)for(var f in n)e.call(n,f)&&n[f]&&i.push(f);else i.push(n.toString())}}return i.join(" ")}s.exports?(r.default=r,s.exports=r):window.classNames=r})()})(Ji);var Bt=Ji.exports,vu={exports:{}};(function(s,e){(function(r,i){s.exports=i()})(Mt,function(){return function r(i,t,n){var a=window,o="application/octet-stream",f=n||o,h=i,p=!t&&!n&&h,l=document.createElement("a"),u=function(S){return String(S)},m=a.Blob||a.MozBlob||a.WebKitBlob||u,y=t||"download",b,_;if(m=m.call?m.bind(a):Blob,String(this)==="true"&&(h=[h,f],f=h[0],h=h[1]),p&&p.length<2048&&(y=p.split("/").pop().split("?")[0],l.href=p,l.href.indexOf(p)!==-1)){var g=new XMLHttpRequest;return g.open("GET",p,!0),g.responseType="blob",g.onload=function(S){r(S.target.response,y,o)},setTimeout(function(){g.send()},0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(h))if(h.length>1024*1024*1.999&&m!==u)h=d(h),f=h.type||o;else return navigator.msSaveBlob?navigator.msSaveBlob(d(h),y):x(h);else if(/([\x80-\xff])/.test(h)){var c=0,v=new Uint8Array(h.length),E=v.length;for(c;c<E;++c)v[c]=h.charCodeAt(c);h=new m([v],{type:f})}b=h instanceof m?h:new m([h],{type:f});function d(S){var T=S.split(/[:;,]/),w=T[1],L=T[2]=="base64"?atob:decodeURIComponent,I=L(T.pop()),A=I.length,O=0,D=new Uint8Array(A);for(O;O<A;++O)D[O]=I.charCodeAt(O);return new m([D],{type:w})}function x(S,T){if("download"in l)return l.href=S,l.setAttribute("download",y),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",document.body.appendChild(l),setTimeout(function(){l.click(),document.body.removeChild(l),T===!0&&setTimeout(function(){a.URL.revokeObjectURL(l.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(S)&&(S="data:"+S.replace(/^data:([\w\/\-\+]+)/,o)),window.open(S)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=S),!0;var w=document.createElement("iframe");document.body.appendChild(w),!T&&/^data:/.test(S)&&(S="data:"+S.replace(/^data:([\w\/\-\+]+)/,o)),w.src=S,setTimeout(function(){document.body.removeChild(w)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(b,y);if(a.URL)x(a.URL.createObjectURL(b),!0);else{if(typeof b=="string"||b.constructor===u)try{return x("data:"+f+";base64,"+a.btoa(b))}catch(S){return x("data:"+f+","+encodeURIComponent(b))}_=new FileReader,_.onload=function(S){x(this.result)},_.readAsDataURL(b)}return!0}})})(vu);var mu=vu.exports,Ma={exports:{}};Ma.exports=bo;Ma.exports.isMobile=bo;Ma.exports.default=bo;var yp=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,Ep=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function bo(s){s||(s={});var e=s.ua;if(!e&&typeof navigator!="undefined"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var r=s.tablet?Ep.test(e):yp.test(e);return!r&&s.tablet&&s.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(r=!0),r}var _p=Ma.exports,So={},To={exports:{}},ka={exports:{}};(function(s){function e(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?(s.exports=e=function(t){return typeof t},s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=e=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s.exports.default=s.exports,s.exports.__esModule=!0),e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(ka);(function(s){var e=ka.exports.default;function r(t){if(typeof WeakMap!="function")return null;var n=new WeakMap,a=new WeakMap;return(r=function(f){return f?a:n})(t)}function i(t,n){if(!n&&t&&t.__esModule)return t;if(t===null||e(t)!=="object"&&typeof t!="function")return{default:t};var a=r(n);if(a&&a.has(t))return a.get(t);var o={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if(h!=="default"&&Object.prototype.hasOwnProperty.call(t,h)){var p=f?Object.getOwnPropertyDescriptor(t,h):null;p&&(p.get||p.set)?Object.defineProperty(o,h,p):o[h]=t[h]}return o.default=t,a&&a.set(t,o),o}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(To);var fi={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(fi);var Ti={exports:{}},wi={exports:{}};(function(s){function e(r,i,t){return i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t,r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(wi);(function(s){var e=wi.exports;function r(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),a.push.apply(a,o)}return a}function i(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?r(Object(a),!0).forEach(function(o){e(t,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(a,o))})}return t}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Ti);var Na={exports:{}};(function(s){function e(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Na);var Fa={exports:{}};(function(s){function e(i,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function r(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Fa);var Ba={exports:{}},gu={exports:{}};(function(s){function e(r,i){return s.exports=e=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},s.exports.default=s.exports,s.exports.__esModule=!0,e(r,i)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(gu);(function(s){var e=gu.exports;function r(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&e(i,t)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ba);var Ua={exports:{}},ja={exports:{}};(function(s){function e(r){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s.exports.default=s.exports,s.exports.__esModule=!0,e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(ja);var yu={exports:{}};(function(s){function e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(yu);var Eu={exports:{}},_u={exports:{}};(function(s){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(_u);(function(s){var e=ka.exports.default,r=_u.exports;function i(t,n){if(n&&(e(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Eu);(function(s){var e=ja.exports,r=yu.exports,i=Eu.exports;function t(n){var a=r();return function(){var f=e(n),h;if(a){var p=e(this).constructor;h=Reflect.construct(f,arguments,p)}else h=f.apply(this,arguments);return i(this,h)}}s.exports=t,s.exports.default=s.exports,s.exports.__esModule=!0})(Ua);var xr={};Object.defineProperty(xr,"__esModule",{value:!0});xr.warning=xu;xr.note=bu;xr.resetWarned=xp;xr.call=Ao;xr.warningOnce=Su;xr.noteOnce=bp;xr.default=void 0;var wo={};function xu(s,e){}function bu(s,e){}function xp(){wo={}}function Ao(s,e,r){!e&&!wo[r]&&(s(!1,r),wo[r]=!0)}function Su(s,e){Ao(xu,s,e)}function bp(s,e){Ao(bu,s,e)}var Sp=Su;xr.default=Sp;var Wa={},Oo=fi.exports;Object.defineProperty(Wa,"__esModule",{value:!0});Wa.default=void 0;var Tu=Oo(Ti.exports),qi=Oo(wi.exports),Tp=Oo(Ye.exports),wp=function(e){var r,i,t=e.className,n=e.included,a=e.vertical,o=e.style,f=e.length,h=e.offset,p=e.reverse;f<0&&(p=!p,f=Math.abs(f),h=100-h);var l=a?(r={},(0,qi.default)(r,p?"top":"bottom","".concat(h,"%")),(0,qi.default)(r,p?"bottom":"top","auto"),(0,qi.default)(r,"height","".concat(f,"%")),r):(i={},(0,qi.default)(i,p?"right":"left","".concat(h,"%")),(0,qi.default)(i,p?"left":"right","auto"),(0,qi.default)(i,"width","".concat(f,"%")),i),u=(0,Tu.default)((0,Tu.default)({},o),l);return n?Tp.default.createElement("div",{className:t,style:u}):null},Ap=wp;Wa.default=Ap;var Lo={},Do={exports:{}};(function(s){function e(){return s.exports=e=Object.assign||function(r){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},s.exports.default=s.exports,s.exports.__esModule=!0,e.apply(this,arguments)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Do);var Io={exports:{}},wu={exports:{}};(function(s){function e(r,i){if(r==null)return{};var t={},n=Object.keys(r),a,o;for(o=0;o<n.length;o++)a=n[o],!(i.indexOf(a)>=0)&&(t[a]=r[a]);return t}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(wu);(function(s){var e=wu.exports;function r(i,t){if(i==null)return{};var n=e(i,t),a,o;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(i);for(o=0;o<f.length;o++)a=f[o],!(t.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(n[a]=i[a]))}return n}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Io);var Ro={exports:{}},Au={exports:{}},Co={exports:{}};(function(s){function e(r,i){(i==null||i>r.length)&&(i=r.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=r[t];return n}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Co);(function(s){var e=Co.exports;function r(i){if(Array.isArray(i))return e(i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Au);var Ou={exports:{}};(function(s){function e(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ou);var Lu={exports:{}};(function(s){var e=Co.exports;function r(i,t){if(!!i){if(typeof i=="string")return e(i,t);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(i,t)}}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Lu);var Du={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Du);(function(s){var e=Au.exports,r=Ou.exports,i=Lu.exports,t=Du.exports;function n(a){return e(a)||r(a)||i(a)||t()}s.exports=n,s.exports.default=s.exports,s.exports.__esModule=!0})(Ro);var Iu={exports:{}},Ru={exports:{}};(function(s){var e=ja.exports;function r(i,t){for(;!Object.prototype.hasOwnProperty.call(i,t)&&(i=e(i),i!==null););return i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ru);(function(s){var e=Ru.exports;function r(i,t,n){return typeof Reflect!="undefined"&&Reflect.get?(s.exports=r=Reflect.get,s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=r=function(o,f,h){var p=e(o,f);if(!!p){var l=Object.getOwnPropertyDescriptor(p,f);return l.get?l.get.call(h):l.value}},s.exports.default=s.exports,s.exports.__esModule=!0),r(i,t,n||i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Iu);var za={},Cu={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Cu);var Op=Cu.exports;Object.defineProperty(za,"__esModule",{value:!0});za.default=Lp;var Pu=Op(Mn.exports);function Lp(s,e,r,i){var t=Pu.default.unstable_batchedUpdates?function(a){Pu.default.unstable_batchedUpdates(r,a)}:r;return s.addEventListener&&s.addEventListener(e,t,i),{remove:function(){s.removeEventListener&&s.removeEventListener(e,t)}}}var $a={},Fn=fi.exports;Object.defineProperty($a,"__esModule",{value:!0});$a.default=void 0;var Bn=Fn(wi.exports),en=Fn(Ti.exports),Mu=Fn(Ye.exports),Dp=Fn(Ji.exports),Ip=Fn(xr),Rp=function(e,r,i,t,n,a){(0,Ip.default)(i?t>0:!0,"`Slider[step]` should be a positive number in order to make Slider[dots] work.");var o=Object.keys(r).map(parseFloat).sort(function(h,p){return h-p});if(i&&t)for(var f=n;f<=a;f+=t)o.indexOf(f)===-1&&o.push(f);return o},Cp=function(e){var r=e.prefixCls,i=e.vertical,t=e.reverse,n=e.marks,a=e.dots,o=e.step,f=e.included,h=e.lowerBound,p=e.upperBound,l=e.max,u=e.min,m=e.dotStyle,y=e.activeDotStyle,b=l-u,_=Rp(i,n,a,o,u,l).map(function(g){var c,v="".concat(Math.abs(g-u)/b*100,"%"),E=!f&&g===p||f&&g<=p&&g>=h,d=i?(0,en.default)((0,en.default)({},m),{},(0,Bn.default)({},t?"top":"bottom",v)):(0,en.default)((0,en.default)({},m),{},(0,Bn.default)({},t?"right":"left",v));E&&(d=(0,en.default)((0,en.default)({},d),y));var x=(0,Dp.default)((c={},(0,Bn.default)(c,"".concat(r,"-dot"),!0),(0,Bn.default)(c,"".concat(r,"-dot-active"),E),(0,Bn.default)(c,"".concat(r,"-dot-reverse"),t),c));return Mu.default.createElement("span",{className:x,style:d,key:g})});return Mu.default.createElement("div",{className:"".concat(r,"-step")},_)},Pp=Cp;$a.default=Pp;var Va={},Un=fi.exports;Object.defineProperty(Va,"__esModule",{value:!0});Va.default=void 0;var ku=Un(Ti.exports),Ha=Un(wi.exports),Mp=Un(ka.exports),Po=Un(Ye.exports),kp=Un(Ji.exports),Np=function(e){var r=e.className,i=e.vertical,t=e.reverse,n=e.marks,a=e.included,o=e.upperBound,f=e.lowerBound,h=e.max,p=e.min,l=e.onClickLabel,u=Object.keys(n),m=h-p,y=u.map(parseFloat).sort(function(b,_){return b-_}).map(function(b){var _,g=n[b],c=(0,Mp.default)(g)==="object"&&!Po.default.isValidElement(g),v=c?g.label:g;if(!v&&v!==0)return null;var E=!a&&b===o||a&&b<=o&&b>=f,d=(0,kp.default)((_={},(0,Ha.default)(_,"".concat(r,"-text"),!0),(0,Ha.default)(_,"".concat(r,"-text-active"),E),_)),x=(0,Ha.default)({marginBottom:"-50%"},t?"top":"bottom","".concat((b-p)/m*100,"%")),S=(0,Ha.default)({transform:"translateX(".concat(t?"50%":"-50%",")"),msTransform:"translateX(".concat(t?"50%":"-50%",")")},t?"right":"left","".concat((b-p)/m*100,"%")),T=i?x:S,w=c?(0,ku.default)((0,ku.default)({},T),g.style):T;return Po.default.createElement("span",{className:d,style:w,key:b,onMouseDown:function(I){return l(I,b)},onTouchStart:function(I){return l(I,b)}},v)});return Po.default.createElement("div",{className:r},y)},Fp=Np;Va.default=Fp;var Ka={},Pr=fi.exports;Object.defineProperty(Ka,"__esModule",{value:!0});Ka.default=void 0;var Bp=Pr(Do.exports),Nu=Pr(Ti.exports),Ai=Pr(wi.exports),Up=Pr(Io.exports),jp=Pr(Na.exports),Wp=Pr(Fa.exports),zp=Pr(Ba.exports),$p=Pr(Ua.exports),Fu=Pr(Ye.exports),Vp=Pr(Ji.exports),Hp=Pr(za),Kp=["prefixCls","vertical","reverse","offset","style","disabled","min","max","value","tabIndex","ariaLabel","ariaLabelledBy","ariaValueTextFormatter"],Gp=function(s){(0,zp.default)(r,s);var e=(0,$p.default)(r);function r(){var i;(0,jp.default)(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),i.state={clickFocused:!1},i.onMouseUpListener=void 0,i.handle=void 0,i.setHandleRef=function(o){i.handle=o},i.handleMouseUp=function(){document.activeElement===i.handle&&i.setClickFocus(!0)},i.handleMouseDown=function(o){o.preventDefault(),i.focus()},i.handleBlur=function(){i.setClickFocus(!1)},i.handleKeyDown=function(){i.setClickFocus(!1)},i}return(0,Wp.default)(r,[{key:"componentDidMount",value:function(){this.onMouseUpListener=(0,Hp.default)(document,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"setClickFocus",value:function(t){this.setState({clickFocused:t})}},{key:"clickFocus",value:function(){this.setClickFocus(!0),this.focus()}},{key:"focus",value:function(){this.handle.focus()}},{key:"blur",value:function(){this.handle.blur()}},{key:"render",value:function(){var t,n,a=this.props,o=a.prefixCls,f=a.vertical,h=a.reverse,p=a.offset,l=a.style,u=a.disabled,m=a.min,y=a.max,b=a.value,_=a.tabIndex,g=a.ariaLabel,c=a.ariaLabelledBy,v=a.ariaValueTextFormatter,E=(0,Up.default)(a,Kp),d=(0,Vp.default)(this.props.className,(0,Ai.default)({},"".concat(o,"-handle-click-focused"),this.state.clickFocused)),x=f?(t={},(0,Ai.default)(t,h?"top":"bottom","".concat(p,"%")),(0,Ai.default)(t,h?"bottom":"top","auto"),(0,Ai.default)(t,"transform",h?null:"translateY(+50%)"),t):(n={},(0,Ai.default)(n,h?"right":"left","".concat(p,"%")),(0,Ai.default)(n,h?"left":"right","auto"),(0,Ai.default)(n,"transform","translateX(".concat(h?"+":"-","50%)")),n),S=(0,Nu.default)((0,Nu.default)({},l),x),T=_||0;(u||_===null)&&(T=null);var w;return v&&(w=v(b)),Fu.default.createElement("div",(0,Bp.default)({ref:this.setHandleRef,tabIndex:T},E,{className:d,style:S,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,role:"slider","aria-valuemin":m,"aria-valuemax":y,"aria-valuenow":b,"aria-disabled":!!u,"aria-label":g,"aria-labelledby":c,"aria-valuetext":w}))}}]),r}(Fu.default.Component);Ka.default=Gp;var zt={},Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.default=void 0;var Qe={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Qe.F1&&r<=Qe.F12)return!1;switch(r){case Qe.ALT:case Qe.CAPS_LOCK:case Qe.CONTEXT_MENU:case Qe.CTRL:case Qe.DOWN:case Qe.END:case Qe.ESC:case Qe.HOME:case Qe.INSERT:case Qe.LEFT:case Qe.MAC_FF_META:case Qe.META:case Qe.NUMLOCK:case Qe.NUM_CENTER:case Qe.PAGE_DOWN:case Qe.PAGE_UP:case Qe.PAUSE:case Qe.PRINT_SCREEN:case Qe.RIGHT:case Qe.SHIFT:case Qe.UP:case Qe.WIN_KEY:case Qe.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Qe.ZERO&&e<=Qe.NINE||e>=Qe.NUM_ZERO&&e<=Qe.NUM_MULTIPLY||e>=Qe.A&&e<=Qe.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Qe.SPACE:case Qe.QUESTION_MARK:case Qe.NUM_PLUS:case Qe.NUM_MINUS:case Qe.NUM_PERIOD:case Qe.NUM_DIVISION:case Qe.SEMICOLON:case Qe.DASH:case Qe.EQUALS:case Qe.COMMA:case Qe.PERIOD:case Qe.SLASH:case Qe.APOSTROPHE:case Qe.SINGLE_QUOTE:case Qe.OPEN_SQUARE_BRACKET:case Qe.BACKSLASH:case Qe.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Yp=Qe;Ga.default=Yp;var Bu=fi.exports;Object.defineProperty(zt,"__esModule",{value:!0});zt.calculateNextValue=Uu;zt.ensureValueInRange=iv;zt.ensureValuePrecision=nv;zt.getClosestPoint=Mo;zt.getHandleCenterPosition=rv;zt.getKeyboardValueMutator=sv;zt.getMousePosition=ev;zt.getPrecision=ko;zt.getTouchPosition=tv;zt.isEventFromHandle=Qp;zt.isNotTouchEvent=qp;zt.isValueOutOfRange=Jp;zt.pauseEvent=av;var Xp=Bu(Ro.exports),Zp=Mn.exports,di=Bu(Ga);function Qp(s,e){try{return Object.keys(e).some(function(r){return s.target===(0,Zp.findDOMNode)(e[r])})}catch(r){return!1}}function Jp(s,e){var r=e.min,i=e.max;return s<r||s>i}function qp(s){return s.touches.length>1||s.type.toLowerCase()==="touchend"&&s.touches.length>0}function Mo(s,e){var r=e.marks,i=e.step,t=e.min,n=e.max,a=Object.keys(r).map(parseFloat);if(i!==null){var o=Math.pow(10,ko(i)),f=Math.floor((n*o-t*o)/(i*o)),h=Math.min((s-t)/i,f),p=Math.round(h)*i+t;a.push(p)}var l=a.map(function(u){return Math.abs(s-u)});return a[l.indexOf(Math.min.apply(Math,(0,Xp.default)(l)))]}function ko(s){var e=s.toString(),r=0;return e.indexOf(".")>=0&&(r=e.length-e.indexOf(".")-1),r}function ev(s,e){return s?e.clientY:e.pageX}function tv(s,e){return s?e.touches[0].clientY:e.touches[0].pageX}function rv(s,e){var r=e.getBoundingClientRect();return s?r.top+r.height*.5:window.pageXOffset+r.left+r.width*.5}function iv(s,e){var r=e.max,i=e.min;return s<=i?i:s>=r?r:s}function nv(s,e){var r=e.step,i=isFinite(Mo(s,e))?Mo(s,e):0;return r===null?i:parseFloat(i.toFixed(ko(r)))}function av(s){s.stopPropagation(),s.preventDefault()}function Uu(s,e,r){var i={increase:function(o,f){return o+f},decrease:function(o,f){return o-f}},t=i[s](Object.keys(r.marks).indexOf(JSON.stringify(e)),1),n=Object.keys(r.marks)[t];return r.step?i[s](e,r.step):!!Object.keys(r.marks).length&&!!r.marks[n]?r.marks[n]:e}function sv(s,e,r){var i="increase",t="decrease",n=i;switch(s.keyCode){case di.default.UP:n=e&&r?t:i;break;case di.default.RIGHT:n=!e&&r?t:i;break;case di.default.DOWN:n=e&&r?i:t;break;case di.default.LEFT:n=!e&&r?i:t;break;case di.default.END:return function(a,o){return o.max};case di.default.HOME:return function(a,o){return o.min};case di.default.PAGE_UP:return function(a,o){return a+o.step*2};case di.default.PAGE_DOWN:return function(a,o){return a-o.step*2};default:return}return function(a,o){return Uu(n,a,o)}}var kt=fi.exports,ov=To.exports;Object.defineProperty(Lo,"__esModule",{value:!0});Lo.default=xv;var lv=kt(Do.exports),uv=kt(Io.exports),Ya=kt(Ti.exports),Xa=kt(wi.exports),fv=kt(Ro.exports),dv=kt(Na.exports),cv=kt(Fa.exports),No=kt(Iu.exports),Fo=kt(ja.exports),hv=kt(Ba.exports),pv=kt(Ua.exports),jn=kt(Ye.exports),Za=kt(za),vv=kt(Ji.exports),mv=kt(xr),gv=kt($a),yv=kt(Va),Ev=kt(Ka),sr=ov(zt),_v=["index"];function Vr(){}function xv(s){var e,r;return r=e=function(i){(0,hv.default)(n,i);var t=(0,pv.default)(n);function n(a){var o;(0,dv.default)(this,n),o=t.call(this,a),o.handlesRefs=void 0,o.sliderRef=void 0,o.document=void 0,o.dragOffset=void 0,o.prevMovedHandleIndex=void 0,o.onTouchMoveListener=void 0,o.onTouchUpListener=void 0,o.onMouseMoveListener=void 0,o.onMouseUpListener=void 0,o.dragTrack=void 0,o.startBounds=void 0,o.onDown=function(u,m){var y=m,b=o.props,_=b.draggableTrack,g=b.vertical,c=o.state.bounds,v=_&&o.positionGetValue?o.positionGetValue(y)||[]:[],E=sr.isEventFromHandle(u,o.handlesRefs);if(o.dragTrack=_&&c.length>=2&&!E&&!v.map(function(x,S){var T=S?!0:x>=c[S];return S===v.length-1?x<=c[S]:T}).some(function(x){return!x}),o.dragTrack)o.dragOffset=y,o.startBounds=(0,fv.default)(c);else{if(!E)o.dragOffset=0;else{var d=sr.getHandleCenterPosition(g,u.target);o.dragOffset=y-d,y=d}o.onStart(y)}},o.onMouseDown=function(u){if(u.button===0){o.removeDocumentEvents();var m=o.props.vertical,y=sr.getMousePosition(m,u);o.onDown(u,y),o.addDocumentMouseEvents()}},o.onTouchStart=function(u){if(!sr.isNotTouchEvent(u)){var m=o.props.vertical,y=sr.getTouchPosition(m,u);o.onDown(u,y),o.addDocumentTouchEvents(),sr.pauseEvent(u)}},o.onFocus=function(u){var m=o.props,y=m.onFocus,b=m.vertical;if(sr.isEventFromHandle(u,o.handlesRefs)&&!o.dragTrack){var _=sr.getHandleCenterPosition(b,u.target);o.dragOffset=0,o.onStart(_),sr.pauseEvent(u),y&&y(u)}},o.onBlur=function(u){var m=o.props.onBlur;o.dragTrack||o.onEnd(),m&&m(u)},o.onMouseUp=function(){o.handlesRefs[o.prevMovedHandleIndex]&&o.handlesRefs[o.prevMovedHandleIndex].clickFocus()},o.onMouseMove=function(u){if(!o.sliderRef){o.onEnd();return}var m=sr.getMousePosition(o.props.vertical,u);o.onMove(u,m-o.dragOffset,o.dragTrack,o.startBounds)},o.onTouchMove=function(u){if(sr.isNotTouchEvent(u)||!o.sliderRef){o.onEnd();return}var m=sr.getTouchPosition(o.props.vertical,u);o.onMove(u,m-o.dragOffset,o.dragTrack,o.startBounds)},o.onKeyDown=function(u){o.sliderRef&&sr.isEventFromHandle(u,o.handlesRefs)&&o.onKeyboard(u)},o.onClickMarkLabel=function(u,m){u.stopPropagation(),o.onChange({value:m}),o.setState({value:m},function(){return o.onEnd(!0)})},o.saveSlider=function(u){o.sliderRef=u};var f=a.step,h=a.max,p=a.min,l=isFinite(h-p)?(h-p)%f==0:!0;return(0,mv.default)(f&&Math.floor(f)===f?l:!0,"Slider[max] - Slider[min] (".concat(h-p,") should be a multiple of Slider[step] (").concat(f,")")),o.handlesRefs={},o}return(0,cv.default)(n,[{key:"componentDidMount",value:function(){this.document=this.sliderRef&&this.sliderRef.ownerDocument;var o=this.props,f=o.autoFocus,h=o.disabled;f&&!h&&this.focus()}},{key:"componentWillUnmount",value:function(){(0,No.default)((0,Fo.default)(n.prototype),"componentWillUnmount",this)&&(0,No.default)((0,Fo.default)(n.prototype),"componentWillUnmount",this).call(this),this.removeDocumentEvents()}},{key:"getSliderStart",value:function(){var o=this.sliderRef,f=this.props,h=f.vertical,p=f.reverse,l=o.getBoundingClientRect();return h?p?l.bottom:l.top:window.pageXOffset+(p?l.right:l.left)}},{key:"getSliderLength",value:function(){var o=this.sliderRef;if(!o)return 0;var f=o.getBoundingClientRect();return this.props.vertical?f.height:f.width}},{key:"addDocumentTouchEvents",value:function(){this.onTouchMoveListener=(0,Za.default)(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=(0,Za.default)(this.document,"touchend",this.onEnd)}},{key:"addDocumentMouseEvents",value:function(){this.onMouseMoveListener=(0,Za.default)(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=(0,Za.default)(this.document,"mouseup",this.onEnd)}},{key:"removeDocumentEvents",value:function(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"focus",value:function(){var o;this.props.disabled||(o=this.handlesRefs[0])===null||o===void 0||o.focus()}},{key:"blur",value:function(){var o=this;this.props.disabled||Object.keys(this.handlesRefs).forEach(function(f){var h,p;(h=o.handlesRefs[f])===null||h===void 0||(p=h.blur)===null||p===void 0||p.call(h)})}},{key:"calcValue",value:function(o){var f=this.props,h=f.vertical,p=f.min,l=f.max,u=Math.abs(Math.max(o,0)/this.getSliderLength()),m=h?(1-u)*(l-p)+p:u*(l-p)+p;return m}},{key:"calcValueByPos",value:function(o){var f=this.props.reverse?-1:1,h=f*(o-this.getSliderStart()),p=this.trimAlignValue(this.calcValue(h));return p}},{key:"calcOffset",value:function(o){var f=this.props,h=f.min,p=f.max,l=(o-h)/(p-h);return Math.max(0,l*100)}},{key:"saveHandle",value:function(o,f){this.handlesRefs[o]=f}},{key:"render",value:function(){var o,f=this.props,h=f.prefixCls,p=f.className,l=f.marks,u=f.dots,m=f.step,y=f.included,b=f.disabled,_=f.vertical,g=f.reverse,c=f.min,v=f.max,E=f.children,d=f.maximumTrackStyle,x=f.style,S=f.railStyle,T=f.dotStyle,w=f.activeDotStyle,L=(0,No.default)((0,Fo.default)(n.prototype),"render",this).call(this),I=L.tracks,A=L.handles,O=(0,vv.default)(h,(o={},(0,Xa.default)(o,"".concat(h,"-with-marks"),Object.keys(l).length),(0,Xa.default)(o,"".concat(h,"-disabled"),b),(0,Xa.default)(o,"".concat(h,"-vertical"),_),(0,Xa.default)(o,p,p),o));return jn.default.createElement("div",{ref:this.saveSlider,className:O,onTouchStart:b?Vr:this.onTouchStart,onMouseDown:b?Vr:this.onMouseDown,onMouseUp:b?Vr:this.onMouseUp,onKeyDown:b?Vr:this.onKeyDown,onFocus:b?Vr:this.onFocus,onBlur:b?Vr:this.onBlur,style:x},jn.default.createElement("div",{className:"".concat(h,"-rail"),style:(0,Ya.default)((0,Ya.default)({},d),S)}),I,jn.default.createElement(gv.default,{prefixCls:h,vertical:_,reverse:g,marks:l,dots:u,step:m,included:y,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:v,min:c,dotStyle:T,activeDotStyle:w}),A,jn.default.createElement(yv.default,{className:"".concat(h,"-mark"),onClickLabel:b?Vr:this.onClickMarkLabel,vertical:_,marks:l,included:y,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:v,min:c,reverse:g}),E)}}]),n}(s),e.displayName="ComponentEnhancer(".concat(s.displayName,")"),e.defaultProps=(0,Ya.default)((0,Ya.default)({},s.defaultProps),{},{prefixCls:"rc-slider",className:"",min:0,max:100,step:1,marks:{},handle:function(t){var n=t.index,a=(0,uv.default)(t,_v);return delete a.dragging,a.value===null?null:jn.default.createElement(Ev.default,(0,lv.default)({},a,{key:n}))},onBeforeChange:Vr,onChange:Vr,onAfterChange:Vr,included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),r}var bv=To.exports,ti=fi.exports;Object.defineProperty(So,"__esModule",{value:!0});var Bo=So.default=void 0,tn=ti(Ti.exports),Sv=ti(Na.exports),Tv=ti(Fa.exports),wv=ti(Ba.exports),Av=ti(Ua.exports),ju=ti(Ye.exports),Wu=ti(xr),Ov=ti(Wa),Lv=ti(Lo),rn=bv(zt),Dv=function(s){(0,wv.default)(r,s);var e=(0,Av.default)(r);function r(i){var t;(0,Sv.default)(this,r),t=e.call(this,i),t.positionGetValue=function(o){return[]},t.startValue=void 0,t.startPosition=void 0,t.prevMovedHandleIndex=void 0,t.onEnd=function(o){var f=t.state.dragging;t.removeDocumentEvents(),(f||o)&&t.props.onAfterChange(t.getValue()),t.setState({dragging:!1})};var n=i.defaultValue!==void 0?i.defaultValue:i.min,a=i.value!==void 0?i.value:n;return t.state={value:t.trimAlignValue(a),dragging:!1},(0,Wu.default)(!("minimumTrackStyle"in i),"minimumTrackStyle will be deprecated, please use trackStyle instead."),(0,Wu.default)(!("maximumTrackStyle"in i),"maximumTrackStyle will be deprecated, please use railStyle instead."),t}return(0,Tv.default)(r,[{key:"calcValueByPos",value:function(t){return 0}},{key:"calcOffset",value:function(t){return 0}},{key:"saveHandle",value:function(t,n){}},{key:"removeDocumentEvents",value:function(){}},{key:"componentDidUpdate",value:function(t,n){var a=this.props,o=a.min,f=a.max,h=a.value,p=a.onChange;if("min"in this.props||"max"in this.props){var l=h!==void 0?h:n.value,u=this.trimAlignValue(l,this.props);u!==n.value&&(this.setState({value:u}),!(o===t.min&&f===t.max)&&rn.isValueOutOfRange(l,this.props)&&p(u))}}},{key:"onChange",value:function(t){var n=this.props,a=!("value"in n),o=t.value>this.props.max?(0,tn.default)((0,tn.default)({},t),{},{value:this.props.max}):t;a&&this.setState(o);var f=o.value;n.onChange(f)}},{key:"onStart",value:function(t){this.setState({dragging:!0});var n=this.props,a=this.getValue();n.onBeforeChange(a);var o=this.calcValueByPos(t);this.startValue=o,this.startPosition=t,o!==a&&(this.prevMovedHandleIndex=0,this.onChange({value:o}))}},{key:"onMove",value:function(t,n){rn.pauseEvent(t);var a=this.state.value,o=this.calcValueByPos(n);o!==a&&this.onChange({value:o})}},{key:"onKeyboard",value:function(t){var n=this.props,a=n.reverse,o=n.vertical,f=rn.getKeyboardValueMutator(t,o,a);if(f){rn.pauseEvent(t);var h=this.state,p=h.value,l=f(p,this.props),u=this.trimAlignValue(l);if(u===p)return;this.onChange({value:u}),this.props.onAfterChange(u),this.onEnd()}}},{key:"getValue",value:function(){return this.state.value}},{key:"getLowerBound",value:function(){var t=this.props.startPoint||this.props.min;return this.state.value>t?t:this.state.value}},{key:"getUpperBound",value:function(){return this.state.value<this.props.startPoint?this.props.startPoint:this.state.value}},{key:"trimAlignValue",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t===null)return null;var a=(0,tn.default)((0,tn.default)({},this.props),n),o=rn.ensureValueInRange(t,a);return rn.ensureValuePrecision(o,a)}},{key:"render",value:function(){var t=this,n=this.props,a=n.prefixCls,o=n.vertical,f=n.included,h=n.disabled,p=n.minimumTrackStyle,l=n.trackStyle,u=n.handleStyle,m=n.tabIndex,y=n.ariaLabelForHandle,b=n.ariaLabelledByForHandle,_=n.ariaValueTextFormatterForHandle,g=n.min,c=n.max,v=n.startPoint,E=n.reverse,d=n.handle,x=this.state,S=x.value,T=x.dragging,w=this.calcOffset(S),L=d({className:"".concat(a,"-handle"),prefixCls:a,vertical:o,offset:w,value:S,dragging:T,disabled:h,min:g,max:c,reverse:E,index:0,tabIndex:m,ariaLabel:y,ariaLabelledBy:b,ariaValueTextFormatter:_,style:u[0]||u,ref:function(R){return t.saveHandle(0,R)}}),I=v!==void 0?this.calcOffset(v):0,A=l[0]||l,O=ju.default.createElement(Ov.default,{className:"".concat(a,"-track"),vertical:o,included:f,offset:I,reverse:E,length:w-I,style:(0,tn.default)((0,tn.default)({},p),A)});return{tracks:O,handles:L}}}]),r}(ju.default.Component),Iv=(0,Lv.default)(Dv);Bo=So.default=Iv;function zu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Rv(s){if(Array.isArray(s))return s}function Cv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(f){n=!0,o=f}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function $u(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Pv(s,e){if(!!s){if(typeof s=="string")return $u(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $u(s,e)}}function Mv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kv(s,e){return Rv(s)||Cv(s,e)||Pv(s,e)||Mv()}function Nv(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Fv(s,e){if(s==null)return{};var r=Nv(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function Bv(s){if(Array.isArray(s))return s}function Uv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(f){n=!0,o=f}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Vu(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function jv(s,e){if(!!s){if(typeof s=="string")return Vu(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vu(s,e)}}function Wv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zv(s,e){return Bv(s)||Uv(s,e)||jv(s,e)||Wv()}function $v(s,e){var r=e||{},i=r.defaultValue,t=r.value,n=r.onChange,a=r.postState,o=Ye.exports.useState(function(){return t!==void 0?t:i!==void 0?typeof i=="function"?i():i:typeof s=="function"?s():s}),f=zv(o,2),h=f[0],p=f[1],l=t!==void 0?t:h;a&&(l=a(l));function u(y){p(y),l!==y&&n&&n(y,l)}var m=Ye.exports.useRef(!0);return Ye.exports.useEffect(function(){if(m.current){m.current=!1;return}t===void 0&&p(t)},[t]),[l,u]}var Ze={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Ze.F1&&r<=Ze.F12)return!1;switch(r){case Ze.ALT:case Ze.CAPS_LOCK:case Ze.CONTEXT_MENU:case Ze.CTRL:case Ze.DOWN:case Ze.END:case Ze.ESC:case Ze.HOME:case Ze.INSERT:case Ze.LEFT:case Ze.MAC_FF_META:case Ze.META:case Ze.NUMLOCK:case Ze.NUM_CENTER:case Ze.PAGE_DOWN:case Ze.PAGE_UP:case Ze.PAUSE:case Ze.PRINT_SCREEN:case Ze.RIGHT:case Ze.SHIFT:case Ze.UP:case Ze.WIN_KEY:case Ze.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Ze.ZERO&&e<=Ze.NINE||e>=Ze.NUM_ZERO&&e<=Ze.NUM_MULTIPLY||e>=Ze.A&&e<=Ze.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Ze.SPACE:case Ze.QUESTION_MARK:case Ze.NUM_PLUS:case Ze.NUM_MINUS:case Ze.NUM_PERIOD:case Ze.NUM_DIVISION:case Ze.SEMICOLON:case Ze.DASH:case Ze.EQUALS:case Ze.COMMA:case Ze.PERIOD:case Ze.SLASH:case Ze.APOSTROPHE:case Ze.SINGLE_QUOTE:case Ze.OPEN_SQUARE_BRACKET:case Ze.BACKSLASH:case Ze.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Hu=Ye.exports.forwardRef(function(s,e){var r,i=s.prefixCls,t=i===void 0?"rc-switch":i,n=s.className,a=s.checked,o=s.defaultChecked,f=s.disabled,h=s.loadingIcon,p=s.checkedChildren,l=s.unCheckedChildren,u=s.onClick,m=s.onChange,y=s.onKeyDown,b=Fv(s,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),_=$v(!1,{value:a,defaultValue:o}),g=kv(_,2),c=g[0],v=g[1];function E(T,w){var L=c;return f||(L=T,v(L),m==null||m(L,w)),L}function d(T){T.which===Ze.LEFT?E(!1,T):T.which===Ze.RIGHT&&E(!0,T),y==null||y(T)}function x(T){var w=E(!c,T);u==null||u(w,T)}var S=Bt(t,n,(r={},zu(r,"".concat(t,"-checked"),c),zu(r,"".concat(t,"-disabled"),f),r));return Ye.exports.createElement("button",Object.assign({},b,{type:"button",role:"switch","aria-checked":c,disabled:f,className:S,ref:e,onKeyDown:d,onClick:x}),h,Ye.exports.createElement("span",{className:"".concat(t,"-inner")},c?p:l))});Hu.displayName="Switch";var Qa={exports:{}},Ku={},Vv=Eo(fp),St={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.findInArray=Hv;Hr.isFunction=Kv;Hr.isNum=Gv;Hr.int=Yv;Hr.dontSetMe=Xv;function Hv(s,e){for(var r=0,i=s.length;r<i;r++)if(e.apply(e,[s[r],r,s]))return s[r]}function Kv(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Function]"}function Gv(s){return typeof s=="number"&&!isNaN(s)}function Yv(s){return parseInt(s,10)}function Xv(s,e,r){if(s[e])return new Error("Invalid prop ".concat(e," passed to ").concat(r," - do not set this, set it on the child."))}var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.getPrefix=Gu;Oi.browserPrefixToKey=Yu;Oi.browserPrefixToStyle=Zv;Oi.default=void 0;var Uo=["Moz","Webkit","O","ms"];function Gu(){var s,e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";var i=(s=window.document)===null||s===void 0||(e=s.documentElement)===null||e===void 0?void 0:e.style;if(!i||r in i)return"";for(var t=0;t<Uo.length;t++)if(Yu(r,Uo[t])in i)return Uo[t];return""}function Yu(s,e){return e?"".concat(e).concat(Qv(s)):s}function Zv(s,e){return e?"-".concat(e.toLowerCase(),"-").concat(s):s}function Qv(s){for(var e="",r=!0,i=0;i<s.length;i++)r?(e+=s[i].toUpperCase(),r=!1):s[i]==="-"?r=!0:e+=s[i];return e}var Jv=Gu();Oi.default=Jv;function Ja(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ja=function(r){return typeof r}:Ja=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ja(s)}Object.defineProperty(St,"__esModule",{value:!0});St.matchesSelector=ef;St.matchesSelectorAndParentsTo=em;St.addEvent=tm;St.removeEvent=rm;St.outerHeight=im;St.outerWidth=nm;St.innerHeight=am;St.innerWidth=sm;St.offsetXYFromParent=om;St.createCSSTransform=lm;St.createSVGTransform=um;St.getTranslation=jo;St.getTouch=fm;St.getTouchIdentifier=dm;St.addUserSelectStyles=cm;St.removeUserSelectStyles=hm;St.addClassName=tf;St.removeClassName=rf;var or=Hr,Xu=qv(Oi);function Zu(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Zu=function(t){return t?r:e})(s)}function qv(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||Ja(s)!=="object"&&typeof s!="function")return{default:s};var r=Zu(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Qu(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function Ju(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qu(Object(r),!0).forEach(function(i){qu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qu(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function qu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var qa="";function ef(s,e){return qa||(qa=(0,or.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,or.isFunction)(s[r])})),(0,or.isFunction)(s[qa])?s[qa](e):!1}function em(s,e,r){var i=s;do{if(ef(i,e))return!0;if(i===r)return!1;i=i.parentNode}while(i);return!1}function tm(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.addEventListener?s.addEventListener(e,r,t):s.attachEvent?s.attachEvent("on"+e,r):s["on"+e]=r}}function rm(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.removeEventListener?s.removeEventListener(e,r,t):s.detachEvent?s.detachEvent("on"+e,r):s["on"+e]=null}}function im(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,or.int)(r.borderTopWidth),e+=(0,or.int)(r.borderBottomWidth),e}function nm(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,or.int)(r.borderLeftWidth),e+=(0,or.int)(r.borderRightWidth),e}function am(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,or.int)(r.paddingTop),e-=(0,or.int)(r.paddingBottom),e}function sm(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,or.int)(r.paddingLeft),e-=(0,or.int)(r.paddingRight),e}function om(s,e,r){var i=e===e.ownerDocument.body,t=i?{left:0,top:0}:e.getBoundingClientRect(),n=(s.clientX+e.scrollLeft-t.left)/r,a=(s.clientY+e.scrollTop-t.top)/r;return{x:n,y:a}}function lm(s,e){var r=jo(s,e,"px");return qu({},(0,Xu.browserPrefixToKey)("transform",Xu.default),r)}function um(s,e){var r=jo(s,e,"");return r}function jo(s,e,r){var i=s.x,t=s.y,n="translate(".concat(i).concat(r,",").concat(t).concat(r,")");if(e){var a="".concat(typeof e.x=="string"?e.x:e.x+r),o="".concat(typeof e.y=="string"?e.y:e.y+r);n="translate(".concat(a,", ").concat(o,")")+n}return n}function fm(s,e){return s.targetTouches&&(0,or.findInArray)(s.targetTouches,function(r){return e===r.identifier})||s.changedTouches&&(0,or.findInArray)(s.changedTouches,function(r){return e===r.identifier})}function dm(s){if(s.targetTouches&&s.targetTouches[0])return s.targetTouches[0].identifier;if(s.changedTouches&&s.changedTouches[0])return s.changedTouches[0].identifier}function cm(s){if(!!s){var e=s.getElementById("react-draggable-style-el");e||(e=s.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,s.getElementsByTagName("head")[0].appendChild(e)),s.body&&tf(s.body,"react-draggable-transparent-selection")}}function hm(s){if(!!s)try{if(s.body&&rf(s.body,"react-draggable-transparent-selection"),s.selection)s.selection.empty();else{var e=(s.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch(r){}}function tf(s,e){s.classList?s.classList.add(e):s.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(s.className+=" ".concat(e))}function rf(s,e){s.classList?s.classList.remove(e):s.className=s.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.getBoundPosition=pm;Kr.snapToGrid=vm;Kr.canDragX=mm;Kr.canDragY=gm;Kr.getControlPosition=ym;Kr.createCoreData=Em;Kr.createDraggableData=_m;var lr=Hr,nn=St;function pm(s,e,r){if(!s.props.bounds)return[e,r];var i=s.props.bounds;i=typeof i=="string"?i:xm(i);var t=Wo(s);if(typeof i=="string"){var n=t.ownerDocument,a=n.defaultView,o;if(i==="parent"?o=t.parentNode:o=n.querySelector(i),!(o instanceof a.HTMLElement))throw new Error('Bounds selector "'+i+'" could not find an element.');var f=o,h=a.getComputedStyle(t),p=a.getComputedStyle(f);i={left:-t.offsetLeft+(0,lr.int)(p.paddingLeft)+(0,lr.int)(h.marginLeft),top:-t.offsetTop+(0,lr.int)(p.paddingTop)+(0,lr.int)(h.marginTop),right:(0,nn.innerWidth)(f)-(0,nn.outerWidth)(t)-t.offsetLeft+(0,lr.int)(p.paddingRight)-(0,lr.int)(h.marginRight),bottom:(0,nn.innerHeight)(f)-(0,nn.outerHeight)(t)-t.offsetTop+(0,lr.int)(p.paddingBottom)-(0,lr.int)(h.marginBottom)}}return(0,lr.isNum)(i.right)&&(e=Math.min(e,i.right)),(0,lr.isNum)(i.bottom)&&(r=Math.min(r,i.bottom)),(0,lr.isNum)(i.left)&&(e=Math.max(e,i.left)),(0,lr.isNum)(i.top)&&(r=Math.max(r,i.top)),[e,r]}function vm(s,e,r){var i=Math.round(e/s[0])*s[0],t=Math.round(r/s[1])*s[1];return[i,t]}function mm(s){return s.props.axis==="both"||s.props.axis==="x"}function gm(s){return s.props.axis==="both"||s.props.axis==="y"}function ym(s,e,r){var i=typeof e=="number"?(0,nn.getTouch)(s,e):null;if(typeof e=="number"&&!i)return null;var t=Wo(r),n=r.props.offsetParent||t.offsetParent||t.ownerDocument.body;return(0,nn.offsetXYFromParent)(i||s,n,r.props.scale)}function Em(s,e,r){var i=s.state,t=!(0,lr.isNum)(i.lastX),n=Wo(s);return t?{node:n,deltaX:0,deltaY:0,lastX:e,lastY:r,x:e,y:r}:{node:n,deltaX:e-i.lastX,deltaY:r-i.lastY,lastX:i.lastX,lastY:i.lastY,x:e,y:r}}function _m(s,e){var r=s.props.scale;return{node:e.node,x:s.state.x+e.deltaX/r,y:s.state.y+e.deltaY/r,deltaX:e.deltaX/r,deltaY:e.deltaY/r,lastX:s.state.x,lastY:s.state.y}}function xm(s){return{left:s.left,top:s.top,right:s.right,bottom:s.bottom}}function Wo(s){var e=s.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var es={},ts={};Object.defineProperty(ts,"__esModule",{value:!0});ts.default=bm;function bm(){}function Wn(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wn=function(r){return typeof r}:Wn=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wn(s)}Object.defineProperty(es,"__esModule",{value:!0});es.default=void 0;var zo=Tm(Ye.exports),ur=Vo(cu.exports),Sm=Vo(Mn.exports),$t=St,Li=Kr,$o=Hr,zn=Vo(ts);function Vo(s){return s&&s.__esModule?s:{default:s}}function nf(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(nf=function(t){return t?r:e})(s)}function Tm(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||Wn(s)!=="object"&&typeof s!="function")return{default:s};var r=nf(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function wm(s,e){return Dm(s)||Lm(s,e)||Om(s,e)||Am()}function Am(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Om(s,e){if(!!s){if(typeof s=="string")return af(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return af(s,e)}}function af(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Lm(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(f){n=!0,o=f}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Dm(s){if(Array.isArray(s))return s}function Im(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function sf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function Rm(s,e,r){return e&&sf(s.prototype,e),r&&sf(s,r),s}function Cm(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&Ho(s,e)}function Ho(s,e){return Ho=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},Ho(s,e)}function Pm(s){var e=km();return function(){var i=rs(s),t;if(e){var n=rs(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return Mm(this,t)}}function Mm(s,e){if(e&&(Wn(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vt(s)}function Vt(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function km(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function rs(s){return rs=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},rs(s)}function br(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var Mr={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},ci=Mr.mouse,is=function(s){Cm(r,s);var e=Pm(r);function r(){var i;Im(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),br(Vt(i),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),br(Vt(i),"mounted",!1),br(Vt(i),"handleDragStart",function(o){if(i.props.onMouseDown(o),!i.props.allowAnyClick&&typeof o.button=="number"&&o.button!==0)return!1;var f=i.findDOMNode();if(!f||!f.ownerDocument||!f.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var h=f.ownerDocument;if(!(i.props.disabled||!(o.target instanceof h.defaultView.Node)||i.props.handle&&!(0,$t.matchesSelectorAndParentsTo)(o.target,i.props.handle,f)||i.props.cancel&&(0,$t.matchesSelectorAndParentsTo)(o.target,i.props.cancel,f))){o.type==="touchstart"&&o.preventDefault();var p=(0,$t.getTouchIdentifier)(o);i.setState({touchIdentifier:p});var l=(0,Li.getControlPosition)(o,p,Vt(i));if(l!=null){var u=l.x,m=l.y,y=(0,Li.createCoreData)(Vt(i),u,m);(0,zn.default)("DraggableCore: handleDragStart: %j",y),(0,zn.default)("calling",i.props.onStart);var b=i.props.onStart(o,y);b===!1||i.mounted===!1||(i.props.enableUserSelectHack&&(0,$t.addUserSelectStyles)(h),i.setState({dragging:!0,lastX:u,lastY:m}),(0,$t.addEvent)(h,ci.move,i.handleDrag),(0,$t.addEvent)(h,ci.stop,i.handleDragStop))}}}),br(Vt(i),"handleDrag",function(o){var f=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Vt(i));if(f!=null){var h=f.x,p=f.y;if(Array.isArray(i.props.grid)){var l=h-i.state.lastX,u=p-i.state.lastY,m=(0,Li.snapToGrid)(i.props.grid,l,u),y=wm(m,2);if(l=y[0],u=y[1],!l&&!u)return;h=i.state.lastX+l,p=i.state.lastY+u}var b=(0,Li.createCoreData)(Vt(i),h,p);(0,zn.default)("DraggableCore: handleDrag: %j",b);var _=i.props.onDrag(o,b);if(_===!1||i.mounted===!1){try{i.handleDragStop(new MouseEvent("mouseup"))}catch(c){var g=document.createEvent("MouseEvents");g.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.handleDragStop(g)}return}i.setState({lastX:h,lastY:p})}}),br(Vt(i),"handleDragStop",function(o){if(!!i.state.dragging){var f=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Vt(i));if(f!=null){var h=f.x,p=f.y,l=(0,Li.createCoreData)(Vt(i),h,p),u=i.props.onStop(o,l);if(u===!1||i.mounted===!1)return!1;var m=i.findDOMNode();m&&i.props.enableUserSelectHack&&(0,$t.removeUserSelectStyles)(m.ownerDocument),(0,zn.default)("DraggableCore: handleDragStop: %j",l),i.setState({dragging:!1,lastX:NaN,lastY:NaN}),m&&((0,zn.default)("DraggableCore: Removing handlers"),(0,$t.removeEvent)(m.ownerDocument,ci.move,i.handleDrag),(0,$t.removeEvent)(m.ownerDocument,ci.stop,i.handleDragStop))}}}),br(Vt(i),"onMouseDown",function(o){return ci=Mr.mouse,i.handleDragStart(o)}),br(Vt(i),"onMouseUp",function(o){return ci=Mr.mouse,i.handleDragStop(o)}),br(Vt(i),"onTouchStart",function(o){return ci=Mr.touch,i.handleDragStart(o)}),br(Vt(i),"onTouchEnd",function(o){return ci=Mr.touch,i.handleDragStop(o)}),i}return Rm(r,[{key:"componentDidMount",value:function(){this.mounted=!0;var t=this.findDOMNode();t&&(0,$t.addEvent)(t,Mr.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var t=this.findDOMNode();if(t){var n=t.ownerDocument;(0,$t.removeEvent)(n,Mr.mouse.move,this.handleDrag),(0,$t.removeEvent)(n,Mr.touch.move,this.handleDrag),(0,$t.removeEvent)(n,Mr.mouse.stop,this.handleDragStop),(0,$t.removeEvent)(n,Mr.touch.stop,this.handleDragStop),(0,$t.removeEvent)(t,Mr.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,$t.removeUserSelectStyles)(n)}}},{key:"findDOMNode",value:function(){var t,n,a;return(t=(n=this.props)===null||n===void 0||(a=n.nodeRef)===null||a===void 0?void 0:a.current)!==null&&t!==void 0?t:Sm.default.findDOMNode(this)}},{key:"render",value:function(){return zo.cloneElement(zo.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),r}(zo.Component);es.default=is;br(is,"displayName","DraggableCore");br(is,"propTypes",{allowAnyClick:ur.default.bool,disabled:ur.default.bool,enableUserSelectHack:ur.default.bool,offsetParent:function(e,r){if(e[r]&&e[r].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:ur.default.arrayOf(ur.default.number),handle:ur.default.string,cancel:ur.default.string,nodeRef:ur.default.object,onStart:ur.default.func,onDrag:ur.default.func,onStop:ur.default.func,onMouseDown:ur.default.func,scale:ur.default.number,className:$o.dontSetMe,style:$o.dontSetMe,transform:$o.dontSetMe});br(is,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(s){function e(F){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function($){return typeof $}:e=function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},e(F)}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"DraggableCore",{enumerable:!0,get:function(){return h.default}}),s.default=void 0;var r=y(Ye.exports),i=u(cu.exports),t=u(Mn.exports),n=u(Vv),a=St,o=Kr,f=Hr,h=u(es),p=u(ts),l=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function u(F){return F&&F.__esModule?F:{default:F}}function m(F){if(typeof WeakMap!="function")return null;var j=new WeakMap,$=new WeakMap;return(m=function(Y){return Y?$:j})(F)}function y(F,j){if(!j&&F&&F.__esModule)return F;if(F===null||e(F)!=="object"&&typeof F!="function")return{default:F};var $=m(j);if($&&$.has(F))return $.get(F);var G={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in F)if(X!=="default"&&Object.prototype.hasOwnProperty.call(F,X)){var ie=Y?Object.getOwnPropertyDescriptor(F,X):null;ie&&(ie.get||ie.set)?Object.defineProperty(G,X,ie):G[X]=F[X]}return G.default=F,$&&$.set(F,G),G}function b(){return b=Object.assign||function(F){for(var j=1;j<arguments.length;j++){var $=arguments[j];for(var G in $)Object.prototype.hasOwnProperty.call($,G)&&(F[G]=$[G])}return F},b.apply(this,arguments)}function _(F,j){if(F==null)return{};var $=g(F,j),G,Y;if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(F);for(Y=0;Y<X.length;Y++)G=X[Y],!(j.indexOf(G)>=0)&&(!Object.prototype.propertyIsEnumerable.call(F,G)||($[G]=F[G]))}return $}function g(F,j){if(F==null)return{};var $={},G=Object.keys(F),Y,X;for(X=0;X<G.length;X++)Y=G[X],!(j.indexOf(Y)>=0)&&($[Y]=F[Y]);return $}function c(F,j){var $=Object.keys(F);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(F);j&&(G=G.filter(function(Y){return Object.getOwnPropertyDescriptor(F,Y).enumerable})),$.push.apply($,G)}return $}function v(F){for(var j=1;j<arguments.length;j++){var $=arguments[j]!=null?arguments[j]:{};j%2?c(Object($),!0).forEach(function(G){B(F,G,$[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors($)):c(Object($)).forEach(function(G){Object.defineProperty(F,G,Object.getOwnPropertyDescriptor($,G))})}return F}function E(F,j){return w(F)||T(F,j)||x(F,j)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x(F,j){if(!!F){if(typeof F=="string")return S(F,j);var $=Object.prototype.toString.call(F).slice(8,-1);if($==="Object"&&F.constructor&&($=F.constructor.name),$==="Map"||$==="Set")return Array.from(F);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return S(F,j)}}function S(F,j){(j==null||j>F.length)&&(j=F.length);for(var $=0,G=new Array(j);$<j;$++)G[$]=F[$];return G}function T(F,j){var $=F==null?null:typeof Symbol!="undefined"&&F[Symbol.iterator]||F["@@iterator"];if($!=null){var G=[],Y=!0,X=!1,ie,pe;try{for($=$.call(F);!(Y=(ie=$.next()).done)&&(G.push(ie.value),!(j&&G.length===j));Y=!0);}catch(ue){X=!0,pe=ue}finally{try{!Y&&$.return!=null&&$.return()}finally{if(X)throw pe}}return G}}function w(F){if(Array.isArray(F))return F}function L(F,j){if(!(F instanceof j))throw new TypeError("Cannot call a class as a function")}function I(F,j){for(var $=0;$<j.length;$++){var G=j[$];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(F,G.key,G)}}function A(F,j,$){return j&&I(F.prototype,j),$&&I(F,$),F}function O(F,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(j&&j.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),j&&D(F,j)}function D(F,j){return D=Object.setPrototypeOf||function(G,Y){return G.__proto__=Y,G},D(F,j)}function R(F){var j=M();return function(){var G=N(F),Y;if(j){var X=N(this).constructor;Y=Reflect.construct(G,arguments,X)}else Y=G.apply(this,arguments);return C(this,Y)}}function C(F,j){if(j&&(e(j)==="object"||typeof j=="function"))return j;if(j!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P(F)}function P(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(F){return!1}}function N(F){return N=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)},N(F)}function B(F,j,$){return j in F?Object.defineProperty(F,j,{value:$,enumerable:!0,configurable:!0,writable:!0}):F[j]=$,F}var U=function(F){O($,F);var j=R($);function $(G){var Y;return L(this,$),Y=j.call(this,G),B(P(Y),"onDragStart",function(X,ie){(0,p.default)("Draggable: onDragStart: %j",ie);var pe=Y.props.onStart(X,(0,o.createDraggableData)(P(Y),ie));if(pe===!1)return!1;Y.setState({dragging:!0,dragged:!0})}),B(P(Y),"onDrag",function(X,ie){if(!Y.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",ie);var pe=(0,o.createDraggableData)(P(Y),ie),ue={x:pe.x,y:pe.y};if(Y.props.bounds){var we=ue.x,de=ue.y;ue.x+=Y.state.slackX,ue.y+=Y.state.slackY;var oe=(0,o.getBoundPosition)(P(Y),ue.x,ue.y),De=E(oe,2),Ce=De[0],Ue=De[1];ue.x=Ce,ue.y=Ue,ue.slackX=Y.state.slackX+(we-ue.x),ue.slackY=Y.state.slackY+(de-ue.y),pe.x=ue.x,pe.y=ue.y,pe.deltaX=ue.x-Y.state.x,pe.deltaY=ue.y-Y.state.y}var Me=Y.props.onDrag(X,pe);if(Me===!1)return!1;Y.setState(ue)}),B(P(Y),"onDragStop",function(X,ie){if(!Y.state.dragging)return!1;var pe=Y.props.onStop(X,(0,o.createDraggableData)(P(Y),ie));if(pe===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",ie);var ue={dragging:!1,slackX:0,slackY:0},we=Boolean(Y.props.position);if(we){var de=Y.props.position,oe=de.x,De=de.y;ue.x=oe,ue.y=De}Y.setState(ue)}),Y.state={dragging:!1,dragged:!1,x:G.position?G.position.x:G.defaultPosition.x,y:G.position?G.position.y:G.defaultPosition.y,prevPropsPosition:v({},G.position),slackX:0,slackY:0,isElementSVG:!1},G.position&&!(G.onDrag||G.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),Y}return A($,[{key:"componentDidMount",value:function(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var Y,X,ie;return(Y=(X=this.props)===null||X===void 0||(ie=X.nodeRef)===null||ie===void 0?void 0:ie.current)!==null&&Y!==void 0?Y:t.default.findDOMNode(this)}},{key:"render",value:function(){var Y,X=this.props;X.axis,X.bounds;var ie=X.children,pe=X.defaultPosition,ue=X.defaultClassName,we=X.defaultClassNameDragging,de=X.defaultClassNameDragged,oe=X.position,De=X.positionOffset;X.scale;var Ce=_(X,l),Ue={},Me=null,ze=Boolean(oe),Ge=!ze||this.state.dragging,Ke=oe||pe,He={x:(0,o.canDragX)(this)&&Ge?this.state.x:Ke.x,y:(0,o.canDragY)(this)&&Ge?this.state.y:Ke.y};this.state.isElementSVG?Me=(0,a.createSVGTransform)(He,De):Ue=(0,a.createCSSTransform)(He,De);var Fe=(0,n.default)(ie.props.className||"",ue,(Y={},B(Y,we,this.state.dragging),B(Y,de,this.state.dragged),Y));return r.createElement(h.default,b({},Ce,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(ie),{className:Fe,style:v(v({},ie.props.style),Ue),transform:Me}))}}],[{key:"getDerivedStateFromProps",value:function(Y,X){var ie=Y.position,pe=X.prevPropsPosition;return ie&&(!pe||ie.x!==pe.x||ie.y!==pe.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:ie,prevPropsPosition:pe}),{x:ie.x,y:ie.y,prevPropsPosition:v({},ie)}):null}}]),$}(r.Component);s.default=U,B(U,"displayName","Draggable"),B(U,"propTypes",v(v({},h.default.propTypes),{},{axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:f.dontSetMe,style:f.dontSetMe,transform:f.dontSetMe})),B(U,"defaultProps",v(v({},h.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))})(Ku);var of=Ku,lf=of.default,Nm=of.DraggableCore;Qa.exports=lf;Qa.exports.default=lf;Qa.exports.DraggableCore=Nm;var uf=Qa.exports;/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ff(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function Gr(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ff(Object(r),!0).forEach(function(i){Fm(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ff(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function ns(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ns=function(e){return typeof e}:ns=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ns(s)}function Fm(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Yr(){return Yr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Yr.apply(this,arguments)}function Bm(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Um(s,e){if(s==null)return{};var r=Bm(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}var jm="1.14.0";function ri(s){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(s)}var ii=ri(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),$n=ri(/Edge/i),df=ri(/firefox/i),Vn=ri(/safari/i)&&!ri(/chrome/i)&&!ri(/android/i),cf=ri(/iP(ad|od|hone)/i),Wm=ri(/chrome/i)&&ri(/android/i),hf={capture:!1,passive:!1};function ut(s,e,r){s.addEventListener(e,r,!ii&&hf)}function lt(s,e,r){s.removeEventListener(e,r,!ii&&hf)}function as(s,e){if(!!e){if(e[0]===">"&&(e=e.substring(1)),s)try{if(s.matches)return s.matches(e);if(s.msMatchesSelector)return s.msMatchesSelector(e);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(e)}catch(r){return!1}return!1}}function zm(s){return s.host&&s!==document&&s.host.nodeType?s.host:s.parentNode}function Xr(s,e,r,i){if(s){r=r||document;do{if(e!=null&&(e[0]===">"?s.parentNode===r&&as(s,e):as(s,e))||i&&s===r)return s;if(s===r)break}while(s=zm(s))}return null}var pf=/\s+/g;function Ht(s,e,r){if(s&&e)if(s.classList)s.classList[r?"add":"remove"](e);else{var i=(" "+s.className+" ").replace(pf," ").replace(" "+e+" "," ");s.className=(i+(r?" "+e:"")).replace(pf," ")}}function qe(s,e,r){var i=s&&s.style;if(i){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(r=s.currentStyle),e===void 0?r:r[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=r+(typeof r=="string"?"":"px")}}function an(s,e){var r="";if(typeof s=="string")r=s;else do{var i=qe(s,"transform");i&&i!=="none"&&(r=i+" "+r)}while(!e&&(s=s.parentNode));var t=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return t&&new t(r)}function vf(s,e,r){if(s){var i=s.getElementsByTagName(e),t=0,n=i.length;if(r)for(;t<n;t++)r(i[t],t);return i}return[]}function Zr(){var s=document.scrollingElement;return s||document.documentElement}function Ct(s,e,r,i,t){if(!(!s.getBoundingClientRect&&s!==window)){var n,a,o,f,h,p,l;if(s!==window&&s.parentNode&&s!==Zr()?(n=s.getBoundingClientRect(),a=n.top,o=n.left,f=n.bottom,h=n.right,p=n.height,l=n.width):(a=0,o=0,f=window.innerHeight,h=window.innerWidth,p=window.innerHeight,l=window.innerWidth),(e||r)&&s!==window&&(t=t||s.parentNode,!ii))do if(t&&t.getBoundingClientRect&&(qe(t,"transform")!=="none"||r&&qe(t,"position")!=="static")){var u=t.getBoundingClientRect();a-=u.top+parseInt(qe(t,"border-top-width")),o-=u.left+parseInt(qe(t,"border-left-width")),f=a+n.height,h=o+n.width;break}while(t=t.parentNode);if(i&&s!==window){var m=an(t||s),y=m&&m.a,b=m&&m.d;m&&(a/=b,o/=y,l/=y,p/=b,f=a+p,h=o+l)}return{top:a,left:o,bottom:f,right:h,width:l,height:p}}}function mf(s,e,r){for(var i=hi(s,!0),t=Ct(s)[e];i;){var n=Ct(i)[r],a=void 0;if(r==="top"||r==="left"?a=t>=n:a=t<=n,!a)return i;if(i===Zr())break;i=hi(i,!1)}return!1}function sn(s,e,r,i){for(var t=0,n=0,a=s.children;n<a.length;){if(a[n].style.display!=="none"&&a[n]!==Je.ghost&&(i||a[n]!==Je.dragged)&&Xr(a[n],r.draggable,s,!1)){if(t===e)return a[n];t++}n++}return null}function Ko(s,e){for(var r=s.lastElementChild;r&&(r===Je.ghost||qe(r,"display")==="none"||e&&!as(r,e));)r=r.previousElementSibling;return r||null}function tr(s,e){var r=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()!=="TEMPLATE"&&s!==Je.clone&&(!e||as(s,e))&&r++;return r}function gf(s){var e=0,r=0,i=Zr();if(s)do{var t=an(s),n=t.a,a=t.d;e+=s.scrollLeft*n,r+=s.scrollTop*a}while(s!==i&&(s=s.parentNode));return[e,r]}function $m(s,e){for(var r in s)if(!!s.hasOwnProperty(r)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===s[r][i])return Number(r)}return-1}function hi(s,e){if(!s||!s.getBoundingClientRect)return Zr();var r=s,i=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var t=qe(r);if(r.clientWidth<r.scrollWidth&&(t.overflowX=="auto"||t.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(t.overflowY=="auto"||t.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return Zr();if(i||e)return r;i=!0}}while(r=r.parentNode);return Zr()}function Vm(s,e){if(s&&e)for(var r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);return s}function Go(s,e){return Math.round(s.top)===Math.round(e.top)&&Math.round(s.left)===Math.round(e.left)&&Math.round(s.height)===Math.round(e.height)&&Math.round(s.width)===Math.round(e.width)}var Hn;function yf(s,e){return function(){if(!Hn){var r=arguments,i=this;r.length===1?s.call(i,r[0]):s.apply(i,r),Hn=setTimeout(function(){Hn=void 0},e)}}}function Hm(){clearTimeout(Hn),Hn=void 0}function Ef(s,e,r){s.scrollLeft+=e,s.scrollTop+=r}function _f(s){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(s).cloneNode(!0):r?r(s).clone(!0)[0]:s.cloneNode(!0)}var fr="Sortable"+new Date().getTime();function Km(){var s=[],e;return{captureAnimationState:function(){if(s=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(t){if(!(qe(t,"display")==="none"||t===Je.ghost)){s.push({target:t,rect:Ct(t)});var n=Gr({},s[s.length-1].rect);if(t.thisAnimationDuration){var a=an(t,!0);a&&(n.top-=a.f,n.left-=a.e)}t.fromRect=n}})}},addAnimationState:function(i){s.push(i)},removeAnimationState:function(i){s.splice($m(s,{target:i}),1)},animateAll:function(i){var t=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var n=!1,a=0;s.forEach(function(o){var f=0,h=o.target,p=h.fromRect,l=Ct(h),u=h.prevFromRect,m=h.prevToRect,y=o.rect,b=an(h,!0);b&&(l.top-=b.f,l.left-=b.e),h.toRect=l,h.thisAnimationDuration&&Go(u,l)&&!Go(p,l)&&(y.top-l.top)/(y.left-l.left)==(p.top-l.top)/(p.left-l.left)&&(f=Ym(y,u,m,t.options)),Go(l,p)||(h.prevFromRect=p,h.prevToRect=l,f||(f=t.options.animation),t.animate(h,y,l,f)),f&&(n=!0,a=Math.max(a,f),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},f),h.thisAnimationDuration=f)}),clearTimeout(e),n?e=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),s=[]},animate:function(i,t,n,a){if(a){qe(i,"transition",""),qe(i,"transform","");var o=an(this.el),f=o&&o.a,h=o&&o.d,p=(t.left-n.left)/(f||1),l=(t.top-n.top)/(h||1);i.animatingX=!!p,i.animatingY=!!l,qe(i,"transform","translate3d("+p+"px,"+l+"px,0)"),this.forRepaintDummy=Gm(i),qe(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),qe(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){qe(i,"transition",""),qe(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function Gm(s){return s.offsetWidth}function Ym(s,e,r,i){return Math.sqrt(Math.pow(e.top-s.top,2)+Math.pow(e.left-s.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*i.animation}var on=[],Yo={initializeByDefault:!0},Kn={mount:function(e){for(var r in Yo)Yo.hasOwnProperty(r)&&!(r in e)&&(e[r]=Yo[r]);on.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),on.push(e)},pluginEvent:function(e,r,i){var t=this;this.eventCanceled=!1,i.cancel=function(){t.eventCanceled=!0};var n=e+"Global";on.forEach(function(a){!r[a.pluginName]||(r[a.pluginName][n]&&r[a.pluginName][n](Gr({sortable:r},i)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e](Gr({sortable:r},i)))})},initializePlugins:function(e,r,i,t){on.forEach(function(o){var f=o.pluginName;if(!(!e.options[f]&&!o.initializeByDefault)){var h=new o(e,r,e.options);h.sortable=e,h.options=e.options,e[f]=h,Yr(i,h.defaults)}});for(var n in e.options)if(!!e.options.hasOwnProperty(n)){var a=this.modifyOption(e,n,e.options[n]);typeof a!="undefined"&&(e.options[n]=a)}},getEventProperties:function(e,r){var i={};return on.forEach(function(t){typeof t.eventProperties=="function"&&Yr(i,t.eventProperties.call(r[t.pluginName],e))}),i},modifyOption:function(e,r,i){var t;return on.forEach(function(n){!e[n.pluginName]||n.optionListeners&&typeof n.optionListeners[r]=="function"&&(t=n.optionListeners[r].call(e[n.pluginName],i))}),t}};function Xm(s){var e=s.sortable,r=s.rootEl,i=s.name,t=s.targetEl,n=s.cloneEl,a=s.toEl,o=s.fromEl,f=s.oldIndex,h=s.newIndex,p=s.oldDraggableIndex,l=s.newDraggableIndex,u=s.originalEvent,m=s.putSortable,y=s.extraEventProperties;if(e=e||r&&r[fr],!!e){var b,_=e.options,g="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!ii&&!$n?b=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(b=document.createEvent("Event"),b.initEvent(i,!0,!0)),b.to=a||r,b.from=o||r,b.item=t||r,b.clone=n,b.oldIndex=f,b.newIndex=h,b.oldDraggableIndex=p,b.newDraggableIndex=l,b.originalEvent=u,b.pullMode=m?m.lastPutMode:void 0;var c=Gr(Gr({},y),Kn.getEventProperties(i,e));for(var v in c)b[v]=c[v];r&&r.dispatchEvent(b),_[g]&&_[g].call(e,b)}}var Zm=["evt"],rr=function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=i.evt,n=Um(i,Zm);Kn.pluginEvent.bind(Je)(e,r,Gr({dragEl:Pe,parentEl:Tt,ghostEl:tt,rootEl:gt,nextEl:Di,lastDownEl:ss,cloneEl:wt,cloneHidden:pi,dragStarted:Yn,putSortable:Ut,activeSortable:Je.active,originalEvent:t,oldIndex:ln,oldDraggableIndex:Gn,newIndex:dr,newDraggableIndex:vi,hideGhostForTarget:Of,unhideGhostForTarget:Lf,cloneNowHidden:function(){pi=!0},cloneNowShown:function(){pi=!1},dispatchSortableEvent:function(o){Zt({sortable:r,name:o,originalEvent:t})}},n))};function Zt(s){Xm(Gr({putSortable:Ut,cloneEl:wt,targetEl:Pe,rootEl:gt,oldIndex:ln,oldDraggableIndex:Gn,newIndex:dr,newDraggableIndex:vi},s))}var Pe,Tt,tt,gt,Di,ss,wt,pi,ln,dr,Gn,vi,os,Ut,un=!1,ls=!1,us=[],Ii,kr,Xo,Zo,xf,bf,Yn,fn,Xn,Zn=!1,fs=!1,ds,Kt,Qo=[],Jo=!1,cs=[],hs=typeof document!="undefined",ps=cf,Sf=$n||ii?"cssFloat":"float",Qm=hs&&!Wm&&!cf&&"draggable"in document.createElement("div"),Tf=function(){if(!!hs){if(ii)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),wf=function(e,r){var i=qe(e),t=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=sn(e,0,r),a=sn(e,1,r),o=n&&qe(n),f=a&&qe(a),h=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Ct(n).width,p=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+Ct(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&o.float&&o.float!=="none"){var l=o.float==="left"?"left":"right";return a&&(f.clear==="both"||f.clear===l)?"vertical":"horizontal"}return n&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||h>=t&&i[Sf]==="none"||a&&i[Sf]==="none"&&h+p>t)?"vertical":"horizontal"},Jm=function(e,r,i){var t=i?e.left:e.top,n=i?e.right:e.bottom,a=i?e.width:e.height,o=i?r.left:r.top,f=i?r.right:r.bottom,h=i?r.width:r.height;return t===o||n===f||t+a/2===o+h/2},qm=function(e,r){var i;return us.some(function(t){var n=t[fr].options.emptyInsertThreshold;if(!(!n||Ko(t))){var a=Ct(t),o=e>=a.left-n&&e<=a.right+n,f=r>=a.top-n&&r<=a.bottom+n;if(o&&f)return i=t}}),i},Af=function(e){function r(n,a){return function(o,f,h,p){var l=o.options.group.name&&f.options.group.name&&o.options.group.name===f.options.group.name;if(n==null&&(a||l))return!0;if(n==null||n===!1)return!1;if(a&&n==="clone")return n;if(typeof n=="function")return r(n(o,f,h,p),a)(o,f,h,p);var u=(a?o:f).options.group.name;return n===!0||typeof n=="string"&&n===u||n.join&&n.indexOf(u)>-1}}var i={},t=e.group;(!t||ns(t)!="object")&&(t={name:t}),i.name=t.name,i.checkPull=r(t.pull,!0),i.checkPut=r(t.put),i.revertClone=t.revertClone,e.group=i},Of=function(){!Tf&&tt&&qe(tt,"display","none")},Lf=function(){!Tf&&tt&&qe(tt,"display","")};hs&&document.addEventListener("click",function(s){if(ls)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),ls=!1,!1},!0);var Ri=function(e){if(Pe){e=e.touches?e.touches[0]:e;var r=qm(e.clientX,e.clientY);if(r){var i={};for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);i.target=i.rootEl=r,i.preventDefault=void 0,i.stopPropagation=void 0,r[fr]._onDragOver(i)}}},eg=function(e){Pe&&Pe.parentNode[fr]._isOutsideThisEl(e.target)};function Je(s,e){if(!(s&&s.nodeType&&s.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=e=Yr({},e),s[fr]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return wf(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Je.supportPointer!==!1&&"PointerEvent"in window&&!Vn,emptyInsertThreshold:5};Kn.initializePlugins(this,s,r);for(var i in r)!(i in e)&&(e[i]=r[i]);Af(e);for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this));this.nativeDraggable=e.forceFallback?!1:Qm,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ut(s,"pointerdown",this._onTapStart):(ut(s,"mousedown",this._onTapStart),ut(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(ut(s,"dragover",this),ut(s,"dragenter",this)),us.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Yr(this,Km())}Je.prototype={constructor:Je,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(fn=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,Pe):this.options.direction},_onTapStart:function(e){if(!!e.cancelable){var r=this,i=this.el,t=this.options,n=t.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,f=(o||e).target,h=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||f,p=t.filter;if(lg(i),!Pe&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||t.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&Vn&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Xr(f,t.draggable,i,!1),!(f&&f.animated)&&ss!==f)){if(ln=tr(f),Gn=tr(f,t.draggable),typeof p=="function"){if(p.call(this,e,f,this)){Zt({sortable:r,rootEl:h,name:"filter",targetEl:f,toEl:i,fromEl:i}),rr("filter",r,{evt:e}),n&&e.cancelable&&e.preventDefault();return}}else if(p&&(p=p.split(",").some(function(l){if(l=Xr(h,l.trim(),i,!1),l)return Zt({sortable:r,rootEl:l,name:"filter",targetEl:f,fromEl:i,toEl:i}),rr("filter",r,{evt:e}),!0}),p)){n&&e.cancelable&&e.preventDefault();return}t.handle&&!Xr(h,t.handle,i,!1)||this._prepareDragStart(e,o,f)}}},_prepareDragStart:function(e,r,i){var t=this,n=t.el,a=t.options,o=n.ownerDocument,f;if(i&&!Pe&&i.parentNode===n){var h=Ct(i);if(gt=n,Pe=i,Tt=Pe.parentNode,Di=Pe.nextSibling,ss=i,os=a.group,Je.dragged=Pe,Ii={target:Pe,clientX:(r||e).clientX,clientY:(r||e).clientY},xf=Ii.clientX-h.left,bf=Ii.clientY-h.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,Pe.style["will-change"]="all",f=function(){if(rr("delayEnded",t,{evt:e}),Je.eventCanceled){t._onDrop();return}t._disableDelayedDragEvents(),!df&&t.nativeDraggable&&(Pe.draggable=!0),t._triggerDragStart(e,r),Zt({sortable:t,name:"choose",originalEvent:e}),Ht(Pe,a.chosenClass,!0)},a.ignore.split(",").forEach(function(p){vf(Pe,p.trim(),qo)}),ut(o,"dragover",Ri),ut(o,"mousemove",Ri),ut(o,"touchmove",Ri),ut(o,"mouseup",t._onDrop),ut(o,"touchend",t._onDrop),ut(o,"touchcancel",t._onDrop),df&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Pe.draggable=!0),rr("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!($n||ii))){if(Je.eventCanceled){this._onDrop();return}ut(o,"mouseup",t._disableDelayedDrag),ut(o,"touchend",t._disableDelayedDrag),ut(o,"touchcancel",t._disableDelayedDrag),ut(o,"mousemove",t._delayedDragTouchMoveHandler),ut(o,"touchmove",t._delayedDragTouchMoveHandler),a.supportPointer&&ut(o,"pointermove",t._delayedDragTouchMoveHandler),t._dragStartTimer=setTimeout(f,a.delay)}else f()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Pe&&qo(Pe),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._disableDelayedDrag),lt(e,"touchend",this._disableDelayedDrag),lt(e,"touchcancel",this._disableDelayedDrag),lt(e,"mousemove",this._delayedDragTouchMoveHandler),lt(e,"touchmove",this._delayedDragTouchMoveHandler),lt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?ut(document,"pointermove",this._onTouchMove):r?ut(document,"touchmove",this._onTouchMove):ut(document,"mousemove",this._onTouchMove):(ut(Pe,"dragend",this),ut(gt,"dragstart",this._onDragStart));try{document.selection?ms(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(e,r){if(un=!1,gt&&Pe){rr("dragStarted",this,{evt:r}),this.nativeDraggable&&ut(document,"dragover",eg);var i=this.options;!e&&Ht(Pe,i.dragClass,!1),Ht(Pe,i.ghostClass,!0),Je.active=this,e&&this._appendGhost(),Zt({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(kr){this._lastX=kr.clientX,this._lastY=kr.clientY,Of();for(var e=document.elementFromPoint(kr.clientX,kr.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(kr.clientX,kr.clientY),e!==r);)r=e;if(Pe.parentNode[fr]._isOutsideThisEl(e),r)do{if(r[fr]){var i=void 0;if(i=r[fr]._onDragOver({clientX:kr.clientX,clientY:kr.clientY,target:e,rootEl:r}),i&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);Lf()}},_onTouchMove:function(e){if(Ii){var r=this.options,i=r.fallbackTolerance,t=r.fallbackOffset,n=e.touches?e.touches[0]:e,a=tt&&an(tt,!0),o=tt&&a&&a.a,f=tt&&a&&a.d,h=ps&&Kt&&gf(Kt),p=(n.clientX-Ii.clientX+t.x)/(o||1)+(h?h[0]-Qo[0]:0)/(o||1),l=(n.clientY-Ii.clientY+t.y)/(f||1)+(h?h[1]-Qo[1]:0)/(f||1);if(!Je.active&&!un){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(tt){a?(a.e+=p-(Xo||0),a.f+=l-(Zo||0)):a={a:1,b:0,c:0,d:1,e:p,f:l};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");qe(tt,"webkitTransform",u),qe(tt,"mozTransform",u),qe(tt,"msTransform",u),qe(tt,"transform",u),Xo=p,Zo=l,kr=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!tt){var e=this.options.fallbackOnBody?document.body:gt,r=Ct(Pe,!0,ps,!0,e),i=this.options;if(ps){for(Kt=e;qe(Kt,"position")==="static"&&qe(Kt,"transform")==="none"&&Kt!==document;)Kt=Kt.parentNode;Kt!==document.body&&Kt!==document.documentElement?(Kt===document&&(Kt=Zr()),r.top+=Kt.scrollTop,r.left+=Kt.scrollLeft):Kt=Zr(),Qo=gf(Kt)}tt=Pe.cloneNode(!0),Ht(tt,i.ghostClass,!1),Ht(tt,i.fallbackClass,!0),Ht(tt,i.dragClass,!0),qe(tt,"transition",""),qe(tt,"transform",""),qe(tt,"box-sizing","border-box"),qe(tt,"margin",0),qe(tt,"top",r.top),qe(tt,"left",r.left),qe(tt,"width",r.width),qe(tt,"height",r.height),qe(tt,"opacity","0.8"),qe(tt,"position",ps?"absolute":"fixed"),qe(tt,"zIndex","100000"),qe(tt,"pointerEvents","none"),Je.ghost=tt,e.appendChild(tt),qe(tt,"transform-origin",xf/parseInt(tt.style.width)*100+"% "+bf/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(e,r){var i=this,t=e.dataTransfer,n=i.options;if(rr("dragStart",this,{evt:e}),Je.eventCanceled){this._onDrop();return}rr("setupClone",this),Je.eventCanceled||(wt=_f(Pe),wt.draggable=!1,wt.style["will-change"]="",this._hideClone(),Ht(wt,this.options.chosenClass,!1),Je.clone=wt),i.cloneId=ms(function(){rr("clone",i),!Je.eventCanceled&&(i.options.removeCloneOnHide||gt.insertBefore(wt,Pe),i._hideClone(),Zt({sortable:i,name:"clone"}))}),!r&&Ht(Pe,n.dragClass,!0),r?(ls=!0,i._loopId=setInterval(i._emulateDragOver,50)):(lt(document,"mouseup",i._onDrop),lt(document,"touchend",i._onDrop),lt(document,"touchcancel",i._onDrop),t&&(t.effectAllowed="move",n.setData&&n.setData.call(i,t,Pe)),ut(document,"drop",i),qe(Pe,"transform","translateZ(0)")),un=!0,i._dragStartId=ms(i._dragStarted.bind(i,r,e)),ut(document,"selectstart",i),Yn=!0,Vn&&qe(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,i=e.target,t,n,a,o=this.options,f=o.group,h=Je.active,p=os===f,l=o.sort,u=Ut||h,m,y=this,b=!1;if(Jo)return;function _(M,N){rr(M,y,Gr({evt:e,isOwner:p,axis:m?"vertical":"horizontal",revert:a,dragRect:t,targetRect:n,canSort:l,fromSortable:u,target:i,completed:c,onMove:function(U,F){return vs(gt,r,Pe,t,U,Ct(U),e,F)},changed:v},N))}function g(){_("dragOverAnimationCapture"),y.captureAnimationState(),y!==u&&u.captureAnimationState()}function c(M){return _("dragOverCompleted",{insertion:M}),M&&(p?h._hideClone():h._showClone(y),y!==u&&(Ht(Pe,Ut?Ut.options.ghostClass:h.options.ghostClass,!1),Ht(Pe,o.ghostClass,!0)),Ut!==y&&y!==Je.active?Ut=y:y===Je.active&&Ut&&(Ut=null),u===y&&(y._ignoreWhileAnimating=i),y.animateAll(function(){_("dragOverAnimationComplete"),y._ignoreWhileAnimating=null}),y!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(i===Pe&&!Pe.animated||i===r&&!i.animated)&&(fn=null),!o.dragoverBubble&&!e.rootEl&&i!==document&&(Pe.parentNode[fr]._isOutsideThisEl(e.target),!M&&Ri(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),b=!0}function v(){dr=tr(Pe),vi=tr(Pe,o.draggable),Zt({sortable:y,name:"change",toEl:r,newIndex:dr,newDraggableIndex:vi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=Xr(i,o.draggable,r,!0),_("dragOver"),Je.eventCanceled)return b;if(Pe.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||y._ignoreWhileAnimating===i)return c(!1);if(ls=!1,h&&!o.disabled&&(p?l||(a=Tt!==gt):Ut===this||(this.lastPutMode=os.checkPull(this,h,Pe,e))&&f.checkPut(this,h,Pe,e))){if(m=this._getDirection(e,i)==="vertical",t=Ct(Pe),_("dragOverValid"),Je.eventCanceled)return b;if(a)return Tt=gt,g(),this._hideClone(),_("revert"),Je.eventCanceled||(Di?gt.insertBefore(Pe,Di):gt.appendChild(Pe)),c(!0);var E=Ko(r,o.draggable);if(!E||ng(e,m,this)&&!E.animated){if(E===Pe)return c(!1);if(E&&r===e.target&&(i=E),i&&(n=Ct(i)),vs(gt,r,Pe,t,i,n,e,!!i)!==!1)return g(),r.appendChild(Pe),Tt=r,v(),c(!0)}else if(E&&ig(e,m,this)){var d=sn(r,0,o,!0);if(d===Pe)return c(!1);if(i=d,n=Ct(i),vs(gt,r,Pe,t,i,n,e,!1)!==!1)return g(),r.insertBefore(Pe,d),Tt=r,v(),c(!0)}else if(i.parentNode===r){n=Ct(i);var x=0,S,T=Pe.parentNode!==r,w=!Jm(Pe.animated&&Pe.toRect||t,i.animated&&i.toRect||n,m),L=m?"top":"left",I=mf(i,"top","top")||mf(Pe,"top","top"),A=I?I.scrollTop:void 0;fn!==i&&(S=n[L],Zn=!1,fs=!w&&o.invertSwap||T),x=ag(e,i,n,m,w?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,fs,fn===i);var O;if(x!==0){var D=tr(Pe);do D-=x,O=Tt.children[D];while(O&&(qe(O,"display")==="none"||O===tt))}if(x===0||O===i)return c(!1);fn=i,Xn=x;var R=i.nextElementSibling,C=!1;C=x===1;var P=vs(gt,r,Pe,t,i,n,e,C);if(P!==!1)return(P===1||P===-1)&&(C=P===1),Jo=!0,setTimeout(rg,30),g(),C&&!R?r.appendChild(Pe):i.parentNode.insertBefore(Pe,C?R:i),I&&Ef(I,0,A-I.scrollTop),Tt=Pe.parentNode,S!==void 0&&!fs&&(ds=Math.abs(S-Ct(i)[L])),v(),c(!0)}if(r.contains(Pe))return c(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){lt(document,"mousemove",this._onTouchMove),lt(document,"touchmove",this._onTouchMove),lt(document,"pointermove",this._onTouchMove),lt(document,"dragover",Ri),lt(document,"mousemove",Ri),lt(document,"touchmove",Ri)},_offUpEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._onDrop),lt(e,"touchend",this._onDrop),lt(e,"pointerup",this._onDrop),lt(e,"touchcancel",this._onDrop),lt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,i=this.options;if(dr=tr(Pe),vi=tr(Pe,i.draggable),rr("drop",this,{evt:e}),Tt=Pe&&Pe.parentNode,dr=tr(Pe),vi=tr(Pe,i.draggable),Je.eventCanceled){this._nulling();return}un=!1,fs=!1,Zn=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),el(this.cloneId),el(this._dragStartId),this.nativeDraggable&&(lt(document,"drop",this),lt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Vn&&qe(document.body,"user-select",""),qe(Pe,"transform",""),e&&(Yn&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(gt===Tt||Ut&&Ut.lastPutMode!=="clone")&&wt&&wt.parentNode&&wt.parentNode.removeChild(wt),Pe&&(this.nativeDraggable&&lt(Pe,"dragend",this),qo(Pe),Pe.style["will-change"]="",Yn&&!un&&Ht(Pe,Ut?Ut.options.ghostClass:this.options.ghostClass,!1),Ht(Pe,this.options.chosenClass,!1),Zt({sortable:this,name:"unchoose",toEl:Tt,newIndex:null,newDraggableIndex:null,originalEvent:e}),gt!==Tt?(dr>=0&&(Zt({rootEl:Tt,name:"add",toEl:Tt,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"remove",toEl:Tt,originalEvent:e}),Zt({rootEl:Tt,name:"sort",toEl:Tt,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:Tt,originalEvent:e})),Ut&&Ut.save()):dr!==ln&&dr>=0&&(Zt({sortable:this,name:"update",toEl:Tt,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:Tt,originalEvent:e})),Je.active&&((dr==null||dr===-1)&&(dr=ln,vi=Gn),Zt({sortable:this,name:"end",toEl:Tt,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){rr("nulling",this),gt=Pe=Tt=tt=Di=wt=ss=pi=Ii=kr=Yn=dr=vi=ln=Gn=fn=Xn=Ut=os=Je.dragged=Je.ghost=Je.clone=Je.active=null,cs.forEach(function(e){e.checked=!0}),cs.length=Xo=Zo=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Pe&&(this._onDragOver(e),tg(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,i=this.el.children,t=0,n=i.length,a=this.options;t<n;t++)r=i[t],Xr(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||og(r));return e},sort:function(e,r){var i={},t=this.el;this.toArray().forEach(function(n,a){var o=t.children[a];Xr(o,this.options.draggable,t,!1)&&(i[n]=o)},this),r&&this.captureAnimationState(),e.forEach(function(n){i[n]&&(t.removeChild(i[n]),t.appendChild(i[n]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return Xr(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var i=this.options;if(r===void 0)return i[e];var t=Kn.modifyOption(this,e,r);typeof t!="undefined"?i[e]=t:i[e]=r,e==="group"&&Af(i)},destroy:function(){rr("destroy",this);var e=this.el;e[fr]=null,lt(e,"mousedown",this._onTapStart),lt(e,"touchstart",this._onTapStart),lt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(lt(e,"dragover",this),lt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),us.splice(us.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!pi){if(rr("hideClone",this),Je.eventCanceled)return;qe(wt,"display","none"),this.options.removeCloneOnHide&&wt.parentNode&&wt.parentNode.removeChild(wt),pi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(pi){if(rr("showClone",this),Je.eventCanceled)return;Pe.parentNode==gt&&!this.options.group.revertClone?gt.insertBefore(wt,Pe):Di?gt.insertBefore(wt,Di):gt.appendChild(wt),this.options.group.revertClone&&this.animate(Pe,wt),qe(wt,"display",""),pi=!1}}};function tg(s){s.dataTransfer&&(s.dataTransfer.dropEffect="move"),s.cancelable&&s.preventDefault()}function vs(s,e,r,i,t,n,a,o){var f,h=s[fr],p=h.options.onMove,l;return window.CustomEvent&&!ii&&!$n?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=e,f.from=s,f.dragged=r,f.draggedRect=i,f.related=t||e,f.relatedRect=n||Ct(e),f.willInsertAfter=o,f.originalEvent=a,s.dispatchEvent(f),p&&(l=p.call(h,f,a)),l}function qo(s){s.draggable=!1}function rg(){Jo=!1}function ig(s,e,r){var i=Ct(sn(r.el,0,r.options,!0)),t=10;return e?s.clientX<i.left-t||s.clientY<i.top&&s.clientX<i.right:s.clientY<i.top-t||s.clientY<i.bottom&&s.clientX<i.left}function ng(s,e,r){var i=Ct(Ko(r.el,r.options.draggable)),t=10;return e?s.clientX>i.right+t||s.clientX<=i.right&&s.clientY>i.bottom&&s.clientX>=i.left:s.clientX>i.right&&s.clientY>i.top||s.clientX<=i.right&&s.clientY>i.bottom+t}function ag(s,e,r,i,t,n,a,o){var f=i?s.clientY:s.clientX,h=i?r.height:r.width,p=i?r.top:r.left,l=i?r.bottom:r.right,u=!1;if(!a){if(o&&ds<h*t){if(!Zn&&(Xn===1?f>p+h*n/2:f<l-h*n/2)&&(Zn=!0),Zn)u=!0;else if(Xn===1?f<p+ds:f>l-ds)return-Xn}else if(f>p+h*(1-t)/2&&f<l-h*(1-t)/2)return sg(e)}return u=u||a,u&&(f<p+h*n/2||f>l-h*n/2)?f>p+h/2?1:-1:0}function sg(s){return tr(Pe)<tr(s)?1:-1}function og(s){for(var e=s.tagName+s.className+s.src+s.href+s.textContent,r=e.length,i=0;r--;)i+=e.charCodeAt(r);return i.toString(36)}function lg(s){cs.length=0;for(var e=s.getElementsByTagName("input"),r=e.length;r--;){var i=e[r];i.checked&&cs.push(i)}}function ms(s){return setTimeout(s,0)}function el(s){return clearTimeout(s)}hs&&ut(document,"touchmove",function(s){(Je.active||un)&&s.cancelable&&s.preventDefault()});Je.utils={on:ut,off:lt,css:qe,find:vf,is:function(e,r){return!!Xr(e,r,e,!1)},extend:Vm,throttle:yf,closest:Xr,toggleClass:Ht,clone:_f,index:tr,nextTick:ms,cancelNextTick:el,detectDirection:wf,getChild:sn};Je.get=function(s){return s[fr]};Je.mount=function(){for(var s=arguments.length,e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(Je.utils=Gr(Gr({},Je.utils),i.utils)),Kn.mount(i)})};Je.create=function(s,e){return new Je(s,e)};Je.version=jm;var It=[],Qn,tl,rl=!1,il,nl,gs,Jn;function ug(){function s(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return s.prototype={dragStarted:function(r){var i=r.originalEvent;this.sortable.nativeDraggable?ut(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ut(document,"pointermove",this._handleFallbackAutoScroll):i.touches?ut(document,"touchmove",this._handleFallbackAutoScroll):ut(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var i=r.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?lt(document,"dragover",this._handleAutoScroll):(lt(document,"pointermove",this._handleFallbackAutoScroll),lt(document,"touchmove",this._handleFallbackAutoScroll),lt(document,"mousemove",this._handleFallbackAutoScroll)),Df(),ys(),Hm()},nulling:function(){gs=tl=Qn=rl=Jn=il=nl=null,It.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,i){var t=this,n=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(n,a);if(gs=r,i||this.options.forceAutoScrollFallback||$n||ii||Vn){al(r,this.options,o,i);var f=hi(o,!0);rl&&(!Jn||n!==il||a!==nl)&&(Jn&&Df(),Jn=setInterval(function(){var h=hi(document.elementFromPoint(n,a),!0);h!==f&&(f=h,ys()),al(r,t.options,h,i)},10),il=n,nl=a)}else{if(!this.options.bubbleScroll||hi(o,!0)===Zr()){ys();return}al(r,this.options,hi(o,!1),!1)}}},Yr(s,{pluginName:"scroll",initializeByDefault:!0})}function ys(){It.forEach(function(s){clearInterval(s.pid)}),It=[]}function Df(){clearInterval(Jn)}var al=yf(function(s,e,r,i){if(!!e.scroll){var t=(s.touches?s.touches[0]:s).clientX,n=(s.touches?s.touches[0]:s).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,f=Zr(),h=!1,p;tl!==r&&(tl=r,ys(),Qn=e.scroll,p=e.scrollFn,Qn===!0&&(Qn=hi(r,!0)));var l=0,u=Qn;do{var m=u,y=Ct(m),b=y.top,_=y.bottom,g=y.left,c=y.right,v=y.width,E=y.height,d=void 0,x=void 0,S=m.scrollWidth,T=m.scrollHeight,w=qe(m),L=m.scrollLeft,I=m.scrollTop;m===f?(d=v<S&&(w.overflowX==="auto"||w.overflowX==="scroll"||w.overflowX==="visible"),x=E<T&&(w.overflowY==="auto"||w.overflowY==="scroll"||w.overflowY==="visible")):(d=v<S&&(w.overflowX==="auto"||w.overflowX==="scroll"),x=E<T&&(w.overflowY==="auto"||w.overflowY==="scroll"));var A=d&&(Math.abs(c-t)<=a&&L+v<S)-(Math.abs(g-t)<=a&&!!L),O=x&&(Math.abs(_-n)<=a&&I+E<T)-(Math.abs(b-n)<=a&&!!I);if(!It[l])for(var D=0;D<=l;D++)It[D]||(It[D]={});(It[l].vx!=A||It[l].vy!=O||It[l].el!==m)&&(It[l].el=m,It[l].vx=A,It[l].vy=O,clearInterval(It[l].pid),(A!=0||O!=0)&&(h=!0,It[l].pid=setInterval(function(){i&&this.layer===0&&Je.active._onTouchMove(gs);var R=It[this.layer].vy?It[this.layer].vy*o:0,C=It[this.layer].vx?It[this.layer].vx*o:0;typeof p=="function"&&p.call(Je.dragged.parentNode[fr],C,R,s,gs,It[this.layer].el)!=="continue"||Ef(It[this.layer].el,C,R)}.bind({layer:l}),24))),l++}while(e.bubbleScroll&&u!==f&&(u=hi(u,!1)));rl=h}},30),If=function(e){var r=e.originalEvent,i=e.putSortable,t=e.dragEl,n=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,f=e.unhideGhostForTarget;if(!!r){var h=i||n;o();var p=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,l=document.elementFromPoint(p.clientX,p.clientY);f(),h&&!h.el.contains(l)&&(a("spill"),this.onSpill({dragEl:t,putSortable:i}))}};function sl(){}sl.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var t=sn(this.sortable.el,this.startIndex,this.options);t?this.sortable.el.insertBefore(r,t):this.sortable.el.appendChild(r),this.sortable.animateAll(),i&&i.animateAll()},drop:If};Yr(sl,{pluginName:"revertOnSpill"});function ol(){}ol.prototype={onSpill:function(e){var r=e.dragEl,i=e.putSortable,t=i||this.sortable;t.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),t.animateAll()},drop:If};Yr(ol,{pluginName:"removeOnSpill"});var Sr;function fg(){function s(){this.defaults={swapClass:"sortable-swap-highlight"}}return s.prototype={dragStart:function(r){var i=r.dragEl;Sr=i},dragOverValid:function(r){var i=r.completed,t=r.target,n=r.onMove,a=r.activeSortable,o=r.changed,f=r.cancel;if(!!a.options.swap){var h=this.sortable.el,p=this.options;if(t&&t!==h){var l=Sr;n(t)!==!1?(Ht(t,p.swapClass,!0),Sr=t):Sr=null,l&&l!==Sr&&Ht(l,p.swapClass,!1)}o(),i(!0),f()}},drop:function(r){var i=r.activeSortable,t=r.putSortable,n=r.dragEl,a=t||this.sortable,o=this.options;Sr&&Ht(Sr,o.swapClass,!1),Sr&&(o.swap||t&&t.options.swap)&&n!==Sr&&(a.captureAnimationState(),a!==i&&i.captureAnimationState(),dg(n,Sr),a.animateAll(),a!==i&&i.animateAll())},nulling:function(){Sr=null}},Yr(s,{pluginName:"swap",eventProperties:function(){return{swapItem:Sr}}})}function dg(s,e){var r=s.parentNode,i=e.parentNode,t,n;!r||!i||r.isEqualNode(e)||i.isEqualNode(s)||(t=tr(s),n=tr(e),r.isEqualNode(i)&&t<n&&n++,r.insertBefore(e,r.children[t]),i.insertBefore(s,i.children[n]))}Je.mount(new ug);Je.mount(ol,sl);var qn=0,cg=1,hg=-1,yt="__PLAYER_KEY__",ll={selector:"audio-lists-panel-content-wrap",swapClass:"audio-lists-panel-sortable-highlight-bg",swap:!0,animation:100,easing:"cubic-bezier(0.43, -0.1, 0.16, 1.1)"},pg=function(e){var r=e.audioLists,i=e.onCancel,t=e.onDelete,n=e.onPlay,a=e.playId,o=e.loading,f=e.panelToggleAnimate,h=e.glassBg,p=e.remove,l=e.removeId,u=e.isMobile,m=e.locale,y=e.icon,b=e.playing;return q.createElement("div",{className:Bt("audio-lists-panel",f,{"audio-lists-panel-mobile":u,"glass-bg":h})},q.createElement("div",{className:"audio-lists-panel-header"},q.createElement("h2",{className:"audio-lists-panel-header-title"},q.createElement("span",null,m.playListsText," / "),q.createElement("span",{className:"audio-lists-panel-header-num"},r.length),q.createElement("span",{className:"audio-lists-panel-header-actions"},p&&q.createElement(q.Fragment,null,q.createElement("span",{className:"audio-lists-panel-header-delete-btn",title:m.removeAudioListsText,onClick:t()},y.delete),q.createElement("span",{className:"audio-lists-panel-header-line"})),q.createElement("span",{className:"audio-lists-panel-header-close-btn",title:m.closeText,onClick:i},u?y.packUpPanelMobile:y.close)))),q.createElement("div",{className:Bt("audio-lists-panel-content",{"no-content":r.length<1})},r.length>=1?q.createElement("ul",{className:ll.selector},r.map(function(_){var g=_.name,c=_.singer,v=_[yt],E=a===v;return q.createElement("li",{key:v,title:b&&E?m.clickToPauseText:m.clickToPlayText,className:Bt("audio-item",{playing:E},{pause:!b},{remove:l===v}),onClick:function(){return n(v)}},q.createElement("span",{className:"group player-status"},q.createElement("span",{className:"player-icons"},E&&o?y.loading:E?b?y.pause:y.play:void 0)),q.createElement("span",{className:"group player-name",title:g},g),q.createElement("span",{className:"group player-singer",title:c},c),p&&q.createElement("span",{className:"group player-delete",title:m.clickToDeleteText(g),onClick:t(v)},y.close))})):q.createElement(q.Fragment,null,q.createElement("span",null,y.empty),q.createElement("span",{className:"no-data"},m.emptyText||m.notContentText))))},vg=Ye.exports.memo(pg),mg=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.progress,i=r===void 0?0:r,t=e.r,n=t===void 0?40:t,a=i.toFixed(2),o=Math.PI*2*n,f="".concat(Math.floor(o*a)," ").concat(Math.floor(o*(1-a)));return q.createElement("svg",{className:"audio-circle-process-bar"},q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"stroke",strokeDasharray:f}),q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"bg",strokeDasharray:"0 1000"}))},gg=Ye.exports.memo(mg),yg=[{id:"fa",name:"Font Awesome",projectUrl:"https://fontawesome.com/",license:"CC BY 4.0 License",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"},{id:"io",name:"Ionicons 4",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"io5",name:"Ionicons 5",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"md",name:"Material Design icons",projectUrl:"http://google.github.io/material-design-icons/",license:"Apache License Version 2.0",licenseUrl:"https://github.com/google/material-design-icons/blob/master/LICENSE"},{id:"ti",name:"Typicons",projectUrl:"http://s-ings.com/typicons/",license:"CC BY-SA 3.0",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"},{id:"go",name:"Github Octicons icons",projectUrl:"https://octicons.github.com/",license:"MIT",licenseUrl:"https://github.com/primer/octicons/blob/master/LICENSE"},{id:"fi",name:"Feather",projectUrl:"https://feathericons.com/",license:"MIT",licenseUrl:"https://github.com/feathericons/feather/blob/master/LICENSE"},{id:"gi",name:"Game Icons",projectUrl:"https://game-icons.net/",license:"CC BY 3.0",licenseUrl:"https://creativecommons.org/licenses/by/3.0/"},{id:"wi",name:"Weather Icons",projectUrl:"https://erikflowers.github.io/weather-icons/",license:"SIL OFL 1.1",licenseUrl:"http://scripts.sil.org/OFL"},{id:"di",name:"Devicons",projectUrl:"https://vorillaz.github.io/devicons/",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ai",name:"Ant Design Icons",projectUrl:"https://github.com/ant-design/ant-design-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"bs",name:"Bootstrap Icons",projectUrl:"https://github.com/twbs/icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ri",name:"Remix Icon",projectUrl:"https://github.com/Remix-Design/RemixIcon",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"fc",name:"Flat Color Icons",projectUrl:"https://github.com/icons8/flat-color-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"gr",name:"Grommet-Icons",projectUrl:"https://github.com/grommet/grommet-icons",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"hi",name:"Heroicons",projectUrl:"https://github.com/refactoringui/heroicons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"si",name:"Simple Icons",projectUrl:"https://simpleicons.org/",license:"CC0 1.0 Universal",licenseUrl:"https://creativecommons.org/publicdomain/zero/1.0/"},{id:"im",name:"IcoMoon Free",projectUrl:"https://github.com/Keyamoon/IcoMoon-Free",license:"CC BY 4.0 License"},{id:"bi",name:"BoxIcons",projectUrl:"https://github.com/atisawd/boxicons",license:"CC BY 4.0 License"},{id:"cg",name:"css.gg",projectUrl:"https://github.com/astrit/css.gg",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"vsc",name:"VS Code Icons",projectUrl:"https://github.com/microsoft/vscode-codicons",license:"CC BY 4.0",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"}],ul={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},fl=q.createContext&&q.createContext(ul),mi=globalThis&&globalThis.__assign||function(){return mi=Object.assign||function(s){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}return s},mi.apply(this,arguments)},Eg=globalThis&&globalThis.__rest||function(s,e){var r={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,i=Object.getOwnPropertySymbols(s);t<i.length;t++)e.indexOf(i[t])<0&&Object.prototype.propertyIsEnumerable.call(s,i[t])&&(r[i[t]]=s[i[t]]);return r};function Rf(s){return s&&s.map(function(e,r){return q.createElement(e.tag,mi({key:r},e.attr),Rf(e.child))})}function _g(s){return function(e){return q.createElement(Cf,mi({attr:mi({},s.attr)},e),Rf(s.child))}}function Cf(s){var e=function(r){var i=s.attr,t=s.size,n=s.title,a=Eg(s,["attr","size","title"]),o=t||r.size||"1em",f;return r.className&&(f=r.className),s.className&&(f=(f?f+" ":"")+s.className),q.createElement("svg",mi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:f,style:mi(mi({color:s.color||r.color},r.style),s.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&q.createElement("title",null,n),s.children)};return fl!==void 0?q.createElement(fl.Consumer,null,function(r){return e(r)}):e(ul)}var xg=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",IconsManifest:yg,GenIcon:_g,IconBase:Cf,DefaultContext:ul,IconContext:fl}),Lt=Eo(xg),bg=Lt.GenIcon,Sg=function(e){return bg({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-16 328c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160zm112 0c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160z"}}]})(e)},Tg=Lt.GenIcon,wg=function(e){return Tg({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"}}]})(e)},Ag=Lt.GenIcon,Og=function(e){return Ag({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"}}]})(e)},Lg=Lt.GenIcon,Pf=function(e){return Lg({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.52 32 0 146.496 0 288v48a32 32 0 0 0 17.689 28.622l14.383 7.191C34.083 431.903 83.421 480 144 480h24c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-24c-31.342 0-59.671 12.879-80 33.627V288c0-105.869 86.131-192 192-192s192 86.131 192 192v1.627C427.671 268.879 399.342 256 368 256h-24c-13.255 0-24 10.745-24 24v176c0 13.255 10.745 24 24 24h24c60.579 0 109.917-48.098 111.928-108.187l14.382-7.191A32 32 0 0 0 512 336v-48c0-141.479-114.496-256-256-256z"}}]})(e)},Dg=Lt.GenIcon,Ig=function(e){return Dg({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M108 284c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h232c6.6 0 12 5.4 12 12v32c0 6.6-5.4 12-12 12H108zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"}}]})(e)},Rg=Lt.GenIcon,Cg=function(e){return Rg({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}}]})(e)},Pg=Lt.GenIcon,Mg=function(e){return Pg({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"}}]})(e)},kg=Lt.GenIcon,Ng=function(e){return kg({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"7 13 12 18 17 13"}},{tag:"polyline",attr:{points:"7 6 12 11 17 6"}}]})(e)},Fg=Lt.GenIcon,Bg=function(e){return Fg({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"}}]})(e)},Ug=Lt.GenIcon,jg=function(e){return Ug({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 8.02c0 1.09-.45 2.09-1.17 2.83l-.67-.67c.55-.56.89-1.31.89-2.16 0-.85-.34-1.61-.89-2.16l.67-.67A3.99 3.99 0 0 1 12 8.02zM7.72 2.28L4 6H2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h2l3.72 3.72c.47.47 1.28.14 1.28-.53V2.81c0-.67-.81-1-1.28-.53zm5.94.08l-.67.67a6.996 6.996 0 0 1 2.06 4.98c0 1.94-.78 3.7-2.06 4.98l.67.67A7.973 7.973 0 0 0 16 8c0-2.22-.89-4.22-2.34-5.66v.02zm-1.41 1.41l-.69.67a5.05 5.05 0 0 1 1.48 3.58c0 1.39-.56 2.66-1.48 3.56l.69.67A5.971 5.971 0 0 0 14 8.02c0-1.65-.67-3.16-1.75-4.25z"}}]})(e)},Wg=Lt.GenIcon,Mf=function(e){return Wg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)},zg=Lt.GenIcon,$g=function(e){return zg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 5h-3v5.5c0 1.38-1.12 2.5-2.5 2.5S10 13.88 10 12.5s1.12-2.5 2.5-2.5c.57 0 1.08.19 1.5.51V5h4v2zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"}}]})(e)},Vg=Lt.GenIcon,Hg=function(e){return Vg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}}]})(e)},Kg=Lt.GenIcon,Gg=function(e){return Kg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4zm-4-2V9h-1l-2 1v1h1.5v4H13z"}}]})(e)},Yg=Lt.GenIcon,Xg=function(e){return Yg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"}}]})(e)},Zg=Lt.GenIcon,Qg=function(e){return Zg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}}]})(e)},Jg=Lt.GenIcon,qg=function(e){return Jg({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"}}]})(e)},e0=Lt.GenIcon,t0=function(e){return e0({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"}}]}]})(e)},r0=Lt.GenIcon,i0=function(e){return r0({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0H24V24H0z"}},{tag:"path",attr:{d:"M22 18v2H2v-2h20zM2 3.5l8 5-8 5v-10zM22 11v2H12v-2h10zm0-7v2H12V4h10z"}}]}]})(e)},n0=Lt.GenIcon,a0=function(e){return n0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 9h3.5c.736 0 1.393.391 1.851 1.001.325-.604.729-1.163 1.191-1.662-.803-.823-1.866-1.339-3.042-1.339h-3.5c-.553 0-1 .448-1 1s.447 1 1 1zM11.685 12.111c.551-1.657 2.256-3.111 3.649-3.111h1.838l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-1.838c-2.274 0-4.711 1.967-5.547 4.479l-.472 1.411c-.641 1.926-2.072 3.11-2.815 3.11h-2.5c-.553 0-1 .448-1 1s.447 1 1 1h2.5c1.837 0 3.863-1.925 4.713-4.479l.472-1.41zM15.879 13.293c-.391.391-.391 1.023 0 1.414l1.293 1.293h-2.338c-1.268 0-2.33-.891-2.691-2.108-.256.75-.627 1.499-1.09 2.185.886 1.162 2.243 1.923 3.781 1.923h2.338l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0z"}}]})(e)},s0=Lt.GenIcon,o0=function(e){return s0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.707 7.404c-.189-.188-.448-.283-.707-.283s-.518.095-.707.283l-2.293 2.293v-6.697c0-.552-.448-1-1-1s-1 .448-1 1v6.697l-2.293-2.293c-.189-.188-.44-.293-.707-.293s-.518.105-.707.293c-.39.39-.39 1.024 0 1.414l4.707 4.682 4.709-4.684c.388-.387.388-1.022-.002-1.412zM20.987 16c0-.105-.004-.211-.039-.316l-2-6c-.136-.409-.517-.684-.948-.684h-.219c-.094.188-.21.368-.367.525l-1.482 1.475h1.348l1.667 5h-13.893l1.667-5h1.348l-1.483-1.475c-.157-.157-.274-.337-.367-.525h-.219c-.431 0-.812.275-.948.684l-2 6c-.035.105-.039.211-.039.316-.013 0-.013 5-.013 5 0 .553.447 1 1 1h16c.553 0 1-.447 1-1 0 0 0-5-.013-5z"}}]})(e)},l0=function(){return q.createElement(wg,{className:"react-jinke-music-player-play-icon"})},u0=function(){return q.createElement(Sg,{className:"react-jinke-music-player-pause-icon"})},f0=function(e){var r=e.prefix,i=e.visible,t=e.title,n=e.text;return q.createElement("div",{className:Bt("".concat(r,"-play-model-tip"),{show:i})},q.createElement("span",{className:"".concat(r,"-play-model-tip-title")},t),q.createElement("span",{className:"".concat(r,"-play-model-tip-text")},n))},d0=Ye.exports.memo(f0),cr="react-jinke-music-player-mobile",kf=function(e){var r=e.name,i=e.cover,t=e.singer,n=e.playing,a=e.duration,o=e.currentTime,f=e.loading,h=e.themeSwitch,p=e.progressBar,l=e.openAudioListsPanel,u=e.audioPrevPlay,m=e.audioNextPlay,y=e.playMode,b=e.onClose,_=e.playModeTipVisible,g=e.currentPlayModeName,c=e.extendsContent,v=e.onPlay,E=e.glassBg,d=e.onCoverClick,x=e.autoHiddenCover,S=e.icon,T=e.locale,w=e.toggleMode,L=e.renderAudioTitle,I=e.shouldShowPlayIcon,A=e.isResetCoverRotate;return q.createElement("div",{className:Bt(cr,{"default-bg":!E,"glass-bg":E})},q.createElement(d0,{prefix:cr,visible:_,title:y,text:g}),q.createElement("div",{className:"".concat(cr,"-header group")},q.createElement("div",{className:"".concat(cr,"-header-title"),title:r},L()),w&&q.createElement("div",{className:"".concat(cr,"-header-right"),onClick:b},S.close)),q.createElement("div",{className:"".concat(cr,"-singer text-center group")},q.createElement("span",{className:"".concat(cr,"-singer-name"),title:t},t)),q.createElement("div",{className:"".concat(cr,"-switch text-center group")},h),(!x||x&&i)&&q.createElement("div",{className:"".concat(cr,"-cover text-center"),onClick:function(){return d()}},q.createElement("img",{src:i,alt:"cover",className:Bt("cover",{"img-rotate-pause":!n||!i,"img-rotate-reset":A})})),q.createElement("div",{className:"".concat(cr,"-progress group")},q.createElement("span",{className:"current-time"},f?"--":o),q.createElement("span",{className:"".concat(cr,"-progress-bar")},p),q.createElement("span",{className:"duration text-right"},f?"--":a)),q.createElement("div",{className:"".concat(cr,"-toggle text-center group")},q.createElement("span",{className:"group prev-audio",title:T.previousTrackText,onClick:u},S.prev),f?q.createElement("span",{className:"group loading-icon"},S.loading):q.createElement("span",{className:"group play-btn",title:I?T.clickToPlayText:T.clickToPauseText,onClick:v},I?S.play:S.pause),q.createElement("span",{className:"group next-audio",title:T.nextTrackText,onClick:m},S.next)),q.createElement("div",{className:"".concat(cr,"-operation group")},q.createElement("ul",{className:"items"},[y,S.download,S.reload,S.lyric].filter(Ye.exports.isValidElement).map(function(O){return q.createElement("li",{className:"item",key:O.props.className},O)}),c,q.createElement("li",{className:"item",onClick:l},S.playLists))))};kf.defaultProps={icon:{},renderAudioTitle:function(){}};var c0=Ye.exports.memo(kf),h0=function(e){var r=e.visible,i=e.value;return q.createElement("div",{className:Bt("play-mode-title",{"play-mode-title-visible":r})},i)},p0=Ye.exports.memo(h0),v0=350,m0=32,ea={en_US:"en_US",zh_CN:"zh_CN"},Nf={MOBILE:"(max-width: 768px) and (orientation : portrait)",DARK_THEME:"screen and (prefers-color-scheme: dark)",LIGHT_THEME:"screen and (prefers-color-scheme: light)"},Tr={FULL:"full",MINI:"mini"},Ff={NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3,NETWORK_READY_SUCCESS_STATE:4},g0={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},Et={order:"order",orderLoop:"orderLoop",singleLoop:"singleLoop",shufflePlay:"shufflePlay"},wr={LIGHT:"light",DARK:"dark",AUTO:"auto"},Bf=se.oneOf(["order","orderLoop","singleLoop","shufflePlay"]),y0={audioLists:se.array.isRequired,locale:se.oneOfType([se.object,se.oneOf(Object.values(ea))]),theme:se.oneOf(Object.values(wr)),mode:se.oneOf(Object.values(Tr)),defaultPlayMode:Bf,playMode:Bf,drag:se.bool,seeked:se.bool,autoPlay:se.bool,clearPriorAudioLists:se.bool,autoPlayInitLoadPlayList:se.bool,playModeText:se.object,panelTitle:se.string,closeText:se.oneOfType([se.string,se.object]),openText:se.oneOfType([se.string,se.object]),clickToPlayText:se.oneOfType([se.string,se.object]),clickToPauseText:se.oneOfType([se.string,se.object]),nextTrackText:se.oneOfType([se.string,se.object]),previousTrackText:se.oneOfType([se.string,se.object]),reloadText:se.oneOfType([se.string,se.object]),volumeText:se.oneOfType([se.string,se.object]),playListsText:se.oneOfType([se.string,se.object]),toggleLyricText:se.oneOfType([se.string,se.object]),toggleMiniModeText:se.oneOfType([se.string,se.object]),destroyText:se.oneOfType([se.string,se.object]),downloadText:se.oneOfType([se.string,se.object]),emptyText:se.oneOfType([se.string,se.object]),controllerTitle:se.oneOfType([se.string,se.object]),defaultPosition:se.shape({top:se.oneOfType([se.number,se.string]),left:se.oneOfType([se.number,se.string]),right:se.oneOfType([se.number,se.string]),bottom:se.oneOfType([se.number,se.string])}),onAudioPlay:se.func,onAudioPause:se.func,onAudioEnded:se.func,onAudioAbort:se.func,onAudioVolumeChange:se.func,onAudioError:se.func,onAudioProgress:se.func,onAudioSeeked:se.func,onAudioDownload:se.func,onAudioReload:se.func,onThemeChange:se.func,onAudioListsChange:se.func,onPlayModeChange:se.func,onModeChange:se.func,onAudioListsPanelChange:se.func,onAudioPlayTrackChange:se.func,onAudioListsSortEnd:se.func,onAudioLyricChange:se.func,showDownload:se.bool,showPlay:se.bool,showReload:se.bool,showPlayMode:se.bool,showThemeSwitch:se.bool,showMiniModeCover:se.bool,toggleMode:se.bool,once:se.bool,extendsContent:se.oneOfType([se.array,se.bool,se.object,se.node,se.element,se.string]),checkedText:se.oneOfType([se.string,se.object]),unCheckedText:se.oneOfType([se.string,se.object]),defaultVolume:se.number,playModeShowTime:se.number,bounds:se.oneOfType([se.string,se.object]),showMiniProcessBar:se.bool,loadAudioErrorPlayNext:se.bool,preload:se.oneOfType([se.bool,se.oneOf(["auto","metadata","none"])]),glassBg:se.bool,remember:se.bool,remove:se.bool,defaultPlayIndex:se.number,playIndex:se.number,lyricClassName:se.string,emptyLyricText:se.oneOfType([se.string,se.object]),showLyric:se.bool,getContainer:se.func,getAudioInstance:se.func,onBeforeAudioDownload:se.func,autoHiddenCover:se.bool,spaceBar:se.bool,showDestroy:se.bool,onBeforeDestroy:se.func,onDestroyed:se.func,customDownloader:se.func,audioTitle:se.oneOfType([se.string,se.func]),responsive:se.bool,quietUpdate:se.bool,renderAudioTitle:se.func,mobileMediaQuery:se.string,volumeFade:se.shape({fadeIn:se.number,fadeOut:se.number}),sortableOptions:se.object},E0={min:0,step:1},_0={min:0,max:1,step:.01},Nr={IN:"in",OUT:"out",NONE:"none"},x0={playModeText:{order:"Play in order",orderLoop:"List loop",singleLoop:"Single loop",shufflePlay:"Shuffle playback"},openText:"Open",closeText:"Close",emptyText:"No music",clickToPlayText:"Click to play",clickToPauseText:"Click to pause",nextTrackText:"Next track",previousTrackText:"Previous track",reloadText:"Reload",volumeText:"Volume",playListsText:"Playlists",toggleLyricText:"Toggle lyric",toggleMiniModeText:"Minimize",destroyText:"Destroy",downloadText:"Download",lightThemeText:"L",darkThemeText:"D",switchThemeText:"Dark/Light mode",removeAudioListsText:"Delete audio lists",clickToDeleteText:function(e){return"Click to delete ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"No lyric",loadingText:"Loading"},b0={playModeText:{order:"\u987A\u5E8F\u64AD\u653E",orderLoop:"\u5217\u8868\u5FAA\u73AF",singleLoop:"\u5355\u66F2\u5FAA\u73AF",shufflePlay:"\u968F\u673A\u64AD\u653E"},openText:"\u6253\u5F00",closeText:"\u5173\u95ED",emptyText:"\u97F3\u4E50\u64AD\u653E\u5217\u8868\u4E3A\u7A7A",clickToPlayText:"\u70B9\u51FB\u64AD\u653E",clickToPauseText:"\u70B9\u51FB\u6682\u505C",nextTrackText:"\u4E0B\u4E00\u9996",previousTrackText:"\u4E0A\u4E00\u9996",reloadText:"\u91CD\u65B0\u64AD\u653E",volumeText:"\u97F3\u91CF",playListsText:"\u64AD\u653E\u5217\u8868",toggleLyricText:"\u663E\u793A/\u9690\u85CF \u6B4C\u8BCD",toggleMiniModeText:"\u5207\u6362\u81F3\u8FF7\u4F60\u6A21\u5F0F",destroyText:"\u79FB\u9664\u64AD\u653E\u5668",downloadText:"\u4E0B\u8F7D",lightThemeText:"\u4EAE",darkThemeText:"\u6697",switchThemeText:"\u6697\u9ED1/\u660E\u4EAE \u4E3B\u9898",removeAudioListsText:"\u6E05\u7A7A\u64AD\u653E\u5217\u8868",clickToDeleteText:function(e){return"\u70B9\u51FB\u5220\u9664 ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"\u6682\u65E0\u6B4C\u8BCD",loadingText:"\u52A0\u8F7D\u4E2D"},Es;function Uf(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var S0=(Es={},Uf(Es,ea.en_US,x0),Uf(Es,ea.zh_CN,b0),Es),jf=S0;function T0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Wf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function w0(s,e,r){return e&&Wf(s.prototype,e),r&&Wf(s,r),s}var zf=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g,$f=0,_s=1,Vf={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"},A0=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};T0(this,s),this.lrc=e,this.tags={},this.lines=[],this.handler=r,this.state=$f,this.curLine=0,this._init()}return w0(s,[{key:"_init",value:function(){this._initTag(),this._initLines()}},{key:"_initTag",value:function(){for(var r in Vf){var i=this.lrc.match(new RegExp("\\[".concat(Vf[r],":([^\\]]*)]"),"i"));this.tags[r]=i&&i[1]||""}}},{key:"_initLines",value:function(){for(var r=this.lrc.split(`
`),i=parseInt(this.tags.offset,10)||0,t=0;t<r.length;t++){var n=r[t],a=zf.exec(n);if(a){var o=n.replace(zf,"").trim();o&&this.lines.push({time:a[1]*60*1e3+a[2]*1e3+(a[3]||0)*10+i,txt:o})}}this.lines.sort(function(f,h){return f.time-h.time})}},{key:"_findCurNum",value:function(r){for(var i=0;i<this.lines.length;i++)if(r<=this.lines[i].time)return i;return this.lines.length-1}},{key:"_callHandler",value:function(r){r<0||this.handler({txt:this.lines[r].txt,lineNum:r})}},{key:"_playRest",value:function(){var r=this,i=this.lines[this.curNum],t=i.time-(+new Date-this.startStamp);this.timer=setTimeout(function(){r._callHandler(r.curNum++),r.curNum<r.lines.length&&r.state===_s&&r._playRest()},t)}},{key:"play",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;!this.lines.length||(this.state=_s,this.curNum=this._findCurNum(r),this.startStamp=+new Date-r,i||this._callHandler(this.curNum-1),this.curNum<this.lines.length&&(clearTimeout(this.timer),this._playRest()))}},{key:"togglePlay",value:function(){var r=+new Date;this.state===_s?(this.stop(),this.pauseStamp=r):(this.state=_s,this.play((this.pauseStamp||r)-(this.startStamp||r),!0),this.pauseStamp=0)}},{key:"stop",value:function(){this.state=$f,clearTimeout(this.timer)}},{key:"seek",value:function(r){this.play(r)}}]),s}();function Hf(s){var e=0,r=0,i=parseInt(s);i>=60&&(e=parseInt(i/60),i=parseInt(i%60),e>=60&&(r=parseInt(e/60),e=parseInt(e%60)));var t=function(a){return a>>0<10?"0".concat(a):a};return r>0?[t(r),t(e),t(i)].join(":"):[t(e),t(i)].join(":")}function O0(s,e){return parseInt(Math.random()*(e-s+1)+s,10)}var L0=function(e){return function(r){return JSON.stringify(e)===JSON.stringify(r)}},gi=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},Kf=function(){return"".concat(gi()+gi(),"-").concat(gi(),"-").concat(gi(),"-").concat(gi(),"-").concat(gi()).concat(gi()).concat(gi())},D0=function(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)};function I0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function R0(s){return .5-Math.cos(s*Math.PI)/2}function Gf(s,e,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},t=i.duration,n=t===void 0?1e3:t,a=i.easing,o=a===void 0?R0:a,f=i.interval,h=f===void 0?13:f,p=arguments.length>4?arguments[4]:void 0,l=r-e;if(!l||!n||!o||!h||I0())return s.volume=r,p(),{fadeInterval:void 0,updateIntervalEndVolume:void 0};var u=Math.floor(n/h),m=1,y=function(g){r=g},b=setInterval(function(){var _=r-e;_!==l&&(l=_),s.volume=e+o(m/u)*l,++m>=u&&(s.volume=r,clearInterval(b),p())},h);return{fadeInterval:b,updateIntervalEndVolume:y}}function dn(){return dn=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},dn.apply(this,arguments)}function C0(s,e){if(s==null)return{};var r=P0(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function P0(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Yf(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function ht(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yf(Object(r),!0).forEach(function(i){me(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Yf(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function cn(s){return F0(s)||N0(s)||k0(s)||M0()}function M0(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k0(s,e){if(!!s){if(typeof s=="string")return dl(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dl(s,e)}}function N0(s){if(typeof Symbol!="undefined"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function F0(s){if(Array.isArray(s))return dl(s)}function dl(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function yi(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yi=function(r){return typeof r}:yi=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yi(s)}function B0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Xf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function U0(s,e,r){return e&&Xf(s.prototype,e),r&&Xf(s,r),s}function j0(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&cl(s,e)}function cl(s,e){return cl=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},cl(s,e)}function W0(s){var e=$0();return function(){var i=xs(s),t;if(e){var n=xs(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return z0(this,t)}}function z0(s,e){return e&&(yi(e)==="object"||typeof e=="function")?e:ye(s)}function ye(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function $0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function xs(s){return xs=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},xs(s)}function me(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}Je.mount(new fg);var hl=_p(),Zf={pause:q.createElement(u0,null),play:q.createElement(l0,null),destroy:q.createElement(Mf,null),close:q.createElement(Mf,null),delete:q.createElement(t0,{size:24}),download:q.createElement(o0,{size:26}),toggle:q.createElement(Ig,null),lyric:q.createElement(Og,null),volume:q.createElement(jg,{size:26}),mute:q.createElement(Bg,{size:26}),next:q.createElement(qg,null),prev:q.createElement(Xg,null),playLists:q.createElement(i0,null),reload:q.createElement(Mg,{size:22}),loop:q.createElement(Gg,{size:26}),order:q.createElement(Qg,{size:26}),orderLoop:q.createElement(Hg,{size:26}),shuffle:q.createElement(a0,{size:26}),loading:q.createElement(Cg,null),packUpPanelMobile:q.createElement(Ng,{size:26}),empty:q.createElement($g,null)},pl=function(s){j0(r,s);var e=W0(r);function r(i){var t;return B0(this,r),t=e.call(this,i),me(ye(t),"isDrag",!1),me(ye(t),"initPlayId",""),me(ye(t),"state",{audioLists:[],playId:t.initPlayId,name:"",cover:"",singer:"",musicSrc:"",lyric:"",currentLyric:"",isMobile:hl,toggle:t.props.mode===Tr.FULL,playing:!1,currentTime:0,soundValue:cg,moveX:0,moveY:0,loading:!1,audioListsPanelVisible:!1,playModelNameVisible:!1,theme:t.props.theme||t.darkThemeName,playMode:t.props.playMode||t.props.defaultPlayMode||"",currentAudioVolume:0,initAnimate:!1,isInitAutoPlay:t.props.autoPlay,isInitRemember:!1,loadedProgress:0,removeId:hg,isNeedMobileHack:hl,audioLyricVisible:!1,isAutoPlayWhenUserClicked:!1,playIndex:t.props.playIndex||t.props.defaultPlayIndex||qn,canPlay:!1,currentVolumeFade:Nr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0,isAudioSeeking:!1,isResetCoverRotate:!1}),me(ye(t),"getPlayIndex",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.playIndex,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.state.audioLists;return Math.max(qn,Math.min(a.length-1,n))}),me(ye(t),"onCoverClick",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tr.FULL,a=t.props.showMiniModeCover,o=t.state.cover;!a&&n===Tr.MINI||t.props.onCoverClick&&o&&t.props.onCoverClick(n,t.state.audioLists,t.getBaseAudioInfo())}),me(ye(t),"getAudioTitle",function(){var n=t.locale||{},a=n.audioTitle,o=t.state,f=o.name,h=o.singer;return typeof a=="function"&&t.audio?a(t.getBaseAudioInfo()):a||"".concat(f).concat(h?" - ".concat(h):"")}),me(ye(t),"renderAudioTitle",function(){var n=t.state,a=n.isMobile,o=n.name;return t.props.renderAudioTitle?t.props.renderAudioTitle(t.getBaseAudioInfo(),a):a?o:t.getAudioTitle()}),me(ye(t),"toggleAudioLyric",function(){t.setState({audioLyricVisible:!t.state.audioLyricVisible})}),me(ye(t),"togglePlayMode",function(){var n=t._PLAY_MODE_.findIndex(function(o){return o===t.state.playMode}),a=n===t._PLAY_MODE_LENGTH_-1?t._PLAY_MODE_[0]:t._PLAY_MODE_[++n];t.setState({playMode:a,playModelNameVisible:!0,playModeTipVisible:!0}),t.props.onPlayModeChange&&t.props.onPlayModeChange(a),clearTimeout(t.playModelTimer),t.playModelTimer=setTimeout(function(){t.setState({playModelNameVisible:!1,playModeTipVisible:!1})},t.props.playModeShowTime)}),me(ye(t),"renderPlayModeIcon",function(n){var a={className:"react-jinke-music-player-mode-icon"},o=null;switch(n){case Et.order:o=Ye.exports.cloneElement(t.iconMap.order,a);break;case Et.orderLoop:o=Ye.exports.cloneElement(t.iconMap.orderLoop,a);break;case Et.singleLoop:o=Ye.exports.cloneElement(t.iconMap.loop,a);break;case Et.shufflePlay:o=Ye.exports.cloneElement(t.iconMap.shuffle,a);break;default:o=Ye.exports.cloneElement(t.iconMap.order,a)}return o}),me(ye(t),"audioListsPlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.state,f=o.playId,h=o.playing,p=o.audioLists,l=o.loading,u=o.canPlay;if(Array.isArray(p)&&p.length===0)return console.warn("Warning: Your playlist has no songs. and cannot play !");if(!(l&&n===f)){var m=p.findIndex(function(x){return x[yt]===n}),y=p[m]||{},b=y.name,_=y.cover,g=y.musicSrc,c=y.singer,v=y.lyric,E=v===void 0?"":v,d=function(S){t.setState({name:b,cover:_,musicSrc:S,singer:c,playId:n,lyric:E,currentTime:0,playing:!1,loading:!0,canPlay:!1,loadedProgress:0,playIndex:m,isAutoPlayWhenUserClicked:!0},function(){t.lyric&&t.lyric.stop(),t.audio.load(),t.updateMediaSessionMetadata(),setTimeout(function(){t.initLyricParser()},0)})};if(n===f&&!a){if(t.setState({playing:!h}),!h){if(u){t.play();return}return d(g)}return t.audio.pause()}switch(t.props.onAudioPlayTrackChange&&t.props.onAudioPlayTrackChange(n,p,t.getBaseAudioInfo()),t.props.onPlayIndexChange&&t.props.onPlayIndexChange(m),yi(g)){case"function":g().then(d,t.onAudioError);break;default:d(g)}}}),me(ye(t),"resetAudioStatus",function(){t.audio.pause(),t.lyric&&t.lyric.stop(),t.initPlayInfo([]),t.resetAudioPlayStatus(),t.resetAudioPlayId()}),me(ye(t),"resetAudioPlayId",function(){t.setState({playId:t.initPlayId})}),me(ye(t),"clearAudioLists",function(){t.props.onAudioListsChange&&t.props.onAudioListsChange("",[],{}),t.resetAudioStatus()}),me(ye(t),"onDeleteAudioLists",function(n){return function(a){a.stopPropagation();var o=t.state,f=o.audioLists,h=o.playId;if(!(f.length<1)){if(t.lyric&&t.lyric.stop(),!n){t.clearAudioLists();return}var p=cn(f).filter(function(l){return l[yt]!==n});t.setState({removeId:n}),setTimeout(function(){t.setState({audioLists:p,removeId:-1},function(){if(!p.length)return t.resetAudioStatus();n===h&&t.handlePlay(Et.orderLoop)})},v0),t.props.onAudioListsChange&&t.props.onAudioListsChange(h,p,t.getBaseAudioInfo())}}}),me(ye(t),"openAudioListsPanel",function(){t.setState(function(n){var a=n.audioListsPanelVisible;return{initAnimate:!0,audioListsPanelVisible:!a}}),t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!t.state.audioListsPanelVisible)}),me(ye(t),"closeAudioListsPanel",function(n){n.stopPropagation(),t._closeAudioListsPanel()}),me(ye(t),"_closeAudioListsPanel",function(){var n=t.state.audioListsPanelVisible;t.setState({audioListsPanelVisible:!1}),n&&t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!1)}),me(ye(t),"themeChange",function(n){var a=n?wr.LIGHT:wr.DARK;t.setState({theme:a}),t.props.onThemeChange&&t.props.onThemeChange(a)}),me(ye(t),"onAudioDownload",function(){var n=t.state.musicSrc;if(t.state.musicSrc){var a=t.props.customDownloader,o=t.getBaseAudioInfo(),f=t.props.onBeforeAudioDownload(o),h={};f&&f.then?f.then(function(p){var l=p.src,u=p.filename,m=p.mimeType;h=p,a?a(p):mu(l,u,m)}):a?a({src:n}):mu(n),t.props.onAudioDownload&&t.props.onAudioDownload(o,h)}}),me(ye(t),"onControllerDrag",function(n,a){var o=a.x,f=a.y,h=t.state,p=h.moveX,l=h.moveY;t.isDrag=!0,p===o&&l===f&&(t.isDrag=!1)}),me(ye(t),"onControllerDragStart",function(n,a){var o=a.x,f=a.y;t.isDrag=!1,t.setState({moveX:o,moveY:f})}),me(ye(t),"onControllerDragStop",function(n,a){var o=a.x,f=a.y;if(t.props.showDestroy&&t.destroyBtn&&t.destroyBtn.current&&t.destroyBtn.current.contains(n.target)){t.onDestroyPlayer();return}t.isDrag||(t.state.isNeedMobileHack&&(t.loadAndPlayAudio(),t.setState({isNeedMobileHack:!1})),t.onOpenPanel()),t.setState({moveX:o,moveY:f})}),me(ye(t),"onResetVolume",function(){var n=t.state.currentAudioVolume;t.setAudioVolume(t.getVolumeBarValue(n||.1))}),me(ye(t),"setAudioVolume",function(n){t.audio.volume=t.getListeningVolume(n),t.setState({currentAudioVolume:n,soundValue:n}),t.state.currentVolumeFade===Nr.IN&&t.state.updateIntervalEndVolume&&t.state.updateIntervalEndVolume(n)}),me(ye(t),"stopAll",function(n){n.stopPropagation(),n.preventDefault()}),me(ye(t),"getBoundingClientRect",function(n){var a=n.getBoundingClientRect(),o=a.left,f=a.top;return{left:o,top:f}}),me(ye(t),"getListeningVolume",function(n){return Math.pow(n,2)}),me(ye(t),"getVolumeBarValue",function(n){return Math.sqrt(n)}),me(ye(t),"onAudioReload",function(){t.props.audioLists.length&&(t.handlePlay(Et.singleLoop),t.props.onAudioReload&&t.props.onAudioReload(t.getBaseAudioInfo()))}),me(ye(t),"onOpenPanel",function(){var n=t.props,a=n.toggleMode,o=n.spaceBar;a&&(t.setState({toggle:!0}),t.props.onModeChange&&t.props.onModeChange(Tr.FULL),o&&t.player.current&&t.player.current.focus({preventScroll:!0})),t.onCoverClick(Tr.MINI)}),me(ye(t),"onHidePanel",function(){t.setState({toggle:!1,audioListsPanelVisible:!1}),t.props.onModeChange&&t.props.onModeChange(Tr.MINI)}),me(ye(t),"onDestroyPlayer",function(){if(t.props.onBeforeDestroy){var n=Promise.resolve(t.props.onBeforeDestroy(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()));n&&n.then&&n.then(function(){t._onDestroyPlayer()}).catch(function(){});return}t._onDestroyPlayer()}),me(ye(t),"_onDestroyPlayer",function(){t.unInstallPlayer()}),me(ye(t),"_onDestroyed",function(){t.setState({isPlayDestroyed:!0}),t.props.onDestroyed&&t.props.onDestroyed(t.state.playId,t.state.audioLists,t.getBaseAudioInfo())}),me(ye(t),"getCurrentPlayIndex",function(){return t.state.audioLists.findIndex(function(n){return n[yt]===t.state.playId})}),me(ye(t),"resetAudioPlayStatus",function(){return new Promise(function(n){t.setState({currentTime:0,loading:!1,playing:!1,canPlay:!1,lyric:"",currentLyric:"",loadedProgress:0,playIndex:qn},n)})}),me(ye(t),"onTogglePlay",function(){if(t.setState({isAudioSeeking:!1}),t.state.audioLists.length>=1){var n=t.props.volumeFade||{},a=n.fadeIn,o=n.fadeOut,f=t.state,h=f.currentVolumeFade,p=f.currentVolumeFadeInterval,l=h===Nr.IN||h===Nr.OUT;if(l&&(clearInterval(p),t.setState({currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0})),!l&&t.state.playing||h===Nr.IN){t.setState({currentVolumeFade:Nr.OUT});var u=Gf(t.audio,t.audio.volume,0,{duration:o},function(){t.audio.pause(),t.setState({currentVolumeFade:Nr.NONE,currentVolumeFadeInterval:void 0,playing:!1,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),m=u.fadeInterval,y=u.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:m,updateIntervalEndVolume:y})}else{t.setState({currentVolumeFade:Nr.IN});var b=l?t.audio.volume:0,_=t.getListeningVolume(t.state.soundValue),g=Gf(t.audio,b,_,{duration:a},function(){t.setState({currentVolumeFade:Nr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),c=g.fadeInterval,v=g.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:c,updateIntervalEndVolume:v,isAutoPlayWhenUserClicked:!0},function(){c&&(t.audio.volume=b),t.loadAndPlayAudio()})}}}),me(ye(t),"playAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;(t.isAudioCanPlay||n)&&(n&&t.setAudioLoaded(),t.loadAndPlayAudio(n))}),me(ye(t),"setAudioLoaded",function(){t.setState({loading:!1,playing:!1})}),me(ye(t),"onAudioPause",function(){t.setState({playing:!1}),t.props.onAudioPause&&t.props.onAudioPause(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay()}),me(ye(t),"onAudioPlay",function(){t.state.isAudioSeeking||(t.setState({playing:!0,loading:!1}),t.props.onAudioPlay&&t.props.onAudioPlay(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay())}),me(ye(t),"onSetAudioLoadedProgress",function(){var n=t.audio,a=n.buffered,o=n.duration;if(a.length&&a.end){var f=a.end(a.length-1)/o*100;t.setState({loadedProgress:f})}}),me(ye(t),"loadAndPlayAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=t.props.remember,o=t.state,f=o.isInitRemember,h=o.musicSrc,p=t.audio,l=p.networkState,u=p.readyState;if(!!h){if(l===Ff.NETWORK_NO_SOURCE||l===Ff.NETWORK_EMPTY)return t.onAudioError({reason:`
          [loadAndPlayAudio]: Failed to load because no supported source was found.
          current network status is `.concat(l,`.
        `)});if(t.setState({playing:!1,loading:!0,isAudioSeeking:!1,isResetCoverRotate:!1}),n||u>=g0.HAVE_FUTURE_DATA){var m=t.getLastPlayStatus(),y=m.playing,b=a&&!f&&!y,_=a?!b:t.isAudioCanPlay;t.setState({playing:_,loading:!1},function(){_&&t.play(),t.setState({isInitAutoPlay:!0,isInitRemember:!0,isAutoPlayWhenUserClicked:!1})})}else t.audio.load()}}),me(ye(t),"onAudioError",function(n){var a=t.state,o=a.playMode,f=a.audioLists,h=a.playId,p=a.musicSrc,l=t.props.loadAudioErrorPlayNext,u=o===Et.singleLoop,m=u?Et.order:o;if(t.lyric&&t.lyric.stop(),p){if(l&&f.length){var y=(o===Et.order||o===Et.orderLoop)&&h===f[f.length-1][yt];y||t.handlePlay(m,!0)}t.props.onAudioError&&t.props.onAudioError(t.audio.error||n&&n.reason||null,h,f,t.getBaseAudioInfo())}}),me(ye(t),"handlePlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=t.state,f=o.playId,h=o.audioLists,p=h.length;if(!!p){var l=t.getCurrentPlayIndex();switch(n){case Et.order:if(l===p-1){t.audio.pause();return}t.audioListsPlay(a?h[l+1][yt]:h[l-1][yt]);break;case Et.orderLoop:if(a){if(l===p-1)return t.audioListsPlay(h[0][yt]);t.audioListsPlay(h[l+1][yt])}else{if(l===0)return t.audioListsPlay(h[p-1][yt]);t.audioListsPlay(h[l-1][yt])}break;case Et.singleLoop:t.audio.currentTime=0,t.audioListsPlay(f,!0);break;case Et.shufflePlay:{var u=O0(0,p-1);u===t.getCurrentPlayIndex()&&(u=t.getPlayIndex(u+1));var m=(h[u]||{})[yt];t.audioListsPlay(m,!0)}break}}}),me(ye(t),"onAudioEnd",function(){t.props.onAudioEnded&&t.props.onAudioEnded(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()),t.handlePlay(t.state.playMode)}),me(ye(t),"audioPrevAndNextBasePlayHandle",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=t.state.playMode,o="";switch(a){case Et.shufflePlay:o=a;break;default:o=Et.orderLoop;break}t.handlePlay(o,n)}),me(ye(t),"onPlayPrevAudio",function(){var n=t.props.restartCurrentOnPrev;if(n&&t.audio.currentTime>1){t.audio.currentTime=0;return}t.audioPrevAndNextBasePlayHandle(!1)}),me(ye(t),"onPlayNextAudio",function(){t.audioPrevAndNextBasePlayHandle(!0)}),me(ye(t),"audioTimeUpdate",function(){var n=t.audio.currentTime;t.setState({currentTime:n}),t.props.remember&&t.saveLastPlayStatus(),t.props.onAudioProgress&&t.props.onAudioProgress(t.getBaseAudioInfo())}),me(ye(t),"onAudioSoundChange",function(n){t.setAudioVolume(n)}),me(ye(t),"onAudioVolumeChange",function(){var n=t.audio.volume,a=t.state,o=a.currentVolumeFade,f=a.currentAudioVolume;if(!(o!==Nr.NONE||f===n)){var h=t.getVolumeBarValue(n);if(t.setState({soundValue:h}),t.props.onAudioVolumeChange){var p=parseFloat(n.toFixed(4));t.props.onAudioVolumeChange(p)}}}),me(ye(t),"onProgressChange",function(n){t.audio&&(t.audio.currentTime=n),t.setState({currentTime:n,isAudioSeeking:!0})}),me(ye(t),"onAudioSeeked",function(n){t.setState({isAudioSeeking:!0}),!!t.state.audioLists.length&&(t.lyric&&t.lyric.seek(n*1e3),t.state.playing||t.lyric&&t.lyric.stop(),t.audio&&(t.audio.currentTime=n),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo()),setTimeout(function(){t.setState({isAudioSeeking:!1})},500))}),me(ye(t),"onAudioMute",function(){t.setState({soundValue:0,currentAudioVolume:t.audio.volume},function(){t.audio.volume=0})}),me(ye(t),"onAudioAbort",function(n){var a=t.state,o=a.audioLists,f=a.playId,h=t.getBaseAudioInfo(),p=ht(ht({},n),h);t.props.onAudioAbort&&t.props.onAudioAbort(f,o,p)}),me(ye(t),"toggleMode",function(n){n===Tr.FULL&&t.setState({toggle:!0})}),me(ye(t),"toggleTheme",function(n){t.setState({theme:n})}),me(ye(t),"onAudioListsSortEnd",function(n){var a=n.oldIndex,o=n.newIndex;if(a!==o){var f=t.state,h=f.playId,p=f.audioLists,l=cn(p),u=l.splice(a,1)[0];l.splice(o,0,u);var m=a===h?o:h;t.setState({audioLists:l,playId:m}),t.props.onAudioListsSortEnd&&t.props.onAudioListsSortEnd(a,o),t.props.onAudioListsChange&&t.props.onAudioListsChange(m,l,t.getBaseAudioInfo()),t.props.onAudioListsDragEnd&&(console.warn("[Deprecated] onAudioListsDragEnd is deprecated. please use onAudioListsSortEnd(oldIndex, newIndex){}"),t.props.onAudioListsDragEnd(a,o))}}),me(ye(t),"saveLastPlayStatus",function(){var n=t.state,a=n.currentTime,o=n.playId,f=n.theme,h=n.soundValue,p=n.playMode,l=n.name,u=n.cover,m=n.singer,y=n.musicSrc,b=JSON.stringify({currentTime:a,playId:o,theme:f,playMode:p,soundValue:h,name:l,cover:u,singer:m,musicSrc:y});localStorage.setItem("lastPlayStatus",b)}),me(ye(t),"getLastPlayStatus",function(){var n=t.props,a=n.theme,o=n.defaultPlayMode,f=n.playMode,h=n.defaultPlayIndex,p=n.playIndex,l={currentTime:0,playMode:f||o||Et.order,name:"",cover:"",singer:"",musicSrc:"",lyric:"",playId:t.getDefaultPlayId(),theme:a,playing:!0,playIndex:p||h||0};try{return JSON.parse(localStorage.getItem("lastPlayStatus"))||l}catch(u){return l}}),me(ye(t),"checkCurrentPlayingAudioIsInUpdatedAudioLists",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props,a=t.state,o=a.playId,f=a.musicSrc;return!n.quietUpdate||!Array.isArray(n.audioLists)?!1:o&&n.audioLists.some(function(h){return h[yt]===o||h.musicSrc===f})}),me(ye(t),"play",function(){var n=t.audio.play();n&&n.then&&n.then(function(){t.setState({loading:!1,playing:!0})}).catch(function(){t.setState({loading:!1,playing:!1})})}),me(ye(t),"mockAutoPlayForMobile",function(){t.props.autoPlay&&!t.state.playing&&(t.audio.load(),t.play())}),me(ye(t),"bindMobileAutoPlayEvents",function(){document.addEventListener("touchstart",function(){t.mockAutoPlayForMobile()},{once:!0}),document.addEventListener("WeixinJSBridgeReady",function(){t.mockAutoPlayForMobile()})}),me(ye(t),"bindSafariAutoPlayEvents",function(){document.addEventListener("click",function(){t.mockAutoPlayForMobile()},{once:!0})}),me(ye(t),"unBindEvents",function(){var n;(n=t).bindEvents.apply(n,arguments)}),me(ye(t),"bindEvents",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.audio,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{waiting:t.loadAndPlayAudio,canplay:t.onAudioCanPlay,error:t.onAudioError,ended:t.onAudioEnd,pause:t.onAudioPause,play:t.onAudioPlay,timeupdate:t.audioTimeUpdate,volumechange:t.onAudioVolumeChange,abort:t.onAudioAbort,progress:t.onSetAudioLoadedProgress},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=t.props.once;for(var h in a){var p=a[h];n&&(o?n.addEventListener(h,p,{once:!!(f&&h==="play")}):n.removeEventListener(h,p))}}),me(ye(t),"getPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.audioLists,a=t.getPlayIndex(void 0,n),o=t.state.playId||n[a]&&n[a][yt];return o}),me(ye(t),"_getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=t.getPlayId(n),o=n.find(function(c){return c[yt]===a})||{},f=o.name,h=f===void 0?"":f,p=o.cover,l=p===void 0?"":p,u=o.singer,m=u===void 0?"":u,y=o.musicSrc,b=y===void 0?"":y,_=o.lyric,g=_===void 0?"":_;return{name:h,cover:l,singer:m,musicSrc:b,lyric:g,audioLists:n,playId:a}}),me(ye(t),"getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=n.filter(function(h){return!h[yt]}),o=n.filter(function(h){return h[yt]}),f=[].concat(cn(o),cn(a.map(function(h){return ht(ht({},h),{},me({},yt,Kf()))})));return t._getPlayInfo(f)}),me(ye(t),"getPlayInfoOfNewList",function(n){var a=n.audioLists,o=a===void 0?[]:a,f=o.map(function(h){var p=n.quietUpdate&&t.state.audioLists.find(function(l){var u=l.musicSrc;return u===h.musicSrc})||{};return ht(ht({},h),{},me({},yt,p[yt]||Kf()))});return t._getPlayInfo(f)}),me(ye(t),"initPlayInfo",function(n,a){var o=t.getPlayInfo(n);switch(yi(o.musicSrc)){case"function":o.musicSrc().then(function(f){t.setState(ht(ht({},o),{},{musicSrc:f}),a)},t.onAudioError);break;default:t.setState(o,a)}}),me(ye(t),"addMatchMediaListener",function(n,a){var o=window.matchMedia(n);return a(o),"addEventListener"in o?o.addEventListener("change",a):o.addListener(a),o}),me(ye(t),"removeMatchMediaListener",function(n,a){n&&("removeEventListener"in n?n.removeEventListener("change",a):n.removeListener&&n.removeListener(a))}),me(ye(t),"addMobileListener",function(){t.mobileMedia=t.addMatchMediaListener(t.props.mobileMediaQuery,t.mobileMediaHandler)}),me(ye(t),"removeMobileListener",function(){t.removeMatchMediaListener(t.mobileMedia,t.mobileMediaHandler)}),me(ye(t),"addSystemThemeListener",function(){t.systemThemeMedia=t.addMatchMediaListener(Nf.DARK_THEME,t.systemThemeMediaHandler)}),me(ye(t),"removeSystemThemeListener",function(){t.removeMatchMediaListener(t.systemThemeMedia,t.systemThemeMediaHandler)}),me(ye(t),"mobileMediaHandler",function(n){var a=n.matches;t.setState({isMobile:!!a})}),me(ye(t),"systemThemeMediaHandler",function(n){var a=n.matches;if(t.props.theme===wr.AUTO){var o=a?wr.DARK:wr.LIGHT;t.updateTheme(o)}}),me(ye(t),"setDefaultAudioVolume",function(){var n=t.props,a=n.defaultVolume,o=n.remember;t.defaultVolume=Math.max(0,Math.min(a,1));var f=t.getLastPlayStatus(),h=f.soundValue,p=h===void 0?t.defaultVolume:h;t.setAudioVolume(o?p:t.defaultVolume)}),me(ye(t),"getDefaultPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=t.getPlayIndex();return n[a]&&n[a][yt]}),me(ye(t),"initLyricParser",function(){t.lyric=new A0(t.state.lyric,t.onLyricChange),t.setState({currentLyric:t.lyric.lines[0]&&t.lyric.lines[0].text})}),me(ye(t),"onLyricChange",function(n){var a=n.lineNum,o=n.txt;t.setState({currentLyric:o}),t.props.onAudioLyricChange&&t.props.onAudioLyricChange(a,o)}),me(ye(t),"updateTheme",function(n){n&&n!==t.props.theme&&Object.values(wr).includes(n)&&t.setState({theme:n})}),me(ye(t),"updateMode",function(n){n&&n!==t.props.mode&&Object.values(Tr).includes(n)&&(t.setState({toggle:n===Tr.FULL}),n===Tr.MINI&&t._closeAudioListsPanel())}),me(ye(t),"updatePlayMode",function(n){!Object.values(Et).includes(n)||n!==t.props.playMode&&t.setState({playMode:n})}),me(ye(t),"updateAudioLists",function(n){var a=[].concat(cn(t.state.audioLists),cn(n.filter(function(o){return t.state.audioLists.findIndex(function(f){return f.musicSrc===o.musicSrc})===-1})));t.initPlayInfo(a),t.bindEvents(t.audio),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n,t.getBaseAudioInfo())}),me(ye(t),"loadNewAudioLists",function(n){var a=n.audioLists,o=n.remember,f=n.playMode,h=n.theme,p=n.autoPlayInitLoadPlayList,l=n.playIndex;if(!(!Array.isArray(a)||!a.length)){var u=t.getPlayInfoOfNewList(n),m=o?t.getLastPlayStatus():{playMode:f||Et.order,playIndex:l||qn};h!==wr.AUTO&&(m.theme=h);var y=ht(ht(ht({},u),m),{},{isInitAutoPlay:p,playing:t.isAudioCanPlay});if(t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)){t.setState({audioLists:u.audioLists});return}switch(yi(u.musicSrc)){case"function":u.musicSrc().then(function(b){t.setState(ht(ht({},y),{},{musicSrc:b}))},t.onAudioError);break;default:t.setState(y)}}}),me(ye(t),"resetPlayId",function(){return new Promise(function(n){t.setState({playId:t.initPlayId},n)})}),me(ye(t),"changeAudioLists",function(n){t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)||t.resetAudioStatus(),t.resetPlayId().then(function(){t.loadNewAudioLists(n),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n.audioLists,t.getBaseAudioInfo())})}),me(ye(t),"updatePlayIndex",function(n){var a=t.getCurrentPlayIndex();n!==void 0&&a!==n&&t.resetAudioPlayStatus().then(function(){var o=t.state.audioLists[t.getPlayIndex(n)];o&&o[yt]&&t.audioListsPlay(o[yt],!0)})}),me(ye(t),"playByIndex",function(n){t.updatePlayIndex(n)}),me(ye(t),"getEnhanceAudio",function(){var n=ye(t),a=n.audio;return[{name:"destroy",value:t.onDestroyPlayer},{name:"updatePlayIndex",value:t.updatePlayIndex},{name:"playByIndex",value:t.playByIndex},{name:"playNext",value:t.onPlayNextAudio},{name:"playPrev",value:t.onPlayPrevAudio},{name:"togglePlay",value:t.onTogglePlay},{name:"clear",value:t.clearAudioLists},{name:"sortable",value:t.sortable}].forEach(function(o){var f=o.name,h=o.value;Object.defineProperty(a,f,{value:h,writable:!1})}),a}),me(ye(t),"onGetAudioInstance",function(){t.props.getAudioInstance&&t.props.getAudioInstance(t.getEnhanceAudio())}),me(ye(t),"updateMediaSessionMetadata",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=t.state,a=n.name,o=n.cover,f=n.singer,h={title:a,artist:f,album:a};o&&(h.artwork=["96x96","128x128","192x192","256x256","384x384","512x512"].map(function(p){return{src:o,sizes:p,type:"image/png"}})),navigator.mediaSession.metadata=new MediaMetadata(h),t.updateMediaSessionPositionState()}}),me(ye(t),"updateMediaSessionPositionState",function(){if("setPositionState"in navigator.mediaSession)try{var n=ye(t),a=n.audio;navigator.mediaSession.setPositionState({duration:t.audioDuration,playbackRate:a.playbackRate||1,position:a.currentTime||0})}catch(o){console.error("Update media session position state failed: ",o)}}),me(ye(t),"onAddMediaSession",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=10;navigator.mediaSession.setActionHandler("play",t.onTogglePlay),navigator.mediaSession.setActionHandler("pause",t.onTogglePlay),navigator.mediaSession.setActionHandler("seekbackward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.max(t.audio.currentTime-o,0),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("seekforward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.min(t.audio.currentTime+o,t.audioDuration),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("previoustrack",t.onPlayPrevAudio),navigator.mediaSession.setActionHandler("nexttrack",t.onPlayNextAudio),setTimeout(function(){t.updateMediaSessionMetadata()},0);try{navigator.mediaSession.setActionHandler("seekto",function(a){if(a.fastSeek&&"fastSeek"in t.audio){t.audio.fastSeek(a.seekTime);return}t.audio.currentTime=a.seekTime,t.updateMediaSessionPositionState()})}catch(a){console.warn('Warning! The "seekto" media session action is not supported.')}}}),me(ye(t),"bindUnhandledRejection",function(){window.addEventListener("unhandledrejection",t.onAudioError)}),me(ye(t),"unBindUnhandledRejection",function(){window.removeEventListener("unhandledrejection",t.onAudioError)}),me(ye(t),"bindKeyDownEvents",function(){t.props.spaceBar&&t.player.current&&(t.player.current.addEventListener("keydown",t.onKeyDown,!1),t.player.current.focus({preventScroll:!0}))}),me(ye(t),"unBindKeyDownEvents",function(){t.player.current&&t.player.current.removeEventListener("keydown",t.onKeyDown,!1)}),me(ye(t),"onKeyDown",function(n){var a=t.props.spaceBar;a&&n.keyCode===m0&&t.onTogglePlay()}),me(ye(t),"initPlayer",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;o&&t.setDefaultAudioVolume(),!(!Array.isArray(n)||!n.length)&&(t.bindUnhandledRejection(),t.bindEvents(t.audio),t.initLyricParser(),t.onAddMediaSession(),hl?t.bindMobileAutoPlayEvents():(a&&t.bindKeyDownEvents(),D0()&&t.bindSafariAutoPlayEvents()))}),me(ye(t),"removeLyric",function(){t.lyric&&(t.lyric.stop(),t.lyric=void 0)}),me(ye(t),"unInstallPlayer",function(){t.unBindEvents(t.audio,void 0,!1),t.unBindUnhandledRejection(),t.unBindKeyDownEvents(),t.removeMobileListener(),t.removeLyric(),t._onDestroyed(),t.sortable&&t.sortable.destroy()}),me(ye(t),"onAudioCanPlay",function(){t.state.isAudioSeeking||t.setState({canPlay:!0},function(){t.playAudio(!0)})}),me(ye(t),"initSortableAudioLists",function(){var n=t.props,a=n.audioLists,o=n.sortableOptions,f=ll.selector,h=C0(ll,["selector"]),p=document.querySelector(".".concat(f));Array.isArray(a)&&!a.length||!p||(t.sortable&&t.sortable.destroy(),t.sortable=new Je(p,ht(ht({onEnd:t.onAudioListsSortEnd},h),o)))}),t.audio=null,t.targetId="music-player-controller",t._PLAY_MODE_=Object.values(Et),t._PLAY_MODE_LENGTH_=t._PLAY_MODE_.length,t.player=Ye.exports.createRef(),t.destroyBtn=Ye.exports.createRef(),t}return U0(r,[{key:"locale",get:function(){var t=this.props.locale;return typeof t=="string"?jf[this.props.locale]:t?ht(ht({},jf[ea.en_US]),t):{}}},{key:"audioDuration",get:function(){var t=this.state,n=t.audioLists,a=t.playId;if(!n.length||!this.audio)return 0;var o=n.find(function(h){return h[yt]===a})||{},f=o.duration;return Math.max(Number(f)||this.audio.duration||0,0)}},{key:"isAudioCanPlay",get:function(){var t=this.props.autoPlay,n=this.state,a=n.isInitAutoPlay,o=n.isAutoPlayWhenUserClicked,f=n.canPlay;return f&&(a||t||o)}},{key:"iconMap",get:function(){var t=this,n=function(){return q.createElement("span",{className:"loading group"},t.props.icon.loading)};return ht(ht(ht({},Zf),this.props.icon),{},{loading:q.createElement(n,null)})}},{key:"render",value:function(){var t=this,n=this.props,a=n.className,o=n.drag,f=n.style,h=n.showDownload,p=n.showPlay,l=n.showReload,u=n.showPlayMode,m=n.showThemeSwitch,y=n.toggleMode,b=n.showMiniModeCover,_=n.extendsContent,g=n.defaultPlayMode,c=n.seeked,v=n.showProgressLoadBar,E=n.bounds,d=n.defaultPosition,x=n.showMiniProcessBar,S=n.preload,T=n.glassBg,w=n.remove,L=n.lyricClassName,I=n.showLyric,A=n.getContainer,O=n.autoHiddenCover,D=n.showDestroy,R=n.responsive,C=this.locale,P=this.state,M=P.toggle,N=P.playing,B=P.currentTime,U=P.soundValue,F=P.moveX,j=P.moveY,$=P.loading,G=P.audioListsPanelVisible,Y=P.theme,X=P.name,ie=P.cover,pe=P.singer,ue=P.musicSrc,we=P.playId,de=P.isMobile,oe=P.playMode,De=P.playModeTipVisible,Ce=P.playModelNameVisible,Ue=P.initAnimate,Me=P.loadedProgress,ze=P.audioLists,Ge=P.removeId,Ke=P.currentLyric,He=P.audioLyricVisible,Fe=P.isPlayDestroyed,Se=P.isResetCoverRotate,Xe=S===!1||S==="none"?{}:S===!0?{preload:"auto"}:{preload:S},st=Ue?{show:G,hide:!G}:{show:G},et=Et[oe||g]||Et.order,ot=C.playModeText[et],nt=b&&!O||O&&ie?{style:{backgroundImage:"url(".concat(ie,")")}}:{},dt=Hf(B),ne=Hf(this.audioDuration),Ee=c?{onChange:this.onProgressChange,onAfterChange:this.onAudioSeeked}:{},xe=q.createElement(q.Fragment,null,v&&q.createElement("div",{className:"progress-load-bar",style:{width:"".concat(Math.min(Me,100),"%")}}),q.createElement(Bo,dn({max:Math.ceil(this.audioDuration),defaultValue:0,value:Math.ceil(B)},Ee,E0))),Ae=h&&q.createElement("span",{className:"group audio-download",onClick:this.onAudioDownload,title:C.downloadText},this.iconMap.download),be=m&&q.createElement("span",{className:"group theme-switch"},q.createElement(Hu,{className:"theme-switch-container",onChange:this.themeChange,checkedChildren:C.lightThemeText,unCheckedChildren:C.darkThemeText,checked:Y===wr.LIGHT,title:C.switchThemeText})),je=l&&q.createElement("span",{className:"group reload-btn",onClick:this.onAudioReload,title:C.reloadText},this.iconMap.reload),V=I&&q.createElement("span",{className:Bt("group lyric-btn",{"lyric-btn-active":He}),onClick:this.toggleAudioLyric,title:C.toggleLyricText},this.iconMap.lyric),he=u&&q.createElement("span",{className:Bt("group loop-btn"),onClick:this.togglePlayMode,title:C.playModeText[et]},this.renderPlayModeIcon(et)),_e=de?30:40,Ie=D&&q.createElement("span",{title:C.destroyText,className:"group destroy-btn",ref:this.destroyBtn,onClick:!o||M?this.onDestroyPlayer:void 0},this.iconMap.destroy),Z=q.createElement("div",{className:Bt("react-jinke-music-player"),style:d,tabIndex:"-1"},q.createElement("div",{className:Bt("music-player")},x&&q.createElement(gg,{progress:B/this.audioDuration,r:_e}),q.createElement("div",dn({id:this.targetId,className:Bt("scale","music-player-controller",{"music-player-playing":N})},nt,{onClick:o?void 0:this.onOpenPanel}),$?this.iconMap.loading:q.createElement(q.Fragment,null,q.createElement("span",{className:"controller-title"},C.controllerTitle),q.createElement("div",{className:"music-player-controller-setting"},M?C.closeText:C.openText))),Ie)),fe=A()||document.body,W=this.getAudioTitle();if(Fe)return null;var ge=!N||this.state.currentVolumeFade===Nr.OUT;return Mn.exports.createPortal(q.createElement("div",{className:Bt("react-jinke-music-player-main",{"light-theme":Y===wr.LIGHT,"dark-theme":Y===wr.DARK},a),style:f,ref:this.player,tabIndex:"-1"},M&&de&&R&&q.createElement(c0,{playing:N,loading:$,name:X,singer:pe,cover:ie,themeSwitch:be,duration:ne,currentTime:dt,progressBar:xe,onPlay:this.onTogglePlay,currentPlayModeName:ot,playMode:he,audioNextPlay:this.onPlayNextAudio,audioPrevPlay:this.onPlayPrevAudio,icon:ht(ht({},this.iconMap),{},{reload:je,download:Ae,lyric:V}),playModeTipVisible:De,openAudioListsPanel:this.openAudioListsPanel,onClose:this.onHidePanel,extendsContent:_,glassBg:T,autoHiddenCover:O,onCoverClick:this.onCoverClick,locale:C,toggleMode:y,renderAudioTitle:this.renderAudioTitle,shouldShowPlayIcon:ge,isResetCoverRotate:Se}),M?void 0:o?q.createElement(uf,{bounds:E,position:{x:F,y:j},onDrag:this.onControllerDrag,onStop:this.onControllerDragStop,onStart:this.onControllerDragStart},Z):Z,M&&(!de||!R)&&q.createElement("div",{className:Bt("music-player-panel","translate",{"glass-bg":T})},q.createElement("section",{className:"panel-content"},(!O||O&&ie)&&q.createElement("div",{className:Bt("img-content","img-rotate",{"img-rotate-pause":!N||!ie,"img-rotate-reset":Se}),style:{backgroundImage:"url(".concat(ie,")")},onClick:function(){return t.onCoverClick()}}),q.createElement("div",{className:"progress-bar-content"},q.createElement("span",{className:"audio-title",title:W},this.renderAudioTitle()),q.createElement("section",{className:"audio-main"},q.createElement("span",{className:"current-time",title:dt},$?"--":dt),q.createElement("div",{className:"progress-bar"},xe),q.createElement("span",{className:"duration",title:ne},$?"--":ne))),q.createElement("div",{className:"player-content"},p?q.createElement("span",{className:"group"},q.createElement("span",{className:"group prev-audio",title:C.previousTrackText,onClick:this.onPlayPrevAudio},this.iconMap.prev),$?q.createElement("span",{className:"group loading-icon",title:C.loadingText},this.iconMap.loading):q.createElement("span",{className:"group play-btn",onClick:this.onTogglePlay,title:ge?C.clickToPlayText:C.clickToPauseText},ge?this.iconMap.play:this.iconMap.pause),q.createElement("span",{className:"group next-audio",title:C.nextTrackText,onClick:this.onPlayNextAudio},this.iconMap.next)):$&&this.iconMap.loading,je,Ae,be,_||null,q.createElement("span",{className:"group play-sounds",title:C.volumeText},U===0?q.createElement("span",{className:"sounds-icon",onClick:this.onResetVolume},this.iconMap.mute):q.createElement("span",{className:"sounds-icon",onClick:this.onAudioMute},this.iconMap.volume),q.createElement(Bo,dn({value:U,onChange:this.onAudioSoundChange,className:"sound-operation"},_0))),he,V,q.createElement("span",{className:"group audio-lists-btn",title:C.playListsText,onClick:this.openAudioListsPanel},q.createElement("span",{className:"audio-lists-icon"},this.iconMap.playLists),q.createElement("span",{className:"audio-lists-num"},ze.length)),y&&q.createElement("span",{className:"group hide-panel",title:C.toggleMiniModeText,onClick:this.onHidePanel},this.iconMap.toggle),Ie))),q.createElement(vg,{playing:N,playId:we,loading:$,visible:G,audioLists:ze,onPlay:this.audioListsPlay,onCancel:this.closeAudioListsPanel,icon:this.iconMap,isMobile:de,panelToggleAnimate:st,glassBg:T,cover:ie,remove:w,onDelete:this.onDeleteAudioLists,removeId:Ge,locale:C}),!de&&q.createElement(p0,{visible:Ce,value:ot}),He&&q.createElement(uf,null,q.createElement("div",{className:Bt("music-player-lyric",L)},Ke||C.emptyLyricText)),q.createElement("audio",dn({className:"music-player-audio",title:W},Xe,{src:ue,ref:function(k){t.audio=k}}))),fe)}},{key:"getBaseAudioInfo",value:function(){var t=this.state,n=t.cover,a=t.name,o=t.musicSrc,f=t.soundValue,h=t.lyric,p=t.audioLists,l=t.currentLyric,u=this.audio||{},m=u.currentTime,y=u.muted,b=u.networkState,_=u.readyState,g=u.played,c=u.paused,v=u.ended,E=u.startDate,d=this.getCurrentPlayIndex(),x=p[d]||{};return ht(ht({},x),{},{cover:n,name:a,musicSrc:o,volume:f,currentTime:m,duration:this.audioDuration,muted:y,networkState:b,readyState:_,played:g,paused:c,ended:v,startDate:E,lyric:h,currentLyric:l,playIndex:d})}},{key:"componentDidUpdate",value:function(t,n){n.musicSrc!==this.state.musicSrc&&this.setState({isResetCoverRotate:!0})}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){var n=this,a=t.audioLists,o=t.playIndex,f=t.theme,h=t.mode,p=t.playMode,l=t.clearPriorAudioLists,u=L0(a)(this.props.audioLists);u||(l?this.changeAudioLists(t):this.updateAudioLists(a),this.checkCurrentPlayingAudioIsInUpdatedAudioLists(t)||this.initPlayer(a,!1,!1),setTimeout(function(){return n.initSortableAudioLists()},200)),this.updatePlayIndex(!u&&l?qn:o),this.updateTheme(f),this.updateMode(h),this.updatePlayMode(p)}},{key:"UNSAFE_componentWillMount",value:function(){var t=this,n=this.props,a=n.audioLists,o=n.remember;if(Array.isArray(a)&&a.length>=1){var f=this.getPlayInfo(a),h=o?this.getLastPlayStatus():{};switch(yi(f.musicSrc)){case"function":f.musicSrc().then(function(p){t.setState(ht(ht({},f),{},{musicSrc:p},h))},this.onAudioError);break;default:this.setState(ht(ht({},f),h))}}}},{key:"componentWillUnmount",value:function(){this.unInstallPlayer()}},{key:"componentDidMount",value:function(){this.addMobileListener(),this.addSystemThemeListener(),this.initPlayer(),this.initSortableAudioLists(),this.onGetAudioInstance()}}]),r}(Ye.exports.PureComponent);me(pl,"defaultProps",{audioLists:[],theme:wr.DARK,mode:Tr.MINI,defaultPlayMode:Et.order,defaultPosition:{left:0,top:0},once:!1,drag:!0,toggleMode:!0,showMiniModeCover:!0,showDownload:!0,showPlay:!0,showReload:!0,showPlayMode:!0,showThemeSwitch:!0,showLyric:!1,playModeTipVisible:!1,autoPlay:!0,defaultVolume:1,showProgressLoadBar:!0,seeked:!0,playModeShowTime:600,bounds:"body",showMiniProcessBar:!1,loadAudioErrorPlayNext:!0,preload:!1,glassBg:!1,remember:!1,remove:!0,defaultPlayIndex:0,getContainer:function(){return document.body},autoHiddenCover:!1,onBeforeAudioDownload:function(){},spaceBar:!1,showDestroy:!1,showMediaSession:!1,locale:ea.en_US,responsive:!0,icon:Zf,quietUpdate:!1,mobileMediaQuery:Nf.MOBILE,volumeFade:{fadeIn:0,fadeOut:0},restartCurrentOnPrev:!1,sortableOptions:{}});me(pl,"propTypes",y0);const Qf=4,V0=[],H0=({file:s})=>{const{lastFiles:e,getSetting:r}=Ye.exports.useContext($r),i=Xh("light","dark"),{t,i18n:n}=kn(),[a,o]=q.useState([]),f=ui(),[h,p]=dp("volume",.5),l=hu({base:!0,md:!1}),u=r("music cover")||"https://store.heytapimage.com/cdo-portal/feedback/202110/30/d43c41c5d257c9bc36366e310374fb19.png",m=t("unknown"),[y,b]=q.useState(0);return Ye.exports.useEffect(()=>{const _={name:s.name,musicSrc:f(),cover:u,singer:m};s.thumbnail&&(_.cover=s.thumbnail);const g=e.filter(c=>c.type===Qf).map(c=>{let v=f(c);const E={name:c.name,musicSrc:v,cover:u,singer:m};return c.thumbnail&&(E.cover=c.thumbnail),E});g.length>0?o(g):o([_]),b(g.findIndex(c=>c.name===s.name))},[]),q.createElement(Xi,{className:"audio-box",w:"full"},q.createElement(Zi,{p:"8",w:"full"},q.createElement(Ra,{display:"inline-flex",alignItems:"center"},q.createElement(Nn,{color:r("icon color")||"#1890ff",as:Pa(s.type,"")}),t("Enjoy the music"),"...")),q.createElement(pl,{audioLists:a,theme:i,locale:n.language==="zh"?"zh_CN":"en_US",mode:"full",autoPlay:r("autoplay audio")==="true",defaultPosition:{left:20,bottom:20},playIndex:y,onPlayIndexChange:b,sortableOptions:{disabled:l},defaultVolume:h,onAudioVolumeChange:_=>p(_)}))};var K0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:Qf,exts:V0,default:H0}),vl={},bs={},ml={exports:{}},G0="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y0=G0,X0=Y0;function Jf(){}function qf(){}qf.resetWarningCache=Jf;var Z0=function(){function s(i,t,n,a,o,f){if(f!==X0){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}s.isRequired=s;function e(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:e,element:s,elementType:s,instanceOf:e,node:s,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:qf,resetWarningCache:Jf};return r.PropTypes=r,r};ml.exports=Z0();var ed={},ta={},Ar={exports:{}},td={exports:{}},Q0=void 0,rd=function(s){return s!==Q0&&s!==null},J0=rd,q0={object:!0,function:!0,undefined:!0},ey=function(s){return J0(s)?hasOwnProperty.call(q0,typeof s):!1},ty=ey,ry=function(s){if(!ty(s))return!1;try{return s.constructor?s.constructor.prototype===s:!1}catch(e){return!1}},iy=ry,ny=function(s){if(typeof s!="function"||!hasOwnProperty.call(s,"length"))return!1;try{if(typeof s.length!="number"||typeof s.call!="function"||typeof s.apply!="function")return!1}catch(e){return!1}return!iy(s)},ay=ny,sy=/^\s*class[\s{/}]/,oy=Function.prototype.toString,ly=function(s){return!(!ay(s)||sy.test(oy.call(s)))},uy=function(){var s=Object.assign,e;return typeof s!="function"?!1:(e={foo:"raz"},s(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},fy=function(){try{return Object.keys("primitive"),!0}catch(s){return!1}},dy=function(){},cy=dy(),gl=function(s){return s!==cy&&s!==null},hy=gl,py=Object.keys,vy=function(s){return py(hy(s)?Object(s):s)},my=fy()?Object.keys:vy,gy=gl,yy=function(s){if(!gy(s))throw new TypeError("Cannot use null or undefined");return s},Ey=my,_y=yy,xy=Math.max,by=function(s,e){var r,i,t=xy(arguments.length,2),n;for(s=Object(_y(s)),n=function(a){try{s[a]=e[a]}catch(o){r||(r=o)}},i=1;i<t;++i)e=arguments[i],Ey(e).forEach(n);if(r!==void 0)throw r;return s},Sy=uy()?Object.assign:by,Ty=gl,wy=Array.prototype.forEach,Ay=Object.create,Oy=function(s,e){var r;for(r in s)e[r]=s[r]},Ly=function(s){var e=Ay(null);return wy.call(arguments,function(r){!Ty(r)||Oy(Object(r),e)}),e},yl="razdwatrzy",Dy=function(){return typeof yl.contains!="function"?!1:yl.contains("dwa")===!0&&yl.contains("foo")===!1},Iy=String.prototype.indexOf,Ry=function(s){return Iy.call(this,s,arguments[1])>-1},Cy=Dy()?String.prototype.contains:Ry,Ss=rd,id=ly,nd=Sy,ad=Ly,ra=Cy,Py=td.exports=function(s,e){var r,i,t,n,a;return arguments.length<2||typeof s!="string"?(n=e,e=s,s=null):n=arguments[2],Ss(s)?(r=ra.call(s,"c"),i=ra.call(s,"e"),t=ra.call(s,"w")):(r=t=!0,i=!1),a={value:e,configurable:r,enumerable:i,writable:t},n?nd(ad(n),a):a};Py.gs=function(s,e,r){var i,t,n,a;return typeof s!="string"?(n=r,r=e,e=s,s=null):n=arguments[3],Ss(e)?id(e)?Ss(r)?id(r)||(n=r,r=void 0):r=void 0:(n=e,e=r=void 0):e=void 0,Ss(s)?(i=ra.call(s,"c"),t=ra.call(s,"e")):(i=!0,t=!1),a={get:e,set:r,configurable:i,enumerable:t},n?nd(ad(n),a):a};var My=function(s){if(typeof s!="function")throw new TypeError(s+" is not a function");return s};(function(s,e){var r=td.exports,i=My,t=Function.prototype.apply,n=Function.prototype.call,a=Object.create,o=Object.defineProperty,f=Object.defineProperties,h=Object.prototype.hasOwnProperty,p={configurable:!0,enumerable:!1,writable:!0},l,u,m,y,b,_,g;l=function(c,v){var E;return i(v),h.call(this,"__ee__")?E=this.__ee__:(E=p.value=a(null),o(this,"__ee__",p),p.value=null),E[c]?typeof E[c]=="object"?E[c].push(v):E[c]=[E[c],v]:E[c]=v,this},u=function(c,v){var E,d;return i(v),d=this,l.call(this,c,E=function(){m.call(d,c,E),t.call(v,this,arguments)}),E.__eeOnceListener__=v,this},m=function(c,v){var E,d,x,S;if(i(v),!h.call(this,"__ee__"))return this;if(E=this.__ee__,!E[c])return this;if(d=E[c],typeof d=="object")for(S=0;x=d[S];++S)(x===v||x.__eeOnceListener__===v)&&(d.length===2?E[c]=d[S?0:1]:d.splice(S,1));else(d===v||d.__eeOnceListener__===v)&&delete E[c];return this},y=function(c){var v,E,d,x,S;if(!!h.call(this,"__ee__")&&(x=this.__ee__[c],!!x))if(typeof x=="object"){for(E=arguments.length,S=new Array(E-1),v=1;v<E;++v)S[v-1]=arguments[v];for(x=x.slice(),v=0;d=x[v];++v)t.call(d,this,S)}else switch(arguments.length){case 1:n.call(x,this);break;case 2:n.call(x,this,arguments[1]);break;case 3:n.call(x,this,arguments[1],arguments[2]);break;default:for(E=arguments.length,S=new Array(E-1),v=1;v<E;++v)S[v-1]=arguments[v];t.call(x,this,S)}},b={on:l,once:u,off:m,emit:y},_={on:r(l),once:r(u),off:r(m),emit:r(y)},g=f({},_),s.exports=e=function(c){return c==null?a(g):f(Object(c),_)},e.methods=b})(Ar,Ar.exports);var Be={},ia={},ni={},Ci={};function El(s,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(s):s}var sd=El({HTML:"text/html",isHTML:function(s){return s===sd.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),od=El({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===od.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ci.freeze=El;Ci.MIME_TYPE=sd;Ci.NAMESPACE=od;var ky=Ci,na=ky.NAMESPACE;function Ny(s){return s!==""}function Fy(s){return s?s.split(/[\t\n\f\r ]+/).filter(Ny):[]}function By(s,e){return s.hasOwnProperty(e)||(s[e]=!0),s}function ld(s){if(!s)return[];var e=Fy(s);return Object.keys(e.reduce(By,{}))}function Uy(s){return function(e){return s&&s.indexOf(e)!==-1}}function aa(s,e){for(var r in s)e[r]=s[r]}function ir(s,e){var r=s.prototype;if(!(r instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,aa(r,i),s.prototype=r=i}r.constructor!=s&&(typeof s!="function"&&console.error("unknown Class:"+s),r.constructor=s)}var nr={},Fr=nr.ELEMENT_NODE=1,hn=nr.ATTRIBUTE_NODE=2,Ts=nr.TEXT_NODE=3,ud=nr.CDATA_SECTION_NODE=4,fd=nr.ENTITY_REFERENCE_NODE=5,jy=nr.ENTITY_NODE=6,dd=nr.PROCESSING_INSTRUCTION_NODE=7,cd=nr.COMMENT_NODE=8,hd=nr.DOCUMENT_NODE=9,pd=nr.DOCUMENT_TYPE_NODE=10,ai=nr.DOCUMENT_FRAGMENT_NODE=11,Wy=nr.NOTATION_NODE=12,Gt={},Nt={};Gt.INDEX_SIZE_ERR=(Nt[1]="Index size error",1);Gt.DOMSTRING_SIZE_ERR=(Nt[2]="DOMString size error",2);var zy=Gt.HIERARCHY_REQUEST_ERR=(Nt[3]="Hierarchy request error",3);Gt.WRONG_DOCUMENT_ERR=(Nt[4]="Wrong document",4);Gt.INVALID_CHARACTER_ERR=(Nt[5]="Invalid character",5);Gt.NO_DATA_ALLOWED_ERR=(Nt[6]="No data allowed",6);Gt.NO_MODIFICATION_ALLOWED_ERR=(Nt[7]="No modification allowed",7);var $y=Gt.NOT_FOUND_ERR=(Nt[8]="Not found",8);Gt.NOT_SUPPORTED_ERR=(Nt[9]="Not supported",9);var vd=Gt.INUSE_ATTRIBUTE_ERR=(Nt[10]="Attribute in use",10);Gt.INVALID_STATE_ERR=(Nt[11]="Invalid state",11);Gt.SYNTAX_ERR=(Nt[12]="Syntax error",12);Gt.INVALID_MODIFICATION_ERR=(Nt[13]="Invalid modification",13);Gt.NAMESPACE_ERR=(Nt[14]="Invalid namespace",14);Gt.INVALID_ACCESS_ERR=(Nt[15]="Invalid access",15);function Pi(s,e){if(e instanceof Error)var r=e;else r=this,Error.call(this,Nt[s]),this.message=Nt[s],Error.captureStackTrace&&Error.captureStackTrace(this,Pi);return r.code=s,e&&(this.message=this.message+": "+e),r}Pi.prototype=Error.prototype;aa(Gt,Pi);function si(){}si.prototype={length:0,item:function(s){return this[s]||null},toString:function(s,e){for(var r=[],i=0;i<this.length;i++)vn(this[i],r,s,e);return r.join("")}};function pn(s,e){this._node=s,this._refresh=e,_l(this)}function _l(s){var e=s._node._inc||s._node.ownerDocument._inc;if(s._inc!=e){var r=s._refresh(s._node);Id(s,"length",r.length),aa(r,s),s._inc=e}}pn.prototype.item=function(s){return _l(this),this[s]};ir(pn,si);function ws(){}function md(s,e){for(var r=s.length;r--;)if(s[r]===e)return r}function gd(s,e,r,i){if(i?e[md(e,i)]=r:e[e.length++]=r,s){r.ownerElement=s;var t=s.ownerDocument;t&&(i&&xd(t,s,i),Vy(t,s,r))}}function yd(s,e,r){var i=md(e,r);if(i>=0){for(var t=e.length-1;i<t;)e[i]=e[++i];if(e.length=t,s){var n=s.ownerDocument;n&&(xd(n,s,r),r.ownerElement=null)}}else throw Pi($y,new Error(s.tagName+"@"+r))}ws.prototype={length:0,item:si.prototype.item,getNamedItem:function(s){for(var e=this.length;e--;){var r=this[e];if(r.nodeName==s)return r}},setNamedItem:function(s){var e=s.ownerElement;if(e&&e!=this._ownerElement)throw new Pi(vd);var r=this.getNamedItem(s.nodeName);return gd(this._ownerElement,this,s,r),r},setNamedItemNS:function(s){var e=s.ownerElement,r;if(e&&e!=this._ownerElement)throw new Pi(vd);return r=this.getNamedItemNS(s.namespaceURI,s.localName),gd(this._ownerElement,this,s,r),r},removeNamedItem:function(s){var e=this.getNamedItem(s);return yd(this._ownerElement,this,e),e},removeNamedItemNS:function(s,e){var r=this.getNamedItemNS(s,e);return yd(this._ownerElement,this,r),r},getNamedItemNS:function(s,e){for(var r=this.length;r--;){var i=this[r];if(i.localName==e&&i.namespaceURI==s)return i}return null}};function Ed(){}Ed.prototype={hasFeature:function(s,e){return!0},createDocument:function(s,e,r){var i=new oa;if(i.implementation=this,i.childNodes=new si,i.doctype=r||null,r&&i.appendChild(r),e){var t=i.createElementNS(s,e);i.appendChild(t)}return i},createDocumentType:function(s,e,r){var i=new Os;return i.name=s,i.nodeName=s,i.publicId=e||"",i.systemId=r||"",i}};function Yt(){}Yt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(s,e){return Sd(this,s,e)},replaceChild:function(s,e){this.insertBefore(s,e),e&&this.removeChild(e)},removeChild:function(s){return bd(this,s)},appendChild:function(s){return this.insertBefore(s,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(s){return Ll(this.ownerDocument||this,this,s)},normalize:function(){for(var s=this.firstChild;s;){var e=s.nextSibling;e&&e.nodeType==Ts&&s.nodeType==Ts?(this.removeChild(e),s.appendData(e.data)):(s.normalize(),s=e)}},isSupported:function(s,e){return this.ownerDocument.implementation.hasFeature(s,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(s){for(var e=this;e;){var r=e._nsMap;if(r){for(var i in r)if(r[i]==s)return i}e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(s){for(var e=this;e;){var r=e._nsMap;if(r&&s in r)return r[s];e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(s){var e=this.lookupPrefix(s);return e==null}};function _d(s){return s=="<"&&"&lt;"||s==">"&&"&gt;"||s=="&"&&"&amp;"||s=='"'&&"&quot;"||"&#"+s.charCodeAt()+";"}aa(nr,Yt);aa(nr,Yt.prototype);function sa(s,e){if(e(s))return!0;if(s=s.firstChild)do if(sa(s,e))return!0;while(s=s.nextSibling)}function oa(){}function Vy(s,e,r){s&&s._inc++;var i=r.namespaceURI;i===na.XMLNS&&(e._nsMap[r.prefix?r.localName:""]=r.value)}function xd(s,e,r,i){s&&s._inc++;var t=r.namespaceURI;t===na.XMLNS&&delete e._nsMap[r.prefix?r.localName:""]}function xl(s,e,r){if(s&&s._inc){s._inc++;var i=e.childNodes;if(r)i[i.length++]=r;else{for(var t=e.firstChild,n=0;t;)i[n++]=t,t=t.nextSibling;i.length=n}}}function bd(s,e){var r=e.previousSibling,i=e.nextSibling;return r?r.nextSibling=i:s.firstChild=i,i?i.previousSibling=r:s.lastChild=r,xl(s.ownerDocument,s),e}function Sd(s,e,r){var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===ai){var t=e.firstChild;if(t==null)return e;var n=e.lastChild}else t=n=e;var a=r?r.previousSibling:s.lastChild;t.previousSibling=a,n.nextSibling=r,a?a.nextSibling=t:s.firstChild=t,r==null?s.lastChild=n:r.previousSibling=n;do t.parentNode=s;while(t!==n&&(t=t.nextSibling));return xl(s.ownerDocument||s,s),e.nodeType==ai&&(e.firstChild=e.lastChild=null),e}function Hy(s,e){var r=e.parentNode;if(r){var i=s.lastChild;r.removeChild(e);var i=s.lastChild}var i=s.lastChild;return e.parentNode=s,e.previousSibling=i,e.nextSibling=null,i?i.nextSibling=e:s.firstChild=e,s.lastChild=e,xl(s.ownerDocument,s,e),e}oa.prototype={nodeName:"#document",nodeType:hd,doctype:null,documentElement:null,_inc:1,insertBefore:function(s,e){if(s.nodeType==ai){for(var r=s.firstChild;r;){var i=r.nextSibling;this.insertBefore(r,e),r=i}return s}return this.documentElement==null&&s.nodeType==Fr&&(this.documentElement=s),Sd(this,s,e),s.ownerDocument=this,s},removeChild:function(s){return this.documentElement==s&&(this.documentElement=null),bd(this,s)},importNode:function(s,e){return Dd(this,s,e)},getElementById:function(s){var e=null;return sa(this.documentElement,function(r){if(r.nodeType==Fr&&r.getAttribute("id")==s)return e=r,!0}),e},getElementsByClassName:function(s){var e=ld(s);return new pn(this,function(r){var i=[];return e.length>0&&sa(r.documentElement,function(t){if(t!==r&&t.nodeType===Fr){var n=t.getAttribute("class");if(n){var a=s===n;if(!a){var o=ld(n);a=e.every(Uy(o))}a&&i.push(t)}}}),i})},createElement:function(s){var e=new Mi;e.ownerDocument=this,e.nodeName=s,e.tagName=s,e.localName=s,e.childNodes=new si;var r=e.attributes=new ws;return r._ownerElement=e,e},createDocumentFragment:function(){var s=new Ls;return s.ownerDocument=this,s.childNodes=new si,s},createTextNode:function(s){var e=new bl;return e.ownerDocument=this,e.appendData(s),e},createComment:function(s){var e=new Sl;return e.ownerDocument=this,e.appendData(s),e},createCDATASection:function(s){var e=new Tl;return e.ownerDocument=this,e.appendData(s),e},createProcessingInstruction:function(s,e){var r=new Al;return r.ownerDocument=this,r.tagName=r.target=s,r.nodeValue=r.data=e,r},createAttribute:function(s){var e=new As;return e.ownerDocument=this,e.name=s,e.nodeName=s,e.localName=s,e.specified=!0,e},createEntityReference:function(s){var e=new wl;return e.ownerDocument=this,e.nodeName=s,e},createElementNS:function(s,e){var r=new Mi,i=e.split(":"),t=r.attributes=new ws;return r.childNodes=new si,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=s,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,t._ownerElement=r,r},createAttributeNS:function(s,e){var r=new As,i=e.split(":");return r.ownerDocument=this,r.nodeName=e,r.name=e,r.namespaceURI=s,r.specified=!0,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,r}};ir(oa,Yt);function Mi(){this._nsMap={}}Mi.prototype={nodeType:Fr,hasAttribute:function(s){return this.getAttributeNode(s)!=null},getAttribute:function(s){var e=this.getAttributeNode(s);return e&&e.value||""},getAttributeNode:function(s){return this.attributes.getNamedItem(s)},setAttribute:function(s,e){var r=this.ownerDocument.createAttribute(s);r.value=r.nodeValue=""+e,this.setAttributeNode(r)},removeAttribute:function(s){var e=this.getAttributeNode(s);e&&this.removeAttributeNode(e)},appendChild:function(s){return s.nodeType===ai?this.insertBefore(s,null):Hy(this,s)},setAttributeNode:function(s){return this.attributes.setNamedItem(s)},setAttributeNodeNS:function(s){return this.attributes.setNamedItemNS(s)},removeAttributeNode:function(s){return this.attributes.removeNamedItem(s.nodeName)},removeAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(s,e){return this.getAttributeNodeNS(s,e)!=null},getAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);return r&&r.value||""},setAttributeNS:function(s,e,r){var i=this.ownerDocument.createAttributeNS(s,e);i.value=i.nodeValue=""+r,this.setAttributeNode(i)},getAttributeNodeNS:function(s,e){return this.attributes.getNamedItemNS(s,e)},getElementsByTagName:function(s){return new pn(this,function(e){var r=[];return sa(e,function(i){i!==e&&i.nodeType==Fr&&(s==="*"||i.tagName==s)&&r.push(i)}),r})},getElementsByTagNameNS:function(s,e){return new pn(this,function(r){var i=[];return sa(r,function(t){t!==r&&t.nodeType===Fr&&(s==="*"||t.namespaceURI===s)&&(e==="*"||t.localName==e)&&i.push(t)}),i})}};oa.prototype.getElementsByTagName=Mi.prototype.getElementsByTagName;oa.prototype.getElementsByTagNameNS=Mi.prototype.getElementsByTagNameNS;ir(Mi,Yt);function As(){}As.prototype.nodeType=hn;ir(As,Yt);function la(){}la.prototype={data:"",substringData:function(s,e){return this.data.substring(s,s+e)},appendData:function(s){s=this.data+s,this.nodeValue=this.data=s,this.length=s.length},insertData:function(s,e){this.replaceData(s,0,e)},appendChild:function(s){throw new Error(Nt[zy])},deleteData:function(s,e){this.replaceData(s,e,"")},replaceData:function(s,e,r){var i=this.data.substring(0,s),t=this.data.substring(s+e);r=i+r+t,this.nodeValue=this.data=r,this.length=r.length}};ir(la,Yt);function bl(){}bl.prototype={nodeName:"#text",nodeType:Ts,splitText:function(s){var e=this.data,r=e.substring(s);e=e.substring(0,s),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};ir(bl,la);function Sl(){}Sl.prototype={nodeName:"#comment",nodeType:cd};ir(Sl,la);function Tl(){}Tl.prototype={nodeName:"#cdata-section",nodeType:ud};ir(Tl,la);function Os(){}Os.prototype.nodeType=pd;ir(Os,Yt);function Td(){}Td.prototype.nodeType=Wy;ir(Td,Yt);function wd(){}wd.prototype.nodeType=jy;ir(wd,Yt);function wl(){}wl.prototype.nodeType=fd;ir(wl,Yt);function Ls(){}Ls.prototype.nodeName="#document-fragment";Ls.prototype.nodeType=ai;ir(Ls,Yt);function Al(){}Al.prototype.nodeType=dd;ir(Al,Yt);function Ad(){}Ad.prototype.serializeToString=function(s,e,r){return Od.call(s,e,r)};Yt.prototype.toString=Od;function Od(s,e){var r=[],i=this.nodeType==9&&this.documentElement||this,t=i.prefix,n=i.namespaceURI;if(n&&t==null){var t=i.lookupPrefix(n);if(t==null)var a=[{namespace:n,prefix:null}]}return vn(this,r,s,e,a),r.join("")}function Ld(s,e,r){var i=s.prefix||"",t=s.namespaceURI;if(!t||i==="xml"&&t===na.XML||t===na.XMLNS)return!1;for(var n=r.length;n--;){var a=r[n];if(a.prefix===i)return a.namespace!==t}return!0}function Ol(s,e,r){s.push(" ",e,'="',r.replace(/[<&"]/g,_d),'"')}function vn(s,e,r,i,t){if(t||(t=[]),i)if(s=i(s),s){if(typeof s=="string"){e.push(s);return}}else return;switch(s.nodeType){case Fr:var n=s.attributes,a=n.length,o=s.firstChild,f=s.tagName;r=na.isHTML(s.namespaceURI)||r;var h=f;if(!r&&!s.prefix&&s.namespaceURI){for(var p,l=0;l<n.length;l++)if(n.item(l).name==="xmlns"){p=n.item(l).value;break}if(!p)for(var u=t.length-1;u>=0;u--){var m=t[u];if(m.prefix===""&&m.namespace===s.namespaceURI){p=m.namespace;break}}if(p!==s.namespaceURI)for(var u=t.length-1;u>=0;u--){var m=t[u];if(m.namespace===s.namespaceURI){m.prefix&&(h=m.prefix+":"+f);break}}}e.push("<",h);for(var y=0;y<a;y++){var b=n.item(y);b.prefix=="xmlns"?t.push({prefix:b.localName,namespace:b.value}):b.nodeName=="xmlns"&&t.push({prefix:"",namespace:b.value})}for(var y=0;y<a;y++){var b=n.item(y);if(Ld(b,r,t)){var _=b.prefix||"",g=b.namespaceURI;Ol(e,_?"xmlns:"+_:"xmlns",g),t.push({prefix:_,namespace:g})}vn(b,e,r,i,t)}if(f===h&&Ld(s,r,t)){var _=s.prefix||"",g=s.namespaceURI;Ol(e,_?"xmlns:"+_:"xmlns",g),t.push({prefix:_,namespace:g})}if(o||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(f)){if(e.push(">"),r&&/^script$/i.test(f))for(;o;)o.data?e.push(o.data):vn(o,e,r,i,t.slice()),o=o.nextSibling;else for(;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;e.push("</",h,">")}else e.push("/>");return;case hd:case ai:for(var o=s.firstChild;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;return;case hn:return Ol(e,s.name,s.value);case Ts:return e.push(s.data.replace(/[<&]/g,_d).replace(/]]>/g,"]]&gt;"));case ud:return e.push("<![CDATA[",s.data,"]]>");case cd:return e.push("<!--",s.data,"-->");case pd:var c=s.publicId,v=s.systemId;if(e.push("<!DOCTYPE ",s.name),c)e.push(" PUBLIC ",c),v&&v!="."&&e.push(" ",v),e.push(">");else if(v&&v!=".")e.push(" SYSTEM ",v,">");else{var E=s.internalSubset;E&&e.push(" [",E,"]"),e.push(">")}return;case dd:return e.push("<?",s.target," ",s.data,"?>");case fd:return e.push("&",s.nodeName,";");default:e.push("??",s.nodeName)}}function Dd(s,e,r){var i;switch(e.nodeType){case Fr:i=e.cloneNode(!1),i.ownerDocument=s;case ai:break;case hn:r=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=s,i.parentNode=null,r)for(var t=e.firstChild;t;)i.appendChild(Dd(s,t,r)),t=t.nextSibling;return i}function Ll(s,e,r){var i=new e.constructor;for(var t in e){var n=e[t];typeof n!="object"&&n!=i[t]&&(i[t]=n)}switch(e.childNodes&&(i.childNodes=new si),i.ownerDocument=s,i.nodeType){case Fr:var a=e.attributes,o=i.attributes=new ws,f=a.length;o._ownerElement=i;for(var h=0;h<f;h++)i.setAttributeNode(Ll(s,a.item(h),!0));break;case hn:r=!0}if(r)for(var p=e.firstChild;p;)i.appendChild(Ll(s,p,r)),p=p.nextSibling;return i}function Id(s,e,r){s[e]=r}try{if(Object.defineProperty){let s=function(e){switch(e.nodeType){case Fr:case ai:var r=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&r.push(s(e)),e=e.nextSibling;return r.join("");default:return e.nodeValue}};Object.defineProperty(pn.prototype,"length",{get:function(){return _l(this),this.$$length}}),Object.defineProperty(Yt.prototype,"textContent",{get:function(){return s(this)},set:function(e){switch(this.nodeType){case Fr:case ai:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Id=function(e,r,i){e["$$"+r]=i}}}catch(s){}ni.DocumentType=Os;ni.DOMException=Pi;ni.DOMImplementation=Ed;ni.Element=Mi;ni.Node=Yt;ni.NodeList=si;ni.XMLSerializer=Ad;var ua={},Rd={};(function(s){var e=Ci.freeze;s.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),s.HTML_ENTITIES=e({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),s.entityMap=s.HTML_ENTITIES})(Rd);var Dl={},fa=Ci.NAMESPACE,Il=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cd=new RegExp("[\\-\\.0-9"+Il.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Pd=new RegExp("^"+Il.source+Cd.source+"*(?::"+Il.source+Cd.source+"*)?$"),da=0,Ei=1,mn=2,ca=3,gn=4,yn=5,ha=6,Ds=7;function En(s,e){this.message=s,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,En)}En.prototype=new Error;En.prototype.name=En.name;function Md(){}Md.prototype={parse:function(s,e,r){var i=this.domBuilder;i.startDocument(),Fd(e,e={}),Ky(s,e,r,i,this.errorHandler),i.endDocument()}};function Ky(s,e,r,i,t){function n(C){if(C>65535){C-=65536;var P=55296+(C>>10),M=56320+(C&1023);return String.fromCharCode(P,M)}else return String.fromCharCode(C)}function a(C){var P=C.slice(1,-1);return P in r?r[P]:P.charAt(0)==="#"?n(parseInt(P.substr(1).replace("x","0x"))):(t.error("entity not found:"+C),C)}function o(C){if(C>b){var P=s.substring(b,C).replace(/&#?\w+;/g,a);u&&f(b),i.characters(P,0,C-b),b=C}}function f(C,P){for(;C>=p&&(P=l.exec(s));)h=P.index,p=h+P[0].length,u.lineNumber++;u.columnNumber=C-h+1}for(var h=0,p=0,l=/.*(?:\r\n?|\n)|.*$/g,u=i.locator,m=[{currentNSMap:e}],y={},b=0;;){try{var _=s.indexOf("<",b);if(_<0){if(!s.substr(b).match(/^\s*$/)){var g=i.doc,c=g.createTextNode(s.substr(b));g.appendChild(c),i.currentElement=c}return}switch(_>b&&o(_),s.charAt(_+1)){case"/":var v=s.indexOf(">",_+3),E=s.substring(_+2,v).replace(/[ \t\n\r]+$/g,""),d=m.pop();v<0?(E=s.substring(_+2).replace(/[\s<].*/,""),t.error("end tag name: "+E+" is not complete:"+d.tagName),v=_+1+E.length):E.match(/\s</)&&(E=E.replace(/[\s<].*/,""),t.error("end tag name: "+E+" maybe not complete"),v=_+1+E.length);var x=d.localNSMap,S=d.tagName==E,T=S||d.tagName&&d.tagName.toLowerCase()==E.toLowerCase();if(T){if(i.endElement(d.uri,d.localName,E),x)for(var w in x)i.endPrefixMapping(w);S||t.fatalError("end tag name: "+E+" is not match the current start tagName:"+d.tagName)}else m.push(d);v++;break;case"?":u&&f(_),v=Qy(s,_,i);break;case"!":u&&f(_),v=Zy(s,_,i,t);break;default:u&&f(_);var L=new Bd,I=m[m.length-1].currentNSMap,v=Gy(s,_,L,I,a,t),A=L.length;if(!L.closed&&Xy(s,v,L.tagName,y)&&(L.closed=!0,r.nbsp||t.warning("unclosed xml attribute")),u&&A){for(var O=kd(u,{}),D=0;D<A;D++){var R=L[D];f(R.offset),R.locator=kd(u,{})}i.locator=O,Nd(L,i,I)&&m.push(L),i.locator=u}else Nd(L,i,I)&&m.push(L);fa.isHTML(L.uri)&&!L.closed?v=Yy(s,v,L.tagName,a,i):v++}}catch(C){if(C instanceof En)throw C;t.error("element parse error: "+C),v=-1}v>b?b=v:o(Math.max(_,b)+1)}}function kd(s,e){return e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber,e}function Gy(s,e,r,i,t,n){function a(u,m,y){r.attributeNames.hasOwnProperty(u)&&n.fatalError("Attribute "+u+" redefined"),r.addValue(u,m,y)}for(var o,f,h=++e,p=da;;){var l=s.charAt(h);switch(l){case"=":if(p===Ei)o=s.slice(e,h),p=ca;else if(p===mn)p=ca;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(p===ca||p===Ei)if(p===Ei&&(n.warning('attribute value must after "="'),o=s.slice(e,h)),e=h+1,h=s.indexOf(l,e),h>0)f=s.slice(e,h).replace(/&#?\w+;/g,t),a(o,f,e-1),p=yn;else throw new Error("attribute value no end '"+l+"' match");else if(p==gn)f=s.slice(e,h).replace(/&#?\w+;/g,t),a(o,f,e),n.warning('attribute "'+o+'" missed start quot('+l+")!!"),e=h+1,p=yn;else throw new Error('attribute value must after "="');break;case"/":switch(p){case da:r.setTagName(s.slice(e,h));case yn:case ha:case Ds:p=Ds,r.closed=!0;case gn:case Ei:case mn:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),p==da&&r.setTagName(s.slice(e,h)),h;case">":switch(p){case da:r.setTagName(s.slice(e,h));case yn:case ha:case Ds:break;case gn:case Ei:f=s.slice(e,h),f.slice(-1)==="/"&&(r.closed=!0,f=f.slice(0,-1));case mn:p===mn&&(f=o),p==gn?(n.warning('attribute "'+f+'" missed quot(")!'),a(o,f.replace(/&#?\w+;/g,t),e)):((!fa.isHTML(i[""])||!f.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),a(f,f,e));break;case ca:throw new Error("attribute value missed!!")}return h;case"\x80":l=" ";default:if(l<=" ")switch(p){case da:r.setTagName(s.slice(e,h)),p=ha;break;case Ei:o=s.slice(e,h),p=mn;break;case gn:var f=s.slice(e,h).replace(/&#?\w+;/g,t);n.warning('attribute "'+f+'" missed quot(")!!'),a(o,f,e);case yn:p=ha;break}else switch(p){case mn:r.tagName,(!fa.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=h,p=Ei;break;case yn:n.warning('attribute space is required"'+o+'"!!');case ha:p=Ei,e=h;break;case ca:p=gn,e=h;break;case Ds:throw new Error("elements closed character '/' and '>' must be connected to")}}h++}}function Nd(s,e,r){for(var i=s.tagName,t=null,n=s.length;n--;){var a=s[n],o=a.qName,f=a.value,u=o.indexOf(":");if(u>0)var h=a.prefix=o.slice(0,u),p=o.slice(u+1),l=h==="xmlns"&&p;else p=o,h=null,l=o==="xmlns"&&"";a.localName=p,l!==!1&&(t==null&&(t={},Fd(r,r={})),r[l]=t[l]=f,a.uri=fa.XMLNS,e.startPrefixMapping(l,f))}for(var n=s.length;n--;){a=s[n];var h=a.prefix;h&&(h==="xml"&&(a.uri=fa.XML),h!=="xmlns"&&(a.uri=r[h||""]))}var u=i.indexOf(":");u>0?(h=s.prefix=i.slice(0,u),p=s.localName=i.slice(u+1)):(h=null,p=s.localName=i);var m=s.uri=r[h||""];if(e.startElement(m,p,i,s),s.closed){if(e.endElement(m,p,i),t)for(h in t)e.endPrefixMapping(h)}else return s.currentNSMap=r,s.localNSMap=t,!0}function Yy(s,e,r,i,t){if(/^(?:script|textarea)$/i.test(r)){var n=s.indexOf("</"+r+">",e),a=s.substring(e+1,n);if(/[&<]/.test(a))return/^script$/i.test(r)?(t.characters(a,0,a.length),n):(a=a.replace(/&#?\w+;/g,i),t.characters(a,0,a.length),n)}return e+1}function Xy(s,e,r,i){var t=i[r];return t==null&&(t=s.lastIndexOf("</"+r+">"),t<e&&(t=s.lastIndexOf("</"+r)),i[r]=t),t<e}function Fd(s,e){for(var r in s)e[r]=s[r]}function Zy(s,e,r,i){var t=s.charAt(e+2);switch(t){case"-":if(s.charAt(e+3)==="-"){var n=s.indexOf("-->",e+4);return n>e?(r.comment(s,e+4,n-e-4),n+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(s.substr(e+3,6)=="CDATA["){var n=s.indexOf("]]>",e+9);return r.startCDATA(),r.characters(s,e+9,n-e-9),r.endCDATA(),n+3}var a=Jy(s,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var f=a[1][0],h=!1,p=!1;o>3&&(/^public$/i.test(a[2][0])?(h=a[3][0],p=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(p=a[3][0]));var l=a[o-1];return r.startDTD(f,h,p),r.endDTD(),l.index+l[0].length}}return-1}function Qy(s,e,r){var i=s.indexOf("?>",e);if(i){var t=s.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return t?(t[0].length,r.processingInstruction(t[1],t[2]),i+2):-1}return-1}function Bd(){this.attributeNames={}}Bd.prototype={setTagName:function(s){if(!Pd.test(s))throw new Error("invalid tagName:"+s);this.tagName=s},addValue:function(s,e,r){if(!Pd.test(s))throw new Error("invalid attribute:"+s);this.attributeNames[s]=this.length,this[this.length++]={qName:s,value:e,offset:r}},length:0,getLocalName:function(s){return this[s].localName},getLocator:function(s){return this[s].locator},getQName:function(s){return this[s].qName},getURI:function(s){return this[s].uri},getValue:function(s){return this[s].value}};function Jy(s,e){var r,i=[],t=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(t.lastIndex=e,t.exec(s);r=t.exec(s);)if(i.push(r),r[1])return i}Dl.XMLReader=Md;Dl.ParseError=En;var qy=Ci,Rl=ni,Ud=Rd,jd=Dl,eE=Rl.DOMImplementation,Wd=qy.NAMESPACE,tE=jd.ParseError,rE=jd.XMLReader;function zd(s){this.options=s||{locator:{}}}zd.prototype.parseFromString=function(s,e){var r=this.options,i=new rE,t=r.domBuilder||new pa,n=r.errorHandler,a=r.locator,o=r.xmlns||{},f=/\/x?html?$/.test(e),h=f?Ud.HTML_ENTITIES:Ud.XML_ENTITIES;return a&&t.setDocumentLocator(a),i.errorHandler=iE(n,t,a),i.domBuilder=r.domBuilder||t,f&&(o[""]=Wd.HTML),o.xml=o.xml||Wd.XML,s&&typeof s=="string"?i.parse(s,o,h):i.errorHandler.error("invalid doc source"),t.doc};function iE(s,e,r){if(!s){if(e instanceof pa)return e;s=e}var i={},t=s instanceof Function;r=r||{};function n(a){var o=s[a];!o&&t&&(o=s.length==2?function(f){s(a,f)}:s),i[a]=o&&function(f){o("[xmldom "+a+"]	"+f+Cl(r))}||function(){}}return n("warning"),n("error"),n("fatalError"),i}function pa(){this.cdata=!1}function _n(s,e){e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber}pa.prototype={startDocument:function(){this.doc=new eE().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(s,e,r,i){var t=this.doc,n=t.createElementNS(s,r||e),a=i.length;Is(this,n),this.currentElement=n,this.locator&&_n(this.locator,n);for(var o=0;o<a;o++){var s=i.getURI(o),f=i.getValue(o),r=i.getQName(o),h=t.createAttributeNS(s,r);this.locator&&_n(i.getLocator(o),h),h.value=h.nodeValue=f,n.setAttributeNode(h)}},endElement:function(s,e,r){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(s,e){},endPrefixMapping:function(s){},processingInstruction:function(s,e){var r=this.doc.createProcessingInstruction(s,e);this.locator&&_n(this.locator,r),Is(this,r)},ignorableWhitespace:function(s,e,r){},characters:function(s,e,r){if(s=$d.apply(this,arguments),s){if(this.cdata)var i=this.doc.createCDATASection(s);else var i=this.doc.createTextNode(s);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(s)&&this.doc.appendChild(i),this.locator&&_n(this.locator,i)}},skippedEntity:function(s){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(s){(this.locator=s)&&(s.lineNumber=0)},comment:function(s,e,r){s=$d.apply(this,arguments);var i=this.doc.createComment(s);this.locator&&_n(this.locator,i),Is(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(s,e,r){var i=this.doc.implementation;if(i&&i.createDocumentType){var t=i.createDocumentType(s,e,r);this.locator&&_n(this.locator,t),Is(this,t),this.doc.doctype=t}},warning:function(s){console.warn("[xmldom warning]	"+s,Cl(this.locator))},error:function(s){console.error("[xmldom error]	"+s,Cl(this.locator))},fatalError:function(s){throw new tE(s,this.locator)}};function Cl(s){if(s)return`
@`+(s.systemId||"")+"#[line:"+s.lineNumber+",col:"+s.columnNumber+"]"}function $d(s,e,r){return typeof s=="string"?s.substr(e,r):s.length>=e+r||e?new java.lang.String(s,e,r)+"":s}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(s){pa.prototype[s]=function(){return null}});function Is(s,e){s.currentElement?s.currentElement.appendChild(e):s.doc.appendChild(e)}ua.__DOMHandler=pa;ua.DOMParser=zd;ua.DOMImplementation=Rl.DOMImplementation;ua.XMLSerializer=Rl.XMLSerializer;var Vd=ni;ia.DOMImplementation=Vd.DOMImplementation;ia.XMLSerializer=Vd.XMLSerializer;ia.DOMParser=ua.DOMParser;Object.defineProperty(Be,"__esModule",{value:!0});Be.RangeObject=void 0;Be.blob2base64=IE;Be.borders=mE;Be.bounds=vE;Be.createBase64Url=TE;Be.createBlob=Yd;Be.createBlobUrl=bE;Be.defaults=cE;Be.defer=RE;Be.documentHeight=lE;Be.extend=hE;Be.filterChildren=ME;Be.findChildren=PE;Be.getParentByTagName=kE;Be.indexOfElementNode=_E;Be.indexOfNode=Ml;Be.indexOfSorted=Pl;Be.indexOfTextNode=EE;Be.insert=pE;Be.isElement=uE;Be.isFloat=fE;Be.isNumber=Gd;Be.isXml=xE;Be.locationOf=Rs;Be.nodeBounds=gE;Be.parents=Nl;Be.parse=AE;Be.prefixed=dE;Be.qs=OE;Be.qsa=Xd;Be.qsp=LE;Be.querySelectorByType=CE;Be.requestAnimationFrame=void 0;Be.revokeBlobUrl=SE;Be.sprint=DE;Be.treeWalker=Zd;Be.type=wE;Be.uuid=Kd;Be.walk=kl;Be.windowBounds=yE;var nE=ia;const aE=typeof window!="undefined"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;Be.requestAnimationFrame=aE;const sE=1,oE=3,Hd=typeof URL!="undefined"?URL:typeof window!="undefined"?window.URL||window.webkitURL||window.mozURL:void 0;function Kd(){var s=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var i=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(r=="x"?i:i&7|8).toString(16)});return e}function lE(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function uE(s){return!!(s&&s.nodeType==1)}function Gd(s){return!isNaN(parseFloat(s))&&isFinite(s)}function fE(s){let e=parseFloat(s);return Gd(s)===!1?!1:typeof s=="string"&&s.indexOf(".")>-1?!0:Math.floor(e)!==e}function dE(s){var e=["Webkit","webkit","Moz","O","ms"],r=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=s.toLowerCase(),t=e.length;if(typeof document=="undefined"||typeof document.body.style[i]!="undefined")return s;for(var n=0;n<t;n++)if(typeof document.body.style[r[n]+i]!="undefined")return r[n]+i;return s}function cE(s){for(var e=1,r=arguments.length;e<r;e++){var i=arguments[e];for(var t in i)s[t]===void 0&&(s[t]=i[t])}return s}function hE(s){var e=[].slice.call(arguments,1);return e.forEach(function(r){!r||Object.getOwnPropertyNames(r).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}),s}function pE(s,e,r){var i=Rs(s,e,r);return e.splice(i,0,s),i}function Rs(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),f;return r||(r=function(h,p){if(h>p)return 1;if(h<p)return-1;if(h==p)return 0}),a-n<=0?o:(f=r(e[o],s),a-n==1?f>=0?o:o+1:f===0?o:f===-1?Rs(s,e,r,o,a):Rs(s,e,r,n,o))}function Pl(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),f;return r||(r=function(h,p){if(h>p)return 1;if(h<p)return-1;if(h==p)return 0}),a-n<=0?-1:(f=r(e[o],s),a-n==1?f===0?o:-1:f===0?o:f===-1?Pl(s,e,r,o,a):Pl(s,e,r,n,o))}function vE(s){var e=window.getComputedStyle(s),r=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function mE(s){var e=window.getComputedStyle(s),r=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function gE(s){let e,r=s.ownerDocument;if(s.nodeType==Node.TEXT_NODE){let i=r.createRange();i.selectNodeContents(s),e=i.getBoundingClientRect()}else e=s.getBoundingClientRect();return e}function yE(){var s=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:s,bottom:e,width:s,height:e}}function Ml(s,e){for(var r=s.parentNode,i=r.childNodes,t,n=-1,a=0;a<i.length&&(t=i[a],t.nodeType===e&&n++,t!=s);a++);return n}function EE(s){return Ml(s,oE)}function _E(s){return Ml(s,sE)}function xE(s){return["xml","opf","ncx"].indexOf(s)>-1}function Yd(s,e){return new Blob([s],{type:e})}function bE(s,e){var r,i=Yd(s,e);return r=Hd.createObjectURL(i),r}function SE(s){return Hd.revokeObjectURL(s)}function TE(s,e){var r,i;if(typeof s=="string")return r=btoa(s),i="data:"+e+";base64,"+r,i}function wE(s){return Object.prototype.toString.call(s).slice(8,-1)}function AE(s,e,r){var i,t;return typeof DOMParser=="undefined"||r?t=nE.DOMParser:t=DOMParser,s.charCodeAt(0)===65279&&(s=s.slice(1)),i=new t().parseFromString(s,e),i}function OE(s,e){var r;if(!s)throw new Error("No Element Provided");if(typeof s.querySelector!="undefined")return s.querySelector(e);if(r=s.getElementsByTagName(e),r.length)return r[0]}function Xd(s,e){return typeof s.querySelector!="undefined"?s.querySelectorAll(e):s.getElementsByTagName(e)}function LE(s,e,r){var i,t;if(typeof s.querySelector!="undefined"){e+="[";for(var n in r)e+=n+"~='"+r[n]+"'";return e+="]",s.querySelector(e)}else if(i=s.getElementsByTagName(e),t=Array.prototype.slice.call(i,0).filter(function(a){for(var o in r)if(a.getAttribute(o)===r[o])return!0;return!1}),t)return t[0]}function DE(s,e){var r=s.ownerDocument||s;typeof r.createTreeWalker!="undefined"?Zd(s,e,NodeFilter.SHOW_TEXT):kl(s,function(i){i&&i.nodeType===3&&e(i)})}function Zd(s,e,r){var i=document.createTreeWalker(s,r,null,!1);let t;for(;t=i.nextNode();)e(t)}function kl(s,e){if(e(s))return!0;if(s=s.firstChild,s)do{if(kl(s,e))return!0;s=s.nextSibling}while(s)}function IE(s){return new Promise(function(e,r){var i=new FileReader;i.readAsDataURL(s),i.onloadend=function(){e(i.result)}})}function RE(){this.resolve=null,this.reject=null,this.id=Kd(),this.promise=new Promise((s,e)=>{this.resolve=s,this.reject=e}),Object.freeze(this)}function CE(s,e,r){var i;if(typeof s.querySelector!="undefined"&&(i=s.querySelector(`${e}[*|type="${r}"]`)),!i||i.length===0){i=Xd(s,e);for(var t=0;t<i.length;t++)if(i[t].getAttributeNS("http://www.idpf.org/2007/ops","type")===r||i[t].getAttribute("epub:type")===r)return i[t]}else return i}function PE(s){for(var e=[],r=s.childNodes,i=0;i<r.length;i++){let t=r[i];t.nodeType===1&&e.push(t)}return e}function Nl(s){for(var e=[s];s;s=s.parentNode)e.unshift(s);return e}function ME(s,e,r){for(var i=[],t=s.childNodes,n=0;n<t.length;n++){let a=t[n];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(r)return a;i.push(a)}}if(!r)return i}function kE(s,e){let r;if(!(s===null||e===""))for(r=s.parentNode;r.nodeType===1;){if(r.tagName.toLowerCase()===e)return r;r=r.parentNode}}class NE{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,r){this.startContainer=e,this.startOffset=r,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,r){this.endContainer=e,this.endOffset=r,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let r=e.parentNode,i=Array.prototype.indexOf.call(r.childNodes,e);this.setStart(r,i),this.setEnd(r,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let r=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,r)}_commonAncestorContainer(e,r){var i=Nl(e||this.startContainer),t=Nl(r||this.endContainer);if(i[0]==t[0]){for(var n=0;n<i.length;n++)if(i[n]!=t[n])return i[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}Be.RangeObject=NE;var ki={},Qr={};if(!Qd)var Qd={cwd:function(){return"/"}};function Jr(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+s)}function Jd(s,e){for(var r="",i=-1,t=0,n,a=0;a<=s.length;++a){if(a<s.length)n=s.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(i===a-1||t===1))if(i!==a-1&&t===2){if(r.length<2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){for(var o=r.length-1,f=o;f>=0&&r.charCodeAt(f)!==47;--f);if(f!==o){f===-1?r="":r=r.slice(0,f),i=a,t=0;continue}}else if(r.length===2||r.length===1){r="",i=a,t=0;continue}}e&&(r.length>0?r+="/..":r="..")}else r.length>0?r+="/"+s.slice(i+1,a):r=s.slice(i+1,a);i=a,t=0}else n===46&&t!==-1?++t:t=-1}return r}function FE(s,e){var r=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+i:r+s+i:i}var Cs={resolve:function(){for(var e="",r=!1,i,t=arguments.length-1;t>=-1&&!r;t--){var n;t>=0?n=arguments[t]:(i===void 0&&(i=Qd.cwd()),n=i),Jr(n),n.length!==0&&(e=n+"/"+e,r=n.charCodeAt(0)===47)}return e=Jd(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Jr(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=Jd(e,!r),e.length===0&&!r&&(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return Jr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var i=arguments[r];Jr(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Cs.normalize(e)},relative:function(e,r){if(Jr(e),Jr(r),e===r||(e=Cs.resolve(e),r=Cs.resolve(r),e===r))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var t=e.length,n=t-i,a=1;a<r.length&&r.charCodeAt(a)===47;++a);for(var o=r.length,f=o-a,h=n<f?n:f,p=-1,l=0;l<=h;++l){if(l===h){if(f>h){if(r.charCodeAt(a+l)===47)return r.slice(a+l+1);if(l===0)return r.slice(a+l)}else n>h&&(e.charCodeAt(i+l)===47?p=l:l===0&&(p=0));break}var u=e.charCodeAt(i+l),m=r.charCodeAt(a+l);if(u!==m)break;u===47&&(p=l)}var y="";for(l=i+p+1;l<=t;++l)(l===t||e.charCodeAt(l)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+r.slice(a+p):(a+=p,r.charCodeAt(a)===47&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Jr(e),e.length===0)return".";for(var r=e.charCodeAt(0),i=r===47,t=-1,n=!0,a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!n){t=a;break}}else n=!1;return t===-1?i?"/":".":i&&t===1?"//":e.slice(0,t)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');Jr(e);var i=0,t=-1,n=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var o=r.length-1,f=-1;for(a=e.length-1;a>=0;--a){var h=e.charCodeAt(a);if(h===47){if(!n){i=a+1;break}}else f===-1&&(n=!1,f=a+1),o>=0&&(h===r.charCodeAt(o)?--o==-1&&(t=a):(o=-1,t=f))}return i===t?t=f:t===-1&&(t=e.length),e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!n){i=a+1;break}}else t===-1&&(n=!1,t=a+1);return t===-1?"":e.slice(i,t)}},extname:function(e){Jr(e);for(var r=-1,i=0,t=-1,n=!0,a=0,o=e.length-1;o>=0;--o){var f=e.charCodeAt(o);if(f===47){if(!n){i=o+1;break}continue}t===-1&&(n=!1,t=o+1),f===46?r===-1?r=o:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1?"":e.slice(r,t)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return FE("/",e)},parse:function(e){Jr(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,n;t?(r.root="/",n=1):n=0;for(var a=-1,o=0,f=-1,h=!0,p=e.length-1,l=0;p>=n;--p){if(i=e.charCodeAt(p),i===47){if(!h){o=p+1;break}continue}f===-1&&(h=!1,f=p+1),i===46?a===-1?a=p:l!==1&&(l=1):a!==-1&&(l=-1)}return a===-1||f===-1||l===0||l===1&&a===f-1&&a===o+1?f!==-1&&(o===0&&t?r.base=r.name=e.slice(1,f):r.base=r.name=e.slice(o,f)):(o===0&&t?(r.name=e.slice(1,a),r.base=e.slice(1,f)):(r.name=e.slice(o,a),r.base=e.slice(o,f)),r.ext=e.slice(a,f)),o>0?r.dir=e.slice(0,o-1):t&&(r.dir="/"),r},sep:"/",delimiter:":",posix:null},Ps=Cs;Object.defineProperty(Qr,"__esModule",{value:!0});Qr.default=void 0;var Ms=BE(Ps);function BE(s){return s&&s.__esModule?s:{default:s}}class UE{constructor(e){var r,i;r=e.indexOf("://"),r>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return Ms.default.parse(e)}isAbsolute(e){return Ms.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Ms.default.resolve(this.directory,e)}relative(e){var r=e&&e.indexOf("://")>-1;return r?e:Ms.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var jE=UE;Qr.default=jE;Object.defineProperty(ki,"__esModule",{value:!0});ki.default=void 0;var qd=tc(Qr),ec=tc(Ps);function tc(s){return s&&s.__esModule?s:{default:s}}class WE{constructor(e,r){var i=e.indexOf("://")>-1,t=e,n;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=r,!i&&r!==!1&&typeof r!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,t=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(a){this.Url=void 0,this.base&&(n=new qd.default(this.base),t=n.resolve(t))}this.Path=new qd.default(t),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var r=e.indexOf("://")>-1,i;return r?e:(i=ec.default.resolve(this.directory,e),this.origin+i)}relative(e){return ec.default.relative(e,this.directory)}toString(){return this.href}}var zE=WE;ki.default=zE;var ks={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.default=void 0;var _i=Be;const xn=1,Or=3,$E=9;class Ni{constructor(e,r,i){var t;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Ni))return new Ni(e,r,i);if(typeof r=="string"?this.base=this.parseComponent(r):typeof r=="object"&&r.steps&&(this.base=r),t=this.checkType(e),t==="string")return this.str=e,(0,_i.extend)(this,this.parse(e));if(t==="range")return(0,_i.extend)(this,this.fromRange(e,this.base,i));if(t==="node")return(0,_i.extend)(this,this.fromNode(e,this.base,i));if(t==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,_i.type)(e)==="Range"||typeof e.startContainer!="undefined")?"range":e&&typeof e=="object"&&typeof e.nodeType!="undefined"?"node":e&&typeof e=="object"&&e instanceof Ni?"EpubCFI":!1}parse(e){var r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,t,n;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(r.base=this.parseComponent(i),t=this.getPathComponent(e),r.path=this.parseComponent(t),n=this.getRange(e),n&&(r.range=!0,r.start=this.parseComponent(n[0]),r.end=this.parseComponent(n[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}parseComponent(e){var r={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),t=i[0].split("/"),n;return i.length>1&&(n=i[1],r.terminal=this.parseTerminal(n)),t[0]===""&&t.shift(),r.steps=t.map(function(a){return this.parseStep(a)}.bind(this)),r}parseStep(e){var r,i,t,n,a;if(n=e.match(/\[(.*)\]/),n&&n[1]&&(a=n[1]),i=parseInt(e),!isNaN(i))return i%2==0?(r="element",t=i/2-1):(r="text",t=(i-1)/2),{type:r,index:t,id:a||null}}parseTerminal(e){var r,i,t=e.match(/\[(.*)\]/);return t&&t[1]?(r=parseInt(e.split("[")[0]),i=t[1]):r=parseInt(e),(0,_i.isNumber)(r)||(r=null),{offset:r,assertion:i}}getChapterComponent(e){var r=e.split("!");return r[0]}getPathComponent(e){var r=e.split("!");if(r[1])return r[1].split(",")[0]}getRange(e){var r=e.split(",");return r.length===3?[r[1],r[2]]:!1}getCharecterOffsetComponent(e){var r=e.split(":");return r[1]||""}joinSteps(e){return e?e.map(function(r){var i="";return r.type==="element"&&(i+=(r.index+1)*2),r.type==="text"&&(i+=1+2*r.index),r.id&&(i+="["+r.id+"]"),i}).join("/"):""}segmentString(e){var r="/";return r+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(r+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(r+="["+e.terminal.assertion+"]"),r}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,r){var i,t,n,a;if(typeof e=="string"&&(e=new Ni(e)),typeof r=="string"&&(r=new Ni(r)),e.spinePos>r.spinePos)return 1;if(e.spinePos<r.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),n=e.start.terminal):(i=e.path.steps,n=e.path.terminal),r.range?(t=r.path.steps.concat(r.start.steps),a=r.start.terminal):(t=r.path.steps,a=r.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!t[o]||i[o].index>t[o].index)return 1;if(i[o].index<t[o].index)return-1}return i.length<t.length?-1:n.offset>a.offset?1:n.offset<a.offset?-1:0}step(e){var r=e.nodeType===Or?"text":"element";return{id:e.id,tagName:e.tagName,type:r,index:this.position(e)}}filteredStep(e,r){var i=this.filter(e,r),t;if(!!i)return t=i.nodeType===Or?"text":"element",{id:i.id,tagName:i.tagName,type:t,index:this.filteredPosition(i,r)}}pathTo(e,r,i){for(var t={steps:[],terminal:{offset:null,assertion:null}},n=e,a;n&&n.parentNode&&n.parentNode.nodeType!=$E;)i?a=this.filteredStep(n,i):a=this.step(n),a&&t.steps.unshift(a),n=n.parentNode;return r!=null&&r>=0&&(t.terminal.offset=r,t.steps[t.steps.length-1].type!="text"&&t.steps.push({type:"text",index:0})),t}equalStep(e,r){return!e||!r?!1:e.index===r.index&&e.id===r.id&&e.type===r.type}fromRange(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null},n=e.startContainer,a=e.endContainer,o=e.startOffset,f=e.endOffset,h=!1;if(i&&(h=n.ownerDocument.querySelector("."+i)!=null),typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),e.collapsed)h&&(o=this.patchOffset(n,o,i)),t.path=this.pathTo(n,o,i);else{t.range=!0,h&&(o=this.patchOffset(n,o,i)),t.start=this.pathTo(n,o,i),h&&(f=this.patchOffset(a,f,i)),t.end=this.pathTo(a,f,i),t.path={steps:[],terminal:null};var p=t.start.steps.length,l;for(l=0;l<p&&this.equalStep(t.start.steps[l],t.end.steps[l]);l++)l===p-1?t.start.terminal===t.end.terminal&&(t.path.steps.push(t.start.steps[l]),t.range=!1):t.path.steps.push(t.start.steps[l]);t.start.steps=t.start.steps.slice(t.path.steps.length),t.end.steps=t.end.steps.slice(t.path.steps.length)}return t}fromNode(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null};return typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),t.path=this.pathTo(e,null,i),t}filter(e,r){var i,t,n,a,o,f=!1;return e.nodeType===Or?(f=!0,n=e.parentNode,i=e.parentNode.classList.contains(r)):(f=!1,i=e.classList.contains(r)),i&&f?(a=n.previousSibling,o=n.nextSibling,a&&a.nodeType===Or?t=a:o&&o.nodeType===Or&&(t=o),t||e):i&&!f?!1:e}patchOffset(e,r,i){if(e.nodeType!=Or)throw new Error("Anchor must be a text node");var t=e,n=r;for(e.parentNode.classList.contains(i)&&(t=e.parentNode);t.previousSibling;){if(t.previousSibling.nodeType===xn)if(t.previousSibling.classList.contains(i))n+=t.previousSibling.textContent.length;else break;else n+=t.previousSibling.textContent.length;t=t.previousSibling}return n}normalizedMap(e,r,i){var t={},n=-1,a,o=e.length,f,h;for(a=0;a<o;a++)f=e[a].nodeType,f===xn&&e[a].classList.contains(i)&&(f=Or),a>0&&f===Or&&h===Or?t[a]=n:r===f&&(n=n+1,t[a]=n),h=f;return t}position(e){var r,i;return e.nodeType===xn?(r=e.parentNode.children,r||(r=(0,_i.findChildren)(e.parentNode)),i=Array.prototype.indexOf.call(r,e)):(r=this.textNodes(e.parentNode),i=r.indexOf(e)),i}filteredPosition(e,r){var i,t,n;return e.nodeType===xn?(i=e.parentNode.children,n=this.normalizedMap(i,xn,r)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(r)&&(e=e.parentNode,i=e.parentNode.childNodes),n=this.normalizedMap(i,Or,r)),t=Array.prototype.indexOf.call(i,e),n[t]}stepsToXpath(e){var r=[".","*"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("*[position()="+t+" and @id='"+i.id+"']"):i.type==="text"?r.push("text()["+t+"]"):r.push("*["+t+"]")}),r.join("/")}stepsToQuerySelector(e){var r=["html"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("#"+i.id):i.type==="text"||r.push("*:nth-child("+t+")")}),r.join(">")}textNodes(e,r){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===Or?!0:!!(r&&i.classList.contains(r))})}walkToNode(e,r,i){var t=r||document,n=t.documentElement,a,o,f=e.length,h;for(h=0;h<f&&(o=e[h],o.type==="element"?o.id?n=t.getElementById(o.id):(a=n.children||(0,_i.findChildren)(n),n=a[o.index]):o.type==="text"&&(n=this.textNodes(n,i)[o.index]),!!n);h++);return n}findNode(e,r,i){var t=r||document,n,a;return!i&&typeof t.evaluate!="undefined"?(a=this.stepsToXpath(e),n=t.evaluate(a,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?n=this.walkToNode(e,t,i):n=this.walkToNode(e,t),n}fixMiss(e,r,i,t){var n=this.findNode(e.slice(0,-1),i,t),a=n.childNodes,o=this.normalizedMap(a,Or,t),f,h,p=e[e.length-1].index;for(let l in o){if(!o.hasOwnProperty(l))return;if(o[l]===p)if(f=a[l],h=f.textContent.length,r>h)r=r-h;else{f.nodeType===xn?n=f.childNodes[0]:n=f;break}}return{container:n,offset:r}}toRange(e,r){var i=e||document,t,n,a,o,f,h=this,p,l,u=r?i.querySelector("."+r)!=null:!1,m;if(typeof i.createRange!="undefined"?t=i.createRange():t=new _i.RangeObject,h.range?(n=h.start,p=h.path.steps.concat(n.steps),o=this.findNode(p,i,u?r:null),a=h.end,l=h.path.steps.concat(a.steps),f=this.findNode(l,i,u?r:null)):(n=h.path,p=h.path.steps,o=this.findNode(h.path.steps,i,u?r:null)),o)try{n.terminal.offset!=null?t.setStart(o,n.terminal.offset):t.setStart(o,0)}catch(y){m=this.fixMiss(p,n.terminal.offset,i,u?r:null),t.setStart(m.container,m.offset)}else return console.log("No startContainer found for",this.toString()),null;if(f)try{a.terminal.offset!=null?t.setEnd(f,a.terminal.offset):t.setEnd(f,0)}catch(y){m=this.fixMiss(l,h.end.terminal.offset,i,u?r:null),t.setEnd(m.container,m.offset)}return t}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,r,i){var t=parseInt(r),n=(e+1)*2,a="/"+n+"/";return a+=(t+1)*2,i&&(a+="["+i+"]"),a}collapse(e){!this.range||(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var VE=Ni;Qt.default=VE;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.default=void 0;class HE{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var r=0;r<arguments[e].length;++r)this.hooks.push(arguments[e][r])}deregister(e){let r;for(let i=0;i<this.hooks.length;i++)if(r=this.hooks[i],r===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,r=this.context,i=[];return this.hooks.forEach(function(t){try{var n=t.apply(r,e)}catch(a){console.log(a)}n&&typeof n.then=="function"&&i.push(n)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}var KE=HE;bn.default=KE;var Ns={},qr={};Object.defineProperty(qr,"__esModule",{value:!0});qr.replaceBase=YE;qr.replaceCanonical=XE;qr.replaceLinks=QE;qr.replaceMeta=ZE;qr.substitute=JE;var Fi=Be,GE=rc(ki);rc(Qr);function rc(s){return s&&s.__esModule?s:{default:s}}function YE(s,e){var r,i,t=e.url,n=t.indexOf("://")>-1;!s||(i=(0,Fi.qs)(s,"head"),r=(0,Fi.qs)(i,"base"),r||(r=s.createElement("base"),i.insertBefore(r,i.firstChild)),!n&&window&&window.location&&(t=window.location.origin+t),r.setAttribute("href",t))}function XE(s,e){var r,i,t=e.canonical;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[rel='canonical']"),i?i.setAttribute("href",t):(i=s.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",t),r.appendChild(i)))}function ZE(s,e){var r,i,t=e.idref;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[property='dc.identifier']"),i?i.setAttribute("content",t):(i=s.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",t),r.appendChild(i)))}function QE(s,e){var r=s.querySelectorAll("a[href]");if(!!r.length)for(var i=(0,Fi.qs)(s.ownerDocument,"base"),t=i?i.getAttribute("href"):void 0,n=function(o){var f=o.getAttribute("href");if(f.indexOf("mailto:")!==0){var h=f.indexOf("://")>-1;if(h)o.setAttribute("target","_blank");else{var p;try{p=new GE.default(f,t)}catch(l){}o.onclick=function(){return p&&p.hash?e(p.Path.path+p.hash):e(p?p.Path.path:f),!1}}}}.bind(this),a=0;a<r.length;a++)n(r[a])}function JE(s,e,r){return e.forEach(function(i,t){i&&r[t]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),s=s.replace(new RegExp(i,"g"),r[t]))}),s}var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.default=void 0;var Sn=Be,qE=e_(Qr);function e_(s){return s&&s.__esModule?s:{default:s}}function t_(s,e,r,i){var t=typeof window!="undefined"?window.URL:!1,n=t?"blob":"arraybuffer",a=new Sn.defer,o=new XMLHttpRequest,f=XMLHttpRequest.prototype,h;"overrideMimeType"in f||Object.defineProperty(f,"overrideMimeType",{value:function(){}}),r&&(o.withCredentials=!0),o.onreadystatechange=l,o.onerror=p,o.open("GET",s,!0);for(h in i)o.setRequestHeader(h,i[h]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new qE.default(s).extension),e=="blob"&&(o.responseType=n),(0,Sn.isXml)(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function p(u){a.reject(u)}function l(){if(this.readyState===XMLHttpRequest.DONE){var u=!1;if((this.responseType===""||this.responseType==="document")&&(u=this.responseXML),this.status===200||this.status===0||u){var m;if(!this.response&&!u)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;u?m=this.responseXML:(0,Sn.isXml)(e)?m=(0,Sn.parse)(this.response,"text/xml"):e=="xhtml"?m=(0,Sn.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?m=(0,Sn.parse)(this.response,"text/html"):e=="json"?m=JSON.parse(this.response):e=="blob"?t?m=this.response:m=new Blob([this.response]):m=this.response,a.resolve(m)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}var r_=t_;Bi.default=r_;Object.defineProperty(Ns,"__esModule",{value:!0});Ns.default=void 0;var Fl=Be,ic=Bl(Qt),nc=Bl(bn),i_=qr,n_=Bl(Bi),a_=ia;function Bl(s){return s&&s.__esModule?s:{default:s}}class s_{constructor(e,r){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,r?this.hooks=r:(this.hooks={},this.hooks.serialize=new nc.default(this),this.hooks.content=new nc.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var r=e||this.request||n_.default,i=new Fl.defer,t=i.promise;return this.contents?i.resolve(this.contents):r(this.url).then(function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){i.resolve(this.contents)}.bind(this)).catch(function(n){i.reject(n)}),t}base(){return(0,i_.replaceBase)(this.document,this)}render(e){var r=new Fl.defer,i=r.promise;return this.output,this.load(e).then(function(t){var n=typeof navigator!="undefined"&&navigator.userAgent||"",a=n.indexOf("Trident")>=0,o;typeof XMLSerializer=="undefined"||a?o=a_.DOMParser:o=XMLSerializer;var f=new o;return this.output=f.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){r.resolve(this.output)}.bind(this)).catch(function(t){r.reject(t)}),i}find(e){var r=this,i=[],t=e.toLowerCase(),n=function(a){for(var o=a.textContent.toLowerCase(),f=r.document.createRange(),h,p,l=-1,u,m=150;p!=-1;)p=o.indexOf(t,l+1),p!=-1&&(f=r.document.createRange(),f.setStart(a,p),f.setEnd(a,p+t.length),h=r.cfiFromRange(f),a.textContent.length<m?u=a.textContent:(u=a.textContent.substring(p-m/2,p+m/2),u="..."+u+"..."),i.push({cfi:h,excerpt:u})),l=p};return(0,Fl.sprint)(r.document,function(a){n(a)}),i}search(e,r=5){if(typeof document.createTreeWalker=="undefined")return this.find(e);let i=[];const t=150,n=this,a=e.toLowerCase(),o=function(l){const y=l.reduce((b,_)=>b+_.textContent,"").toLowerCase().indexOf(a);if(y!=-1){const b=0,_=y+a.length;let g=0,c=0;if(y<l[b].length){let v;for(;g<l.length-1&&(c+=l[g].length,!(_<=c));)g+=1;let E=l[b],d=l[g],x=n.document.createRange();x.setStart(E,y);let S=l.slice(0,g).reduce((w,L)=>w+L.textContent.length,0);x.setEnd(d,S>_?_:_-S),v=n.cfiFromRange(x);let T=l.slice(0,g+1).reduce((w,L)=>w+L.textContent,"");T.length>t&&(T=T.substring(y-t/2,y+t/2),T="..."+T+"..."),i.push({cfi:v,excerpt:T})}}},f=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let h,p=[];for(;h=f.nextNode();)p.push(h),p.length==r&&(o(p.slice(0,r)),p=p.slice(1,r));return p.length>0&&o(p),i}reconcileLayoutSettings(e){var r={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var t=i.replace("rendition:",""),n=t.indexOf("-"),a,o;n!=-1&&(a=t.slice(0,n),o=t.slice(n+1),r[a]=o)}),r}cfiFromRange(e){return new ic.default(e,this.cfiBase).toString()}cfiFromElement(e){return new ic.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var o_=s_;Ns.default=o_;Object.defineProperty(ks,"__esModule",{value:!0});ks.default=void 0;var ac=jl(Qt),sc=jl(bn),l_=jl(Ns),Ul=qr;function jl(s){return s&&s.__esModule?s:{default:s}}class u_{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new sc.default,this.hooks.content=new sc.default,this.hooks.content.register(Ul.replaceBase),this.hooks.content.register(Ul.replaceCanonical),this.hooks.content.register(Ul.replaceMeta),this.epubcfi=new ac.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,r,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((t,n)=>{var a=this.manifest[t.idref],o;t.index=n,t.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,t.index,t.id),t.href&&(t.url=r(t.href,!0),t.canonical=i(t.href)),a&&(t.href=a.href,t.url=r(t.href,!0),t.canonical=i(t.href),a.properties.length&&t.properties.push.apply(t.properties,a.properties)),t.linear==="yes"?(t.prev=function(){let f=t.index;for(;f>0;){let h=this.get(f-1);if(h&&h.linear)return h;f-=1}}.bind(this),t.next=function(){let f=t.index;for(;f<this.spineItems.length-1;){let h=this.get(f+1);if(h&&h.linear)return h;f+=1}}.bind(this)):(t.prev=function(){},t.next=function(){}),o=new l_.default(t,this.hooks),this.append(o)}),this.loaded=!0}get(e){var r=0;if(typeof e=="undefined")for(;r<this.spineItems.length;){let i=this.spineItems[r];if(i&&i.linear)break;r+=1}else this.epubcfi.isCfiString(e)?r=new ac.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?r=e:typeof e=="string"&&e.indexOf("#")===0?r=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],r=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[r]||null}append(e){var r=this.spineItems.length;return e.index=r,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=r,this.spineByHref[encodeURI(e.href)]=r,this.spineByHref[e.href]=r,this.spineById[e.idref]=r,r}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(r,i){r.index=i}),0}remove(e){var r=this.spineItems.indexOf(e);if(r>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(r,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let r=this.get(e);if(r&&r.linear)return r;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let r=this.get(e);if(r&&r.linear)return r;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var f_=u_;ks.default=f_;var Fs={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.default=xi.Task=void 0;var Bs=Be;class d_{constructor(e){this._q=[],this.context=e,this.tick=Bs.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,r,i,t=[].shift.call(arguments),n=arguments;if(!t)throw new Error("No Task Provided");return typeof t=="function"?(e=new Bs.defer,r=e.promise,i={task:t,args:n,deferred:e,promise:r}):i={promise:t},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,r,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),r=e.task,r)return i=r.apply(this.context,e.args),i&&typeof i.then=="function"?i.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Bs.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Bs.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class c_{constructor(e,r,i){return function(){var t=arguments||[];return new Promise((n,a)=>{var o=function(f,h){!f&&h?a(h):n(f)};t.push(o),e.apply(i||this,t)})}}}xi.Task=c_;var h_=d_;xi.default=h_;var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.EVENTS=Ft.EPUBJS_VERSION=Ft.DOM_EVENTS=void 0;const p_="0.3";Ft.EPUBJS_VERSION=p_;const v_=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];Ft.DOM_EVENTS=v_;const m_={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};Ft.EVENTS=m_;Object.defineProperty(Fs,"__esModule",{value:!0});Fs.default=void 0;var Ui=Be,g_=Wl(xi),bi=Wl(Qt),y_=Ft,E_=Wl(Ar.exports);function Wl(s){return s&&s.__esModule?s:{default:s}}class oc{constructor(e,r,i){this.spine=e,this.request=r,this.pause=i||100,this.q=new g_.default(this),this.epubcfi=new bi.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(r){r.linear&&this.q.enqueue(this.process.bind(this),r)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(r){var i=new Ui.defer,t=this.parse(r,e.cfiBase);return this._locations=this._locations.concat(t),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(t),this.pause),i.promise}.bind(this))}parse(e,r,i){var t=[],n,a=e.ownerDocument,o=(0,Ui.qs)(a,"body"),f=0,h,p=i||this.break,l=function(u){var m=u.length,y,b=0;if(u.textContent.trim().length===0)return!1;for(f==0&&(n=this.createRange(),n.startContainer=u,n.startOffset=0),y=p-f,y>m&&(f+=m,b=m);b<m;)if(y=p-f,f===0&&(b+=1,n=this.createRange(),n.startContainer=u,n.startOffset=b),b+y>=m)f+=m-b,b=m;else{b+=y,n.endContainer=u,n.endOffset=b;let _=new bi.default(n,r).toString();t.push(_),f=0}h=u};if((0,Ui.sprint)(o,l.bind(this)),n&&n.startContainer&&h){n.endContainer=h,n.endOffset=h.length;let u=new bi.default(n,r).toString();t.push(u),f=0}return t}generateFromWords(e,r,i){var t=e?new bi.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(n){n.linear&&(t?n.index>=t.spinePos&&this.q.enqueue(this.processWords.bind(this),n,r,t,i):this.q.enqueue(this.processWords.bind(this),n,r,t,i))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,r,i,t){return t&&this._locationsWords.length>=t?Promise.resolve():e.load(this.request).then(function(n){var a=new Ui.defer,o=this.parseWords(n,e,r,i),f=t-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=t?o.slice(0,f):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,r,i,t){var n=r.cfiBase,a=[],o=e.ownerDocument,f=(0,Ui.qs)(o,"body"),h=i,p=t?t.spinePos!==r.index:!0,l;t&&r.index===t.spinePos&&(l=t.findNode(t.range?t.path.steps.concat(t.start.steps):t.path.steps,e.ownerDocument));var u=function(m){if(!p)if(m===l)p=!0;else return!1;if(m.textContent.length<10&&m.textContent.trim().length===0)return!1;var y=this.countWords(m.textContent),b,_=0;if(y===0)return!1;for(b=h-this._wordCounter,b>y&&(this._wordCounter+=y,_=y);_<y;)if(b=h-this._wordCounter,_+b>=y)this._wordCounter+=y-_,_=y;else{_+=b;let g=new bi.default(m,n);a.push({cfi:g.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,Ui.sprint)(f,u.bind(this)),a}locationFromCfi(e){let r;return bi.default.prototype.isCfiString(e)&&(e=new bi.default(e)),this._locations.length===0?-1:(r=(0,Ui.locationOf)(e,this._locations,this.epubcfi.compare),r>this.total?this.total:r)}percentageFromCfi(e){if(this._locations.length===0)return null;var r=this.locationFromCfi(e);return this.percentageFromLocation(r)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var r=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(r=this._locations[e]),r}cfiFromPercentage(e){let r;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new bi.default(this._locations[this.total]);return i.collapse(),i.toString()}return r=Math.ceil(this.total*e),this.cfiFromLocation(r)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var r;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(r=this.locationFromCfi(e),this._current=r):r=e,this.emit(y_.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(r)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,E_.default)(oc.prototype);var __=oc;Fs.default=__;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.default=void 0;var x_=S_(Ps),b_=Be;function S_(s){return s&&s.__esModule?s:{default:s}}class T_{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var r;if(!e)throw new Error("Container File Not Found");if(r=(0,b_.qs)(e,"rootfile"),!r)throw new Error("No RootFile Found");this.packagePath=r.getAttribute("full-path"),this.directory=x_.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}var w_=T_;Us.default=w_;var js={};Object.defineProperty(js,"__esModule",{value:!0});js.default=void 0;var Lr=Be;class A_{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var r,i,t;if(!e)throw new Error("Package File Not Found");if(r=(0,Lr.qs)(e,"metadata"),!r)throw new Error("No Metadata Found");if(i=(0,Lr.qs)(e,"manifest"),!i)throw new Error("No Manifest Found");if(t=(0,Lr.qs)(e,"spine"),!t)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,t),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,Lr.indexOfElementNode)(t),this.spine=this.parseSpine(t,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(r),this.metadata.direction=t.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var r={};return r.title=this.getElementText(e,"title"),r.creator=this.getElementText(e,"creator"),r.description=this.getElementText(e,"description"),r.pubdate=this.getElementText(e,"date"),r.publisher=this.getElementText(e,"publisher"),r.identifier=this.getElementText(e,"identifier"),r.language=this.getElementText(e,"language"),r.rights=this.getElementText(e,"rights"),r.modified_date=this.getPropertyText(e,"dcterms:modified"),r.layout=this.getPropertyText(e,"rendition:layout"),r.orientation=this.getPropertyText(e,"rendition:orientation"),r.flow=this.getPropertyText(e,"rendition:flow"),r.viewport=this.getPropertyText(e,"rendition:viewport"),r.media_active_class=this.getPropertyText(e,"media:active-class"),r.spread=this.getPropertyText(e,"rendition:spread"),r}parseManifest(e){var r={},i=(0,Lr.qsa)(e,"item"),t=Array.prototype.slice.call(i);return t.forEach(function(n){var a=n.getAttribute("id"),o=n.getAttribute("href")||"",f=n.getAttribute("media-type")||"",h=n.getAttribute("media-overlay")||"",p=n.getAttribute("properties")||"";r[a]={href:o,type:f,overlay:h,properties:p.length?p.split(" "):[]}}),r}parseSpine(e,r){var i=[],t=(0,Lr.qsa)(e,"itemref"),n=Array.prototype.slice.call(t);return n.forEach(function(a,o){var f=a.getAttribute("idref"),h=a.getAttribute("properties")||"",p=h.length?h.split(" "):[],l={id:a.getAttribute("id"),idref:f,linear:a.getAttribute("linear")||"yes",properties:p,index:o};i.push(l)}),i}findUniqueIdentifier(e){var r=e.documentElement.getAttribute("unique-identifier");if(!r)return"";var i=e.getElementById(r);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var r=(0,Lr.qsp)(e,"item",{properties:"nav"});return r?r.getAttribute("href"):!1}findNcxPath(e,r){var i=(0,Lr.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),t;return i||(t=r.getAttribute("toc"),t&&(i=e.querySelector(`#${t}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var r=(0,Lr.qs)(e,"package");r.getAttribute("version");var i=(0,Lr.qsp)(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var t=(0,Lr.qsp)(e,"meta",{name:"cover"});if(t){var n=t.getAttribute("content"),a=e.getElementById(n);return a?a.getAttribute("href"):""}else return!1}getElementText(e,r){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",r),t;return!i||i.length===0?"":(t=i[0],t.childNodes.length?t.childNodes[0].nodeValue:"")}getPropertyText(e,r){var i=(0,Lr.qsp)(e,"meta",{property:r});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let r=e.readingOrder||e.spine;return this.spine=r.map((i,t)=>(i.index=t,i.linear=i.linear||"yes",i)),e.resources.forEach((i,t)=>{this.manifest[t]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,t)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var O_=A_;js.default=O_;var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.default=void 0;var hr=Be;class L_{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let r=e.nodeType,i,t;r&&(i=(0,hr.qs)(e,"html"),t=(0,hr.qs)(e,"ncx")),r?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):t&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var r,i=0;i<e.length;i++)r=e[i],r.href&&(this.tocByHref[r.href]=i),r.id&&(this.tocById[r.id]=i),this.length++,r.subitems.length&&this.unpack(r.subitems)}get(e){var r;return e?(e.indexOf("#")===0?r=this.tocById[e.substring(1)]:e in this.tocByHref&&(r=this.tocByHref[e]),this.getByIndex(e,r,this.toc)):this.toc}getByIndex(e,r,i){if(i.length===0)return;const t=i[r];if(t&&(e===t.id||e===t.href))return t;{let n;for(let a=0;a<i.length&&(n=this.getByIndex(e,r,i[a].subitems),!n);++a);return n}}landmark(e){var r;return e?(r=this.landmarksByType[e],this.landmarks[r]):this.landmarks}parseNav(e){var r=(0,hr.querySelectorByType)(e,"nav","toc"),i=[];if(!r)return i;let t=(0,hr.filterChildren)(r,"ol",!0);return t&&(i=this.parseNavList(t)),i}parseNavList(e,r){const i=[];if(!e||!e.children)return i;for(let t=0;t<e.children.length;t++){const n=this.navItem(e.children[t],r);n&&i.push(n)}return i}navItem(e,r){let i=e.getAttribute("id")||void 0,t=(0,hr.filterChildren)(e,"a",!0)||(0,hr.filterChildren)(e,"span",!0);if(!t)return;let n=t.getAttribute("href")||"";i||(i=n);let a=t.textContent||"",o=[],f=(0,hr.filterChildren)(e,"ol",!0);return f&&(o=this.parseNavList(f,i)),{id:i,href:n,label:a,subitems:o,parent:r}}parseLandmarks(e){var r=(0,hr.querySelectorByType)(e,"nav","landmarks"),i=r?(0,hr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.landmarkItem(i[n]),o&&(a.push(o),this.landmarksByType[o.type]=n);return a}landmarkItem(e){let r=(0,hr.filterChildren)(e,"a",!0);if(!r)return;let i=r.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,t=r.getAttribute("href")||"",n=r.textContent||"";return{href:t,label:n,type:i}}parseNcx(e){var r=(0,hr.qsa)(e,"navPoint"),i=r.length,t,n={},a=[],o,f;if(!r||i===0)return a;for(t=0;t<i;++t)o=this.ncxItem(r[t]),n[o.id]=o,o.parent?(f=n[o.parent],f.subitems.push(o)):a.push(o);return a}ncxItem(e){var r=e.getAttribute("id")||!1,i=(0,hr.qs)(e,"content"),t=i.getAttribute("src"),n=(0,hr.qs)(e,"navLabel"),a=n.textContent?n.textContent:"",o=[],f=e.parentNode,h;return f&&(f.nodeName==="navPoint"||f.nodeName.split(":").slice(-1)[0]==="navPoint")&&(h=f.getAttribute("id")),{id:r,href:t,label:a,subitems:o,parent:h}}load(e){return e.map(r=>(r.label=r.title,r.subitems=r.children?this.load(r.children):[],r))}forEach(e){return this.toc.forEach(e)}}var D_=L_;Ws.default=D_;var zs={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.default=void 0;var va={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},I_=function(){var s,e,r,i,t={};for(s in va)if(va.hasOwnProperty(s)){for(e in va[s])if(va[s].hasOwnProperty(e))if(r=va[s][e],typeof r=="string")t[r]=s+"/"+e;else for(i=0;i<r.length;i++)t[r[i]]=s+"/"+e}return t}(),R_="text/plain";function C_(s){return s&&I_[s.split(".").pop().toLowerCase()]||R_}var P_={lookup:C_};Tn.default=P_;Object.defineProperty(zs,"__esModule",{value:!0});zs.default=void 0;var lc=qr,ma=Be,M_=$s(ki),k_=$s(Tn),uc=$s(Qr),N_=$s(Ps);function $s(s){return s&&s.__esModule?s:{default:s}}class F_{constructor(e,r){this.settings={replacements:r&&r.replacements||"base64",archive:r&&r.archive,resolver:r&&r.resolver,request:r&&r.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(r){return e[r]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var r=new M_.default(e),i=k_.default.lookup(r.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(t=>(0,ma.blob2base64)(t)).then(t=>(0,ma.createBase64Url)(t,i)):this.settings.request(e,"blob").then(t=>(0,ma.createBlobUrl)(t,i))}replacements(){if(this.settings.replacements==="none")return new Promise(function(r){r(this.urls)}.bind(this));var e=this.urls.map(r=>{var i=this.settings.resolver(r);return this.createUrl(i).catch(t=>(console.error(t),null))});return Promise.all(e).then(r=>(this.replacementUrls=r.filter(i=>typeof i=="string"),r))}replaceCss(e,r){var i=[];return e=e||this.settings.archive,r=r||this.settings.resolver,this.cssUrls.forEach(function(t){var n=this.createCssFile(t,e,r).then(function(a){var o=this.urls.indexOf(t);o>-1&&(this.replacementUrls[o]=a)}.bind(this));i.push(n)}.bind(this)),Promise.all(i)}createCssFile(e){var r;if(N_.default.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),t;this.settings.archive?t=this.settings.archive.getText(i):t=this.settings.request(i,"text");var n=this.urls.map(a=>{var o=this.settings.resolver(a),f=new uc.default(i).relative(o);return f});return t?t.then(a=>(a=(0,lc.substitute)(a,n,this.replacementUrls),this.settings.replacements==="base64"?r=(0,ma.createBase64Url)(a,"text/css"):r=(0,ma.createBlobUrl)(a,"text/css"),r),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,r){return r=r||this.settings.resolver,this.urls.map(function(i){var t=r(i),n=new uc.default(e).relative(t);return n}.bind(this))}get(e){var r=this.urls.indexOf(e);if(r!==-1)return this.replacementUrls.length?new Promise(function(i,t){i(this.replacementUrls[r])}.bind(this)):this.createUrl(e)}substitute(e,r){var i;return r?i=this.relativeTo(r):i=this.urls,(0,lc.substitute)(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var B_=F_;zs.default=B_;var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.default=void 0;var U_=j_(Qt),Dr=Be;function j_(s){return s&&s.__esModule?s:{default:s}}class W_{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new U_.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var r=(0,Dr.qs)(e,"html"),i=(0,Dr.qs)(e,"ncx");if(r)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var r=(0,Dr.querySelectorByType)(e,"nav","page-list"),i=r?(0,Dr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.item(i[n]),a.push(o);return a}parseNcx(e){var r=[],i=0,t,n,a,o=0;if(n=(0,Dr.qs)(e,"pageList"),!n||(a=(0,Dr.qsa)(n,"pageTarget"),o=a.length,!a||a.length===0))return r;for(i=0;i<o;++i)t=this.ncxItem(a[i]),r.push(t);return r}ncxItem(e){var r=(0,Dr.qs)(e,"navLabel"),i=(0,Dr.qs)(r,"text"),t=i.textContent,n=(0,Dr.qs)(e,"content"),a=n.getAttribute("src"),o=parseInt(t,10);return{href:a,page:o}}item(e){var r=(0,Dr.qs)(e,"a"),i=r.getAttribute("href")||"",t=r.textContent||"",n=parseInt(t),a=i.indexOf("epubcfi"),o,f,h;return a!=-1?(o=i.split("#"),f=o[0],h=o.length>1?o[1]:!1,{cfi:h,href:i,packageUrl:f,page:n}):{href:i,page:n}}process(e){e.forEach(function(r){this.pages.push(r.page),r.cfi&&this.locations.push(r.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var r=-1;if(this.locations.length===0)return-1;var i=(0,Dr.indexOfSorted)(e,this.locations,this.epubcfi.compare);return i!=-1?r=this.pages[i]:(i=(0,Dr.locationOf)(e,this.locations,this.epubcfi.compare),r=i-1>=0?this.pages[i-1]:this.pages[0],r!==void 0||(r=-1)),r}cfiFromPage(e){var r=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(r=this.locations[i]),r}pageFromPercentage(e){var r=Math.round(this.totalPages*e);return r}percentageFromPage(e){var r=(e-this.firstPage)/this.totalPages;return Math.round(r*1e3)/1e3}percentageFromCfi(e){var r=this.pageFromCfi(e),i=this.percentageFromPage(r);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var z_=W_;Vs.default=z_;var wn={},ga={};Object.defineProperty(ga,"__esModule",{value:!0});ga.default=void 0;var $_=Be,V_=Ft,H_=K_(Ar.exports);function K_(s){return s&&s.__esModule?s:{default:s}}class fc{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e!="undefined"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,r){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),r>=0&&(this._minSpreadWidth=r),this._spread}calculate(e,r,i){var t=1,n=i||0,a=e,o=r,f=Math.floor(a/12),h,p,l,u;this._spread&&a>=this._minSpreadWidth?t=2:t=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(n=f%2==0?f:f-1),this.name==="pre-paginated"&&(n=0),t>1?(h=a/t-n,l=h+n):(h=a,l=a),this.name==="pre-paginated"&&t>1&&(a=h),p=h*t+n,u=a,this.width=a,this.height=o,this.spreadWidth=p,this.pageWidth=l,this.delta=u,this.columnWidth=h,this.gap=n,this.divisor=t,this.update({width:a,height:o,spreadWidth:p,pageWidth:l,delta:u,columnWidth:h,gap:n,divisor:t})}format(e,r,i){var t;return this.name==="pre-paginated"?t=e.fit(this.columnWidth,this.height,r):this._flow==="paginated"?t=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?t=e.size(null,this.height):t=e.size(this.width,null),t}count(e,r){let i,t;return this.name==="pre-paginated"?(i=1,t=1):this._flow==="paginated"?(r=r||this.delta,i=Math.ceil(e/r),t=i*this.divisor):(r=r||this.height,i=Math.ceil(e/r),t=i),{spreads:i,pages:t}}update(e){if(Object.keys(e).forEach(r=>{this.props[r]===e[r]&&delete e[r]}),Object.keys(e).length>0){let r=(0,$_.extend)(this.props,e);this.emit(V_.EVENTS.LAYOUT.UPDATED,r,e)}}}(0,H_.default)(fc.prototype);var G_=fc;ga.default=G_;var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.default=void 0;var Y_=X_(ki);function X_(s){return s&&s.__esModule?s:{default:s}}class Z_{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(!!e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var r in e)e.hasOwnProperty(r)&&(typeof e[r]=="string"?this.registerUrl(r,e[r]):this.registerRules(r,e[r]))}registerCss(e,r){this._themes[e]={serialized:r},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,r){var i=new Y_.default(r);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,r){this._themes[e]={rules:r},(this._injected[e]||e=="default")&&this.update(e)}select(e){var r=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(t=>{t.removeClass(r),t.addClass(e)})}update(e){var r=this.rendition.getContents();r.forEach(i=>{this.add(e,i)})}inject(e){var r=[],i=this._themes,t;for(var n in i)i.hasOwnProperty(n)&&(n===this._current||n==="default")&&(t=i[n],(t.rules&&Object.keys(t.rules).length>0||t.url&&r.indexOf(t.url)===-1)&&this.add(n,e),this._injected.push(n));this._current!="default"&&e.addClass(this._current)}add(e,r){var i=this._themes[e];!i||!r||(i.url?r.addStylesheet(i.url):i.serialized?(r.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(r.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,r,i){var t=this.rendition.getContents();this._overrides[e]={value:r,priority:i===!0},t.forEach(n=>{n.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var r=this.rendition.getContents();delete this._overrides[e],r.forEach(i=>{i.css(e)})}overrides(e){var r=this._overrides;for(var i in r)r.hasOwnProperty(i)&&e.css(i,r[i].value,r[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var Q_=Z_;Hs.default=Q_;var ji={},ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.default=void 0;var Ks=J_(Qt),dc=Be;function J_(s){return s&&s.__esModule?s:{default:s}}class q_{constructor(e,r,i,t=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=r||"ltr",this._dev=t}section(e){var r=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,r);return i}page(e,r,i,t){var n=e&&e.document?e.document.body:!1,a;if(!!n){if(a=this.rangePairToCfiPair(r,{start:this.findStart(n,i,t),end:this.findEnd(n,i,t)}),this._dev===!0){let o=e.document,f=new Ks.default(a.start).toRange(o),h=new Ks.default(a.end).toRange(o),p=o.defaultView.getSelection(),l=o.createRange();p.removeAllRanges(),l.setStart(f.startContainer,f.startOffset),l.setEnd(h.endContainer,h.endOffset),p.addRange(l)}return a}}walk(e,r){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(f){return f.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},t=i.acceptNode;t.acceptNode=i.acceptNode;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t,!1),a,o;(a=n.nextNode())&&(o=r(a),!o););return o}}findRanges(e){for(var r=[],i=e.contents.scrollWidth(),t=Math.ceil(i/this.layout.spreadWidth),n=t*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,f,h,p=0;p<n.pages;p++)f=(a+o)*p,h=a*(p+1)+o*p,r.push({start:this.findStart(e.document.body,f,h),end:this.findEnd(e.document.body,f,h)});return r}findStart(e,r,i){for(var t=[e],n,a,o=e;t.length;)if(n=t.shift(),a=this.walk(n,f=>{var h,p,l,u,m;if(m=(0,dc.nodeBounds)(f),this.horizontal&&this.direction==="ltr"){if(h=this.horizontal?m.left:m.top,p=this.horizontal?m.right:m.bottom,h>=r&&h<=i)return f;if(p>r)return f;o=f,t.push(f)}else if(this.horizontal&&this.direction==="rtl"){if(h=m.left,p=m.right,p<=i&&p>=r)return f;if(h<i)return f;o=f,t.push(f)}else{if(l=m.top,u=m.bottom,l>=r&&l<=i)return f;if(u>r)return f;o=f,t.push(f)}}),a)return this.findTextStartRange(a,r,i);return this.findTextStartRange(o,r,i)}findEnd(e,r,i){for(var t=[e],n,a=e,o;t.length;)if(n=t.shift(),o=this.walk(n,f=>{var h,p,l,u,m;if(m=(0,dc.nodeBounds)(f),this.horizontal&&this.direction==="ltr"){if(h=Math.round(m.left),p=Math.round(m.right),h>i&&a)return a;if(p>i)return f;a=f,t.push(f)}else if(this.horizontal&&this.direction==="rtl"){if(h=Math.round(this.horizontal?m.left:m.top),p=Math.round(this.horizontal?m.right:m.bottom),p<r&&a)return a;if(h<r)return f;a=f,t.push(f)}else{if(l=Math.round(m.top),u=Math.round(m.bottom),l>i&&a)return a;if(u>i)return f;a=f,t.push(f)}}),o)return this.findTextEndRange(o,r,i);return this.findTextEndRange(a,r,i)}findTextStartRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,f,h,p=0;p<t.length;p++)if(n=t[p],a=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=r)return n}else if(this.horizontal&&this.direction==="rtl"){if(h=a.right,h<=i)return n}else if(f=a.top,f>=r)return n;return t[0]}findTextEndRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,f,h,p,l,u=0;u<t.length;u++){if(a=t[u],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(f=o.left,h=o.right,f>i&&n)return n;if(h>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(f=o.left,h=o.right,h<r&&n)return n;if(f<r)return a}else{if(p=o.top,l=o.bottom,p>i&&n)return n;if(l>i)return a}n=a}return t[t.length-1]}splitTextNodeIntoRanges(e,r){var i=[],t=e.textContent||"",n=t.trim(),a,o=e.ownerDocument,f=r||" ",h=n.indexOf(f);if(h===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,h),i.push(a),a=!1;h!=-1;)h=n.indexOf(f,h+1),h>0&&(a&&(a.setEnd(e,h),i.push(a)),a=o.createRange(),a.setStart(e,h+1));return a&&(a.setEnd(e,n.length),i.push(a)),i}rangePairToCfiPair(e,r){var i=r.start,t=r.end;i.collapse(!0),t.collapse(!1);let n=new Ks.default(i,e).toString(),a=new Ks.default(t,e).toString();return{start:n,end:a}}rangeListToCfiList(e,r){for(var i=[],t,n=0;n<r.length;n++)t=this.rangePairToCfiPair(e,r[n]),i.push(t);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var ex=q_;ya.default=ex;Object.defineProperty(ji,"__esModule",{value:!0});ji.default=void 0;var tx=zl(Ar.exports),Br=Be,An=zl(Qt),cc=zl(ya),rx=qr,oi=Ft;function zl(s){return s&&s.__esModule?s:{default:s}}const hc=typeof navigator!="undefined",ix=hc&&/Chrome/.test(navigator.userAgent),pc=hc&&!ix&&/AppleWebKit/.test(navigator.userAgent),nx=1;class vc{constructor(e,r,i,t){this.epubcfi=new An.default,this.document=e,this.documentElement=this.document.documentElement,this.content=r||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=t||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",oi.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return oi.DOM_EVENTS}width(e){var r=this.content;return e&&(0,Br.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}height(e){var r=this.content;return e&&(0,Br.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}contentWidth(e){var r=this.content||this.document.body;return e&&(0,Br.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}contentHeight(e){var r=this.content||this.document.body;return e&&(0,Br.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}textWidth(){let e,r,i=this.document.createRange(),t=this.content||this.document.body,n=(0,Br.borders)(t);return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.width,n&&n.width&&(r+=n.width),Math.round(r)}textHeight(){let e,r,i=this.document.createRange(),t=this.content||this.document.body;return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.bottom,Math.round(r)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,r,i){var t=this.content||this.document.body;return r?t.style.setProperty(e,r,i?"important":""):t.style.removeProperty(e),this.window.getComputedStyle(t)[e]}viewport(e){var r=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},t=[],n={};if(r&&r.hasAttribute("content")){let a=r.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),f=a.match(/height\s*=\s*([^,]*)/),h=a.match(/initial-scale\s*=\s*([^,]*)/),p=a.match(/minimum-scale\s*=\s*([^,]*)/),l=a.match(/maximum-scale\s*=\s*([^,]*)/),u=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]!="undefined"&&(i.width=o[1]),f&&f.length&&typeof f[1]!="undefined"&&(i.height=f[1]),h&&h.length&&typeof h[1]!="undefined"&&(i.scale=h[1]),p&&p.length&&typeof p[1]!="undefined"&&(i.minimum=p[1]),l&&l.length&&typeof l[1]!="undefined"&&(i.maximum=l[1]),u&&u.length&&typeof u[1]!="undefined"&&(i.scalable=u[1])}return n=(0,Br.defaults)(e||{},i),e&&(n.width&&t.push("width="+n.width),n.height&&t.push("height="+n.height),n.scale&&t.push("initial-scale="+n.scale),n.scalable==="no"?(t.push("minimum-scale="+n.scale),t.push("maximum-scale="+n.scale),t.push("user-scalable="+n.scalable)):(n.scalable&&t.push("user-scalable="+n.scalable),n.minimum&&t.push("minimum-scale="+n.minimum),n.maximum&&t.push("minimum-scale="+n.maximum)),r||(r=this.document.createElement("meta"),r.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(r)),r.setAttribute("content",t.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(oi.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver=="undefined"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),r=this.textHeight();(e!=this._size.width||r!=this._size.height)&&(this._size={width:e,height:r},this.onResize&&this.onResize(this._size),this.emit(oi.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,r=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),i=0;i<e.length;i+=1){var t;try{t=e[i].cssRules}catch(o){return}if(!t)return;for(var n=0;n<t.length;n+=1)if(t[n].media){var a=this.window.matchMedia(t[n].media.mediaText);a.addListener(r)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(r=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),r,i=0;i<e.length;i++)r=e[i],typeof r.naturalWidth!="undefined"&&r.naturalWidth===0&&(r.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,r){var i,t={left:0,top:0};if(!this.document)return t;if(this.epubcfi.isCfiString(e)){let n=new An.default(e).toRange(this.document,r);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let a=n.startContainer.textContent.indexOf(" ",n.startOffset);a==-1&&(a=n.startContainer.textContent.length),n.setEnd(n.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)i=n.startContainer.getBoundingClientRect(),t.left=i.left,t.top=i.top;else if(pc){let a=n.startContainer,o=new Range;try{a.nodeType===nx?i=a.getBoundingClientRect():n.startOffset+2<a.length?(o.setStart(a,n.startOffset),o.setEnd(a,n.startOffset+2),i=o.getBoundingClientRect()):n.startOffset-2>0?(o.setStart(a,n.startOffset-2),o.setEnd(a,n.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(f){console.error(f,f.stack)}}else i=n.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let n=e.substring(e.indexOf("#")+1),a=this.document.getElementById(n);if(a)if(pc){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(t.left=i.left,t.top=i.top),t}addStylesheet(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}if(t=this.document.querySelector("link[href='"+e+"']"),t){r(!0);return}t=this.document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}_getStylesheetNode(e){var r;return e="epubjs-inserted-css-"+(e||""),this.document?(r=this.document.getElementById(e),r||(r=this.document.createElement("style"),r.id=e,this.document.head.appendChild(r)),r):!1}addStylesheetCss(e,r){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(r),i.innerHTML=e,!0}addStylesheetRules(e,r){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(r).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var t=0,n=e.length;t<n;t++){var a=1,o=e[t],f=e[t][0],h="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var p=o.length;a<p;a++){var l=o[a];h+=l[0]+":"+l[1]+(l[2]?" !important":"")+`;
`}i.insertRule(f+"{"+h+"}",i.cssRules.length)}else Object.keys(e).forEach(m=>{const y=e[m];if(Array.isArray(y))y.forEach(b=>{const g=Object.keys(b).map(c=>`${c}:${b[c]}`).join(";");i.insertRule(`${m}{${g}}`,i.cssRules.length)});else{const _=Object.keys(y).map(g=>`${g}:${y[g]}`).join(";");i.insertRule(`${m}{${_}}`,i.cssRules.length)}})}addScript(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}t=this.document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}addClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.add(e))}removeClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.remove(e))}addEventListeners(){!this.document||(this._triggerEvent=this.triggerEvent.bind(this),oi.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){!this.document||(oi.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){!this.document||(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){!this.document||(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var r=this.window.getSelection();this.triggerSelectedEvent(r)}.bind(this),250)}triggerSelectedEvent(e){var r,i;e&&e.rangeCount>0&&(r=e.getRangeAt(0),r.collapsed||(i=new An.default(r,this.cfiBase).toString(),this.emit(oi.EVENTS.CONTENTS.SELECTED,i),this.emit(oi.EVENTS.CONTENTS.SELECTED_RANGE,r)))}range(e,r){var i=new An.default(e);return i.toRange(this.document,r)}cfiFromRange(e,r){return new An.default(e,this.cfiBase,r).toString()}cfiFromNode(e,r){return new An.default(e,this.cfiBase,r).toString()}map(e){var r=new cc.default(e);return r.section()}size(e,r){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),r>=0&&(this.height(r),i.height=r),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,r,i,t,n){let a=(0,Br.prefixed)("column-axis"),o=(0,Br.prefixed)("column-gap"),f=(0,Br.prefixed)("column-width"),h=(0,Br.prefixed)("column-fill"),l=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&l==="horizontal"&&this.direction(n),this.width(e),this.height(r),this.viewport({width:e,height:r,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),l==="vertical"?(this.css("padding-top",t/2+"px",!0),this.css("padding-bottom",t/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",t/2+"px",!0),this.css("padding-right",t/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(h,"auto"),this.css(o,t+"px"),this.css(f,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,r,i){var t="scale("+e+")",n="";this.css("transform-origin","top left"),(r>=0||i>=0)&&(n=" translate("+(r||0)+"px, "+(i||0)+"px )"),this.css("transform",t+n)}fit(e,r,i){var t=this.viewport(),n=parseInt(t.width),a=parseInt(t.height),o=e/n,f=r/a,h=o<f?o:f;if(this.layoutStyle("paginated"),this.width(n),this.height(a),this.overflow("hidden"),this.scaler(h,0,0),this.css("background-size",n*h+"px "+a*h+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var p=e-n*h;this.css("margin-left",p+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,r,i,t,n){var a=new cc.default(r,n);return a.page(this,e,i,t)}linksHandler(){(0,rx.replaceLinks)(this.content,e=>{this.emit(oi.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let r=(0,Br.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[r]=e),this.window.getComputedStyle(this.documentElement)[r]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,r){return navigator.epubReadingSystem={name:e,version:r,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,tx.default)(vc.prototype);var ax=vc;ji.default=ax;var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.default=void 0;var sx=gc(Ar.exports),ox=gc(Qt),mc=Ft;function gc(s){return s&&s.__esModule?s:{default:s}}class lx{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,r,i,t,n,a){let o=encodeURI(r+e),h=new ox.default(r).spinePos,p=new yc({type:e,cfiRange:r,data:i,sectionIndex:h,cb:t,className:n,styles:a});return this._annotations[o]=p,h in this._annotationsBySectionIndex?this._annotationsBySectionIndex[h].push(o):this._annotationsBySectionIndex[h]=[o],this.rendition.views().forEach(u=>{p.sectionIndex===u.index&&p.attach(u)}),p}remove(e,r){let i=encodeURI(e+r);if(i in this._annotations){let t=this._annotations[i];if(r&&t.type!==r)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(t.sectionIndex,i),t.sectionIndex===a.index&&t.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,r){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==r)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,r,i,t,n){return this.add("highlight",e,r,i,t,n)}underline(e,r,i,t,n){return this.add("underline",e,r,i,t,n)}mark(e,r,i){return this.add("mark",e,r,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}}class yc{constructor({type:e,cfiRange:r,data:i,sectionIndex:t,cb:n,className:a,styles:o}){this.type=e,this.cfiRange=r,this.data=i,this.sectionIndex=t,this.mark=void 0,this.cb=n,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:r,data:i,type:t,mark:n,cb:a,className:o,styles:f}=this,h;return t==="highlight"?h=e.highlight(r,i,a,o,f):t==="underline"?h=e.underline(r,i,a,o,f):t==="mark"&&(h=e.mark(r,i,a)),this.mark=h,this.emit(mc.EVENTS.ANNOTATION.ATTACH,h),h}detach(e){let{cfiRange:r,type:i}=this,t;return e&&(i==="highlight"?t=e.unhighlight(r):i==="underline"?t=e.ununderline(r):i==="mark"&&(t=e.unmark(r))),this.mark=void 0,this.emit(mc.EVENTS.ANNOTATION.DETACH,t),t}text(){}}(0,sx.default)(yc.prototype);var ux=lx;Gs.default=ux;var Ea={},ei={},Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.createElement=Ec;function Ec(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}Ys.default={createElement:Ec};var _a={};Object.defineProperty(_a,"__esModule",{value:!0});_a.proxyMouse=_c;_a.clone=xc;_a.default={proxyMouse:_c};function _c(s,e){function r(a){for(var o=e.length-1;o>=0;o--){var f=e[o],h=a.clientX,p=a.clientY;if(a.touches&&a.touches.length&&(h=a.touches[0].clientX,p=a.touches[0].clientY),!!fx(f,s,h,p)){f.dispatchEvent(xc(a));break}}}if(s.nodeName==="iframe"||s.nodeName==="IFRAME")try{this.target=s.contentDocument}catch(a){this.target=s}else this.target=s;for(var i=["mouseup","mousedown","click","touchstart"],t=0;t<i.length;t++){var n=i[t];this.target.addEventListener(n,function(a){return r(a)},!1)}}function xc(s){var e=Object.assign({},s,{bubbles:!1});try{return new MouseEvent(s.type,e)}catch(i){var r=document.createEvent("MouseEvents");return r.initMouseEvent(s.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),r}}function fx(s,e,r,i){var t=e.getBoundingClientRect();function n(p,l,u){var m=p.top-t.top,y=p.left-t.left,b=m+p.height,_=y+p.width;return m<=u&&y<=l&&b>u&&_>l}var a=s.getBoundingClientRect();if(!n(a,r,i))return!1;for(var o=s.getClientRects(),f=0,h=o.length;f<h;f++)if(n(o[f],r,i))return!0;return!1}Object.defineProperty(ei,"__esModule",{value:!0});ei.Underline=ei.Highlight=ei.Mark=ei.Pane=void 0;var dx=function s(e,r,i){e===null&&(e=Function.prototype);var t=Object.getOwnPropertyDescriptor(e,r);if(t===void 0){var n=Object.getPrototypeOf(e);return n===null?void 0:s(n,r,i)}else{if("value"in t)return t.value;var a=t.get;return a===void 0?void 0:a.call(i)}},Xs=function(){function s(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,i){return r&&s(e.prototype,r),i&&s(e,i),e}}(),cx=Ys,xa=bc(cx),hx=_a,px=bc(hx);function bc(s){return s&&s.__esModule?s:{default:s}}function Sc(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:s}function Tc(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}function Zs(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}ei.Pane=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;Zs(this,s),this.target=e,this.element=xa.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),px.default.proxyMouse(this.target,this.marks),this.container=r,this.container.appendChild(this.element),this.render()}return Xs(s,[{key:"addMark",value:function(r){var i=xa.default.createElement("g");return this.element.appendChild(i),r.bind(i,this.container),this.marks.push(r),r.render(),r}},{key:"removeMark",value:function(r){var i=this.marks.indexOf(r);if(i!==-1){var t=r.unbind();this.element.removeChild(t),this.marks.splice(i,1)}}},{key:"render",value:function(){yx(this.element,gx(this.target,this.container));var r=!0,i=!1,t=void 0;try{for(var n=this.marks[Symbol.iterator](),a;!(r=(a=n.next()).done);r=!0){var o=a.value;o.render()}}catch(f){i=!0,t=f}finally{try{!r&&n.return&&n.return()}finally{if(i)throw t}}}}]),s}();var vx=ei.Mark=function(){function s(){Zs(this,s),this.element=null}return Xs(s,[{key:"bind",value:function(r,i){this.element=r,this.container=i}},{key:"unbind",value:function(){var r=this.element;return this.element=null,r}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(r){!this.element||this.element.dispatchEvent(r)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var r=[],i=this.element.firstChild;i;)r.push(i.getBoundingClientRect()),i=i.nextSibling;return r}},{key:"filteredRanges",value:function(){var r=Array.from(this.range.getClientRects());return r.filter(function(i){for(var t=0;t<r.length;t++){if(r[t]===i)return!0;var n=Ex(r[t],i);if(n)return!1}return!0})}}]),s}(),mx=ei.Highlight=function(s){Tc(e,s);function e(r,i,t,n){Zs(this,e);var a=Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=r,a.className=i,a.data=t||{},a.attributes=n||{},a}return Xs(e,[{key:"bind",value:function(i,t){dx(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,t);for(var n in this.data)this.data.hasOwnProperty(n)&&(this.element.dataset[n]=this.data[n]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&this.element.setAttribute(n,this.attributes[n]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,f=t.length;o<f;o++){var h=t[o],p=xa.default.createElement("rect");p.setAttribute("x",h.left-n.left+a.left),p.setAttribute("y",h.top-n.top+a.top),p.setAttribute("height",h.height),p.setAttribute("width",h.width),i.appendChild(p)}this.element.appendChild(i)}}]),e}(vx);ei.Underline=function(s){Tc(e,s);function e(r,i,t,n){return Zs(this,e),Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,i,t,n))}return Xs(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,f=t.length;o<f;o++){var h=t[o],p=xa.default.createElement("rect");p.setAttribute("x",h.left-n.left+a.left),p.setAttribute("y",h.top-n.top+a.top),p.setAttribute("height",h.height),p.setAttribute("width",h.width),p.setAttribute("fill","none");var l=xa.default.createElement("line");l.setAttribute("x1",h.left-n.left+a.left),l.setAttribute("x2",h.left-n.left+a.left+h.width),l.setAttribute("y1",h.top-n.top+a.top+h.height-1),l.setAttribute("y2",h.top-n.top+a.top+h.height-1),l.setAttribute("stroke-width",1),l.setAttribute("stroke","black"),l.setAttribute("stroke-linecap","square"),i.appendChild(p),i.appendChild(l)}this.element.appendChild(i)}}]),e}(mx);function gx(s,e){var r=e.getBoundingClientRect(),i=s.getBoundingClientRect();return{top:i.top-r.top,left:i.left-r.left,height:s.scrollHeight,width:s.scrollWidth}}function yx(s,e){s.style.setProperty("top",e.top+"px","important"),s.style.setProperty("left",e.left+"px","important"),s.style.setProperty("height",e.height+"px","important"),s.style.setProperty("width",e.width+"px","important")}function Ex(s,e){return e.right<=s.right&&e.left>=s.left&&e.top>=s.top&&e.bottom<=s.bottom}Object.defineProperty(Ea,"__esModule",{value:!0});Ea.default=void 0;var _x=$l(Ar.exports),jt=Be,xx=$l(Qt),bx=$l(ji),pr=Ft,Qs=ei;function $l(s){return s&&s.__esModule?s:{default:s}}class wc{constructor(e,r){this.settings=(0,jt.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},r||{}),this.id="epubjs-view-"+(0,jt.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new xx.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var r=document.createElement("div");return r.classList.add("epub-view"),r.style.height="0px",r.style.width="0px",r.style.overflow="hidden",r.style.position="relative",r.style.display="block",e&&e=="horizontal"?r.style.flex="none":r.style.flex="initial",r}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,jt.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,r){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(i){return this.load(i)}.bind(this)).then(function(){let i=this.contents.writingMode(),t;return this.settings.flow==="scrolled"?t=i.indexOf("vertical")===0?"horizontal":"vertical":t=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(pr.EVENTS.VIEWS.AXIS,t),this.setWritingMode(i),this.emit(pr.EVENTS.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}.bind(this),function(i){return this.emit(pr.EVENTS.VIEWS.LOAD_ERROR,i),new Promise((t,n)=>{n(i)})}.bind(this)).then(function(){this.emit(pr.EVENTS.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,r){var i=e||this.settings.width,t=r||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,t):this.settings.axis==="horizontal"?this.lock("height",i,t):this.lock("width",i,t),this.settings.width=i,this.settings.height=t}lock(e,r,i){var t=(0,jt.borders)(this.element),n;this.iframe?n=(0,jt.borders)(this.iframe):n={width:0,height:0},e=="width"&&(0,jt.isNumber)(r)&&(this.lockedWidth=r-t.width-n.width),e=="height"&&(0,jt.isNumber)(i)&&(this.lockedHeight=i-t.height-n.height),e==="both"&&(0,jt.isNumber)(r)&&(0,jt.isNumber)(i)&&(this.lockedWidth=r-t.width-n.width,this.lockedHeight=i-t.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(e){var r=this.lockedWidth,i=this.lockedHeight,t;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(r=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(r=this.contents.textWidth(),r%this.layout.pageWidth>0&&(r=Math.ceil(r/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(t=r/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&t%2>0&&(r+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||r!=this._width||i!=this._height)&&this.reframe(r,i),this._expanding=!1)}reframe(e,r){var i;(0,jt.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,jt.isNumber)(r)&&(this.element.style.height=r+"px",this.iframe.style.height=r+"px",this._height=r);let t=this.prevBounds?e-this.prevBounds.width:e,n=this.prevBounds?r-this.prevBounds.height:r;i={width:e,height:r,widthDelta:t,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit(pr.EVENTS.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=(0,jt.bounds)(this.element)}load(e){var r=new jt.defer,i=r.promise;if(!this.iframe)return r.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=function(n){this.onLoad(n,r)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,jt.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return r.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var t=this;MSApp.execUnsafeLocalFunction(function(){t.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,r){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new bx.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(pr.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(pr.EVENTS.CONTENTS.RESIZE,t=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),r.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var r=new jt.defer;return this.displayed?r.resolve(this):this.render(e).then(function(){this.emit(pr.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,r.resolve(this)}.bind(this),function(i){r.reject(i,this)}),r.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(pr.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(pr.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var r=this.contents.locationOf(e,this.settings.ignoreClass);return{left:r.left,top:r.top}}onDisplayed(e){}onResize(e,r){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,jt.bounds)(this.element)),this.elementBounds}highlight(e,r={},i,t="epubjs-hl",n={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),f=()=>{this.emit(pr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Qs.Pane(this.iframe,this.element));let h=new Qs.Highlight(o,t,r,a),p=this.pane.addMark(h);return this.highlights[e]={mark:p,element:p.element,listeners:[f,i]},p.element.setAttribute("ref",t),p.element.addEventListener("click",f),p.element.addEventListener("touchstart",f),i&&(p.element.addEventListener("click",i),p.element.addEventListener("touchstart",i)),p}underline(e,r={},i,t="epubjs-ul",n={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),f=()=>{this.emit(pr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Qs.Pane(this.iframe,this.element));let h=new Qs.Underline(o,t,r,a),p=this.pane.addMark(h);return this.underlines[e]={mark:p,element:p.element,listeners:[f,i]},p.element.setAttribute("ref",t),p.element.addEventListener("click",f),p.element.addEventListener("touchstart",f),i&&(p.element.addEventListener("click",i),p.element.addEventListener("touchstart",i)),p}mark(e,r={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let t=this.contents.range(e);if(!t)return;let n=t.commonAncestorContainer,a=n.nodeType===1?n:n.parentNode,o=h=>{this.emit(pr.EVENTS.VIEWS.MARK_CLICKED,e,r)};t.collapsed&&n.nodeType===1?(t=new Range,t.selectNodeContents(n)):t.collapsed&&(t=new Range,t.selectNodeContents(a));let f=this.document.createElement("a");return f.setAttribute("ref","epubjs-mk"),f.style.position="absolute",f.dataset.epubcfi=e,r&&Object.keys(r).forEach(h=>{f.dataset[h]=r[h]}),i&&(f.addEventListener("click",i),f.addEventListener("touchstart",i)),f.addEventListener("click",o),f.addEventListener("touchstart",o),this.placeMark(f,t),this.element.appendChild(f),this.marks[e]={element:f,range:t,listeners:[o,i]},a}placeMark(e,r){let i,t,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=r.getBoundingClientRect();i=o.top,t=o.right}else{let o=r.getClientRects(),f;for(var a=0;a!=o.length;a++)f=o[a],(!n||f.left<n)&&(n=f.left,t=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=f.top)}e.style.top=`${i}px`,e.style.left=`${t}px`}unhighlight(e){let r;e in this.highlights&&(r=this.highlights[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let r;e in this.underlines&&(r=this.underlines[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let r;e in this.marks&&(r=this.marks[e],this.element.removeChild(r.element),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,jt.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,_x.default)(wc.prototype);var Sx=wc;Ea.default=Sx;var On={},Js={};Object.defineProperty(Js,"__esModule",{value:!0});Js.createDefiner=Ac;Js.default=Tx;function Tx(){var s="reverse",e=Ac();return document.body.appendChild(e),e.scrollLeft>0?s="default":typeof Element!="undefined"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(s="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(s="negative")),document.body.removeChild(e),s}function Ac(){var s=document.createElement("div");s.dir="rtl",s.style.position="fixed",s.style.width="1px",s.style.height="1px",s.style.top="0px",s.style.left="0px",s.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var r=document.createElement("span");r.style.width="1px",r.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(r),e.appendChild(i),s.appendChild(e),s}var qs={};function wx(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var Vl=wx,Ax=typeof Mt=="object"&&Mt&&Mt.Object===Object&&Mt,Ox=Ax,Lx=Ox,Dx=typeof self=="object"&&self&&self.Object===Object&&self,Ix=Lx||Dx||Function("return this")(),Oc=Ix,Rx=Oc,Cx=function(){return Rx.Date.now()},Px=Cx,Mx=/\s/;function kx(s){for(var e=s.length;e--&&Mx.test(s.charAt(e)););return e}var Nx=kx,Fx=Nx,Bx=/^\s+/;function Ux(s){return s&&s.slice(0,Fx(s)+1).replace(Bx,"")}var jx=Ux,Wx=Oc,zx=Wx.Symbol,Lc=zx,Dc=Lc,Ic=Object.prototype,$x=Ic.hasOwnProperty,Vx=Ic.toString,ba=Dc?Dc.toStringTag:void 0;function Hx(s){var e=$x.call(s,ba),r=s[ba];try{s[ba]=void 0;var i=!0}catch(n){}var t=Vx.call(s);return i&&(e?s[ba]=r:delete s[ba]),t}var Kx=Hx,Gx=Object.prototype,Yx=Gx.toString;function Xx(s){return Yx.call(s)}var Zx=Xx,Rc=Lc,Qx=Kx,Jx=Zx,qx="[object Null]",eb="[object Undefined]",Cc=Rc?Rc.toStringTag:void 0;function tb(s){return s==null?s===void 0?eb:qx:Cc&&Cc in Object(s)?Qx(s):Jx(s)}var rb=tb;function ib(s){return s!=null&&typeof s=="object"}var nb=ib,ab=rb,sb=nb,ob="[object Symbol]";function lb(s){return typeof s=="symbol"||sb(s)&&ab(s)==ob}var ub=lb,fb=jx,Pc=Vl,db=ub,Mc=0/0,cb=/^[-+]0x[0-9a-f]+$/i,hb=/^0b[01]+$/i,pb=/^0o[0-7]+$/i,vb=parseInt;function mb(s){if(typeof s=="number")return s;if(db(s))return Mc;if(Pc(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=Pc(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=fb(s);var r=hb.test(s);return r||pb.test(s)?vb(s.slice(2),r?2:8):cb.test(s)?Mc:+s}var gb=mb,yb=Vl,Hl=Px,kc=gb,Eb="Expected a function",_b=Math.max,xb=Math.min;function bb(s,e,r){var i,t,n,a,o,f,h=0,p=!1,l=!1,u=!0;if(typeof s!="function")throw new TypeError(Eb);e=kc(e)||0,yb(r)&&(p=!!r.leading,l="maxWait"in r,n=l?_b(kc(r.maxWait)||0,e):n,u="trailing"in r?!!r.trailing:u);function m(x){var S=i,T=t;return i=t=void 0,h=x,a=s.apply(T,S),a}function y(x){return h=x,o=setTimeout(g,e),p?m(x):a}function b(x){var S=x-f,T=x-h,w=e-S;return l?xb(w,n-T):w}function _(x){var S=x-f,T=x-h;return f===void 0||S>=e||S<0||l&&T>=n}function g(){var x=Hl();if(_(x))return c(x);o=setTimeout(g,b(x))}function c(x){return o=void 0,u&&i?m(x):(i=t=void 0,a)}function v(){o!==void 0&&clearTimeout(o),h=0,i=f=t=o=void 0}function E(){return o===void 0?a:c(Hl())}function d(){var x=Hl(),S=_(x);if(i=arguments,t=this,f=x,S){if(o===void 0)return y(f);if(l)return clearTimeout(o),o=setTimeout(g,e),m(f)}return o===void 0&&(o=setTimeout(g,e)),a}return d.cancel=v,d.flush=E,d}var Nc=bb,Sb=Nc,Tb=Vl,wb="Expected a function";function Ab(s,e,r){var i=!0,t=!0;if(typeof s!="function")throw new TypeError(wb);return Tb(r)&&(i="leading"in r?!!r.leading:i,t="trailing"in r?!!r.trailing:t),Sb(s,e,{leading:i,maxWait:e,trailing:t})}var Ob=Ab;Object.defineProperty(qs,"__esModule",{value:!0});qs.default=void 0;var vr=Be,Lb=Db(Ob);function Db(s){return s&&s.__esModule?s:{default:s}}class Ib{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,vr.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let r=e.height,i=e.width,t=e.overflow||!1,n=e.axis||"vertical",a=e.direction;(0,vr.extend)(this.settings,e),e.height&&(0,vr.isNumber)(e.height)&&(r=e.height+"px"),e.width&&(0,vr.isNumber)(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",n==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),r&&(o.style.height=r),t&&(t==="scroll"&&n==="vertical"?(o.style["overflow-y"]=t,o.style["overflow-x"]="hidden"):t==="scroll"&&n==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=t):o.style.overflow=t),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var r=document.createElement("div");return r.style.visibility="hidden",r.style.overflow="hidden",r.style.width="0",r.style.height="0",r.appendChild(e),r}getElement(e){var r;if((0,vr.isElement)(e)?r=e:typeof e=="string"&&(r=document.getElementById(e)),!r)throw new Error("Not an Element");return r}attachTo(e){var r=this.getElement(e),i;if(!!r)return this.settings.hidden?i=this.wrapper:i=this.container,r.appendChild(i),this.element=r,r}getContainer(){return this.container}onResize(e){(!(0,vr.isNumber)(this.settings.width)||!(0,vr.isNumber)(this.settings.height))&&(this.resizeFunc=(0,Lb.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,r){var i;let t=e||this.settings.width,n=r||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):(0,vr.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,r===null?(i=i||this.element.getBoundingClientRect(),i.height&&(r=i.height,this.container.style.height=r+"px")):(0,vr.isNumber)(r)?this.container.style.height=r+"px":this.container.style.height=r,(0,vr.isNumber)(e)||(e=this.container.clientWidth),(0,vr.isNumber)(r)||(r=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=(0,vr.windowBounds)(),o=window.getComputedStyle(document.body),f={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return t||(e=a.width-f.left-f.right),(this.settings.fullsize&&!n||!n)&&(r=a.height-f.top-f.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:r-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,vr.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,r){var i="#"+this.id+" ",t="";this.sheet||(this.sheet=this.getSheet()),r.forEach(function(n){for(var a in n)n.hasOwnProperty(a)&&(t+=a+":"+n[a]+";")}),this.sheet.insertRule(i+e+" {"+t+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var Rb=Ib;qs.default=Rb;var eo={};Object.defineProperty(eo,"__esModule",{value:!0});eo.default=void 0;class Cb{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,r){return this._views.splice(r,0,e),this.container&&(r<this.container.children.length?this.container.insertBefore(e.element,this.container.children[r]):this.container.appendChild(e.element)),this.length++,e}remove(e){var r=this._views.indexOf(e);r>-1&&this._views.splice(r,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,r=this.length;if(!!this.length){for(var i=0;i<r;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var r,i=this.length,t=0;t<i;t++)if(r=this._views[t],r.displayed&&r.section.index==e.index)return r}displayed(){for(var e=[],r,i=this.length,t=0;t<i;t++)r=this._views[t],r.displayed&&e.push(r);return e}show(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}var Pb=Cb;eo.default=Pb;Object.defineProperty(On,"__esModule",{value:!0});On.default=void 0;var Mb=Dn(Ar.exports),Ln=Be,kb=Dn(Js),Fc=Dn(ya),Nb=Dn(xi),Fb=Dn(qs),Bb=Dn(eo),mr=Ft;function Dn(s){return s&&s.__esModule?s:{default:s}}class Bc{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new Nb.default(this),this.settings=(0,Ln.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,Ln.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,r){let i=e.tagName;typeof this.settings.fullsize=="undefined"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=r,this.settings.rtlScrollType=(0,kb.default)(),this.stage=new Fb.default({width:r.width,height:r.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new Bb.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(r){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:r}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(mr.EVENTS.MANAGERS.ORIENTATION_CHANGE,r)}.bind(this),500)}onResized(e){this.resize()}resize(e,r,i){let t=this.stage.size(e,r);if(this.winBounds=(0,Ln.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===t.width&&this._stageSize.height===t.height||(this._stageSize=t,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(mr.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,r){return new this.View(e,(0,Ln.extend)(this.viewSettings,{forceRight:r}))}handleNextPrePaginated(e,r,i){let t;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||r.index===0)return;if(t=r.next(),t&&!t.properties.includes("page-spread-left"))return i.call(this,t)}}display(e,r){var i=new Ln.defer,t=i.promise;(r===e.href||(0,Ln.isNumber)(r))&&(r=void 0);var n=this.views.find(e);if(n&&e&&this.layout.name!=="pre-paginated"){let o=n.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let f=n.width();this.scrollTo(o.left+f,o.top,!0)}if(r){let f=n.locationOf(r),h=n.width();this.moveTo(f,h)}return i.resolve(),t}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(o){if(r){let f=o.locationOf(r),h=o.width();this.moveTo(f,h)}}.bind(this),o=>{i.reject(o)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),i.resolve()}.bind(this)),t}afterDisplayed(e){this.emit(mr.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(mr.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,r){var i=0,t=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),t=Math.floor(e.top/this.layout.delta)*this.layout.delta,t+this.layout.delta>this.container.scrollHeight&&(t=this.container.scrollHeight-this.layout.delta)):t=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-r),this.scrollTo(i,t,!0)}add(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(mr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(mr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}append(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(mr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(mr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}prepend(e,r){var i=this.createView(e,r);return i.on(mr.EVENTS.VIEWS.RESIZED,t=>{this.counter(t)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(mr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(mr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,r<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft,r>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(r=this.container.scrollLeft+this.layout.delta*-1,r>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(t=!0),this.append(e,t).then(function(){return this.handleNextPrePaginated(t,e,this.append)}.bind(this),n=>n).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft,r>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft+this.container.offsetWidth,r<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(r=this.container.scrollLeft,r<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(t=!0),this.prepend(e,t).then(function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=e.prev(),n))return this.prepend(n)}.bind(this),n=>n).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=r.height<window.innerHeight?r.height:window.innerHeight,t=r.width<window.innerWidth?r.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=n?window.scrollY:window.scrollX),e.map(h=>{let{index:p,href:l}=h.section,u=h.position(),m=h.width(),y=h.height(),b,_,g,c;n?(b=a+r.top-u.top+o,_=b+i-o,c=this.layout.count(y,i).pages,g=i):(b=a+r.left-u.left+o,_=b+t-o,c=this.layout.count(m,t).pages,g=t);let v=Math.ceil(b/g),E=[],d=Math.ceil(_/g);if(this.settings.direction==="rtl"&&!n){let T=v;v=c-d,d=c-T}E=[];for(var x=v;x<=d;x++){let T=x+1;E.push(T)}let S=this.mapping.page(h.contents,h.section.cfiBase,b,_);return{index:p,href:l,pages:E,totalPages:c,mapping:S}})}paginatedLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=0,t=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:f}=a.section,h,p=a.position(),l=a.width(),u,m,y;this.settings.direction==="rtl"?(h=r.right-i,y=Math.min(Math.abs(h-p.left),this.layout.width)-t,m=p.width-(p.right-h)-t,u=m-y):(h=r.left+i,y=Math.min(p.right-h,this.layout.width)-t,u=h-p.left+t,m=u+y),t+=y;let b=this.mapping.page(a.contents,a.section.cfiBase,u,m),_=this.layout.count(l).pages,g=Math.floor(u/this.layout.pageWidth),c=[],v=Math.floor(m/this.layout.pageWidth);if(g<0&&(g=0,v=v+1),this.settings.direction==="rtl"){let d=g;g=_-v,v=_-d}for(var E=g+1;E<=v;E++){let d=E;c.push(d)}return{index:o,href:f,pages:c,totalPages:_,mapping:b}})}isVisible(e,r,i,t){var n=e.position(),a=t||this.bounds();return this.settings.axis==="horizontal"&&n.right>a.left-r&&n.left<a.right+i?!0:this.settings.axis==="vertical"&&n.bottom>a.top-r&&n.top<a.bottom+i}visible(){for(var e=this.bounds(),r=this.views.displayed(),i=r.length,t=[],n,a,o=0;o<i;o++)a=r[o],n=this.isVisible(a,0,0,e),n===!0&&t.push(a);return t}scrollBy(e,r,i){let t=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*t,r*t):(e&&(this.container.scrollLeft+=e*t),r&&(this.container.scrollTop+=r)),this.scrolled=!0}scrollTo(e,r,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,r):(this.container.scrollLeft=e,this.container.scrollTop=r),this.scrolled=!0}onScroll(){let e,r;this.settings.fullsize?(e=window.scrollY,r=window.scrollX):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:(this.emit(mr.EVENTS.MANAGERS.SCROLL,{top:e,left:r}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(mr.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){!this.stage||(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Fc.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(r){r&&r.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,r){!r&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Fc.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,r="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":r,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(r){const i=r&&r.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,Mb.default)(Bc.prototype);var Ub=Bc;On.default=Ub;var Sa={},to={};Object.defineProperty(to,"__esModule",{value:!0});to.default=void 0;var Uc=Be,jc=Ft,jb=Wb(Ar.exports);function Wb(s){return s&&s.__esModule?s:{default:s}}const zb=Math.PI/2,$b={easeOutSine:function(s){return Math.sin(s*zb)},easeInOutSine:function(s){return-.5*(Math.cos(Math.PI*s)-1)},easeInOutQuint:function(s){return(s/=.5)<1?.5*Math.pow(s,5):.5*(Math.pow(s-2,5)+2)},easeInCubic:function(s){return Math.pow(s,3)}};class Wc{constructor(e,r){this.settings=(0,Uc.extend)({duration:80,minVelocity:.2,minDistance:10,easing:$b.easeInCubic},r||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let r=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{r.on(i,t=>this.triggerViewEvent(t,r))})}triggerViewEvent(e,r){this.emit(e.type,e,r)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:r,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=r,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:r,screenY:i}=e.touches[0],t=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&t<10&&(this.element.scrollLeft-=r-this.endTouchX),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let r=this.wasSwiped();r!==0?this.snap(r):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,r=this.endTouchX-this.startTouchX,i=Math.abs(r),t=this.endTime-this.startTime,n=r/t,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(n>a)return-1;if(n<-a)return 1}needsSnap(){let e=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor;return e%r!=0}snap(e=0){let r=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,t=Math.round(r/i)*i;return e&&(t+=e*i),this.smoothScrollTo(t)}smoothScrollTo(e){const r=new Uc.defer,i=this.scrollLeft,t=this.now(),n=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const f=this.now(),h=Math.min(1,(f-t)/n);if(a(h),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,r.resolve();return}h<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*h,0)):(this.scrollTo(e,0),this.snapping=!1,r.resolve())}return o.call(this),r.promise}scrollTo(e=0,r=0){this.fullsize?window.scroll(e,r):(this.scroller.scrollLeft=e,this.scroller.scrollTop=r)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){!this.scroller||(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,jb.default)(Wc.prototype);var Vb=Wc;to.default=Vb;Object.defineProperty(Sa,"__esModule",{value:!0});Sa.default=void 0;var Wi=Be,zc=Kl(On),$c=Kl(to),Ir=Ft,Hb=Kl(Nc);function Kl(s){return s&&s.__esModule?s:{default:s}}class Kb extends zc.default{constructor(e){super(e);this.name="continuous",this.settings=(0,Wi.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,Wi.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,r){return zc.default.prototype.display.call(this,e,r).then(function(){return this.fill()}.bind(this))}fill(e){var r=e||new Wi.defer;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(r):r.resolve()}),r.promise}moveTo(e){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(r>0||i>0)&&this.scrollBy(r,i,!0)}afterResized(e){this.emit(Ir.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var r=this.createView(e);return this.views.append(r),r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.display(this.request)}append(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r}prepend(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{this.counter(i),r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var r=this.bounds(),i=this.views.all(),t=i.length,n=typeof e!="undefined"?e:this.settings.offset||0,a,o,f=new Wi.defer,h=[],p=0;p<t;p++)if(o=i[p],a=this.isVisible(o,n,n,r),a===!0)if(o.displayed)o.show();else{let l=o.display(this.request).then(function(u){u.show()},u=>{o.hide()});h.push(l)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return h.length?Promise.all(h).catch(l=>{f.reject(l)}):(f.resolve(),f.promise)}check(e,r){var i=new Wi.defer,t=[],n=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&n&&(a=e),r&&!n&&(a=r);var o=this._bounds;let f=n?this.scrollLeft:this.scrollTop,h=n?Math.floor(o.width):o.height,p=n?this.container.scrollWidth:this.container.scrollHeight,l=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",u=this.settings.rtlScrollType,m=this.settings.direction==="rtl";this.settings.fullsize?(n&&m&&u==="negative"||!n&&m&&u==="default")&&(f=f*-1):(m&&u==="default"&&l==="horizontal"&&(f=p-h-f),m&&u==="negative"&&l==="horizontal"&&(f=f*-1));let y=()=>{let v=this.views.first(),E=v&&v.section.prev();E&&t.push(this.prepend(E))},b=()=>{let v=this.views.last(),E=v&&v.section.next();E&&t.push(this.append(E))},_=f+h+a,g=f-a;_>=p&&b(),g<0&&y();let c=t.map(v=>v.display(this.request));return t.length?Promise.all(c).then(()=>this.check()).then(()=>this.update(a),v=>v):(this.q.enqueue(function(){this.update()}.bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Wi.defer,r=this.views.displayed(),i=r[0],t=r[r.length-1],n=this.views.indexOf(i),a=this.views.indexOf(t),o=this.views.slice(0,n),f=this.views.slice(a+1),h=0;h<o.length-1;h++)this.erase(o[h],o);for(var p=1;p<f.length;p++)this.erase(f[p]);return e.resolve(),e.promise}erase(e,r){var i,t;this.settings.fullsize?(i=window.scrollY,t=window.scrollX):(i=this.container.scrollTop,t=this.container.scrollLeft);var n=e.bounds();this.views.remove(e),r&&(this.settings.axis==="vertical"?this.scrollTo(0,i-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(t+Math.floor(n.width),0,!0):this.scrollTo(t,0,!0):this.scrollTo(t-Math.floor(n.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(r){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new $c.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Wi.requestAnimationFrame;let r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*r,this.scrollLeft=window.scrollX*r):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,Hb.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,r,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,r=window.scrollX*i):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(r-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=r,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(Ir.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ir.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new $c.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var Gb=Kb;Sa.default=Gb;Object.defineProperty(wn,"__esModule",{value:!0});wn.default=void 0;var Yb=Ur(Ar.exports),Ta=Be,zi=Ur(bn),Vc=Ur(Qt),Xb=Ur(xi),Zb=Ur(ga),Qb=Ur(Hs);Ur(ji);var Jb=Ur(Gs),pt=Ft,qb=Ur(Ea),e1=Ur(On),t1=Ur(Sa);function Ur(s){return s&&s.__esModule?s:{default:s}}class Hc{constructor(e,r){this.settings=(0,Ta.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,Ta.extend)(this.settings,r),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new zi.default(this),this.hooks.serialize=new zi.default(this),this.hooks.content=new zi.default(this),this.hooks.unloaded=new zi.default(this),this.hooks.layout=new zi.default(this),this.hooks.render=new zi.default(this),this.hooks.show=new zi.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new Qb.default(this),this.annotations=new Jb.default(this),this.epubcfi=new Vc.default,this.q=new Xb.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Ta.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var r;return typeof e=="string"&&e==="default"?r=e1.default:typeof e=="string"&&e==="continuous"?r=t1.default:r=e,r}requireView(e){var r;return typeof e=="string"&&e==="iframe"?r=qb.default:r=e,r}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(pt.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(pt.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(pt.EVENTS.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(!!this.book){this.epubcfi.isCfiString(e);var r=new Ta.defer,i=r.promise,t;return this.displaying=r,this.book.locations.length()&&(0,Ta.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),t=this.book.spine.get(e),t?(this.manager.display(t,e).then(()=>{r.resolve(t),this.displaying=void 0,this.emit(pt.EVENTS.RENDITION.DISPLAYED,t),this.reportLocation()},n=>{this.emit(pt.EVENTS.RENDITION.DISPLAY_ERROR,n)}),i):(r.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(pt.EVENTS.VIEWS.MARK_CLICKED,(r,i)=>this.triggerMarkEvent(r,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(pt.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,r){this.emit(pt.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},r),this.location&&this.location.start&&this.display(r||this.location.start.cfi)}onOrientationChange(e){this.emit(pt.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,r,i){e&&(this.settings.width=e),r&&(this.settings.height=r),this.manager.resize(e,r,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var r,i=this.settings.layout||e.layout||"reflowable",t=this.settings.spread||e.spread||"auto",n=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",f=this.settings.minSpreadWidth||e.minSpreadWidth||800,h=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),r={layout:i,spread:t,orientation:n,flow:a,viewport:o,minSpreadWidth:f,direction:h},r}flow(e){var r=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(r="scrolled"),(e==="auto"||e==="paginated")&&(r="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(r),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(r),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Zb.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(pt.EVENTS.LAYOUT.UPDATED,(r,i)=>{this.emit(pt.EVENTS.RENDITION.LAYOUT,r,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,r){this.settings.spread=e,r&&(this.settings.minSpreadWidth=r),this._layout&&this._layout.spread(e,r),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then(function(t){let n=this.located(t);!n||!n.start||!n.end||(this.location=n,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location))}.bind(this));else if(i){let t=this.located(i);if(!t||!t.start||!t.end)return;this.location=t,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(r){return this.located(r)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let r=e[0],i=e[e.length-1],t={start:{index:r.index,href:r.href,cfi:r.mapping.start,displayed:{page:r.pages[0]||1,total:r.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},n=this.book.locations.locationFromCfi(r.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);n!=null&&(t.start.location=n,t.start.percentage=this.book.locations.percentageFromLocation(n)),a!=null&&(t.end.location=a,t.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(r.mapping.start),f=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(t.start.page=o),f!=-1&&(t.end.page=f),i.index===this.book.spine.last().index&&t.end.displayed.page>=t.end.displayed.total&&(t.atEnd=!0),r.index===this.book.spine.first().index&&t.start.displayed.page===1&&(t.atStart=!0),t}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){pt.DOM_EVENTS.forEach(r=>{e.on(r,i=>this.triggerViewEvent(i,e))}),e.on(pt.EVENTS.CONTENTS.SELECTED,r=>this.triggerSelectedEvent(r,e))}triggerViewEvent(e,r){this.emit(e.type,e,r)}triggerSelectedEvent(e,r){this.emit(pt.EVENTS.RENDITION.SELECTED,e,r)}triggerMarkEvent(e,r,i){this.emit(pt.EVENTS.RENDITION.MARK_CLICKED,e,r,i)}getRange(e,r){var i=new Vc.default(e),t=this.manager.visible().filter(function(n){if(i.spinePos===n.index)return!0});if(t.length)return t[0].contents.range(i,r)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let r=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)))*.95,t=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,a){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(pt.EVENTS.CONTENTS.LINK_CLICKED,r=>{let i=this.book.path.relative(r);this.display(i)})}injectStylesheet(e,r){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,r){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,r){let i=this.book.packaging.metadata.identifier,t=e.createElement("meta");t.setAttribute("name","dc.relation.ispartof"),i&&t.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(t)}}(0,Yb.default)(Hc.prototype);var r1=Hc;wn.default=r1;var ro={},Kc={exports:{}};/*!

JSZip v3.7.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(h,p){if(!t[h]){if(!i[h]){var l=typeof Er=="function"&&Er;if(!p&&l)return l(h,!0);if(o)return o(h,!0);var u=new Error("Cannot find module '"+h+"'");throw u.code="MODULE_NOT_FOUND",u}var m=t[h]={exports:{}};i[h][0].call(m.exports,function(y){var b=i[h][1][y];return a(b||y)},m,m.exports,r,i,t,n)}return t[h].exports}for(var o=typeof Er=="function"&&Er,f=0;f<n.length;f++)a(n[f]);return a}({1:[function(r,i,t){var n=r("./utils"),a=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(f){for(var h=[],p,l,u,m,y,b,_,g=0,c=f.length,v=c,E=n.getTypeOf(f)!=="string";g<f.length;)v=c-g,E?(p=f[g++],l=g<c?f[g++]:0,u=g<c?f[g++]:0):(p=f.charCodeAt(g++),l=g<c?f.charCodeAt(g++):0,u=g<c?f.charCodeAt(g++):0),m=p>>2,y=(p&3)<<4|l>>4,b=v>1?(l&15)<<2|u>>6:64,_=v>2?u&63:64,h.push(o.charAt(m)+o.charAt(y)+o.charAt(b)+o.charAt(_));return h.join("")},t.decode=function(f){var h,p,l,u,m,y,b,_=0,g=0,c="data:";if(f.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");var v=f.length*3/4;if(f.charAt(f.length-1)===o.charAt(64)&&v--,f.charAt(f.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");var E;for(a.uint8array?E=new Uint8Array(v|0):E=new Array(v|0);_<f.length;)u=o.indexOf(f.charAt(_++)),m=o.indexOf(f.charAt(_++)),y=o.indexOf(f.charAt(_++)),b=o.indexOf(f.charAt(_++)),h=u<<2|m>>4,p=(m&15)<<4|y>>2,l=(y&3)<<6|b,E[g++]=h,y!==64&&(E[g++]=p),b!==64&&(E[g++]=l);return E}},{"./support":30,"./utils":32}],2:[function(r,i,t){var n=r("./external"),a=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),f=r("./stream/DataLengthProbe");function h(p,l,u,m,y){this.compressedSize=p,this.uncompressedSize=l,this.crc32=u,this.compression=m,this.compressedContent=y}h.prototype={getContentWorker:function(){var p=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),l=this;return p.on("end",function(){if(this.streamInfo.data_length!==l.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(p,l,u){return p.pipe(new o).pipe(new f("uncompressedSize")).pipe(l.compressWorker(u)).pipe(new f("compressedSize")).withStreamInfo("compression",l)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,i,t){var n=r("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(a){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},t.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,i,t){var n=r("./utils");function a(){for(var p,l=[],u=0;u<256;u++){p=u;for(var m=0;m<8;m++)p=p&1?3988292384^p>>>1:p>>>1;l[u]=p}return l}var o=a();function f(p,l,u,m){var y=o,b=m+u;p=p^-1;for(var _=m;_<b;_++)p=p>>>8^y[(p^l[_])&255];return p^-1}function h(p,l,u,m){var y=o,b=m+u;p=p^-1;for(var _=m;_<b;_++)p=p>>>8^y[(p^l.charCodeAt(_))&255];return p^-1}i.exports=function(l,u){if(typeof l=="undefined"||!l.length)return 0;var m=n.getTypeOf(l)!=="string";return m?f(u|0,l,l.length,0):h(u|0,l,l.length,0)}},{"./utils":32}],5:[function(r,i,t){t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(r,i,t){var n=null;typeof Promise!="undefined"?n=Promise:n=r("lie"),i.exports={Promise:n}},{lie:37}],7:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",a=r("pako"),o=r("./utils"),f=r("./stream/GenericWorker"),h=n?"uint8array":"array";t.magic="\b\0";function p(l,u){f.call(this,"FlateWorker/"+l),this._pako=null,this._pakoAction=l,this._pakoOptions=u,this.meta={}}o.inherits(p,f),p.prototype.processChunk=function(l){this.meta=l.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(h,l.data),!1)},p.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var l=this;this._pako.onData=function(u){l.push({data:u,meta:l.meta})}},t.compressWorker=function(l){return new p("Deflate",l)},t.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker"),o=r("../utf8"),f=r("../crc32"),h=r("../signature"),p=function(g,c){var v="",E;for(E=0;E<c;E++)v+=String.fromCharCode(g&255),g=g>>>8;return v},l=function(g,c){var v=g;return g||(v=c?16893:33204),(v&65535)<<16},u=function(g,c){return(g||0)&63},m=function(g,c,v,E,d,x){var S=g.file,T=g.compression,w=x!==o.utf8encode,L=n.transformTo("string",x(S.name)),I=n.transformTo("string",o.utf8encode(S.name)),A=S.comment,O=n.transformTo("string",x(A)),D=n.transformTo("string",o.utf8encode(A)),R=I.length!==S.name.length,C=D.length!==A.length,P,M,N="",B="",U="",F=S.dir,j=S.date,$={crc32:0,compressedSize:0,uncompressedSize:0};(!c||v)&&($.crc32=g.crc32,$.compressedSize=g.compressedSize,$.uncompressedSize=g.uncompressedSize);var G=0;c&&(G|=8),!w&&(R||C)&&(G|=2048);var Y=0,X=0;F&&(Y|=16),d==="UNIX"?(X=798,Y|=l(S.unixPermissions,F)):(X=20,Y|=u(S.dosPermissions)),P=j.getUTCHours(),P=P<<6,P=P|j.getUTCMinutes(),P=P<<5,P=P|j.getUTCSeconds()/2,M=j.getUTCFullYear()-1980,M=M<<4,M=M|j.getUTCMonth()+1,M=M<<5,M=M|j.getUTCDate(),R&&(B=p(1,1)+p(f(L),4)+I,N+="up"+p(B.length,2)+B),C&&(U=p(1,1)+p(f(O),4)+D,N+="uc"+p(U.length,2)+U);var ie="";ie+=`
\0`,ie+=p(G,2),ie+=T.magic,ie+=p(P,2),ie+=p(M,2),ie+=p($.crc32,4),ie+=p($.compressedSize,4),ie+=p($.uncompressedSize,4),ie+=p(L.length,2),ie+=p(N.length,2);var pe=h.LOCAL_FILE_HEADER+ie+L+N,ue=h.CENTRAL_FILE_HEADER+p(X,2)+ie+p(O.length,2)+"\0\0\0\0"+p(Y,4)+p(E,4)+L+N+O;return{fileRecord:pe,dirRecord:ue}},y=function(g,c,v,E,d){var x="",S=n.transformTo("string",d(E));return x=h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(g,2)+p(g,2)+p(c,4)+p(v,4)+p(S.length,2)+S,x},b=function(g){var c="";return c=h.DATA_DESCRIPTOR+p(g.crc32,4)+p(g.compressedSize,4)+p(g.uncompressedSize,4),c};function _(g,c,v,E){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=v,this.encodeFileName=E,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(_,a),_.prototype.push=function(g){var c=g.meta.percent||0,v=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,a.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:v?(c+100*(v-E-1))/v:100}}))},_.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var c=this.streamFiles&&!g.file.dir;if(c){var v=m(g,c,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(g){this.accumulate=!1;var c=this.streamFiles&&!g.file.dir,v=m(g,c,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),c)this.push({data:b(g),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var g=this.bytesWritten,c=0;c<this.dirRecords.length;c++)this.push({data:this.dirRecords[c],meta:{percent:100}});var v=this.bytesWritten-g,E=y(this.dirRecords.length,v,g,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(g){this._sources.push(g);var c=this;return g.on("data",function(v){c.processChunk(v)}),g.on("end",function(){c.closedSource(c.previous.streamInfo),c._sources.length?c.prepareNextSource():c.end()}),g.on("error",function(v){c.error(v)}),this},_.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},_.prototype.error=function(g){var c=this._sources;if(!a.prototype.error.call(this,g))return!1;for(var v=0;v<c.length;v++)try{c[v].error(g)}catch(E){}return!0},_.prototype.lock=function(){a.prototype.lock.call(this);for(var g=this._sources,c=0;c<g.length;c++)g[c].lock()},i.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,i,t){var n=r("../compressions"),a=r("./ZipFileWorker"),o=function(f,h){var p=f||h,l=n[p];if(!l)throw new Error(p+" is not a valid compression method !");return l};t.generateWorker=function(f,h,p){var l=new a(h.streamFiles,p,h.platform,h.encodeFileName),u=0;try{f.forEach(function(m,y){u++;var b=o(y.options.compression,h.compression),_=y.options.compressionOptions||h.compressionOptions||{},g=y.dir,c=y.date;y._compressWorker(b,_).withStreamInfo("file",{name:m,dir:g,date:c,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(l)}),l.entriesCount=u}catch(m){l.error(m)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,i,t){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new n;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}n.prototype=r("./object"),n.prototype.loadAsync=r("./load"),n.support=r("./support"),n.defaults=r("./defaults"),n.version="3.7.1",n.loadAsync=function(a,o){return new n().loadAsync(a,o)},n.external=r("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,i,t){var n=r("./utils"),a=r("./external"),o=r("./utf8"),f=r("./zipEntries"),h=r("./stream/Crc32Probe"),p=r("./nodejsUtils");function l(u){return new a.Promise(function(m,y){var b=u.decompressed.getContentWorker().pipe(new h);b.on("error",function(_){y(_)}).on("end",function(){b.streamInfo.crc32!==u.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}i.exports=function(u,m){var y=this;return m=n.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),p.isNode&&p.isStream(u)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",u,!0,m.optimizedBinaryString,m.base64).then(function(b){var _=new f(m);return _.load(b),_}).then(function(_){var g=[a.Promise.resolve(_)],c=_.files;if(m.checkCRC32)for(var v=0;v<c.length;v++)g.push(l(c[v]));return a.Promise.all(g)}).then(function(_){for(var g=_.shift(),c=g.files,v=0;v<c.length;v++){var E=c[v];y.file(E.fileNameStr,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:m.createFolders})}return g.zipComment.length&&(y.comment=g.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker");function o(f,h){a.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(h)}n.inherits(o,a),o.prototype._bindStream=function(f){var h=this;this._stream=f,f.pause(),f.on("data",function(p){h.push({data:p,meta:{percent:0}})}).on("error",function(p){h.isPaused?this.generatedError=p:h.error(p)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,i,t){var n=r("readable-stream").Readable,a=r("../utils");a.inherits(o,n);function o(f,h,p){n.call(this,h),this._helper=f;var l=this;f.on("data",function(u,m){l.push(u)||l._helper.pause(),p&&p(m)}).on("error",function(u){l.emit("error",u)}).on("end",function(){l.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,i,t){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,a);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,a)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var a=new Buffer(n);return a.fill(0),a},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(r,i,t){var n=r("./utf8"),a=r("./utils"),o=r("./stream/GenericWorker"),f=r("./stream/StreamHelper"),h=r("./defaults"),p=r("./compressedObject"),l=r("./zipObject"),u=r("./generate"),m=r("./nodejsUtils"),y=r("./nodejs/NodejsStreamInputAdapter"),b=function(d,x,S){var T=a.getTypeOf(x),w,L=a.extend(S||{},h);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(d=g(d)),L.createFolders&&(w=_(d))&&c.call(this,w,!0);var I=T==="string"&&L.binary===!1&&L.base64===!1;(!S||typeof S.binary=="undefined")&&(L.binary=!I);var A=x instanceof p&&x.uncompressedSize===0;(A||L.dir||!x||x.length===0)&&(L.base64=!1,L.binary=!0,x="",L.compression="STORE",T="string");var O=null;x instanceof p||x instanceof o?O=x:m.isNode&&m.isStream(x)?O=new y(d,x):O=a.prepareContent(d,x,L.binary,L.optimizedBinaryString,L.base64);var D=new l(d,O,L);this.files[d]=D},_=function(d){d.slice(-1)==="/"&&(d=d.substring(0,d.length-1));var x=d.lastIndexOf("/");return x>0?d.substring(0,x):""},g=function(d){return d.slice(-1)!=="/"&&(d+="/"),d},c=function(d,x){return x=typeof x!="undefined"?x:h.createFolders,d=g(d),this.files[d]||b.call(this,d,null,{dir:!0,createFolders:x}),this.files[d]};function v(d){return Object.prototype.toString.call(d)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(d){var x,S,T;for(x in this.files)T=this.files[x],S=x.slice(this.root.length,x.length),S&&x.slice(0,this.root.length)===this.root&&d(S,T)},filter:function(d){var x=[];return this.forEach(function(S,T){d(S,T)&&x.push(T)}),x},file:function(d,x,S){if(arguments.length===1)if(v(d)){var T=d;return this.filter(function(L,I){return!I.dir&&T.test(L)})}else{var w=this.files[this.root+d];return w&&!w.dir?w:null}else d=this.root+d,b.call(this,d,x,S);return this},folder:function(d){if(!d)return this;if(v(d))return this.filter(function(w,L){return L.dir&&d.test(w)});var x=this.root+d,S=c.call(this,x),T=this.clone();return T.root=S.name,T},remove:function(d){d=this.root+d;var x=this.files[d];if(x||(d.slice(-1)!=="/"&&(d+="/"),x=this.files[d]),x&&!x.dir)delete this.files[d];else for(var S=this.filter(function(w,L){return L.name.slice(0,d.length)===d}),T=0;T<S.length;T++)delete this.files[S[T].name];return this},generate:function(d){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(d){var x,S={};try{if(S=a.extend(d||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),S.type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");a.checkSupport(S.type),(S.platform==="darwin"||S.platform==="freebsd"||S.platform==="linux"||S.platform==="sunos")&&(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var T=S.comment||this.comment||"";x=u.generateWorker(this,S,T)}catch(w){x=new o("error"),x.error(w)}return new f(x,S.type||"string",S.mimeType)},generateAsync:function(d,x){return this.generateInternalStream(d).accumulate(x)},generateNodeStream:function(d,x){return d=d||{},d.type||(d.type="nodebuffer"),this.generateInternalStream(d).toNodejsStream(x)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,i,t){i.exports=r("stream")},{stream:void 0}],17:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(f){n.call(this,f);for(var h=0;h<this.data.length;h++)f[h]=f[h]&255}a.inherits(o,n),o.prototype.byteAt=function(f){return this.data[this.zero+f]},o.prototype.lastIndexOfSignature=function(f){for(var h=f.charCodeAt(0),p=f.charCodeAt(1),l=f.charCodeAt(2),u=f.charCodeAt(3),m=this.length-4;m>=0;--m)if(this.data[m]===h&&this.data[m+1]===p&&this.data[m+2]===l&&this.data[m+3]===u)return m-this.zero;return-1},o.prototype.readAndCheckSignature=function(f){var h=f.charCodeAt(0),p=f.charCodeAt(1),l=f.charCodeAt(2),u=f.charCodeAt(3),m=this.readData(4);return h===m[0]&&p===m[1]&&l===m[2]&&u===m[3]},o.prototype.readData=function(f){if(this.checkOffset(f),f===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,h},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,i,t){var n=r("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(o){},readInt:function(o){var f=0,h;for(this.checkOffset(o),h=this.index+o-1;h>=this.index;h--)f=(f<<8)+this.byteAt(h);return this.index+=o,f},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(o){},lastIndexOfSignature:function(o){},readAndCheckSignature:function(o){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(r,i,t){var n=r("./Uint8ArrayReader"),a=r("../utils");function o(f){n.call(this,f)}a.inherits(o,n),o.prototype.readData=function(f){this.checkOffset(f);var h=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,h},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(f){n.call(this,f)}a.inherits(o,n),o.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)},o.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero},o.prototype.readAndCheckSignature=function(f){var h=this.readData(4);return f===h},o.prototype.readData=function(f){this.checkOffset(f);var h=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,h},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,i,t){var n=r("./ArrayReader"),a=r("../utils");function o(f){n.call(this,f)}a.inherits(o,n),o.prototype.readData=function(f){if(this.checkOffset(f),f===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,h},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,i,t){var n=r("../utils"),a=r("../support"),o=r("./ArrayReader"),f=r("./StringReader"),h=r("./NodeBufferReader"),p=r("./Uint8ArrayReader");i.exports=function(l){var u=n.getTypeOf(l);return n.checkSupport(u),u==="string"&&!a.uint8array?new f(l):u==="nodebuffer"?new h(l):a.uint8array?new p(n.transformTo("uint8array",l)):new o(n.transformTo("array",l))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,i,t){t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,i,t){var n=r("./GenericWorker"),a=r("../utils");function o(f){n.call(this,"ConvertWorker to "+f),this.destType=f}a.inherits(o,n),o.prototype.processChunk=function(f){this.push({data:a.transformTo(this.destType,f.data),meta:f.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,i,t){var n=r("./GenericWorker"),a=r("../crc32"),o=r("../utils");function f(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(f,n),f.prototype.processChunk=function(h){this.streamInfo.crc32=a(h.data,this.streamInfo.crc32||0),this.push(h)},i.exports=f},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker");function o(f){a.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}n.inherits(o,a),o.prototype.processChunk=function(f){if(f){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+f.data.length}a.prototype.processChunk.call(this,f)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker"),o=16*1024;function f(h){a.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(l){p.dataIsReady=!0,p.data=l,p.max=l&&l.length||0,p.type=n.getTypeOf(l),p.isPaused||p._tickAndRepeat()},function(l){p.error(l)})}n.inherits(f,a),f.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},f.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},f.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},f.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=o,p=null,l=Math.min(this.max,this.index+h);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,l);break;case"uint8array":p=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":p=this.data.slice(this.index,l);break}return this.index=l,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=f},{"../utils":32,"./GenericWorker":28}],28:[function(r,i,t){function n(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var f=0;f<this._listeners[a].length;f++)this._listeners[a][f].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(f){o.processChunk(f)}),a.on("end",function(){o.end()}),a.on("error",function(f){o.error(f)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)!this.extraStreamInfo.hasOwnProperty(a)||(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=n},{}],29:[function(r,i,t){var n=r("../utils"),a=r("./ConvertWorker"),o=r("./GenericWorker"),f=r("../base64"),h=r("../support"),p=r("../external"),l=null;if(h.nodestream)try{l=r("../nodejs/NodejsStreamOutputAdapter")}catch(_){}function u(_,g,c){switch(_){case"blob":return n.newBlob(n.transformTo("arraybuffer",g),c);case"base64":return f.encode(g);default:return n.transformTo(_,g)}}function m(_,g){var c,v=0,E=null,d=0;for(c=0;c<g.length;c++)d+=g[c].length;switch(_){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(E=new Uint8Array(d),c=0;c<g.length;c++)E.set(g[c],v),v+=g[c].length;return E;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+_+"'")}}function y(_,g){return new p.Promise(function(c,v){var E=[],d=_._internalType,x=_._outputType,S=_._mimeType;_.on("data",function(T,w){E.push(T),g&&g(w)}).on("error",function(T){E=[],v(T)}).on("end",function(){try{var T=u(x,m(d,E),S);c(T)}catch(w){v(w)}E=[]}).resume()})}function b(_,g,c){var v=g;switch(g){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=g,this._mimeType=c,n.checkSupport(v),this._worker=_.pipe(new a(v)),_.lock()}catch(E){this._worker=new o("error"),this._worker.error(E)}}b.prototype={accumulate:function(_){return y(this,_)},on:function(_,g){var c=this;return _==="data"?this._worker.on(_,function(v){g.call(c,v.data,v.meta)}):this._worker.on(_,function(){n.delay(g,arguments,c)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:this._outputType!=="nodebuffer"},_)}},i.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,i,t){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",t.nodebuffer=typeof Buffer!="undefined",t.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")t.blob=!1;else{var n=new ArrayBuffer(0);try{t.blob=new Blob([n],{type:"application/zip"}).size===0}catch(f){try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(n),t.blob=o.getBlob("application/zip").size===0}catch(h){t.blob=!1}}}try{t.nodestream=!!r("readable-stream").Readable}catch(f){t.nodestream=!1}},{"readable-stream":16}],31:[function(r,i,t){for(var n=r("./utils"),a=r("./support"),o=r("./nodejsUtils"),f=r("./stream/GenericWorker"),h=new Array(256),p=0;p<256;p++)h[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;h[254]=h[254]=1;var l=function(_){var g,c,v,E,d,x=_.length,S=0;for(E=0;E<x;E++)c=_.charCodeAt(E),(c&64512)==55296&&E+1<x&&(v=_.charCodeAt(E+1),(v&64512)==56320&&(c=65536+(c-55296<<10)+(v-56320),E++)),S+=c<128?1:c<2048?2:c<65536?3:4;for(a.uint8array?g=new Uint8Array(S):g=new Array(S),d=0,E=0;d<S;E++)c=_.charCodeAt(E),(c&64512)==55296&&E+1<x&&(v=_.charCodeAt(E+1),(v&64512)==56320&&(c=65536+(c-55296<<10)+(v-56320),E++)),c<128?g[d++]=c:c<2048?(g[d++]=192|c>>>6,g[d++]=128|c&63):c<65536?(g[d++]=224|c>>>12,g[d++]=128|c>>>6&63,g[d++]=128|c&63):(g[d++]=240|c>>>18,g[d++]=128|c>>>12&63,g[d++]=128|c>>>6&63,g[d++]=128|c&63);return g},u=function(_,g){var c;for(g=g||_.length,g>_.length&&(g=_.length),c=g-1;c>=0&&(_[c]&192)==128;)c--;return c<0||c===0?g:c+h[_[c]]>g?c:g},m=function(_){var g,c,v,E,d=_.length,x=new Array(d*2);for(c=0,g=0;g<d;){if(v=_[g++],v<128){x[c++]=v;continue}if(E=h[v],E>4){x[c++]=65533,g+=E-1;continue}for(v&=E===2?31:E===3?15:7;E>1&&g<d;)v=v<<6|_[g++]&63,E--;if(E>1){x[c++]=65533;continue}v<65536?x[c++]=v:(v-=65536,x[c++]=55296|v>>10&1023,x[c++]=56320|v&1023)}return x.length!==c&&(x.subarray?x=x.subarray(0,c):x.length=c),n.applyFromCharCode(x)};t.utf8encode=function(g){return a.nodebuffer?o.newBufferFrom(g,"utf-8"):l(g)},t.utf8decode=function(g){return a.nodebuffer?n.transformTo("nodebuffer",g).toString("utf-8"):(g=n.transformTo(a.uint8array?"uint8array":"array",g),m(g))};function y(){f.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(y,f),y.prototype.processChunk=function(_){var g=n.transformTo(a.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var c=g;g=new Uint8Array(c.length+this.leftOver.length),g.set(this.leftOver,0),g.set(c,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var v=u(g),E=g;v!==g.length&&(a.uint8array?(E=g.subarray(0,v),this.leftOver=g.subarray(v,g.length)):(E=g.slice(0,v),this.leftOver=g.slice(v,g.length))),this.push({data:t.utf8decode(E),meta:_.meta})},y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=y;function b(){f.call(this,"utf-8 encode")}n.inherits(b,f),b.prototype.processChunk=function(_){this.push({data:t.utf8encode(_.data),meta:_.meta})},t.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,i,t){var n=r("./support"),a=r("./base64"),o=r("./nodejsUtils"),f=r("set-immediate-shim"),h=r("./external");function p(g){var c=null;return n.uint8array?c=new Uint8Array(g.length):c=new Array(g.length),u(g,c)}t.newBlob=function(g,c){t.checkSupport("blob");try{return new Blob([g],{type:c})}catch(d){try{var v=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,E=new v;return E.append(g),E.getBlob(c)}catch(x){throw new Error("Bug : can't construct the Blob.")}}};function l(g){return g}function u(g,c){for(var v=0;v<g.length;++v)c[v]=g.charCodeAt(v)&255;return c}var m={stringifyByChunk:function(g,c,v){var E=[],d=0,x=g.length;if(x<=v)return String.fromCharCode.apply(null,g);for(;d<x;)c==="array"||c==="nodebuffer"?E.push(String.fromCharCode.apply(null,g.slice(d,Math.min(d+v,x)))):E.push(String.fromCharCode.apply(null,g.subarray(d,Math.min(d+v,x)))),d+=v;return E.join("")},stringifyByChar:function(g){for(var c="",v=0;v<g.length;v++)c+=String.fromCharCode(g[v]);return c},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(g){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch(g){return!1}}()}};function y(g){var c=65536,v=t.getTypeOf(g),E=!0;if(v==="uint8array"?E=m.applyCanBeUsed.uint8array:v==="nodebuffer"&&(E=m.applyCanBeUsed.nodebuffer),E)for(;c>1;)try{return m.stringifyByChunk(g,v,c)}catch(d){c=Math.floor(c/2)}return m.stringifyByChar(g)}t.applyFromCharCode=y;function b(g,c){for(var v=0;v<g.length;v++)c[v]=g[v];return c}var _={};_.string={string:l,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return _.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,o.allocBuffer(g.length))}},_.array={string:y,array:l,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(g)}},_.arraybuffer={string:function(g){return y(new Uint8Array(g))},array:function(g){return b(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:l,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(new Uint8Array(g))}},_.uint8array={string:y,array:function(g){return b(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:l,nodebuffer:function(g){return o.newBufferFrom(g)}},_.nodebuffer={string:y,array:function(g){return b(g,new Array(g.length))},arraybuffer:function(g){return _.nodebuffer.uint8array(g).buffer},uint8array:function(g){return b(g,new Uint8Array(g.length))},nodebuffer:l},t.transformTo=function(g,c){if(c||(c=""),!g)return c;t.checkSupport(g);var v=t.getTypeOf(c),E=_[v][g](c);return E},t.getTypeOf=function(g){if(typeof g=="string")return"string";if(Object.prototype.toString.call(g)==="[object Array]")return"array";if(n.nodebuffer&&o.isBuffer(g))return"nodebuffer";if(n.uint8array&&g instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&g instanceof ArrayBuffer)return"arraybuffer"},t.checkSupport=function(g){var c=n[g.toLowerCase()];if(!c)throw new Error(g+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(g){var c="",v,E;for(E=0;E<(g||"").length;E++)v=g.charCodeAt(E),c+="\\x"+(v<16?"0":"")+v.toString(16).toUpperCase();return c},t.delay=function(g,c,v){f(function(){g.apply(v||null,c||[])})},t.inherits=function(g,c){var v=function(){};v.prototype=c.prototype,g.prototype=new v},t.extend=function(){var g={},c,v;for(c=0;c<arguments.length;c++)for(v in arguments[c])arguments[c].hasOwnProperty(v)&&typeof g[v]=="undefined"&&(g[v]=arguments[c][v]);return g},t.prepareContent=function(g,c,v,E,d){var x=h.Promise.resolve(c).then(function(S){var T=n.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1);return T&&typeof FileReader!="undefined"?new h.Promise(function(w,L){var I=new FileReader;I.onload=function(A){w(A.target.result)},I.onerror=function(A){L(A.target.error)},I.readAsArrayBuffer(S)}):S});return x.then(function(S){var T=t.getTypeOf(S);return T?(T==="arraybuffer"?S=t.transformTo("uint8array",S):T==="string"&&(d?S=a.decode(S):v&&E!==!0&&(S=p(S))),S):h.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./signature"),f=r("./zipEntry");r("./utf8");var h=r("./support");function p(l){this.files=[],this.loadOptions=l}p.prototype={checkSignature:function(l){if(!this.reader.readAndCheckSignature(l)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(u)+", expected "+a.pretty(l)+")")}},isSignature:function(l,u){var m=this.reader.index;this.reader.setIndex(l);var y=this.reader.readString(4),b=y===u;return this.reader.setIndex(m),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var l=this.reader.readData(this.zipCommentLength),u=h.uint8array?"uint8array":"array",m=a.transformTo(u,l);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var l=this.zip64EndOfCentralSize-44,u=0,m,y,b;u<l;)m=this.reader.readInt(2),y=this.reader.readInt(4),b=this.reader.readData(y),this.zip64ExtensibleData[m]={id:m,length:y,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var l,u;for(l=0;l<this.files.length;l++)u=this.files[l],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var l;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)l=new f({zip64:this.zip64},this.loadOptions),l.readCentralPart(this.reader),this.files.push(l);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var l=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(l<0){var u=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw u?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(l);var m=l;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,l=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),l<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(l),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var b=m-y;if(b>0)this.isSignature(m,o.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(l){this.reader=n(l)},load:function(l){this.prepareReader(l),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./compressedObject"),f=r("./crc32"),h=r("./utf8"),p=r("./compressions"),l=r("./support"),u=0,m=3,y=function(_){for(var g in p)if(!!p.hasOwnProperty(g)&&p[g].magic===_)return p[g];return null};function b(_,g){this.options=_,this.loadOptions=g}b.prototype={isEncrypted:function(){return(this.bitFlag&1)==1},useUTF8:function(){return(this.bitFlag&2048)==2048},readLocalPart:function(_){var g,c;if(_.skip(22),this.fileNameLength=_.readInt(2),c=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=y(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var g=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(g),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),_===u&&(this.dosPermissions=this.externalFileAttributes&63),_===m&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(_){if(!!this.extraFields[1]){var g=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(_){var g=_.index+this.extraFieldsLength,c,v,E;for(this.extraFields||(this.extraFields={});_.index+4<g;)c=_.readInt(2),v=_.readInt(2),E=_.readData(v),this.extraFields[c]={id:c,length:v,value:E};_.setIndex(g)},handleUTF8:function(){var _=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var c=a.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var E=a.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var g=n(_.value);return g.readInt(1)!==1||f(this.fileName)!==g.readInt(4)?null:h.utf8decode(g.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var g=n(_.value);return g.readInt(1)!==1||f(this.fileComment)!==g.readInt(4)?null:h.utf8decode(g.readData(_.length-5))}return null}},i.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,i,t){var n=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),o=r("./utf8"),f=r("./compressedObject"),h=r("./stream/GenericWorker"),p=function(y,b,_){this.name=y,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=b,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}};p.prototype={internalStream:function(y){var b=null,_="string";try{if(!y)throw new Error("No output type specified.");_=y.toLowerCase();var g=_==="string"||_==="text";(_==="binarystring"||_==="text")&&(_="string"),b=this._decompressWorker();var c=!this._dataBinary;c&&!g&&(b=b.pipe(new o.Utf8EncodeWorker)),!c&&g&&(b=b.pipe(new o.Utf8DecodeWorker))}catch(v){b=new h("error"),b.error(v)}return new n(b,_,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof f&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new o.Utf8EncodeWorker)),f.createWorkerFrom(_,y,b)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<l.length;m++)p.prototype[l[m]]=u;i.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var f=0,h=new a(y),p=n.document.createTextNode("");h.observe(p,{characterData:!0}),o=function(){p.data=f=++f%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var l=new n.MessageChannel;l.port1.onmessage=y,o=function(){l.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var _=n.document.createElement("script");_.onreadystatechange=function(){y(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},n.document.documentElement.appendChild(_)}:o=function(){setTimeout(y,0)};var u,m=[];function y(){u=!0;for(var _,g,c=m.length;c;){for(g=m,m=[],_=-1;++_<c;)g[_]();c=m.length}u=!1}i.exports=b;function b(_){m.push(_)===1&&!u&&o()}}).call(this,typeof Mt!="undefined"?Mt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(r,i,t){var n=r("immediate");function a(){}var o={},f=["REJECTED"],h=["FULFILLED"],p=["PENDING"];i.exports=l;function l(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,d!==a&&b(this,d)}l.prototype.finally=function(d){if(typeof d!="function")return this;var x=this.constructor;return this.then(S,T);function S(w){function L(){return w}return x.resolve(d()).then(L)}function T(w){function L(){throw w}return x.resolve(d()).then(L)}},l.prototype.catch=function(d){return this.then(null,d)},l.prototype.then=function(d,x){if(typeof d!="function"&&this.state===h||typeof x!="function"&&this.state===f)return this;var S=new this.constructor(a);if(this.state!==p){var T=this.state===h?d:x;m(S,T,this.outcome)}else this.queue.push(new u(S,d,x));return S};function u(d,x,S){this.promise=d,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}u.prototype.callFulfilled=function(d){o.resolve(this.promise,d)},u.prototype.otherCallFulfilled=function(d){m(this.promise,this.onFulfilled,d)},u.prototype.callRejected=function(d){o.reject(this.promise,d)},u.prototype.otherCallRejected=function(d){m(this.promise,this.onRejected,d)};function m(d,x,S){n(function(){var T;try{T=x(S)}catch(w){return o.reject(d,w)}T===d?o.reject(d,new TypeError("Cannot resolve promise with itself")):o.resolve(d,T)})}o.resolve=function(d,x){var S=_(y,x);if(S.status==="error")return o.reject(d,S.value);var T=S.value;if(T)b(d,T);else{d.state=h,d.outcome=x;for(var w=-1,L=d.queue.length;++w<L;)d.queue[w].callFulfilled(x)}return d},o.reject=function(d,x){d.state=f,d.outcome=x;for(var S=-1,T=d.queue.length;++S<T;)d.queue[S].callRejected(x);return d};function y(d){var x=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof x=="function")return function(){x.apply(d,arguments)}}function b(d,x){var S=!1;function T(A){S||(S=!0,o.reject(d,A))}function w(A){S||(S=!0,o.resolve(d,A))}function L(){x(w,T)}var I=_(L);I.status==="error"&&T(I.value)}function _(d,x){var S={};try{S.value=d(x),S.status="success"}catch(T){S.status="error",S.value=T}return S}l.resolve=g;function g(d){return d instanceof this?d:o.resolve(new this(a),d)}l.reject=c;function c(d){var x=new this(a);return o.reject(x,d)}l.all=v;function v(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,T=!1;if(!S)return this.resolve([]);for(var w=new Array(S),L=0,I=-1,A=new this(a);++I<S;)O(d[I],I);return A;function O(D,R){x.resolve(D).then(C,function(P){T||(T=!0,o.reject(A,P))});function C(P){w[R]=P,++L===S&&!T&&(T=!0,o.resolve(A,w))}}}l.race=E;function E(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,T=!1;if(!S)return this.resolve([]);for(var w=-1,L=new this(a);++w<S;)I(d[w]);return L;function I(A){x.resolve(A).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{immediate:36}],38:[function(r,i,t){var n=r("./lib/utils/common").assign,a=r("./lib/deflate"),o=r("./lib/inflate"),f=r("./lib/zlib/constants"),h={};n(h,a,o,f),i.exports=h},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,i,t){var n=r("./zlib/deflate"),a=r("./utils/common"),o=r("./utils/strings"),f=r("./zlib/messages"),h=r("./zlib/zstream"),p=Object.prototype.toString,l=0,u=4,m=0,y=1,b=2,_=-1,g=0,c=8;function v(S){if(!(this instanceof v))return new v(S);this.options=a.assign({level:_,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},S||{});var T=this.options;T.raw&&T.windowBits>0?T.windowBits=-T.windowBits:T.gzip&&T.windowBits>0&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var w=n.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(w!==m)throw new Error(f[w]);if(T.header&&n.deflateSetHeader(this.strm,T.header),T.dictionary){var L;if(typeof T.dictionary=="string"?L=o.string2buf(T.dictionary):p.call(T.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(T.dictionary):L=T.dictionary,w=n.deflateSetDictionary(this.strm,L),w!==m)throw new Error(f[w]);this._dict_set=!0}}v.prototype.push=function(S,T){var w=this.strm,L=this.options.chunkSize,I,A;if(this.ended)return!1;A=T===~~T?T:T===!0?u:l,typeof S=="string"?w.input=o.string2buf(S):p.call(S)==="[object ArrayBuffer]"?w.input=new Uint8Array(S):w.input=S,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new a.Buf8(L),w.next_out=0,w.avail_out=L),I=n.deflate(w,A),I!==y&&I!==m)return this.onEnd(I),this.ended=!0,!1;(w.avail_out===0||w.avail_in===0&&(A===u||A===b))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(w.output,w.next_out))):this.onData(a.shrinkBuf(w.output,w.next_out)))}while((w.avail_in>0||w.avail_out===0)&&I!==y);return A===u?(I=n.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===m):(A===b&&(this.onEnd(m),w.avail_out=0),!0)},v.prototype.onData=function(S){this.chunks.push(S)},v.prototype.onEnd=function(S){S===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg};function E(S,T){var w=new v(T);if(w.push(S,!0),w.err)throw w.msg||f[w.err];return w.result}function d(S,T){return T=T||{},T.raw=!0,E(S,T)}function x(S,T){return T=T||{},T.gzip=!0,E(S,T)}t.Deflate=v,t.deflate=E,t.deflateRaw=d,t.gzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,i,t){var n=r("./zlib/inflate"),a=r("./utils/common"),o=r("./utils/strings"),f=r("./zlib/constants"),h=r("./zlib/messages"),p=r("./zlib/zstream"),l=r("./zlib/gzheader"),u=Object.prototype.toString;function m(_){if(!(this instanceof m))return new m(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(_&&_.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var c=n.inflateInit2(this.strm,g.windowBits);if(c!==f.Z_OK)throw new Error(h[c]);this.header=new l,n.inflateGetHeader(this.strm,this.header)}m.prototype.push=function(_,g){var c=this.strm,v=this.options.chunkSize,E=this.options.dictionary,d,x,S,T,w,L,I=!1;if(this.ended)return!1;x=g===~~g?g:g===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof _=="string"?c.input=o.binstring2buf(_):u.call(_)==="[object ArrayBuffer]"?c.input=new Uint8Array(_):c.input=_,c.next_in=0,c.avail_in=c.input.length;do{if(c.avail_out===0&&(c.output=new a.Buf8(v),c.next_out=0,c.avail_out=v),d=n.inflate(c,f.Z_NO_FLUSH),d===f.Z_NEED_DICT&&E&&(typeof E=="string"?L=o.string2buf(E):u.call(E)==="[object ArrayBuffer]"?L=new Uint8Array(E):L=E,d=n.inflateSetDictionary(this.strm,L)),d===f.Z_BUF_ERROR&&I===!0&&(d=f.Z_OK,I=!1),d!==f.Z_STREAM_END&&d!==f.Z_OK)return this.onEnd(d),this.ended=!0,!1;c.next_out&&(c.avail_out===0||d===f.Z_STREAM_END||c.avail_in===0&&(x===f.Z_FINISH||x===f.Z_SYNC_FLUSH))&&(this.options.to==="string"?(S=o.utf8border(c.output,c.next_out),T=c.next_out-S,w=o.buf2string(c.output,S),c.next_out=T,c.avail_out=v-T,T&&a.arraySet(c.output,c.output,S,T,0),this.onData(w)):this.onData(a.shrinkBuf(c.output,c.next_out))),c.avail_in===0&&c.avail_out===0&&(I=!0)}while((c.avail_in>0||c.avail_out===0)&&d!==f.Z_STREAM_END);return d===f.Z_STREAM_END&&(x=f.Z_FINISH),x===f.Z_FINISH?(d=n.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===f.Z_OK):(x===f.Z_SYNC_FLUSH&&(this.onEnd(f.Z_OK),c.avail_out=0),!0)},m.prototype.onData=function(_){this.chunks.push(_)},m.prototype.onEnd=function(_){_===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function y(_,g){var c=new m(g);if(c.push(_,!0),c.err)throw c.msg||h[c.err];return c.result}function b(_,g){return g=g||{},g.raw=!0,y(_,g)}t.Inflate=m,t.inflate=y,t.inflateRaw=b,t.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";t.assign=function(f){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var p=h.shift();if(!!p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var l in p)p.hasOwnProperty(l)&&(f[l]=p[l])}}return f},t.shrinkBuf=function(f,h){return f.length===h?f:f.subarray?f.subarray(0,h):(f.length=h,f)};var a={arraySet:function(f,h,p,l,u){if(h.subarray&&f.subarray){f.set(h.subarray(p,p+l),u);return}for(var m=0;m<l;m++)f[u+m]=h[p+m]},flattenChunks:function(f){var h,p,l,u,m,y;for(l=0,h=0,p=f.length;h<p;h++)l+=f[h].length;for(y=new Uint8Array(l),u=0,h=0,p=f.length;h<p;h++)m=f[h],y.set(m,u),u+=m.length;return y}},o={arraySet:function(f,h,p,l,u){for(var m=0;m<l;m++)f[u+m]=h[p+m]},flattenChunks:function(f){return[].concat.apply([],f)}};t.setTyped=function(f){f?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},{}],42:[function(r,i,t){var n=r("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(l){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){o=!1}for(var f=new n.Buf8(256),h=0;h<256;h++)f[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;f[254]=f[254]=1,t.string2buf=function(l){var u,m,y,b,_,g=l.length,c=0;for(b=0;b<g;b++)m=l.charCodeAt(b),(m&64512)==55296&&b+1<g&&(y=l.charCodeAt(b+1),(y&64512)==56320&&(m=65536+(m-55296<<10)+(y-56320),b++)),c+=m<128?1:m<2048?2:m<65536?3:4;for(u=new n.Buf8(c),_=0,b=0;_<c;b++)m=l.charCodeAt(b),(m&64512)==55296&&b+1<g&&(y=l.charCodeAt(b+1),(y&64512)==56320&&(m=65536+(m-55296<<10)+(y-56320),b++)),m<128?u[_++]=m:m<2048?(u[_++]=192|m>>>6,u[_++]=128|m&63):m<65536?(u[_++]=224|m>>>12,u[_++]=128|m>>>6&63,u[_++]=128|m&63):(u[_++]=240|m>>>18,u[_++]=128|m>>>12&63,u[_++]=128|m>>>6&63,u[_++]=128|m&63);return u};function p(l,u){if(u<65537&&(l.subarray&&o||!l.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(l,u));for(var m="",y=0;y<u;y++)m+=String.fromCharCode(l[y]);return m}t.buf2binstring=function(l){return p(l,l.length)},t.binstring2buf=function(l){for(var u=new n.Buf8(l.length),m=0,y=u.length;m<y;m++)u[m]=l.charCodeAt(m);return u},t.buf2string=function(l,u){var m,y,b,_,g=u||l.length,c=new Array(g*2);for(y=0,m=0;m<g;){if(b=l[m++],b<128){c[y++]=b;continue}if(_=f[b],_>4){c[y++]=65533,m+=_-1;continue}for(b&=_===2?31:_===3?15:7;_>1&&m<g;)b=b<<6|l[m++]&63,_--;if(_>1){c[y++]=65533;continue}b<65536?c[y++]=b:(b-=65536,c[y++]=55296|b>>10&1023,c[y++]=56320|b&1023)}return p(c,y)},t.utf8border=function(l,u){var m;for(u=u||l.length,u>l.length&&(u=l.length),m=u-1;m>=0&&(l[m]&192)==128;)m--;return m<0||m===0?u:m+f[l[m]]>u?m:u}},{"./common":41}],43:[function(r,i,t){function n(a,o,f,h){for(var p=a&65535|0,l=a>>>16&65535|0,u=0;f!==0;){u=f>2e3?2e3:f,f-=u;do p=p+o[h++]|0,l=l+p|0;while(--u);p%=65521,l%=65521}return p|l<<16|0}i.exports=n},{}],44:[function(r,i,t){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,i,t){function n(){for(var f,h=[],p=0;p<256;p++){f=p;for(var l=0;l<8;l++)f=f&1?3988292384^f>>>1:f>>>1;h[p]=f}return h}var a=n();function o(f,h,p,l){var u=a,m=l+p;f^=-1;for(var y=l;y<m;y++)f=f>>>8^u[(f^h[y])&255];return f^-1}i.exports=o},{}],46:[function(r,i,t){var n=r("../utils/common"),a=r("./trees"),o=r("./adler32"),f=r("./crc32"),h=r("./messages"),p=0,l=1,u=3,m=4,y=5,b=0,_=1,g=-2,c=-3,v=-5,E=-1,d=1,x=2,S=3,T=4,w=0,L=2,I=8,A=9,O=15,D=8,R=29,C=256,P=C+1+R,M=30,N=19,B=2*P+1,U=15,F=3,j=258,$=j+F+1,G=32,Y=42,X=69,ie=73,pe=91,ue=103,we=113,de=666,oe=1,De=2,Ce=3,Ue=4,Me=3;function ze(k,le){return k.msg=h[le],le}function Ge(k){return(k<<1)-(k>4?9:0)}function Ke(k){for(var le=k.length;--le>=0;)k[le]=0}function He(k){var le=k.state,ce=le.pending;ce>k.avail_out&&(ce=k.avail_out),ce!==0&&(n.arraySet(k.output,le.pending_buf,le.pending_out,ce,k.next_out),k.next_out+=ce,le.pending_out+=ce,k.total_out+=ce,k.avail_out-=ce,le.pending-=ce,le.pending===0&&(le.pending_out=0))}function Fe(k,le){a._tr_flush_block(k,k.block_start>=0?k.block_start:-1,k.strstart-k.block_start,le),k.block_start=k.strstart,He(k.strm)}function Se(k,le){k.pending_buf[k.pending++]=le}function Xe(k,le){k.pending_buf[k.pending++]=le>>>8&255,k.pending_buf[k.pending++]=le&255}function st(k,le,ce,z){var J=k.avail_in;return J>z&&(J=z),J===0?0:(k.avail_in-=J,n.arraySet(le,k.input,k.next_in,J,ce),k.state.wrap===1?k.adler=o(k.adler,le,J,ce):k.state.wrap===2&&(k.adler=f(k.adler,le,J,ce)),k.next_in+=J,k.total_in+=J,J)}function et(k,le){var ce=k.max_chain_length,z=k.strstart,J,ae,We=k.prev_length,ke=k.nice_match,Ne=k.strstart>k.w_size-$?k.strstart-(k.w_size-$):0,rt=k.window,ar=k.w_mask,vt=k.prev,at=k.strstart+j,At=rt[z+We-1],Pt=rt[z+We];k.prev_length>=k.good_match&&(ce>>=2),ke>k.lookahead&&(ke=k.lookahead);do if(J=le,!(rt[J+We]!==Pt||rt[J+We-1]!==At||rt[J]!==rt[z]||rt[++J]!==rt[z+1])){z+=2,J++;do;while(rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&z<at);if(ae=j-(at-z),z=at-j,ae>We){if(k.match_start=le,We=ae,ae>=ke)break;At=rt[z+We-1],Pt=rt[z+We]}}while((le=vt[le&ar])>Ne&&--ce!=0);return We<=k.lookahead?We:k.lookahead}function ot(k){var le=k.w_size,ce,z,J,ae,We;do{if(ae=k.window_size-k.lookahead-k.strstart,k.strstart>=le+(le-$)){n.arraySet(k.window,k.window,le,le,0),k.match_start-=le,k.strstart-=le,k.block_start-=le,z=k.hash_size,ce=z;do J=k.head[--ce],k.head[ce]=J>=le?J-le:0;while(--z);z=le,ce=z;do J=k.prev[--ce],k.prev[ce]=J>=le?J-le:0;while(--z);ae+=le}if(k.strm.avail_in===0)break;if(z=st(k.strm,k.window,k.strstart+k.lookahead,ae),k.lookahead+=z,k.lookahead+k.insert>=F)for(We=k.strstart-k.insert,k.ins_h=k.window[We],k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+F-1])&k.hash_mask,k.prev[We&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=We,We++,k.insert--,!(k.lookahead+k.insert<F)););}while(k.lookahead<$&&k.strm.avail_in!==0)}function nt(k,le){var ce=65535;for(ce>k.pending_buf_size-5&&(ce=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ot(k),k.lookahead===0&&le===p)return oe;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var z=k.block_start+ce;if((k.strstart===0||k.strstart>=z)&&(k.lookahead=k.strstart-z,k.strstart=z,Fe(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-$&&(Fe(k,!1),k.strm.avail_out===0))return oe}return k.insert=0,le===m?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):(k.strstart>k.block_start&&(Fe(k,!1),k.strm.avail_out===0),oe)}function dt(k,le){for(var ce,z;;){if(k.lookahead<$){if(ot(k),k.lookahead<$&&le===p)return oe;if(k.lookahead===0)break}if(ce=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),ce!==0&&k.strstart-ce<=k.w_size-$&&(k.match_length=et(k,ce)),k.match_length>=F)if(z=a._tr_tally(k,k.strstart-k.match_start,k.match_length-F),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=F){k.match_length--;do k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart;while(--k.match_length!=0);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else z=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(z&&(Fe(k,!1),k.strm.avail_out===0))return oe}return k.insert=k.strstart<F-1?k.strstart:F-1,le===m?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?oe:De}function ne(k,le){for(var ce,z,J;;){if(k.lookahead<$){if(ot(k),k.lookahead<$&&le===p)return oe;if(k.lookahead===0)break}if(ce=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=F-1,ce!==0&&k.prev_length<k.max_lazy_match&&k.strstart-ce<=k.w_size-$&&(k.match_length=et(k,ce),k.match_length<=5&&(k.strategy===d||k.match_length===F&&k.strstart-k.match_start>4096)&&(k.match_length=F-1)),k.prev_length>=F&&k.match_length<=k.prev_length){J=k.strstart+k.lookahead-F,z=a._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-F),k.lookahead-=k.prev_length-1,k.prev_length-=2;do++k.strstart<=J&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,ce=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart);while(--k.prev_length!=0);if(k.match_available=0,k.match_length=F-1,k.strstart++,z&&(Fe(k,!1),k.strm.avail_out===0))return oe}else if(k.match_available){if(z=a._tr_tally(k,0,k.window[k.strstart-1]),z&&Fe(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return oe}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(z=a._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<F-1?k.strstart:F-1,le===m?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?oe:De}function Ee(k,le){for(var ce,z,J,ae,We=k.window;;){if(k.lookahead<=j){if(ot(k),k.lookahead<=j&&le===p)return oe;if(k.lookahead===0)break}if(k.match_length=0,k.lookahead>=F&&k.strstart>0&&(J=k.strstart-1,z=We[J],z===We[++J]&&z===We[++J]&&z===We[++J])){ae=k.strstart+j;do;while(z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&J<ae);k.match_length=j-(ae-J),k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=F?(ce=a._tr_tally(k,1,k.match_length-F),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(ce=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),ce&&(Fe(k,!1),k.strm.avail_out===0))return oe}return k.insert=0,le===m?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?oe:De}function xe(k,le){for(var ce;;){if(k.lookahead===0&&(ot(k),k.lookahead===0)){if(le===p)return oe;break}if(k.match_length=0,ce=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,ce&&(Fe(k,!1),k.strm.avail_out===0))return oe}return k.insert=0,le===m?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?oe:De}function Ae(k,le,ce,z,J){this.good_length=k,this.max_lazy=le,this.nice_length=ce,this.max_chain=z,this.func=J}var be;be=[new Ae(0,0,0,0,nt),new Ae(4,4,8,4,dt),new Ae(4,5,16,8,dt),new Ae(4,6,32,32,dt),new Ae(4,4,16,16,ne),new Ae(8,16,32,32,ne),new Ae(8,16,128,128,ne),new Ae(8,32,128,256,ne),new Ae(32,128,258,1024,ne),new Ae(32,258,258,4096,ne)];function je(k){k.window_size=2*k.w_size,Ke(k.head),k.max_lazy_match=be[k.level].max_lazy,k.good_match=be[k.level].good_length,k.nice_match=be[k.level].nice_length,k.max_chain_length=be[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=F-1,k.match_available=0,k.ins_h=0}function V(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(B*2),this.dyn_dtree=new n.Buf16((2*M+1)*2),this.bl_tree=new n.Buf16((2*N+1)*2),Ke(this.dyn_ltree),Ke(this.dyn_dtree),Ke(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*P+1),Ke(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*P+1),Ke(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(k){var le;return!k||!k.state?ze(k,g):(k.total_in=k.total_out=0,k.data_type=L,le=k.state,le.pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?Y:we,k.adler=le.wrap===2?0:1,le.last_flush=p,a._tr_init(le),b)}function _e(k){var le=he(k);return le===b&&je(k.state),le}function Ie(k,le){return!k||!k.state||k.state.wrap!==2?g:(k.state.gzhead=le,b)}function Z(k,le,ce,z,J,ae){if(!k)return g;var We=1;if(le===E&&(le=6),z<0?(We=0,z=-z):z>15&&(We=2,z-=16),J<1||J>A||ce!==I||z<8||z>15||le<0||le>9||ae<0||ae>T)return ze(k,g);z===8&&(z=9);var ke=new V;return k.state=ke,ke.strm=k,ke.wrap=We,ke.gzhead=null,ke.w_bits=z,ke.w_size=1<<ke.w_bits,ke.w_mask=ke.w_size-1,ke.hash_bits=J+7,ke.hash_size=1<<ke.hash_bits,ke.hash_mask=ke.hash_size-1,ke.hash_shift=~~((ke.hash_bits+F-1)/F),ke.window=new n.Buf8(ke.w_size*2),ke.head=new n.Buf16(ke.hash_size),ke.prev=new n.Buf16(ke.w_size),ke.lit_bufsize=1<<J+6,ke.pending_buf_size=ke.lit_bufsize*4,ke.pending_buf=new n.Buf8(ke.pending_buf_size),ke.d_buf=1*ke.lit_bufsize,ke.l_buf=(1+2)*ke.lit_bufsize,ke.level=le,ke.strategy=ae,ke.method=ce,_e(k)}function fe(k,le){return Z(k,le,I,O,D,w)}function W(k,le){var ce,z,J,ae;if(!k||!k.state||le>y||le<0)return k?ze(k,g):g;if(z=k.state,!k.output||!k.input&&k.avail_in!==0||z.status===de&&le!==m)return ze(k,k.avail_out===0?v:g);if(z.strm=k,ce=z.last_flush,z.last_flush=le,z.status===Y)if(z.wrap===2)k.adler=0,Se(z,31),Se(z,139),Se(z,8),z.gzhead?(Se(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),Se(z,z.gzhead.time&255),Se(z,z.gzhead.time>>8&255),Se(z,z.gzhead.time>>16&255),Se(z,z.gzhead.time>>24&255),Se(z,z.level===9?2:z.strategy>=x||z.level<2?4:0),Se(z,z.gzhead.os&255),z.gzhead.extra&&z.gzhead.extra.length&&(Se(z,z.gzhead.extra.length&255),Se(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(k.adler=f(k.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=X):(Se(z,0),Se(z,0),Se(z,0),Se(z,0),Se(z,0),Se(z,z.level===9?2:z.strategy>=x||z.level<2?4:0),Se(z,Me),z.status=we);else{var We=I+(z.w_bits-8<<4)<<8,ke=-1;z.strategy>=x||z.level<2?ke=0:z.level<6?ke=1:z.level===6?ke=2:ke=3,We|=ke<<6,z.strstart!==0&&(We|=G),We+=31-We%31,z.status=we,Xe(z,We),z.strstart!==0&&(Xe(z,k.adler>>>16),Xe(z,k.adler&65535)),k.adler=1}if(z.status===X)if(z.gzhead.extra){for(J=z.pending;z.gzindex<(z.gzhead.extra.length&65535)&&!(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size));)Se(z,z.gzhead.extra[z.gzindex]&255),z.gzindex++;z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=ie)}else z.status=ie;if(z.status===ie)if(z.gzhead.name){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.name.length?ae=z.gzhead.name.charCodeAt(z.gzindex++)&255:ae=0,Se(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.gzindex=0,z.status=pe)}else z.status=pe;if(z.status===pe)if(z.gzhead.comment){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.comment.length?ae=z.gzhead.comment.charCodeAt(z.gzindex++)&255:ae=0,Se(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=f(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.status=ue)}else z.status=ue;if(z.status===ue&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&He(k),z.pending+2<=z.pending_buf_size&&(Se(z,k.adler&255),Se(z,k.adler>>8&255),k.adler=0,z.status=we)):z.status=we),z.pending!==0){if(He(k),k.avail_out===0)return z.last_flush=-1,b}else if(k.avail_in===0&&Ge(le)<=Ge(ce)&&le!==m)return ze(k,v);if(z.status===de&&k.avail_in!==0)return ze(k,v);if(k.avail_in!==0||z.lookahead!==0||le!==p&&z.status!==de){var Ne=z.strategy===x?xe(z,le):z.strategy===S?Ee(z,le):be[z.level].func(z,le);if((Ne===Ce||Ne===Ue)&&(z.status=de),Ne===oe||Ne===Ce)return k.avail_out===0&&(z.last_flush=-1),b;if(Ne===De&&(le===l?a._tr_align(z):le!==y&&(a._tr_stored_block(z,0,0,!1),le===u&&(Ke(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),He(k),k.avail_out===0))return z.last_flush=-1,b}return le!==m?b:z.wrap<=0?_:(z.wrap===2?(Se(z,k.adler&255),Se(z,k.adler>>8&255),Se(z,k.adler>>16&255),Se(z,k.adler>>24&255),Se(z,k.total_in&255),Se(z,k.total_in>>8&255),Se(z,k.total_in>>16&255),Se(z,k.total_in>>24&255)):(Xe(z,k.adler>>>16),Xe(z,k.adler&65535)),He(k),z.wrap>0&&(z.wrap=-z.wrap),z.pending!==0?b:_)}function ge(k){var le;return!k||!k.state?g:(le=k.state.status,le!==Y&&le!==X&&le!==ie&&le!==pe&&le!==ue&&le!==we&&le!==de?ze(k,g):(k.state=null,le===we?ze(k,c):b))}function Ve(k,le){var ce=le.length,z,J,ae,We,ke,Ne,rt,ar;if(!k||!k.state||(z=k.state,We=z.wrap,We===2||We===1&&z.status!==Y||z.lookahead))return g;for(We===1&&(k.adler=o(k.adler,le,ce,0)),z.wrap=0,ce>=z.w_size&&(We===0&&(Ke(z.head),z.strstart=0,z.block_start=0,z.insert=0),ar=new n.Buf8(z.w_size),n.arraySet(ar,le,ce-z.w_size,z.w_size,0),le=ar,ce=z.w_size),ke=k.avail_in,Ne=k.next_in,rt=k.input,k.avail_in=ce,k.next_in=0,k.input=le,ot(z);z.lookahead>=F;){J=z.strstart,ae=z.lookahead-(F-1);do z.ins_h=(z.ins_h<<z.hash_shift^z.window[J+F-1])&z.hash_mask,z.prev[J&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=J,J++;while(--ae);z.strstart=J,z.lookahead=F-1,ot(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=F-1,z.match_available=0,k.next_in=Ne,k.input=rt,k.avail_in=ke,z.wrap=We,b}t.deflateInit=fe,t.deflateInit2=Z,t.deflateReset=_e,t.deflateResetKeep=he,t.deflateSetHeader=Ie,t.deflate=W,t.deflateEnd=ge,t.deflateSetDictionary=Ve,t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,i,t){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=n},{}],48:[function(r,i,t){var n=30,a=12;i.exports=function(f,h){var p,l,u,m,y,b,_,g,c,v,E,d,x,S,T,w,L,I,A,O,D,R,C,P,M;p=f.state,l=f.next_in,P=f.input,u=l+(f.avail_in-5),m=f.next_out,M=f.output,y=m-(h-f.avail_out),b=m+(f.avail_out-257),_=p.dmax,g=p.wsize,c=p.whave,v=p.wnext,E=p.window,d=p.hold,x=p.bits,S=p.lencode,T=p.distcode,w=(1<<p.lenbits)-1,L=(1<<p.distbits)-1;e:do{x<15&&(d+=P[l++]<<x,x+=8,d+=P[l++]<<x,x+=8),I=S[d&w];t:for(;;){if(A=I>>>24,d>>>=A,x-=A,A=I>>>16&255,A===0)M[m++]=I&65535;else if(A&16){O=I&65535,A&=15,A&&(x<A&&(d+=P[l++]<<x,x+=8),O+=d&(1<<A)-1,d>>>=A,x-=A),x<15&&(d+=P[l++]<<x,x+=8,d+=P[l++]<<x,x+=8),I=T[d&L];r:for(;;){if(A=I>>>24,d>>>=A,x-=A,A=I>>>16&255,A&16){if(D=I&65535,A&=15,x<A&&(d+=P[l++]<<x,x+=8,x<A&&(d+=P[l++]<<x,x+=8)),D+=d&(1<<A)-1,D>_){f.msg="invalid distance too far back",p.mode=n;break e}if(d>>>=A,x-=A,A=m-y,D>A){if(A=D-A,A>c&&p.sane){f.msg="invalid distance too far back",p.mode=n;break e}if(R=0,C=E,v===0){if(R+=g-A,A<O){O-=A;do M[m++]=E[R++];while(--A);R=m-D,C=M}}else if(v<A){if(R+=g+v-A,A-=v,A<O){O-=A;do M[m++]=E[R++];while(--A);if(R=0,v<O){A=v,O-=A;do M[m++]=E[R++];while(--A);R=m-D,C=M}}}else if(R+=v-A,A<O){O-=A;do M[m++]=E[R++];while(--A);R=m-D,C=M}for(;O>2;)M[m++]=C[R++],M[m++]=C[R++],M[m++]=C[R++],O-=3;O&&(M[m++]=C[R++],O>1&&(M[m++]=C[R++]))}else{R=m-D;do M[m++]=M[R++],M[m++]=M[R++],M[m++]=M[R++],O-=3;while(O>2);O&&(M[m++]=M[R++],O>1&&(M[m++]=M[R++]))}}else if((A&64)==0){I=T[(I&65535)+(d&(1<<A)-1)];continue r}else{f.msg="invalid distance code",p.mode=n;break e}break}}else if((A&64)==0){I=S[(I&65535)+(d&(1<<A)-1)];continue t}else if(A&32){p.mode=a;break e}else{f.msg="invalid literal/length code",p.mode=n;break e}break}}while(l<u&&m<b);O=x>>3,l-=O,x-=O<<3,d&=(1<<x)-1,f.next_in=l,f.next_out=m,f.avail_in=l<u?5+(u-l):5-(l-u),f.avail_out=m<b?257+(b-m):257-(m-b),p.hold=d,p.bits=x}},{}],49:[function(r,i,t){var n=r("../utils/common"),a=r("./adler32"),o=r("./crc32"),f=r("./inffast"),h=r("./inftrees"),p=0,l=1,u=2,m=4,y=5,b=6,_=0,g=1,c=2,v=-2,E=-3,d=-4,x=-5,S=8,T=1,w=2,L=3,I=4,A=5,O=6,D=7,R=8,C=9,P=10,M=11,N=12,B=13,U=14,F=15,j=16,$=17,G=18,Y=19,X=20,ie=21,pe=22,ue=23,we=24,de=25,oe=26,De=27,Ce=28,Ue=29,Me=30,ze=31,Ge=32,Ke=852,He=592,Fe=15,Se=Fe;function Xe(Z){return(Z>>>24&255)+(Z>>>8&65280)+((Z&65280)<<8)+((Z&255)<<24)}function st(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function et(Z){var fe;return!Z||!Z.state?v:(fe=Z.state,Z.total_in=Z.total_out=fe.total=0,Z.msg="",fe.wrap&&(Z.adler=fe.wrap&1),fe.mode=T,fe.last=0,fe.havedict=0,fe.dmax=32768,fe.head=null,fe.hold=0,fe.bits=0,fe.lencode=fe.lendyn=new n.Buf32(Ke),fe.distcode=fe.distdyn=new n.Buf32(He),fe.sane=1,fe.back=-1,_)}function ot(Z){var fe;return!Z||!Z.state?v:(fe=Z.state,fe.wsize=0,fe.whave=0,fe.wnext=0,et(Z))}function nt(Z,fe){var W,ge;return!Z||!Z.state||(ge=Z.state,fe<0?(W=0,fe=-fe):(W=(fe>>4)+1,fe<48&&(fe&=15)),fe&&(fe<8||fe>15))?v:(ge.window!==null&&ge.wbits!==fe&&(ge.window=null),ge.wrap=W,ge.wbits=fe,ot(Z))}function dt(Z,fe){var W,ge;return Z?(ge=new st,Z.state=ge,ge.window=null,W=nt(Z,fe),W!==_&&(Z.state=null),W):v}function ne(Z){return dt(Z,Se)}var Ee=!0,xe,Ae;function be(Z){if(Ee){var fe;for(xe=new n.Buf32(512),Ae=new n.Buf32(32),fe=0;fe<144;)Z.lens[fe++]=8;for(;fe<256;)Z.lens[fe++]=9;for(;fe<280;)Z.lens[fe++]=7;for(;fe<288;)Z.lens[fe++]=8;for(h(l,Z.lens,0,288,xe,0,Z.work,{bits:9}),fe=0;fe<32;)Z.lens[fe++]=5;h(u,Z.lens,0,32,Ae,0,Z.work,{bits:5}),Ee=!1}Z.lencode=xe,Z.lenbits=9,Z.distcode=Ae,Z.distbits=5}function je(Z,fe,W,ge){var Ve,k=Z.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new n.Buf8(k.wsize)),ge>=k.wsize?(n.arraySet(k.window,fe,W-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(Ve=k.wsize-k.wnext,Ve>ge&&(Ve=ge),n.arraySet(k.window,fe,W-ge,Ve,k.wnext),ge-=Ve,ge?(n.arraySet(k.window,fe,W-ge,ge,0),k.wnext=ge,k.whave=k.wsize):(k.wnext+=Ve,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=Ve))),0}function V(Z,fe){var W,ge,Ve,k,le,ce,z,J,ae,We,ke,Ne,rt,ar,vt=0,at,At,Pt,Wt,Ki,Gi,xt,qt,Rt=new n.Buf8(4),Cr,gr,Da=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Z||!Z.state||!Z.output||!Z.input&&Z.avail_in!==0)return v;W=Z.state,W.mode===N&&(W.mode=B),le=Z.next_out,Ve=Z.output,z=Z.avail_out,k=Z.next_in,ge=Z.input,ce=Z.avail_in,J=W.hold,ae=W.bits,We=ce,ke=z,qt=_;e:for(;;)switch(W.mode){case T:if(W.wrap===0){W.mode=B;break}for(;ae<16;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(W.wrap&2&&J===35615){W.check=0,Rt[0]=J&255,Rt[1]=J>>>8&255,W.check=o(W.check,Rt,2,0),J=0,ae=0,W.mode=w;break}if(W.flags=0,W.head&&(W.head.done=!1),!(W.wrap&1)||(((J&255)<<8)+(J>>8))%31){Z.msg="incorrect header check",W.mode=Me;break}if((J&15)!==S){Z.msg="unknown compression method",W.mode=Me;break}if(J>>>=4,ae-=4,xt=(J&15)+8,W.wbits===0)W.wbits=xt;else if(xt>W.wbits){Z.msg="invalid window size",W.mode=Me;break}W.dmax=1<<xt,Z.adler=W.check=1,W.mode=J&512?P:N,J=0,ae=0;break;case w:for(;ae<16;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(W.flags=J,(W.flags&255)!==S){Z.msg="unknown compression method",W.mode=Me;break}if(W.flags&57344){Z.msg="unknown header flags set",W.mode=Me;break}W.head&&(W.head.text=J>>8&1),W.flags&512&&(Rt[0]=J&255,Rt[1]=J>>>8&255,W.check=o(W.check,Rt,2,0)),J=0,ae=0,W.mode=L;case L:for(;ae<32;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.head&&(W.head.time=J),W.flags&512&&(Rt[0]=J&255,Rt[1]=J>>>8&255,Rt[2]=J>>>16&255,Rt[3]=J>>>24&255,W.check=o(W.check,Rt,4,0)),J=0,ae=0,W.mode=I;case I:for(;ae<16;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.head&&(W.head.xflags=J&255,W.head.os=J>>8),W.flags&512&&(Rt[0]=J&255,Rt[1]=J>>>8&255,W.check=o(W.check,Rt,2,0)),J=0,ae=0,W.mode=A;case A:if(W.flags&1024){for(;ae<16;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.length=J,W.head&&(W.head.extra_len=J),W.flags&512&&(Rt[0]=J&255,Rt[1]=J>>>8&255,W.check=o(W.check,Rt,2,0)),J=0,ae=0}else W.head&&(W.head.extra=null);W.mode=O;case O:if(W.flags&1024&&(Ne=W.length,Ne>ce&&(Ne=ce),Ne&&(W.head&&(xt=W.head.extra_len-W.length,W.head.extra||(W.head.extra=new Array(W.head.extra_len)),n.arraySet(W.head.extra,ge,k,Ne,xt)),W.flags&512&&(W.check=o(W.check,ge,Ne,k)),ce-=Ne,k+=Ne,W.length-=Ne),W.length))break e;W.length=0,W.mode=D;case D:if(W.flags&2048){if(ce===0)break e;Ne=0;do xt=ge[k+Ne++],W.head&&xt&&W.length<65536&&(W.head.name+=String.fromCharCode(xt));while(xt&&Ne<ce);if(W.flags&512&&(W.check=o(W.check,ge,Ne,k)),ce-=Ne,k+=Ne,xt)break e}else W.head&&(W.head.name=null);W.length=0,W.mode=R;case R:if(W.flags&4096){if(ce===0)break e;Ne=0;do xt=ge[k+Ne++],W.head&&xt&&W.length<65536&&(W.head.comment+=String.fromCharCode(xt));while(xt&&Ne<ce);if(W.flags&512&&(W.check=o(W.check,ge,Ne,k)),ce-=Ne,k+=Ne,xt)break e}else W.head&&(W.head.comment=null);W.mode=C;case C:if(W.flags&512){for(;ae<16;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(J!==(W.check&65535)){Z.msg="header crc mismatch",W.mode=Me;break}J=0,ae=0}W.head&&(W.head.hcrc=W.flags>>9&1,W.head.done=!0),Z.adler=W.check=0,W.mode=N;break;case P:for(;ae<32;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}Z.adler=W.check=Xe(J),J=0,ae=0,W.mode=M;case M:if(W.havedict===0)return Z.next_out=le,Z.avail_out=z,Z.next_in=k,Z.avail_in=ce,W.hold=J,W.bits=ae,c;Z.adler=W.check=1,W.mode=N;case N:if(fe===y||fe===b)break e;case B:if(W.last){J>>>=ae&7,ae-=ae&7,W.mode=De;break}for(;ae<3;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}switch(W.last=J&1,J>>>=1,ae-=1,J&3){case 0:W.mode=U;break;case 1:if(be(W),W.mode=X,fe===b){J>>>=2,ae-=2;break e}break;case 2:W.mode=$;break;case 3:Z.msg="invalid block type",W.mode=Me}J>>>=2,ae-=2;break;case U:for(J>>>=ae&7,ae-=ae&7;ae<32;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if((J&65535)!=(J>>>16^65535)){Z.msg="invalid stored block lengths",W.mode=Me;break}if(W.length=J&65535,J=0,ae=0,W.mode=F,fe===b)break e;case F:W.mode=j;case j:if(Ne=W.length,Ne){if(Ne>ce&&(Ne=ce),Ne>z&&(Ne=z),Ne===0)break e;n.arraySet(Ve,ge,k,Ne,le),ce-=Ne,k+=Ne,z-=Ne,le+=Ne,W.length-=Ne;break}W.mode=N;break;case $:for(;ae<14;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(W.nlen=(J&31)+257,J>>>=5,ae-=5,W.ndist=(J&31)+1,J>>>=5,ae-=5,W.ncode=(J&15)+4,J>>>=4,ae-=4,W.nlen>286||W.ndist>30){Z.msg="too many length or distance symbols",W.mode=Me;break}W.have=0,W.mode=G;case G:for(;W.have<W.ncode;){for(;ae<3;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.lens[Da[W.have++]]=J&7,J>>>=3,ae-=3}for(;W.have<19;)W.lens[Da[W.have++]]=0;if(W.lencode=W.lendyn,W.lenbits=7,Cr={bits:W.lenbits},qt=h(p,W.lens,0,19,W.lencode,0,W.work,Cr),W.lenbits=Cr.bits,qt){Z.msg="invalid code lengths set",W.mode=Me;break}W.have=0,W.mode=Y;case Y:for(;W.have<W.nlen+W.ndist;){for(;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(Pt<16)J>>>=at,ae-=at,W.lens[W.have++]=Pt;else{if(Pt===16){for(gr=at+2;ae<gr;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(J>>>=at,ae-=at,W.have===0){Z.msg="invalid bit length repeat",W.mode=Me;break}xt=W.lens[W.have-1],Ne=3+(J&3),J>>>=2,ae-=2}else if(Pt===17){for(gr=at+3;ae<gr;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Ne=3+(J&7),J>>>=3,ae-=3}else{for(gr=at+7;ae<gr;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Ne=11+(J&127),J>>>=7,ae-=7}if(W.have+Ne>W.nlen+W.ndist){Z.msg="invalid bit length repeat",W.mode=Me;break}for(;Ne--;)W.lens[W.have++]=xt}}if(W.mode===Me)break;if(W.lens[256]===0){Z.msg="invalid code -- missing end-of-block",W.mode=Me;break}if(W.lenbits=9,Cr={bits:W.lenbits},qt=h(l,W.lens,0,W.nlen,W.lencode,0,W.work,Cr),W.lenbits=Cr.bits,qt){Z.msg="invalid literal/lengths set",W.mode=Me;break}if(W.distbits=6,W.distcode=W.distdyn,Cr={bits:W.distbits},qt=h(u,W.lens,W.nlen,W.ndist,W.distcode,0,W.work,Cr),W.distbits=Cr.bits,qt){Z.msg="invalid distances set",W.mode=Me;break}if(W.mode=X,fe===b)break e;case X:W.mode=ie;case ie:if(ce>=6&&z>=258){Z.next_out=le,Z.avail_out=z,Z.next_in=k,Z.avail_in=ce,W.hold=J,W.bits=ae,f(Z,ke),le=Z.next_out,Ve=Z.output,z=Z.avail_out,k=Z.next_in,ge=Z.input,ce=Z.avail_in,J=W.hold,ae=W.bits,W.mode===N&&(W.back=-1);break}for(W.back=0;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(At&&(At&240)==0){for(Wt=at,Ki=At,Gi=Pt;vt=W.lencode[Gi+((J&(1<<Wt+Ki)-1)>>Wt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(Wt+at<=ae);){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}J>>>=Wt,ae-=Wt,W.back+=Wt}if(J>>>=at,ae-=at,W.back+=at,W.length=Pt,At===0){W.mode=oe;break}if(At&32){W.back=-1,W.mode=N;break}if(At&64){Z.msg="invalid literal/length code",W.mode=Me;break}W.extra=At&15,W.mode=pe;case pe:if(W.extra){for(gr=W.extra;ae<gr;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.length+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}W.was=W.length,W.mode=ue;case ue:for(;vt=W.distcode[J&(1<<W.distbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if((At&240)==0){for(Wt=at,Ki=At,Gi=Pt;vt=W.distcode[Gi+((J&(1<<Wt+Ki)-1)>>Wt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(Wt+at<=ae);){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}J>>>=Wt,ae-=Wt,W.back+=Wt}if(J>>>=at,ae-=at,W.back+=at,At&64){Z.msg="invalid distance code",W.mode=Me;break}W.offset=Pt,W.extra=At&15,W.mode=we;case we:if(W.extra){for(gr=W.extra;ae<gr;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}W.offset+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}if(W.offset>W.dmax){Z.msg="invalid distance too far back",W.mode=Me;break}W.mode=de;case de:if(z===0)break e;if(Ne=ke-z,W.offset>Ne){if(Ne=W.offset-Ne,Ne>W.whave&&W.sane){Z.msg="invalid distance too far back",W.mode=Me;break}Ne>W.wnext?(Ne-=W.wnext,rt=W.wsize-Ne):rt=W.wnext-Ne,Ne>W.length&&(Ne=W.length),ar=W.window}else ar=Ve,rt=le-W.offset,Ne=W.length;Ne>z&&(Ne=z),z-=Ne,W.length-=Ne;do Ve[le++]=ar[rt++];while(--Ne);W.length===0&&(W.mode=ie);break;case oe:if(z===0)break e;Ve[le++]=W.length,z--,W.mode=ie;break;case De:if(W.wrap){for(;ae<32;){if(ce===0)break e;ce--,J|=ge[k++]<<ae,ae+=8}if(ke-=z,Z.total_out+=ke,W.total+=ke,ke&&(Z.adler=W.check=W.flags?o(W.check,Ve,ke,le-ke):a(W.check,Ve,ke,le-ke)),ke=z,(W.flags?J:Xe(J))!==W.check){Z.msg="incorrect data check",W.mode=Me;break}J=0,ae=0}W.mode=Ce;case Ce:if(W.wrap&&W.flags){for(;ae<32;){if(ce===0)break e;ce--,J+=ge[k++]<<ae,ae+=8}if(J!==(W.total&4294967295)){Z.msg="incorrect length check",W.mode=Me;break}J=0,ae=0}W.mode=Ue;case Ue:qt=g;break e;case Me:qt=E;break e;case ze:return d;case Ge:default:return v}return Z.next_out=le,Z.avail_out=z,Z.next_in=k,Z.avail_in=ce,W.hold=J,W.bits=ae,(W.wsize||ke!==Z.avail_out&&W.mode<Me&&(W.mode<De||fe!==m))&&je(Z,Z.output,Z.next_out,ke-Z.avail_out),We-=Z.avail_in,ke-=Z.avail_out,Z.total_in+=We,Z.total_out+=ke,W.total+=ke,W.wrap&&ke&&(Z.adler=W.check=W.flags?o(W.check,Ve,ke,Z.next_out-ke):a(W.check,Ve,ke,Z.next_out-ke)),Z.data_type=W.bits+(W.last?64:0)+(W.mode===N?128:0)+(W.mode===X||W.mode===F?256:0),(We===0&&ke===0||fe===m)&&qt===_&&(qt=x),qt}function he(Z){if(!Z||!Z.state)return v;var fe=Z.state;return fe.window&&(fe.window=null),Z.state=null,_}function _e(Z,fe){var W;return!Z||!Z.state||(W=Z.state,(W.wrap&2)==0)?v:(W.head=fe,fe.done=!1,_)}function Ie(Z,fe){var W=fe.length,ge,Ve,k;return!Z||!Z.state||(ge=Z.state,ge.wrap!==0&&ge.mode!==M)?v:ge.mode===M&&(Ve=1,Ve=a(Ve,fe,W,0),Ve!==ge.check)?E:(k=je(Z,fe,W,W),k?(ge.mode=ze,d):(ge.havedict=1,_))}t.inflateReset=ot,t.inflateReset2=nt,t.inflateResetKeep=et,t.inflateInit=ne,t.inflateInit2=dt,t.inflate=V,t.inflateEnd=he,t.inflateGetHeader=_e,t.inflateSetDictionary=Ie,t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,i,t){var n=r("../utils/common"),a=15,o=852,f=592,h=0,p=1,l=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(g,c,v,E,d,x,S,T){var w=T.bits,L=0,I=0,A=0,O=0,D=0,R=0,C=0,P=0,M=0,N=0,B,U,F,j,$,G=null,Y=0,X,ie=new n.Buf16(a+1),pe=new n.Buf16(a+1),ue=null,we=0,de,oe,De;for(L=0;L<=a;L++)ie[L]=0;for(I=0;I<E;I++)ie[c[v+I]]++;for(D=w,O=a;O>=1&&ie[O]===0;O--);if(D>O&&(D=O),O===0)return d[x++]=1<<24|64<<16|0,d[x++]=1<<24|64<<16|0,T.bits=1,0;for(A=1;A<O&&ie[A]===0;A++);for(D<A&&(D=A),P=1,L=1;L<=a;L++)if(P<<=1,P-=ie[L],P<0)return-1;if(P>0&&(g===h||O!==1))return-1;for(pe[1]=0,L=1;L<a;L++)pe[L+1]=pe[L]+ie[L];for(I=0;I<E;I++)c[v+I]!==0&&(S[pe[c[v+I]]++]=I);if(g===h?(G=ue=S,X=19):g===p?(G=u,Y-=257,ue=m,we-=257,X=256):(G=y,ue=b,X=-1),N=0,I=0,L=A,$=x,R=D,C=0,F=-1,M=1<<D,j=M-1,g===p&&M>o||g===l&&M>f)return 1;for(;;){de=L-C,S[I]<X?(oe=0,De=S[I]):S[I]>X?(oe=ue[we+S[I]],De=G[Y+S[I]]):(oe=32+64,De=0),B=1<<L-C,U=1<<R,A=U;do U-=B,d[$+(N>>C)+U]=de<<24|oe<<16|De|0;while(U!==0);for(B=1<<L-1;N&B;)B>>=1;if(B!==0?(N&=B-1,N+=B):N=0,I++,--ie[L]==0){if(L===O)break;L=c[v+S[I]]}if(L>D&&(N&j)!==F){for(C===0&&(C=D),$+=A,R=L-C,P=1<<R;R+C<O&&(P-=ie[R+C],!(P<=0));)R++,P<<=1;if(M+=1<<R,g===p&&M>o||g===l&&M>f)return 1;F=N&j,d[F]=D<<24|R<<16|$-x|0}}return N!==0&&(d[$+N]=L-C<<24|64<<16|0),T.bits=D,0}},{"../utils/common":41}],51:[function(r,i,t){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,i,t){var n=r("../utils/common"),a=4,o=0,f=1,h=2;function p(V){for(var he=V.length;--he>=0;)V[he]=0}var l=0,u=1,m=2,y=3,b=258,_=29,g=256,c=g+1+_,v=30,E=19,d=2*c+1,x=15,S=16,T=7,w=256,L=16,I=17,A=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,M=new Array((c+2)*2);p(M);var N=new Array(v*2);p(N);var B=new Array(P);p(B);var U=new Array(b-y+1);p(U);var F=new Array(_);p(F);var j=new Array(v);p(j);function $(V,he,_e,Ie,Z){this.static_tree=V,this.extra_bits=he,this.extra_base=_e,this.elems=Ie,this.max_length=Z,this.has_stree=V&&V.length}var G,Y,X;function ie(V,he){this.dyn_tree=V,this.max_code=0,this.stat_desc=he}function pe(V){return V<256?B[V]:B[256+(V>>>7)]}function ue(V,he){V.pending_buf[V.pending++]=he&255,V.pending_buf[V.pending++]=he>>>8&255}function we(V,he,_e){V.bi_valid>S-_e?(V.bi_buf|=he<<V.bi_valid&65535,ue(V,V.bi_buf),V.bi_buf=he>>S-V.bi_valid,V.bi_valid+=_e-S):(V.bi_buf|=he<<V.bi_valid&65535,V.bi_valid+=_e)}function de(V,he,_e){we(V,_e[he*2],_e[he*2+1])}function oe(V,he){var _e=0;do _e|=V&1,V>>>=1,_e<<=1;while(--he>0);return _e>>>1}function De(V){V.bi_valid===16?(ue(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):V.bi_valid>=8&&(V.pending_buf[V.pending++]=V.bi_buf&255,V.bi_buf>>=8,V.bi_valid-=8)}function Ce(V,he){var _e=he.dyn_tree,Ie=he.max_code,Z=he.stat_desc.static_tree,fe=he.stat_desc.has_stree,W=he.stat_desc.extra_bits,ge=he.stat_desc.extra_base,Ve=he.stat_desc.max_length,k,le,ce,z,J,ae,We=0;for(z=0;z<=x;z++)V.bl_count[z]=0;for(_e[V.heap[V.heap_max]*2+1]=0,k=V.heap_max+1;k<d;k++)le=V.heap[k],z=_e[_e[le*2+1]*2+1]+1,z>Ve&&(z=Ve,We++),_e[le*2+1]=z,!(le>Ie)&&(V.bl_count[z]++,J=0,le>=ge&&(J=W[le-ge]),ae=_e[le*2],V.opt_len+=ae*(z+J),fe&&(V.static_len+=ae*(Z[le*2+1]+J)));if(We!==0){do{for(z=Ve-1;V.bl_count[z]===0;)z--;V.bl_count[z]--,V.bl_count[z+1]+=2,V.bl_count[Ve]--,We-=2}while(We>0);for(z=Ve;z!==0;z--)for(le=V.bl_count[z];le!==0;)ce=V.heap[--k],!(ce>Ie)&&(_e[ce*2+1]!==z&&(V.opt_len+=(z-_e[ce*2+1])*_e[ce*2],_e[ce*2+1]=z),le--)}}function Ue(V,he,_e){var Ie=new Array(x+1),Z=0,fe,W;for(fe=1;fe<=x;fe++)Ie[fe]=Z=Z+_e[fe-1]<<1;for(W=0;W<=he;W++){var ge=V[W*2+1];ge!==0&&(V[W*2]=oe(Ie[ge]++,ge))}}function Me(){var V,he,_e,Ie,Z,fe=new Array(x+1);for(_e=0,Ie=0;Ie<_-1;Ie++)for(F[Ie]=_e,V=0;V<1<<O[Ie];V++)U[_e++]=Ie;for(U[_e-1]=Ie,Z=0,Ie=0;Ie<16;Ie++)for(j[Ie]=Z,V=0;V<1<<D[Ie];V++)B[Z++]=Ie;for(Z>>=7;Ie<v;Ie++)for(j[Ie]=Z<<7,V=0;V<1<<D[Ie]-7;V++)B[256+Z++]=Ie;for(he=0;he<=x;he++)fe[he]=0;for(V=0;V<=143;)M[V*2+1]=8,V++,fe[8]++;for(;V<=255;)M[V*2+1]=9,V++,fe[9]++;for(;V<=279;)M[V*2+1]=7,V++,fe[7]++;for(;V<=287;)M[V*2+1]=8,V++,fe[8]++;for(Ue(M,c+1,fe),V=0;V<v;V++)N[V*2+1]=5,N[V*2]=oe(V,5);G=new $(M,O,g+1,c,x),Y=new $(N,D,0,v,x),X=new $(new Array(0),R,0,E,T)}function ze(V){var he;for(he=0;he<c;he++)V.dyn_ltree[he*2]=0;for(he=0;he<v;he++)V.dyn_dtree[he*2]=0;for(he=0;he<E;he++)V.bl_tree[he*2]=0;V.dyn_ltree[w*2]=1,V.opt_len=V.static_len=0,V.last_lit=V.matches=0}function Ge(V){V.bi_valid>8?ue(V,V.bi_buf):V.bi_valid>0&&(V.pending_buf[V.pending++]=V.bi_buf),V.bi_buf=0,V.bi_valid=0}function Ke(V,he,_e,Ie){Ge(V),Ie&&(ue(V,_e),ue(V,~_e)),n.arraySet(V.pending_buf,V.window,he,_e,V.pending),V.pending+=_e}function He(V,he,_e,Ie){var Z=he*2,fe=_e*2;return V[Z]<V[fe]||V[Z]===V[fe]&&Ie[he]<=Ie[_e]}function Fe(V,he,_e){for(var Ie=V.heap[_e],Z=_e<<1;Z<=V.heap_len&&(Z<V.heap_len&&He(he,V.heap[Z+1],V.heap[Z],V.depth)&&Z++,!He(he,Ie,V.heap[Z],V.depth));)V.heap[_e]=V.heap[Z],_e=Z,Z<<=1;V.heap[_e]=Ie}function Se(V,he,_e){var Ie,Z,fe=0,W,ge;if(V.last_lit!==0)do Ie=V.pending_buf[V.d_buf+fe*2]<<8|V.pending_buf[V.d_buf+fe*2+1],Z=V.pending_buf[V.l_buf+fe],fe++,Ie===0?de(V,Z,he):(W=U[Z],de(V,W+g+1,he),ge=O[W],ge!==0&&(Z-=F[W],we(V,Z,ge)),Ie--,W=pe(Ie),de(V,W,_e),ge=D[W],ge!==0&&(Ie-=j[W],we(V,Ie,ge)));while(fe<V.last_lit);de(V,w,he)}function Xe(V,he){var _e=he.dyn_tree,Ie=he.stat_desc.static_tree,Z=he.stat_desc.has_stree,fe=he.stat_desc.elems,W,ge,Ve=-1,k;for(V.heap_len=0,V.heap_max=d,W=0;W<fe;W++)_e[W*2]!==0?(V.heap[++V.heap_len]=Ve=W,V.depth[W]=0):_e[W*2+1]=0;for(;V.heap_len<2;)k=V.heap[++V.heap_len]=Ve<2?++Ve:0,_e[k*2]=1,V.depth[k]=0,V.opt_len--,Z&&(V.static_len-=Ie[k*2+1]);for(he.max_code=Ve,W=V.heap_len>>1;W>=1;W--)Fe(V,_e,W);k=fe;do W=V.heap[1],V.heap[1]=V.heap[V.heap_len--],Fe(V,_e,1),ge=V.heap[1],V.heap[--V.heap_max]=W,V.heap[--V.heap_max]=ge,_e[k*2]=_e[W*2]+_e[ge*2],V.depth[k]=(V.depth[W]>=V.depth[ge]?V.depth[W]:V.depth[ge])+1,_e[W*2+1]=_e[ge*2+1]=k,V.heap[1]=k++,Fe(V,_e,1);while(V.heap_len>=2);V.heap[--V.heap_max]=V.heap[1],Ce(V,he),Ue(_e,Ve,V.bl_count)}function st(V,he,_e){var Ie,Z=-1,fe,W=he[0*2+1],ge=0,Ve=7,k=4;for(W===0&&(Ve=138,k=3),he[(_e+1)*2+1]=65535,Ie=0;Ie<=_e;Ie++)fe=W,W=he[(Ie+1)*2+1],!(++ge<Ve&&fe===W)&&(ge<k?V.bl_tree[fe*2]+=ge:fe!==0?(fe!==Z&&V.bl_tree[fe*2]++,V.bl_tree[L*2]++):ge<=10?V.bl_tree[I*2]++:V.bl_tree[A*2]++,ge=0,Z=fe,W===0?(Ve=138,k=3):fe===W?(Ve=6,k=3):(Ve=7,k=4))}function et(V,he,_e){var Ie,Z=-1,fe,W=he[0*2+1],ge=0,Ve=7,k=4;for(W===0&&(Ve=138,k=3),Ie=0;Ie<=_e;Ie++)if(fe=W,W=he[(Ie+1)*2+1],!(++ge<Ve&&fe===W)){if(ge<k)do de(V,fe,V.bl_tree);while(--ge!=0);else fe!==0?(fe!==Z&&(de(V,fe,V.bl_tree),ge--),de(V,L,V.bl_tree),we(V,ge-3,2)):ge<=10?(de(V,I,V.bl_tree),we(V,ge-3,3)):(de(V,A,V.bl_tree),we(V,ge-11,7));ge=0,Z=fe,W===0?(Ve=138,k=3):fe===W?(Ve=6,k=3):(Ve=7,k=4)}}function ot(V){var he;for(st(V,V.dyn_ltree,V.l_desc.max_code),st(V,V.dyn_dtree,V.d_desc.max_code),Xe(V,V.bl_desc),he=E-1;he>=3&&V.bl_tree[C[he]*2+1]===0;he--);return V.opt_len+=3*(he+1)+5+5+4,he}function nt(V,he,_e,Ie){var Z;for(we(V,he-257,5),we(V,_e-1,5),we(V,Ie-4,4),Z=0;Z<Ie;Z++)we(V,V.bl_tree[C[Z]*2+1],3);et(V,V.dyn_ltree,he-1),et(V,V.dyn_dtree,_e-1)}function dt(V){var he=4093624447,_e;for(_e=0;_e<=31;_e++,he>>>=1)if(he&1&&V.dyn_ltree[_e*2]!==0)return o;if(V.dyn_ltree[9*2]!==0||V.dyn_ltree[10*2]!==0||V.dyn_ltree[13*2]!==0)return f;for(_e=32;_e<g;_e++)if(V.dyn_ltree[_e*2]!==0)return f;return o}var ne=!1;function Ee(V){ne||(Me(),ne=!0),V.l_desc=new ie(V.dyn_ltree,G),V.d_desc=new ie(V.dyn_dtree,Y),V.bl_desc=new ie(V.bl_tree,X),V.bi_buf=0,V.bi_valid=0,ze(V)}function xe(V,he,_e,Ie){we(V,(l<<1)+(Ie?1:0),3),Ke(V,he,_e,!0)}function Ae(V){we(V,u<<1,3),de(V,w,M),De(V)}function be(V,he,_e,Ie){var Z,fe,W=0;V.level>0?(V.strm.data_type===h&&(V.strm.data_type=dt(V)),Xe(V,V.l_desc),Xe(V,V.d_desc),W=ot(V),Z=V.opt_len+3+7>>>3,fe=V.static_len+3+7>>>3,fe<=Z&&(Z=fe)):Z=fe=_e+5,_e+4<=Z&&he!==-1?xe(V,he,_e,Ie):V.strategy===a||fe===Z?(we(V,(u<<1)+(Ie?1:0),3),Se(V,M,N)):(we(V,(m<<1)+(Ie?1:0),3),nt(V,V.l_desc.max_code+1,V.d_desc.max_code+1,W+1),Se(V,V.dyn_ltree,V.dyn_dtree)),ze(V),Ie&&Ge(V)}function je(V,he,_e){return V.pending_buf[V.d_buf+V.last_lit*2]=he>>>8&255,V.pending_buf[V.d_buf+V.last_lit*2+1]=he&255,V.pending_buf[V.l_buf+V.last_lit]=_e&255,V.last_lit++,he===0?V.dyn_ltree[_e*2]++:(V.matches++,he--,V.dyn_ltree[(U[_e]+g+1)*2]++,V.dyn_dtree[pe(he)*2]++),V.last_lit===V.lit_bufsize-1}t._tr_init=Ee,t._tr_stored_block=xe,t._tr_flush_block=be,t._tr_tally=je,t._tr_align=Ae},{"../utils/common":41}],53:[function(r,i,t){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=n},{}],54:[function(r,i,t){i.exports=typeof setImmediate=="function"?setImmediate:function(){var a=[].slice.apply(arguments);a.splice(1,0,0),setTimeout.apply(null,a)}},{}]},{},[10])(10)})})(Kc);Object.defineProperty(ro,"__esModule",{value:!0});ro.default=void 0;var In=Be,i1=io(Bi),Gc=io(Tn),n1=io(Qr),a1=io(Kc.exports);function io(s){return s&&s.__esModule?s:{default:s}}class s1{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new a1.default}catch(e){throw new Error("JSZip lib not loaded")}}open(e,r){return this.zip.loadAsync(e,{base64:r})}openUrl(e,r){return(0,i1.default)(e,"binary").then(function(i){return this.zip.loadAsync(i,{base64:r})}.bind(this))}request(e,r){var i=new In.defer,t,n=new n1.default(e);return r||(r=n.extension),r=="blob"?t=this.getBlob(e):t=this.getText(e),t?t.then(function(a){let o=this.handleResponse(a,r);i.resolve(o)}.bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,In.isXml)(r)?i=(0,In.parse)(e,"text/xml"):r=="xhtml"?i=(0,In.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,In.parse)(e,"text/html"):i=e,i}getBlob(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("uint8array").then(function(n){return new Blob([n],{type:r})})}getText(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return t.async("string").then(function(n){return n})}getBase64(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("base64").then(function(n){return"data:"+r+";base64,"+n})}createUrl(e,r){var i=new In.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(f){this.urlCache[e]=f,i.resolve(f)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(f){n=t.createObjectURL(f),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.zip=void 0,this.urlCache={}}}var o1=s1;ro.default=o1;var no={},Yc={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(h,p){if(!t[h]){if(!i[h]){var l=typeof Er=="function"&&Er;if(!p&&l)return l(h,!0);if(o)return o(h,!0);var u=new Error("Cannot find module '"+h+"'");throw u.code="MODULE_NOT_FOUND",u}var m=t[h]={exports:{}};i[h][0].call(m.exports,function(y){var b=i[h][1][y];return a(b||y)},m,m.exports,r,i,t,n)}return t[h].exports}for(var o=typeof Er=="function"&&Er,f=0;f<n.length;f++)a(n[f]);return a}({1:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var f=0,h=new a(y),p=n.document.createTextNode("");h.observe(p,{characterData:!0}),o=function(){p.data=f=++f%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var l=new n.MessageChannel;l.port1.onmessage=y,o=function(){l.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var _=n.document.createElement("script");_.onreadystatechange=function(){y(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},n.document.documentElement.appendChild(_)}:o=function(){setTimeout(y,0)};var u,m=[];function y(){u=!0;for(var _,g,c=m.length;c;){for(g=m,m=[],_=-1;++_<c;)g[_]();c=m.length}u=!1}i.exports=b;function b(_){m.push(_)===1&&!u&&o()}}).call(this,typeof Mt!="undefined"?Mt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(r,i,t){var n=r(1);function a(){}var o={},f=["REJECTED"],h=["FULFILLED"],p=["PENDING"];i.exports=l;function l(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,d!==a&&b(this,d)}l.prototype.catch=function(d){return this.then(null,d)},l.prototype.then=function(d,x){if(typeof d!="function"&&this.state===h||typeof x!="function"&&this.state===f)return this;var S=new this.constructor(a);if(this.state!==p){var T=this.state===h?d:x;m(S,T,this.outcome)}else this.queue.push(new u(S,d,x));return S};function u(d,x,S){this.promise=d,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}u.prototype.callFulfilled=function(d){o.resolve(this.promise,d)},u.prototype.otherCallFulfilled=function(d){m(this.promise,this.onFulfilled,d)},u.prototype.callRejected=function(d){o.reject(this.promise,d)},u.prototype.otherCallRejected=function(d){m(this.promise,this.onRejected,d)};function m(d,x,S){n(function(){var T;try{T=x(S)}catch(w){return o.reject(d,w)}T===d?o.reject(d,new TypeError("Cannot resolve promise with itself")):o.resolve(d,T)})}o.resolve=function(d,x){var S=_(y,x);if(S.status==="error")return o.reject(d,S.value);var T=S.value;if(T)b(d,T);else{d.state=h,d.outcome=x;for(var w=-1,L=d.queue.length;++w<L;)d.queue[w].callFulfilled(x)}return d},o.reject=function(d,x){d.state=f,d.outcome=x;for(var S=-1,T=d.queue.length;++S<T;)d.queue[S].callRejected(x);return d};function y(d){var x=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof x=="function")return function(){x.apply(d,arguments)}}function b(d,x){var S=!1;function T(A){S||(S=!0,o.reject(d,A))}function w(A){S||(S=!0,o.resolve(d,A))}function L(){x(w,T)}var I=_(L);I.status==="error"&&T(I.value)}function _(d,x){var S={};try{S.value=d(x),S.status="success"}catch(T){S.status="error",S.value=T}return S}l.resolve=g;function g(d){return d instanceof this?d:o.resolve(new this(a),d)}l.reject=c;function c(d){var x=new this(a);return o.reject(x,d)}l.all=v;function v(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,T=!1;if(!S)return this.resolve([]);for(var w=new Array(S),L=0,I=-1,A=new this(a);++I<S;)O(d[I],I);return A;function O(D,R){x.resolve(D).then(C,function(P){T||(T=!0,o.reject(A,P))});function C(P){w[R]=P,++L===S&&!T&&(T=!0,o.resolve(A,w))}}}l.race=E;function E(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,T=!1;if(!S)return this.resolve([]);for(var w=-1,L=new this(a);++w<S;)I(d[w]);return L;function I(A){x.resolve(A).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{"1":1}],3:[function(r,i,t){(function(n){typeof n.Promise!="function"&&(n.Promise=r(2))}).call(this,typeof Mt!="undefined"?Mt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(r,i,t){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H};function a(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(H){return}}var f=o();function h(){try{if(!f||!f.open)return!1;var H=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Q=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!H||Q)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(K){return!1}}function p(H,Q){H=H||[],Q=Q||{};try{return new Blob(H,Q)}catch(ee){if(ee.name!=="TypeError")throw ee;for(var K=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,te=new K,re=0;re<H.length;re+=1)te.append(H[re]);return te.getBlob(Q.type)}}typeof Promise=="undefined"&&r(3);var l=Promise;function u(H,Q){Q&&H.then(function(K){Q(null,K)},function(K){Q(K)})}function m(H,Q,K){typeof Q=="function"&&H.then(Q),typeof K=="function"&&H.catch(K)}function y(H){return typeof H!="string"&&(console.warn(H+" used as a key, but it is not a string."),H=String(H)),H}function b(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var _="local-forage-detect-blob-support",g=void 0,c={},v=Object.prototype.toString,E="readonly",d="readwrite";function x(H){for(var Q=H.length,K=new ArrayBuffer(Q),te=new Uint8Array(K),re=0;re<Q;re++)te[re]=H.charCodeAt(re);return K}function S(H){return new l(function(Q){var K=H.transaction(_,d),te=p([""]);K.objectStore(_).put(te,"key"),K.onabort=function(re){re.preventDefault(),re.stopPropagation(),Q(!1)},K.oncomplete=function(){var re=navigator.userAgent.match(/Chrome\/(\d+)/),ee=navigator.userAgent.match(/Edge\//);Q(ee||!re||parseInt(re[1],10)>=43)}}).catch(function(){return!1})}function T(H){return typeof g=="boolean"?l.resolve(g):S(H).then(function(Q){return g=Q,g})}function w(H){var Q=c[H.name],K={};K.promise=new l(function(te,re){K.resolve=te,K.reject=re}),Q.deferredOperations.push(K),Q.dbReady?Q.dbReady=Q.dbReady.then(function(){return K.promise}):Q.dbReady=K.promise}function L(H){var Q=c[H.name],K=Q.deferredOperations.pop();if(K)return K.resolve(),K.promise}function I(H,Q){var K=c[H.name],te=K.deferredOperations.pop();if(te)return te.reject(Q),te.promise}function A(H,Q){return new l(function(K,te){if(c[H.name]=c[H.name]||F(),H.db)if(Q)w(H),H.db.close();else return K(H.db);var re=[H.name];Q&&re.push(H.version);var ee=f.open.apply(f,re);Q&&(ee.onupgradeneeded=function(ve){var Te=ee.result;try{Te.createObjectStore(H.storeName),ve.oldVersion<=1&&Te.createObjectStore(_)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+H.name+'" has been upgraded from version '+ve.oldVersion+" to version "+ve.newVersion+', but the storage "'+H.storeName+'" already exists.');else throw Oe}}),ee.onerror=function(ve){ve.preventDefault(),te(ee.error)},ee.onsuccess=function(){var ve=ee.result;ve.onversionchange=function(Te){Te.target.close()},K(ve),L(H)}})}function O(H){return A(H,!1)}function D(H){return A(H,!0)}function R(H,Q){if(!H.db)return!0;var K=!H.db.objectStoreNames.contains(H.storeName),te=H.version<H.db.version,re=H.version>H.db.version;if(te&&(H.version!==Q&&console.warn('The database "'+H.name+`" can't be downgraded from version `+H.db.version+" to version "+H.version+"."),H.version=H.db.version),re||K){if(K){var ee=H.db.version+1;ee>H.version&&(H.version=ee)}return!0}return!1}function C(H){return new l(function(Q,K){var te=new FileReader;te.onerror=K,te.onloadend=function(re){var ee=btoa(re.target.result||"");Q({__local_forage_encoded_blob:!0,data:ee,type:H.type})},te.readAsBinaryString(H)})}function P(H){var Q=x(atob(H.data));return p([Q],{type:H.type})}function M(H){return H&&H.__local_forage_encoded_blob}function N(H){var Q=this,K=Q._initReady().then(function(){var te=c[Q._dbInfo.name];if(te&&te.dbReady)return te.dbReady});return m(K,H,H),K}function B(H){w(H);for(var Q=c[H.name],K=Q.forages,te=0;te<K.length;te++){var re=K[te];re._dbInfo.db&&(re._dbInfo.db.close(),re._dbInfo.db=null)}return H.db=null,O(H).then(function(ee){return H.db=ee,R(H)?D(H):ee}).then(function(ee){H.db=Q.db=ee;for(var ve=0;ve<K.length;ve++)K[ve]._dbInfo.db=ee}).catch(function(ee){throw I(H,ee),ee})}function U(H,Q,K,te){te===void 0&&(te=1);try{var re=H.db.transaction(H.storeName,Q);K(null,re)}catch(ee){if(te>0&&(!H.db||ee.name==="InvalidStateError"||ee.name==="NotFoundError"))return l.resolve().then(function(){if(!H.db||ee.name==="NotFoundError"&&!H.db.objectStoreNames.contains(H.storeName)&&H.version<=H.db.version)return H.db&&(H.version=H.db.version+1),D(H)}).then(function(){return B(H).then(function(){U(H,Q,K,te-1)})}).catch(K);K(ee)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function j(H){var Q=this,K={db:null};if(H)for(var te in H)K[te]=H[te];var re=c[K.name];re||(re=F(),c[K.name]=re),re.forages.push(Q),Q._initReady||(Q._initReady=Q.ready,Q.ready=N);var ee=[];function ve(){return l.resolve()}for(var Te=0;Te<re.forages.length;Te++){var Oe=re.forages[Te];Oe!==Q&&ee.push(Oe._initReady().catch(ve))}var Le=re.forages.slice(0);return l.all(ee).then(function(){return K.db=re.db,O(K)}).then(function(Re){return K.db=Re,R(K,Q._defaultConfig.version)?D(K):Re}).then(function(Re){K.db=re.db=Re,Q._dbInfo=K;for(var $e=0;$e<Le.length;$e++){var it=Le[$e];it!==Q&&(it._dbInfo.db=K.db,it._dbInfo.version=K.version)}})}function $(H,Q){var K=this;H=y(H);var te=new l(function(re,ee){K.ready().then(function(){U(K._dbInfo,E,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore(K._dbInfo.storeName),Le=Oe.get(H);Le.onsuccess=function(){var Re=Le.result;Re===void 0&&(Re=null),M(Re)&&(Re=P(Re)),re(Re)},Le.onerror=function(){ee(Le.error)}}catch(Re){ee(Re)}})}).catch(ee)});return u(te,Q),te}function G(H,Q){var K=this,te=new l(function(re,ee){K.ready().then(function(){U(K._dbInfo,E,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore(K._dbInfo.storeName),Le=Oe.openCursor(),Re=1;Le.onsuccess=function(){var $e=Le.result;if($e){var it=$e.value;M(it)&&(it=P(it));var ft=H(it,$e.key,Re++);ft!==void 0?re(ft):$e.continue()}else re()},Le.onerror=function(){ee(Le.error)}}catch($e){ee($e)}})}).catch(ee)});return u(te,Q),te}function Y(H,Q,K){var te=this;H=y(H);var re=new l(function(ee,ve){var Te;te.ready().then(function(){return Te=te._dbInfo,v.call(Q)==="[object Blob]"?T(Te.db).then(function(Oe){return Oe?Q:C(Q)}):Q}).then(function(Oe){U(te._dbInfo,d,function(Le,Re){if(Le)return ve(Le);try{var $e=Re.objectStore(te._dbInfo.storeName);Oe===null&&(Oe=void 0);var it=$e.put(Oe,H);Re.oncomplete=function(){Oe===void 0&&(Oe=null),ee(Oe)},Re.onabort=Re.onerror=function(){var ft=it.error?it.error:it.transaction.error;ve(ft)}}catch(ft){ve(ft)}})}).catch(ve)});return u(re,K),re}function X(H,Q){var K=this;H=y(H);var te=new l(function(re,ee){K.ready().then(function(){U(K._dbInfo,d,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore(K._dbInfo.storeName),Le=Oe.delete(H);Te.oncomplete=function(){re()},Te.onerror=function(){ee(Le.error)},Te.onabort=function(){var Re=Le.error?Le.error:Le.transaction.error;ee(Re)}}catch(Re){ee(Re)}})}).catch(ee)});return u(te,Q),te}function ie(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){U(Q._dbInfo,d,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.clear();ve.oncomplete=function(){te()},ve.onabort=ve.onerror=function(){var Le=Oe.error?Oe.error:Oe.transaction.error;re(Le)}}catch(Le){re(Le)}})}).catch(re)});return u(K,H),K}function pe(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){U(Q._dbInfo,E,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.count();Oe.onsuccess=function(){te(Oe.result)},Oe.onerror=function(){re(Oe.error)}}catch(Le){re(Le)}})}).catch(re)});return u(K,H),K}function ue(H,Q){var K=this,te=new l(function(re,ee){if(H<0){re(null);return}K.ready().then(function(){U(K._dbInfo,E,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore(K._dbInfo.storeName),Le=!1,Re=Oe.openKeyCursor();Re.onsuccess=function(){var $e=Re.result;if(!$e){re(null);return}H===0||Le?re($e.key):(Le=!0,$e.advance(H))},Re.onerror=function(){ee(Re.error)}}catch($e){ee($e)}})}).catch(ee)});return u(te,Q),te}function we(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){U(Q._dbInfo,E,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.openKeyCursor(),Le=[];Oe.onsuccess=function(){var Re=Oe.result;if(!Re){te(Le);return}Le.push(Re.key),Re.continue()},Oe.onerror=function(){re(Oe.error)}}catch(Re){re(Re)}})}).catch(re)});return u(K,H),K}function de(H,Q){Q=b.apply(this,arguments);var K=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||K.name,H.storeName=H.storeName||K.storeName);var te=this,re;if(!H.name)re=l.reject("Invalid arguments");else{var ee=H.name===K.name&&te._dbInfo.db,ve=ee?l.resolve(te._dbInfo.db):O(H).then(function(Te){var Oe=c[H.name],Le=Oe.forages;Oe.db=Te;for(var Re=0;Re<Le.length;Re++)Le[Re]._dbInfo.db=Te;return Te});H.storeName?re=ve.then(function(Te){if(!!Te.objectStoreNames.contains(H.storeName)){var Oe=Te.version+1;w(H);var Le=c[H.name],Re=Le.forages;Te.close();for(var $e=0;$e<Re.length;$e++){var it=Re[$e];it._dbInfo.db=null,it._dbInfo.version=Oe}var ft=new l(function(ct,Dt){var Ot=f.open(H.name,Oe);Ot.onerror=function(yr){var Pn=Ot.result;Pn.close(),Dt(yr)},Ot.onupgradeneeded=function(){var yr=Ot.result;yr.deleteObjectStore(H.storeName)},Ot.onsuccess=function(){var yr=Ot.result;yr.close(),ct(yr)}});return ft.then(function(ct){Le.db=ct;for(var Dt=0;Dt<Re.length;Dt++){var Ot=Re[Dt];Ot._dbInfo.db=ct,L(Ot._dbInfo)}}).catch(function(ct){throw(I(H,ct)||l.resolve()).catch(function(){}),ct})}}):re=ve.then(function(Te){w(H);var Oe=c[H.name],Le=Oe.forages;Te.close();for(var Re=0;Re<Le.length;Re++){var $e=Le[Re];$e._dbInfo.db=null}var it=new l(function(ft,ct){var Dt=f.deleteDatabase(H.name);Dt.onerror=function(){var Ot=Dt.result;Ot&&Ot.close(),ct(Dt.error)},Dt.onblocked=function(){console.warn('dropInstance blocked for database "'+H.name+'" until all open connections are closed')},Dt.onsuccess=function(){var Ot=Dt.result;Ot&&Ot.close(),ft(Ot)}});return it.then(function(ft){Oe.db=ft;for(var ct=0;ct<Le.length;ct++){var Dt=Le[ct];L(Dt._dbInfo)}}).catch(function(ft){throw(I(H,ft)||l.resolve()).catch(function(){}),ft})})}return u(re,Q),re}var oe={_driver:"asyncStorage",_initStorage:j,_support:h(),iterate:G,getItem:$,setItem:Y,removeItem:X,clear:ie,length:pe,key:ue,keys:we,dropInstance:de};function De(){return typeof openDatabase=="function"}var Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ue="~~local_forage_type~",Me=/^~~local_forage_type~([^~]+)~/,ze="__lfsc__:",Ge=ze.length,Ke="arbf",He="blob",Fe="si08",Se="ui08",Xe="uic8",st="si16",et="si32",ot="ur16",nt="ui32",dt="fl32",ne="fl64",Ee=Ge+Ke.length,xe=Object.prototype.toString;function Ae(H){var Q=H.length*.75,K=H.length,te,re=0,ee,ve,Te,Oe;H[H.length-1]==="="&&(Q--,H[H.length-2]==="="&&Q--);var Le=new ArrayBuffer(Q),Re=new Uint8Array(Le);for(te=0;te<K;te+=4)ee=Ce.indexOf(H[te]),ve=Ce.indexOf(H[te+1]),Te=Ce.indexOf(H[te+2]),Oe=Ce.indexOf(H[te+3]),Re[re++]=ee<<2|ve>>4,Re[re++]=(ve&15)<<4|Te>>2,Re[re++]=(Te&3)<<6|Oe&63;return Le}function be(H){var Q=new Uint8Array(H),K="",te;for(te=0;te<Q.length;te+=3)K+=Ce[Q[te]>>2],K+=Ce[(Q[te]&3)<<4|Q[te+1]>>4],K+=Ce[(Q[te+1]&15)<<2|Q[te+2]>>6],K+=Ce[Q[te+2]&63];return Q.length%3==2?K=K.substring(0,K.length-1)+"=":Q.length%3==1&&(K=K.substring(0,K.length-2)+"=="),K}function je(H,Q){var K="";if(H&&(K=xe.call(H)),H&&(K==="[object ArrayBuffer]"||H.buffer&&xe.call(H.buffer)==="[object ArrayBuffer]")){var te,re=ze;H instanceof ArrayBuffer?(te=H,re+=Ke):(te=H.buffer,K==="[object Int8Array]"?re+=Fe:K==="[object Uint8Array]"?re+=Se:K==="[object Uint8ClampedArray]"?re+=Xe:K==="[object Int16Array]"?re+=st:K==="[object Uint16Array]"?re+=ot:K==="[object Int32Array]"?re+=et:K==="[object Uint32Array]"?re+=nt:K==="[object Float32Array]"?re+=dt:K==="[object Float64Array]"?re+=ne:Q(new Error("Failed to get type for BinaryArray"))),Q(re+be(te))}else if(K==="[object Blob]"){var ee=new FileReader;ee.onload=function(){var ve=Ue+H.type+"~"+be(this.result);Q(ze+He+ve)},ee.readAsArrayBuffer(H)}else try{Q(JSON.stringify(H))}catch(ve){console.error("Couldn't convert value into a JSON string: ",H),Q(null,ve)}}function V(H){if(H.substring(0,Ge)!==ze)return JSON.parse(H);var Q=H.substring(Ee),K=H.substring(Ge,Ee),te;if(K===He&&Me.test(Q)){var re=Q.match(Me);te=re[1],Q=Q.substring(re[0].length)}var ee=Ae(Q);switch(K){case Ke:return ee;case He:return p([ee],{type:te});case Fe:return new Int8Array(ee);case Se:return new Uint8Array(ee);case Xe:return new Uint8ClampedArray(ee);case st:return new Int16Array(ee);case ot:return new Uint16Array(ee);case et:return new Int32Array(ee);case nt:return new Uint32Array(ee);case dt:return new Float32Array(ee);case ne:return new Float64Array(ee);default:throw new Error("Unkown type: "+K)}}var he={serialize:je,deserialize:V,stringToBuffer:Ae,bufferToString:be};function _e(H,Q,K,te){H.executeSql("CREATE TABLE IF NOT EXISTS "+Q.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],K,te)}function Ie(H){var Q=this,K={db:null};if(H)for(var te in H)K[te]=typeof H[te]!="string"?H[te].toString():H[te];var re=new l(function(ee,ve){try{K.db=openDatabase(K.name,String(K.version),K.description,K.size)}catch(Te){return ve(Te)}K.db.transaction(function(Te){_e(Te,K,function(){Q._dbInfo=K,ee()},function(Oe,Le){ve(Le)})},ve)});return K.serializer=he,re}function Z(H,Q,K,te,re,ee){H.executeSql(K,te,re,function(ve,Te){Te.code===Te.SYNTAX_ERR?ve.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Q.storeName],function(Oe,Le){Le.rows.length?ee(Oe,Te):_e(Oe,Q,function(){Oe.executeSql(K,te,re,ee)},ee)},ee):ee(ve,Te)},ee)}function fe(H,Q){var K=this;H=y(H);var te=new l(function(re,ee){K.ready().then(function(){var ve=K._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT * FROM "+ve.storeName+" WHERE key = ? LIMIT 1",[H],function(Oe,Le){var Re=Le.rows.length?Le.rows.item(0).value:null;Re&&(Re=ve.serializer.deserialize(Re)),re(Re)},function(Oe,Le){ee(Le)})})}).catch(ee)});return u(te,Q),te}function W(H,Q){var K=this,te=new l(function(re,ee){K.ready().then(function(){var ve=K._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT * FROM "+ve.storeName,[],function(Oe,Le){for(var Re=Le.rows,$e=Re.length,it=0;it<$e;it++){var ft=Re.item(it),ct=ft.value;if(ct&&(ct=ve.serializer.deserialize(ct)),ct=H(ct,ft.key,it+1),ct!==void 0){re(ct);return}}re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return u(te,Q),te}function ge(H,Q,K,te){var re=this;H=y(H);var ee=new l(function(ve,Te){re.ready().then(function(){Q===void 0&&(Q=null);var Oe=Q,Le=re._dbInfo;Le.serializer.serialize(Q,function(Re,$e){$e?Te($e):Le.db.transaction(function(it){Z(it,Le,"INSERT OR REPLACE INTO "+Le.storeName+" (key, value) VALUES (?, ?)",[H,Re],function(){ve(Oe)},function(ft,ct){Te(ct)})},function(it){if(it.code===it.QUOTA_ERR){if(te>0){ve(ge.apply(re,[H,Oe,K,te-1]));return}Te(it)}})})}).catch(Te)});return u(ee,K),ee}function Ve(H,Q,K){return ge.apply(this,[H,Q,K,1])}function k(H,Q){var K=this;H=y(H);var te=new l(function(re,ee){K.ready().then(function(){var ve=K._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"DELETE FROM "+ve.storeName+" WHERE key = ?",[H],function(){re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return u(te,Q),te}function le(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"DELETE FROM "+ee.storeName,[],function(){te()},function(Te,Oe){re(Oe)})})}).catch(re)});return u(K,H),K}function ce(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT COUNT(key) as c FROM "+ee.storeName,[],function(Te,Oe){var Le=Oe.rows.item(0).c;te(Le)},function(Te,Oe){re(Oe)})})}).catch(re)});return u(K,H),K}function z(H,Q){var K=this,te=new l(function(re,ee){K.ready().then(function(){var ve=K._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT key FROM "+ve.storeName+" WHERE id = ? LIMIT 1",[H+1],function(Oe,Le){var Re=Le.rows.length?Le.rows.item(0).key:null;re(Re)},function(Oe,Le){ee(Le)})})}).catch(ee)});return u(te,Q),te}function J(H){var Q=this,K=new l(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT key FROM "+ee.storeName,[],function(Te,Oe){for(var Le=[],Re=0;Re<Oe.rows.length;Re++)Le.push(Oe.rows.item(Re).key);te(Le)},function(Te,Oe){re(Oe)})})}).catch(re)});return u(K,H),K}function ae(H){return new l(function(Q,K){H.transaction(function(te){te.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(re,ee){for(var ve=[],Te=0;Te<ee.rows.length;Te++)ve.push(ee.rows.item(Te).name);Q({db:H,storeNames:ve})},function(re,ee){K(ee)})},function(te){K(te)})})}function We(H,Q){Q=b.apply(this,arguments);var K=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||K.name,H.storeName=H.storeName||K.storeName);var te=this,re;return H.name?re=new l(function(ee){var ve;H.name===K.name?ve=te._dbInfo.db:ve=openDatabase(H.name,"","",0),H.storeName?ee({db:ve,storeNames:[H.storeName]}):ee(ae(ve))}).then(function(ee){return new l(function(ve,Te){ee.db.transaction(function(Oe){function Le(ft){return new l(function(ct,Dt){Oe.executeSql("DROP TABLE IF EXISTS "+ft,[],function(){ct()},function(Ot,yr){Dt(yr)})})}for(var Re=[],$e=0,it=ee.storeNames.length;$e<it;$e++)Re.push(Le(ee.storeNames[$e]));l.all(Re).then(function(){ve()}).catch(function(ft){Te(ft)})},function(Oe){Te(Oe)})})}):re=l.reject("Invalid arguments"),u(re,Q),re}var ke={_driver:"webSQLStorage",_initStorage:Ie,_support:De(),iterate:W,getItem:fe,setItem:Ve,removeItem:k,clear:le,length:ce,key:z,keys:J,dropInstance:We};function Ne(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(H){return!1}}function rt(H,Q){var K=H.name+"/";return H.storeName!==Q.storeName&&(K+=H.storeName+"/"),K}function ar(){var H="_localforage_support_test";try{return localStorage.setItem(H,!0),localStorage.removeItem(H),!1}catch(Q){return!0}}function vt(){return!ar()||localStorage.length>0}function at(H){var Q=this,K={};if(H)for(var te in H)K[te]=H[te];return K.keyPrefix=rt(H,Q._defaultConfig),vt()?(Q._dbInfo=K,K.serializer=he,l.resolve()):l.reject()}function At(H){var Q=this,K=Q.ready().then(function(){for(var te=Q._dbInfo.keyPrefix,re=localStorage.length-1;re>=0;re--){var ee=localStorage.key(re);ee.indexOf(te)===0&&localStorage.removeItem(ee)}});return u(K,H),K}function Pt(H,Q){var K=this;H=y(H);var te=K.ready().then(function(){var re=K._dbInfo,ee=localStorage.getItem(re.keyPrefix+H);return ee&&(ee=re.serializer.deserialize(ee)),ee});return u(te,Q),te}function Wt(H,Q){var K=this,te=K.ready().then(function(){for(var re=K._dbInfo,ee=re.keyPrefix,ve=ee.length,Te=localStorage.length,Oe=1,Le=0;Le<Te;Le++){var Re=localStorage.key(Le);if(Re.indexOf(ee)===0){var $e=localStorage.getItem(Re);if($e&&($e=re.serializer.deserialize($e)),$e=H($e,Re.substring(ve),Oe++),$e!==void 0)return $e}}});return u(te,Q),te}function Ki(H,Q){var K=this,te=K.ready().then(function(){var re=K._dbInfo,ee;try{ee=localStorage.key(H)}catch(ve){ee=null}return ee&&(ee=ee.substring(re.keyPrefix.length)),ee});return u(te,Q),te}function Gi(H){var Q=this,K=Q.ready().then(function(){for(var te=Q._dbInfo,re=localStorage.length,ee=[],ve=0;ve<re;ve++){var Te=localStorage.key(ve);Te.indexOf(te.keyPrefix)===0&&ee.push(Te.substring(te.keyPrefix.length))}return ee});return u(K,H),K}function xt(H){var Q=this,K=Q.keys().then(function(te){return te.length});return u(K,H),K}function qt(H,Q){var K=this;H=y(H);var te=K.ready().then(function(){var re=K._dbInfo;localStorage.removeItem(re.keyPrefix+H)});return u(te,Q),te}function Rt(H,Q,K){var te=this;H=y(H);var re=te.ready().then(function(){Q===void 0&&(Q=null);var ee=Q;return new l(function(ve,Te){var Oe=te._dbInfo;Oe.serializer.serialize(Q,function(Le,Re){if(Re)Te(Re);else try{localStorage.setItem(Oe.keyPrefix+H,Le),ve(ee)}catch($e){($e.name==="QuotaExceededError"||$e.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Te($e),Te($e)}})})});return u(re,K),re}function Cr(H,Q){if(Q=b.apply(this,arguments),H=typeof H!="function"&&H||{},!H.name){var K=this.config();H.name=H.name||K.name,H.storeName=H.storeName||K.storeName}var te=this,re;return H.name?re=new l(function(ee){H.storeName?ee(rt(H,te._defaultConfig)):ee(H.name+"/")}).then(function(ee){for(var ve=localStorage.length-1;ve>=0;ve--){var Te=localStorage.key(ve);Te.indexOf(ee)===0&&localStorage.removeItem(Te)}}):re=l.reject("Invalid arguments"),u(re,Q),re}var gr={_driver:"localStorageWrapper",_initStorage:at,_support:Ne(),iterate:Wt,getItem:Pt,setItem:Rt,removeItem:qt,clear:At,length:xt,key:Ki,keys:Gi,dropInstance:Cr},Da=function(Q,K){return Q===K||typeof Q=="number"&&typeof K=="number"&&isNaN(Q)&&isNaN(K)},kh=function(Q,K){for(var te=Q.length,re=0;re<te;){if(Da(Q[re],K))return!0;re++}return!1},ou=Array.isArray||function(H){return Object.prototype.toString.call(H)==="[object Array]"},Cn={},lu={},Yi={INDEXEDDB:oe,WEBSQL:ke,LOCALSTORAGE:gr},Nh=[Yi.INDEXEDDB._driver,Yi.WEBSQL._driver,Yi.LOCALSTORAGE._driver],Ia=["dropInstance"],vo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ia),Fh={description:"",driver:Nh.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Bh(H,Q){H[Q]=function(){var K=arguments;return H.ready().then(function(){return H[Q].apply(H,K)})}}function mo(){for(var H=1;H<arguments.length;H++){var Q=arguments[H];if(Q)for(var K in Q)Q.hasOwnProperty(K)&&(ou(Q[K])?arguments[0][K]=Q[K].slice():arguments[0][K]=Q[K])}return arguments[0]}var Uh=function(){function H(Q){a(this,H);for(var K in Yi)if(Yi.hasOwnProperty(K)){var te=Yi[K],re=te._driver;this[K]=re,Cn[re]||this.defineDriver(te)}this._defaultConfig=mo({},Fh),this._config=mo({},this._defaultConfig,Q),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return H.prototype.config=function(K){if((typeof K=="undefined"?"undefined":n(K))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var te in K){if(te==="storeName"&&(K[te]=K[te].replace(/\W/g,"_")),te==="version"&&typeof K[te]!="number")return new Error("Database version must be a number.");this._config[te]=K[te]}return"driver"in K&&K.driver?this.setDriver(this._config.driver):!0}else return typeof K=="string"?this._config[K]:this._config},H.prototype.defineDriver=function(K,te,re){var ee=new l(function(ve,Te){try{var Oe=K._driver,Le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!K._driver){Te(Le);return}for(var Re=vo.concat("_initStorage"),$e=0,it=Re.length;$e<it;$e++){var ft=Re[$e],ct=!kh(Ia,ft);if((ct||K[ft])&&typeof K[ft]!="function"){Te(Le);return}}var Dt=function(){for(var Pn=function(zh){return function(){var $h=new Error("Method "+zh+" is not implemented by the current driver"),uu=l.reject($h);return u(uu,arguments[arguments.length-1]),uu}},go=0,Wh=Ia.length;go<Wh;go++){var yo=Ia[go];K[yo]||(K[yo]=Pn(yo))}};Dt();var Ot=function(Pn){Cn[Oe]&&console.info("Redefining LocalForage driver: "+Oe),Cn[Oe]=K,lu[Oe]=Pn,ve()};"_support"in K?K._support&&typeof K._support=="function"?K._support().then(Ot,Te):Ot(!!K._support):Ot(!0)}catch(yr){Te(yr)}});return m(ee,te,re),ee},H.prototype.driver=function(){return this._driver||null},H.prototype.getDriver=function(K,te,re){var ee=Cn[K]?l.resolve(Cn[K]):l.reject(new Error("Driver not found."));return m(ee,te,re),ee},H.prototype.getSerializer=function(K){var te=l.resolve(he);return m(te,K),te},H.prototype.ready=function(K){var te=this,re=te._driverSet.then(function(){return te._ready===null&&(te._ready=te._initDriver()),te._ready});return m(re,K,K),re},H.prototype.setDriver=function(K,te,re){var ee=this;ou(K)||(K=[K]);var ve=this._getSupportedDrivers(K);function Te(){ee._config.driver=ee.driver()}function Oe($e){return ee._extend($e),Te(),ee._ready=ee._initStorage(ee._config),ee._ready}function Le($e){return function(){var it=0;function ft(){for(;it<$e.length;){var ct=$e[it];return it++,ee._dbInfo=null,ee._ready=null,ee.getDriver(ct).then(Oe).catch(ft)}Te();var Dt=new Error("No available storage method found.");return ee._driverSet=l.reject(Dt),ee._driverSet}return ft()}}var Re=this._driverSet!==null?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=Re.then(function(){var $e=ve[0];return ee._dbInfo=null,ee._ready=null,ee.getDriver($e).then(function(it){ee._driver=it._driver,Te(),ee._wrapLibraryMethodsWithReady(),ee._initDriver=Le(ve)})}).catch(function(){Te();var $e=new Error("No available storage method found.");return ee._driverSet=l.reject($e),ee._driverSet}),m(this._driverSet,te,re),this._driverSet},H.prototype.supports=function(K){return!!lu[K]},H.prototype._extend=function(K){mo(this,K)},H.prototype._getSupportedDrivers=function(K){for(var te=[],re=0,ee=K.length;re<ee;re++){var ve=K[re];this.supports(ve)&&te.push(ve)}return te},H.prototype._wrapLibraryMethodsWithReady=function(){for(var K=0,te=vo.length;K<te;K++)Bh(this,vo[K])},H.prototype.createInstance=function(K){return new H(K)},H}(),jh=new Uh;i.exports=jh},{"3":3}]},{},[4])(4)})})(Yc);Object.defineProperty(no,"__esModule",{value:!0});no.default=void 0;var li=Be,l1=wa(Bi),Gl=wa(Tn),u1=wa(Qr),f1=wa(Ar.exports),Xc=wa(Yc.exports);function wa(s){return s&&s.__esModule?s:{default:s}}class Zc{constructor(e,r,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=r||l1.default,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Xc.default=="undefined"&&(e=Xc.default),this.storage=e.createInstance({name:this.name})}catch(e){throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let r=navigator.onLine;this.online=r,r?this.emit("online",this):this.emit("offline",this)}add(e,r){let i=e.resources.map(t=>{let{href:n}=t,a=this.resolver(n),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(f=>!f||r?this.requester(a,"binary").then(h=>this.storage.setItem(o,h)):f)});return Promise.all(i)}put(e,r,i){let t=window.encodeURIComponent(e);return this.storage.getItem(t).then(n=>n||this.requester(e,"binary",r,i).then(a=>this.storage.setItem(t,a)))}request(e,r,i,t){return this.online?this.requester(e,r,i,t).then(n=>(this.put(e),n)):this.retrieve(e,r)}retrieve(e,r){new li.defer;var i,t=new u1.default(e);return r||(r=t.extension),r=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(n=>{var a=new li.defer,o;return n?(o=this.handleResponse(n,r),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,li.isXml)(r)?i=(0,li.parse)(e,"text/xml"):r=="xhtml"?i=(0,li.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,li.parse)(e,"text/html"):i=e,i}getBlob(e,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(t){if(!!t)return r=r||Gl.default.lookup(e),new Blob([t],{type:r})})}getText(e,r){let i=window.encodeURIComponent(e);return r=r||Gl.default.lookup(e),this.storage.getItem(i).then(function(t){var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsText(o,r),n.promise})}getBase64(e,r){let i=window.encodeURIComponent(e);return r=r||Gl.default.lookup(e),this.storage.getItem(i).then(t=>{var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsDataURL(o,r),n.promise})}createUrl(e,r){var i=new li.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(f){this.urlCache[e]=f,i.resolve(f)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(f){n=t.createObjectURL(f),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.urlCache={},this.removeListeners()}}(0,f1.default)(Zc.prototype);var d1=Zc;no.default=d1;var ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.default=void 0;var Qc=Be;class c1{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const r=(0,Qc.qs)(e,"display_options");return r?((0,Qc.qsa)(r,"option").forEach(t=>{let n="";switch(t.childNodes.length&&(n=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":this.interactive=n;break;case"fixed-layout":this.fixedLayout=n;break;case"open-to-spread":this.openToSpread=n;break;case"orientation-lock":this.orientationLock=n;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var h1=c1;ao.default=h1;Object.defineProperty(ta,"__esModule",{value:!0});ta.default=void 0;var p1=Xt(Ar.exports),jr=Be,Si=Xt(ki),Jc=Xt(Qr),v1=Xt(ks),m1=Xt(Fs),g1=Xt(Us),qc=Xt(js),Yl=Xt(Ws),y1=Xt(zs),Xl=Xt(Vs),E1=Xt(wn),_1=Xt(ro),eh=Xt(Bi),x1=Xt(Qt),b1=Xt(no),Zl=Xt(ao),th=Ft;function Xt(s){return s&&s.__esModule?s:{default:s}}const rh="META-INF/container.xml",S1="META-INF/com.apple.ibooks.display-options.xml",Wr={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ih{constructor(e,r){typeof r=="undefined"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(r=e,e=void 0),this.settings=(0,jr.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,jr.extend)(this.settings,r),this.opening=new jr.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new jr.defer,spine:new jr.defer,metadata:new jr.defer,cover:new jr.defer,navigation:new jr.defer,pageList:new jr.defer,resources:new jr.defer,displayOptions:new jr.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||eh.default,this.spine=new v1.default,this.locations=new m1.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var t=new Error("Cannot load book at "+e);this.emit(th.EVENTS.BOOK.OPEN_FAILED,t)})}open(e,r){var i,t=r||this.determineType(e);return t===Wr.BINARY?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e)):t===Wr.BASE64?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e,t)):t===Wr.EPUB?(this.archived=!0,this.url=new Si.default("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):t==Wr.OPF?(this.url=new Si.default(e),i=this.openPackaging(this.url.Path.toString())):t==Wr.MANIFEST?(this.url=new Si.default(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Si.default(e),i=this.openContainer(rh).then(this.openPackaging.bind(this))),i}openEpub(e,r){return this.unarchive(e,r||this.settings.encoding).then(()=>this.openContainer(rh)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(r=>(this.container=new g1.default(r),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default(r),this.unpack(this.packaging)))}openManifest(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default,this.packaging.load(r),this.unpack(this.packaging)))}load(e){var r=this.resolve(e);return this.archived?this.archive.request(r):this.request(r,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,r){if(!!e){var i=e,t=e.indexOf("://")>-1;return t?e:(this.path&&(i=this.path.resolve(e)),r!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var r=e;return e?(this.settings.canonical?r=this.settings.canonical(e):r=this.resolve(e,!0),r):""}determineType(e){var r,i,t;if(this.settings.encoding==="base64")return Wr.BASE64;if(typeof e!="string")return Wr.BINARY;if(r=new Si.default(e),i=r.path(),t=i.extension,t&&(t=t.replace(/\?.*$/,"")),!t)return Wr.DIRECTORY;if(t==="epub")return Wr.EPUB;if(t==="opf")return Wr.OPF;if(t==="json")return Wr.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(S1)).then(r=>{this.displayOptions=new Zl.default(r),this.loading.displayOptions.resolve(this.displayOptions)}).catch(r=>{this.displayOptions=new Zl.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Zl.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new y1.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(r=>{console.error(r)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let r=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((t,n)=>{this.navigation=new Yl.default(i),e.pageList&&(this.pageList=new Xl.default(e.pageList)),t(this.navigation)}):r?this.load(r,"xml").then(t=>(this.navigation=new Yl.default(t),this.pageList=new Xl.default(t),this.navigation)):new Promise((t,n)=>{this.navigation=new Yl.default,this.pageList=new Xl.default,t(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,r){return this.rendition=new E1.default(this,r),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,r){return this.archive=new _1.default,this.archive.open(e,r)}store(e){let r=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,t=this.settings.requestMethod||eh.default.bind(this);return this.storage=new b1.default(e,t,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=r||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Si.default("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,r)=>{r.output=this.resources.substitute(e,r.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var r=new x1.default(e),i=this.spine.get(r.spinePos),t=this.load.bind(this);return i?i.load(t).then(function(n){var a=r.toRange(i.document);return a}):new Promise((n,a)=>{a("CFI could not be found")})}key(e){var r=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${th.EPUBJS_VERSION}:${r}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,p1.default)(ih.prototype);var T1=ih;ta.default=T1;var so={};Object.defineProperty(so,"__esModule",{value:!0});so.default=void 0;var nh=$i(ta),w1=$i(wn),A1=$i(Qt),O1=$i(ji),L1=D1(Be),ah=Ft;$i(Ea);$i(On);$i(Sa);function sh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(sh=function(i){return i?r:e})(s)}function D1(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||typeof s!="object"&&typeof s!="function")return{default:s};var r=sh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function $i(s){return s&&s.__esModule?s:{default:s}}function Vi(s,e){return new nh.default(s,e)}Vi.VERSION=ah.EPUBJS_VERSION;typeof Mt!="undefined"&&(Mt.EPUBJS_VERSION=ah.EPUBJS_VERSION);Vi.Book=nh.default;Vi.Rendition=w1.default;Vi.Contents=O1.default;Vi.CFI=A1.default;Vi.utils=L1;var I1=Vi;so.default=I1;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"Contents",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(s,"EpubCFI",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"Layout",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(s,"Rendition",{enumerable:!0,get:function(){return i.default}}),s.default=void 0;var e=o(ta),r=o(Qt),i=o(wn),t=o(ji),n=o(ga),a=o(so);function o(h){return h&&h.__esModule?h:{default:h}}var f=a.default;s.default=f})(ed);var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.default=void 0;var R1={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}},C1=R1;Aa.default=C1;function oo(s){return oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oo(s)}Object.defineProperty(bs,"__esModule",{value:!0});bs.default=void 0;var lo=k1(Ye.exports),Jt=Ql(ml.exports),P1=Ql(ed),M1=Ql(Aa);function Ql(s){return s&&s.__esModule?s:{default:s}}function oh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(oh=function(t){return t?r:e})(s)}function k1(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||oo(s)!=="object"&&typeof s!="function")return{default:s};var r=oh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function lh(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function N1(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lh(Object(r),!0).forEach(function(i){eu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):lh(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function F1(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function uh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function B1(s,e,r){return e&&uh(s.prototype,e),r&&uh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function U1(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Jl(s,e)}function Jl(s,e){return Jl=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},Jl(s,e)}function j1(s){var e=z1();return function(){var i=uo(s),t;if(e){var n=uo(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return W1(this,t)}}function W1(s,e){if(e&&(oo(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ql(s)}function ql(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function z1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function uo(s){return uo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(s)}function eu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var tu=function(s){U1(r,s);var e=j1(r);function r(i){var t;return F1(this,r),t=e.call(this,i),eu(ql(t),"onLocationChange",function(n){var a=t.props,o=a.location,f=a.locationChanged,h=n&&n.start;o!==h&&(t.location=h,f&&f(h))}),eu(ql(t),"handleKeyPress",function(n){var a=n.key;a&&a==="ArrowRight"&&t.nextPage(),a&&a==="ArrowLeft"&&t.prevPage()}),t.state={isLoaded:!1,toc:[]},t.viewerRef=lo.default.createRef(),t.location=i.location,t.book=t.rendition=t.prevPage=t.nextPage=null,t}return B1(r,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var t=this,n=this.props,a=n.url,o=n.tocChanged,f=n.epubInitOptions;this.book&&this.book.destroy(),this.book=new P1.default(a,f),this.book.loaded.navigation.then(function(h){var p=h.toc;t.setState({isLoaded:!0,toc:p},function(){o&&o(p),t.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(t){return!this.state.isLoaded||t.location!==this.props.location||t.location!==this.props.location}},{key:"componentDidUpdate",value:function(t){t.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),t.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var t=this,n=this.state.toc,a=this.props,o=a.location,f=a.epubOptions,h=a.getRendition,p=this.viewerRef.current;this.rendition=this.book.renderTo(p,N1({contained:!0,width:"100%",height:"100%"},f)),this.prevPage=function(){t.rendition.prev()},this.nextPage=function(){t.rendition.next()},this.registerEvents(),h&&h(this.rendition),typeof o=="string"||typeof o=="number"?this.rendition.display(o):n.length>0&&n[0].href?this.rendition.display(n[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var t=this.props,n=t.handleKeyPress,a=t.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",n||this.handleKeyPress),a&&this.rendition.on("selected",a)}},{key:"renderBook",value:function(){var t=this.props.styles;return lo.default.createElement("div",{ref:this.viewerRef,style:t.view})}},{key:"render",value:function(){var t=this.state.isLoaded,n=this.props,a=n.loadingView,o=n.styles;return lo.default.createElement("div",{style:o.viewHolder},t&&this.renderBook()||a)}}]),r}(lo.Component);tu.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,styles:M1.default,epubOptions:{},epubInitOptions:{}};tu.propTypes={url:Jt.default.oneOfType([Jt.default.string,Jt.default.instanceOf(ArrayBuffer)]),loadingView:Jt.default.element,location:Jt.default.oneOfType([Jt.default.string,Jt.default.number]),locationChanged:Jt.default.func,tocChanged:Jt.default.func,styles:Jt.default.object,epubInitOptions:Jt.default.object,epubOptions:Jt.default.object,getRendition:Jt.default.func,handleKeyPress:Jt.default.func,handleTextSelected:Jt.default.func};var $1=tu;bs.default=$1;var fo={};function zr(){return zr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},zr.apply(this,arguments)}var fh="Left",dh="Right",ch="Up",hh="Down",ru={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},iu={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ph="mousemove",vh="mouseup",V1="touchend",H1="touchmove",K1="touchstart";function G1(s,e,r,i){return s>e?r>0?dh:fh:i>0?hh:ch}function mh(s,e){if(e===0)return s;var r=Math.PI/180*e,i=s[0]*Math.cos(r)+s[1]*Math.sin(r),t=s[1]*Math.cos(r)-s[0]*Math.sin(r);return[i,t]}function Y1(s,e){var r=function(l){l&&"touches"in l&&l.touches.length>1||s(function(u,m){m.trackMouse&&(document.addEventListener(ph,i),document.addEventListener(vh,a));var y="touches"in l?l.touches[0]:l,b=y.clientX,_=y.clientY,g=mh([b,_],m.rotationAngle);return zr({},u,iu,{initial:[].concat(g),xy:g,start:l.timeStamp||0})})},i=function(l){s(function(u,m){if("touches"in l&&l.touches.length>1)return u;var y="touches"in l?l.touches[0]:l,b=y.clientX,_=y.clientY,g=mh([b,_],m.rotationAngle),c=g[0],v=g[1],E=c-u.xy[0],d=v-u.xy[1],x=Math.abs(E),S=Math.abs(d),T=(l.timeStamp||0)-u.start,w=Math.sqrt(x*x+S*S)/(T||1),L=[E/(T||1),d/(T||1)],I=G1(x,S,E,d),A=typeof m.delta=="number"?m.delta:m.delta[I.toLowerCase()]||ru.delta;if(x<A&&S<A&&!u.swiping)return u;var O={absX:x,absY:S,deltaX:E,deltaY:d,dir:I,event:l,first:u.first,initial:u.initial,velocity:w,vxvy:L};O.first&&m.onSwipeStart&&m.onSwipeStart(O),m.onSwiping&&m.onSwiping(O);var D=!1;return(m.onSwiping||m.onSwiped||"onSwiped"+I in m)&&(D=!0),D&&m.preventDefaultTouchmoveEvent&&m.trackTouch&&l.cancelable&&l.preventDefault(),zr({},u,{first:!1,eventData:O,swiping:!0})})},t=function(l){s(function(u,m){var y;if(u.swiping&&u.eventData){y=zr({},u.eventData,{event:l}),m.onSwiped&&m.onSwiped(y);var b=m["onSwiped"+y.dir];b&&b(y)}else m.onTap&&m.onTap({event:l});return zr({},u,iu,{eventData:y})})},n=function(){document.removeEventListener(ph,i),document.removeEventListener(vh,a)},a=function(l){n(),t(l)},o=function(l,u){var m=function(){};if(l&&l.addEventListener){var y=[[K1,r],[H1,i],[V1,t]];y.forEach(function(b){var _=b[0],g=b[1];return l.addEventListener(_,g,{passive:u})}),m=function(){return y.forEach(function(_){var g=_[0],c=_[1];return l.removeEventListener(g,c)})}}return m},f=function(l){l!==null&&s(function(u,m){if(u.el===l)return u;var y={};return u.el&&u.el!==l&&u.cleanUpTouch&&(u.cleanUpTouch(),y.cleanUpTouch=void 0),m.trackTouch&&l&&(y.cleanUpTouch=o(l,!m.preventDefaultTouchmoveEvent)),zr({},u,{el:l},y)})},h={ref:f};return e.trackMouse&&(h.onMouseDown=r),[h,o]}function X1(s,e,r){var i={};return!e.trackTouch&&s.cleanUpTouch?(s.cleanUpTouch(),i.cleanUpTouch=void 0):e.trackTouch&&!s.cleanUpTouch&&s.el&&(i.cleanUpTouch=r(s.el,!e.preventDefaultTouchmoveEvent)),zr({},s,i)}function Z1(s){var e=s.trackMouse,r=Ye.exports.useRef(zr({},iu)),i=Ye.exports.useRef(zr({},ru));i.current=zr({},ru,s);var t=Ye.exports.useMemo(function(){return Y1(function(o){return r.current=o(r.current,i.current)},{trackMouse:e})},[e]),n=t[0],a=t[1];return r.current=X1(r.current,i.current,a),n}var Q1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DOWN:hh,LEFT:fh,RIGHT:dh,UP:ch,useSwipeable:Z1}),J1=Eo(Q1),Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.default=void 0;var q1={container:{overflow:"hidden",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}},eS=q1;Oa.default=eS;function co(s){return co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(s)}Object.defineProperty(fo,"__esModule",{value:!0});fo.default=void 0;var _t=aS(Ye.exports),Rr=yh(ml.exports),tS=J1,rS=vl,gh=yh(Oa),iS=["children"],nS=["title","showToc","loadingView","styles","locationChanged","swipeable","epubViewStyles"];function yh(s){return s&&s.__esModule?s:{default:s}}function Eh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Eh=function(t){return t?r:e})(s)}function aS(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||co(s)!=="object"&&typeof s!="function")return{default:s};var r=Eh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function ho(){return ho=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},ho.apply(this,arguments)}function _h(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function xh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function bh(s,e,r){return e&&xh(s.prototype,e),r&&xh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function Sh(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&nu(s,e)}function nu(s,e){return nu=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},nu(s,e)}function Th(s){var e=oS();return function(){var i=po(s),t;if(e){var n=po(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return sS(this,t)}}function sS(s,e){if(e&&(co(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hi(s)}function Hi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function oS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function po(s){return po=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},po(s)}function Rn(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function wh(s,e){if(s==null)return{};var r=lS(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function lS(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}var uS=function(e){var r=e.children,i=wh(e,iS),t=(0,tS.useSwipeable)(i);return _t.default.createElement("div",t,r)},Ah=function(s){Sh(r,s);var e=Th(r);function r(){var i;_h(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),Rn(Hi(i),"setLocation",function(){i.props.setLocation(i.props.href)}),i}return bh(r,[{key:"render",value:function(){var t=this.props,n=t.label,a=t.styles;return _t.default.createElement("button",{onClick:this.setLocation,style:a},n)}}]),r}(_t.PureComponent);Ah.propTypes={label:Rr.default.string,href:Rr.default.string,setLocation:Rr.default.func,styles:Rr.default.object};var au=function(s){Sh(r,s);var e=Th(r);function r(i){var t;return _h(this,r),t=e.call(this,i),Rn(Hi(t),"toggleToc",function(){t.setState({expandedToc:!t.state.expandedToc})}),Rn(Hi(t),"next",function(){var n=t.readerRef.current;n.nextPage()}),Rn(Hi(t),"prev",function(){var n=t.readerRef.current;n.prevPage()}),Rn(Hi(t),"onTocChange",function(n){var a=t.props.tocChanged;t.setState({toc:n},function(){return a&&a(n)})}),Rn(Hi(t),"setLocation",function(n){var a=t.props.locationChanged;t.setState({expandedToc:!1},function(){return a&&a(n)})}),t.readerRef=_t.default.createRef(),t.state={expandedToc:!1,toc:!1},t}return bh(r,[{key:"renderToc",value:function(){var t=this,n=this.state,a=n.toc,o=n.expandedToc,f=this.props.styles;return _t.default.createElement("div",null,_t.default.createElement("div",{style:f.tocArea},_t.default.createElement("div",{style:f.toc},a.map(function(h,p){return _t.default.createElement(Ah,ho({},h,{key:p,setLocation:t.setLocation,styles:f.tocAreaButton}))}))),o&&_t.default.createElement("div",{style:f.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var t=this.state.expandedToc,n=this.props.styles;return _t.default.createElement("button",{style:Object.assign({},n.tocButton,t?n.tocButtonExpanded:{}),onClick:this.toggleToc},_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBarTop)}),_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBottom)}))}},{key:"render",value:function(){var t=this.props,n=t.title,a=t.showToc,o=t.loadingView,f=t.styles,h=t.locationChanged,p=t.swipeable,l=t.epubViewStyles,u=wh(t,nS),m=this.state,y=m.toc,b=m.expandedToc;return _t.default.createElement("div",{style:f.container},_t.default.createElement("div",{style:Object.assign({},f.readerArea,b?f.containerExpanded:{})},a&&this.renderTocToggle(),_t.default.createElement("div",{style:f.titleArea},n),_t.default.createElement(uS,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},_t.default.createElement("div",{style:f.reader},_t.default.createElement(rS.EpubView,ho({ref:this.readerRef,loadingView:o,styles:l},u,{tocChanged:this.onTocChange,locationChanged:h})),p&&_t.default.createElement("div",{style:f.swipeWrapper}))),_t.default.createElement("button",{style:Object.assign({},f.arrow,f.prev),onClick:this.prev},"\u2039"),_t.default.createElement("button",{style:Object.assign({},f.arrow,f.next),onClick:this.next},"\u203A")),a&&y&&this.renderToc())}}]),r}(_t.PureComponent);au.defaultProps={loadingView:_t.default.createElement("div",{style:gh.default.loadingView},"Loading\u2026"),locationChanged:null,tocChanged:null,showToc:!0,styles:gh.default};au.propTypes={title:Rr.default.string,loadingView:Rr.default.element,showToc:Rr.default.bool,locationChanged:Rr.default.func,tocChanged:Rr.default.func,styles:Rr.default.object,epubViewStyles:Rr.default.object,swipeable:Rr.default.bool};var fS=au;fo.default=fS;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"EpubViewStyle",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"ReactReader",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"ReactReaderStyle",{enumerable:!0,get:function(){return t.default}});var e=n(bs),r=n(Aa),i=n(fo),t=n(Oa);function n(a){return a&&a.__esModule?a:{default:a}}})(vl);const Oh=(s=!0)=>{const{setShowUnfold:e,unfold:r}=Ye.exports.useContext($r);return Ye.exports.useEffect(()=>(s&&e(!0),()=>{e(!1)}),[]),{unfold:r,setShowUnfold:e}},dS=-1,cS=["epub"],hS=({file:s})=>{const[e,r]=Ye.exports.useState(void 0),i=a=>{r(a)},{unfold:t}=Oh(!0),n=ui();return q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"epub-box"},q.createElement(vl.ReactReader,{location:e,locationChanged:i,url:n()}))};var pS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:dS,exts:cS,default:hS});const vS=6,mS=[],gS=({file:s})=>{const e=ui(),[r,i]=Ye.exports.useState(""),{getSetting:t,password:n}=Ye.exports.useContext($r);return Ye.exports.useEffect(()=>{i(e(s))},[]),q.createElement(Zi,{className:"image-box",w:"full"},q.createElement(Zh,{maxH:"75vh",fallback:q.createElement(Qh,{color:t("icon color")||"#1890ff",size:"xl"}),rounded:"lg",src:r}))};var yS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:vS,exts:mS,default:gS});let su="/";su==="/"&&(su=window.location.origin+"/");const ES=su,_S=-1,xS=["ipa"],bS=({file:s})=>{const{getSetting:e}=Ye.exports.useContext($r),r=s.name.split(".").pop()||"",i=ui(),{t}=kn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ra,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(_r,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(xo,{href:`itms-services://?action=download-manifest&url=${ES}i/${btoa(n).replaceAll("/","_").replaceAll("=","-")}/ipa.plist`},q.createElement(_r,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var SS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:_S,exts:xS,default:bS});const TS=-1,wS=[],Lh=({url:s,unfold:e})=>{const{getSetting:r}=Ye.exports.useContext($r),i=r("pdf viewer url")||"https://alist-org.github.io/pdf.js/web/viewer.html?file=$url";return q.createElement(Zi,{w:"full",h:"full",className:"pdf-preview-box"},q.createElement("iframe",{title:"pdf-viewer",width:"100%",height:"100%",src:i.replace("$url",s)}))};var AS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:TS,exts:wS,default:Lh});const OS=2,LS=[],DS=({file:s})=>{const{pathname:e}=Jh(),{password:r}=Ye.exports.useContext($r);let i=ui(!1,!1);const{unfold:t,setShowUnfold:n}=Oh(!1),[a,o]=q.useState(""),[f,h]=q.useState(""),p=i(),[l,u]=q.useState("office"),m=[{name:"office",url:`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(p)}`},{name:"google",url:`https://docs.google.com/gview?url=${encodeURIComponent(p)}&embedded=true`}],y=()=>{s.driver==="AliDrive"?cp.post("preview",{path:e,password:r}).then(b=>{const _=b.data;if(_.code!==200)return;aliyun.config({mount:document.querySelector("#office-preview"),url:_.data.preview_url}).setToken({token:_.data.access_token})}):(s.name.endsWith(".pdf")?(h(i()),o("pdf")):o("office"),n(!0))};return Ye.exports.useEffect(()=>{y()},[]),q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",id:"office-preview",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"office-preview-box"},a==="office"&&q.createElement(Xi,{w:"full",h:"full"},q.createElement(qh,{m:"1",onChange:u,value:l},q.createElement(ep,{direction:"row"},m.map(b=>q.createElement(tp,{value:b.name,key:b.name},b.name)))),m.map(b=>b.name===l&&q.createElement("iframe",{key:b.name,width:"100%",style:{height:"calc(100% - 24px - 0.25rem)"},src:b.url,frameBorder:"0"}))),a==="pdf"&&q.createElement(Lh,{url:f,unfold:t||!1}))};var IS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:OS,exts:LS,default:DS});const RS=-1,CS=["plist"],PS=({file:s})=>{const{getSetting:e}=Ye.exports.useContext($r),r=s.name.split(".").pop()||"",i=ui(),{t}=kn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ra,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(_r,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(xo,{href:"itms-services://?action=download-manifest&url="+n},q.createElement(_r,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var MS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:RS,exts:CS,default:PS}),Dh={exports:{}};/*!
 * artplayer.js v4.4.3
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(s,e){(function(r,i,t,n,a){var o=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Mt!="undefined"?Mt:{},f=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0,h=f.cache||{},p=typeof Er=="function"&&Er.bind(s);function l(y,b){if(!h[y]){if(!r[y]){var _=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0;if(!b&&_)return _(y,!0);if(f)return f(y,!0);if(p&&typeof y=="string")return p(y);var g=new Error("Cannot find module '"+y+"'");throw g.code="MODULE_NOT_FOUND",g}v.resolve=function(E){var d=r[y][1][E];return d!=null?d:E},v.cache={};var c=h[y]=new l.Module(y);r[y][0].call(c.exports,v,c,c.exports,this)}return h[y].exports;function v(E){var d=v.resolve(E);return d===!1?{}:l(d)}}l.isParcelRequire=!0,l.Module=function(y){this.id=y,this.bundle=l,this.exports={}},l.modules=r,l.cache=h,l.parent=f,l.register=function(y,b){r[y]=[function(_,g){g.exports=b},{}]},Object.defineProperty(l,"root",{get:function(){return o.parcelRequire4dc0}}),o.parcelRequire4dc0=l;for(var u=0;u<i.length;u++)l(i[u]);var m=l(t);s.exports=m})({"6SN6P":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("bundle-text:./style/index.less"),o=n.interopDefault(a),f=r("option-validator"),h=n.interopDefault(f),p=r("./utils/emitter"),l=n.interopDefault(p),u=r("./utils"),m=r("./scheme"),y=n.interopDefault(m),b=r("./config"),_=n.interopDefault(b),g=r("./whitelist"),c=n.interopDefault(g),v=r("./template"),E=n.interopDefault(v),d=r("./i18n"),x=n.interopDefault(d),S=r("./player"),T=n.interopDefault(S),w=r("./control"),L=n.interopDefault(w),I=r("./contextmenu"),A=n.interopDefault(I),O=r("./info"),D=n.interopDefault(O),R=r("./subtitle"),C=n.interopDefault(R),P=r("./events"),M=n.interopDefault(P),N=r("./hotkey"),B=n.interopDefault(N),U=r("./layer"),F=n.interopDefault(U),j=r("./loading"),$=n.interopDefault(j),G=r("./notice"),Y=n.interopDefault(G),X=r("./mask"),ie=n.interopDefault(X),pe=r("./icons"),ue=n.interopDefault(pe),we=r("./setting"),de=n.interopDefault(we),oe=r("./storage"),De=n.interopDefault(oe),Ce=r("./plugins"),Ue=n.interopDefault(Ce),Me=r("./ads"),ze=n.interopDefault(Me),Ge=r("./mobile"),Ke=n.interopDefault(Ge);let He=0;const Fe=[];class Se extends l.default{constructor(st,et){super(),this.id=++He;const ot=u.mergeDeep(Se.option,st);this.option=h.default(ot,y.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new c.default(this),this.template=new E.default(this),this.events=new M.default(this),this.whitelist.state?(this.storage=new De.default(this),this.icons=new ue.default(this),this.i18n=new x.default(this),this.notice=new Y.default(this),this.player=new T.default(this),this.layers=new F.default(this),this.controls=new L.default(this),this.contextmenu=new A.default(this),this.subtitle=new C.default(this),this.ads=new ze.default(this),this.info=new D.default(this),this.loading=new $.default(this),this.hotkey=new B.default(this),this.mask=new ie.default(this),this.setting=new de.default(this),this.plugins=new Ue.default(this)):this.mobile=new Ke.default(this),typeof et=="function"&&this.on("ready",()=>et.call(this)),Fe.push(this)}static get instances(){return Fe}static get version(){return"4.4.3"}static get env(){return"production"}static get build(){return"1653543392822"}static get config(){return _.default}static get utils(){return u}static get scheme(){return y.default}static get Emitter(){return l.default}static get validator(){return h.default}static get kindOf(){return h.default.kindOf}static get html(){return E.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,ads:[],layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:u.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(st=!0){this.events.destroy(),this.template.destroy(st),Fe.splice(Fe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(t.default=Se,Se.NOTICE_TIME=2e3,Se.SETTING_WIDTH=250,Se.SETTING_ITEM_WIDTH=200,Se.SETTING_ITEM_HEIGHT=35,Se.INDICATOR_SIZE=14,Se.INDICATOR_SIZE_ICON=16,Se.INDICATOR_SIZE_MOBILE=18,Se.INDICATOR_SIZE_MOBILE_ICON=20,Se.VOLUME_PANEL_WIDTH=60,Se.VOLUME_HANDLE_WIDTH=12,Se.RESIZE_TIME=500,Se.SCROLL_TIME=200,Se.SCROLL_GAP=50,Se.AUTO_PLAYBACK_MAX=10,Se.RECONNECT_TIME_MAX=5,Se.RECONNECT_SLEEP_TIME=1e3,Se.CONTROL_HIDE_TIME=3e3,Se.DB_CLICE_TIME=300,Se.MOBILE_AUTO_PLAYBACKRATE=3,Se.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,Se.MOBILE_AUTO_ORIENTATION_TIME=200,Se.INFO_LOOP_TIME=1e3,Se.FAST_FORWARD_VALUE=3,Se.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const Xe=document.createElement("style");Xe.id="artplayer-style",Xe.textContent=o.default,document.head.appendChild(Xe)}typeof window!="undefined"&&(window.Artplayer=Se),console.log(`%c ArtPlayer %c ${Se.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"hqjoJ","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./ads":"aafSd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(r,i,t){i.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:0}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:0}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000000;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],hqjoJ:[function(r,i,t){i.exports=function(){function n(u){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(u)}var a=Object.prototype.toString,o=function(u){if(u===void 0)return"undefined";if(u===null)return"null";var m=n(u);if(m==="boolean")return"boolean";if(m==="string")return"string";if(m==="number")return"number";if(m==="symbol")return"symbol";if(m==="function")return function(y){return f(y)==="GeneratorFunction"}(u)?"generatorfunction":"function";if(function(y){return Array.isArray?Array.isArray(y):y instanceof Array}(u))return"array";if(function(y){return!(!y.constructor||typeof y.constructor.isBuffer!="function")&&y.constructor.isBuffer(y)}(u))return"buffer";if(function(y){try{if(typeof y.length=="number"&&typeof y.callee=="function")return!0}catch(b){if(b.message.indexOf("callee")!==-1)return!0}return!1}(u))return"arguments";if(function(y){return y instanceof Date||typeof y.toDateString=="function"&&typeof y.getDate=="function"&&typeof y.setDate=="function"}(u))return"date";if(function(y){return y instanceof Error||typeof y.message=="string"&&y.constructor&&typeof y.constructor.stackTraceLimit=="number"}(u))return"error";if(function(y){return y instanceof RegExp||typeof y.flags=="string"&&typeof y.ignoreCase=="boolean"&&typeof y.multiline=="boolean"&&typeof y.global=="boolean"}(u))return"regexp";switch(f(u)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(y){return typeof y.throw=="function"&&typeof y.return=="function"&&typeof y.next=="function"}(u))return"generator";switch(m=a.call(u)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return m.slice(8,-1).toLowerCase().replace(/\s/g,"")};function f(u){return u.constructor?u.constructor.name:null}function h(u,m){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return p(u,m,y),l(u,m,y),function(b,_,g){var c=o(_),v=o(b);if(c==="object"){if(v!=="object")throw new Error("[Type Error]: '".concat(g.join("."),"' require 'object' type, but got '").concat(v,"'"));Object.keys(_).forEach(function(E){var d=b[E],x=_[E],S=g.slice();S.push(E),p(d,x,S),l(d,x,S),h(d,x,S)})}if(c==="array"){if(v!=="array")throw new Error("[Type Error]: '".concat(g.join("."),"' require 'array' type, but got '").concat(v,"'"));b.forEach(function(E,d){var x=b[d],S=_[d]||_[0],T=g.slice();T.push(d),p(x,S,T),l(x,S,T),h(x,S,T)})}}(u,m,y),u}function p(u,m,y){if(o(m)==="string"){var b=o(u);if(m[0]==="?"&&(m=m.slice(1)+"|undefined"),!(-1<m.indexOf("|")?m.split("|").map(function(_){return _.toLowerCase().trim()}).filter(Boolean).some(function(_){return b===_}):m.toLowerCase().trim()===b))throw new Error("[Type Error]: '".concat(y.join("."),"' require '").concat(m,"' type, but got '").concat(b,"'"))}}function l(u,m,y){if(o(m)==="function"){var b=m(u,o(u),y);if(b!==!0){var _=o(b);throw _==="string"?new Error(b):_==="error"?b:new Error("[Validator Error]: The scheme for '".concat(y.join("."),"' validator require return true, but got '").concat(b,"'"))}}}return h.kindOf=o,h}()},{}],"7pHuB":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{on(n,a,o){const f=this.e||(this.e={});return(f[n]||(f[n]=[])).push({fn:a,ctx:o}),this}once(n,a,o){const f=this;function h(...p){f.off(n,h),a.apply(o,p)}return h._=a,this.on(n,h,o)}emit(n,...a){const o=((this.e||(this.e={}))[n]||[]).slice();for(let f=0;f<o.length;f+=1)o[f].fn.apply(o[f].ctx,a);return this}off(n,a){const o=this.e||(this.e={}),f=o[n],h=[];if(f&&a)for(let p=0,l=f.length;p<l;p+=1)f[p].fn!==a&&f[p].fn._!==a&&h.push(f[p]);return h.length?o[n]=h:delete o[n],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(r,i,t){t.interopDefault=function(n){return n&&n.__esModule?n:{default:n}},t.defineInteropFlag=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.exportAll=function(n,a){return Object.keys(n).forEach(function(o){o==="default"||o==="__esModule"||a.hasOwnProperty(o)||Object.defineProperty(a,o,{enumerable:!0,get:function(){return n[o]}})}),a},t.export=function(n,a,o){Object.defineProperty(n,a,{enumerable:!0,get:o})}},{}],geSvU:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom");n.exportAll(a,t);var o=r("./error");n.exportAll(o,t);var f=r("./subtitle");n.exportAll(f,t);var h=r("./file");n.exportAll(h,t);var p=r("./property");n.exportAll(p,t);var l=r("./time");n.exportAll(l,t);var u=r("./format");n.exportAll(u,t);var m=r("./compatibility");n.exportAll(m,t)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"query",()=>o),n.export(t,"queryAll",()=>f),n.export(t,"addClass",()=>h),n.export(t,"removeClass",()=>p),n.export(t,"hasClass",()=>l),n.export(t,"append",()=>u),n.export(t,"remove",()=>m),n.export(t,"setStyle",()=>y),n.export(t,"setStyles",()=>b),n.export(t,"getStyle",()=>_),n.export(t,"sublings",()=>g),n.export(t,"inverseClass",()=>c),n.export(t,"tooltip",()=>v),n.export(t,"isInViewport",()=>E),n.export(t,"includeFromEvent",()=>d),n.export(t,"replaceElement",()=>x);var a=r("./compatibility");function o(S,T=document){return T.querySelector(S)}function f(S,T=document){return Array.from(T.querySelectorAll(S))}function h(S,T){return S.classList.add(T)}function p(S,T){return S.classList.remove(T)}function l(S,T){return S.classList.contains(T)}function u(S,T){return T instanceof Element?S.appendChild(T):S.insertAdjacentHTML("beforeend",String(T)),S.lastElementChild||S.lastChild}function m(S){return S.parentNode.removeChild(S)}function y(S,T,w){return S.style[T]=w,S}function b(S,T){return Object.keys(T).forEach(w=>{y(S,w,T[w])}),S}function _(S,T,w=!0){const L=window.getComputedStyle(S,null).getPropertyValue(T);return w?parseFloat(L):L}function g(S){return Array.from(S.parentElement.children).filter(T=>T!==S)}function c(S,T){g(S).forEach(w=>p(w,T)),h(S,T)}function v(S,T,w="top"){a.isMobile||(S.setAttribute("aria-label",T),h(S,"hint--rounded"),h(S,`hint--${w}`))}function E(S,T=0){const w=S.getBoundingClientRect(),L=window.innerHeight||document.documentElement.clientHeight,I=window.innerWidth||document.documentElement.clientWidth,A=w.top-T<=L&&w.top+w.height+T>=0,O=w.left-T<=I+T&&w.left+w.width+T>=0;return A&&O}function d(S,T){return S.composedPath&&S.composedPath().indexOf(T)>-1}function x(S,T){return T.parentNode.replaceChild(S,T),S}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"userAgent",()=>a),n.export(t,"isMobile",()=>o),n.export(t,"isSafari",()=>f),n.export(t,"isWechat",()=>h),n.export(t,"isIE",()=>p),n.export(t,"isAndroid",()=>l),n.export(t,"isIOS",()=>u);const a=typeof window!="undefined"?window.navigator.userAgent:"",o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),f=/^((?!chrome|android).)*safari/i.test(a),h=/MicroMessenger/i.test(a),p=/MSIE|Trident/i.test(a),l=/android/i.test(a),u=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ArtPlayerError",()=>a),n.export(t,"errorHandle",()=>o);class a extends Error{constructor(h,p){super(h),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,p||this.constructor),this.name="ArtPlayerError"}}function o(f,h){if(!f)throw new a(h);return f}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h){return`WEBVTT \r
\r
`.concat((p=h,p.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(l,u,m)=>{let y=m.slice(0,3);return m.length===1&&(y=m+"00"),m.length===2&&(y=m+"0"),`${u},${y}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var p}function o(h){return URL.createObjectURL(new Blob([h],{type:"text/vtt"}))}function f(h){const p=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function l(u=""){return u.split(/[:.]/).map((m,y,b)=>{if(y===b.length-1){if(m.length===1)return`.${m}00`;if(m.length===2)return`.${m}0`}else if(m.length===1)return(y===0?"0":":0")+m;return y===0?m:y===b.length-1?`.${m}`:`:${m}`}).join("")}return`WEBVTT

${h.split(/\r?\n/).map(u=>{const m=u.match(p);return m?{start:l(m[1].trim()),end:l(m[2].trim()),text:m[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(y=>y.trim()).join(`
`)}:null}).filter(u=>u).map((u,m)=>u?`${m+1}
${u.start} --> ${u.end}
${u.text}`:"").filter(u=>u.trim()).join(`

`)}`}n.defineInteropFlag(t),n.export(t,"srtToVtt",()=>a),n.export(t,"vttToBlob",()=>o),n.export(t,"assToVtt",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(f){return f.includes("?")?a(f.split("?")[0]):f.includes("#")?a(f.split("#")[0]):f.trim().toLowerCase().split(".").pop()}function o(f,h){const p=document.createElement("a");p.style.display="none",p.href=f,p.download=h,document.body.appendChild(p),p.click(),document.body.removeChild(p)}n.defineInteropFlag(t),n.export(t,"getExt",()=>a),n.export(t,"download",()=>o)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"def",()=>a),n.export(t,"has",()=>f),n.export(t,"get",()=>h),n.export(t,"mergeDeep",()=>p);const a=Object.defineProperty,{hasOwnProperty:o}=Object.prototype;function f(l,u){return o.call(l,u)}function h(l,u){return Object.getOwnPropertyDescriptor(l,u)}function p(...l){const u=m=>m&&typeof m=="object"&&!Array.isArray(m);return l.reduce((m,y)=>(Object.keys(y).forEach(b=>{const _=m[b],g=y[b];Array.isArray(_)&&Array.isArray(g)?m[b]=_.concat(...g):!u(_)||!u(g)||g instanceof Element?m[b]=g:m[b]=p(_,g)}),m),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h=0){return new Promise(p=>setTimeout(p,h))}function o(h,p,l){let u;function m(...y){clearTimeout(u),u=setTimeout(function(){u=null,h.apply(l,y)},p)}return m.clearTimeout=function(){clearTimeout(u)},m}function f(h,p){let l,u,m=!1;return function y(...b){if(m)return l=b,void(u=this);m=!0,h.apply(this,b),setTimeout(()=>{m=!1,l&&(y.apply(u,l),l=null,u=null)},p)}}n.defineInteropFlag(t),n.export(t,"sleep",()=>a),n.export(t,"debounce",()=>o),n.export(t,"throttle",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h,p,l){return Math.max(Math.min(h,Math.max(p,l)),Math.min(p,l))}function o(h){const p=Math.floor(h/3600),l=Math.floor((h-3600*p)/60),u=Math.floor(h-3600*p-60*l);return(p>0?[p,l,u]:[l,u]).map(m=>m<10?`0${m}`:String(m)).join(":")}function f(h){return h.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}n.defineInteropFlag(t),n.export(t,"clamp",()=>a),n.export(t,"secondToTime",()=>o),n.export(t,"escape",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ComponentOption",()=>y);var a=r("../utils");const o="array",f="boolean",h="string",p="number",l="object",u="function";function m(b,_,g){return a.errorHandle(_===h||_===p||b instanceof Element,`${g.join(".")} require '${h}' or 'Element' type`)}const y={html:m,disable:`?${f}`,name:`?${h}`,index:`?${p}`,style:`?${l}`,click:`?${u}`,mounted:`?${u}`,tooltip:`?${h}|${p}`,width:`?${p}`,selector:`?${o}`,onSelect:`?${u}`,switch:`?${f}`,onSwitch:`?${u}`,range:`?${o}`,onRange:`?${u}`};t.default={container:m,url:h,poster:h,title:h,type:h,theme:h,lang:h,volume:p,isLive:f,muted:f,autoplay:f,autoSize:f,autoMini:f,loop:f,flip:f,playbackRate:f,aspectRatio:f,screenshot:f,setting:f,hotkey:f,pip:f,mutex:f,backdrop:f,fullscreen:f,fullscreenWeb:f,subtitleOffset:f,miniProgressBar:f,useSSR:f,playsInline:f,lock:f,fastForward:f,autoPlayback:f,autoOrientation:f,ads:[{url:h}],plugins:[u],whitelist:[`${h}|${u}|regexp`],layers:[y],contextmenu:[y],settings:[y],controls:[bt(mt({},y),{position:(b,_,g)=>{const c=["top","left","right"];return a.errorHandle(c.includes(b),`${g.join(".")} only accept ${c.toString()} as parameters`)}})],quality:[{default:`?${f}`,html:h,url:h}],highlight:[{time:p,text:h}],thumbnails:{url:h,number:p,column:p},subtitle:{url:h,type:h,style:l,encoding:h},moreVideoAttr:l,icons:l,customType:l}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a}get state(){const{option:a,constructor:{kindOf:o}}=this.art;return!n.isMobile||a.whitelist.some(f=>{switch(o(f)){case"string":return f==="*"||n.userAgent.indexOf(f)>-1;case"function":return f(n.userAgent);case"regexp":return f.test(n.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");class a{constructor(f){this.art=f;const{option:h,constructor:p,whitelist:l}=f;h.container instanceof Element?this.$container=h.container:(this.$container=n.query(h.container),n.errorHandle(this.$container,`No container element found by ${h.container}`));const u=this.$container.tagName.toLowerCase();n.errorHandle(u==="div",`Unsupported container element type, only support 'div' but got '${u}'`),n.errorHandle(p.instances.every(m=>m.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=f.id,this.$original=this.$container.cloneNode(!0),l.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.4.3</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(f){return n.query(f,this.$container)}desktop(){const{option:f}=this.art;f.useSSR||(this.$container.innerHTML=a.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),f.backdrop&&(n.addClass(this.$setting,"art-backdrop-filter"),n.addClass(this.$contextmenu,"art-backdrop-filter"),n.addClass(this.$info,"art-backdrop-filter")),n.isMobile&&n.addClass(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(f){f?n.replaceElement(this.$original,this.$container):n.addClass(this.$player,"art-destroy")}}t.default=a},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./zh-cn.json"),f=n.interopDefault(o),h=r("./zh-tw.json"),p=n.interopDefault(h),l=r("./pl.json"),u=n.interopDefault(l),m=r("./cs.json"),y=n.interopDefault(m);t.default=class{constructor(b){this.art=b,this.languages={"zh-cn":f.default,"zh-tw":p.default,pl:u.default,cs:y.default},this.init()}init(){const b=this.art.option.lang.toLowerCase();this.language=this.languages[b]||{}}get(b){return this.language[b]||b}update(b){this.languages=a.mergeDeep(this.languages,b),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./pl.json":"3cd1e","./cs.json":"an7cR"}],e7BQ4:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u4E3A\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"5kFyN":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u70BA\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"3cd1e":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Auto playback at":"Automatyczne odtwarzanie za"}')},{}],an7cR:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Auto playback at":"Automatick\xE9 p\u0159ehr\xE1v\xE1n\xED za"}')},{}],fzROd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./urlMix"),o=n.interopDefault(a),f=r("./attrMix"),h=n.interopDefault(f),p=r("./playMix"),l=n.interopDefault(p),u=r("./pauseMix"),m=n.interopDefault(u),y=r("./toggleMix"),b=n.interopDefault(y),_=r("./seekMix"),g=n.interopDefault(_),c=r("./volumeMix"),v=n.interopDefault(c),E=r("./currentTimeMix"),d=n.interopDefault(E),x=r("./durationMix"),S=n.interopDefault(x),T=r("./switchMix"),w=n.interopDefault(T),L=r("./playbackRateMix"),I=n.interopDefault(L),A=r("./aspectRatioMix"),O=n.interopDefault(A),D=r("./screenshotMix"),R=n.interopDefault(D),C=r("./fullscreenMix"),P=n.interopDefault(C),M=r("./fullscreenWebMix"),N=n.interopDefault(M),B=r("./pipMix"),U=n.interopDefault(B),F=r("./loadedMix"),j=n.interopDefault(F),$=r("./playedMix"),G=n.interopDefault($),Y=r("./playingMix"),X=n.interopDefault(Y),ie=r("./autoSizeMix"),pe=n.interopDefault(ie),ue=r("./rectMix"),we=n.interopDefault(ue),de=r("./flipMix"),oe=n.interopDefault(de),De=r("./miniMix"),Ce=n.interopDefault(De),Ue=r("./loopMix"),Me=n.interopDefault(Ue),ze=r("./posterMix"),Ge=n.interopDefault(ze),Ke=r("./autoHeightMix"),He=n.interopDefault(Ke),Fe=r("./themeMix"),Se=n.interopDefault(Fe),Xe=r("./titleMix"),st=n.interopDefault(Xe),et=r("./normalSizeMix"),ot=n.interopDefault(et),nt=r("./subtitleOffsetMix"),dt=n.interopDefault(nt),ne=r("./optionInit"),Ee=n.interopDefault(ne),xe=r("./eventInit"),Ae=n.interopDefault(xe);t.default=class{constructor(be){o.default(be),h.default(be),l.default(be),m.default(be),b.default(be),g.default(be),v.default(be),d.default(be),S.default(be),w.default(be),I.default(be),O.default(be),R.default(be),P.default(be),N.default(be),U.default(be),j.default(be),G.default(be),X.default(be),pe.default(be),we.default(be),oe.default(be),Ce.default(be),Me.default(be),Ge.default(be),He.default(be),Se.default(be),st.default(be),ot.default(be),dt.default(be),Ae.default(be),Ee.default(be)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./normalSizeMix":"iEQHG"}],cChak:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$video:f}}=a;n.def(a,"url",{get:()=>f.currentSrc,set(h){return er(this,null,function*(){const p=o.type||n.getExt(h),l=o.customType[p];p&&l?(yield n.sleep(),a.loading.show=!0,l.call(a,f,h,a)):(a.url&&a.url!==h&&a.once("video:canplay",()=>{a.isReady&&a.emit("restart")}),f.src=h,a.option.url=h,a.emit("url",h))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o}}=a;n.def(a,"attr",{value(f,h){if(h===void 0)return o[f];o[f]=h}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:f,option:h,constructor:{instances:p},template:{$video:l}}=a;n.def(a,"play",{value(){const u=l.play();if(u&&u.then&&u.then().catch(m=>{throw f.show=m,m}),h.mutex)for(let m=0;m<p.length;m++){const y=p[m];y!==a&&y.pause()}return f.show=o.get("Play"),a.emit("play"),u}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:f,notice:h}=a;n.def(a,"pause",{value(){const p=o.pause();return h.show=f.get("Pause"),a.emit("pause"),p}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"toggle",{value:()=>a.playing?a.pause():a.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o}=a;n.def(a,"seek",{set(f){a.currentTime=f,a.emit("seek",a.currentTime),a.duration&&(o.show=`${n.secondToTime(a.currentTime)} / ${n.secondToTime(a.duration)}`)}}),n.def(a,"forward",{set(f){a.seek=a.currentTime+f}}),n.def(a,"backward",{set(f){a.seek=a.currentTime-f}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:f,notice:h,storage:p}=a;n.def(a,"volume",{get:()=>o.volume||0,set:l=>{o.volume=n.clamp(l,0,1),h.show=`${f.get("Volume")}: ${parseInt(100*o.volume,10)}`,o.volume!==0&&p.set("volume",o.volume),a.emit("volume",o.volume)}}),n.def(a,"muted",{get:()=>o.muted,set:l=>{o.muted=l,a.emit("volume",o.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"currentTime",{get:()=>o.currentTime||0,set:f=>{f=parseFloat(f),Number.isNaN(f)||(o.currentTime=n.clamp(f,0,a.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"duration",{get:()=>{const{duration:o}=a.template.$video;return o===1/0?0:o||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:f,notice:h}=a;function p(l,u,m){return new Promise(y=>{if(l===a.url)return y(l);const{playing:b}=a;a.pause(),URL.revokeObjectURL(a.url),a.url=l,a.once("video:canplay",()=>{a.playbackRate=!1,a.aspectRatio=!1,a.flip="normal",a.autoSize=f.autoSize,a.currentTime=m,a.notice.show="",b&&a.play(),u&&(h.show=`${o.get("Switch Video")}: ${u}`),a.emit("switch",l),y(l)})})}n.def(a,"switchQuality",{value:(l,u)=>p(l,u,a.currentTime)}),n.def(a,"switchUrl",{value:(l,u)=>p(l,u,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:f,notice:h}=a;n.def(a,"playbackRate",{get:()=>o.playbackRate,set(p){if(p){if(p===o.playbackRate)return;const l=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];n.errorHandle(l.includes(p),`'playbackRate' only accept ${l.toString()} as parameters`),o.playbackRate=p,h.show=`${f.get("Rate")}: ${p===1?f.get("Normal"):`${p}x`}`,a.emit("playbackRate",p)}else a.playbackRate=1,a.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o,$player:f},i18n:h,notice:p}=a;n.def(a,"aspectRatio",{get:()=>f.dataset.aspectRatio||"default",set(l){l||(l="default");const u=["default","4:3","16:9"];if(n.errorHandle(u.includes(l),`'aspectRatio' only accept ${u.toString()} as parameters`),l==="default")n.setStyle(o,"width",null),n.setStyle(o,"height",null),n.setStyle(o,"padding",null),delete f.dataset.aspectRatio;else{const m=l.split(":").map(Number),{videoWidth:y,videoHeight:b}=o,{clientWidth:_,clientHeight:g}=f,c=y/b,v=m[0]/m[1];if(c>v){const E=v*b/y;n.setStyle(o,"width",100*E+"%"),n.setStyle(o,"height","100%"),n.setStyle(o,"padding",`0 ${(_-_*E)/2}px`)}else{const E=y/v/b;n.setStyle(o,"width","100%"),n.setStyle(o,"height",100*E+"%"),n.setStyle(o,"padding",(g-g*E)/2+"px 0")}f.dataset.aspectRatio=l}p.show=`${h.get("Aspect Ratio")}: ${l==="default"?h.get("Default"):l}`,a.emit("aspectRatio",l)}}),n.def(a,"aspectRatioReset",{set(l){if(l){const{aspectRatio:u}=a;a.aspectRatio=u}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,notice:f,template:{$video:h}}=a,p=document.createElement("canvas");n.def(a,"getDataURL",{value:()=>new Promise((l,u)=>{try{p.width=h.videoWidth,p.height=h.videoHeight,p.getContext("2d").drawImage(h,0,0),l(p.toDataURL("image/png"))}catch(m){f.show=m,u(m)}})}),n.def(a,"getBlobUrl",{value:()=>new Promise((l,u)=>{try{p.width=h.videoWidth,p.height=h.videoHeight,p.getContext("2d").drawImage(h,0,0),p.toBlob(m=>{l(URL.createObjectURL(m))})}catch(m){f.show=m,u(m)}})}),n.def(a,"screenshot",{value:()=>er(this,null,function*(){const l=yield a.getDataURL();return n.download(l,`${o.title||"artplayer"}_${n.secondToTime(h.currentTime)}.png`),a.emit("screenshot",l),l})})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../libs/screenfull"),o=n.interopDefault(a),f=r("../utils");t.default=function(h){const{i18n:p,notice:l,template:{$video:u,$player:m}}=h,y=o.default();h.once("video:loadedmetadata",()=>{var b;y.isEnabled?(b=h,y.on("change",()=>b.emit("fullscreen",y.isFullscreen)),f.def(b,"fullscreen",{get:()=>y.isFullscreen,set(_){return er(this,null,function*(){_?(b.normalSize="fullscreen",b.aspectRatioReset=!0,b.autoSize=!1,yield y.request(m),f.addClass(m,"art-fullscreen"),b.emit("resize"),b.emit("fullscreen",!0),l.show=""):(b.aspectRatioReset=!0,b.autoSize=b.option.autoSize,yield y.exit(),f.removeClass(m,"art-fullscreen"),b.emit("resize"),b.emit("fullscreen"),l.show="")})}})):document.fullscreenEnabled||u.webkitSupportsFullscreen?(_=>{f.def(_,"fullscreen",{get:()=>u.webkitDisplayingFullscreen,set(g){g?(_.normalSize="fullscreen",u.webkitEnterFullscreen(),_.emit("fullscreen",!0),l.show=""):(u.webkitExitFullscreen(),_.emit("fullscreen"),l.show="")}})})(h):f.def(h,"fullscreen",{get:()=>!1,set(){l.show=p.get("Fullscreen Not Supported")}}),f.def(h,"fullscreen",f.get(h,"fullscreen"))})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","../libs/screenfull":"aPwar"}],aPwar:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(){const n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{const h=n[0],p={};for(const l of n)if(l[1]in document){for(const[u,m]of l.entries())p[h[u]]=m;return p}return!1})(),o={change:a.fullscreenchange,error:a.fullscreenerror};let f={request:(h=document.documentElement,p)=>new Promise((l,u)=>{const m=()=>{f.off("change",m),l()};f.on("change",m);const y=h[a.requestFullscreen](p);y instanceof Promise&&y.then(m).catch(u)}),exit:()=>new Promise((h,p)=>{if(!f.isFullscreen)return void h();const l=()=>{f.off("change",l),h()};f.on("change",l);const u=document[a.exitFullscreen]();u instanceof Promise&&u.then(l).catch(p)}),toggle:(h,p)=>f.isFullscreen?f.exit():f.request(h,p),onchange(h){f.on("change",h)},onerror(h){f.on("error",h)},on(h,p){const l=o[h];l&&document.addEventListener(l,p,!1)},off(h,p){const l=o[h];l&&document.removeEventListener(l,p,!1)},raw:a};return Object.defineProperties(f,{isFullscreen:{get:()=>Boolean(document[a.fullscreenElement])},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[a.fullscreenEnabled])}}),a||(f={isEnabled:!1}),f}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o,template:{$player:f}}=a;n.def(a,"fullscreenWeb",{get:()=>n.hasClass(f,"art-fullscreen-web"),set(h){h?(a.normalSize="fullscreenWeb",n.addClass(f,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=!1,a.emit("resize"),a.emit("fullscreenWeb",!0),o.show=""):(n.removeClass(f,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=a.option.autoSize,a.emit("resize"),a.emit("fullscreenWeb"),o.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:f,template:{$video:h}}=a;document.pictureInPictureEnabled?function(p){const{template:{$video:l},events:{proxy:u},notice:m}=p;l.disablePictureInPicture=!1,n.def(p,"pip",{get:()=>document.pictureInPictureElement,set(y){y?(p.normalSize="pip",l.requestPictureInPicture().catch(b=>{throw m.show=b,b})):document.exitPictureInPicture().catch(b=>{throw m.show=b,b})}}),u(l,"enterpictureinpicture",()=>{p.emit("pip",!0)}),u(l,"leavepictureinpicture",()=>{p.emit("pip")})}(a):h.webkitSupportsPresentationMode?function(p){const{$video:l}=p.template;l.webkitSetPresentationMode("inline"),n.def(p,"pip",{get:()=>l.webkitPresentationMode==="picture-in-picture",set(u){u?(p.normalSize="pip",l.webkitSetPresentationMode("picture-in-picture"),p.emit("pip",!0)):(l.webkitSetPresentationMode("inline"),p.emit("pip"))}})}(a):n.def(a,"pip",{get:()=>!1,set(){f.show=o.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"loaded",{get:()=>a.loadedTime/o.duration}),n.def(a,"loadedTime",{get:()=>o.buffered.length?o.buffered.end(o.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"played",{get:()=>a.currentTime/a.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"playing",{get:()=>o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$container:o,$player:f,$video:h}=a.template;n.def(a,"autoSize",{get:()=>n.hasClass(o,"art-auto-size"),set(p){if(p){const{videoWidth:l,videoHeight:u}=h,{width:m,height:y}=o.getBoundingClientRect(),b=l/u,_=m/y;if(n.addClass(o,"art-auto-size"),_>b){const g=y*b/m*100;n.setStyle(f,"width",`${g}%`),n.setStyle(f,"height","100%")}else{const g=m/b/y*100;n.setStyle(f,"width","100%"),n.setStyle(f,"height",`${g}%`)}a.emit("autoSize",{width:a.width,height:a.height})}else n.removeClass(o,"art-auto-size"),n.setStyle(f,"width",null),n.setStyle(f,"height",null),a.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"rect",{get:()=>a.template.$player.getBoundingClientRect()});const o=["bottom","height","left","right","top","width"];for(let f=0;f<o.length;f++){const h=o[f];n.def(a,h,{get:()=>a.rect[h]})}n.def(a,"x",{get:()=>a.left+window.pageXOffset}),n.def(a,"y",{get:()=>a.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$player:o},i18n:f,notice:h}=a;n.def(a,"flip",{get:()=>o.dataset.flip||"normal",set(p){p||(p="normal");const l=["normal","horizontal","vertical"];n.errorHandle(l.includes(p),`'flip' only accept ${l.toString()} as parameters`),p==="normal"?delete o.dataset.flip:o.dataset.flip=p;const u=p.replace(p[0],p[0].toUpperCase());h.show=`${f.get("Video Flip")}: ${f.get(u)}`,a.emit("flip",p)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:f,storage:h,events:{proxy:p},template:{$player:l,$miniClose:u,$miniTitle:m,$miniHeader:y}}=a;let b="",_=!1,g=0,c=0,v=0,E=0;p(y,"mousedown",d=>{_=!0,g=d.pageX,c=d.pageY,v=a.left,E=a.top}),p(document,"mousemove",d=>{if(_){n.addClass(l,"art-is-dragging");const x=E+d.pageY-c,S=v+d.pageX-g;n.setStyle(l,"top",`${x}px`),n.setStyle(l,"left",`${S}px`),h.set("top",x),h.set("left",S)}}),p(document,"mouseup",()=>{_=!1,n.removeClass(l,"art-is-dragging")}),p(u,"click",()=>{a.mini=!1,_=!1,n.removeClass(l,"art-is-dragging")}),n.append(m,f.title||o.get("Mini Player")),n.def(a,"mini",{get:()=>n.hasClass(l,"art-mini"),set(d){if(d){a.normalSize="mini",a.autoSize=!1,b=l.style.cssText,n.addClass(l,"art-mini");const x=h.get("top"),S=h.get("left");if(x&&S)n.setStyle(l,"top",`${x}px`),n.setStyle(l,"left",`${S}px`),n.isInViewport(y)||(h.del("top"),h.del("left"),a.mini=!0);else{const T=window.innerHeight-a.height-50,w=window.innerWidth-a.width-50;h.set("top",T),h.set("left",w),n.setStyle(l,"top",`${T}px`),n.setStyle(l,"left",`${w}px`)}a.aspectRatio=!1,a.playbackRate=!1,a.notice.show="",a.emit("mini",!0)}else l.style.cssText=b,n.removeClass(l,"art-mini"),n.setStyle(l,"top",null),n.setStyle(l,"left",null),a.aspectRatio=!1,a.playbackRate=!1,a.autoSize=f.autoSize,a.notice.show="",a.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){let o=[];n.def(a,"loop",{get:()=>o,set:f=>{if(Array.isArray(f)&&typeof f[0]=="number"&&typeof f[1]=="number"){const h=n.clamp(f[0],0,Math.min(f[1],a.duration)),p=n.clamp(f[1],h,a.duration);p-h>=1?(o=[h,p],a.emit("loop",o)):(o=[],a.emit("loop"))}else o=[],a.emit("loop")}}),a.on("video:timeupdate",()=>{o.length&&(a.currentTime<o[0]||a.currentTime>o[1])&&(a.seek=o[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$poster:f}}=a;n.def(a,"poster",{get:()=>o.poster,set(h){o.poster=h,n.setStyle(f,"backgroundImage",`url(${h})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$container:f,$video:h}}=a,p=f.style.height;n.def(a,"autoHeight",{get:()=>n.hasClass(f,"art-auto-height"),set(l){if(l){const{clientWidth:u}=f,{videoHeight:m,videoWidth:y}=h,b=m*(u/y);n.setStyle(f,"height",b+"px"),n.addClass(f,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight",b)}else n.setStyle(f,"height",p),n.removeClass(f,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$player:f}}=a;n.def(a,"theme",{get:()=>getComputedStyle(f).getPropertyValue("--theme"),set(h){o.theme=h,f.style.setProperty("--theme",h)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"title",{get:()=>a.option.title,set(o){a.option.title=o}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{clamp:o}=a.constructor.utils,{notice:f,template:h,i18n:p}=a;let l=0,u=[];a.on("subtitle:switch",()=>{u=[]}),n.def(a,"subtitleOffset",{get:()=>l,set(m){if(h.$track&&h.$track.track){const y=Array.from(h.$track.track.cues);l=o(m,-5,5);for(let b=0;b<y.length;b++){const _=y[b];u[b]||(u[b]={startTime:_.startTime,endTime:_.endTime}),_.startTime=o(u[b].startTime+l,0,a.duration),_.endTime=o(u[b].endTime+l,0,a.duration)}a.subtitle.update(),f.show=`${p.get("Subtitle Offset")}: ${m}s`,a.emit("subtitleOffset",m)}else a.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,storage:f,template:{$video:h,$poster:p}}=a;Object.keys(o.moreVideoAttr).forEach(u=>{a.attr(u,o.moreVideoAttr[u])}),o.muted&&(a.muted=o.muted),o.volume&&(h.volume=n.clamp(o.volume,0,1));const l=f.get("volume");typeof l=="number"&&(h.volume=n.clamp(l,0,1)),o.poster&&n.setStyle(p,"backgroundImage",`url(${o.poster})`),o.autoplay&&(h.autoplay=o.autoplay),o.playsInline&&(h.playsInline=!0,h["webkit-playsinline"]=!0),o.theme&&(a.theme=o.theme),o.ads.length===0&&(a.url=o.url)}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../config"),o=n.interopDefault(a),f=r("../utils");t.default=function(h){const{i18n:p,notice:l,option:u,constructor:m,events:{proxy:y},template:{$player:b,$video:_,$poster:g}}=h;let c=0;for(let v=0;v<o.default.events.length;v++)y(_,o.default.events[v],E=>{h.emit(`video:${E.type}`,E)});h.on("video:canplay",()=>{c=0,h.loading.show=!1}),h.once("video:canplay",()=>{h.loading.show=!1,h.controls.show=!0,h.mask.show=!0,h.isReady=!0,h.emit("ready")}),h.on("video:ended",()=>{u.loop?(h.seek=0,h.play(),h.controls.show=!1,h.mask.show=!1):(h.controls.show=!0,h.mask.show=!0)}),h.on("video:error",()=>er(this,null,function*(){c<m.RECONNECT_TIME_MAX?(yield f.sleep(m.RECONNECT_SLEEP_TIME),c+=1,h.url=u.url,l.show=`${p.get("Reconnect")}: ${c}`,h.emit("error",c)):(h.mask.show=!0,h.loading.show=!1,h.controls.show=!0,f.addClass(b,"art-error"),yield f.sleep(m.RECONNECT_SLEEP_TIME),l.show=p.get("Video Load Failed"),h.destroy(!1))})),h.on("video:loadedmetadata",()=>{h.autoSize=u.autoSize,f.isMobile&&(h.loading.show=!1,h.controls.show=!0,h.mask.show=!0)}),h.on("video:loadstart",()=>{h.loading.show=!0,h.mask.show=!1,h.controls.show=!0}),h.on("video:pause",()=>{h.controls.show=!0,h.mask.show=!0}),h.on("video:play",()=>{h.mask.show=!1,f.setStyle(g,"display","none")}),h.on("video:playing",()=>{h.mask.show=!1}),h.on("video:seeked",()=>{h.loading.show=!1}),h.on("video:seeking",()=>{h.loading.show=!0,h.mask.show=!1}),h.on("video:timeupdate",()=>{h.mask.show=!1}),h.on("video:waiting",()=>{h.loading.show=!0,h.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const o=["mini","pip","fullscreen","fullscreenWeb"];n.def(a,"normalSize",{get:()=>o.every(f=>!a[f]),set(f){o.filter(h=>h!==f).forEach(h=>{a[h]&&(a[h]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),f=n.interopDefault(o),h=r("./fullscreen"),p=n.interopDefault(h),l=r("./fullscreenWeb"),u=n.interopDefault(l),m=r("./pip"),y=n.interopDefault(m),b=r("./playAndPause"),_=n.interopDefault(b),g=r("./progress"),c=n.interopDefault(g),v=r("./time"),E=n.interopDefault(v),d=r("./volume"),x=n.interopDefault(d),S=r("./setting"),T=n.interopDefault(S),w=r("./thumbnails"),L=n.interopDefault(w),I=r("./screenshot"),A=n.interopDefault(I),O=r("./quality"),D=n.interopDefault(O),R=r("./loop"),C=n.interopDefault(R);class P extends f.default{constructor(N){super(N),this.name="control";const{constructor:B,events:{proxy:U},template:{$player:F}}=N;let j=Date.now();U(F,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,a.removeClass(F,"art-hide-cursor"),a.addClass(F,"art-hover"),j=Date.now()}),N.on("video:timeupdate",()=>{!N.isInput&&N.playing&&this.show&&Date.now()-j>=B.CONTROL_HIDE_TIME&&(this.show=!1,a.addClass(F,"art-hide-cursor"),a.removeClass(F,"art-hover"))}),this.init()}init(){const{option:N}=this.art;this.add(c.default({name:"progress",disable:N.isLive,position:"top",index:10})),this.add(L.default({name:"thumbnails",disable:!N.thumbnails.url||N.isLive||a.isMobile,position:"top",index:20})),this.add(C.default({name:"loop",disable:!1,position:"top",index:30})),this.add(_.default({name:"playAndPause",disable:!1,position:"left",index:10})),this.add(x.default({name:"volume",disable:!1,position:"left",index:20})),this.add(E.default({name:"time",disable:N.isLive,position:"left",index:30})),this.add(D.default({name:"quality",disable:N.quality.length===0,position:"right",index:10})),this.add(A.default({name:"screenshot",disable:!N.screenshot||a.isMobile,position:"right",index:20})),this.add(T.default({name:"setting",disable:!N.setting,position:"right",index:30})),this.add(y.default({name:"pip",disable:!N.pip,position:"right",index:40})),this.add(u.default({name:"fullscreenWeb",disable:!N.fullscreenWeb,position:"right",index:50})),this.add(p.default({name:"fullscreen",disable:!N.fullscreen,position:"right",index:60}));for(let B=0;B<N.controls.length;B++)this.add(N.controls[B])}add(N){const B=typeof N=="function"?N(this.art):N,{$progress:U,$controlsLeft:F,$controlsRight:j}=this.art.template;switch(B.position){case"top":this.$parent=U;break;case"left":this.$parent=F;break;case"right":this.$parent=j;break;default:a.errorHandle(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(B)}}t.default=P},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom"),o=r("option-validator"),f=n.interopDefault(o),h=r("../scheme"),p=r("./property"),l=r("./error");t.default=class{constructor(u){this.id=0,this.art=u,this.add=this.add.bind(this)}get show(){return a.hasClass(this.art.template.$player,`art-${this.name}-show`)}set show(u){const{$player:m}=this.art.template,y=`art-${this.name}-show`;u?a.addClass(m,y):a.removeClass(m,y),this.art.emit(this.name,u)}set toggle(u){u&&(this.show=!this.show)}add(u){const m=typeof u=="function"?u(this.art):u;if(m.html=m.html||"",f.default(m,h.ComponentOption),!this.$parent||!this.name||m.disable)return;const y=m.name||`${this.name}${this.id}`;l.errorHandle(!p.has(this,y),`Cannot add an existing name [${y}] to the [${this.name}]`),this.id+=1;const b=document.createElement("div");a.addClass(b,`art-${this.name}`),a.addClass(b,`art-${this.name}-${y}`);const _=Array.from(this.$parent.children);b.dataset.index=m.index||this.id;const g=_.find(c=>Number(c.dataset.index)>=Number(b.dataset.index));return g?g.insertAdjacentElement("beforebegin",b):a.append(this.$parent,b),m.html&&a.append(b,m.html),m.style&&a.setStyles(b,m.style),m.tooltip&&a.tooltip(b,m.tooltip),m.click&&this.art.events.proxy(b,"click",c=>{c.preventDefault(),m.click.call(this.art,this,c)}),m.selector&&["left","right"].includes(m.position)&&this.selector(m,b),m.mounted&&m.mounted.call(this.art,b),b.childNodes.length===1&&b.childNodes[0].nodeType===3&&a.addClass(b,"art-control-onlyText"),p.def(this,y,{value:b}),b}selector(u,m){const{hover:y,proxy:b}=this.art.events;a.addClass(m,"art-control-selector");const _=document.createElement("div");a.addClass(_,"art-selector-value"),a.append(_,u.html),m.innerText="",a.append(m,_);const g=u.selector.map((E,d)=>`<div class="art-selector-item ${E.default?"art-current":""}" data-index="${d}">${E.html}</div>`).join(""),c=document.createElement("div");a.addClass(c,"art-selector-list"),a.append(c,g),a.append(m,c);const v=()=>{const E=a.getStyle(m,"width")/2-a.getStyle(c,"width")/2;c.style.left=`${E}px`};y(m,v),b(c,"click",E=>er(this,null,function*(){const d=(E.composedPath()||[]).find(T=>a.hasClass(T,"art-selector-item"));if(!d)return;a.inverseClass(d,"art-current");const x=Number(d.dataset.index),S=u.selector[x]||{};if(_.innerText=d.innerText,u.onSelect){const T=yield u.onSelect.call(this.art,S,d,E);typeof T!="string"&&typeof T!="number"||(_.innerHTML=T)}v(),this.art.emit("selector",S,d)}))}}},{"./dom":"ff6Hs","option-validator":"hqjoJ","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{tooltip:o.i18n.get("Fullscreen"),mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o,u=n.append(f,p.fullscreenOn),m=n.append(f,p.fullscreenOff);n.setStyle(m,"display","none"),h(f,"click",()=>{o.fullscreen=!o.fullscreen}),o.on("fullscreen",y=>{y?(n.tooltip(f,l.get("Exit Fullscreen")),n.setStyle(u,"display","none"),n.setStyle(m,"display","inline-flex")):(n.tooltip(f,l.get("Fullscreen")),n.setStyle(u,"display","inline-flex"),n.setStyle(m,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{tooltip:o.i18n.get("Web Fullscreen"),mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o,u=n.append(f,p.fullscreenWebOn),m=n.append(f,p.fullscreenWebOff);n.setStyle(m,"display","none"),h(f,"click",()=>{o.fullscreenWeb=!o.fullscreenWeb}),o.on("fullscreenWeb",y=>{y?(n.tooltip(f,l.get("Exit Web Fullscreen")),n.setStyle(u,"display","none"),n.setStyle(m,"display","inline-flex")):(n.tooltip(f,l.get("Web Fullscreen")),n.setStyle(u,"display","inline-flex"),n.setStyle(m,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{tooltip:o.i18n.get("PIP Mode"),mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o;n.append(f,p.pip),h(f,"click",()=>{o.pip=!o.pip}),o.on("pip",u=>{n.tooltip(f,l.get(u?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o,u=n.append(f,p.play),m=n.append(f,p.pause);function y(){n.setStyle(u,"display","flex"),n.setStyle(m,"display","none")}function b(){n.setStyle(u,"display","none"),n.setStyle(m,"display","flex")}n.tooltip(u,l.get("Play")),n.tooltip(m,l.get("Pause")),h(u,"click",()=>{o.play()}),h(m,"click",()=>{o.pause()}),o.playing?b():y(),o.on("video:playing",()=>{b()}),o.on("video:pause",()=>{y()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"getPosFromEvent",()=>o);var a=r("../utils");function o(f,h){const{$progress:p}=f.template,{left:l}=p.getBoundingClientRect(),u=h.pageX,m=a.clamp(u-l,0,p.clientWidth),y=m/p.clientWidth*f.duration;return{second:y,time:a.secondToTime(y),width:m,percentage:a.clamp(m/p.clientWidth,0,1)}}t.default=function(f){return h=>{const{icons:p,option:l,events:{proxy:u}}=h;return bt(mt({},f),{html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:m=>{let y=!1;const b=a.query(".art-progress-loaded",m),_=a.query(".art-progress-played",m),g=a.query(".art-progress-highlight",m),c=a.query(".art-progress-indicator",m),v=a.query(".art-progress-tip",m);a.setStyle(_,"backgroundColor","var(--theme)");let E=h.constructor.INDICATOR_SIZE;function d(x,S){x==="loaded"&&a.setStyle(b,"width",100*S+"%"),x==="played"&&(a.setStyle(_,"width",100*S+"%"),a.setStyle(c,"left",`calc(${100*S}% - ${E/2}px)`))}p.indicator?(E=h.constructor.INDICATOR_SIZE_ICON,a.append(c,p.indicator)):a.setStyles(c,{backgroundColor:"var(--theme)"}),a.isMobile&&(E=h.constructor.INDICATOR_SIZE_MOBILE,p.indicator&&(E=h.constructor.INDICATOR_SIZE_MOBILE_ICON)),a.setStyles(c,{left:`-${E/2}px`,width:`${E}px`,height:`${E}px`}),h.on("video:loadedmetadata",()=>{for(let x=0;x<l.highlight.length;x++){const S=l.highlight[x],T=a.clamp(S.time,0,h.duration)/h.duration*100;a.append(g,`<span data-text="${S.text}" data-time="${S.time}" style="left: ${T}%"></span>`)}}),d("loaded",h.loaded),h.on("setBar",(x,S)=>{d(x,S)}),h.on("video:progress",()=>{d("loaded",h.loaded)}),h.on("video:timeupdate",()=>{d("played",h.played)}),h.on("video:ended",()=>{d("played",1)}),a.isMobile||(u(m,"click",x=>{if(x.target!==c){const{second:S,percentage:T}=o(h,x);d("played",T),h.seek=S}}),u(m,"mousemove",x=>{a.setStyle(v,"display","block"),a.includeFromEvent(x,g)?function(S){const{width:T}=o(h,S),{text:w}=S.target.dataset;v.innerHTML=w;const L=v.clientWidth;T<=L/2?a.setStyle(v,"left",0):T>m.clientWidth-L/2?a.setStyle(v,"left",m.clientWidth-L+"px"):a.setStyle(v,"left",T-L/2+"px")}(x):function(S){const{width:T,time:w}=o(h,S);v.innerHTML=w;const L=v.clientWidth;T<=L/2?a.setStyle(v,"left",0):T>m.clientWidth-L/2?a.setStyle(v,"left",m.clientWidth-L+"px"):a.setStyle(v,"left",T-L/2+"px")}(x)}),u(m,"mouseout",()=>{a.setStyle(v,"display","none")}),u(c,"mousedown",()=>{y=!0}),u(document,"mousemove",x=>{if(y){const{second:S,percentage:T}=o(h,x);d("played",T),h.seek=S}}),u(document,"mouseup",()=>{y&&(y=!1)}))}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{style:{cursor:"auto"},mounted:f=>{function h(){const l=`${n.secondToTime(o.currentTime)} / ${n.secondToTime(o.duration)}`;l!==f.innerText&&(f.innerText=l)}h();const p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let l=0;l<p.length;l++)o.on(p[l],h)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o;let u=!1;const m=o.constructor.VOLUME_PANEL_WIDTH,y=o.constructor.VOLUME_HANDLE_WIDTH,b=n.append(f,p.volume),_=n.append(f,p.volumeClose),g=n.append(f,'<div class="art-volume-panel"></div>'),c=n.append(g,'<div class="art-volume-slider-handle"></div>');function v(d){const{left:x}=g.getBoundingClientRect();return n.clamp(d.pageX-x-y/2,0,m-y/2)/(m-y)}function E(d=.7){if(o.muted||d===0)n.setStyle(b,"display","none"),n.setStyle(_,"display","flex"),n.setStyle(c,"left","0");else{const x=(m-y)*d;n.setStyle(b,"display","flex"),n.setStyle(_,"display","none"),n.setStyle(c,"left",`${x}px`)}}n.tooltip(b,l.get("Mute")),n.setStyle(_,"display","none"),n.isMobile&&n.setStyle(g,"display","none"),E(o.volume),o.on("video:volumechange",()=>{E(o.volume)}),h(b,"click",()=>{o.muted=!0}),h(_,"click",()=>{o.muted=!1}),h(g,"click",d=>{o.muted=!1,o.volume=v(d)}),h(c,"mousedown",()=>{u=!0}),h(f,"mousemove",d=>{u&&(o.muted=!1,o.volume=v(d))}),h(document,"mouseup",()=>{u&&(u=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{tooltip:o.i18n.get("Show Setting"),mounted:f=>{const{events:{proxy:h},icons:p,i18n:l}=o;n.append(f,p.setting),h(f,"click",()=>{o.setting.toggle=!0}),o.on("setting",u=>{n.tooltip(f,l.get(u?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils"),a=r("./progress");t.default=function(o){return f=>bt(mt({},o),{mounted:h=>{const{option:p,template:{$progress:l,$video:u},events:{proxy:m,loadImg:y}}=f;let b=null,_=!1,g=!1;m(l,"mousemove",c=>er(this,null,function*(){_||(_=!0,b=yield y(p.thumbnails.url),g=!0),g&&(n.setStyle(h,"display","block"),function(v){const{width:E}=a.getPosFromEvent(f,v),{url:d,number:x,column:S}=p.thumbnails,T=b.naturalWidth/S,w=T/(u.videoWidth/u.videoHeight),L=l.clientWidth/x,I=Math.floor(E/L),A=Math.ceil(I/S)-1,O=I%S||S-1;n.setStyle(h,"backgroundImage",`url(${d})`),n.setStyle(h,"height",`${w}px`),n.setStyle(h,"width",`${T}px`),n.setStyle(h,"backgroundPosition",`-${O*T}px -${A*w}px`),E<=T/2?n.setStyle(h,"left",0):E>l.clientWidth-T/2?n.setStyle(h,"left",l.clientWidth-T+"px"):n.setStyle(h,"left",E-T/2+"px")}(c))})),m(l,"mouseout",()=>{n.setStyle(h,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{tooltip:o.i18n.get("Screenshot"),mounted:f=>{const{events:{proxy:h},icons:p}=o;n.append(f,p.screenshot),h(f,"click",()=>{o.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>{const o=a.option.quality,f=o.find(h=>h.default)||o[0];return bt(mt({},n),{html:f?f.html:"",selector:o,onSelect(h){a.switchQuality(h.url,h.html)}})}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>bt(mt({},a),{mounted:f=>{const h=n.append(f,'<span class="art-loop-point"></span>'),p=n.append(f,'<span class="art-loop-point"></span>');o.on("loop",l=>{l?(n.setStyle(f,"display","block"),n.setStyle(h,"left",`calc(${l[0]/o.duration*100}% - ${h.clientWidth}px)`),n.setStyle(p,"left",l[1]/o.duration*100+"%")):n.setStyle(f,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),f=n.interopDefault(o),h=r("./playbackRate"),p=n.interopDefault(h),l=r("./aspectRatio"),u=n.interopDefault(l),m=r("./flip"),y=n.interopDefault(m),b=r("./info"),_=n.interopDefault(b),g=r("./version"),c=n.interopDefault(g),v=r("./close"),E=n.interopDefault(v);class d extends f.default{constructor(S){super(S),this.name="contextmenu",this.$parent=S.template.$contextmenu,a.isMobile||this.init()}init(){const{option:S,template:{$player:T,$contextmenu:w},events:{proxy:L}}=this.art;this.add(p.default({disable:!S.playbackRate,name:"playbackRate",index:10})),this.add(u.default({disable:!S.aspectRatio,name:"aspectRatio",index:20})),this.add(y.default({disable:!S.flip,name:"flip",index:30})),this.add(_.default({disable:!1,name:"info",index:40})),this.add(c.default({disable:!1,name:"version",index:50})),this.add(E.default({disable:!1,name:"close",index:60}));for(let I=0;I<S.contextmenu.length;I++)this.add(S.contextmenu[I]);L(T,"contextmenu",I=>{I.preventDefault(),this.show=!0;const A=I.clientX,O=I.clientY,{height:D,width:R,left:C,top:P}=T.getBoundingClientRect(),{height:M,width:N}=w.getBoundingClientRect();let B=A-C,U=O-P;A+N>C+R&&(B=R-N),O+M>P+D&&(U=D-M),a.setStyles(w,{top:`${U}px`,left:`${B}px`})}),L(T,"click",I=>{a.includeFromEvent(I,w)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}t.default=d},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:f}=o;return bt(mt({},a),{html:`${f.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${f.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(h,p)=>{const{value:l}=p.target.dataset;l&&(o.playbackRate=Number(l),h.show=!1)},mounted:h=>{o.on("playbackRate",p=>{const l=n.queryAll("span",h).find(u=>Number(u.dataset.value)===p);l&&n.inverseClass(l,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:f}=o;return bt(mt({},a),{html:`${f.get("Aspect Ratio")}:<span data-value="default" class="art-current">${f.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(h,p)=>{const{value:l}=p.target.dataset;l&&(o.aspectRatio=l,h.show=!1)},mounted:h=>{o.on("aspectRatio",p=>{const l=n.queryAll("span",h).find(u=>u.dataset.value===p);l&&n.inverseClass(l,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:f}=o;return bt(mt({},a),{html:`${f.get("Video Flip")}:<span data-value="normal" class="art-current">${f.get("Normal")}</span><span data-value="horizontal">${f.get("Horizontal")}</span><span data-value="vertical">${f.get("Vertical")}</span>`,click:(h,p)=>{const{value:l}=p.target.dataset;l&&(o.flip=l,h.show=!1)},mounted:h=>{o.on("flip",p=>{const l=n.queryAll("span",h).find(u=>u.dataset.value===p);l&&n.inverseClass(l,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>bt(mt({},n),{html:a.i18n.get("Video Info"),click:o=>{a.info.show=!0,o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return bt(mt({},n),{html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.4.3</a>'})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>bt(mt({},n),{html:a.i18n.get("Close"),click:o=>{o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),f=n.interopDefault(o);class h extends f.default{constructor(l){super(l),this.name="info",a.isMobile||this.init()}init(){const{constructor:l,events:{proxy:u},template:{$infoPanel:m,$infoClose:y,$video:b}}=this.art;u(y,"click",()=>{this.show=!1});let _=null;const g=a.queryAll("[data-video]",m)||[];this.art.on("destroy",()=>{clearTimeout(_)}),function c(){for(let v=0;v<g.length;v++){const E=g[v],d=b[E.dataset.video],x=typeof d=="number"?d.toFixed(2):d;E.innerText!==x&&(E.innerText=x)}_=setTimeout(c,l.INFO_LOOP_TIME)}()}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),f=n.interopDefault(o),h=r("option-validator"),p=n.interopDefault(h),l=r("./scheme"),u=n.interopDefault(l);class m extends f.default{constructor(b){super(b),this.name="subtitle",this.init(b.option.subtitle)}get url(){return this.art.template.$track.src}set url(b){this.switch(b)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(b,_){const{$subtitle:g}=this.art.template;return typeof b=="object"?a.setStyles(g,b):a.setStyle(g,b,_)}update(){const{$subtitle:b}=this.art.template;b.innerHTML="",this.activeCue&&(b.innerHTML=this.activeCue.text.split(/\r?\n/).map(_=>`<p>${a.escape(_)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}switch(g){return er(this,arguments,function*(b,_={}){const{i18n:c,notice:v,option:E}=this.art,d=bt(mt(mt({},E.subtitle),_),{url:b}),x=yield this.init(d);return _.name&&(v.show=`${c.get("Switch Subtitle")}: ${_.name}`),x})}init(b){if(p.default(b,u.default.subtitle),!b.url)return;const{notice:_,events:{proxy:g},template:{$subtitle:c,$video:v,$track:E}}=this.art;if(!E){const d=document.createElement("track");d.default=!0,d.kind="metadata",v.appendChild(d),this.art.template.$track=d,g(this.textTrack,"cuechange",this.update.bind(this))}return this.style(b.style),a.errorHandle(window.fetch,"fetch not support"),fetch(b.url).then(d=>d.arrayBuffer()).then(d=>{a.errorHandle(window.TextDecoder,"TextDecoder not support");const x=new TextDecoder(b.encoding).decode(d);switch(this.art.emit("subtitleLoad",b.url),b.type||a.getExt(b.url)){case"srt":return a.vttToBlob(a.srtToVtt(x));case"ass":return a.vttToBlob(a.assToVtt(x));case"vtt":return a.vttToBlob(x);default:return b.url}}).then(d=>(c.innerHTML="",this.url===d||(URL.revokeObjectURL(this.url),this.art.template.$track.src=d,this.art.emit("subtitleSwitch",d)),d)).catch(d=>{throw _.show=d,d})}}t.default=m},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"hqjoJ","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils/error"),o=r("./clickInit"),f=n.interopDefault(o),h=r("./hoverInit"),p=n.interopDefault(h),l=r("./mousemoveInit"),u=n.interopDefault(l),m=r("./resizeInit"),y=n.interopDefault(m),b=r("./gestureInit"),_=n.interopDefault(b),g=r("./viewInit"),c=n.interopDefault(g);t.default=class{constructor(v){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),v.whitelist.state&&(f.default(v,this),p.default(v,this),u.default(v,this),y.default(v,this),_.default(v,this),c.default(v,this))}proxy(v,E,d,x={}){if(Array.isArray(E))return E.map(T=>this.proxy(v,T,d,x));v.addEventListener(E,d,x);const S=()=>v.removeEventListener(E,d,x);return this.destroyEvents.push(S),S}hover(v,E,d){E&&this.proxy(v,"mouseenter",E),d&&this.proxy(v,"mouseleave",d)}loadImg(v){return new Promise((E,d)=>{let x;if(v instanceof HTMLImageElement)x=v;else{if(typeof v!="string")return d(new a.ArtPlayerError("Unable to get Image"));x=new Image,x.src=v}if(x.complete)return E(x);this.proxy(x,"load",()=>E(x)),this.proxy(x,"error",()=>d(new a.ArtPlayerError(`Failed to load Image: ${x.src}`)))})}destroy(){for(let v=0;v<this.destroyEvents.length;v++)this.destroyEvents[v]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{constructor:f,template:{$player:h,$video:p}}=a;o.proxy(document,["click","contextmenu"],u=>{n.includeFromEvent(u,h)?(a.isInput=u.target.tagName==="INPUT",a.isFocus=!0,a.emit("focus")):(a.isInput=!1,a.isFocus=!1,a.emit("blur"))});let l=0;o.proxy(p,"click",()=>{const u=Date.now();u-l<=f.DB_CLICE_TIME?(a.emit("dblclick"),n.isMobile?a.isLock||a.toggle():a.fullscreen=!a.fullscreen):(a.emit("click"),n.isMobile||a.toggle()),l=u})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{$player:f}=a.template;o.hover(f,()=>{n.addClass(f,"art-hover"),a.emit("hover",!0)},()=>{n.removeClass(f,"art-hover"),a.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n,a){const{$player:o}=n.template;a.proxy(o,"mousemove",f=>{n.emit("mousemove",f)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{option:f}=a,h=n.throttle(()=>{a.normalSize&&(a.autoSize=f.autoSize),a.aspectRatioReset=!0,a.notice.show="",a.emit("resize")},a.constructor.RESIZE_TIME);o.proxy(window,["orientationchange","resize"],()=>{h()}),screen&&screen.orientation&&screen.orientation.onchange&&o.proxy(screen.orientation,"change",()=>{h()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){if(n.isMobile&&!a.option.isLive){const{$video:f,$bottom:h,$controls:p}=a.template;let l=!1,u=0,m=0,y=0;const b=c=>{if(c.touches.length===1&&!a.isLock){l=!0;const{clientX:v,clientY:E}=c.touches[0];u=v,m=E,y=a.currentTime}},_=c=>{if(c.touches.length===1&&l&&a.duration){const v=a.plugins.autoOrientation&&a.plugins.autoOrientation.state,{clientX:E,clientY:d}=c.touches[0],x=n.clamp((E-u)/a.width,-1,1),S=n.clamp((d-m)/a.height,-1,1),T=v?S:x,w=n.clamp(y+a.duration*T/2,0,a.duration);a.seek=w,a.emit("setBar","played",n.clamp(w/a.duration,0,1)),a.notice.show=`${n.secondToTime(w)} / ${n.secondToTime(a.duration)}`}},g=()=>{l&&(u=0,m=0,y=0,l=!1)};o.proxy(h,"touchstart",c=>{n.includeFromEvent(c,p)||b(c)}),o.proxy(h,"touchmove",_),o.proxy(f,"touchstart",b),o.proxy(f,"touchmove",_),o.proxy(document,"touchend",g)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{option:f,constructor:h,template:{$container:p}}=a,l=n.throttle(()=>{a.emit("view",n.isInViewport(p,h.SCROLL_GAP))},h.SCROLL_TIME);o.proxy(window,"scroll",()=>{l()}),a.on("view",u=>{f.autoMini&&(a.mini=!u)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.keys={},a.option.hotkey&&!n.isMobile&&this.init()}init(){const{proxy:a}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),a(window,"keydown",o=>{if(this.art.isFocus){const f=document.activeElement.tagName.toUpperCase(),h=document.activeElement.getAttribute("contenteditable");if(f!=="INPUT"&&f!=="TEXTAREA"&&h!==""&&h!=="true"){const p=this.keys[o.keyCode];if(p){o.preventDefault();for(let l=0;l<p.length;l++)p[l].call(this.art,o);this.art.emit("hotkey",o)}}}})}add(a,o){return this.keys[a]?this.keys[a].push(o):this.keys[a]=[o],this}remove(a,o){if(this.keys[a]){const f=this.keys[a].indexOf(o);f!==-1&&this.keys[a].splice(f,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils/component"),o=n.interopDefault(a);class f extends o.default{constructor(p){super(p);const{option:l,template:{$layer:u}}=p;this.name="layer",this.$parent=u;for(let m=0;m<l.layers.length;m++)this.add(l.layers[m])}}t.default=f},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),f=n.interopDefault(o);class h extends f.default{constructor(l){super(l),this.name="loading",a.append(l.template.$loading,l.icons.loading)}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.timer=null}set show(a){const{constructor:o,template:{$player:f,$noticeInner:h}}=this.art;a?(h.innerText=a instanceof Error?a.message.trim():a,n.addClass(f,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{h.innerText="",n.removeClass(f,"art-notice-show")},o.NOTICE_TIME)):n.removeClass(f,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),f=n.interopDefault(o);class h extends f.default{constructor(l){super(l),this.name="mask";const{template:u,icons:m,events:y}=l,b=a.append(u.$state,m.state),_=a.append(u.$state,m.error);a.setStyle(_,"display","none"),l.on("destroy",()=>{a.setStyle(b,"display","none"),a.setStyle(_,"display",null)}),y.proxy(u.$state,"click",()=>l.play())}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("bundle-text:./loading.svg"),f=n.interopDefault(o),h=r("bundle-text:./state.svg"),p=n.interopDefault(h),l=r("bundle-text:./check.svg"),u=n.interopDefault(l),m=r("bundle-text:./play.svg"),y=n.interopDefault(m),b=r("bundle-text:./pause.svg"),_=n.interopDefault(b),g=r("bundle-text:./volume.svg"),c=n.interopDefault(g),v=r("bundle-text:./volume-close.svg"),E=n.interopDefault(v),d=r("bundle-text:./screenshot.svg"),x=n.interopDefault(d),S=r("bundle-text:./setting.svg"),T=n.interopDefault(S),w=r("bundle-text:./arrow-left.svg"),L=n.interopDefault(w),I=r("bundle-text:./arrow-right.svg"),A=n.interopDefault(I),O=r("bundle-text:./playback-rate.svg"),D=n.interopDefault(O),R=r("bundle-text:./aspect-ratio.svg"),C=n.interopDefault(R),P=r("bundle-text:./config.svg"),M=n.interopDefault(P),N=r("bundle-text:./pip.svg"),B=n.interopDefault(N),U=r("bundle-text:./lock.svg"),F=n.interopDefault(U),j=r("bundle-text:./unlock.svg"),$=n.interopDefault(j),G=r("bundle-text:./fullscreen-off.svg"),Y=n.interopDefault(G),X=r("bundle-text:./fullscreen-on.svg"),ie=n.interopDefault(X),pe=r("bundle-text:./fullscreen-web-off.svg"),ue=n.interopDefault(pe),we=r("bundle-text:./fullscreen-web-on.svg"),de=n.interopDefault(we),oe=r("bundle-text:./switch-on.svg"),De=n.interopDefault(oe),Ce=r("bundle-text:./switch-off.svg"),Ue=n.interopDefault(Ce),Me=r("bundle-text:./flip.svg"),ze=n.interopDefault(Me),Ge=r("bundle-text:./error.svg"),Ke=n.interopDefault(Ge);t.default=class{constructor(He){const Fe=mt({loading:f.default,state:p.default,play:y.default,pause:_.default,check:u.default,volume:c.default,volumeClose:E.default,screenshot:x.default,setting:T.default,pip:B.default,arrowLeft:L.default,arrowRight:A.default,playbackRate:D.default,aspectRatio:C.default,config:M.default,lock:F.default,flip:ze.default,unlock:$.default,fullscreenOff:Y.default,fullscreenOn:ie.default,fullscreenWebOff:ue.default,fullscreenWebOn:de.default,switchOn:De.default,switchOff:Ue.default,error:Ke.default},He.option.icons);Object.keys(Fe).forEach(Se=>{a.def(this,Se,{get:()=>{const Xe=document.createElement("i");return a.addClass(Xe,"art-icon"),a.addClass(Xe,`art-icon-${Se}`),a.append(Xe,Fe[Se]),Xe}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ"}],hX0lQ:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(r,i,t){i.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(r,i,t){i.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],d5XKP:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./flip"),o=n.interopDefault(a),f=r("./aspectRatio"),h=n.interopDefault(f),p=r("./playbackRate"),l=n.interopDefault(p),u=r("./subtitleOffset"),m=n.interopDefault(u),y=r("../utils/component"),b=n.interopDefault(y),_=r("../utils");function g(E,d,x){for(let S=0;S<E.length;S++){const T=E[S];T.$parentItem=d,T.$parentList=x,T.selector&&g(T.selector,T,E)}return E}function c(E){return["string","number"].includes(typeof E)}class v extends b.default{constructor(d){super(d);const{option:x,events:{proxy:S},template:{$setting:T,$player:w}}=d;if(this.name="setting",this.$parent=T,this.option=[],this.events=[],this.cache=new Map,x.setting){x.playbackRate&&this.option.push(l.default(d)),x.aspectRatio&&this.option.push(h.default(d)),x.flip&&this.option.push(o.default(d)),x.subtitleOffset&&this.option.push(m.default(d));for(let L=0;L<x.settings.length;L++)this.option.push(x.settings[L]);this.option=g(this.option),this.init(this.option),d.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),S(w,"click",L=>{!this.show||_.includeFromEvent(L,d.controls.setting)||_.includeFromEvent(L,this.$parent)||(this.show=!1,this.init(this.option))})}}add(d){typeof d=="function"?this.option.push(d(this.art)):this.option.push(d),this.cache=new Map,this.events.forEach(x=>x()),this.events=[],this.$parent.innerHTML="",this.option=g(this.option),this.init(this.option)}creatHeader(d){const{icons:x,events:{proxy:S}}=this.art,T=document.createElement("div");_.addClass(T,"art-setting-item"),_.addClass(T,"art-setting-item-back");const w=_.append(T,'<div class="art-setting-item-left"></div>'),L=document.createElement("div");_.addClass(L,"art-setting-item-left-icon"),_.append(L,x.arrowLeft),_.append(w,L),_.append(w,d.$parentItem.html);const I=S(T,"click",()=>{this.init(d.$parentList)});return this.events.push(I),T}creatItem(d,x){const{icons:S,events:{proxy:T}}=this.art,w=document.createElement("div");_.addClass(w,"art-setting-item"),c(x.name)&&(w.dataset.name=x.name),c(x.value)&&(w.dataset.value=x.value);const L=_.append(w,'<div class="art-setting-item-left"></div>'),I=_.append(w,'<div class="art-setting-item-right"></div>'),A=document.createElement("div");switch(_.addClass(A,"art-setting-item-left-icon"),d){case"switch":case"range":_.append(A,c(x.icon)||x.icon instanceof Element?x.icon:S.config);break;case"selector":x.selector&&x.selector.length?_.append(A,c(x.icon)||x.icon instanceof Element?x.icon:S.config):_.append(A,S.check)}_.append(L,A),x.$icon=A,_.def(x,"icon",{configurable:!0,get:()=>A.innerHTML,set(R){c(R)&&(A.innerHTML=R)}});const O=document.createElement("div");_.addClass(O,"art-setting-item-left-text"),_.append(O,x.html||""),_.append(L,O),x.$html=O,_.def(x,"html",{configurable:!0,get:()=>O.innerHTML,set(R){c(R)&&(O.innerHTML=R)}});const D=document.createElement("div");switch(_.addClass(D,"art-setting-item-right-tooltip"),_.append(D,x.tooltip||""),_.append(I,D),x.$tooltip=D,_.def(x,"tooltip",{configurable:!0,get:()=>D.innerHTML,set(R){c(R)&&(D.innerHTML=R)}}),d){case"switch":{const R=document.createElement("div");_.addClass(R,"art-setting-item-right-icon");const C=_.append(R,S.switchOn),P=_.append(R,S.switchOff);_.setStyle(x.switch?P:C,"display","none"),_.append(I,R),x.$switch=x.switch,_.def(x,"switch",{configurable:!0,get:()=>x.$switch,set(M){x.$switch=M,M?(_.setStyle(P,"display","none"),_.setStyle(C,"display",null)):(_.setStyle(P,"display",null),_.setStyle(C,"display","none"))}});break}case"range":{const R=document.createElement("div");_.addClass(R,"art-setting-item-right-icon");const C=_.append(R,'<input type="range">');C.value=x.range[0]||0,C.min=x.range[1]||0,C.max=x.range[2]||10,C.step=x.range[3]||1,_.addClass(C,"art-setting-range"),_.append(I,R),x.$range=C,_.def(x,"range",{configurable:!0,get:()=>C.valueAsNumber,set(P){C.value=Number(P)}})}break;case"selector":if(x.selector&&x.selector.length){const R=document.createElement("div");_.addClass(R,"art-setting-item-right-icon"),_.append(R,S.arrowRight),_.append(I,R)}}switch(d){case"switch":if(x.onSwitch){const R=T(w,"click",C=>er(this,null,function*(){x.switch=yield x.onSwitch.call(this.art,x,w,C)}));this.events.push(R)}break;case"range":if(x.onRange&&x.$range){const R=T(x.$range,"change",C=>er(this,null,function*(){x.tooltip=yield x.onRange.call(this.art,x,w,C)}));this.events.push(R)}break;case"selector":{const R=T(w,"click",C=>er(this,null,function*(){if(x.selector&&x.selector.length)this.init(x.selector,x.width);else if(_.inverseClass(w,"art-current"),x.$parentList&&this.init(x.$parentList),x.$parentItem&&x.$parentItem.onSelect){const P=yield x.$parentItem.onSelect.call(this.art,x,w,C);x.$parentItem.$tooltip&&c(P)&&(x.$parentItem.$tooltip.innerHTML=P)}}));this.events.push(R),x.default&&_.addClass(w,"art-current")}}return w}init(d,x){const{constructor:S}=this.art;if(this.cache.has(d)){const T=this.cache.get(d);_.inverseClass(T,"art-current"),_.setStyle(this.$parent,"width",`${T.dataset.width}px`),_.setStyle(this.$parent,"height",`${T.dataset.height}px`)}else{const T=document.createElement("div");_.addClass(T,"art-setting-panel"),T.dataset.width=x||S.SETTING_WIDTH,T.dataset.height=d.length*S.SETTING_ITEM_HEIGHT,d[0]&&d[0].$parentItem&&(_.append(T,this.creatHeader(d[0])),T.dataset.height=Number(T.dataset.height)+S.SETTING_ITEM_HEIGHT);for(let w=0;w<d.length;w++){const L=d[w];_.has(L,"switch")?_.append(T,this.creatItem("switch",L)):_.has(L,"range")?_.append(T,this.creatItem("range",L)):_.append(T,this.creatItem("selector",L))}_.append(this.$parent,T),this.cache.set(d,T),_.inverseClass(T,"art-current"),_.setStyle(this.$parent,"width",`${T.dataset.width}px`),_.setStyle(this.$parent,"height",`${T.dataset.height}px`),d[0]&&d[0].$parentItem&&d[0].$parentItem.mounted&&d[0].$parentItem.mounted.call(this.art,T,d[0].$parentItem)}}}t.default=v},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:f,constructor:h}=a,p={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function l(u,m,y){m&&(m.innerText=o.get(p[y]));const b=n.queryAll(".art-setting-item",u).find(_=>_.dataset.value===y);b&&n.inverseClass(b,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Video Flip"),tooltip:o.get(p[a.flip]),icon:f.flip,selector:Object.keys(p).map(u=>({value:u,default:u===a.flip,html:o.get(p[u])})),onSelect(u){a.flip=u.value},mounted:(u,m)=>{l(u,m.$tooltip,a.flip),a.on("flip",()=>{l(u,m.$tooltip,a.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:f,constructor:h}=a;function p(u){return u==="default"?o.get("Default"):u}function l(u,m,y){m&&(m.innerText=p(y));const b=n.queryAll(".art-setting-item",u).find(_=>_.dataset.value===y);b&&n.inverseClass(b,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Aspect Ratio"),icon:f.aspectRatio,tooltip:p(a.aspectRatio),selector:["default","4:3","16:9"].map(u=>({value:u,default:u===a.aspectRatio,html:p(u)})),onSelect(u){a.aspectRatio=u.value},mounted:(u,m)=>{l(u,m.$tooltip,a.aspectRatio),a.on("aspectRatio",()=>{l(u,m.$tooltip,a.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:f,constructor:h}=a;function p(u){return u===1?o.get("Normal"):u}function l(u,m,y){m&&(m.innerText=p(y));const b=n.queryAll(".art-setting-item",u).find(_=>Number(_.dataset.value)===y);b&&n.inverseClass(b,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Play Speed"),tooltip:p(a.playbackRate),icon:f.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(u=>({value:u,default:u===a.playbackRate,html:p(u)})),onSelect(u){a.playbackRate=u.value},mounted:(u,m)=>{l(u,m.$tooltip,a.playbackRate),a.on("playbackRate",()=>{l(u,m.$tooltip,a.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:f,constructor:h}=a;function p(u){return u===0?o.get("Normal"):u}function l(u,m,y){m&&(m.innerText=p(y));const b=n.queryAll(".art-setting-item",u).find(_=>Number(_.dataset.value)===y);b&&n.inverseClass(b,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Subtitle Offset"),tooltip:p(a.subtitleOffset),icon:f.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(u=>({value:u,default:u===a.subtitleOffset,html:p(u)})),onSelect(u){a.subtitleOffset=u.value},mounted:(u,m)=>{l(u,m.$tooltip,a.subtitleOffset),a.on("subtitleOffset",()=>{l(u,m.$tooltip,a.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(n){try{const a=JSON.parse(window.localStorage.getItem(this.name))||{};return n?a[n]:a}catch(a){return n?this.settings[n]:this.settings}}set(n,a){try{const o=Object.assign({},this.get(),{[n]:a});window.localStorage.setItem(this.name,JSON.stringify(o))}catch(o){this.settings[n]=a}}del(n){try{const a=this.get();delete a[n],window.localStorage.setItem(this.name,JSON.stringify(a))}catch(a){delete this.settings[n]}}clear(){try{window.localStorage.removeItem(this.name)}catch(n){this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./miniProgressBar"),f=n.interopDefault(o),h=r("./autoOrientation"),p=n.interopDefault(h),l=r("./autoPlayback"),u=n.interopDefault(l),m=r("./fastForward"),y=n.interopDefault(m),b=r("./lock"),_=n.interopDefault(b);t.default=class{constructor(g){this.art=g,this.id=0;const{option:c}=g;c.miniProgressBar&&!c.isLive&&this.add(f.default),c.lock&&a.isMobile&&this.add(_.default),c.autoPlayback&&this.add(u.default),c.autoOrientation&&a.isMobile&&this.add(p.default),c.fastForward&&a.isMobile&&!c.isLive&&this.add(y.default);for(let v=0;v<c.plugins.length;v++)this.add(c.plugins[v])}add(g){this.id+=1;const c=g.call(this,this.art),v=c&&c.name||g.name||`plugin${this.id}`;return a.errorHandle(!a.has(this,v),`Cannot add a plugin that already has the same name: ${v}`),a.def(this,v,{value:c}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return n.on("ready",()=>{n.layers.add({name:"miniProgressBar",mounted(a){n.on("destroy",()=>{a.style.display="none"}),n.on("video:timeupdate",()=>{a.style.width=100*n.played+"%"}),n.on("setBar",(o,f)=>{o==="played"&&(a.style.width=100*f+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,constructor:f,template:{$player:h,$video:p}}=a;return a.on("fullscreenWeb",l=>{if(l){const{videoWidth:u,videoHeight:m}=p,{clientWidth:y,clientHeight:b}=document.documentElement;(u>m&&y<b||u<m&&y>b)&&setTimeout(()=>{n.setStyle(h,"width",`${b}px`),n.setStyle(h,"height",`${y}px`),n.setStyle(h,"transform-origin","0 0"),n.setStyle(h,"transform",`rotate(90deg) translate(0, -${y}px)`),n.addClass(h,"art-auto-orientation"),a.emit("resize")},f.MOBILE_AUTO_ORIENTATION_TIME)}else n.hasClass(h,"art-auto-orientation")&&(n.setStyle(h,"width",null),n.setStyle(h,"height",null),n.setStyle(h,"transform",null),n.setStyle(h,"transform-origin",null),n.removeClass(h,"art-auto-orientation"),a.aspectRatioReset=!0,a.autoSize=o.autoSize,a.notice.show="",a.emit("resize"))}),a.on("fullscreen",l=>er(this,null,function*(){const u=screen.orientation.type;if(l){const{videoWidth:m,videoHeight:y}=p,{clientWidth:b,clientHeight:_}=document.documentElement;if(m>y&&b<_||m<y&&b>_){const g=u.startsWith("portrait")?"landscape":"portrait";yield screen.orientation.lock(g),n.addClass(h,"art-auto-orientation-fullscreen")}}else n.hasClass(h,"art-auto-orientation-fullscreen")&&(yield screen.orientation.lock(u),n.removeClass(h,"art-auto-orientation-fullscreen"))})),{name:"autoOrientation",get state(){return n.hasClass(h,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,storage:f,constructor:h,template:{$poster:p}}=a;return a.on("video:timeupdate",()=>{const l=f.get("times")||{},u=Object.keys(l);u.length>h.AUTO_PLAYBACK_MAX&&delete l[u[0]],l[a.option.url]=a.currentTime,f.set("times",l)}),a.on("ready",()=>{const l=(f.get("times")||{})[a.option.url];l&&(a.seek=l,n.setStyle(p,"display","none"),a.notice.show=`${o.get("Auto playback at")} ${n.secondToTime(l)}`)}),{name:"autoPlayback",get times(){return f.get("times")||{}},clear:()=>f.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{constructor:o,events:{proxy:f},template:{$player:h,$video:p}}=a;let l=null,u=!1;const m=()=>{clearTimeout(l),u&&(u=!1,a.playbackRate=1,n.removeClass(h,"art-fast-forward"))};return f(p,"touchstart",y=>{y.touches.length===1&&a.playing&&!a.isLock&&(l=setTimeout(()=>{u=!0,a.playbackRate=o.FAST_FORWARD_VALUE,n.addClass(h,"art-fast-forward")},o.FAST_FORWARD_TIME))}),f(document,"touchmove",m),f(document,"touchend",m),{name:"fastForward",get state(){return n.hasClass(h,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{layers:o,icons:f,template:{$player:h}}=a;return o.add({name:"lock",mounted(p){const l=n.append(p,f.lock),u=n.append(p,f.unlock);n.setStyle(l,"display","none"),a.on("lock",m=>{m?(n.setStyle(l,"display","inline-flex"),n.setStyle(u,"display","none")):(n.setStyle(l,"display","none"),n.setStyle(u,"display","inline-flex"))})},click(){n.hasClass(h,"art-lock")?(n.removeClass(h,"art-lock"),this.isLock=!1,a.emit("lock",!1)):(n.addClass(h,"art-lock"),this.isLock=!0,a.emit("lock",!0))}}),{name:"lock",get state(){return n.hasClass(h,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aafSd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(n){this.art=n,this.init()}get current(){return this.art.option.ads[this.index]}get prev(){return this.art.option.ads[this.index-1]}get next(){return this.art.option.ads[this.index+1]}init(){this.index=0,this.isEnd=!1,this.playing=!1,this.urlCache=this.art.option.url,this.current&&(this.playing=!0,this.play(this.current))}play(n={}){this.isEnd||(this.art.switchUrl(n.url),this.art.once("video:timeupdate",()=>{this.art.emit("ads:start",n)}),this.art.once("video:ended",()=>{const a=this.next;a?(this.index+=1,this.play(a)):this.end()}))}end(){this.isEnd||(this.isEnd=!0,this.playing=!1,this.art.option.url=this.urlCache,this.art.switchUrl(this.urlCache),this.art.emit("ads:end"))}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./config"),o=n.interopDefault(a),f=r("./utils");t.default=class{constructor(h){const{option:p,events:{proxy:l},template:{$video:u}}=h;for(let b=0;b<o.default.events.length;b++)l(u,o.default.events[b],_=>{h.emit(`video:${_.type}`,_)});Object.keys(p.moreVideoAttr).forEach(b=>{u[b]=p.moreVideoAttr[b]}),p.muted&&(u.muted=p.muted),p.volume&&(u.volume=f.clamp(p.volume,0,1)),p.poster&&(u.poster=p.poster),p.autoplay&&(u.autoplay=p.autoplay),p.playsInline&&(u.playsInline=!0,u["webkit-playsinline"]=!0);const m=p.type||f.getExt(p.url),y=p.customType[m];m&&y?(y(u,p.url,h),h.emit("customType",m)):(u.src=p.url,h.emit("url",u.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Dh);var kS=Ca(Dh.exports),Ih={exports:{}};(function(s,e){(function(i,t){s.exports=t()})(self,function(){return function(){var r={"./node_modules/es6-promise/dist/es6-promise.js":function(a,o,f){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(h,p){a.exports=p()})(this,function(){function h(ne){var Ee=typeof ne;return ne!==null&&(Ee==="object"||Ee==="function")}function p(ne){return typeof ne=="function"}var l=void 0;Array.isArray?l=Array.isArray:l=function(ne){return Object.prototype.toString.call(ne)==="[object Array]"};var u=l,m=0,y=void 0,b=void 0,_=function(Ee,xe){O[m]=Ee,O[m+1]=xe,m+=2,m===2&&(b?b(D):C())};function g(ne){b=ne}function c(ne){_=ne}var v=typeof window!="undefined"?window:void 0,E=v||{},d=E.MutationObserver||E.WebKitMutationObserver,x=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",S=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function T(){return function(){return process.nextTick(D)}}function w(){return typeof y!="undefined"?function(){y(D)}:A()}function L(){var ne=0,Ee=new d(D),xe=document.createTextNode("");return Ee.observe(xe,{characterData:!0}),function(){xe.data=ne=++ne%2}}function I(){var ne=new MessageChannel;return ne.port1.onmessage=D,function(){return ne.port2.postMessage(0)}}function A(){var ne=setTimeout;return function(){return ne(D,1)}}var O=new Array(1e3);function D(){for(var ne=0;ne<m;ne+=2){var Ee=O[ne],xe=O[ne+1];Ee(xe),O[ne]=void 0,O[ne+1]=void 0}m=0}function R(){try{var ne=Function("return this")().require("vertx");return y=ne.runOnLoop||ne.runOnContext,w()}catch(Ee){return A()}}var C=void 0;x?C=T():d?C=L():S?C=I():v===void 0?C=R():C=A();function P(ne,Ee){var xe=this,Ae=new this.constructor(B);Ae[N]===void 0&&Ke(Ae);var be=xe._state;if(be){var je=arguments[be-1];_(function(){return Ue(be,Ae,je,xe._result)})}else De(xe,Ae,ne,Ee);return Ae}function M(ne){var Ee=this;if(ne&&typeof ne=="object"&&ne.constructor===Ee)return ne;var xe=new Ee(B);return ue(xe,ne),xe}var N=Math.random().toString(36).substring(2);function B(){}var U=void 0,F=1,j=2;function $(){return new TypeError("You cannot resolve a promise with itself")}function G(){return new TypeError("A promises callback cannot return that same promise.")}function Y(ne,Ee,xe,Ae){try{ne.call(Ee,xe,Ae)}catch(be){return be}}function X(ne,Ee,xe){_(function(Ae){var be=!1,je=Y(xe,Ee,function(V){be||(be=!0,Ee!==V?ue(Ae,V):de(Ae,V))},function(V){be||(be=!0,oe(Ae,V))},"Settle: "+(Ae._label||" unknown promise"));!be&&je&&(be=!0,oe(Ae,je))},ne)}function ie(ne,Ee){Ee._state===F?de(ne,Ee._result):Ee._state===j?oe(ne,Ee._result):De(Ee,void 0,function(xe){return ue(ne,xe)},function(xe){return oe(ne,xe)})}function pe(ne,Ee,xe){Ee.constructor===ne.constructor&&xe===P&&Ee.constructor.resolve===M?ie(ne,Ee):xe===void 0?de(ne,Ee):p(xe)?X(ne,Ee,xe):de(ne,Ee)}function ue(ne,Ee){if(ne===Ee)oe(ne,$());else if(h(Ee)){var xe=void 0;try{xe=Ee.then}catch(Ae){oe(ne,Ae);return}pe(ne,Ee,xe)}else de(ne,Ee)}function we(ne){ne._onerror&&ne._onerror(ne._result),Ce(ne)}function de(ne,Ee){ne._state===U&&(ne._result=Ee,ne._state=F,ne._subscribers.length!==0&&_(Ce,ne))}function oe(ne,Ee){ne._state===U&&(ne._state=j,ne._result=Ee,_(we,ne))}function De(ne,Ee,xe,Ae){var be=ne._subscribers,je=be.length;ne._onerror=null,be[je]=Ee,be[je+F]=xe,be[je+j]=Ae,je===0&&ne._state&&_(Ce,ne)}function Ce(ne){var Ee=ne._subscribers,xe=ne._state;if(Ee.length!==0){for(var Ae=void 0,be=void 0,je=ne._result,V=0;V<Ee.length;V+=3)Ae=Ee[V],be=Ee[V+xe],Ae?Ue(xe,Ae,be,je):be(je);ne._subscribers.length=0}}function Ue(ne,Ee,xe,Ae){var be=p(xe),je=void 0,V=void 0,he=!0;if(be){try{je=xe(Ae)}catch(_e){he=!1,V=_e}if(Ee===je){oe(Ee,G());return}}else je=Ae;Ee._state!==U||(be&&he?ue(Ee,je):he===!1?oe(Ee,V):ne===F?de(Ee,je):ne===j&&oe(Ee,je))}function Me(ne,Ee){try{Ee(function(Ae){ue(ne,Ae)},function(Ae){oe(ne,Ae)})}catch(xe){oe(ne,xe)}}var ze=0;function Ge(){return ze++}function Ke(ne){ne[N]=ze++,ne._state=void 0,ne._result=void 0,ne._subscribers=[]}function He(){return new Error("Array Methods must be provided an Array")}var Fe=function(){function ne(Ee,xe){this._instanceConstructor=Ee,this.promise=new Ee(B),this.promise[N]||Ke(this.promise),u(xe)?(this.length=xe.length,this._remaining=xe.length,this._result=new Array(this.length),this.length===0?de(this.promise,this._result):(this.length=this.length||0,this._enumerate(xe),this._remaining===0&&de(this.promise,this._result))):oe(this.promise,He())}return ne.prototype._enumerate=function(xe){for(var Ae=0;this._state===U&&Ae<xe.length;Ae++)this._eachEntry(xe[Ae],Ae)},ne.prototype._eachEntry=function(xe,Ae){var be=this._instanceConstructor,je=be.resolve;if(je===M){var V=void 0,he=void 0,_e=!1;try{V=xe.then}catch(Z){_e=!0,he=Z}if(V===P&&xe._state!==U)this._settledAt(xe._state,Ae,xe._result);else if(typeof V!="function")this._remaining--,this._result[Ae]=xe;else if(be===nt){var Ie=new be(B);_e?oe(Ie,he):pe(Ie,xe,V),this._willSettleAt(Ie,Ae)}else this._willSettleAt(new be(function(Z){return Z(xe)}),Ae)}else this._willSettleAt(je(xe),Ae)},ne.prototype._settledAt=function(xe,Ae,be){var je=this.promise;je._state===U&&(this._remaining--,xe===j?oe(je,be):this._result[Ae]=be),this._remaining===0&&de(je,this._result)},ne.prototype._willSettleAt=function(xe,Ae){var be=this;De(xe,void 0,function(je){return be._settledAt(F,Ae,je)},function(je){return be._settledAt(j,Ae,je)})},ne}();function Se(ne){return new Fe(this,ne).promise}function Xe(ne){var Ee=this;return u(ne)?new Ee(function(xe,Ae){for(var be=ne.length,je=0;je<be;je++)Ee.resolve(ne[je]).then(xe,Ae)}):new Ee(function(xe,Ae){return Ae(new TypeError("You must pass an array to race."))})}function st(ne){var Ee=this,xe=new Ee(B);return oe(xe,ne),xe}function et(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ot(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nt=function(){function ne(Ee){this[N]=Ge(),this._result=this._state=void 0,this._subscribers=[],B!==Ee&&(typeof Ee!="function"&&et(),this instanceof ne?Me(this,Ee):ot())}return ne.prototype.catch=function(xe){return this.then(null,xe)},ne.prototype.finally=function(xe){var Ae=this,be=Ae.constructor;return p(xe)?Ae.then(function(je){return be.resolve(xe()).then(function(){return je})},function(je){return be.resolve(xe()).then(function(){throw je})}):Ae.then(xe,xe)},ne}();nt.prototype.then=P,nt.all=Se,nt.race=Xe,nt.resolve=M,nt.reject=st,nt._setScheduler=g,nt._setAsap=c,nt._asap=_;function dt(){var ne=void 0;if(typeof f.g!="undefined")ne=f.g;else if(typeof self!="undefined")ne=self;else try{ne=Function("return this")()}catch(Ae){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ee=ne.Promise;if(Ee){var xe=null;try{xe=Object.prototype.toString.call(Ee.resolve())}catch(Ae){}if(xe==="[object Promise]"&&!Ee.cast)return}ne.Promise=nt}return nt.polyfill=dt,nt.Promise=nt,nt})},"./node_modules/events/events.js":function(a){var o=typeof Reflect=="object"?Reflect:null,f=o&&typeof o.apply=="function"?o.apply:function(A,O,D){return Function.prototype.apply.call(A,O,D)},h;o&&typeof o.ownKeys=="function"?h=o.ownKeys:Object.getOwnPropertySymbols?h=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:h=function(A){return Object.getOwnPropertyNames(A)};function p(I){console&&console.warn&&console.warn(I)}var l=Number.isNaN||function(A){return A!==A};function u(){u.init.call(this)}a.exports=u,a.exports.once=T,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var m=10;function y(I){if(typeof I!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof I)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(I){if(typeof I!="number"||I<0||l(I))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+I+".");m=I}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||l(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function b(I){return I._maxListeners===void 0?u.defaultMaxListeners:I._maxListeners}u.prototype.getMaxListeners=function(){return b(this)},u.prototype.emit=function(A){for(var O=[],D=1;D<arguments.length;D++)O.push(arguments[D]);var R=A==="error",C=this._events;if(C!==void 0)R=R&&C.error===void 0;else if(!R)return!1;if(R){var P;if(O.length>0&&(P=O[0]),P instanceof Error)throw P;var M=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw M.context=P,M}var N=C[A];if(N===void 0)return!1;if(typeof N=="function")f(N,this,O);else for(var B=N.length,U=d(N,B),D=0;D<B;++D)f(U[D],this,O);return!0};function _(I,A,O,D){var R,C,P;if(y(O),C=I._events,C===void 0?(C=I._events=Object.create(null),I._eventsCount=0):(C.newListener!==void 0&&(I.emit("newListener",A,O.listener?O.listener:O),C=I._events),P=C[A]),P===void 0)P=C[A]=O,++I._eventsCount;else if(typeof P=="function"?P=C[A]=D?[O,P]:[P,O]:D?P.unshift(O):P.push(O),R=b(I),R>0&&P.length>R&&!P.warned){P.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=I,M.type=A,M.count=P.length,p(M)}return I}u.prototype.addListener=function(A,O){return _(this,A,O,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(A,O){return _(this,A,O,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(I,A,O){var D={fired:!1,wrapFn:void 0,target:I,type:A,listener:O},R=g.bind(D);return R.listener=O,D.wrapFn=R,R}u.prototype.once=function(A,O){return y(O),this.on(A,c(this,A,O)),this},u.prototype.prependOnceListener=function(A,O){return y(O),this.prependListener(A,c(this,A,O)),this},u.prototype.removeListener=function(A,O){var D,R,C,P,M;if(y(O),R=this._events,R===void 0)return this;if(D=R[A],D===void 0)return this;if(D===O||D.listener===O)--this._eventsCount==0?this._events=Object.create(null):(delete R[A],R.removeListener&&this.emit("removeListener",A,D.listener||O));else if(typeof D!="function"){for(C=-1,P=D.length-1;P>=0;P--)if(D[P]===O||D[P].listener===O){M=D[P].listener,C=P;break}if(C<0)return this;C===0?D.shift():x(D,C),D.length===1&&(R[A]=D[0]),R.removeListener!==void 0&&this.emit("removeListener",A,M||O)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(A){var O,D,R;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[A]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete D[A]),this;if(arguments.length===0){var C=Object.keys(D),P;for(R=0;R<C.length;++R)P=C[R],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=D[A],typeof O=="function")this.removeListener(A,O);else if(O!==void 0)for(R=O.length-1;R>=0;R--)this.removeListener(A,O[R]);return this};function v(I,A,O){var D=I._events;if(D===void 0)return[];var R=D[A];return R===void 0?[]:typeof R=="function"?O?[R.listener||R]:[R]:O?S(R):d(R,R.length)}u.prototype.listeners=function(A){return v(this,A,!0)},u.prototype.rawListeners=function(A){return v(this,A,!1)},u.listenerCount=function(I,A){return typeof I.listenerCount=="function"?I.listenerCount(A):E.call(I,A)},u.prototype.listenerCount=E;function E(I){var A=this._events;if(A!==void 0){var O=A[I];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function d(I,A){for(var O=new Array(A),D=0;D<A;++D)O[D]=I[D];return O}function x(I,A){for(;A+1<I.length;A++)I[A]=I[A+1];I.pop()}function S(I){for(var A=new Array(I.length),O=0;O<A.length;++O)A[O]=I[O].listener||I[O];return A}function T(I,A){return new Promise(function(O,D){function R(P){I.removeListener(A,C),D(P)}function C(){typeof I.removeListener=="function"&&I.removeListener("error",R),O([].slice.call(arguments))}L(I,A,C,{once:!0}),A!=="error"&&w(I,R,{once:!0})})}function w(I,A,O){typeof I.on=="function"&&L(I,"error",A,O)}function L(I,A,O,D){if(typeof I.on=="function")D.once?I.once(A,O):I.on(A,O);else if(typeof I.addEventListener=="function")I.addEventListener(A,function R(C){D.once&&I.removeEventListener(A,R),O(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof I)}},"./node_modules/webworkify-webpack/index.js":function(a,o,f){function h(g){var c={};function v(d){if(c[d])return c[d].exports;var x=c[d]={i:d,l:!1,exports:{}};return g[d].call(x.exports,x,x.exports,v),x.l=!0,x.exports}v.m=g,v.c=c,v.i=function(d){return d},v.d=function(d,x,S){v.o(d,x)||Object.defineProperty(d,x,{configurable:!1,enumerable:!0,get:S})},v.r=function(d){Object.defineProperty(d,"__esModule",{value:!0})},v.n=function(d){var x=d&&d.__esModule?function(){return d.default}:function(){return d};return v.d(x,"a",x),x},v.o=function(d,x){return Object.prototype.hasOwnProperty.call(d,x)},v.p="/",v.oe=function(d){throw console.error(d),d};var E=v(v.s=ENTRY_MODULE);return E.default||E}var p="[\\.|\\-|\\+|\\w|/|@]+",l="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function u(g){return(g+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function m(g){return!isNaN(1*g)}function y(g,c,v){var E={};E[v]=[];var d=c.toString(),x=d.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!x)return E;for(var S=x[1],T=new RegExp("(\\\\n|\\W)"+u(S)+l,"g"),w;w=T.exec(d);)w[3]!=="dll-reference"&&E[v].push(w[3]);for(T=new RegExp("\\("+u(S)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+l,"g");w=T.exec(d);)g[w[2]]||(E[v].push(w[1]),g[w[2]]=f(w[1]).m),E[w[2]]=E[w[2]]||[],E[w[2]].push(w[4]);for(var L=Object.keys(E),I=0;I<L.length;I++)for(var A=0;A<E[L[I]].length;A++)m(E[L[I]][A])&&(E[L[I]][A]=1*E[L[I]][A]);return E}function b(g){var c=Object.keys(g);return c.reduce(function(v,E){return v||g[E].length>0},!1)}function _(g,c){for(var v={main:[c]},E={main:[]},d={main:{}};b(v);)for(var x=Object.keys(v),S=0;S<x.length;S++){var T=x[S],w=v[T],L=w.pop();if(d[T]=d[T]||{},!(d[T][L]||!g[T][L])){d[T][L]=!0,E[T]=E[T]||[],E[T].push(L);for(var I=y(g,g[T][L],T),A=Object.keys(I),O=0;O<A.length;O++)v[A[O]]=v[A[O]]||[],v[A[O]]=v[A[O]].concat(I[A[O]])}}return E}a.exports=function(g,c){c=c||{};var v={main:f.m},E=c.all?{main:Object.keys(v.main)}:_(v,g),d="";Object.keys(E).filter(function(L){return L!=="main"}).forEach(function(L){for(var I=0;E[L][I];)I++;E[L].push(I),v[L][I]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+L+" = ("+h.toString().replace("ENTRY_MODULE",JSON.stringify(I))+")({"+E[L].map(function(A){return""+JSON.stringify(A)+": "+v[L][A].toString()}).join(",")+`});
`}),d=d+"new (("+h.toString().replace("ENTRY_MODULE",JSON.stringify(g))+")({"+E.main.map(function(L){return""+JSON.stringify(L)+": "+v.main[L].toString()}).join(",")+"}))(self);";var x=new window.Blob([d],{type:"text/javascript"});if(c.bare)return x;var S=window.URL||window.webkitURL||window.mozURL||window.msURL,T=S.createObjectURL(x),w=new window.Worker(T);return w.objectURL=T,w}},"./src/config.js":function(a,o,f){f.r(o),f.d(o,{defaultConfig:function(){return h},createDefaultConfig:function(){return p}});var h={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function p(){return Object.assign({},h)}},"./src/core/features.js":function(a,o,f){f.r(o);var h=f("./src/io/io-controller.js"),p=f("./src/config.js"),l=function(){function u(){}return u.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},u.supportNetworkStreamIO=function(){var m=new h.default({},(0,p.createDefaultConfig)()),y=m.loaderType;return m.destroy(),y=="fetch-stream-loader"||y=="xhr-moz-chunked-loader"},u.getNetworkLoaderTypeName=function(){var m=new h.default({},(0,p.createDefaultConfig)()),y=m.loaderType;return m.destroy(),y},u.supportNativeMediaPlayback=function(m){u.videoElement==null&&(u.videoElement=window.document.createElement("video"));var y=u.videoElement.canPlayType(m);return y==="probably"||y=="maybe"},u.getFeatureList=function(){var m={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return m.mseFlvPlayback=u.supportMSEH264Playback(),m.networkStreamIO=u.supportNetworkStreamIO(),m.networkLoaderName=u.getNetworkLoaderTypeName(),m.mseLiveFlvPlayback=m.mseFlvPlayback&&m.networkStreamIO,m.nativeMP4H264Playback=u.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),m.nativeWebmVP8Playback=u.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),m.nativeWebmVP9Playback=u.supportNativeMediaPlayback('video/webm; codecs="vp9"'),m},u}();o.default=l},"./src/core/media-info.js":function(a,o,f){f.r(o);var h=function(){function p(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return p.prototype.isComplete=function(){var l=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,u=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&l&&u},p.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},p.prototype.getNearestKeyframe=function(l){if(this.keyframesIndex==null)return null;var u=this.keyframesIndex,m=this._search(u.times,l);return{index:m,milliseconds:u.times[m],fileposition:u.filepositions[m]}},p.prototype._search=function(l,u){var m=0,y=l.length-1,b=0,_=0,g=y;for(u<l[0]&&(m=0,_=g+1);_<=g;)if(b=_+Math.floor((g-_)/2),b===y||u>=l[b]&&u<l[b+1]){m=b;break}else l[b]<u?_=b+1:g=b-1;return m},p}();o.default=h},"./src/core/media-segment-info.js":function(a,o,f){f.r(o),f.d(o,{SampleInfo:function(){return h},MediaSegmentInfo:function(){return p},IDRSampleList:function(){return l},MediaSegmentInfoList:function(){return u}});var h=function(){function m(y,b,_,g,c){this.dts=y,this.pts=b,this.duration=_,this.originalDts=g,this.isSyncPoint=c,this.fileposition=null}return m}(),p=function(){function m(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return m.prototype.appendSyncPoint=function(y){y.isSyncPoint=!0,this.syncPoints.push(y)},m}(),l=function(){function m(){this._list=[]}return m.prototype.clear=function(){this._list=[]},m.prototype.appendArray=function(y){var b=this._list;y.length!==0&&(b.length>0&&y[0].originalDts<b[b.length-1].originalDts&&this.clear(),Array.prototype.push.apply(b,y))},m.prototype.getLastSyncPointBeforeDts=function(y){if(this._list.length==0)return null;var b=this._list,_=0,g=b.length-1,c=0,v=0,E=g;for(y<b[0].dts&&(_=0,v=E+1);v<=E;)if(c=v+Math.floor((E-v)/2),c===g||y>=b[c].dts&&y<b[c+1].dts){_=c;break}else b[c].dts<y?v=c+1:E=c-1;return this._list[_]},m}(),u=function(){function m(y){this._type=y,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),m.prototype.isEmpty=function(){return this._list.length===0},m.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},m.prototype._searchNearestSegmentBefore=function(y){var b=this._list;if(b.length===0)return-2;var _=b.length-1,g=0,c=0,v=_,E=0;if(y<b[0].originalBeginDts)return E=-1,E;for(;c<=v;)if(g=c+Math.floor((v-c)/2),g===_||y>b[g].lastSample.originalDts&&y<b[g+1].originalBeginDts){E=g;break}else b[g].originalBeginDts<y?c=g+1:v=g-1;return E},m.prototype._searchNearestSegmentAfter=function(y){return this._searchNearestSegmentBefore(y)+1},m.prototype.append=function(y){var b=this._list,_=y,g=this._lastAppendLocation,c=0;g!==-1&&g<b.length&&_.originalBeginDts>=b[g].lastSample.originalDts&&(g===b.length-1||g<b.length-1&&_.originalBeginDts<b[g+1].originalBeginDts)?c=g+1:b.length>0&&(c=this._searchNearestSegmentBefore(_.originalBeginDts)+1),this._lastAppendLocation=c,this._list.splice(c,0,_)},m.prototype.getLastSegmentBefore=function(y){var b=this._searchNearestSegmentBefore(y);return b>=0?this._list[b]:null},m.prototype.getLastSampleBefore=function(y){var b=this.getLastSegmentBefore(y);return b!=null?b.lastSample:null},m.prototype.getLastSyncPointBefore=function(y){for(var b=this._searchNearestSegmentBefore(y),_=this._list[b].syncPoints;_.length===0&&b>0;)b--,_=this._list[b].syncPoints;return _.length>0?_[_.length-1]:null},m}()},"./src/core/mse-controller.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./src/utils/logger.js"),u=f("./src/utils/browser.js"),m=f("./src/core/mse-events.js"),y=f("./src/core/media-segment-info.js"),b=f("./src/utils/exception.js"),_=function(){function g(c){this.TAG="MSEController",this._config=c,this._emitter=new(p()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new y.IDRSampleList}return g.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},g.prototype.on=function(c,v){this._emitter.addListener(c,v)},g.prototype.off=function(c,v){this._emitter.removeListener(c,v)},g.prototype.attachMediaElement=function(c){if(this._mediaSource)throw new b.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var v=this._mediaSource=new window.MediaSource;v.addEventListener("sourceopen",this.e.onSourceOpen),v.addEventListener("sourceended",this.e.onSourceEnded),v.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=c,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),c.src=this._mediaSourceObjectURL},g.prototype.detachMediaElement=function(){if(this._mediaSource){var c=this._mediaSource;for(var v in this._sourceBuffers){var E=this._pendingSegments[v];E.splice(0,E.length),this._pendingSegments[v]=null,this._pendingRemoveRanges[v]=null,this._lastInitSegments[v]=null;var d=this._sourceBuffers[v];if(d){if(c.readyState!=="closed"){try{c.removeSourceBuffer(d)}catch(x){l.default.e(this.TAG,x.message)}d.removeEventListener("error",this.e.onSourceBufferError),d.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[v]=null,this._sourceBuffers[v]=null}}if(c.readyState==="open")try{c.endOfStream()}catch(x){l.default.e(this.TAG,x.message)}c.removeEventListener("sourceopen",this.e.onSourceOpen),c.removeEventListener("sourceended",this.e.onSourceEnded),c.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},g.prototype.appendInitSegment=function(c,v){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(c),this._pendingSegments[c.type].push(c);return}var E=c,d=""+E.container;E.codec&&E.codec.length>0&&(d+=";codecs="+E.codec);var x=!1;if(l.default.v(this.TAG,"Received Initialization Segment, mimeType: "+d),this._lastInitSegments[E.type]=E,d!==this._mimeTypes[E.type]){if(this._mimeTypes[E.type])l.default.v(this.TAG,"Notice: "+E.type+" mimeType changed, origin: "+this._mimeTypes[E.type]+", target: "+d);else{x=!0;try{var S=this._sourceBuffers[E.type]=this._mediaSource.addSourceBuffer(d);S.addEventListener("error",this.e.onSourceBufferError),S.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(T){l.default.e(this.TAG,T.message),this._emitter.emit(m.default.ERROR,{code:T.code,msg:T.message});return}}this._mimeTypes[E.type]=d}v||this._pendingSegments[E.type].push(E),x||this._sourceBuffers[E.type]&&!this._sourceBuffers[E.type].updating&&this._doAppendSegments(),u.default.safari&&E.container==="audio/mpeg"&&E.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=E.mediaDuration/1e3,this._updateMediaSourceDuration())},g.prototype.appendMediaSegment=function(c){var v=c;this._pendingSegments[v.type].push(v),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var E=this._sourceBuffers[v.type];E&&!E.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},g.prototype.seek=function(c){for(var v in this._sourceBuffers)if(!!this._sourceBuffers[v]){var E=this._sourceBuffers[v];if(this._mediaSource.readyState==="open")try{E.abort()}catch(L){l.default.e(this.TAG,L.message)}this._idrList.clear();var d=this._pendingSegments[v];if(d.splice(0,d.length),this._mediaSource.readyState!=="closed"){for(var x=0;x<E.buffered.length;x++){var S=E.buffered.start(x),T=E.buffered.end(x);this._pendingRemoveRanges[v].push({start:S,end:T})}if(E.updating||this._doRemoveRanges(),u.default.safari){var w=this._lastInitSegments[v];w&&(this._pendingSegments[v].push(w),E.updating||this._doAppendSegments())}}}},g.prototype.endOfStream=function(){var c=this._mediaSource,v=this._sourceBuffers;if(!c||c.readyState!=="open"){c&&c.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}v.video&&v.video.updating||v.audio&&v.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,c.endOfStream())},g.prototype.getNearestKeyframe=function(c){return this._idrList.getLastSyncPointBeforeDts(c)},g.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var c=this._mediaElement.currentTime;for(var v in this._sourceBuffers){var E=this._sourceBuffers[v];if(E){var d=E.buffered;if(d.length>=1&&c-d.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},g.prototype._doCleanupSourceBuffer=function(){var c=this._mediaElement.currentTime;for(var v in this._sourceBuffers){var E=this._sourceBuffers[v];if(E){for(var d=E.buffered,x=!1,S=0;S<d.length;S++){var T=d.start(S),w=d.end(S);if(T<=c&&c<w+3){if(c-T>=this._config.autoCleanupMaxBackwardDuration){x=!0;var L=c-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[v].push({start:T,end:L})}}else w<c&&(x=!0,this._pendingRemoveRanges[v].push({start:T,end:w}))}x&&!E.updating&&this._doRemoveRanges()}}},g.prototype._updateMediaSourceDuration=function(){var c=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(c.video&&c.video.updating||c.audio&&c.audio.updating)){var v=this._mediaSource.duration,E=this._pendingMediaDuration;E>0&&(isNaN(v)||E>v)&&(l.default.v(this.TAG,"Update MediaSource duration from "+v+" to "+E),this._mediaSource.duration=E),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},g.prototype._doRemoveRanges=function(){for(var c in this._pendingRemoveRanges)if(!(!this._sourceBuffers[c]||this._sourceBuffers[c].updating))for(var v=this._sourceBuffers[c],E=this._pendingRemoveRanges[c];E.length&&!v.updating;){var d=E.shift();v.remove(d.start,d.end)}},g.prototype._doAppendSegments=function(){var c=this._pendingSegments;for(var v in c)if(!(!this._sourceBuffers[v]||this._sourceBuffers[v].updating)&&c[v].length>0){var E=c[v].shift();if(E.timestampOffset){var d=this._sourceBuffers[v].timestampOffset,x=E.timestampOffset/1e3,S=Math.abs(d-x);S>.1&&(l.default.v(this.TAG,"Update MPEG audio timestampOffset from "+d+" to "+x),this._sourceBuffers[v].timestampOffset=x),delete E.timestampOffset}if(!E.data||E.data.byteLength===0)continue;try{this._sourceBuffers[v].appendBuffer(E.data),this._isBufferFull=!1,v==="video"&&E.hasOwnProperty("info")&&this._idrList.appendArray(E.info.syncPoints)}catch(T){this._pendingSegments[v].unshift(E),T.code===22?(this._isBufferFull||this._emitter.emit(m.default.BUFFER_FULL),this._isBufferFull=!0):(l.default.e(this.TAG,T.message),this._emitter.emit(m.default.ERROR,{code:T.code,msg:T.message}))}}},g.prototype._onSourceOpen=function(){if(l.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var c=this._pendingSourceBufferInit;c.length;){var v=c.shift();this.appendInitSegment(v,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(m.default.SOURCE_OPEN)},g.prototype._onSourceEnded=function(){l.default.v(this.TAG,"MediaSource onSourceEnded")},g.prototype._onSourceClose=function(){l.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},g.prototype._hasPendingSegments=function(){var c=this._pendingSegments;return c.video.length>0||c.audio.length>0},g.prototype._hasPendingRemoveRanges=function(){var c=this._pendingRemoveRanges;return c.video.length>0||c.audio.length>0},g.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(m.default.UPDATE_END)},g.prototype._onSourceBufferError=function(c){l.default.e(this.TAG,"SourceBuffer Error: "+c)},g}();o.default=_},"./src/core/mse-events.js":function(a,o,f){f.r(o);var h={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};o.default=h},"./src/core/transmuxer.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./node_modules/webworkify-webpack/index.js"),u=f.n(l),m=f("./src/utils/logger.js"),y=f("./src/utils/logging-control.js"),b=f("./src/core/transmuxing-controller.js"),_=f("./src/core/transmuxing-events.js"),g=f("./src/core/media-info.js"),c=function(){function v(E,d){if(this.TAG="Transmuxer",this._emitter=new(p()),d.enableWorker&&typeof Worker!="undefined")try{this._worker=u()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[E,d]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},y.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:y.default.getConfig()})}catch(S){m.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new b.default(E,d)}else this._controller=new b.default(E,d);if(this._controller){var x=this._controller;x.on(_.default.IO_ERROR,this._onIOError.bind(this)),x.on(_.default.DEMUX_ERROR,this._onDemuxError.bind(this)),x.on(_.default.INIT_SEGMENT,this._onInitSegment.bind(this)),x.on(_.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),x.on(_.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),x.on(_.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),x.on(_.default.MEDIA_INFO,this._onMediaInfo.bind(this)),x.on(_.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),x.on(_.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),x.on(_.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),x.on(_.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return v.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),y.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(E,d){this._emitter.addListener(E,d)},v.prototype.off=function(E,d){this._emitter.removeListener(E,d)},v.prototype.hasWorker=function(){return this._worker!=null},v.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},v.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},v.prototype.seek=function(E){this._worker?this._worker.postMessage({cmd:"seek",param:E}):this._controller.seek(E)},v.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},v.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},v.prototype._onInitSegment=function(E,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.INIT_SEGMENT,E,d)})},v.prototype._onMediaSegment=function(E,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.MEDIA_SEGMENT,E,d)})},v.prototype._onLoadingComplete=function(){var E=this;Promise.resolve().then(function(){E._emitter.emit(_.default.LOADING_COMPLETE)})},v.prototype._onRecoveredEarlyEof=function(){var E=this;Promise.resolve().then(function(){E._emitter.emit(_.default.RECOVERED_EARLY_EOF)})},v.prototype._onMediaInfo=function(E){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.MEDIA_INFO,E)})},v.prototype._onMetaDataArrived=function(E){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.METADATA_ARRIVED,E)})},v.prototype._onScriptDataArrived=function(E){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.SCRIPTDATA_ARRIVED,E)})},v.prototype._onStatisticsInfo=function(E){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.STATISTICS_INFO,E)})},v.prototype._onIOError=function(E,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.IO_ERROR,E,d)})},v.prototype._onDemuxError=function(E,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.DEMUX_ERROR,E,d)})},v.prototype._onRecommendSeekpoint=function(E){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.RECOMMEND_SEEKPOINT,E)})},v.prototype._onLoggingConfigChanged=function(E){this._worker&&this._worker.postMessage({cmd:"logging_config",param:E})},v.prototype._onWorkerMessage=function(E){var d=E.data,x=d.data;if(d.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(d.msg){case _.default.INIT_SEGMENT:case _.default.MEDIA_SEGMENT:this._emitter.emit(d.msg,x.type,x.data);break;case _.default.LOADING_COMPLETE:case _.default.RECOVERED_EARLY_EOF:this._emitter.emit(d.msg);break;case _.default.MEDIA_INFO:Object.setPrototypeOf(x,g.default.prototype),this._emitter.emit(d.msg,x);break;case _.default.METADATA_ARRIVED:case _.default.SCRIPTDATA_ARRIVED:case _.default.STATISTICS_INFO:this._emitter.emit(d.msg,x);break;case _.default.IO_ERROR:case _.default.DEMUX_ERROR:this._emitter.emit(d.msg,x.type,x.info);break;case _.default.RECOMMEND_SEEKPOINT:this._emitter.emit(d.msg,x);break;case"logcat_callback":m.default.emitter.emit("log",x.type,x.logcat);break}},v}();o.default=c},"./src/core/transmuxing-controller.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./src/utils/logger.js"),u=f("./src/utils/browser.js"),m=f("./src/core/media-info.js"),y=f("./src/demux/flv-demuxer.js"),b=f("./src/remux/mp4-remuxer.js"),_=f("./src/demux/demux-errors.js"),g=f("./src/io/io-controller.js"),c=f("./src/core/transmuxing-events.js"),v=function(){function E(d,x){this.TAG="TransmuxingController",this._emitter=new(p()),this._config=x,d.segments||(d.segments=[{duration:d.duration,filesize:d.filesize,url:d.url}]),typeof d.cors!="boolean"&&(d.cors=!0),typeof d.withCredentials!="boolean"&&(d.withCredentials=!1),this._mediaDataSource=d,this._currentSegmentIndex=0;var S=0;this._mediaDataSource.segments.forEach(function(T){T.timestampBase=S,S+=T.duration,T.cors=d.cors,T.withCredentials=d.withCredentials,x.referrerPolicy&&(T.referrerPolicy=x.referrerPolicy)}),!isNaN(S)&&this._mediaDataSource.duration!==S&&(this._mediaDataSource.duration=S),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return E.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},E.prototype.on=function(d,x){this._emitter.addListener(d,x)},E.prototype.off=function(d,x){this._emitter.removeListener(d,x)},E.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},E.prototype._loadSegment=function(d,x){this._currentSegmentIndex=d;var S=this._mediaDataSource.segments[d],T=this._ioctl=new g.default(S,this._config,d);T.onError=this._onIOException.bind(this),T.onSeeked=this._onIOSeeked.bind(this),T.onComplete=this._onIOComplete.bind(this),T.onRedirect=this._onIORedirect.bind(this),T.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),x?this._demuxer.bindDataSource(this._ioctl):T.onDataArrival=this._onInitChunkArrival.bind(this),T.open(x)},E.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},E.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},E.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},E.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},E.prototype.seek=function(d){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var x=this._searchSegmentIndexContains(d);if(x===this._currentSegmentIndex){var S=this._mediaInfo.segments[x];if(S==null)this._pendingSeekTime=d;else{var T=S.getNearestKeyframe(d);this._remuxer.seek(T.milliseconds),this._ioctl.seek(T.fileposition),this._pendingResolveSeekPoint=T.milliseconds}}else{var w=this._mediaInfo.segments[x];if(w==null)this._pendingSeekTime=d,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(x);else{var T=w.getNearestKeyframe(d);this._internalAbort(),this._remuxer.seek(d),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[x].timestampBase,this._loadSegment(x,T.fileposition),this._pendingResolveSeekPoint=T.milliseconds,this._reportSegmentMediaInfo(x)}}this._enableStatisticsReporter()}},E.prototype._searchSegmentIndexContains=function(d){for(var x=this._mediaDataSource.segments,S=x.length-1,T=0;T<x.length;T++)if(d<x[T].timestampBase){S=T-1;break}return S},E.prototype._onInitChunkArrival=function(d,x){var S=this,T=null,w=0;if(x>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,w=this._demuxer.parseChunks(d,x);else if((T=y.default.probe(d)).match){this._demuxer=new y.default(T,this._config),this._remuxer||(this._remuxer=new b.default(this._config));var L=this._mediaDataSource;L.duration!=null&&!isNaN(L.duration)&&(this._demuxer.overridedDuration=L.duration),typeof L.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=L.hasAudio),typeof L.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=L.hasVideo),this._demuxer.timestampBase=L.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),w=this._demuxer.parseChunks(d,x)}else T=null,l.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){S._internalAbort()}),this._emitter.emit(c.default.DEMUX_ERROR,_.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),w=0;return w},E.prototype._onMediaInfo=function(d){var x=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},d),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,m.default.prototype));var S=Object.assign({},d);Object.setPrototypeOf(S,m.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=S,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var T=x._pendingSeekTime;x._pendingSeekTime=null,x.seek(T)})},E.prototype._onMetaDataArrived=function(d){this._emitter.emit(c.default.METADATA_ARRIVED,d)},E.prototype._onScriptDataArrived=function(d){this._emitter.emit(c.default.SCRIPTDATA_ARRIVED,d)},E.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},E.prototype._onIOComplete=function(d){var x=d,S=x+1;S<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(S)):(this._remuxer.flushStashedSamples(),this._emitter.emit(c.default.LOADING_COMPLETE),this._disableStatisticsReporter())},E.prototype._onIORedirect=function(d){var x=this._ioctl.extraData;this._mediaDataSource.segments[x].redirectedURL=d},E.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(c.default.RECOVERED_EARLY_EOF)},E.prototype._onIOException=function(d,x){l.default.e(this.TAG,"IOException: type = "+d+", code = "+x.code+", msg = "+x.msg),this._emitter.emit(c.default.IO_ERROR,d,x),this._disableStatisticsReporter()},E.prototype._onDemuxException=function(d,x){l.default.e(this.TAG,"DemuxException: type = "+d+", info = "+x),this._emitter.emit(c.default.DEMUX_ERROR,d,x)},E.prototype._onRemuxerInitSegmentArrival=function(d,x){this._emitter.emit(c.default.INIT_SEGMENT,d,x)},E.prototype._onRemuxerMediaSegmentArrival=function(d,x){if(this._pendingSeekTime==null&&(this._emitter.emit(c.default.MEDIA_SEGMENT,d,x),this._pendingResolveSeekPoint!=null&&d==="video")){var S=x.info.syncPoints,T=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,u.default.safari&&S.length>0&&S[0].originalDts===T&&(T=S[0].pts),this._emitter.emit(c.default.RECOMMEND_SEEKPOINT,T)}},E.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},E.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},E.prototype._reportSegmentMediaInfo=function(d){var x=this._mediaInfo.segments[d],S=Object.assign({},x);S.duration=this._mediaInfo.duration,S.segmentCount=this._mediaInfo.segmentCount,delete S.segments,delete S.keyframesIndex,this._emitter.emit(c.default.MEDIA_INFO,S)},E.prototype._reportStatisticsInfo=function(){var d={};d.url=this._ioctl.currentURL,d.hasRedirect=this._ioctl.hasRedirect,d.hasRedirect&&(d.redirectedURL=this._ioctl.currentRedirectedURL),d.speed=this._ioctl.currentSpeed,d.loaderType=this._ioctl.loaderType,d.currentSegmentIndex=this._currentSegmentIndex,d.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(c.default.STATISTICS_INFO,d)},E}();o.default=v},"./src/core/transmuxing-events.js":function(a,o,f){f.r(o);var h={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};o.default=h},"./src/core/transmuxing-worker.js":function(a,o,f){f.r(o);var h=f("./src/utils/logging-control.js"),p=f("./src/utils/polyfill.js"),l=f("./src/core/transmuxing-controller.js"),u=f("./src/core/transmuxing-events.js"),m=function(y){var b=null,_=A.bind(this);p.default.install(),y.addEventListener("message",function(O){switch(O.data.cmd){case"init":b=new l.default(O.data.param[0],O.data.param[1]),b.on(u.default.IO_ERROR,w.bind(this)),b.on(u.default.DEMUX_ERROR,L.bind(this)),b.on(u.default.INIT_SEGMENT,g.bind(this)),b.on(u.default.MEDIA_SEGMENT,c.bind(this)),b.on(u.default.LOADING_COMPLETE,v.bind(this)),b.on(u.default.RECOVERED_EARLY_EOF,E.bind(this)),b.on(u.default.MEDIA_INFO,d.bind(this)),b.on(u.default.METADATA_ARRIVED,x.bind(this)),b.on(u.default.SCRIPTDATA_ARRIVED,S.bind(this)),b.on(u.default.STATISTICS_INFO,T.bind(this)),b.on(u.default.RECOMMEND_SEEKPOINT,I.bind(this));break;case"destroy":b&&(b.destroy(),b=null),y.postMessage({msg:"destroyed"});break;case"start":b.start();break;case"stop":b.stop();break;case"seek":b.seek(O.data.param);break;case"pause":b.pause();break;case"resume":b.resume();break;case"logging_config":{var D=O.data.param;h.default.applyConfig(D),D.enableCallback===!0?h.default.addLogListener(_):h.default.removeLogListener(_);break}}});function g(O,D){var R={msg:u.default.INIT_SEGMENT,data:{type:O,data:D}};y.postMessage(R,[D.data])}function c(O,D){var R={msg:u.default.MEDIA_SEGMENT,data:{type:O,data:D}};y.postMessage(R,[D.data])}function v(){var O={msg:u.default.LOADING_COMPLETE};y.postMessage(O)}function E(){var O={msg:u.default.RECOVERED_EARLY_EOF};y.postMessage(O)}function d(O){var D={msg:u.default.MEDIA_INFO,data:O};y.postMessage(D)}function x(O){var D={msg:u.default.METADATA_ARRIVED,data:O};y.postMessage(D)}function S(O){var D={msg:u.default.SCRIPTDATA_ARRIVED,data:O};y.postMessage(D)}function T(O){var D={msg:u.default.STATISTICS_INFO,data:O};y.postMessage(D)}function w(O,D){y.postMessage({msg:u.default.IO_ERROR,data:{type:O,info:D}})}function L(O,D){y.postMessage({msg:u.default.DEMUX_ERROR,data:{type:O,info:D}})}function I(O){y.postMessage({msg:u.default.RECOMMEND_SEEKPOINT,data:O})}function A(O,D){y.postMessage({msg:"logcat_callback",data:{type:O,logcat:D}})}};o.default=m},"./src/demux/amf-parser.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/utils/utf8-conv.js"),l=f("./src/utils/exception.js"),u=function(){var y=new ArrayBuffer(2);return new DataView(y).setInt16(0,256,!0),new Int16Array(y)[0]===256}(),m=function(){function y(){}return y.parseScriptData=function(b,_,g){var c={};try{var v=y.parseValue(b,_,g),E=y.parseValue(b,_+v.size,g-v.size);c[v.data]=E.data}catch(d){h.default.e("AMF",d.toString())}return c},y.parseObject=function(b,_,g){if(g<3)throw new l.IllegalStateException("Data not enough when parse ScriptDataObject");var c=y.parseString(b,_,g),v=y.parseValue(b,_+c.size,g-c.size),E=v.objectEnd;return{data:{name:c.data,value:v.data},size:c.size+v.size,objectEnd:E}},y.parseVariable=function(b,_,g){return y.parseObject(b,_,g)},y.parseString=function(b,_,g){if(g<2)throw new l.IllegalStateException("Data not enough when parse String");var c=new DataView(b,_,g),v=c.getUint16(0,!u),E;return v>0?E=(0,p.default)(new Uint8Array(b,_+2,v)):E="",{data:E,size:2+v}},y.parseLongString=function(b,_,g){if(g<4)throw new l.IllegalStateException("Data not enough when parse LongString");var c=new DataView(b,_,g),v=c.getUint32(0,!u),E;return v>0?E=(0,p.default)(new Uint8Array(b,_+4,v)):E="",{data:E,size:4+v}},y.parseDate=function(b,_,g){if(g<10)throw new l.IllegalStateException("Data size invalid when parse Date");var c=new DataView(b,_,g),v=c.getFloat64(0,!u),E=c.getInt16(8,!u);return v+=E*60*1e3,{data:new Date(v),size:8+2}},y.parseValue=function(b,_,g){if(g<1)throw new l.IllegalStateException("Data not enough when parse Value");var c=new DataView(b,_,g),v=1,E=c.getUint8(0),d,x=!1;try{switch(E){case 0:d=c.getFloat64(1,!u),v+=8;break;case 1:{var S=c.getUint8(1);d=!!S,v+=1;break}case 2:{var T=y.parseString(b,_+1,g-1);d=T.data,v+=T.size;break}case 3:{d={};var w=0;for((c.getUint32(g-4,!u)&16777215)==9&&(w=3);v<g-4;){var L=y.parseObject(b,_+v,g-v-w);if(L.objectEnd)break;d[L.data.name]=L.data.value,v+=L.size}if(v<=g-3){var I=c.getUint32(v-1,!u)&16777215;I===9&&(v+=3)}break}case 8:{d={},v+=4;var w=0;for((c.getUint32(g-4,!u)&16777215)==9&&(w=3);v<g-8;){var A=y.parseVariable(b,_+v,g-v-w);if(A.objectEnd)break;d[A.data.name]=A.data.value,v+=A.size}if(v<=g-3){var I=c.getUint32(v-1,!u)&16777215;I===9&&(v+=3)}break}case 9:d=void 0,v=1,x=!0;break;case 10:{d=[];var O=c.getUint32(1,!u);v+=4;for(var D=0;D<O;D++){var R=y.parseValue(b,_+v,g-v);d.push(R.data),v+=R.size}break}case 11:{var C=y.parseDate(b,_+1,g-1);d=C.data,v+=C.size;break}case 12:{var P=y.parseString(b,_+1,g-1);d=P.data,v+=P.size;break}default:v=g,h.default.w("AMF","Unsupported AMF value type "+E)}}catch(M){h.default.e("AMF",M.toString())}return{data:d,size:v,objectEnd:x}},y}();o.default=m},"./src/demux/demux-errors.js":function(a,o,f){f.r(o);var h={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};o.default=h},"./src/demux/exp-golomb.js":function(a,o,f){f.r(o);var h=f("./src/utils/exception.js"),p=function(){function l(u){this.TAG="ExpGolomb",this._buffer=u,this._buffer_index=0,this._total_bytes=u.byteLength,this._total_bits=u.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return l.prototype.destroy=function(){this._buffer=null},l.prototype._fillCurrentWord=function(){var u=this._total_bytes-this._buffer_index;if(u<=0)throw new h.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var m=Math.min(4,u),y=new Uint8Array(4);y.set(this._buffer.subarray(this._buffer_index,this._buffer_index+m)),this._current_word=new DataView(y.buffer).getUint32(0,!1),this._buffer_index+=m,this._current_word_bits_left=m*8},l.prototype.readBits=function(u){if(u>32)throw new h.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(u<=this._current_word_bits_left){var m=this._current_word>>>32-u;return this._current_word<<=u,this._current_word_bits_left-=u,m}var y=this._current_word_bits_left?this._current_word:0;y=y>>>32-this._current_word_bits_left;var b=u-this._current_word_bits_left;this._fillCurrentWord();var _=Math.min(b,this._current_word_bits_left),g=this._current_word>>>32-_;return this._current_word<<=_,this._current_word_bits_left-=_,y=y<<_|g,y},l.prototype.readBool=function(){return this.readBits(1)===1},l.prototype.readByte=function(){return this.readBits(8)},l.prototype._skipLeadingZero=function(){var u;for(u=0;u<this._current_word_bits_left;u++)if((this._current_word&2147483648>>>u)!=0)return this._current_word<<=u,this._current_word_bits_left-=u,u;return this._fillCurrentWord(),u+this._skipLeadingZero()},l.prototype.readUEG=function(){var u=this._skipLeadingZero();return this.readBits(u+1)-1},l.prototype.readSEG=function(){var u=this.readUEG();return u&1?u+1>>>1:-1*(u>>>1)},l}();o.default=p},"./src/demux/flv-demuxer.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/demux/amf-parser.js"),l=f("./src/demux/sps-parser.js"),u=f("./src/demux/demux-errors.js"),m=f("./src/core/media-info.js"),y=f("./src/utils/exception.js");function b(g,c){return g[c]<<24|g[c+1]<<16|g[c+2]<<8|g[c+3]}var _=function(){function g(c,v){this.TAG="FLVDemuxer",this._config=v,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=c.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=c.hasAudioTrack,this._hasVideo=c.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new m.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var E=new ArrayBuffer(2);return new DataView(E).setInt16(0,256,!0),new Int16Array(E)[0]===256}()}return g.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},g.probe=function(c){var v=new Uint8Array(c),E={match:!1};if(v[0]!==70||v[1]!==76||v[2]!==86||v[3]!==1)return E;var d=(v[4]&4)>>>2!=0,x=(v[4]&1)!=0,S=b(v,5);return S<9?E:{match:!0,consumed:S,dataOffset:S,hasAudioTrack:d,hasVideoTrack:x}},g.prototype.bindDataSource=function(c){return c.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(g.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(c){this._onTrackMetadata=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(c){this._onMediaInfo=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(c){this._onMetaDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(c){this._onScriptDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(c){this._onError=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(c){this._onDataAvailable=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(c){this._timestampBase=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"overridedDuration",{get:function(){return this._duration},set:function(c){this._durationOverrided=!0,this._duration=c,this._mediaInfo.duration=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"overridedHasAudio",{set:function(c){this._hasAudioFlagOverrided=!0,this._hasAudio=c,this._mediaInfo.hasAudio=c},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"overridedHasVideo",{set:function(c){this._hasVideoFlagOverrided=!0,this._hasVideo=c,this._mediaInfo.hasVideo=c},enumerable:!1,configurable:!0}),g.prototype.resetMediaInfo=function(){this._mediaInfo=new m.default},g.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},g.prototype.parseChunks=function(c,v){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new y.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var E=0,d=this._littleEndian;if(v===0)if(c.byteLength>13){var x=g.probe(c);E=x.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,v+E!==this._dataOffset&&h.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var S=new DataView(c,E),T=S.getUint32(0,!d);T!==0&&h.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),E+=4}for(;E<c.byteLength;){this._dispatch=!0;var S=new DataView(c,E);if(E+11+4>c.byteLength)break;var w=S.getUint8(0),L=S.getUint32(0,!d)&16777215;if(E+11+L+4>c.byteLength)break;if(w!==8&&w!==9&&w!==18){h.default.w(this.TAG,"Unsupported tag type "+w+", skipped"),E+=11+L+4;continue}var I=S.getUint8(4),A=S.getUint8(5),O=S.getUint8(6),D=S.getUint8(7),R=O|A<<8|I<<16|D<<24,C=S.getUint32(7,!d)&16777215;C!==0&&h.default.w(this.TAG,"Meet tag which has StreamID != 0!");var P=E+11;switch(w){case 8:this._parseAudioData(c,P,L,R);break;case 9:this._parseVideoData(c,P,L,R,v+E);break;case 18:this._parseScriptData(c,P,L);break}var M=S.getUint32(11+L,!d);M!==11+L&&h.default.w(this.TAG,"Invalid PrevTagSize "+M),E+=11+L+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),E},g.prototype._parseScriptData=function(c,v,E){var d=p.default.parseScriptData(c,v,E);if(d.hasOwnProperty("onMetaData")){if(d.onMetaData==null||typeof d.onMetaData!="object"){h.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&h.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=d;var x=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},x)),typeof x.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=x.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof x.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=x.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof x.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=x.audiodatarate),typeof x.videodatarate=="number"&&(this._mediaInfo.videoDataRate=x.videodatarate),typeof x.width=="number"&&(this._mediaInfo.width=x.width),typeof x.height=="number"&&(this._mediaInfo.height=x.height),typeof x.duration=="number"){if(!this._durationOverrided){var S=Math.floor(x.duration*this._timescale);this._duration=S,this._mediaInfo.duration=S}}else this._mediaInfo.duration=0;if(typeof x.framerate=="number"){var T=Math.floor(x.framerate*1e3);if(T>0){var w=T/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=w,this._referenceFrameRate.fps_num=T,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=w}}if(typeof x.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var L=x.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(L),x.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=x,h.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(d).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},d))},g.prototype._parseKeyframesIndex=function(c){for(var v=[],E=[],d=1;d<c.times.length;d++){var x=this._timestampBase+Math.floor(c.times[d]*1e3);v.push(x),E.push(c.filepositions[d])}return{times:v,filepositions:E}},g.prototype._parseAudioData=function(c,v,E,d){if(E<=1){h.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var x=new DataView(c,v,E),S=x.getUint8(0),T=S>>>4;if(T!==2&&T!==10){this._onError(u.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+T);return}var w=0,L=(S&12)>>>2;if(L>=0&&L<=4)w=this._flvSoundRateTable[L];else{this._onError(u.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+L);return}var I=S&1,A=this._audioMetadata,O=this._audioTrack;if(A||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),A=this._audioMetadata={},A.type="audio",A.id=O.id,A.timescale=this._timescale,A.duration=this._duration,A.audioSampleRate=w,A.channelCount=I===0?1:2),T===10){var D=this._parseAACAudioData(c,v+1,E-1);if(D==null)return;if(D.packetType===0){A.config&&h.default.w(this.TAG,"Found another AudioSpecificConfig!");var R=D.data;A.audioSampleRate=R.samplingRate,A.channelCount=R.channelCount,A.codec=R.codec,A.originalCodec=R.originalCodec,A.config=R.config,A.refSampleDuration=1024/A.audioSampleRate*A.timescale,h.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",A);var C=this._mediaInfo;C.audioCodec=A.originalCodec,C.audioSampleRate=A.audioSampleRate,C.audioChannelCount=A.channelCount,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}else if(D.packetType===1){var P=this._timestampBase+d,M={unit:D.data,length:D.data.byteLength,dts:P,pts:P};O.samples.push(M),O.length+=D.data.length}else h.default.e(this.TAG,"Flv: Unsupported AAC data type "+D.packetType)}else if(T===2){if(!A.codec){var R=this._parseMP3AudioData(c,v+1,E-1,!0);if(R==null)return;A.audioSampleRate=R.samplingRate,A.channelCount=R.channelCount,A.codec=R.codec,A.originalCodec=R.originalCodec,A.refSampleDuration=1152/A.audioSampleRate*A.timescale,h.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",A);var C=this._mediaInfo;C.audioCodec=A.codec,C.audioSampleRate=A.audioSampleRate,C.audioChannelCount=A.channelCount,C.audioDataRate=R.bitRate,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}var N=this._parseMP3AudioData(c,v+1,E-1,!1);if(N==null)return;var P=this._timestampBase+d,B={unit:N,length:N.byteLength,dts:P,pts:P};O.samples.push(B),O.length+=N.length}}},g.prototype._parseAACAudioData=function(c,v,E){if(E<=1){h.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var d={},x=new Uint8Array(c,v,E);return d.packetType=x[0],x[0]===0?d.data=this._parseAACAudioSpecificConfig(c,v+1,E-1):d.data=x.subarray(1),d},g.prototype._parseAACAudioSpecificConfig=function(c,v,E){var d=new Uint8Array(c,v,E),x=null,S=0,T=0,w=0,L=null;if(S=T=d[0]>>>3,w=(d[0]&7)<<1|d[1]>>>7,w<0||w>=this._mpegSamplingRates.length){this._onError(u.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var I=this._mpegSamplingRates[w],A=(d[1]&120)>>>3;if(A<0||A>=8){this._onError(u.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}S===5&&(L=(d[1]&7)<<1|d[2]>>>7,(d[2]&124)>>>2);var O=self.navigator.userAgent.toLowerCase();return O.indexOf("firefox")!==-1?w>=6?(S=5,x=new Array(4),L=w-3):(S=2,x=new Array(2),L=w):O.indexOf("android")!==-1?(S=2,x=new Array(2),L=w):(S=5,L=w,x=new Array(4),w>=6?L=w-3:A===1&&(S=2,x=new Array(2),L=w)),x[0]=S<<3,x[0]|=(w&15)>>>1,x[1]=(w&15)<<7,x[1]|=(A&15)<<3,S===5&&(x[1]|=(L&15)>>>1,x[2]=(L&1)<<7,x[2]|=2<<2,x[3]=0),{config:x,samplingRate:I,channelCount:A,codec:"mp4a.40."+S,originalCodec:"mp4a.40."+T}},g.prototype._parseMP3AudioData=function(c,v,E,d){if(E<4){h.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var x=new Uint8Array(c,v,E),S=null;if(d){if(x[0]!==255)return;var T=x[1]>>>3&3,w=(x[1]&6)>>1,L=(x[2]&240)>>>4,I=(x[2]&12)>>>2,A=x[3]>>>6&3,O=A!==3?2:1,D=0,R=0,C="mp3";switch(T){case 0:D=this._mpegAudioV25SampleRateTable[I];break;case 2:D=this._mpegAudioV20SampleRateTable[I];break;case 3:D=this._mpegAudioV10SampleRateTable[I];break}switch(w){case 1:L<this._mpegAudioL3BitRateTable.length&&(R=this._mpegAudioL3BitRateTable[L]);break;case 2:L<this._mpegAudioL2BitRateTable.length&&(R=this._mpegAudioL2BitRateTable[L]);break;case 3:L<this._mpegAudioL1BitRateTable.length&&(R=this._mpegAudioL1BitRateTable[L]);break}S={bitRate:R,samplingRate:D,channelCount:O,codec:C,originalCodec:C}}else S=x;return S},g.prototype._parseVideoData=function(c,v,E,d,x){if(E<=1){h.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var S=new Uint8Array(c,v,E)[0],T=(S&240)>>>4,w=S&15;if(w!==7){this._onError(u.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+w);return}this._parseAVCVideoPacket(c,v+1,E-1,d,x,T)}},g.prototype._parseAVCVideoPacket=function(c,v,E,d,x,S){if(E<4){h.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var T=this._littleEndian,w=new DataView(c,v,E),L=w.getUint8(0),I=w.getUint32(0,!T)&16777215,A=I<<8>>8;if(L===0)this._parseAVCDecoderConfigurationRecord(c,v+4,E-4);else if(L===1)this._parseAVCVideoData(c,v+4,E-4,d,x,S,A);else if(L!==2){this._onError(u.default.FORMAT_ERROR,"Flv: Invalid video packet type "+L);return}},g.prototype._parseAVCDecoderConfigurationRecord=function(c,v,E){if(E<7){h.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var d=this._videoMetadata,x=this._videoTrack,S=this._littleEndian,T=new DataView(c,v,E);d?typeof d.avcc!="undefined"&&h.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),d=this._videoMetadata={},d.type="video",d.id=x.id,d.timescale=this._timescale,d.duration=this._duration);var w=T.getUint8(0),L=T.getUint8(1);if(T.getUint8(2),T.getUint8(3),w!==1||L===0){this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(T.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(u.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var I=T.getUint8(5)&31;if(I===0){this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else I>1&&h.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+I);for(var A=6,O=0;O<I;O++){var D=T.getUint16(A,!S);if(A+=2,D!==0){var R=new Uint8Array(c,v+A,D);A+=D;var C=l.default.parseSPS(R);if(O===0){d.codecWidth=C.codec_size.width,d.codecHeight=C.codec_size.height,d.presentWidth=C.present_size.width,d.presentHeight=C.present_size.height,d.profile=C.profile_string,d.level=C.level_string,d.bitDepth=C.bit_depth,d.chromaFormat=C.chroma_format,d.sarRatio=C.sar_ratio,d.frameRate=C.frame_rate,(C.frame_rate.fixed===!1||C.frame_rate.fps_num===0||C.frame_rate.fps_den===0)&&(d.frameRate=this._referenceFrameRate);var P=d.frameRate.fps_den,M=d.frameRate.fps_num;d.refSampleDuration=d.timescale*(P/M);for(var N=R.subarray(1,4),B="avc1.",U=0;U<3;U++){var F=N[U].toString(16);F.length<2&&(F="0"+F),B+=F}d.codec=B;var j=this._mediaInfo;j.width=d.codecWidth,j.height=d.codecHeight,j.fps=d.frameRate.fps,j.profile=d.profile,j.level=d.level,j.refFrames=C.ref_frames,j.chromaFormat=C.chroma_format_string,j.sarNum=d.sarRatio.width,j.sarDen=d.sarRatio.height,j.videoCodec=B,j.hasAudio?j.audioCodec!=null&&(j.mimeType='video/x-flv; codecs="'+j.videoCodec+","+j.audioCodec+'"'):j.mimeType='video/x-flv; codecs="'+j.videoCodec+'"',j.isComplete()&&this._onMediaInfo(j)}}}var $=T.getUint8(A);if($===0){this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else $>1&&h.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+$);A++;for(var O=0;O<$;O++){var D=T.getUint16(A,!S);A+=2,D!==0&&(A+=D)}d.avcc=new Uint8Array(E),d.avcc.set(new Uint8Array(c,v,E),0),h.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",d)},g.prototype._parseAVCVideoData=function(c,v,E,d,x,S,T){for(var w=this._littleEndian,L=new DataView(c,v,E),I=[],A=0,O=0,D=this._naluLengthSize,R=this._timestampBase+d,C=S===1;O<E;){if(O+4>=E){h.default.w(this.TAG,"Malformed Nalu near timestamp "+R+", offset = "+O+", dataSize = "+E);break}var P=L.getUint32(O,!w);if(D===3&&(P>>>=8),P>E-D){h.default.w(this.TAG,"Malformed Nalus near timestamp "+R+", NaluSize > DataSize!");return}var M=L.getUint8(O+D)&31;M===5&&(C=!0);var N=new Uint8Array(c,v+O,D+P),B={type:M,data:N};I.push(B),A+=N.byteLength,O+=D+P}if(I.length){var U=this._videoTrack,F={units:I,length:A,isKeyframe:C,dts:R,cts:T,pts:R+T};C&&(F.fileposition=x),U.samples.push(F),U.length+=A}},g}();o.default=_},"./src/demux/sps-parser.js":function(a,o,f){f.r(o);var h=f("./src/demux/exp-golomb.js"),p=function(){function l(){}return l._ebsp2rbsp=function(u){for(var m=u,y=m.byteLength,b=new Uint8Array(y),_=0,g=0;g<y;g++)g>=2&&m[g]===3&&m[g-1]===0&&m[g-2]===0||(b[_]=m[g],_++);return new Uint8Array(b.buffer,0,_)},l.parseSPS=function(u){var m=l._ebsp2rbsp(u),y=new h.default(m);y.readByte();var b=y.readByte();y.readByte();var _=y.readByte();y.readUEG();var g=l.getProfileString(b),c=l.getLevelString(_),v=1,E=420,d=[0,420,422,444],x=8;if((b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128||b===138||b===144)&&(v=y.readUEG(),v===3&&y.readBits(1),v<=3&&(E=d[v]),x=y.readUEG()+8,y.readUEG(),y.readBits(1),y.readBool()))for(var S=v!==3?8:12,T=0;T<S;T++)y.readBool()&&(T<6?l._skipScalingList(y,16):l._skipScalingList(y,64));y.readUEG();var w=y.readUEG();if(w===0)y.readUEG();else if(w===1){y.readBits(1),y.readSEG(),y.readSEG();for(var L=y.readUEG(),T=0;T<L;T++)y.readSEG()}var I=y.readUEG();y.readBits(1);var A=y.readUEG(),O=y.readUEG(),D=y.readBits(1);D===0&&y.readBits(1),y.readBits(1);var R=0,C=0,P=0,M=0,N=y.readBool();N&&(R=y.readUEG(),C=y.readUEG(),P=y.readUEG(),M=y.readUEG());var B=1,U=1,F=0,j=!0,$=0,G=0,Y=y.readBool();if(Y){if(y.readBool()){var X=y.readByte(),ie=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],pe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];X>0&&X<16?(B=ie[X-1],U=pe[X-1]):X===255&&(B=y.readByte()<<8|y.readByte(),U=y.readByte()<<8|y.readByte())}if(y.readBool()&&y.readBool(),y.readBool()&&(y.readBits(4),y.readBool()&&y.readBits(24)),y.readBool()&&(y.readUEG(),y.readUEG()),y.readBool()){var ue=y.readBits(32),we=y.readBits(32);j=y.readBool(),$=we,G=ue*2,F=$/G}}var de=1;(B!==1||U!==1)&&(de=B/U);var oe=0,De=0;if(v===0)oe=1,De=2-D;else{var Ce=v===3?1:2,Ue=v===1?2:1;oe=Ce,De=Ue*(2-D)}var Me=(A+1)*16,ze=(2-D)*((O+1)*16);Me-=(R+C)*oe,ze-=(P+M)*De;var Ge=Math.ceil(Me*de);return y.destroy(),y=null,{profile_string:g,level_string:c,bit_depth:x,ref_frames:I,chroma_format:E,chroma_format_string:l.getChromaFormatString(E),frame_rate:{fixed:j,fps:F,fps_den:G,fps_num:$},sar_ratio:{width:B,height:U},codec_size:{width:Me,height:ze},present_size:{width:Ge,height:ze}}},l._skipScalingList=function(u,m){for(var y=8,b=8,_=0,g=0;g<m;g++)b!==0&&(_=u.readSEG(),b=(y+_+256)%256),y=b===0?y:b},l.getProfileString=function(u){switch(u){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},l.getLevelString=function(u){return(u/10).toFixed(1)},l.getChromaFormatString=function(u){switch(u){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},l}();o.default=p},"./src/flv.js":function(a,o,f){f.r(o);var h=f("./src/utils/polyfill.js"),p=f("./src/core/features.js"),l=f("./src/io/loader.js"),u=f("./src/player/flv-player.js"),m=f("./src/player/native-player.js"),y=f("./src/player/player-events.js"),b=f("./src/player/player-errors.js"),_=f("./src/utils/logging-control.js"),g=f("./src/utils/exception.js");h.default.install();function c(x,S){var T=x;if(T==null||typeof T!="object")throw new g.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!T.hasOwnProperty("type"))throw new g.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(T.type){case"flv":return new u.default(T,S);default:return new m.default(T,S)}}function v(){return p.default.supportMSEH264Playback()}function E(){return p.default.getFeatureList()}var d={};d.createPlayer=c,d.isSupported=v,d.getFeatureList=E,d.BaseLoader=l.BaseLoader,d.LoaderStatus=l.LoaderStatus,d.LoaderErrors=l.LoaderErrors,d.Events=y.default,d.ErrorTypes=b.ErrorTypes,d.ErrorDetails=b.ErrorDetails,d.FlvPlayer=u.default,d.NativePlayer=m.default,d.LoggingControl=_.default,Object.defineProperty(d,"version",{enumerable:!0,get:function(){return"1.6.2"}}),o.default=d},"./src/index.js":function(a,o,f){a.exports=f("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(a,o,f){f.r(o);var h=f("./src/utils/browser.js"),p=f("./src/io/loader.js"),l=f("./src/utils/exception.js"),u=function(){var y=function(b,_){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,c){g.__proto__=c}||function(g,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(g[v]=c[v])},y(b,_)};return function(b,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");y(b,_);function g(){this.constructor=b}b.prototype=_===null?Object.create(_):(g.prototype=_.prototype,new g)}}(),m=function(y){u(b,y);function b(_,g){var c=y.call(this,"fetch-stream-loader")||this;return c.TAG="FetchStreamLoader",c._seekHandler=_,c._config=g,c._needStash=!0,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return b.isSupported=function(){try{var _=h.default.msedge&&h.default.version.minor>=15048,g=h.default.msedge?_:!0;return self.fetch&&self.ReadableStream&&g}catch(c){return!1}},b.prototype.destroy=function(){this.isWorking()&&this.abort(),y.prototype.destroy.call(this)},b.prototype.open=function(_,g){var c=this;this._dataSource=_,this._range=g;var v=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(v=_.redirectedURL);var E=this._seekHandler.getConfig(v,g),d=new self.Headers;if(typeof E.headers=="object"){var x=E.headers;for(var S in x)x.hasOwnProperty(S)&&d.append(S,x[S])}var T={method:"GET",headers:d,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var S in this._config.headers)d.append(S,this._config.headers[S]);_.cors===!1&&(T.mode="same-origin"),_.withCredentials&&(T.credentials="include"),_.referrerPolicy&&(T.referrerPolicy=_.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,T.signal=this._abortController.signal),this._status=p.LoaderStatus.kConnecting,self.fetch(E.url,T).then(function(w){if(c._requestAbort){c._status=p.LoaderStatus.kIdle,w.body.cancel();return}if(w.ok&&w.status>=200&&w.status<=299){if(w.url!==E.url&&c._onURLRedirect){var L=c._seekHandler.removeURLParameters(w.url);c._onURLRedirect(L)}var I=w.headers.get("Content-Length");return I!=null&&(c._contentLength=parseInt(I),c._contentLength!==0&&c._onContentLengthKnown&&c._onContentLengthKnown(c._contentLength)),c._pump.call(c,w.body.getReader())}else if(c._status=p.LoaderStatus.kError,c._onError)c._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:w.status,msg:w.statusText});else throw new l.RuntimeException("FetchStreamLoader: Http code invalid, "+w.status+" "+w.statusText)}).catch(function(w){if(!(c._abortController&&c._abortController.signal.aborted))if(c._status=p.LoaderStatus.kError,c._onError)c._onError(p.LoaderErrors.EXCEPTION,{code:-1,msg:w.message});else throw w})},b.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==p.LoaderStatus.kBuffering||!h.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(_){}},b.prototype._pump=function(_){var g=this;return _.read().then(function(c){if(c.done)if(g._contentLength!==null&&g._receivedLength<g._contentLength){g._status=p.LoaderStatus.kError;var v=p.LoaderErrors.EARLY_EOF,E={code:-1,msg:"Fetch stream meet Early-EOF"};if(g._onError)g._onError(v,E);else throw new l.RuntimeException(E.msg)}else g._status=p.LoaderStatus.kComplete,g._onComplete&&g._onComplete(g._range.from,g._range.from+g._receivedLength-1);else{if(g._abortController&&g._abortController.signal.aborted){g._status=p.LoaderStatus.kComplete;return}else if(g._requestAbort===!0)return g._status=p.LoaderStatus.kComplete,_.cancel();g._status=p.LoaderStatus.kBuffering;var d=c.value.buffer,x=g._range.from+g._receivedLength;g._receivedLength+=d.byteLength,g._onDataArrival&&g._onDataArrival(d,x,g._receivedLength),g._pump(_)}}).catch(function(c){if(g._abortController&&g._abortController.signal.aborted){g._status=p.LoaderStatus.kComplete;return}if(!(c.code===11&&h.default.msedge)){g._status=p.LoaderStatus.kError;var v=0,E=null;if((c.code===19||c.message==="network error")&&(g._contentLength===null||g._contentLength!==null&&g._receivedLength<g._contentLength)?(v=p.LoaderErrors.EARLY_EOF,E={code:c.code,msg:"Fetch stream meet Early-EOF"}):(v=p.LoaderErrors.EXCEPTION,E={code:c.code,msg:c.message}),g._onError)g._onError(v,E);else throw new l.RuntimeException(E.msg)}})},b}(p.BaseLoader);o.default=m},"./src/io/io-controller.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/io/speed-sampler.js"),l=f("./src/io/loader.js"),u=f("./src/io/fetch-stream-loader.js"),m=f("./src/io/xhr-moz-chunked-loader.js"),y=f("./src/io/xhr-range-loader.js"),b=f("./src/io/websocket-loader.js"),_=f("./src/io/range-seek-handler.js"),g=f("./src/io/param-seek-handler.js"),c=f("./src/utils/exception.js"),v=function(){function E(d,x,S){this.TAG="IOController",this._config=x,this._extraData=S,this._stashInitialSize=1024*384,x.stashInitialSize!=null&&x.stashInitialSize>0&&(this._stashInitialSize=x.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,x.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=d,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(d.url),this._refTotalLength=d.filesize?d.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return E.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},E.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},E.prototype.isPaused=function(){return this._paused},Object.defineProperty(E.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"extraData",{get:function(){return this._extraData},set:function(d){this._extraData=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(d){this._onDataArrival=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(d){this._onSeeked=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onError",{get:function(){return this._onError},set:function(d){this._onError=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onComplete",{get:function(){return this._onComplete},set:function(d){this._onComplete=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(d){this._onRedirect=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(d){this._onRecoveredEarlyEof=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"currentSpeed",{get:function(){return this._loaderClass===y.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),E.prototype._selectSeekHandler=function(){var d=this._config;if(d.seekType==="range")this._seekHandler=new _.default(this._config.rangeLoadZeroStart);else if(d.seekType==="param"){var x=d.seekParamStart||"bstart",S=d.seekParamEnd||"bend";this._seekHandler=new g.default(x,S)}else if(d.seekType==="custom"){if(typeof d.customSeekHandler!="function")throw new c.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new d.customSeekHandler}else throw new c.InvalidArgumentException("Invalid seekType in config: "+d.seekType)},E.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=b.default;else if(u.default.isSupported())this._loaderClass=u.default;else if(m.default.isSupported())this._loaderClass=m.default;else if(y.default.isSupported())this._loaderClass=y.default;else throw new c.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},E.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},E.prototype.open=function(d){this._currentRange={from:0,to:-1},d&&(this._currentRange.from=d),this._speedSampler.reset(),d||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},E.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},E.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},E.prototype.resume=function(){if(this._paused){this._paused=!1;var d=this._resumeFrom;this._resumeFrom=0,this._internalSeek(d,!0)}},E.prototype.seek=function(d){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(d,!0)},E.prototype._internalSeek=function(d,x){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(x),this._loader.destroy(),this._loader=null;var S={from:d,to:-1};this._currentRange={from:S.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,S),this._onSeeked&&this._onSeeked()},E.prototype.updateUrl=function(d){if(!d||typeof d!="string"||d.length===0)throw new c.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=d},E.prototype._expandBuffer=function(d){for(var x=this._stashSize;x+1024*1024*1<d;)x*=2;if(x+=1024*1024*1,x!==this._bufferSize){var S=new ArrayBuffer(x);if(this._stashUsed>0){var T=new Uint8Array(this._stashBuffer,0,this._stashUsed),w=new Uint8Array(S,0,x);w.set(T,0)}this._stashBuffer=S,this._bufferSize=x}},E.prototype._normalizeSpeed=function(d){var x=this._speedNormalizeList,S=x.length-1,T=0,w=0,L=S;if(d<x[0])return x[0];for(;w<=L;){if(T=w+Math.floor((L-w)/2),T===S||d>=x[T]&&d<x[T+1])return x[T];x[T]<d?w=T+1:L=T-1}},E.prototype._adjustStashSize=function(d){var x=0;this._config.isLive||d<512?x=d:d>=512&&d<=1024?x=Math.floor(d*1.5):x=d*2,x>8192&&(x=8192);var S=x*1024+1024*1024*1;this._bufferSize<S&&this._expandBuffer(S),this._stashSize=x*1024},E.prototype._dispatchChunks=function(d,x){return this._currentRange.to=x+d.byteLength-1,this._onDataArrival(d,x)},E.prototype._onURLRedirect=function(d){this._redirectedURL=d,this._onRedirect&&this._onRedirect(d)},E.prototype._onContentLengthKnown=function(d){d&&this._fullRequestFlag&&(this._totalLength=d,this._fullRequestFlag=!1)},E.prototype._onLoaderChunkArrival=function(d,x,S){if(!this._onDataArrival)throw new c.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(d.byteLength);var T=this._speedSampler.lastSecondKBps;if(T!==0){var w=this._normalizeSpeed(T);this._speedNormalized!==w&&(this._speedNormalized=w,this._adjustStashSize(w))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=x),this._stashUsed+d.byteLength<=this._stashSize){var A=new Uint8Array(this._stashBuffer,0,this._stashSize);A.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength}else{var A=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var D=this._stashBuffer.slice(0,this._stashUsed),L=this._dispatchChunks(D,this._stashByteStart);if(L<D.byteLength){if(L>0){var O=new Uint8Array(D,L);A.set(O,0),this._stashUsed=O.byteLength,this._stashByteStart+=L}}else this._stashUsed=0,this._stashByteStart+=L;this._stashUsed+d.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+d.byteLength),A=new Uint8Array(this._stashBuffer,0,this._bufferSize)),A.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength}else{var L=this._dispatchChunks(d,x);if(L<d.byteLength){var I=d.byteLength-L;I>this._bufferSize&&(this._expandBuffer(I),A=new Uint8Array(this._stashBuffer,0,this._bufferSize)),A.set(new Uint8Array(d,L),0),this._stashUsed+=I,this._stashByteStart=x+L}}}else if(this._stashUsed===0){var L=this._dispatchChunks(d,x);if(L<d.byteLength){var I=d.byteLength-L;I>this._bufferSize&&this._expandBuffer(I);var A=new Uint8Array(this._stashBuffer,0,this._bufferSize);A.set(new Uint8Array(d,L),0),this._stashUsed+=I,this._stashByteStart=x+L}}else{this._stashUsed+d.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+d.byteLength);var A=new Uint8Array(this._stashBuffer,0,this._bufferSize);A.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength;var L=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(L<this._stashUsed&&L>0){var O=new Uint8Array(this._stashBuffer,L);A.set(O,0)}this._stashUsed-=L,this._stashByteStart+=L}}},E.prototype._flushStashBuffer=function(d){if(this._stashUsed>0){var x=this._stashBuffer.slice(0,this._stashUsed),S=this._dispatchChunks(x,this._stashByteStart),T=x.byteLength-S;if(S<x.byteLength)if(d)h.default.w(this.TAG,T+" bytes unconsumed data remain when flush buffer, dropped");else{if(S>0){var w=new Uint8Array(this._stashBuffer,0,this._bufferSize),L=new Uint8Array(x,S);w.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=S}return 0}return this._stashUsed=0,this._stashByteStart=0,T}return 0},E.prototype._onLoaderComplete=function(d,x){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},E.prototype._onLoaderError=function(d,x){switch(h.default.e(this.TAG,"Loader error, code = "+x.code+", msg = "+x.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,d=l.LoaderErrors.UNRECOVERABLE_EARLY_EOF),d){case l.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var S=this._currentRange.to+1;S<this._totalLength&&(h.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(S,!1));return}d=l.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case l.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case l.LoaderErrors.CONNECTING_TIMEOUT:case l.LoaderErrors.HTTP_STATUS_CODE_INVALID:case l.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(d,x);else throw new c.RuntimeException("IOException: "+x.msg)},E}();o.default=v},"./src/io/loader.js":function(a,o,f){f.r(o),f.d(o,{LoaderStatus:function(){return p},LoaderErrors:function(){return l},BaseLoader:function(){return u}});var h=f("./src/utils/exception.js"),p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},l={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},u=function(){function m(y){this._type=y||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return m.prototype.destroy=function(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},m.prototype.isWorking=function(){return this._status===p.kConnecting||this._status===p.kBuffering},Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(y){this._onContentLengthKnown=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(y){this._onURLRedirect=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(y){this._onDataArrival=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onError",{get:function(){return this._onError},set:function(y){this._onError=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onComplete",{get:function(){return this._onComplete},set:function(y){this._onComplete=y},enumerable:!1,configurable:!0}),m.prototype.open=function(y,b){throw new h.NotImplementedException("Unimplemented abstract function!")},m.prototype.abort=function(){throw new h.NotImplementedException("Unimplemented abstract function!")},m}()},"./src/io/param-seek-handler.js":function(a,o,f){f.r(o);var h=function(){function p(l,u){this._startName=l,this._endName=u}return p.prototype.getConfig=function(l,u){var m=l;if(u.from!==0||u.to!==-1){var y=!0;m.indexOf("?")===-1&&(m+="?",y=!1),y&&(m+="&"),m+=this._startName+"="+u.from.toString(),u.to!==-1&&(m+="&"+this._endName+"="+u.to.toString())}return{url:m,headers:{}}},p.prototype.removeURLParameters=function(l){var u=l.split("?")[0],m=void 0,y=l.indexOf("?");y!==-1&&(m=l.substring(y+1));var b="";if(m!=null&&m.length>0)for(var _=m.split("&"),g=0;g<_.length;g++){var c=_[g].split("="),v=g>0;c[0]!==this._startName&&c[0]!==this._endName&&(v&&(b+="&"),b+=_[g])}return b.length===0?u:u+"?"+b},p}();o.default=h},"./src/io/range-seek-handler.js":function(a,o,f){f.r(o);var h=function(){function p(l){this._zeroStart=l||!1}return p.prototype.getConfig=function(l,u){var m={};if(u.from!==0||u.to!==-1){var y=void 0;u.to!==-1?y="bytes="+u.from.toString()+"-"+u.to.toString():y="bytes="+u.from.toString()+"-",m.Range=y}else this._zeroStart&&(m.Range="bytes=0-");return{url:l,headers:m}},p.prototype.removeURLParameters=function(l){return l},p}();o.default=h},"./src/io/speed-sampler.js":function(a,o,f){f.r(o);var h=function(){function p(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return p.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},p.prototype.addBytes=function(l){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=l,this._totalBytes+=l):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=l,this._totalBytes+=l):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=l,this._totalBytes+=l,this._lastCheckpoint=this._now())},Object.defineProperty(p.prototype,"currentKBps",{get:function(){this.addBytes(0);var l=(this._now()-this._lastCheckpoint)/1e3;return l==0&&(l=1),this._intervalBytes/l/1024},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"averageKBps",{get:function(){var l=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/l/1024},enumerable:!1,configurable:!0}),p}();o.default=h},"./src/io/websocket-loader.js":function(a,o,f){f.r(o);var h=f("./src/io/loader.js"),p=f("./src/utils/exception.js"),l=function(){var m=function(y,b){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,g){_.__proto__=g}||function(_,g){for(var c in g)Object.prototype.hasOwnProperty.call(g,c)&&(_[c]=g[c])},m(y,b)};return function(y,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");m(y,b);function _(){this.constructor=y}y.prototype=b===null?Object.create(b):(_.prototype=b.prototype,new _)}}(),u=function(m){l(y,m);function y(){var b=m.call(this,"websocket-loader")||this;return b.TAG="WebSocketLoader",b._needStash=!0,b._ws=null,b._requestAbort=!1,b._receivedLength=0,b}return y.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(b){return!1}},y.prototype.destroy=function(){this._ws&&this.abort(),m.prototype.destroy.call(this)},y.prototype.open=function(b){try{var _=this._ws=new self.WebSocket(b.url);_.binaryType="arraybuffer",_.onopen=this._onWebSocketOpen.bind(this),_.onclose=this._onWebSocketClose.bind(this),_.onmessage=this._onWebSocketMessage.bind(this),_.onerror=this._onWebSocketError.bind(this),this._status=h.LoaderStatus.kConnecting}catch(c){this._status=h.LoaderStatus.kError;var g={code:c.code,msg:c.message};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,g);else throw new p.RuntimeException(g.msg)}},y.prototype.abort=function(){var b=this._ws;b&&(b.readyState===0||b.readyState===1)&&(this._requestAbort=!0,b.close()),this._ws=null,this._status=h.LoaderStatus.kComplete},y.prototype._onWebSocketOpen=function(b){this._status=h.LoaderStatus.kBuffering},y.prototype._onWebSocketClose=function(b){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=h.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},y.prototype._onWebSocketMessage=function(b){var _=this;if(b.data instanceof ArrayBuffer)this._dispatchArrayBuffer(b.data);else if(b.data instanceof Blob){var g=new FileReader;g.onload=function(){_._dispatchArrayBuffer(g.result)},g.readAsArrayBuffer(b.data)}else{this._status=h.LoaderStatus.kError;var c={code:-1,msg:"Unsupported WebSocket message type: "+b.data.constructor.name};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,c);else throw new p.RuntimeException(c.msg)}},y.prototype._dispatchArrayBuffer=function(b){var _=b,g=this._receivedLength;this._receivedLength+=_.byteLength,this._onDataArrival&&this._onDataArrival(_,g,this._receivedLength)},y.prototype._onWebSocketError=function(b){this._status=h.LoaderStatus.kError;var _={code:b.code,msg:b.message};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,_);else throw new p.RuntimeException(_.msg)},y}(h.BaseLoader);o.default=u},"./src/io/xhr-moz-chunked-loader.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/io/loader.js"),l=f("./src/utils/exception.js"),u=function(){var y=function(b,_){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,c){g.__proto__=c}||function(g,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(g[v]=c[v])},y(b,_)};return function(b,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");y(b,_);function g(){this.constructor=b}b.prototype=_===null?Object.create(_):(g.prototype=_.prototype,new g)}}(),m=function(y){u(b,y);function b(_,g){var c=y.call(this,"xhr-moz-chunked-loader")||this;return c.TAG="MozChunkedLoader",c._seekHandler=_,c._config=g,c._needStash=!0,c._xhr=null,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return b.isSupported=function(){try{var _=new XMLHttpRequest;return _.open("GET","https://example.com",!0),_.responseType="moz-chunked-arraybuffer",_.responseType==="moz-chunked-arraybuffer"}catch(g){return h.default.w("MozChunkedLoader",g.message),!1}},b.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),y.prototype.destroy.call(this)},b.prototype.open=function(_,g){this._dataSource=_,this._range=g;var c=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(c=_.redirectedURL);var v=this._seekHandler.getConfig(c,g);this._requestURL=v.url;var E=this._xhr=new XMLHttpRequest;if(E.open("GET",v.url,!0),E.responseType="moz-chunked-arraybuffer",E.onreadystatechange=this._onReadyStateChange.bind(this),E.onprogress=this._onProgress.bind(this),E.onloadend=this._onLoadEnd.bind(this),E.onerror=this._onXhrError.bind(this),_.withCredentials&&(E.withCredentials=!0),typeof v.headers=="object"){var d=v.headers;for(var x in d)d.hasOwnProperty(x)&&E.setRequestHeader(x,d[x])}if(typeof this._config.headers=="object"){var d=this._config.headers;for(var x in d)d.hasOwnProperty(x)&&E.setRequestHeader(x,d[x])}this._status=p.LoaderStatus.kConnecting,E.send()},b.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.LoaderStatus.kComplete},b.prototype._onReadyStateChange=function(_){var g=_.target;if(g.readyState===2){if(g.responseURL!=null&&g.responseURL!==this._requestURL&&this._onURLRedirect){var c=this._seekHandler.removeURLParameters(g.responseURL);this._onURLRedirect(c)}if(g.status!==0&&(g.status<200||g.status>299))if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:g.status,msg:g.statusText});else throw new l.RuntimeException("MozChunkedLoader: Http code invalid, "+g.status+" "+g.statusText);else this._status=p.LoaderStatus.kBuffering}},b.prototype._onProgress=function(_){if(this._status!==p.LoaderStatus.kError){this._contentLength===null&&_.total!==null&&_.total!==0&&(this._contentLength=_.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var g=_.target.response,c=this._range.from+this._receivedLength;this._receivedLength+=g.byteLength,this._onDataArrival&&this._onDataArrival(g,c,this._receivedLength)}},b.prototype._onLoadEnd=function(_){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===p.LoaderStatus.kError)return;this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},b.prototype._onXhrError=function(_){this._status=p.LoaderStatus.kError;var g=0,c=null;if(this._contentLength&&_.loaded<this._contentLength?(g=p.LoaderErrors.EARLY_EOF,c={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(g=p.LoaderErrors.EXCEPTION,c={code:-1,msg:_.constructor.name+" "+_.type}),this._onError)this._onError(g,c);else throw new l.RuntimeException(c.msg)},b}(p.BaseLoader);o.default=m},"./src/io/xhr-range-loader.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/io/speed-sampler.js"),l=f("./src/io/loader.js"),u=f("./src/utils/exception.js"),m=function(){var b=function(_,g){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,v){c.__proto__=v}||function(c,v){for(var E in v)Object.prototype.hasOwnProperty.call(v,E)&&(c[E]=v[E])},b(_,g)};return function(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");b(_,g);function c(){this.constructor=_}_.prototype=g===null?Object.create(g):(c.prototype=g.prototype,new c)}}(),y=function(b){m(_,b);function _(g,c){var v=b.call(this,"xhr-range-loader")||this;return v.TAG="RangeLoader",v._seekHandler=g,v._config=c,v._needStash=!1,v._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],v._currentChunkSizeKB=384,v._currentSpeedNormalized=0,v._zeroSpeedChunkCount=0,v._xhr=null,v._speedSampler=new p.default,v._requestAbort=!1,v._waitForTotalLength=!1,v._totalLengthReceived=!1,v._currentRequestURL=null,v._currentRedirectedURL=null,v._currentRequestRange=null,v._totalLength=null,v._contentLength=null,v._receivedLength=0,v._lastTimeLoaded=0,v}return _.isSupported=function(){try{var g=new XMLHttpRequest;return g.open("GET","https://example.com",!0),g.responseType="arraybuffer",g.responseType==="arraybuffer"}catch(c){return h.default.w("RangeLoader",c.message),!1}},_.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),b.prototype.destroy.call(this)},Object.defineProperty(_.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),_.prototype.open=function(g,c){this._dataSource=g,this._range=c,this._status=l.LoaderStatus.kConnecting;var v=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(v=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!v?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},_.prototype._openSubRange=function(){var g=this._currentChunkSizeKB*1024,c=this._range.from+this._receivedLength,v=c+g;this._contentLength!=null&&v-this._range.from>=this._contentLength&&(v=this._range.from+this._contentLength-1),this._currentRequestRange={from:c,to:v},this._internalOpen(this._dataSource,this._currentRequestRange)},_.prototype._internalOpen=function(g,c){this._lastTimeLoaded=0;var v=g.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?v=this._currentRedirectedURL:g.redirectedURL!=null&&(v=g.redirectedURL));var E=this._seekHandler.getConfig(v,c);this._currentRequestURL=E.url;var d=this._xhr=new XMLHttpRequest;if(d.open("GET",E.url,!0),d.responseType="arraybuffer",d.onreadystatechange=this._onReadyStateChange.bind(this),d.onprogress=this._onProgress.bind(this),d.onload=this._onLoad.bind(this),d.onerror=this._onXhrError.bind(this),g.withCredentials&&(d.withCredentials=!0),typeof E.headers=="object"){var x=E.headers;for(var S in x)x.hasOwnProperty(S)&&d.setRequestHeader(S,x[S])}if(typeof this._config.headers=="object"){var x=this._config.headers;for(var S in x)x.hasOwnProperty(S)&&d.setRequestHeader(S,x[S])}d.send()},_.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=l.LoaderStatus.kComplete},_.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},_.prototype._onReadyStateChange=function(g){var c=g.target;if(c.readyState===2){if(c.responseURL!=null){var v=this._seekHandler.removeURLParameters(c.responseURL);c.responseURL!==this._currentRequestURL&&v!==this._currentRedirectedURL&&(this._currentRedirectedURL=v,this._onURLRedirect&&this._onURLRedirect(v))}if(c.status>=200&&c.status<=299){if(this._waitForTotalLength)return;this._status=l.LoaderStatus.kBuffering}else if(this._status=l.LoaderStatus.kError,this._onError)this._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText});else throw new u.RuntimeException("RangeLoader: Http code invalid, "+c.status+" "+c.statusText)}},_.prototype._onProgress=function(g){if(this._status!==l.LoaderStatus.kError){if(this._contentLength===null){var c=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,c=!0;var v=g.total;this._internalAbort(),v!=null&v!==0&&(this._totalLength=v)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,c){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var E=g.loaded-this._lastTimeLoaded;this._lastTimeLoaded=g.loaded,this._speedSampler.addBytes(E)}},_.prototype._normalizeSpeed=function(g){var c=this._chunkSizeKBList,v=c.length-1,E=0,d=0,x=v;if(g<c[0])return c[0];for(;d<=x;){if(E=d+Math.floor((x-d)/2),E===v||g>=c[E]&&g<c[E+1])return c[E];c[E]<g?d=E+1:x=E-1}},_.prototype._onLoad=function(g){if(this._status!==l.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var c=this._speedSampler.lastSecondKBps;if(c===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(c=this._speedSampler.currentKBps)),c!==0){var v=this._normalizeSpeed(c);this._currentSpeedNormalized!==v&&(this._currentSpeedNormalized=v,this._currentChunkSizeKB=v)}var E=g.target.response,d=this._range.from+this._receivedLength;this._receivedLength+=E.byteLength;var x=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():x=!0,this._onDataArrival&&this._onDataArrival(E,d,this._receivedLength),x&&(this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},_.prototype._onXhrError=function(g){this._status=l.LoaderStatus.kError;var c=0,v=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(c=l.LoaderErrors.EARLY_EOF,v={code:-1,msg:"RangeLoader meet Early-Eof"}):(c=l.LoaderErrors.EXCEPTION,v={code:-1,msg:g.constructor.name+" "+g.type}),this._onError)this._onError(c,v);else throw new u.RuntimeException(v.msg)},_}(l.BaseLoader);o.default=y},"./src/player/flv-player.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./src/utils/logger.js"),u=f("./src/utils/browser.js"),m=f("./src/player/player-events.js"),y=f("./src/core/transmuxer.js"),b=f("./src/core/transmuxing-events.js"),_=f("./src/core/mse-controller.js"),g=f("./src/core/mse-events.js"),c=f("./src/player/player-errors.js"),v=f("./src/config.js"),E=f("./src/utils/exception.js"),d=function(){function x(S,T){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(p()),this._config=(0,v.createDefaultConfig)(),typeof T=="object"&&Object.assign(this._config,T),S.type.toLowerCase()!=="flv")throw new E.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");S.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=S,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var w=u.default.chrome&&(u.default.version.major<50||u.default.version.major===50&&u.default.version.build<2661);this._alwaysSeekKeyframe=!!(w||u.default.msedge||u.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return x.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},x.prototype.on=function(S,T){var w=this;S===m.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){w._emitter.emit(m.default.MEDIA_INFO,w.mediaInfo)}):S===m.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){w._emitter.emit(m.default.STATISTICS_INFO,w.statisticsInfo)}),this._emitter.addListener(S,T)},x.prototype.off=function(S,T){this._emitter.removeListener(S,T)},x.prototype.attachMediaElement=function(S){var T=this;if(this._mediaElement=S,S.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),S.addEventListener("seeking",this.e.onvSeeking),S.addEventListener("canplay",this.e.onvCanPlay),S.addEventListener("stalled",this.e.onvStalled),S.addEventListener("progress",this.e.onvProgress),this._msectl=new _.default(this._config),this._msectl.on(g.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(g.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(g.default.SOURCE_OPEN,function(){T._mseSourceOpened=!0,T._hasPendingLoad&&(T._hasPendingLoad=!1,T.load())}),this._msectl.on(g.default.ERROR,function(w){T._emitter.emit(m.default.ERROR,c.ErrorTypes.MEDIA_ERROR,c.ErrorDetails.MEDIA_MSE_ERROR,w)}),this._msectl.attachMediaElement(S),this._pendingSeekTime!=null)try{S.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(w){}},x.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},x.prototype.load=function(){var S=this;if(!this._mediaElement)throw new E.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new E.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new y.default(this._mediaDataSource,this._config),this._transmuxer.on(b.default.INIT_SEGMENT,function(T,w){S._msectl.appendInitSegment(w)}),this._transmuxer.on(b.default.MEDIA_SEGMENT,function(T,w){if(S._msectl.appendMediaSegment(w),S._config.lazyLoad&&!S._config.isLive){var L=S._mediaElement.currentTime;w.info.endDts>=(L+S._config.lazyLoadMaxDuration)*1e3&&S._progressChecker==null&&(l.default.v(S.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),S._suspendTransmuxer())}}),this._transmuxer.on(b.default.LOADING_COMPLETE,function(){S._msectl.endOfStream(),S._emitter.emit(m.default.LOADING_COMPLETE)}),this._transmuxer.on(b.default.RECOVERED_EARLY_EOF,function(){S._emitter.emit(m.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(b.default.IO_ERROR,function(T,w){S._emitter.emit(m.default.ERROR,c.ErrorTypes.NETWORK_ERROR,T,w)}),this._transmuxer.on(b.default.DEMUX_ERROR,function(T,w){S._emitter.emit(m.default.ERROR,c.ErrorTypes.MEDIA_ERROR,T,{code:-1,msg:w})}),this._transmuxer.on(b.default.MEDIA_INFO,function(T){S._mediaInfo=T,S._emitter.emit(m.default.MEDIA_INFO,Object.assign({},T))}),this._transmuxer.on(b.default.METADATA_ARRIVED,function(T){S._emitter.emit(m.default.METADATA_ARRIVED,T)}),this._transmuxer.on(b.default.SCRIPTDATA_ARRIVED,function(T){S._emitter.emit(m.default.SCRIPTDATA_ARRIVED,T)}),this._transmuxer.on(b.default.STATISTICS_INFO,function(T){S._statisticsInfo=S._fillStatisticsInfo(T),S._emitter.emit(m.default.STATISTICS_INFO,Object.assign({},S._statisticsInfo))}),this._transmuxer.on(b.default.RECOMMEND_SEEKPOINT,function(T){S._mediaElement&&!S._config.accurateSeek&&(S._requestSetTime=!0,S._mediaElement.currentTime=T/1e3)}),this._transmuxer.open()}},x.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},x.prototype.play=function(){return this._mediaElement.play()},x.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(x.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(S){this._mediaElement.volume=S},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(S){this._mediaElement.muted=S},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(S){this._mediaElement?this._internalSeek(S):this._pendingSeekTime=S},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),x.prototype._fillStatisticsInfo=function(S){if(S.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return S;var T=!0,w=0,L=0;if(this._mediaElement.getVideoPlaybackQuality){var I=this._mediaElement.getVideoPlaybackQuality();w=I.totalVideoFrames,L=I.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(w=this._mediaElement.webkitDecodedFrameCount,L=this._mediaElement.webkitDroppedFrameCount):T=!1;return T&&(S.decodedFrames=w,S.droppedFrames=L),S},x.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var S=this._mediaElement.buffered,T=this._mediaElement.currentTime,w=0,L=0;L<S.length;L++){var I=S.start(L),A=S.end(L);if(I<=T&&T<A){w=A;break}}w>=T+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(l.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},x.prototype._onmseBufferFull=function(){l.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},x.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},x.prototype._checkProgressAndResume=function(){for(var S=this._mediaElement.currentTime,T=this._mediaElement.buffered,w=!1,L=0;L<T.length;L++){var I=T.start(L),A=T.end(L);if(S>=I&&S<A){S>=A-this._config.lazyLoadRecoverDuration&&(w=!0);break}}w&&(window.clearInterval(this._progressChecker),this._progressChecker=null,w&&(l.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},x.prototype._isTimepointBuffered=function(S){for(var T=this._mediaElement.buffered,w=0;w<T.length;w++){var L=T.start(w),I=T.end(w);if(S>=L&&S<I)return!0}return!1},x.prototype._internalSeek=function(S){var T=this._isTimepointBuffered(S),w=!1,L=0;if(S<1&&this._mediaElement.buffered.length>0){var I=this._mediaElement.buffered.start(0);(I<1&&S<I||u.default.safari)&&(w=!0,L=u.default.safari?.1:I)}if(w)this._requestSetTime=!0,this._mediaElement.currentTime=L;else if(T){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=S;else{var A=this._msectl.getNearestKeyframe(Math.floor(S*1e3));this._requestSetTime=!0,A!=null?this._mediaElement.currentTime=A.dts/1e3:this._mediaElement.currentTime=S}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(S),this._transmuxer.seek(Math.floor(S*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=S)},x.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var S=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(S)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(S),this._transmuxer.seek(Math.floor(S*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=S))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},x.prototype._checkAndResumeStuckPlayback=function(S){var T=this._mediaElement;if(S||!this._receivedCanPlay||T.readyState<2){var w=T.buffered;w.length>0&&T.currentTime<w.start(0)&&(l.default.w(this.TAG,"Playback seems stuck at "+T.currentTime+", seek to "+w.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=w.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},x.prototype._onvLoadedMetadata=function(S){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},x.prototype._onvSeeking=function(S){var T=this._mediaElement.currentTime,w=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(T<1&&w.length>0){var L=w.start(0);if(L<1&&T<L||u.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=u.default.safari?.1:L;return}}if(this._isTimepointBuffered(T)){if(this._alwaysSeekKeyframe){var I=this._msectl.getNearestKeyframe(Math.floor(T*1e3));I!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=I.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:T,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},x.prototype._onvCanPlay=function(S){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},x.prototype._onvStalled=function(S){this._checkAndResumeStuckPlayback(!0)},x.prototype._onvProgress=function(S){this._checkAndResumeStuckPlayback()},x}();o.default=d},"./src/player/native-player.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./src/player/player-events.js"),u=f("./src/config.js"),m=f("./src/utils/exception.js"),y=function(){function b(_,g){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(p()),this._config=(0,u.createDefaultConfig)(),typeof g=="object"&&Object.assign(this._config,g),_.type.toLowerCase()==="flv")throw new m.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(_.hasOwnProperty("segments"))throw new m.InvalidArgumentException("NativePlayer("+_.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=_,this._mediaElement=null}return b.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},b.prototype.on=function(_,g){var c=this;_===l.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(l.default.MEDIA_INFO,c.mediaInfo)}):_===l.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(l.default.STATISTICS_INFO,c.statisticsInfo)}),this._emitter.addListener(_,g)},b.prototype.off=function(_,g){this._emitter.removeListener(_,g)},b.prototype.attachMediaElement=function(_){if(this._mediaElement=_,_.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{_.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(g){}},b.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},b.prototype.load=function(){if(!this._mediaElement)throw new m.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},b.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},b.prototype.play=function(){return this._mediaElement.play()},b.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(b.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(_){this._mediaElement.volume=_},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(_){this._mediaElement.muted=_},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(_){this._mediaElement?this._mediaElement.currentTime=_:this._pendingSeekTime=_},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"mediaInfo",{get:function(){var _=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",g={mimeType:_+this._mediaDataSource.type};return this._mediaElement&&(g.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(g.width=this._mediaElement.videoWidth,g.height=this._mediaElement.videoHeight)),g},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"statisticsInfo",{get:function(){var _={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return _;var g=!0,c=0,v=0;if(this._mediaElement.getVideoPlaybackQuality){var E=this._mediaElement.getVideoPlaybackQuality();c=E.totalVideoFrames,v=E.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(c=this._mediaElement.webkitDecodedFrameCount,v=this._mediaElement.webkitDroppedFrameCount):g=!1;return g&&(_.decodedFrames=c,_.droppedFrames=v),_},enumerable:!1,configurable:!0}),b.prototype._onvLoadedMetadata=function(_){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(l.default.MEDIA_INFO,this.mediaInfo)},b.prototype._reportStatisticsInfo=function(){this._emitter.emit(l.default.STATISTICS_INFO,this.statisticsInfo)},b}();o.default=y},"./src/player/player-errors.js":function(a,o,f){f.r(o),f.d(o,{ErrorTypes:function(){return l},ErrorDetails:function(){return u}});var h=f("./src/io/loader.js"),p=f("./src/demux/demux-errors.js"),l={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},u={NETWORK_EXCEPTION:h.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:h.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:h.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:h.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:p.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:p.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:p.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(a,o,f){f.r(o);var h={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};o.default=h},"./src/remux/aac-silent.js":function(a,o,f){f.r(o);var h=function(){function p(){}return p.getSilentFrame=function(l,u){if(l==="mp4a.40.2"){if(u===1)return new Uint8Array([0,200,0,128,35,128]);if(u===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(u===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(u===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(u===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(u===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(u===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(u===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(u===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},p}();o.default=h},"./src/remux/mp4-generator.js":function(a,o,f){f.r(o);var h=function(){function p(){}return p.init=function(){p.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var l in p.types)p.types.hasOwnProperty(l)&&(p.types[l]=[l.charCodeAt(0),l.charCodeAt(1),l.charCodeAt(2),l.charCodeAt(3)]);var u=p.constants={};u.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),u.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),u.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),u.STSC=u.STCO=u.STTS,u.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),u.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),u.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),u.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},p.box=function(l){for(var u=8,m=null,y=Array.prototype.slice.call(arguments,1),b=y.length,_=0;_<b;_++)u+=y[_].byteLength;m=new Uint8Array(u),m[0]=u>>>24&255,m[1]=u>>>16&255,m[2]=u>>>8&255,m[3]=u&255,m.set(l,4);for(var g=8,_=0;_<b;_++)m.set(y[_],g),g+=y[_].byteLength;return m},p.generateInitSegment=function(l){var u=p.box(p.types.ftyp,p.constants.FTYP),m=p.moov(l),y=new Uint8Array(u.byteLength+m.byteLength);return y.set(u,0),y.set(m,u.byteLength),y},p.moov=function(l){var u=p.mvhd(l.timescale,l.duration),m=p.trak(l),y=p.mvex(l);return p.box(p.types.moov,u,m,y)},p.mvhd=function(l,u){return p.box(p.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,l>>>24&255,l>>>16&255,l>>>8&255,l&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},p.trak=function(l){return p.box(p.types.trak,p.tkhd(l),p.mdia(l))},p.tkhd=function(l){var u=l.id,m=l.duration,y=l.presentWidth,b=l.presentHeight;return p.box(p.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,0,0,0,0,m>>>24&255,m>>>16&255,m>>>8&255,m&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,y>>>8&255,y&255,0,0,b>>>8&255,b&255,0,0]))},p.mdia=function(l){return p.box(p.types.mdia,p.mdhd(l),p.hdlr(l),p.minf(l))},p.mdhd=function(l){var u=l.timescale,m=l.duration;return p.box(p.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,85,196,0,0]))},p.hdlr=function(l){var u=null;return l.type==="audio"?u=p.constants.HDLR_AUDIO:u=p.constants.HDLR_VIDEO,p.box(p.types.hdlr,u)},p.minf=function(l){var u=null;return l.type==="audio"?u=p.box(p.types.smhd,p.constants.SMHD):u=p.box(p.types.vmhd,p.constants.VMHD),p.box(p.types.minf,u,p.dinf(),p.stbl(l))},p.dinf=function(){var l=p.box(p.types.dinf,p.box(p.types.dref,p.constants.DREF));return l},p.stbl=function(l){var u=p.box(p.types.stbl,p.stsd(l),p.box(p.types.stts,p.constants.STTS),p.box(p.types.stsc,p.constants.STSC),p.box(p.types.stsz,p.constants.STSZ),p.box(p.types.stco,p.constants.STCO));return u},p.stsd=function(l){return l.type==="audio"?l.codec==="mp3"?p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp3(l)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp4a(l)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.avc1(l))},p.mp3=function(l){var u=l.channelCount,m=l.audioSampleRate,y=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,u,0,16,0,0,0,0,m>>>8&255,m&255,0,0]);return p.box(p.types[".mp3"],y)},p.mp4a=function(l){var u=l.channelCount,m=l.audioSampleRate,y=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,u,0,16,0,0,0,0,m>>>8&255,m&255,0,0]);return p.box(p.types.mp4a,y,p.esds(l))},p.esds=function(l){var u=l.config||[],m=u.length,y=new Uint8Array([0,0,0,0,3,23+m,0,1,0,4,15+m,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([m]).concat(u).concat([6,1,2]));return p.box(p.types.esds,y)},p.avc1=function(l){var u=l.avcc,m=l.codecWidth,y=l.codecHeight,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>>8&255,m&255,y>>>8&255,y&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return p.box(p.types.avc1,b,p.box(p.types.avcC,u))},p.mvex=function(l){return p.box(p.types.mvex,p.trex(l))},p.trex=function(l){var u=l.id,m=new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return p.box(p.types.trex,m)},p.moof=function(l,u){return p.box(p.types.moof,p.mfhd(l.sequenceNumber),p.traf(l,u))},p.mfhd=function(l){var u=new Uint8Array([0,0,0,0,l>>>24&255,l>>>16&255,l>>>8&255,l&255]);return p.box(p.types.mfhd,u)},p.traf=function(l,u){var m=l.id,y=p.box(p.types.tfhd,new Uint8Array([0,0,0,0,m>>>24&255,m>>>16&255,m>>>8&255,m&255])),b=p.box(p.types.tfdt,new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255])),_=p.sdtp(l),g=p.trun(l,_.byteLength+16+16+8+16+8+8);return p.box(p.types.traf,y,b,g,_)},p.sdtp=function(l){for(var u=l.samples||[],m=u.length,y=new Uint8Array(4+m),b=0;b<m;b++){var _=u[b].flags;y[b+4]=_.isLeading<<6|_.dependsOn<<4|_.isDependedOn<<2|_.hasRedundancy}return p.box(p.types.sdtp,y)},p.trun=function(l,u){var m=l.samples||[],y=m.length,b=12+16*y,_=new Uint8Array(b);u+=8+b,_.set([0,0,15,1,y>>>24&255,y>>>16&255,y>>>8&255,y&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255],0);for(var g=0;g<y;g++){var c=m[g].duration,v=m[g].size,E=m[g].flags,d=m[g].cts;_.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,E.isLeading<<2|E.dependsOn,E.isDependedOn<<6|E.hasRedundancy<<4|E.isNonSync,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*g)}return p.box(p.types.trun,_)},p.mdat=function(l){return p.box(p.types.mdat,l)},p}();h.init(),o.default=h},"./src/remux/mp4-remuxer.js":function(a,o,f){f.r(o);var h=f("./src/utils/logger.js"),p=f("./src/remux/mp4-generator.js"),l=f("./src/remux/aac-silent.js"),u=f("./src/utils/browser.js"),m=f("./src/core/media-segment-info.js"),y=f("./src/utils/exception.js"),b=function(){function _(g){this.TAG="MP4Remuxer",this._config=g,this._isLive=g.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new m.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new m.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(u.default.chrome&&(u.default.version.major<50||u.default.version.major===50&&u.default.version.build<2661)),this._fillSilentAfterSeek=u.default.msedge||u.default.msie,this._mp3UseMpegAudio=!u.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return _.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},_.prototype.bindDataSource=function(g){return g.onDataAvailable=this.remux.bind(this),g.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(_.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(g){this._onInitSegment=g},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(g){this._onMediaSegment=g},enumerable:!1,configurable:!0}),_.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},_.prototype.seek=function(g){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},_.prototype.remux=function(g,c){if(!this._onMediaSegment)throw new y.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(g,c),this._remuxVideo(c),this._remuxAudio(g)},_.prototype._onTrackMetadataReceived=function(g,c){var v=null,E="mp4",d=c.codec;if(g==="audio")this._audioMeta=c,c.codec==="mp3"&&this._mp3UseMpegAudio?(E="mpeg",d="",v=new Uint8Array):v=p.default.generateInitSegment(c);else if(g==="video")this._videoMeta=c,v=p.default.generateInitSegment(c);else return;if(!this._onInitSegment)throw new y.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(g,{type:g,data:v.buffer,codec:d,container:g+"/"+E,mediaDuration:c.duration})},_.prototype._calculateDtsBase=function(g,c){this._dtsBaseInited||(g.samples&&g.samples.length&&(this._audioDtsBase=g.samples[0].dts),c.samples&&c.samples.length&&(this._videoDtsBase=c.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},_.prototype.flushStashedSamples=function(){var g=this._videoStashedLastSample,c=this._audioStashedLastSample,v={type:"video",id:1,sequenceNumber:0,samples:[],length:0};g!=null&&(v.samples.push(g),v.length=g.length);var E={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};c!=null&&(E.samples.push(c),E.length=c.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(v,!0),this._remuxAudio(E,!0)},_.prototype._remuxAudio=function(g,c){if(this._audioMeta!=null){var v=g,E=v.samples,d=void 0,x=-1,S=-1,T=this._audioMeta.refSampleDuration,w=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,L=this._dtsBaseInited&&this._audioNextDts===void 0,I=!1;if(!(!E||E.length===0)&&!(E.length===1&&!c)){var A=0,O=null,D=0;w?(A=0,D=v.length):(A=8,D=8+v.length);var R=null;if(E.length>1&&(R=E.pop(),D-=R.length),this._audioStashedLastSample!=null){var C=this._audioStashedLastSample;this._audioStashedLastSample=null,E.unshift(C),D+=C.length}R!=null&&(this._audioStashedLastSample=R);var P=E[0].dts-this._dtsBase;if(this._audioNextDts)d=P-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())d=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(I=!0);else{var M=this._audioSegmentInfoList.getLastSampleBefore(P);if(M!=null){var N=P-(M.originalDts+M.duration);N<=3&&(N=0);var B=M.dts+M.duration+N;d=P-B}else d=0}if(I){var U=P-d,F=this._videoSegmentInfoList.getLastSegmentBefore(P);if(F!=null&&F.beginDts<U){var j=l.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(j){var $=F.beginDts,G=U-F.beginDts;h.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+$+", duration: "+G),E.unshift({unit:j,dts:$,pts:$}),D+=j.byteLength}}else I=!1}for(var Y=[],X=0;X<E.length;X++){var C=E[X],ie=C.unit,pe=C.dts-this._dtsBase,$=pe,ue=!1,we=null,de=0;if(!(pe<-.001)){if(this._audioMeta.codec!=="mp3"){var oe=pe,De=3;if(this._audioNextDts&&(oe=this._audioNextDts),d=pe-oe,d<=-De*T){h.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+pe+" ms ,curRefDts: "+oe+" ms)  due to dtsCorrection: "+d+" ms overlap.");continue}else if(d>=De*T&&this._fillAudioTimestampGap&&!u.default.safari){ue=!0;var Ce=Math.floor(d/T);h.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+pe+" ms, curRefDts: "+oe+" ms, ")+("dtsCorrection: "+Math.round(d)+" ms, generate: "+Ce+" frames")),$=Math.floor(oe),de=Math.floor(oe+T)-$;var j=l.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);j==null&&(h.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),j=ie),we=[];for(var Ue=0;Ue<Ce;Ue++){oe=oe+T;var Me=Math.floor(oe),ze=Math.floor(oe+T)-Me,Ge={dts:Me,pts:Me,cts:0,unit:j,size:j.byteLength,duration:ze,originalDts:pe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};we.push(Ge),D+=Ge.size}this._audioNextDts=oe+T}else $=Math.floor(oe),de=Math.floor(oe+T)-$,this._audioNextDts=oe+T}else{if($=pe-d,X!==E.length-1){var Ke=E[X+1].dts-this._dtsBase-d;de=Ke-$}else if(R!=null){var Ke=R.dts-this._dtsBase-d;de=Ke-$}else Y.length>=1?de=Y[Y.length-1].duration:de=Math.floor(T);this._audioNextDts=$+de}x===-1&&(x=$),Y.push({dts:$,pts:$,cts:0,unit:C.unit,size:C.unit.byteLength,duration:de,originalDts:pe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),ue&&Y.push.apply(Y,we)}}if(Y.length===0){v.samples=[],v.length=0;return}w?O=new Uint8Array(D):(O=new Uint8Array(D),O[0]=D>>>24&255,O[1]=D>>>16&255,O[2]=D>>>8&255,O[3]=D&255,O.set(p.default.types.mdat,4));for(var X=0;X<Y.length;X++){var ie=Y[X].unit;O.set(ie,A),A+=ie.byteLength}var He=Y[Y.length-1];S=He.dts+He.duration;var Fe=new m.MediaSegmentInfo;Fe.beginDts=x,Fe.endDts=S,Fe.beginPts=x,Fe.endPts=S,Fe.originalBeginDts=Y[0].originalDts,Fe.originalEndDts=He.originalDts+He.duration,Fe.firstSample=new m.SampleInfo(Y[0].dts,Y[0].pts,Y[0].duration,Y[0].originalDts,!1),Fe.lastSample=new m.SampleInfo(He.dts,He.pts,He.duration,He.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Fe),v.samples=Y,v.sequenceNumber++;var Se=null;w?Se=new Uint8Array:Se=p.default.moof(v,x),v.samples=[],v.length=0;var Xe={type:"audio",data:this._mergeBoxes(Se,O).buffer,sampleCount:Y.length,info:Fe};w&&L&&(Xe.timestampOffset=x),this._onMediaSegment("audio",Xe)}}},_.prototype._remuxVideo=function(g,c){if(this._videoMeta!=null){var v=g,E=v.samples,d=void 0,x=-1,S=-1,T=-1,w=-1;if(!(!E||E.length===0)&&!(E.length===1&&!c)){var L=8,I=null,A=8+g.length,O=null;if(E.length>1&&(O=E.pop(),A-=O.length),this._videoStashedLastSample!=null){var D=this._videoStashedLastSample;this._videoStashedLastSample=null,E.unshift(D),A+=D.length}O!=null&&(this._videoStashedLastSample=O);var R=E[0].dts-this._dtsBase;if(this._videoNextDts)d=R-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())d=0;else{var C=this._videoSegmentInfoList.getLastSampleBefore(R);if(C!=null){var P=R-(C.originalDts+C.duration);P<=3&&(P=0);var M=C.dts+C.duration+P;d=R-M}else d=0}for(var N=new m.MediaSegmentInfo,B=[],U=0;U<E.length;U++){var D=E[U],F=D.dts-this._dtsBase,j=D.isKeyframe,$=F-d,G=D.cts,Y=$+G;x===-1&&(x=$,T=Y);var X=0;if(U!==E.length-1){var ie=E[U+1].dts-this._dtsBase-d;X=ie-$}else if(O!=null){var ie=O.dts-this._dtsBase-d;X=ie-$}else B.length>=1?X=B[B.length-1].duration:X=Math.floor(this._videoMeta.refSampleDuration);if(j){var pe=new m.SampleInfo($,Y,X,D.dts,!0);pe.fileposition=D.fileposition,N.appendSyncPoint(pe)}B.push({dts:$,pts:Y,cts:G,units:D.units,size:D.length,isKeyframe:j,duration:X,originalDts:F,flags:{isLeading:0,dependsOn:j?2:1,isDependedOn:j?1:0,hasRedundancy:0,isNonSync:j?0:1}})}I=new Uint8Array(A),I[0]=A>>>24&255,I[1]=A>>>16&255,I[2]=A>>>8&255,I[3]=A&255,I.set(p.default.types.mdat,4);for(var U=0;U<B.length;U++)for(var ue=B[U].units;ue.length;){var we=ue.shift(),de=we.data;I.set(de,L),L+=de.byteLength}var oe=B[B.length-1];if(S=oe.dts+oe.duration,w=oe.pts+oe.duration,this._videoNextDts=S,N.beginDts=x,N.endDts=S,N.beginPts=T,N.endPts=w,N.originalBeginDts=B[0].originalDts,N.originalEndDts=oe.originalDts+oe.duration,N.firstSample=new m.SampleInfo(B[0].dts,B[0].pts,B[0].duration,B[0].originalDts,B[0].isKeyframe),N.lastSample=new m.SampleInfo(oe.dts,oe.pts,oe.duration,oe.originalDts,oe.isKeyframe),this._isLive||this._videoSegmentInfoList.append(N),v.samples=B,v.sequenceNumber++,this._forceFirstIDR){var De=B[0].flags;De.dependsOn=2,De.isNonSync=0}var Ce=p.default.moof(v,x);v.samples=[],v.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ce,I).buffer,sampleCount:B.length,info:N})}}},_.prototype._mergeBoxes=function(g,c){var v=new Uint8Array(g.byteLength+c.byteLength);return v.set(g,0),v.set(c,g.byteLength),v},_}();o.default=b},"./src/utils/browser.js":function(a,o,f){f.r(o);var h={};function p(){var l=self.navigator.userAgent.toLowerCase(),u=/(edge)\/([\w.]+)/.exec(l)||/(opr)[\/]([\w.]+)/.exec(l)||/(chrome)[ \/]([\w.]+)/.exec(l)||/(iemobile)[\/]([\w.]+)/.exec(l)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(l)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(l)||/(webkit)[ \/]([\w.]+)/.exec(l)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(l)||/(msie) ([\w.]+)/.exec(l)||l.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(l)||l.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(l)||[],m=/(ipad)/.exec(l)||/(ipod)/.exec(l)||/(windows phone)/.exec(l)||/(iphone)/.exec(l)||/(kindle)/.exec(l)||/(android)/.exec(l)||/(windows)/.exec(l)||/(mac)/.exec(l)||/(linux)/.exec(l)||/(cros)/.exec(l)||[],y={browser:u[5]||u[3]||u[1]||"",version:u[2]||u[4]||"0",majorVersion:u[4]||u[2]||"0",platform:m[0]||""},b={};if(y.browser){b[y.browser]=!0;var _=y.majorVersion.split(".");b.version={major:parseInt(y.majorVersion,10),string:y.version},_.length>1&&(b.version.minor=parseInt(_[1],10)),_.length>2&&(b.version.build=parseInt(_[2],10))}if(y.platform&&(b[y.platform]=!0),(b.chrome||b.opr||b.safari)&&(b.webkit=!0),b.rv||b.iemobile){b.rv&&delete b.rv;var g="msie";y.browser=g,b[g]=!0}if(b.edge){delete b.edge;var c="msedge";y.browser=c,b[c]=!0}if(b.opr){var v="opera";y.browser=v,b[v]=!0}if(b.safari&&b.android){var E="android";y.browser=E,b[E]=!0}b.name=y.browser,b.platform=y.platform;for(var d in h)h.hasOwnProperty(d)&&delete h[d];Object.assign(h,b)}p(),o.default=h},"./src/utils/exception.js":function(a,o,f){f.r(o),f.d(o,{RuntimeException:function(){return p},IllegalStateException:function(){return l},InvalidArgumentException:function(){return u},NotImplementedException:function(){return m}});var h=function(){var y=function(b,_){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,c){g.__proto__=c}||function(g,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(g[v]=c[v])},y(b,_)};return function(b,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");y(b,_);function g(){this.constructor=b}b.prototype=_===null?Object.create(_):(g.prototype=_.prototype,new g)}}(),p=function(){function y(b){this._message=b}return Object.defineProperty(y.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),y.prototype.toString=function(){return this.name+": "+this.message},y}(),l=function(y){h(b,y);function b(_){return y.call(this,_)||this}return Object.defineProperty(b.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),b}(p),u=function(y){h(b,y);function b(_){return y.call(this,_)||this}return Object.defineProperty(b.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),b}(p),m=function(y){h(b,y);function b(_){return y.call(this,_)||this}return Object.defineProperty(b.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),b}(p)},"./src/utils/logger.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=function(){function u(){}return u.e=function(m,y){(!m||u.FORCE_GLOBAL_TAG)&&(m=u.GLOBAL_TAG);var b="["+m+"] > "+y;u.ENABLE_CALLBACK&&u.emitter.emit("log","error",b),!!u.ENABLE_ERROR&&(console.error?console.error(b):console.warn?console.warn(b):console.log(b))},u.i=function(m,y){(!m||u.FORCE_GLOBAL_TAG)&&(m=u.GLOBAL_TAG);var b="["+m+"] > "+y;u.ENABLE_CALLBACK&&u.emitter.emit("log","info",b),!!u.ENABLE_INFO&&(console.info?console.info(b):console.log(b))},u.w=function(m,y){(!m||u.FORCE_GLOBAL_TAG)&&(m=u.GLOBAL_TAG);var b="["+m+"] > "+y;u.ENABLE_CALLBACK&&u.emitter.emit("log","warn",b),!!u.ENABLE_WARN&&(console.warn?console.warn(b):console.log(b))},u.d=function(m,y){(!m||u.FORCE_GLOBAL_TAG)&&(m=u.GLOBAL_TAG);var b="["+m+"] > "+y;u.ENABLE_CALLBACK&&u.emitter.emit("log","debug",b),!!u.ENABLE_DEBUG&&(console.debug?console.debug(b):console.log(b))},u.v=function(m,y){(!m||u.FORCE_GLOBAL_TAG)&&(m=u.GLOBAL_TAG);var b="["+m+"] > "+y;u.ENABLE_CALLBACK&&u.emitter.emit("log","verbose",b),!!u.ENABLE_VERBOSE&&console.log(b)},u}();l.GLOBAL_TAG="flv.js",l.FORCE_GLOBAL_TAG=!1,l.ENABLE_ERROR=!0,l.ENABLE_INFO=!0,l.ENABLE_WARN=!0,l.ENABLE_DEBUG=!0,l.ENABLE_VERBOSE=!0,l.ENABLE_CALLBACK=!1,l.emitter=new(p()),o.default=l},"./src/utils/logging-control.js":function(a,o,f){f.r(o);var h=f("./node_modules/events/events.js"),p=f.n(h),l=f("./src/utils/logger.js"),u=function(){function m(){}return Object.defineProperty(m,"forceGlobalTag",{get:function(){return l.default.FORCE_GLOBAL_TAG},set:function(y){l.default.FORCE_GLOBAL_TAG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"globalTag",{get:function(){return l.default.GLOBAL_TAG},set:function(y){l.default.GLOBAL_TAG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableAll",{get:function(){return l.default.ENABLE_VERBOSE&&l.default.ENABLE_DEBUG&&l.default.ENABLE_INFO&&l.default.ENABLE_WARN&&l.default.ENABLE_ERROR},set:function(y){l.default.ENABLE_VERBOSE=y,l.default.ENABLE_DEBUG=y,l.default.ENABLE_INFO=y,l.default.ENABLE_WARN=y,l.default.ENABLE_ERROR=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableDebug",{get:function(){return l.default.ENABLE_DEBUG},set:function(y){l.default.ENABLE_DEBUG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableVerbose",{get:function(){return l.default.ENABLE_VERBOSE},set:function(y){l.default.ENABLE_VERBOSE=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableInfo",{get:function(){return l.default.ENABLE_INFO},set:function(y){l.default.ENABLE_INFO=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableWarn",{get:function(){return l.default.ENABLE_WARN},set:function(y){l.default.ENABLE_WARN=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableError",{get:function(){return l.default.ENABLE_ERROR},set:function(y){l.default.ENABLE_ERROR=y,m._notifyChange()},enumerable:!1,configurable:!0}),m.getConfig=function(){return{globalTag:l.default.GLOBAL_TAG,forceGlobalTag:l.default.FORCE_GLOBAL_TAG,enableVerbose:l.default.ENABLE_VERBOSE,enableDebug:l.default.ENABLE_DEBUG,enableInfo:l.default.ENABLE_INFO,enableWarn:l.default.ENABLE_WARN,enableError:l.default.ENABLE_ERROR,enableCallback:l.default.ENABLE_CALLBACK}},m.applyConfig=function(y){l.default.GLOBAL_TAG=y.globalTag,l.default.FORCE_GLOBAL_TAG=y.forceGlobalTag,l.default.ENABLE_VERBOSE=y.enableVerbose,l.default.ENABLE_DEBUG=y.enableDebug,l.default.ENABLE_INFO=y.enableInfo,l.default.ENABLE_WARN=y.enableWarn,l.default.ENABLE_ERROR=y.enableError,l.default.ENABLE_CALLBACK=y.enableCallback},m._notifyChange=function(){var y=m.emitter;if(y.listenerCount("change")>0){var b=m.getConfig();y.emit("change",b)}},m.registerListener=function(y){m.emitter.addListener("change",y)},m.removeListener=function(y){m.emitter.removeListener("change",y)},m.addLogListener=function(y){l.default.emitter.addListener("log",y),l.default.emitter.listenerCount("log")>0&&(l.default.ENABLE_CALLBACK=!0,m._notifyChange())},m.removeLogListener=function(y){l.default.emitter.removeListener("log",y),l.default.emitter.listenerCount("log")===0&&(l.default.ENABLE_CALLBACK=!1,m._notifyChange())},m}();u.emitter=new(p()),o.default=u},"./src/utils/polyfill.js":function(a,o,f){f.r(o);var h=function(){function p(){}return p.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(l,u){return l.__proto__=u,l},Object.assign=Object.assign||function(l){if(l==null)throw new TypeError("Cannot convert undefined or null to object");for(var u=Object(l),m=1;m<arguments.length;m++){var y=arguments[m];if(y!=null)for(var b in y)y.hasOwnProperty(b)&&(u[b]=y[b])}return u},typeof self.Promise!="function"&&f("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},p}();h.install(),o.default=h},"./src/utils/utf8-conv.js":function(a,o,f){f.r(o);function h(l,u,m){var y=l;if(u+m<y.length){for(;m--;)if((y[++u]&192)!=128)return!1;return!0}else return!1}function p(l){for(var u=[],m=l,y=0,b=l.length;y<b;){if(m[y]<128){u.push(String.fromCharCode(m[y])),++y;continue}else if(!(m[y]<192)){if(m[y]<224){if(h(m,y,1)){var _=(m[y]&31)<<6|m[y+1]&63;if(_>=128){u.push(String.fromCharCode(_&65535)),y+=2;continue}}}else if(m[y]<240){if(h(m,y,2)){var _=(m[y]&15)<<12|(m[y+1]&63)<<6|m[y+2]&63;if(_>=2048&&(_&63488)!=55296){u.push(String.fromCharCode(_&65535)),y+=3;continue}}}else if(m[y]<248&&h(m,y,3)){var _=(m[y]&7)<<18|(m[y+1]&63)<<12|(m[y+2]&63)<<6|m[y+3]&63;if(_>65536&&_<1114112){_-=65536,u.push(String.fromCharCode(_>>>10|55296)),u.push(String.fromCharCode(_&1023|56320)),y+=4;continue}}}u.push(String.fromCharCode(65533)),++y}return u.join("")}o.default=p}},i={};function t(a){var o=i[a];if(o!==void 0)return o.exports;var f=i[a]={exports:{}};return r[a].call(f.exports,f,f.exports,t),f.exports}t.m=r,function(){t.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(o,{a:o}),o}}(),function(){t.d=function(a,o){for(var f in o)t.o(o,f)&&!t.o(a,f)&&Object.defineProperty(a,f,{enumerable:!0,get:o[f]})}}(),function(){t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(a){if(typeof window=="object")return window}}()}(),function(){t.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)}}(),function(){t.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}();var n=t("./src/index.js");return n}()})})(Ih);var NS=Ca(Ih.exports);const La=typeof window!="undefined"?window.navigator.userAgent:"",FS=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(La);/^((?!chrome|android).)*safari/i.test(La);/MicroMessenger/i.test(La);/MSIE|Trident/i.test(La);var Rh={exports:{}};(function(s,e){typeof window!="undefined"&&function(i,t){s.exports=t()}(Mt,function(){return function(r){var i={};function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=r,t.c=i,t.d=function(n,a,o){t.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:o})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,a){if(a&1&&(n=t(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var f in n)t.d(o,f,function(h){return n[h]}.bind(null,f));return o},t.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(a,"a",a),a},t.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},t.p="/dist/",t(t.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(r,i,t){var n=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function f(u,m,y){this.fn=u,this.context=m,this.once=y||!1}function h(u,m,y,b,_){if(typeof y!="function")throw new TypeError("The listener must be a function");var g=new f(y,b||u,_),c=a?a+m:m;return u._events[c]?u._events[c].fn?u._events[c]=[u._events[c],g]:u._events[c].push(g):(u._events[c]=g,u._eventsCount++),u}function p(u,m){--u._eventsCount==0?u._events=new o:delete u._events[m]}function l(){this._events=new o,this._eventsCount=0}l.prototype.eventNames=function(){var m=[],y,b;if(this._eventsCount===0)return m;for(b in y=this._events)n.call(y,b)&&m.push(a?b.slice(1):b);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(y)):m},l.prototype.listeners=function(m){var y=a?a+m:m,b=this._events[y];if(!b)return[];if(b.fn)return[b.fn];for(var _=0,g=b.length,c=new Array(g);_<g;_++)c[_]=b[_].fn;return c},l.prototype.listenerCount=function(m){var y=a?a+m:m,b=this._events[y];return b?b.fn?1:b.length:0},l.prototype.emit=function(m,y,b,_,g,c){var v=a?a+m:m;if(!this._events[v])return!1;var E=this._events[v],d=arguments.length,x,S;if(E.fn){switch(E.once&&this.removeListener(m,E.fn,void 0,!0),d){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,y),!0;case 3:return E.fn.call(E.context,y,b),!0;case 4:return E.fn.call(E.context,y,b,_),!0;case 5:return E.fn.call(E.context,y,b,_,g),!0;case 6:return E.fn.call(E.context,y,b,_,g,c),!0}for(S=1,x=new Array(d-1);S<d;S++)x[S-1]=arguments[S];E.fn.apply(E.context,x)}else{var T=E.length,w;for(S=0;S<T;S++)switch(E[S].once&&this.removeListener(m,E[S].fn,void 0,!0),d){case 1:E[S].fn.call(E[S].context);break;case 2:E[S].fn.call(E[S].context,y);break;case 3:E[S].fn.call(E[S].context,y,b);break;case 4:E[S].fn.call(E[S].context,y,b,_);break;default:if(!x)for(w=1,x=new Array(d-1);w<d;w++)x[w-1]=arguments[w];E[S].fn.apply(E[S].context,x)}}return!0},l.prototype.on=function(m,y,b){return h(this,m,y,b,!1)},l.prototype.once=function(m,y,b){return h(this,m,y,b,!0)},l.prototype.removeListener=function(m,y,b,_){var g=a?a+m:m;if(!this._events[g])return this;if(!y)return p(this,g),this;var c=this._events[g];if(c.fn)c.fn===y&&(!_||c.once)&&(!b||c.context===b)&&p(this,g);else{for(var v=0,E=[],d=c.length;v<d;v++)(c[v].fn!==y||_&&!c[v].once||b&&c[v].context!==b)&&E.push(c[v]);E.length?this._events[g]=E.length===1?E[0]:E:p(this,g)}return this},l.prototype.removeAllListeners=function(m){var y;return m?(y=a?a+m:m,this._events[y]&&p(this,y)):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=a,l.EventEmitter=l,r.exports=l},"./node_modules/url-toolkit/src/url-toolkit.js":function(r,i,t){(function(n){var a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,o=/^([^\/?#]*)([^]*)$/,f=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(l,u,m){if(m=m||{},l=l.trim(),u=u.trim(),!u){if(!m.alwaysNormalize)return l;var y=p.parseURL(l);if(!y)throw new Error("Error trying to parse base URL.");return y.path=p.normalizePath(y.path),p.buildURLFromParts(y)}var b=p.parseURL(u);if(!b)throw new Error("Error trying to parse relative URL.");if(b.scheme)return m.alwaysNormalize?(b.path=p.normalizePath(b.path),p.buildURLFromParts(b)):u;var _=p.parseURL(l);if(!_)throw new Error("Error trying to parse base URL.");if(!_.netLoc&&_.path&&_.path[0]!=="/"){var g=o.exec(_.path);_.netLoc=g[1],_.path=g[2]}_.netLoc&&!_.path&&(_.path="/");var c={scheme:_.scheme,netLoc:b.netLoc,path:null,params:b.params,query:b.query,fragment:b.fragment};if(!b.netLoc&&(c.netLoc=_.netLoc,b.path[0]!=="/"))if(!b.path)c.path=_.path,b.params||(c.params=_.params,b.query||(c.query=_.query));else{var v=_.path,E=v.substring(0,v.lastIndexOf("/")+1)+b.path;c.path=p.normalizePath(E)}return c.path===null&&(c.path=m.alwaysNormalize?p.normalizePath(b.path):b.path),p.buildURLFromParts(c)},parseURL:function(l){var u=a.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(f,"");l.length!==(l=l.replace(h,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};r.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(r,i,t){function n(m){var y={};function b(g){if(y[g])return y[g].exports;var c=y[g]={i:g,l:!1,exports:{}};return m[g].call(c.exports,c,c.exports,b),c.l=!0,c.exports}b.m=m,b.c=y,b.i=function(g){return g},b.d=function(g,c,v){b.o(g,c)||Object.defineProperty(g,c,{configurable:!1,enumerable:!0,get:v})},b.r=function(g){Object.defineProperty(g,"__esModule",{value:!0})},b.n=function(g){var c=g&&g.__esModule?function(){return g.default}:function(){return g};return b.d(c,"a",c),c},b.o=function(g,c){return Object.prototype.hasOwnProperty.call(g,c)},b.p="/",b.oe=function(g){throw console.error(g),g};var _=b(b.s=ENTRY_MODULE);return _.default||_}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+a+").*?\\)";function f(m){return(m+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function h(m){return!isNaN(1*m)}function p(m,y,b){var _={};_[b]=[];var g=y.toString(),c=g.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return _;for(var v=c[1],E=new RegExp("(\\\\n|\\W)"+f(v)+o,"g"),d;d=E.exec(g);)d[3]!=="dll-reference"&&_[b].push(d[3]);for(E=new RegExp("\\("+f(v)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");d=E.exec(g);)m[d[2]]||(_[b].push(d[1]),m[d[2]]=t(d[1]).m),_[d[2]]=_[d[2]]||[],_[d[2]].push(d[4]);for(var x=Object.keys(_),S=0;S<x.length;S++)for(var T=0;T<_[x[S]].length;T++)h(_[x[S]][T])&&(_[x[S]][T]=1*_[x[S]][T]);return _}function l(m){var y=Object.keys(m);return y.reduce(function(b,_){return b||m[_].length>0},!1)}function u(m,y){for(var b={main:[y]},_={main:[]},g={main:{}};l(b);)for(var c=Object.keys(b),v=0;v<c.length;v++){var E=c[v],d=b[E],x=d.pop();if(g[E]=g[E]||{},!(g[E][x]||!m[E][x])){g[E][x]=!0,_[E]=_[E]||[],_[E].push(x);for(var S=p(m,m[E][x],E),T=Object.keys(S),w=0;w<T.length;w++)b[T[w]]=b[T[w]]||[],b[T[w]]=b[T[w]].concat(S[T[w]])}}return _}r.exports=function(m,y){y=y||{};var b={main:t.m},_=y.all?{main:Object.keys(b.main)}:u(b,m),g="";Object.keys(_).filter(function(x){return x!=="main"}).forEach(function(x){for(var S=0;_[x][S];)S++;_[x].push(S),b[x][S]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",g=g+"var "+x+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(S))+")({"+_[x].map(function(T){return""+JSON.stringify(T)+": "+b[x][T].toString()}).join(",")+`});
`}),g=g+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(m))+")({"+_.main.map(function(x){return""+JSON.stringify(x)+": "+b.main[x].toString()}).join(",")+"}))(self);";var c=new window.Blob([g],{type:"text/javascript"});if(y.bare)return c;var v=window.URL||window.webkitURL||window.mozURL||window.msURL,E=v.createObjectURL(c),d=new window.Worker(E);return d.objectURL=E,d}},"./src/config.ts":function(r,i,t){t.r(i),t.d(i,"hlsDefaultConfig",function(){return w}),t.d(i,"mergeConfig",function(){return I}),t.d(i,"enableStreamingMode",function(){return A});var n=t("./src/controller/abr-controller.ts"),a=t("./src/controller/audio-stream-controller.ts"),o=t("./src/controller/audio-track-controller.ts"),f=t("./src/controller/subtitle-stream-controller.ts"),h=t("./src/controller/subtitle-track-controller.ts"),p=t("./src/controller/buffer-controller.ts"),l=t("./src/controller/timeline-controller.ts"),u=t("./src/controller/cap-level-controller.ts"),m=t("./src/controller/fps-controller.ts"),y=t("./src/controller/eme-controller.ts"),b=t("./src/controller/cmcd-controller.ts"),_=t("./src/utils/xhr-loader.ts"),g=t("./src/utils/fetch-loader.ts"),c=t("./src/utils/cues.ts"),v=t("./src/utils/mediakeys-helper.ts"),E=t("./src/utils/logger.ts");function d(){return d=Object.assign||function(O){for(var D=1;D<arguments.length;D++){var R=arguments[D];for(var C in R)Object.prototype.hasOwnProperty.call(R,C)&&(O[C]=R[C])}return O},d.apply(this,arguments)}function x(O,D){var R=Object.keys(O);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(O);D&&(C=C.filter(function(P){return Object.getOwnPropertyDescriptor(O,P).enumerable})),R.push.apply(R,C)}return R}function S(O){for(var D=1;D<arguments.length;D++){var R=arguments[D]!=null?arguments[D]:{};D%2?x(Object(R),!0).forEach(function(C){T(O,C,R[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(R)):x(Object(R)).forEach(function(C){Object.defineProperty(O,C,Object.getOwnPropertyDescriptor(R,C))})}return O}function T(O,D,R){return D in O?Object.defineProperty(O,D,{value:R,enumerable:!0,configurable:!0,writable:!0}):O[D]=R,O}var w=S(S({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:_.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n.default,bufferController:p.default,capLevelController:u.default,fpsController:m.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:v.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},L()),{},{subtitleStreamController:f.SubtitleStreamController,subtitleTrackController:h.default,timelineController:l.TimelineController,audioStreamController:a.default,audioTrackController:o.default,emeController:y.default,cmcdController:b.default});function L(){return{cueHandler:c.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function I(O,D){if((D.liveSyncDurationCount||D.liveMaxLatencyDurationCount)&&(D.liveSyncDuration||D.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(D.liveMaxLatencyDurationCount!==void 0&&(D.liveSyncDurationCount===void 0||D.liveMaxLatencyDurationCount<=D.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(D.liveMaxLatencyDuration!==void 0&&(D.liveSyncDuration===void 0||D.liveMaxLatencyDuration<=D.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return d({},O,D)}function A(O){var D=O.loader;if(D!==g.default&&D!==_.default)E.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),O.progressive=!1;else{var R=Object(g.fetchSupported)();R&&(O.loader=g.default,O.progressive=!0,O.enableSoftwareAES=!0,E.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/ewma-bandwidth-estimator.ts"),o=t("./src/events.ts"),f=t("./src/utils/buffer-helper.ts"),h=t("./src/errors.ts"),p=t("./src/types/loader.ts"),l=t("./src/utils/logger.ts");function u(b,_){for(var g=0;g<_.length;g++){var c=_[g];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(b,c.key,c)}}function m(b,_,g){return _&&u(b.prototype,_),g&&u(b,g),b}var y=function(){function b(g){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=g;var c=g.config;this.bwEstimator=new a.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var _=b.prototype;return _.registerListeners=function(){var c=this.hls;c.on(o.Events.FRAG_LOADING,this.onFragLoading,this),c.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(o.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var c=this.hls;c.off(o.Events.FRAG_LOADING,this.onFragLoading,this),c.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(o.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},_.onFragLoading=function(c,v){var E=v.frag;if(E.type===p.PlaylistLevelType.MAIN&&!this.timer){var d;this.fragCurrent=E,this.partCurrent=(d=v.part)!=null?d:null,this.timer=self.setInterval(this.onCheck,100)}},_.onLevelLoaded=function(c,v){var E=this.hls.config;v.details.live?this.bwEstimator.update(E.abrEwmaSlowLive,E.abrEwmaFastLive):this.bwEstimator.update(E.abrEwmaSlowVoD,E.abrEwmaFastVoD)},_._abandonRulesCheck=function(){var c=this.fragCurrent,v=this.partCurrent,E=this.hls,d=E.autoLevelEnabled,x=E.config,S=E.media;if(!(!c||!S)){var T=v?v.stats:c.stats,w=v?v.duration:c.duration;if(T.aborted){l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!d||S.paused||!S.playbackRate||!S.readyState)){var L=performance.now()-T.loading.start,I=Math.abs(S.playbackRate);if(!(L<=500*w/I)){var A=E.levels,O=E.minAutoLevel,D=A[c.level],R=T.total||Math.max(T.loaded,Math.round(w*D.maxBitrate/8)),C=Math.max(1,T.bwEstimate?T.bwEstimate/8:T.loaded*1e3/L),P=(R-T.loaded)/C,M=S.currentTime,N=(f.BufferHelper.bufferInfo(S,M,x.maxBufferHole).end-M)/I;if(!(N>=2*w/I||P<=N)){var B=Number.POSITIVE_INFINITY,U;for(U=c.level-1;U>O;U--){var F=A[U].maxBitrate;if(B=w*F/(8*.8*C),B<N)break}if(!(B>=P)){var j=this.bwEstimator.getEstimate();l.logger.warn("Fragment "+c.sn+(v?" part "+v.index:"")+" of level "+c.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+U+`
      Current BW estimate: `+(Object(n.isFiniteNumber)(j)?(j/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+P.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+N.toFixed(3)+" s"),E.nextLoadLevel=U,this.bwEstimator.sample(L,T.loaded),this.clearTimer(),c.loader&&(this.fragCurrent=this.partCurrent=null,c.loader.abort()),E.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,part:v,stats:T})}}}}}},_.onFragLoaded=function(c,v){var E=v.frag,d=v.part;if(E.type===p.PlaylistLevelType.MAIN&&Object(n.isFiniteNumber)(E.sn)){var x=d?d.stats:E.stats,S=d?d.duration:E.duration;if(this.clearTimer(),this.lastLoadedFragLevel=E.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var T=this.hls.levels[E.level],w=(T.loaded?T.loaded.bytes:0)+x.loaded,L=(T.loaded?T.loaded.duration:0)+S;T.loaded={bytes:w,duration:L},T.realBitrate=Math.round(8*w/L)}if(E.bitrateTest){var I={stats:x,frag:E,part:d,id:E.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,I),E.bitrateTest=!1}}},_.onFragBuffered=function(c,v){var E=v.frag,d=v.part,x=d?d.stats:E.stats;if(!x.aborted&&!(E.type!==p.PlaylistLevelType.MAIN||E.sn==="initSegment")){var S=x.parsing.end-x.loading.start;this.bwEstimator.sample(S,x.loaded),x.bwEstimate=this.bwEstimator.getEstimate(),E.bitrateTest?this.bitrateTestDelay=S/1e3:this.bitrateTestDelay=0}},_.onError=function(c,v){switch(v.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},_.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},_.getNextABRAutoLevel=function(){var c=this.fragCurrent,v=this.partCurrent,E=this.hls,d=E.maxAutoLevel,x=E.config,S=E.minAutoLevel,T=E.media,w=v?v.duration:c?c.duration:0,L=T?T.currentTime:0,I=T&&T.playbackRate!==0?Math.abs(T.playbackRate):1,A=this.bwEstimator?this.bwEstimator.getEstimate():x.abrEwmaDefaultEstimate,O=(f.BufferHelper.bufferInfo(T,L,x.maxBufferHole).end-L)/I,D=this.findBestLevel(A,S,d,O,x.abrBandWidthFactor,x.abrBandWidthUpFactor);if(D>=0)return D;l.logger.trace((O?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var R=w?Math.min(w,x.maxStarvationDelay):x.maxStarvationDelay,C=x.abrBandWidthFactor,P=x.abrBandWidthUpFactor;if(!O){var M=this.bitrateTestDelay;if(M){var N=w?Math.min(w,x.maxLoadingDelay):x.maxLoadingDelay;R=N-M,l.logger.trace("bitrate test took "+Math.round(1e3*M)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*R)+" ms"),C=P=1}}return D=this.findBestLevel(A,S,d,O+R,C,P),Math.max(D,0)},_.findBestLevel=function(c,v,E,d,x,S){for(var T,w=this.fragCurrent,L=this.partCurrent,I=this.lastLoadedFragLevel,A=this.hls.levels,O=A[I],D=!!(O!=null&&(T=O.details)!==null&&T!==void 0&&T.live),R=O==null?void 0:O.codecSet,C=L?L.duration:w?w.duration:0,P=E;P>=v;P--){var M=A[P];if(!(!M||R&&M.codecSet!==R)){var N=M.details,B=(L?N==null?void 0:N.partTarget:N==null?void 0:N.averagetargetduration)||C,U=void 0;P<=I?U=x*c:U=S*c;var F=A[P].maxBitrate,j=F*B/U;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+P+"/"+Math.round(U)+"/"+F+"/"+B+"/"+d+"/"+j),U>F&&(!j||D&&!this.bitrateTestDelay||j<d))return P}}return-1},m(b,[{key:"nextAutoLevel",get:function(){var c=this._nextAutoLevel,v=this.bwEstimator;if(c!==-1&&(!v||!v.canEstimate()))return c;var E=this.getNextABRAutoLevel();return c!==-1&&(E=Math.min(c,E)),E},set:function(c){this._nextAutoLevel=c}}]),b}();i.default=y},"./src/controller/audio-stream-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/events.ts"),f=t("./src/utils/buffer-helper.ts"),h=t("./src/controller/fragment-tracker.ts"),p=t("./src/types/level.ts"),l=t("./src/types/loader.ts"),u=t("./src/loader/fragment.ts"),m=t("./src/demux/chunk-cache.ts"),y=t("./src/demux/transmuxer-interface.ts"),b=t("./src/types/transmuxer.ts"),_=t("./src/controller/fragment-finders.ts"),g=t("./src/utils/discontinuities.ts"),c=t("./src/errors.ts"),v=t("./src/utils/logger.ts");function E(){return E=Object.assign||function(w){for(var L=1;L<arguments.length;L++){var I=arguments[L];for(var A in I)Object.prototype.hasOwnProperty.call(I,A)&&(w[A]=I[A])}return w},E.apply(this,arguments)}function d(w,L){w.prototype=Object.create(L.prototype),w.prototype.constructor=w,x(w,L)}function x(w,L){return x=Object.setPrototypeOf||function(A,O){return A.__proto__=O,A},x(w,L)}var S=100,T=function(w){d(L,w);function L(A,O){var D;return D=w.call(this,A,O,"[audio-stream-controller]")||this,D.videoBuffer=null,D.videoTrackCC=-1,D.waitingVideoCC=-1,D.audioSwitch=!1,D.trackId=-1,D.waitingData=null,D.mainDetails=null,D.bufferFlushed=!1,D._registerListeners(),D}var I=L.prototype;return I.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},I._registerListeners=function(){var O=this.hls;O.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.on(o.Events.ERROR,this.onError,this),O.on(o.Events.BUFFER_RESET,this.onBufferReset,this),O.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},I._unregisterListeners=function(){var O=this.hls;O.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.off(o.Events.ERROR,this.onError,this),O.off(o.Events.BUFFER_RESET,this.onBufferReset,this),O.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},I.onInitPtsFound=function(O,D){var R=D.frag,C=D.id,P=D.initPTS;if(C==="main"){var M=R.cc;this.initPTS[R.cc]=P,this.log("InitPTS for cc: "+M+" found from main: "+P),this.videoTrackCC=M,this.state===a.State.WAITING_INIT_PTS&&this.tick()}},I.startLoad=function(O){if(!this.levels){this.startPosition=O,this.state=a.State.STOPPED;return}var D=this.lastCurrentTime;this.stopLoad(),this.setInterval(S),this.fragLoadError=0,D>0&&O===-1?(this.log("Override startPosition with lastCurrentTime @"+D.toFixed(3)),this.state=a.State.IDLE):(this.loadedmetadata=!1,this.state=a.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=O,this.tick()},I.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_TRACK:{var O,D=this.levels,R=this.trackId,C=D==null||(O=D[R])===null||O===void 0?void 0:O.details;if(C){if(this.waitForCdnTuneIn(C))break;this.state=a.State.WAITING_INIT_PTS}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var P,M=performance.now(),N=this.retryDate;(!N||M>=N||(P=this.media)!==null&&P!==void 0&&P.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=a.State.IDLE);break}case a.State.WAITING_INIT_PTS:{var B=this.waitingData;if(B){var U=B.frag,F=B.part,j=B.cache,$=B.complete;if(this.initPTS[U.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.FRAG_LOADING;var G=j.flush(),Y={frag:U,part:F,payload:G,networkDetails:null};this._handleFragmentLoadProgress(Y),$&&w.prototype._handleFragmentLoadComplete.call(this,Y)}else if(this.videoTrackCC!==this.waitingVideoCC)v.logger.log("Waiting fragment cc ("+U.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var X=this.getLoadPosition(),ie=f.BufferHelper.bufferInfo(this.mediaBuffer,X,this.config.maxBufferHole),pe=Object(_.fragmentWithinToleranceTest)(ie.end,this.config.maxFragLookUpTolerance,U);pe<0&&(v.logger.log("Waiting fragment cc ("+U.cc+") @ "+U.start+" cancelled because another fragment at "+ie.end+" is needed"),this.clearWaitingFragment())}}else this.state=a.State.IDLE}}this.onTickEnd()},I.clearWaitingFragment=function(){var O=this.waitingData;O&&(this.fragmentTracker.removeFragment(O.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.IDLE)},I.onTickEnd=function(){var O=this.media;if(!(!O||!O.readyState)){var D=this.mediaBuffer?this.mediaBuffer:O,R=D.buffered;!this.loadedmetadata&&R.length&&(this.loadedmetadata=!0),this.lastCurrentTime=O.currentTime}},I.doTickIdle=function(){var O,D,R=this.hls,C=this.levels,P=this.media,M=this.trackId,N=R.config;if(!(!C||!C[M])&&!(!P&&(this.startFragRequested||!N.startFragPrefetch))){var B=C[M],U=B.details;if(!U||U.live&&this.levelLastLoaded!==M||this.waitForCdnTuneIn(U)){this.state=a.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,u.ElementaryStreamTypes.AUDIO,l.PlaylistLevelType.AUDIO));var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,l.PlaylistLevelType.AUDIO);if(F!==null){var j=F.len,$=this.getMaxBufferLength(),G=this.audioSwitch;if(!(j>=$&&!G)){if(!G&&this._streamEnded(F,U)){R.trigger(o.Events.BUFFER_EOS,{type:"audio"}),this.state=a.State.ENDED;return}var Y=U.fragments,X=Y[0].start,ie=F.end;if(G){var pe=this.getLoadPosition();ie=pe,U.PTSKnown&&pe<X&&(F.end>X||F.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),P.currentTime=X+.05)}var ue=this.getNextFragment(ie,U);if(!ue){this.bufferFlushed=!0;return}((O=ue.decryptdata)===null||O===void 0?void 0:O.keyFormat)==="identity"&&!((D=ue.decryptdata)!==null&&D!==void 0&&D.key)?this.loadKey(ue,U):this.loadFragment(ue,U,ie)}}}},I.getMaxBufferLength=function(){var O=w.prototype.getMaxBufferLength.call(this),D=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,l.PlaylistLevelType.MAIN);return D===null?O:Math.max(O,D.len)},I.onMediaDetaching=function(){this.videoBuffer=null,w.prototype.onMediaDetaching.call(this)},I.onAudioTracksUpdated=function(O,D){var R=D.audioTracks;this.resetTransmuxer(),this.levels=R.map(function(C){return new p.Level(C)})},I.onAudioTrackSwitching=function(O,D){var R=!!D.url;this.trackId=D.id;var C=this.fragCurrent;C!=null&&C.loader&&C.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),R?this.setInterval(S):this.resetTransmuxer(),R?(this.audioSwitch=!0,this.state=a.State.IDLE):this.state=a.State.STOPPED,this.tick()},I.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},I.onLevelLoaded=function(O,D){this.mainDetails=D.details},I.onAudioTrackLoaded=function(O,D){var R,C=this.levels,P=D.details,M=D.id;if(!C){this.warn("Audio tracks were reset while loading level "+M);return}this.log("Track "+M+" loaded ["+P.startSN+","+P.endSN+"],duration:"+P.totalduration);var N=C[M],B=0;if(P.live||(R=N.details)!==null&&R!==void 0&&R.live){var U=this.mainDetails;if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed||!U)return;!N.details&&P.hasProgramDateTime&&U.hasProgramDateTime?(Object(g.alignMediaPlaylistByPDT)(P,U),B=P.fragments[0].start):B=this.alignPlaylists(P,N.details)}N.details=P,this.levelLastLoaded=M,!this.startFragRequested&&(this.mainDetails||!P.live)&&this.setStartPosition(N.details,B),this.state===a.State.WAITING_TRACK&&!this.waitForCdnTuneIn(P)&&(this.state=a.State.IDLE),this.tick()},I._handleFragmentLoadProgress=function(O){var D,R=O.frag,C=O.part,P=O.payload,M=this.config,N=this.trackId,B=this.levels;if(!B){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+R.sn+" of level "+R.level+" will not be buffered");return}var U=B[N];console.assert(U,"Audio track is defined on fragment load progress");var F=U.details;console.assert(F,"Audio track details are defined on fragment load progress");var j=M.defaultAudioCodec||U.audioCodec||"mp4a.40.2",$=this.transmuxer;$||($=this.transmuxer=new y.default(this.hls,l.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var G=this.initPTS[R.cc],Y=(D=R.initSegment)===null||D===void 0?void 0:D.data;if(G!==void 0){var X=!1,ie=C?C.index:-1,pe=ie!==-1,ue=new b.ChunkMetadata(R.level,R.sn,R.stats.chunkCount,P.byteLength,ie,pe);$.push(P,Y,j,"",R,C,F.totalduration,X,ue,G)}else{v.logger.log("Unknown video PTS for cc "+R.cc+", waiting for video PTS before demuxing audio frag "+R.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+N);var we=this.waitingData=this.waitingData||{frag:R,part:C,cache:new m.default,complete:!1},de=we.cache;de.push(new Uint8Array(P)),this.waitingVideoCC=this.videoTrackCC,this.state=a.State.WAITING_INIT_PTS}},I._handleFragmentLoadComplete=function(O){if(this.waitingData){this.waitingData.complete=!0;return}w.prototype._handleFragmentLoadComplete.call(this,O)},I.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},I.onBufferCreated=function(O,D){var R=D.tracks.audio;R&&(this.mediaBuffer=R.buffer),D.tracks.video&&(this.videoBuffer=D.tracks.video.buffer)},I.onFragBuffered=function(O,D){var R=D.frag,C=D.part;if(R.type===l.PlaylistLevelType.AUDIO){if(this.fragContextChanged(R)){this.warn("Fragment "+R.sn+(C?" p: "+C.index:"")+" of level "+R.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}R.sn!=="initSegment"&&(this.fragPrevious=R,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(R,C)}},I.onError=function(O,D){switch(D.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.AUDIO,D);break;case c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==a.State.ERROR&&this.state!==a.State.STOPPED&&(this.state=D.fatal?a.State.ERROR:a.State.IDLE,this.warn(D.details+" while loading frag, switching to "+this.state+" state"));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(D.parent==="audio"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var R=!0,C=this.getFwdBufferInfo(this.mediaBuffer,l.PlaylistLevelType.AUDIO);C&&C.len>.5&&(R=!this.reduceMaxBufferLength(C.len)),R&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,w.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},I.onBufferFlushed=function(O,D){var R=D.type;R===u.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},I._handleTransmuxComplete=function(O){var D,R="audio",C=this.hls,P=O.remuxResult,M=O.chunkMeta,N=this.getCurrentContext(M);if(!N){this.warn("The loading context changed while buffering fragment "+M.sn+" of level "+M.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(M.level);return}var B=N.frag,U=N.part,F=P.audio,j=P.text,$=P.id3,G=P.initSegment;if(!this.fragContextChanged(B)){if(this.state=a.State.PARSING,this.audioSwitch&&F&&this.completeAudioSwitch(),G!=null&&G.tracks&&(this._bufferInitSegment(G.tracks,B,M),C.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:R,tracks:G.tracks})),F){var Y=F.startPTS,X=F.endPTS,ie=F.startDTS,pe=F.endDTS;U&&(U.elementaryStreams[u.ElementaryStreamTypes.AUDIO]={startPTS:Y,endPTS:X,startDTS:ie,endDTS:pe}),B.setElementaryStreamInfo(u.ElementaryStreamTypes.AUDIO,Y,X,ie,pe),this.bufferFragmentData(F,B,U,M)}if($!=null&&(D=$.samples)!==null&&D!==void 0&&D.length){var ue=E({frag:B,id:R},$);C.trigger(o.Events.FRAG_PARSING_METADATA,ue)}if(j){var we=E({frag:B,id:R},j);C.trigger(o.Events.FRAG_PARSING_USERDATA,we)}}},I._bufferInitSegment=function(O,D,R){if(this.state===a.State.PARSING){O.video&&delete O.video;var C=O.audio;if(!!C){C.levelCodec=C.codec,C.id="audio",this.log("Init audio buffer, container:"+C.container+", codecs[parsed]=["+C.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,O);var P=C.initSegment;if(P!=null&&P.byteLength){var M={type:"audio",frag:D,part:null,chunkMeta:R,parent:D.type,data:P};this.hls.trigger(o.Events.BUFFER_APPENDING,M)}this.tick()}}},I.loadFragment=function(O,D,R){var C=this.fragmentTracker.getState(O);this.fragCurrent=O,(this.audioSwitch||C===h.FragmentState.NOT_LOADED||C===h.FragmentState.PARTIAL)&&(O.sn==="initSegment"?this._loadInitSegment(O):D.live&&!Object(n.isFiniteNumber)(this.initPTS[O.cc])?(this.log("Waiting for video PTS in continuity counter "+O.cc+" of live stream before loading audio fragment "+O.sn+" of level "+this.trackId),this.state=a.State.WAITING_INIT_PTS):(this.startFragRequested=!0,w.prototype.loadFragment.call(this,O,D,R)))},I.completeAudioSwitch=function(){var O=this.hls,D=this.media,R=this.trackId;D&&(this.log("Switching audio track : flushing all audio"),w.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,O.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:R})},L}(a.default);i.default=T},"./src/controller/audio-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/controller/base-playlist-controller.ts"),f=t("./src/types/loader.ts");function h(y,b){for(var _=0;_<b.length;_++){var g=b[_];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(y,g.key,g)}}function p(y,b,_){return b&&h(y.prototype,b),_&&h(y,_),y}function l(y,b){y.prototype=Object.create(b.prototype),y.prototype.constructor=y,u(y,b)}function u(y,b){return u=Object.setPrototypeOf||function(g,c){return g.__proto__=c,g},u(y,b)}var m=function(y){l(b,y);function b(g){var c;return c=y.call(this,g,"[audio-track-controller]")||this,c.tracks=[],c.groupId=null,c.tracksInGroup=[],c.trackId=-1,c.trackName="",c.selectDefaultTrack=!0,c.registerListeners(),c}var _=b.prototype;return _.registerListeners=function(){var c=this.hls;c.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(n.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var c=this.hls;c.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(n.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,y.prototype.destroy.call(this)},_.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},_.onManifestParsed=function(c,v){this.tracks=v.audioTracks||[]},_.onAudioTrackLoaded=function(c,v){var E=v.id,d=v.details,x=this.tracksInGroup[E];if(!x){this.warn("Invalid audio track id "+E);return}var S=x.details;x.details=v.details,this.log("audioTrack "+E+" loaded ["+d.startSN+"-"+d.endSN+"]"),E===this.trackId&&(this.retryCount=0,this.playlistLoaded(E,v,S))},_.onLevelLoading=function(c,v){this.switchLevel(v.level)},_.onLevelSwitching=function(c,v){this.switchLevel(v.level)},_.switchLevel=function(c){var v=this.hls.levels[c];if(!!(v!=null&&v.audioGroupIds)){var E=v.audioGroupIds[v.urlId];if(this.groupId!==E){this.groupId=E;var d=this.tracks.filter(function(S){return!E||S.groupId===E});this.selectDefaultTrack&&!d.some(function(S){return S.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=d;var x={audioTracks:d};this.log("Updating audio tracks, "+d.length+' track(s) found in "'+E+'" group-id'),this.hls.trigger(n.Events.AUDIO_TRACKS_UPDATED,x),this.selectInitialTrack()}}},_.onError=function(c,v){y.prototype.onError.call(this,c,v),!(v.fatal||!v.context)&&v.context.type===f.PlaylistContextType.AUDIO_TRACK&&v.context.id===this.trackId&&v.context.groupId===this.groupId&&this.retryLoadingOrFail(v)},_.setAudioTrack=function(c){var v=this.tracksInGroup;if(c<0||c>=v.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var E=v[this.trackId];this.log("Now switching to audio-track index "+c);var d=v[c],x=d.id,S=d.groupId,T=S===void 0?"":S,w=d.name,L=d.type,I=d.url;if(this.trackId=c,this.trackName=w,this.selectDefaultTrack=!1,this.hls.trigger(n.Events.AUDIO_TRACK_SWITCHING,{id:x,groupId:T,name:w,type:L,url:I}),!(d.details&&!d.details.live)){var A=this.switchParams(d.url,E==null?void 0:E.details);this.loadPlaylist(A)}},_.selectInitialTrack=function(){var c=this.tracksInGroup;console.assert(c.length,"Initial audio track should be selected when tracks are known");var v=this.trackName,E=this.findTrackId(v)||this.findTrackId();E!==-1?this.setAudioTrack(E):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},_.findTrackId=function(c){for(var v=this.tracksInGroup,E=0;E<v.length;E++){var d=v[E];if((!this.selectDefaultTrack||d.default)&&(!c||c===d.name))return d.id}return-1},_.loadPlaylist=function(c){var v=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(v)){var E=v.id,d=v.groupId,x=v.url;if(c)try{x=c.addDirectives(x)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("loading audio-track playlist for id: "+E),this.clearTimer(),this.hls.trigger(n.Events.AUDIO_TRACK_LOADING,{url:x,id:E,groupId:d,deliveryDirectives:c||null})}},p(b,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1,this.setAudioTrack(c)}}]),b}(o.default);i.default=m},"./src/controller/base-playlist-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return p});var n=t("./src/polyfills/number.ts"),a=t("./src/types/level.ts"),o=t("./src/controller/level-helper.ts"),f=t("./src/utils/logger.ts"),h=t("./src/errors.ts"),p=function(){function l(m,y){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=f.logger.log.bind(f.logger,y+":"),this.warn=f.logger.warn.bind(f.logger,y+":"),this.hls=m}var u=l.prototype;return u.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},u.onError=function(y,b){b.fatal&&b.type===h.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},u.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},u.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},u.stopLoad=function(){this.canLoad=!1,this.clearTimer()},u.switchParams=function(y,b){var _=b==null?void 0:b.renditionReports;if(_)for(var g=0;g<_.length;g++){var c=_[g],v=""+c.URI;if(v===y.substr(-v.length)){var E=parseInt(c["LAST-MSN"]),d=parseInt(c["LAST-PART"]);if(b&&this.hls.config.lowLatencyMode){var x=Math.min(b.age-b.partTarget,b.targetduration);d!==void 0&&x>b.partTarget&&(d+=1)}if(Object(n.isFiniteNumber)(E))return new a.HlsUrlParameters(E,Object(n.isFiniteNumber)(d)?d:void 0,a.HlsSkip.No)}}},u.loadPlaylist=function(y){},u.shouldLoadTrack=function(y){return this.canLoad&&y&&!!y.url&&(!y.details||y.details.live)},u.playlistLoaded=function(y,b,_){var g=this,c=b.details,v=b.stats,E=v.loading.end?Math.max(0,self.performance.now()-v.loading.end):0;if(c.advancedDateTime=Date.now()-E,c.live||_!=null&&_.live){if(c.reloaded(_),_&&this.log("live playlist "+y+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),_&&c.fragments.length>0&&Object(o.mergeDetails)(_,c),!this.canLoad||!c.live)return;var d,x=void 0,S=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var T=this.hls.config.lowLatencyMode,w=c.lastPartSn,L=c.endSN,I=c.lastPartIndex,A=I!==-1,O=w===L,D=T?0:I;A?(x=O?L+1:w,S=O?D:I+1):x=L+1;var R=c.age,C=R+c.ageHeader,P=Math.min(C-c.partTarget,c.targetduration*1.5);if(P>0){if(_&&P>_.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+_.tuneInGoal+" to: "+P+" with playlist age: "+c.age),P=0;else{var M=Math.floor(P/c.targetduration);if(x+=M,S!==void 0){var N=Math.round(P%c.targetduration/c.partTarget);S+=N}this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+R.toFixed(2)+"s goal: "+P+" skip sn "+M+" to part "+S)}c.tuneInGoal=P}if(d=this.getDeliveryDirectives(c,b.deliveryDirectives,x,S),T||!O){this.loadPlaylist(d);return}}else d=this.getDeliveryDirectives(c,b.deliveryDirectives,x,S);var B=Object(o.computeReloadInterval)(c,v);x!==void 0&&c.canBlockReload&&(B-=c.partTarget||1),this.log("reload live playlist "+y+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return g.loadPlaylist(d)},B)}else this.clearTimer()},u.getDeliveryDirectives=function(y,b,_,g){var c=Object(a.getSkipValue)(y,_);return b!=null&&b.skip&&y.deltaUpdateFailed&&(_=b.msn,g=b.part,c=a.HlsSkip.No),new a.HlsUrlParameters(_,g,c)},u.retryLoadingOrFail=function(y){var b=this,_=this.hls.config,g=this.retryCount<_.levelLoadingMaxRetry;if(g){var c;if(this.retryCount++,y.details.indexOf("LoadTimeOut")>-1&&(c=y.context)!==null&&c!==void 0&&c.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+y.details+'"'),this.loadPlaylist();else{var v=Math.min(Math.pow(2,this.retryCount)*_.levelLoadingRetryDelay,_.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return b.loadPlaylist()},v),this.warn("retry playlist loading #"+this.retryCount+" in "+v+' ms after "'+y.details+'"')}}else this.warn('cannot recover from error "'+y.details+'"'),this.clearTimer(),y.fatal=!0;return g},l}()},"./src/controller/base-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"State",function(){return L}),t.d(i,"default",function(){return I});var n=t("./src/polyfills/number.ts"),a=t("./src/task-loop.ts"),o=t("./src/controller/fragment-tracker.ts"),f=t("./src/utils/buffer-helper.ts"),h=t("./src/utils/logger.ts"),p=t("./src/events.ts"),l=t("./src/errors.ts"),u=t("./src/types/transmuxer.ts"),m=t("./src/utils/mp4-tools.ts"),y=t("./src/utils/discontinuities.ts"),b=t("./src/controller/fragment-finders.ts"),_=t("./src/controller/level-helper.ts"),g=t("./src/loader/fragment-loader.ts"),c=t("./src/crypt/decrypter.ts"),v=t("./src/utils/time-ranges.ts"),E=t("./src/types/loader.ts");function d(A,O){for(var D=0;D<O.length;D++){var R=O[D];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(A,R.key,R)}}function x(A,O,D){return O&&d(A.prototype,O),D&&d(A,D),A}function S(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}function T(A,O){A.prototype=Object.create(O.prototype),A.prototype.constructor=A,w(A,O)}function w(A,O){return w=Object.setPrototypeOf||function(R,C){return R.__proto__=C,R},w(A,O)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},I=function(A){T(O,A);function O(R,C,P){var M;return M=A.call(this)||this,M.hls=void 0,M.fragPrevious=null,M.fragCurrent=null,M.fragmentTracker=void 0,M.transmuxer=null,M._state=L.STOPPED,M.media=void 0,M.mediaBuffer=void 0,M.config=void 0,M.bitrateTest=!1,M.lastCurrentTime=0,M.nextLoadPosition=0,M.startPosition=0,M.loadedmetadata=!1,M.fragLoadError=0,M.retryDate=0,M.levels=null,M.fragmentLoader=void 0,M.levelLastLoaded=null,M.startFragRequested=!1,M.decrypter=void 0,M.initPTS=[],M.onvseeking=null,M.onvended=null,M.logPrefix="",M.log=void 0,M.warn=void 0,M.logPrefix=P,M.log=h.logger.log.bind(h.logger,P+":"),M.warn=h.logger.warn.bind(h.logger,P+":"),M.hls=R,M.fragmentLoader=new g.default(R.config),M.fragmentTracker=C,M.config=R.config,M.decrypter=new c.default(R,R.config),R.on(p.Events.KEY_LOADED,M.onKeyLoaded,S(M)),M}var D=O.prototype;return D.doTick=function(){this.onTickEnd()},D.onTickEnd=function(){},D.startLoad=function(C){},D.stopLoad=function(){this.fragmentLoader.abort();var C=this.fragCurrent;C&&this.fragmentTracker.removeFragment(C),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},D._streamEnded=function(C,P){var M=this.fragCurrent,N=this.fragmentTracker;if(!P.live&&M&&M.sn>=P.endSN&&!C.nextStart){var B=P.partList;if(B!=null&&B.length){var U=B[B.length-1],F=f.BufferHelper.isBuffered(this.media,U.start+U.duration/2);return F}var j=N.getState(M);return j===o.FragmentState.PARTIAL||j===o.FragmentState.OK}return!1},D.onMediaAttached=function(C,P){var M=this.media=this.mediaBuffer=P.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),M.addEventListener("seeking",this.onvseeking),M.addEventListener("ended",this.onvended);var N=this.config;this.levels&&N.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(N.startPosition)},D.onMediaDetaching=function(){var C=this.media;C!=null&&C.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),C&&(C.removeEventListener("seeking",this.onvseeking),C.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},D.onMediaSeeking=function(){var C=this.config,P=this.fragCurrent,M=this.media,N=this.mediaBuffer,B=this.state,U=M?M.currentTime:0,F=f.BufferHelper.bufferInfo(N||M,U,C.maxBufferHole);if(this.log("media seeking to "+(Object(n.isFiniteNumber)(U)?U.toFixed(3):U)+", state: "+B),B===L.ENDED)this.resetLoadingState();else if(P&&!F.len){var j=C.maxFragLookUpTolerance,$=P.start-j,G=P.start+P.duration+j,Y=U>G;(U<$||Y)&&(Y&&P.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),P.loader.abort()),this.resetLoadingState())}M&&(this.lastCurrentTime=U),!this.loadedmetadata&&!F.len&&(this.nextLoadPosition=this.startPosition=U),this.tickImmediate()},D.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},D.onKeyLoaded=function(C,P){if(!(this.state!==L.KEY_LOADING||P.frag!==this.fragCurrent||!this.levels)){this.state=L.IDLE;var M=this.levels[P.frag.level].details;M&&this.loadFragment(P.frag,M,P.frag.start)}},D.onHandlerDestroying=function(){this.stopLoad(),A.prototype.onHandlerDestroying.call(this)},D.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(p.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,A.prototype.onHandlerDestroyed.call(this)},D.loadKey=function(C,P){this.log("Loading key for "+C.sn+" of ["+P.startSN+"-"+P.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level),this.state=L.KEY_LOADING,this.fragCurrent=C,this.hls.trigger(p.Events.KEY_LOADING,{frag:C})},D.loadFragment=function(C,P,M){this._loadFragForPlayback(C,P,M)},D._loadFragForPlayback=function(C,P,M){var N=this,B=function(F){if(N.fragContextChanged(C)){N.warn("Fragment "+C.sn+(F.part?" p: "+F.part.index:"")+" of level "+C.level+" was dropped during download."),N.fragmentTracker.removeFragment(C);return}C.stats.chunkCount++,N._handleFragmentLoadProgress(F)};this._doFragLoad(C,P,M,B).then(function(U){if(!!U){N.fragLoadError=0;var F=N.state;if(N.fragContextChanged(C)){(F===L.FRAG_LOADING||F===L.BACKTRACKING||!N.fragCurrent&&F===L.PARSING)&&(N.fragmentTracker.removeFragment(C),N.state=L.IDLE);return}if("payload"in U&&(N.log("Loaded fragment "+C.sn+" of level "+C.level),N.hls.trigger(p.Events.FRAG_LOADED,U),N.state===L.BACKTRACKING)){N.fragmentTracker.backtrack(C,U),N.resetFragmentLoading(C);return}N._handleFragmentLoadComplete(U)}}).catch(function(U){N.warn(U),N.resetFragmentLoading(C)})},D.flushMainBuffer=function(C,P,M){if(M===void 0&&(M=null),!!(C-P)){var N={startOffset:C,endOffset:P,type:M};this.fragLoadError=0,this.hls.trigger(p.Events.BUFFER_FLUSHING,N)}},D._loadInitSegment=function(C){var P=this;this._doFragLoad(C).then(function(M){if(!M||P.fragContextChanged(C)||!P.levels)throw new Error("init load aborted");return M}).then(function(M){var N=P.hls,B=M.payload,U=C.decryptdata;if(B&&B.byteLength>0&&U&&U.key&&U.iv&&U.method==="AES-128"){var F=self.performance.now();return P.decrypter.webCryptoDecrypt(new Uint8Array(B),U.key.buffer,U.iv.buffer).then(function(j){var $=self.performance.now();return N.trigger(p.Events.FRAG_DECRYPTED,{frag:C,payload:j,stats:{tstart:F,tdecrypt:$}}),M.payload=j,M})}return M}).then(function(M){var N=P.fragCurrent,B=P.hls,U=P.levels;if(!U)throw new Error("init load aborted, missing levels");var F=U[C.level].details;console.assert(F,"Level details are defined when init segment is loaded");var j=C.stats;P.state=L.IDLE,P.fragLoadError=0,C.data=new Uint8Array(M.payload),j.parsing.start=j.buffering.start=self.performance.now(),j.parsing.end=j.buffering.end=self.performance.now(),M.frag===N&&B.trigger(p.Events.FRAG_BUFFERED,{stats:j,frag:N,part:null,id:C.type}),P.tick()}).catch(function(M){P.warn(M),P.resetFragmentLoading(C)})},D.fragContextChanged=function(C){var P=this.fragCurrent;return!C||!P||C.level!==P.level||C.sn!==P.sn||C.urlId!==P.urlId},D.fragBufferedComplete=function(C,P){var M=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+C.type+" sn: "+C.sn+(P?" part: "+P.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level+" "+v.default.toString(f.BufferHelper.getBuffered(M))),this.state=L.IDLE,this.tick()},D._handleFragmentLoadComplete=function(C){var P=this.transmuxer;if(!!P){var M=C.frag,N=C.part,B=C.partsLoaded,U=!B||B.length===0||B.some(function(j){return!j}),F=new u.ChunkMetadata(M.level,M.sn,M.stats.chunkCount+1,0,N?N.index:-1,!U);P.flush(F)}},D._handleFragmentLoadProgress=function(C){},D._doFragLoad=function(C,P,M,N){var B=this;if(M===void 0&&(M=null),!this.levels)throw new Error("frag load aborted, missing levels");if(M=Math.max(C.start,M||0),this.config.lowLatencyMode&&P){var U=P.partList;if(U&&N){M>C.end&&P.fragmentHint&&(C=P.fragmentHint);var F=this.getNextPart(U,C,M);if(F>-1){var j=U[F];return this.log("Loading part sn: "+C.sn+" p: "+j.index+" cc: "+C.cc+" of playlist ["+P.startSN+"-"+P.endSN+"] parts [0-"+F+"-"+(U.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),this.nextLoadPosition=j.start+j.duration,this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:C,part:U[F],targetBufferTime:M}),this.doFragPartsLoad(C,U,F,N).catch(function($){return B.handleFragLoadError($)})}else if(!C.url||this.loadedEndOfParts(U,M))return Promise.resolve(null)}}return this.log("Loading fragment "+C.sn+" cc: "+C.cc+" "+(P?"of ["+P.startSN+"-"+P.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),Object(n.isFiniteNumber)(C.sn)&&!this.bitrateTest&&(this.nextLoadPosition=C.start+C.duration),this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:C,targetBufferTime:M}),this.fragmentLoader.load(C,N).catch(function($){return B.handleFragLoadError($)})},D.doFragPartsLoad=function(C,P,M,N){var B=this;return new Promise(function(U,F){var j=[],$=function G(Y){var X=P[Y];B.fragmentLoader.loadPart(C,X,N).then(function(ie){j[X.index]=ie;var pe=ie.part;B.hls.trigger(p.Events.FRAG_LOADED,ie);var ue=P[Y+1];if(ue&&ue.fragment===C)G(Y+1);else return U({frag:C,part:pe,partsLoaded:j})}).catch(F)};$(M)})},D.handleFragLoadError=function(C){var P=C.data;return P&&P.details===l.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(P.frag,P.part):this.hls.trigger(p.Events.ERROR,P),null},D._handleTransmuxerFlush=function(C){var P=this.getCurrentContext(C);if(!P||this.state!==L.PARSING){this.fragCurrent||(this.state=L.IDLE);return}var M=P.frag,N=P.part,B=P.level,U=self.performance.now();M.stats.parsing.end=U,N&&(N.stats.parsing.end=U),this.updateLevelTiming(M,N,B,C.partial)},D.getCurrentContext=function(C){var P=this.levels,M=C.level,N=C.sn,B=C.part;if(!P||!P[M])return this.warn("Levels object was unset while buffering fragment "+N+" of level "+M+". The current chunk will not be buffered."),null;var U=P[M],F=B>-1?Object(_.getPartWith)(U,N,B):null,j=F?F.fragment:Object(_.getFragmentWithSN)(U,N,this.fragCurrent);return j?{frag:j,part:F,level:U}:null},D.bufferFragmentData=function(C,P,M,N){if(!(!C||this.state!==L.PARSING)){var B=C.data1,U=C.data2,F=B;if(B&&U&&(F=Object(m.appendUint8Array)(B,U)),!(!F||!F.length)){var j={type:C.type,frag:P,part:M,chunkMeta:N,parent:P.type,data:F};this.hls.trigger(p.Events.BUFFER_APPENDING,j),C.dropped&&C.independent&&!M&&this.flushBufferGap(P)}}},D.flushBufferGap=function(C){var P=this.media;if(!!P){if(!f.BufferHelper.isBuffered(P,P.currentTime)){this.flushMainBuffer(0,C.start);return}var M=P.currentTime,N=f.BufferHelper.bufferInfo(P,M,0),B=C.duration,U=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),F=Math.max(Math.min(C.start-U,N.end-U),M+U);C.start-F>U&&this.flushMainBuffer(F,C.start)}},D.getFwdBufferInfo=function(C,P){var M=this.config,N=this.getLoadPosition();if(!Object(n.isFiniteNumber)(N))return null;var B=f.BufferHelper.bufferInfo(C,N,M.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var U=this.fragmentTracker.getBufferedFrag(N,P);if(U&&B.nextStart<U.end)return f.BufferHelper.bufferInfo(C,N,Math.max(B.nextStart,M.maxBufferHole))}return B},D.getMaxBufferLength=function(C){var P=this.config,M;return C?M=Math.max(8*P.maxBufferSize/C,P.maxBufferLength):M=P.maxBufferLength,Math.min(M,P.maxMaxBufferLength)},D.reduceMaxBufferLength=function(C){var P=this.config,M=C||P.maxBufferLength;return P.maxMaxBufferLength>=M?(P.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+P.maxMaxBufferLength+"s"),!0):!1},D.getNextFragment=function(C,P){var M,N,B=P.fragments,U=B.length;if(!U)return null;var F=this.config,j=B[0].start,$;if(P.live){var G=F.initialLiveManifestSize;if(U<G)return this.warn("Not enough fragments to start playback (have: "+U+", need: "+G+")"),null;!P.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&($=this.getInitialLiveFragment(P,B),this.startPosition=$?this.hls.liveSyncPosition||$.start:C)}else C<=j&&($=B[0]);if(!$){var Y=F.lowLatencyMode?P.partEnd:P.fragmentEnd;$=this.getFragmentAtPosition(C,Y,P)}return(M=$)!==null&&M!==void 0&&M.initSegment&&!((N=$)!==null&&N!==void 0&&N.initSegment.data)&&!this.bitrateTest&&($=$.initSegment),$},D.getNextPart=function(C,P,M){for(var N=-1,B=!1,U=!0,F=0,j=C.length;F<j;F++){var $=C[F];if(U=U&&!$.independent,N>-1&&M<$.start)break;var G=$.loaded;!G&&(B||$.independent||U)&&$.fragment===P&&(N=F),B=G}return N},D.loadedEndOfParts=function(C,P){var M=C[C.length-1];return M&&P>M.start&&M.loaded},D.getInitialLiveFragment=function(C,P){var M=this.fragPrevious,N=null;if(M){if(C.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+M.programDateTime),N=Object(b.findFragmentByPDT)(P,M.endProgramDateTime,this.config.maxFragLookUpTolerance)),!N){var B=M.sn+1;if(B>=C.startSN&&B<=C.endSN){var U=P[B-C.startSN];M.cc===U.cc&&(N=U,this.log("Live playlist, switching playlist, load frag with next SN: "+N.sn))}N||(N=Object(b.findFragWithCC)(P,M.cc),N&&this.log("Live playlist, switching playlist, load frag with same CC: "+N.sn))}}else{var F=this.hls.liveSyncPosition;F!==null&&(N=this.getFragmentAtPosition(F,this.bitrateTest?C.fragmentEnd:C.edge,C))}return N},D.getFragmentAtPosition=function(C,P,M){var N=this.config,B=this.fragPrevious,U=M.fragments,F=M.endSN,j=M.fragmentHint,$=N.maxFragLookUpTolerance,G=!!(N.lowLatencyMode&&M.partList&&j);G&&j&&!this.bitrateTest&&(U=U.concat(j),F=j.sn);var Y;if(C<P){var X=C>P-$?0:$;Y=Object(b.findFragmentByPTS)(B,U,C,X)}else Y=U[U.length-1];if(Y){var ie=Y.sn-M.startSN,pe=B&&Y.level===B.level,ue=U[ie+1],we=this.fragmentTracker.getState(Y);if(we===o.FragmentState.BACKTRACKED){Y=null;for(var de=ie;U[de]&&this.fragmentTracker.getState(U[de])===o.FragmentState.BACKTRACKED;)B?Y=U[de--]:Y=U[--de];Y||(Y=ue)}else B&&Y.sn===B.sn&&!G&&pe&&(Y.sn<F&&this.fragmentTracker.getState(ue)!==o.FragmentState.OK?(this.log("SN "+Y.sn+" just loaded, load next one: "+ue.sn),Y=ue):Y=null)}return Y},D.synchronizeToLiveEdge=function(C){var P=this.config,M=this.media;if(!!M){var N=this.hls.liveSyncPosition,B=M.currentTime,U=C.fragments[0].start,F=C.edge,j=B>=U-P.maxFragLookUpTolerance&&B<=F;if(N!==null&&M.duration>N&&(B<N||!j)){var $=P.liveMaxLatencyDuration!==void 0?P.liveMaxLatencyDuration:P.liveMaxLatencyDurationCount*C.targetduration;(!j&&M.readyState<4||B<F-$)&&(this.loadedmetadata||(this.nextLoadPosition=N),M.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+F+", reset currentTime to : "+N.toFixed(3)),M.currentTime=N))}}},D.alignPlaylists=function(C,P){var M=this.levels,N=this.levelLastLoaded,B=this.fragPrevious,U=N!==null?M[N]:null,F=C.fragments.length;if(!F)return this.warn("No fragments in live playlist"),0;var j=C.fragments[0].start,$=!P,G=C.alignedSliding&&Object(n.isFiniteNumber)(j);if($||!G&&!j){Object(y.alignStream)(B,U,C);var Y=C.fragments[0].start;return this.log("Live playlist sliding: "+Y.toFixed(2)+" start-sn: "+(P?P.startSN:"na")+"->"+C.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+F),Y}return j},D.waitForCdnTuneIn=function(C){var P=3;return C.live&&C.canBlockReload&&C.tuneInGoal>Math.max(C.partHoldBack,C.partTarget*P)},D.setStartPosition=function(C,P){var M=this.startPosition;if(M<P&&(M=-1),M===-1||this.lastCurrentTime===-1){var N=C.startTimeOffset;Object(n.isFiniteNumber)(N)?(M=P+N,N<0&&(M+=C.totalduration),M=Math.min(Math.max(P,M),P+C.totalduration),this.log("Start time offset "+N+" found in playlist, adjust startPosition to "+M),this.startPosition=M):C.live?M=this.hls.liveSyncPosition||P:this.startPosition=M=0,this.lastCurrentTime=M}this.nextLoadPosition=M},D.getLoadPosition=function(){var C=this.media,P=0;return this.loadedmetadata&&C?P=C.currentTime:this.nextLoadPosition&&(P=this.nextLoadPosition),P},D.handleFragLoadAborted=function(C,P){this.transmuxer&&C.sn!=="initSegment"&&C.stats.aborted&&(this.warn("Fragment "+C.sn+(P?" part"+P.index:"")+" of level "+C.level+" was aborted"),this.resetFragmentLoading(C))},D.resetFragmentLoading=function(C){(!this.fragCurrent||!this.fragContextChanged(C))&&(this.state=L.IDLE)},D.onFragmentOrKeyLoadError=function(C,P){if(!P.fatal){var M=P.frag;if(!(!M||M.type!==C)){var N=this.fragCurrent;console.assert(N&&M.sn===N.sn&&M.level===N.level&&M.urlId===N.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(M.level))return;var U=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+M.sn+" of "+C+" "+M.level+" failed to load, retrying in "+U+"ms"),this.retryDate=self.performance.now()+U,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else P.levelRetry?(C===E.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(h.logger.error(P.details+" reaches max retry, redispatch as fatal ..."),P.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},D.afterBufferFlushed=function(C,P,M){if(!!C){var N=f.BufferHelper.getBuffered(C);this.fragmentTracker.detectEvictedFragments(P,N,M),this.state===L.ENDED&&this.resetLoadingState()}},D.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},D.resetLiveStartWhenNotLoaded=function(C){if(!this.loadedmetadata){this.startFragRequested=!1;var P=this.levels?this.levels[C].details:null;if(P!=null&&P.live)return this.startPosition=-1,this.setStartPosition(P,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},D.updateLevelTiming=function(C,P,M,N){var B=this,U=M.details;console.assert(!!U,"level.details must be defined");var F=Object.keys(C.elementaryStreams).reduce(function(j,$){var G=C.elementaryStreams[$];if(G){var Y=G.endPTS-G.startPTS;if(Y<=0)return B.warn("Could not parse fragment "+C.sn+" "+$+" duration reliably ("+Y+") resetting transmuxer to fallback to playlist timing"),B.resetTransmuxer(),j||!1;var X=N?0:Object(_.updateFragPTSDTS)(U,C,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return B.hls.trigger(p.Events.LEVEL_PTS_UPDATED,{details:U,level:M,drift:X,type:$,frag:C,start:G.startPTS,end:G.endPTS}),!0}return j},!1);F?(this.state=L.PARSED,this.hls.trigger(p.Events.FRAG_PARSED,{frag:C,part:P})):this.resetLoadingState()},D.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},x(O,[{key:"state",get:function(){return this._state},set:function(C){var P=this._state;P!==C&&(this._state=C,this.log(P+"->"+C))}}]),O}(a.default)},"./src/controller/buffer-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return b});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),f=t("./src/errors.ts"),h=t("./src/utils/buffer-helper.ts"),p=t("./src/utils/mediasource-helper.ts"),l=t("./src/loader/fragment.ts"),u=t("./src/controller/buffer-operation-queue.ts"),m=Object(p.getMediaSource)(),y=/([ha]vc.)(?:\.[^.,]+)+/,b=function(){function _(c){var v=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var E=v.hls,d=v.media,x=v.mediaSource;o.logger.log("[buffer-controller]: Media source opened"),d&&(v.updateMediaElementDuration(),E.trigger(a.Events.MEDIA_ATTACHED,{media:d})),x&&x.removeEventListener("sourceopen",v._onMediaSourceOpen),v.checkPendingTracks()},this._onMediaSourceClose=function(){o.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){o.logger.log("[buffer-controller]: Media source ended")},this.hls=c,this._initSourceBuffer(),this.registerListeners()}var g=_.prototype;return g.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},g.destroy=function(){this.unregisterListeners(),this.details=null},g.registerListeners=function(){var v=this.hls;v.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(a.Events.BUFFER_RESET,this.onBufferReset,this),v.on(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),v.on(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.on(a.Events.BUFFER_EOS,this.onBufferEos,this),v.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),v.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),v.on(a.Events.FRAG_PARSED,this.onFragParsed,this),v.on(a.Events.FRAG_CHANGED,this.onFragChanged,this)},g.unregisterListeners=function(){var v=this.hls;v.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(a.Events.BUFFER_RESET,this.onBufferReset,this),v.off(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),v.off(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.off(a.Events.BUFFER_EOS,this.onBufferEos,this),v.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),v.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),v.off(a.Events.FRAG_PARSED,this.onFragParsed,this),v.off(a.Events.FRAG_CHANGED,this.onFragChanged,this)},g._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new u.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},g.onManifestParsed=function(v,E){var d=2;(E.audio&&!E.video||!E.altAudio)&&(d=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=d,this.details=null,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},g.onMediaAttaching=function(v,E){var d=this.media=E.media;if(d&&m){var x=this.mediaSource=new m;x.addEventListener("sourceopen",this._onMediaSourceOpen),x.addEventListener("sourceended",this._onMediaSourceEnded),x.addEventListener("sourceclose",this._onMediaSourceClose),d.src=self.URL.createObjectURL(x),this._objectUrl=d.src}},g.onMediaDetaching=function(){var v=this.media,E=this.mediaSource,d=this._objectUrl;if(E){if(o.logger.log("[buffer-controller]: media source detaching"),E.readyState==="open")try{E.endOfStream()}catch(x){o.logger.warn("[buffer-controller]: onMediaDetaching: "+x.message+" while calling endOfStream")}this.onBufferReset(),E.removeEventListener("sourceopen",this._onMediaSourceOpen),E.removeEventListener("sourceended",this._onMediaSourceEnded),E.removeEventListener("sourceclose",this._onMediaSourceClose),v&&(d&&self.URL.revokeObjectURL(d),v.src===d?(v.removeAttribute("src"),v.load()):o.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(a.Events.MEDIA_DETACHED,void 0)},g.onBufferReset=function(){var v=this;this.getSourceBufferTypes().forEach(function(E){var d=v.sourceBuffer[E];try{d&&(v.removeBufferListeners(E),v.mediaSource&&v.mediaSource.removeSourceBuffer(d),v.sourceBuffer[E]=void 0)}catch(x){o.logger.warn("[buffer-controller]: Failed to reset the "+E+" buffer",x)}}),this._initSourceBuffer()},g.onBufferCodecs=function(v,E){var d=this,x=this.getSourceBufferTypes().length;Object.keys(E).forEach(function(S){if(x){var T=d.tracks[S];if(T&&typeof T.buffer.changeType=="function"){var w=E[S],L=w.codec,I=w.levelCodec,A=w.container,O=(T.levelCodec||T.codec).replace(y,"$1"),D=(I||L).replace(y,"$1");if(O!==D){var R=A+";codecs="+(I||L);d.appendChangeType(S,R)}}}else d.pendingTracks[S]=E[S]}),!x&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},g.appendChangeType=function(v,E){var d=this,x=this.operationQueue,S={execute:function(){var w=d.sourceBuffer[v];w&&(o.logger.log("[buffer-controller]: changing "+v+" sourceBuffer type to "+E),w.changeType(E)),x.shiftAndExecuteNext(v)},onStart:function(){},onComplete:function(){},onError:function(w){o.logger.warn("[buffer-controller]: Failed to change "+v+" SourceBuffer type",w)}};x.append(S,v)},g.onBufferAppending=function(v,E){var d=this,x=this.hls,S=this.operationQueue,T=this.tracks,w=E.data,L=E.type,I=E.frag,A=E.part,O=E.chunkMeta,D=O.buffering[L],R=self.performance.now();D.start=R;var C=I.stats.buffering,P=A?A.stats.buffering:null;C.start===0&&(C.start=R),P&&P.start===0&&(P.start=R);var M=T.audio,N=L==="audio"&&O.id===1&&(M==null?void 0:M.container)==="audio/mpeg",B={execute:function(){if(D.executeStart=self.performance.now(),N){var F=d.sourceBuffer[L];if(F){var j=I.start-F.timestampOffset;Math.abs(j)>=.1&&(o.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+I.start+" (delta: "+j+") sn: "+I.sn+")"),F.timestampOffset=I.start)}}d.appendExecutor(w,L)},onStart:function(){},onComplete:function(){var F=self.performance.now();D.executeEnd=D.end=F,C.first===0&&(C.first=F),P&&P.first===0&&(P.first=F);var j=d.sourceBuffer,$={};for(var G in j)$[G]=h.BufferHelper.getBuffered(j[G]);d.appendError=0,d.hls.trigger(a.Events.BUFFER_APPENDED,{type:L,frag:I,part:A,chunkMeta:O,parent:I.type,timeRanges:$})},onError:function(F){o.logger.error("[buffer-controller]: Error encountered while trying to append to the "+L+" SourceBuffer",F);var j={type:f.ErrorTypes.MEDIA_ERROR,parent:I.type,details:f.ErrorDetails.BUFFER_APPEND_ERROR,err:F,fatal:!1};F.code===DOMException.QUOTA_EXCEEDED_ERR?j.details=f.ErrorDetails.BUFFER_FULL_ERROR:(d.appendError++,j.details=f.ErrorDetails.BUFFER_APPEND_ERROR,d.appendError>x.config.appendErrorMaxRetry&&(o.logger.error("[buffer-controller]: Failed "+x.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),j.fatal=!0)),x.trigger(a.Events.ERROR,j)}};S.append(B,L)},g.onBufferFlushing=function(v,E){var d=this,x=this.operationQueue,S=function(w){return{execute:d.removeExecutor.bind(d,w,E.startOffset,E.endOffset),onStart:function(){},onComplete:function(){d.hls.trigger(a.Events.BUFFER_FLUSHED,{type:w})},onError:function(I){o.logger.warn("[buffer-controller]: Failed to remove from "+w+" SourceBuffer",I)}}};E.type?x.append(S(E.type),E.type):this.getSourceBufferTypes().forEach(function(T){x.append(S(T),T)})},g.onFragParsed=function(v,E){var d=this,x=E.frag,S=E.part,T=[],w=S?S.elementaryStreams:x.elementaryStreams;w[l.ElementaryStreamTypes.AUDIOVIDEO]?T.push("audiovideo"):(w[l.ElementaryStreamTypes.AUDIO]&&T.push("audio"),w[l.ElementaryStreamTypes.VIDEO]&&T.push("video"));var L=function(){var A=self.performance.now();x.stats.buffering.end=A,S&&(S.stats.buffering.end=A);var O=S?S.stats:x.stats;d.hls.trigger(a.Events.FRAG_BUFFERED,{frag:x,part:S,stats:O,id:x.type})};T.length===0&&o.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+x.type+" level: "+x.level+" sn: "+x.sn),this.blockBuffers(L,T)},g.onFragChanged=function(v,E){this.flushBackBuffer()},g.onBufferEos=function(v,E){var d=this,x=this.getSourceBufferTypes().reduce(function(S,T){var w=d.sourceBuffer[T];return(!E.type||E.type===T)&&w&&!w.ended&&(w.ended=!0,o.logger.log("[buffer-controller]: "+T+" sourceBuffer now EOS")),S&&!!(!w||w.ended)},!0);x&&this.blockBuffers(function(){var S=d.mediaSource;!S||S.readyState!=="open"||S.endOfStream()})},g.onLevelUpdated=function(v,E){var d=E.details;!d.fragments.length||(this.details=d,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},g.flushBackBuffer=function(){var v=this.hls,E=this.details,d=this.media,x=this.sourceBuffer;if(!(!d||E===null)){var S=this.getSourceBufferTypes();if(!!S.length){var T=E.live&&v.config.liveBackBufferLength!==null?v.config.liveBackBufferLength:v.config.backBufferLength;if(!(!Object(n.isFiniteNumber)(T)||T<0)){var w=d.currentTime,L=E.levelTargetDuration,I=Math.max(T,L),A=Math.floor(w/L)*L-I;S.forEach(function(O){var D=x[O];if(D){var R=h.BufferHelper.getBuffered(D);R.length>0&&A>R.start(0)&&(v.trigger(a.Events.BACK_BUFFER_REACHED,{bufferEnd:A}),E.live&&v.trigger(a.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:A}),v.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:A,type:O}))}})}}}},g.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var v=this.details,E=this.hls,d=this.media,x=this.mediaSource,S=v.fragments[0].start+v.totalduration,T=d.duration,w=Object(n.isFiniteNumber)(x.duration)?x.duration:0;v.live&&E.config.liveDurationInfinity?(o.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),x.duration=1/0,this.updateSeekableRange(v)):(S>w&&S>T||!Object(n.isFiniteNumber)(T))&&(o.logger.log("[buffer-controller]: Updating Media Source duration to "+S.toFixed(3)),x.duration=S)}},g.updateSeekableRange=function(v){var E=this.mediaSource,d=v.fragments,x=d.length;if(x&&v.live&&E!==null&&E!==void 0&&E.setLiveSeekableRange){var S=Math.max(0,d[0].start),T=Math.max(S,S+v.totalduration);E.setLiveSeekableRange(S,T)}},g.checkPendingTracks=function(){var v=this.bufferCodecEventsExpected,E=this.operationQueue,d=this.pendingTracks,x=Object.keys(d).length;if(x&&!v||x===2){this.createSourceBuffers(d),this.pendingTracks={};var S=this.getSourceBufferTypes();if(S.length===0){this.hls.trigger(a.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}S.forEach(function(T){E.executeNext(T)})}},g.createSourceBuffers=function(v){var E=this.sourceBuffer,d=this.mediaSource;if(!d)throw Error("createSourceBuffers called when mediaSource was null");var x=0;for(var S in v)if(!E[S]){var T=v[S];if(!T)throw Error("source buffer exists for track "+S+", however track does not");var w=T.levelCodec||T.codec,L=T.container+";codecs="+w;o.logger.log("[buffer-controller]: creating sourceBuffer("+L+")");try{var I=E[S]=d.addSourceBuffer(L),A=S;this.addBufferListener(A,"updatestart",this._onSBUpdateStart),this.addBufferListener(A,"updateend",this._onSBUpdateEnd),this.addBufferListener(A,"error",this._onSBUpdateError),this.tracks[S]={buffer:I,codec:w,container:T.container,levelCodec:T.levelCodec,id:T.id},x++}catch(O){o.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+O.message),this.hls.trigger(a.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:O,mimeType:L})}}x&&this.hls.trigger(a.Events.BUFFER_CREATED,{tracks:this.tracks})},g._onSBUpdateStart=function(v){var E=this.operationQueue,d=E.current(v);d.onStart()},g._onSBUpdateEnd=function(v){var E=this.operationQueue,d=E.current(v);d.onComplete(),E.shiftAndExecuteNext(v)},g._onSBUpdateError=function(v,E){o.logger.error("[buffer-controller]: "+v+" SourceBuffer error",E),this.hls.trigger(a.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var d=this.operationQueue.current(v);d&&d.onError(E)},g.removeExecutor=function(v,E,d){var x=this.media,S=this.mediaSource,T=this.operationQueue,w=this.sourceBuffer,L=w[v];if(!x||!S||!L){o.logger.warn("[buffer-controller]: Attempting to remove from the "+v+" SourceBuffer, but it does not exist"),T.shiftAndExecuteNext(v);return}var I=Object(n.isFiniteNumber)(x.duration)?x.duration:1/0,A=Object(n.isFiniteNumber)(S.duration)?S.duration:1/0,O=Math.max(0,E),D=Math.min(d,I,A);D>O?(o.logger.log("[buffer-controller]: Removing ["+O+","+D+"] from the "+v+" SourceBuffer"),console.assert(!L.updating,v+" sourceBuffer must not be updating"),L.remove(O,D)):T.shiftAndExecuteNext(v)},g.appendExecutor=function(v,E){var d=this.operationQueue,x=this.sourceBuffer,S=x[E];if(!S){o.logger.warn("[buffer-controller]: Attempting to append to the "+E+" SourceBuffer, but it does not exist"),d.shiftAndExecuteNext(E);return}S.ended=!1,console.assert(!S.updating,E+" sourceBuffer must not be updating"),S.appendBuffer(v)},g.blockBuffers=function(v,E){var d=this;if(E===void 0&&(E=this.getSourceBufferTypes()),!E.length){o.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(v);return}var x=this.operationQueue,S=E.map(function(T){return x.appendBlocker(T)});Promise.all(S).then(function(){v(),E.forEach(function(T){var w=d.sourceBuffer[T];(!w||!w.updating)&&x.shiftAndExecuteNext(T)})})},g.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},g.addBufferListener=function(v,E,d){var x=this.sourceBuffer[v];if(!!x){var S=d.bind(this,v);this.listeners[v].push({event:E,listener:S}),x.addEventListener(E,S)}},g.removeBufferListeners=function(v){var E=this.sourceBuffer[v];!E||this.listeners[v].forEach(function(d){E.removeEventListener(d.event,d.listener)})},_}()},"./src/controller/buffer-operation-queue.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return a});var n=t("./src/utils/logger.ts"),a=function(){function o(h){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=h}var f=o.prototype;return f.append=function(p,l){var u=this.queues[l];u.push(p),u.length===1&&this.buffers[l]&&this.executeNext(l)},f.insertAbort=function(p,l){var u=this.queues[l];u.unshift(p),this.executeNext(l)},f.appendBlocker=function(p){var l,u=new Promise(function(y){l=y}),m={execute:l,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(m,p),u},f.executeNext=function(p){var l=this.buffers,u=this.queues,m=l[p],y=u[p];if(y.length){var b=y[0];try{b.execute()}catch(_){n.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),b.onError(_),(!m||!m.updating)&&(y.shift(),this.executeNext(p))}}},f.shiftAndExecuteNext=function(p){this.queues[p].shift(),this.executeNext(p)},f.current=function(p){return this.queues[p][0]},o}()},"./src/controller/cap-level-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts");function a(h,p){for(var l=0;l<p.length;l++){var u=p[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(h,u.key,u)}}function o(h,p,l){return p&&a(h.prototype,p),l&&a(h,l),h}var f=function(){function h(l){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=l,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var p=h.prototype;return p.setStreamController=function(u){this.streamController=u},p.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},p.registerListeners=function(){var u=this.hls;u.on(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),u.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.unregisterListener=function(){var u=this.hls;u.off(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),u.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.onFpsDropLevelCapping=function(u,m){h.isLevelAllowed(m.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(m.droppedLevel)},p.onMediaAttaching=function(u,m){this.media=m.media instanceof HTMLVideoElement?m.media:null},p.onManifestParsed=function(u,m){var y=this.hls;this.restrictedLevels=[],this.firstLevel=m.firstLevel,y.config.capLevelToPlayerSize&&m.video&&this.startCapping()},p.onBufferCodecs=function(u,m){var y=this.hls;y.config.capLevelToPlayerSize&&m.video&&this.startCapping()},p.onMediaDetaching=function(){this.stopCapping()},p.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var u=this.hls.levels;if(u.length){var m=this.hls;m.autoLevelCapping=this.getMaxLevel(u.length-1),m.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=m.autoLevelCapping}}},p.getMaxLevel=function(u){var m=this,y=this.hls.levels;if(!y.length)return-1;var b=y.filter(function(_,g){return h.isLevelAllowed(g,m.restrictedLevels)&&g<=u});return this.clientRect=null,h.getMaxLevelByMediaSize(b,this.mediaWidth,this.mediaHeight)},p.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},p.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},p.getDimensions=function(){if(this.clientRect)return this.clientRect;var u=this.media,m={width:0,height:0};if(u){var y=u.getBoundingClientRect();m.width=y.width,m.height=y.height,!m.width&&!m.height&&(m.width=y.right-y.left||u.width||0,m.height=y.bottom-y.top||u.height||0)}return this.clientRect=m,m},h.isLevelAllowed=function(u,m){return m===void 0&&(m=[]),m.indexOf(u)===-1},h.getMaxLevelByMediaSize=function(u,m,y){if(!u||!u.length)return-1;for(var b=function(E,d){return d?E.width!==d.width||E.height!==d.height:!0},_=u.length-1,g=0;g<u.length;g+=1){var c=u[g];if((c.width>=m||c.height>=y)&&b(c,u[g+1])){_=g;break}}return _},o(h,[{key:"mediaWidth",get:function(){return this.getDimensions().width*h.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*h.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var u=1;try{u=self.devicePixelRatio}catch(m){}return u}}]),h}();i.default=f},"./src/controller/cmcd-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return b});var n=t("./src/events.ts"),a=t("./src/types/cmcd.ts"),o=t("./src/utils/buffer-helper.ts"),f=t("./src/utils/logger.ts");function h(_,g){for(var c=0;c<g.length;c++){var v=g[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(_,v.key,v)}}function p(_,g,c){return g&&h(_.prototype,g),c&&h(_,c),_}function l(_,g){var c=typeof Symbol!="undefined"&&_[Symbol.iterator]||_["@@iterator"];if(c)return(c=c.call(_)).next.bind(c);if(Array.isArray(_)||(c=u(_))||g&&_&&typeof _.length=="number"){c&&(_=c);var v=0;return function(){return v>=_.length?{done:!0}:{done:!1,value:_[v++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u(_,g){if(!!_){if(typeof _=="string")return m(_,g);var c=Object.prototype.toString.call(_).slice(8,-1);if(c==="Object"&&_.constructor&&(c=_.constructor.name),c==="Map"||c==="Set")return Array.from(_);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return m(_,g)}}function m(_,g){(g==null||g>_.length)&&(g=_.length);for(var c=0,v=new Array(g);c<g;c++)v[c]=_[c];return v}function y(){return y=Object.assign||function(_){for(var g=1;g<arguments.length;g++){var c=arguments[g];for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(_[v]=c[v])}return _},y.apply(this,arguments)}var b=function(){function _(c){var v=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){v.initialized&&(v.starved=!0),v.buffering=!0},this.onPlaying=function(){v.initialized||(v.initialized=!0),v.buffering=!1},this.applyPlaylistData=function(x){try{v.apply(x,{ot:a.CMCDObjectType.MANIFEST,su:!v.initialized})}catch(S){f.logger.warn("Could not generate manifest CMCD data.",S)}},this.applyFragmentData=function(x){try{var S=x.frag,T=v.hls.levels[S.level],w=v.getObjectType(S),L={d:S.duration*1e3,ot:w};(w===a.CMCDObjectType.VIDEO||w===a.CMCDObjectType.AUDIO||w==a.CMCDObjectType.MUXED)&&(L.br=T.bitrate/1e3,L.tb=v.getTopBandwidth(w)/1e3,L.bl=v.getBufferLength(w)),v.apply(x,L)}catch(I){f.logger.warn("Could not generate segment CMCD data.",I)}},this.hls=c;var E=this.config=c.config,d=E.cmcd;d!=null&&(E.pLoader=this.createPlaylistLoader(),E.fLoader=this.createFragmentLoader(),this.sid=d.sessionId||_.uuid(),this.cid=d.contentId,this.useHeaders=d.useHeaders===!0,this.registerListeners())}var g=_.prototype;return g.registerListeners=function(){var v=this.hls;v.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),v.on(n.Events.BUFFER_CREATED,this.onBufferCreated,this)},g.unregisterListeners=function(){var v=this.hls;v.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),v.off(n.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},g.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},g.onMediaAttached=function(v,E){this.media=E.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},g.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},g.onBufferCreated=function(v,E){var d,x;this.audioBuffer=(d=E.tracks.audio)===null||d===void 0?void 0:d.buffer,this.videoBuffer=(x=E.tracks.video)===null||x===void 0?void 0:x.buffer},g.createData=function(){var v;return{v:a.CMCDVersion,sf:a.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(v=this.media)===null||v===void 0?void 0:v.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},g.apply=function(v,E){E===void 0&&(E={}),y(E,this.createData());var d=E.ot===a.CMCDObjectType.INIT||E.ot===a.CMCDObjectType.VIDEO||E.ot===a.CMCDObjectType.MUXED;if(this.starved&&d&&(E.bs=!0,E.su=!0,this.starved=!1),E.su==null&&(E.su=this.buffering),this.useHeaders){var x=_.toHeaders(E);if(!Object.keys(x).length)return;v.headers||(v.headers={}),y(v.headers,x)}else{var S=_.toQuery(E);if(!S)return;v.url=_.appendQueryToUri(v.url,S)}},g.getObjectType=function(v){var E=v.type;if(E==="subtitle")return a.CMCDObjectType.TIMED_TEXT;if(v.sn==="initSegment")return a.CMCDObjectType.INIT;if(E==="audio")return a.CMCDObjectType.AUDIO;if(E==="main")return this.hls.audioTracks.length?a.CMCDObjectType.VIDEO:a.CMCDObjectType.MUXED},g.getTopBandwidth=function(v){var E=0,d,x=this.hls;if(v===a.CMCDObjectType.AUDIO)d=x.audioTracks;else{var S=x.maxAutoLevel,T=S>-1?S+1:x.levels.length;d=x.levels.slice(0,T)}for(var w=l(d),L;!(L=w()).done;){var I=L.value;I.bitrate>E&&(E=I.bitrate)}return E>0?E:NaN},g.getBufferLength=function(v){var E=this.hls.media,d=v===a.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!d||!E)return NaN;var x=o.BufferHelper.bufferInfo(d,E.currentTime,this.config.maxBufferHole);return x.len*1e3},g.createPlaylistLoader=function(){var v=this.config.pLoader,E=this.applyPlaylistData,d=v||this.config.loader;return function(){function x(T){this.loader=void 0,this.loader=new d(T)}var S=x.prototype;return S.destroy=function(){this.loader.destroy()},S.abort=function(){this.loader.abort()},S.load=function(w,L,I){E(w),this.loader.load(w,L,I)},p(x,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),x}()},g.createFragmentLoader=function(){var v=this.config.fLoader,E=this.applyFragmentData,d=v||this.config.loader;return function(){function x(T){this.loader=void 0,this.loader=new d(T)}var S=x.prototype;return S.destroy=function(){this.loader.destroy()},S.abort=function(){this.loader.abort()},S.load=function(w,L,I){E(w),this.loader.load(w,L,I)},p(x,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),x}()},_.uuid=function(){var v=URL.createObjectURL(new Blob),E=v.toString();return URL.revokeObjectURL(v),E.substr(E.lastIndexOf("/")+1)},_.serialize=function(v){for(var E=[],d=function(N){return!Number.isNaN(N)&&N!=null&&N!==""&&N!==!1},x=function(N){return Math.round(N)},S=function(N){return x(N/100)*100},T=function(N){return encodeURIComponent(N)},w={br:x,d:x,bl:S,dl:S,mtp:S,nor:T,rtp:S,tb:x},L=Object.keys(v||{}).sort(),I=l(L),A;!(A=I()).done;){var O=A.value,D=v[O];if(!!d(D)&&!(O==="v"&&D===1)&&!(O=="pr"&&D===1)){var R=w[O];R&&(D=R(D));var C=typeof D,P=void 0;O==="ot"||O==="sf"||O==="st"?P=O+"="+D:C==="boolean"?P=O:C==="number"?P=O+"="+D:P=O+"="+JSON.stringify(D),E.push(P)}}return E.join(",")},_.toHeaders=function(v){for(var E=Object.keys(v),d={},x=["Object","Request","Session","Status"],S=[{},{},{},{}],T={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},w=0,L=E;w<L.length;w++){var I=L[w],A=T[I]!=null?T[I]:1;S[A][I]=v[I]}for(var O=0;O<S.length;O++){var D=_.serialize(S[O]);D&&(d["CMCD-"+x[O]]=D)}return d},_.toQuery=function(v){return"CMCD="+encodeURIComponent(_.serialize(v))},_.appendQueryToUri=function(v,E){if(!E)return v;var d=v.includes("?")?"&":"?";return""+v+d+E},_}()},"./src/controller/eme-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),f=t("./src/utils/mediakeys-helper.ts");function h(b,_){for(var g=0;g<_.length;g++){var c=_[g];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(b,c.key,c)}}function p(b,_,g){return _&&h(b.prototype,_),g&&h(b,g),b}var l=3,u=function(_,g,c){var v={audioCapabilities:[],videoCapabilities:[]};return _.forEach(function(E){v.audioCapabilities.push({contentType:'audio/mp4; codecs="'+E+'"',robustness:c.audioRobustness||""})}),g.forEach(function(E){v.videoCapabilities.push({contentType:'video/mp4; codecs="'+E+'"',robustness:c.videoRobustness||""})}),[v]},m=function(_,g,c,v){switch(_){case f.KeySystems.WIDEVINE:return u(g,c,v);default:throw new Error("Unknown key-system: "+_)}},y=function(){function b(g){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=g,this._config=g.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var _=b.prototype;return _.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},_._registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_._unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_.getLicenseServerUrl=function(c){switch(c){case f.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+c+'"')},_._attemptKeySystemAccess=function(c,v,E){var d=this,x=m(c,v,E,this._drmSystemOptions);o.logger.log("Requesting encrypted media key-system access");var S=this.requestMediaKeySystemAccess(c,x);this.mediaKeysPromise=S.then(function(T){return d._onMediaKeySystemAccessObtained(c,T)}),S.catch(function(T){o.logger.error('Failed to obtain key-system "'+c+'" access:',T)})},_._onMediaKeySystemAccessObtained=function(c,v){var E=this;o.logger.log('Access for key-system "'+c+'" obtained');var d={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:v,mediaKeySystemDomain:c};this._mediaKeysList.push(d);var x=Promise.resolve().then(function(){return v.createMediaKeys()}).then(function(S){return d.mediaKeys=S,o.logger.log('Media-keys created for key-system "'+c+'"'),E._onMediaKeysCreated(),S});return x.catch(function(S){o.logger.error("Failed to create media-keys:",S)}),x},_._onMediaKeysCreated=function(){var c=this;this._mediaKeysList.forEach(function(v){v.mediaKeysSession||(v.mediaKeysSession=v.mediaKeys.createSession(),c._onNewMediaKeySession(v.mediaKeysSession))})},_._onNewMediaKeySession=function(c){var v=this;o.logger.log("New key-system session "+c.sessionId),c.addEventListener("message",function(E){v._onKeySessionMessage(c,E.message)},!1)},_._onKeySessionMessage=function(c,v){o.logger.log("Got EME message event, creating license request"),this._requestLicense(v,function(E){o.logger.log("Received license data (length: "+(E&&E.byteLength)+"), updating key-session"),c.update(E)})},_.onMediaEncrypted=function(c){var v=this;if(o.logger.log('Media is encrypted using "'+c.initDataType+'" init data type'),!this.mediaKeysPromise){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var E=function(x){!v._media||(v._attemptSetMediaKeys(x),v._generateRequestWithPreferredKeySession(c.initDataType,c.initData))};this.mediaKeysPromise.then(E).catch(E)},_._attemptSetMediaKeys=function(c){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var v=this._mediaKeysList[0];if(!v||!v.mediaKeys){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}o.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(v.mediaKeys),this._hasSetMediaKeys=!0}},_._generateRequestWithPreferredKeySession=function(c,v){var E=this,d=this._mediaKeysList[0];if(!d){o.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(d.mediaKeysSessionInitialized){o.logger.warn("Key-Session already initialized but requested again");return}var x=d.mediaKeysSession;if(!x){o.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!v){o.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}o.logger.log('Generating key-session request for "'+c+'" init data type'),d.mediaKeysSessionInitialized=!0,x.generateRequest(c,v).then(function(){o.logger.debug("Key-session generation succeeded")}).catch(function(S){o.logger.error("Error generating key-session request:",S),E.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},_._createLicenseXhr=function(c,v,E){var d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,d,c,v,E);var x=this._licenseXhrSetup;if(x)try{x.call(this.hls,d,c),x=void 0}catch(S){o.logger.error(S)}try{d.readyState||d.open("POST",c,!0),x&&x.call(this.hls,d,c)}catch(S){throw new Error("issue setting up KeySystem license XHR "+S)}return d},_._onLicenseRequestReadyStageChange=function(c,v,E,d){switch(c.readyState){case 4:if(c.status===200){this._requestLicenseFailureCount=0,o.logger.log("License request succeeded");var x=c.response,S=this._licenseResponseCallback;if(S)try{x=S.call(this.hls,c,v)}catch(w){o.logger.error(w)}d(x)}else{if(o.logger.error("License Request XHR failed ("+v+"). Status: "+c.status+" ("+c.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l){this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var T=l-this._requestLicenseFailureCount+1;o.logger.warn("Retrying license request, "+T+" attempts left"),this._requestLicense(E,d)}break}},_._generateLicenseRequestChallenge=function(c,v){switch(c.mediaKeySystemDomain){case f.KeySystems.WIDEVINE:return v}throw new Error("unsupported key-system: "+c.mediaKeySystemDomain)},_._requestLicense=function(c,v){o.logger.log("Requesting content license for key-system");var E=this._mediaKeysList[0];if(!E){o.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var d=this.getLicenseServerUrl(E.mediaKeySystemDomain),x=this._createLicenseXhr(d,c,v);o.logger.log("Sending license request to URL: "+d);var S=this._generateLicenseRequestChallenge(E,c);x.send(S)}catch(T){o.logger.error("Failure requesting DRM license: "+T),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},_.onMediaAttached=function(c,v){if(!!this._emeEnabled){var E=v.media;this._media=E,E.addEventListener("encrypted",this._onMediaEncrypted)}},_.onMediaDetached=function(){var c=this._media,v=this._mediaKeysList;!c||(c.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(v.map(function(E){if(E.mediaKeysSession)return E.mediaKeysSession.close().catch(function(){})})).then(function(){return c.setMediaKeys(null)}).catch(function(){}))},_.onManifestParsed=function(c,v){if(!!this._emeEnabled){var E=v.levels.map(function(x){return x.audioCodec}).filter(function(x){return!!x}),d=v.levels.map(function(x){return x.videoCodec}).filter(function(x){return!!x});this._attemptKeySystemAccess(f.KeySystems.WIDEVINE,E,d)}},p(b,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),b}();i.default=y},"./src/controller/fps-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/logger.ts"),o=function(){function f(p){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=p,this.registerListeners()}var h=f.prototype;return h.setStreamController=function(l){this.streamController=l},h.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},h.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching)},h.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},h.onMediaAttaching=function(l,u){var m=this.hls.config;if(m.capLevelOnFPSDrop){var y=u.media instanceof self.HTMLVideoElement?u.media:null;this.media=y,y&&typeof y.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),m.fpsDroppedMonitoringPeriod)}},h.checkFPS=function(l,u,m){var y=performance.now();if(u){if(this.lastTime){var b=y-this.lastTime,_=m-this.lastDroppedFrames,g=u-this.lastDecodedFrames,c=1e3*_/b,v=this.hls;if(v.trigger(n.Events.FPS_DROP,{currentDropped:_,currentDecoded:g,totalDroppedFrames:m}),c>0&&_>v.config.fpsDroppedMonitoringThreshold*g){var E=v.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+E),E>0&&(v.autoLevelCapping===-1||v.autoLevelCapping>=E)&&(E=E-1,v.trigger(n.Events.FPS_DROP_LEVEL_CAPPING,{level:E,droppedLevel:v.currentLevel}),v.autoLevelCapping=E,this.streamController.nextLevelSwitch())}}this.lastTime=y,this.lastDroppedFrames=m,this.lastDecodedFrames=u}},h.checkFPSInterval=function(){var l=this.media;if(l)if(this.isVideoPlaybackQualityAvailable){var u=l.getVideoPlaybackQuality();this.checkFPS(l,u.totalVideoFrames,u.droppedVideoFrames)}else this.checkFPS(l,l.webkitDecodedFrameCount,l.webkitDroppedFrameCount)},f}();i.default=o},"./src/controller/fragment-finders.ts":function(r,i,t){t.r(i),t.d(i,"findFragmentByPDT",function(){return o}),t.d(i,"findFragmentByPTS",function(){return f}),t.d(i,"fragmentWithinToleranceTest",function(){return h}),t.d(i,"pdtWithinToleranceTest",function(){return p}),t.d(i,"findFragWithCC",function(){return l});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/binary-search.ts");function o(u,m,y){if(m===null||!Array.isArray(u)||!u.length||!Object(n.isFiniteNumber)(m))return null;var b=u[0].programDateTime;if(m<(b||0))return null;var _=u[u.length-1].endProgramDateTime;if(m>=(_||0))return null;y=y||0;for(var g=0;g<u.length;++g){var c=u[g];if(p(m,y,c))return c}return null}function f(u,m,y,b){y===void 0&&(y=0),b===void 0&&(b=0);var _=null;if(u?_=m[u.sn-m[0].sn+1]||null:y===0&&m[0].start===0&&(_=m[0]),_&&h(y,b,_)===0)return _;var g=a.default.search(m,h.bind(null,y,b));return g||_}function h(u,m,y){u===void 0&&(u=0),m===void 0&&(m=0);var b=Math.min(m,y.duration+(y.deltaPTS?y.deltaPTS:0));return y.start+y.duration-b<=u?1:y.start-b>u&&y.start?-1:0}function p(u,m,y){var b=Math.min(m,y.duration+(y.deltaPTS?y.deltaPTS:0))*1e3,_=y.endProgramDateTime||0;return _-b>u}function l(u,m){return a.default.search(u,function(y){return y.cc<m?1:y.cc>m?-1:0})}},"./src/controller/fragment-tracker.ts":function(r,i,t){t.r(i),t.d(i,"FragmentState",function(){return o}),t.d(i,"FragmentTracker",function(){return f});var n=t("./src/events.ts"),a=t("./src/types/loader.ts"),o;(function(l){l.NOT_LOADED="NOT_LOADED",l.BACKTRACKED="BACKTRACKED",l.APPENDING="APPENDING",l.PARTIAL="PARTIAL",l.OK="OK"})(o||(o={}));var f=function(){function l(m){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=m,this._registerListeners()}var u=l.prototype;return u._registerListeners=function(){var y=this.hls;y.on(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),y.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.on(n.Events.FRAG_LOADED,this.onFragLoaded,this)},u._unregisterListeners=function(){var y=this.hls;y.off(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),y.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.off(n.Events.FRAG_LOADED,this.onFragLoaded,this)},u.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},u.getAppendedFrag=function(y,b){if(b===a.PlaylistLevelType.MAIN){var _=this.activeFragment,g=this.activeParts;if(!_)return null;if(g)for(var c=g.length;c--;){var v=g[c],E=v?v.end:_.appendedPTS;if(v.start<=y&&E!==void 0&&y<=E)return c>9&&(this.activeParts=g.slice(c-9)),v}else if(_.start<=y&&_.appendedPTS!==void 0&&y<=_.appendedPTS)return _}return this.getBufferedFrag(y,b)},u.getBufferedFrag=function(y,b){for(var _=this.fragments,g=Object.keys(_),c=g.length;c--;){var v=_[g[c]];if((v==null?void 0:v.body.type)===b&&v.buffered){var E=v.body;if(E.start<=y&&y<=E.end)return E}}return null},u.detectEvictedFragments=function(y,b,_){var g=this;Object.keys(this.fragments).forEach(function(c){var v=g.fragments[c];if(!!v){if(!v.buffered){v.body.type===_&&g.removeFragment(v.body);return}var E=v.range[y];!E||E.time.some(function(d){var x=!g.isTimeBuffered(d.startPTS,d.endPTS,b);return x&&g.removeFragment(v.body),x})}})},u.detectPartialFragments=function(y){var b=this,_=this.timeRanges,g=y.frag,c=y.part;if(!(!_||g.sn==="initSegment")){var v=p(g),E=this.fragments[v];!E||(Object.keys(_).forEach(function(d){var x=g.elementaryStreams[d];if(!!x){var S=_[d],T=c!==null||x.partial===!0;E.range[d]=b.getBufferedTimes(g,c,T,S)}}),E.backtrack=E.loaded=null,Object.keys(E.range).length?E.buffered=!0:this.removeFragment(E.body))}},u.fragBuffered=function(y){var b=p(y),_=this.fragments[b];_&&(_.backtrack=_.loaded=null,_.buffered=!0)},u.getBufferedTimes=function(y,b,_,g){for(var c={time:[],partial:_},v=b?b.start:y.start,E=b?b.end:y.end,d=y.minEndPTS||E,x=y.maxStartPTS||v,S=0;S<g.length;S++){var T=g.start(S)-this.bufferPadding,w=g.end(S)+this.bufferPadding;if(x>=T&&d<=w){c.time.push({startPTS:Math.max(v,g.start(S)),endPTS:Math.min(E,g.end(S))});break}else if(v<w&&E>T)c.partial=!0,c.time.push({startPTS:Math.max(v,g.start(S)),endPTS:Math.min(E,g.end(S))});else if(E<=T)break}return c},u.getPartialFragment=function(y){var b=null,_,g,c,v=0,E=this.bufferPadding,d=this.fragments;return Object.keys(d).forEach(function(x){var S=d[x];!S||h(S)&&(g=S.body.start-E,c=S.body.end+E,y>=g&&y<=c&&(_=Math.min(y-g,c-y),v<=_&&(b=S.body,v=_)))}),b},u.getState=function(y){var b=p(y),_=this.fragments[b];return _?_.buffered?h(_)?o.PARTIAL:o.OK:_.backtrack?o.BACKTRACKED:o.APPENDING:o.NOT_LOADED},u.backtrack=function(y,b){var _=p(y),g=this.fragments[_];if(!g||g.backtrack)return null;var c=g.backtrack=b||g.loaded;return g.loaded=null,c},u.getBacktrackData=function(y){var b=p(y),_=this.fragments[b];if(_){var g,c=_.backtrack;if(c!=null&&(g=c.payload)!==null&&g!==void 0&&g.byteLength)return c;this.removeFragment(y)}return null},u.isTimeBuffered=function(y,b,_){for(var g,c,v=0;v<_.length;v++){if(g=_.start(v)-this.bufferPadding,c=_.end(v)+this.bufferPadding,y>=g&&b<=c)return!0;if(b<=g)return!1}return!1},u.onFragLoaded=function(y,b){var _=b.frag,g=b.part;if(!(_.sn==="initSegment"||_.bitrateTest||g)){var c=p(_);this.fragments[c]={body:_,loaded:b,backtrack:null,buffered:!1,range:Object.create(null)}}},u.onBufferAppended=function(y,b){var _=this,g=b.frag,c=b.part,v=b.timeRanges;if(g.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=g,c){var E=this.activeParts;E||(this.activeParts=E=[]),E.push(c)}else this.activeParts=null;this.timeRanges=v,Object.keys(v).forEach(function(d){var x=v[d];if(_.detectEvictedFragments(d,x),!c)for(var S=0;S<x.length;S++)g.appendedPTS=Math.max(x.end(S),g.appendedPTS||0)})},u.onFragBuffered=function(y,b){this.detectPartialFragments(b)},u.hasFragment=function(y){var b=p(y);return!!this.fragments[b]},u.removeFragmentsInRange=function(y,b,_){var g=this;Object.keys(this.fragments).forEach(function(c){var v=g.fragments[c];if(!!v&&v.buffered){var E=v.body;E.type===_&&E.start<b&&E.end>y&&g.removeFragment(E)}})},u.removeFragment=function(y){var b=p(y);y.stats.loaded=0,y.clearElementaryStreamInfo(),delete this.fragments[b]},u.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},l}();function h(l){var u,m;return l.buffered&&(((u=l.range.video)===null||u===void 0?void 0:u.partial)||((m=l.range.audio)===null||m===void 0?void 0:m.partial))}function p(l){return l.type+"_"+l.level+"_"+l.urlId+"_"+l.sn}},"./src/controller/gap-controller.ts":function(r,i,t){t.r(i),t.d(i,"STALL_MINIMUM_DURATION_MS",function(){return h}),t.d(i,"MAX_START_GAP_JUMP",function(){return p}),t.d(i,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return l}),t.d(i,"SKIP_BUFFER_RANGE_START",function(){return u}),t.d(i,"default",function(){return m});var n=t("./src/utils/buffer-helper.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts"),f=t("./src/utils/logger.ts"),h=250,p=2,l=.1,u=.05,m=function(){function y(_,g,c,v){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=_,this.media=g,this.fragmentTracker=c,this.hls=v}var b=y.prototype;return b.destroy=function(){this.hls=this.fragmentTracker=this.media=null},b.poll=function(g){var c=this.config,v=this.media,E=this.stalled,d=v.currentTime,x=v.seeking,S=this.seeking&&!x,T=!this.seeking&&x;if(this.seeking=x,d!==g){if(this.moved=!0,E!==null){if(this.stallReported){var w=self.performance.now()-E;f.logger.warn("playback not stuck anymore @"+d+", after "+Math.round(w)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((T||S)&&(this.stalled=null),!(v.paused||v.ended||v.playbackRate===0||!n.BufferHelper.getBuffered(v).length)){var L=n.BufferHelper.bufferInfo(v,d,0),I=L.len>0,A=L.nextStart||0;if(!(!I&&!A)){if(x){var O=L.len>p,D=!A||A-d>p&&!this.fragmentTracker.getPartialFragment(d);if(O||D)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var R,C=Math.max(A,L.start||0)-d,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,M=P==null||(R=P.details)===null||R===void 0?void 0:R.live,N=M?P.details.targetduration*2:p;if(C>0&&C<=N){this._trySkipBufferHole(null);return}}var B=self.performance.now();if(E===null){this.stalled=B;return}var U=B-E;!x&&U>=h&&this._reportStall(L.len);var F=n.BufferHelper.bufferInfo(v,d,c.maxBufferHole);this._tryFixBufferStall(F,U)}}},b._tryFixBufferStall=function(g,c){var v=this.config,E=this.fragmentTracker,d=this.media,x=d.currentTime,S=E.getPartialFragment(x);if(S){var T=this._trySkipBufferHole(S);if(T)return}g.len>v.maxBufferHole&&c>v.highBufferWatchdogPeriod*1e3&&(f.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},b._reportStall=function(g){var c=this.hls,v=this.media,E=this.stallReported;E||(this.stallReported=!0,f.logger.warn("Playback stalling at @"+v.currentTime+" due to low buffer (buffer="+g+")"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g}))},b._trySkipBufferHole=function(g){for(var c=this.config,v=this.hls,E=this.media,d=E.currentTime,x=0,S=n.BufferHelper.getBuffered(E),T=0;T<S.length;T++){var w=S.start(T);if(d+c.maxBufferHole>=x&&d<w){var L=Math.max(w+u,E.currentTime+l);return f.logger.warn("skipping hole, adjusting currentTime from "+d+" to "+L),this.moved=!0,this.stalled=null,E.currentTime=L,g&&v.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+d+" to "+L,frag:g}),L}x=S.end(T)}return 0},b._tryNudgeBuffer=function(){var g=this.config,c=this.hls,v=this.media,E=v.currentTime,d=(this.nudgeRetry||0)+1;if(this.nudgeRetry=d,d<g.nudgeMaxRetry){var x=E+d*g.nudgeOffset;f.logger.warn("Nudging 'currentTime' from "+E+" to "+x),v.currentTime=x,c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else f.logger.error("Playhead still not moving while enough data buffered @"+E+" after "+g.nudgeMaxRetry+" nudges"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},y}()},"./src/controller/id3-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/demux/id3.ts"),f=.25,h=function(){function p(u){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=u,this._registerListeners()}var l=p.prototype;return l.destroy=function(){this._unregisterListeners()},l._registerListeners=function(){var m=this.hls;m.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),m.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},l._unregisterListeners=function(){var m=this.hls;m.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),m.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},l.onMediaAttached=function(m,y){this.media=y.media},l.onMediaDetaching=function(){!this.id3Track||(Object(a.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},l.getID3Track=function(m){if(!!this.media){for(var y=0;y<m.length;y++){var b=m[y];if(b.kind==="metadata"&&b.label==="id3")return Object(a.sendAddTrackEvent)(b,this.media),b}return this.media.addTextTrack("metadata","id3")}},l.onFragParsingMetadata=function(m,y){if(!!this.media){var b=y.frag,_=y.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var g=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,c=0;c<_.length;c++){var v=o.getID3Frames(_[c].data);if(v){var E=_[c].pts,d=c<_.length-1?_[c+1].pts:b.end,x=d-E;x<=0&&(d=E+f);for(var S=0;S<v.length;S++){var T=v[S];if(!o.isTimeStampFrame(T)){var w=new g(E,d,"");w.value=T,this.id3Track.addCue(w)}}}}}},l.onBufferFlushing=function(m,y){var b=y.startOffset,_=y.endOffset,g=y.type;if(!g||g==="audio"){var c=this.id3Track;c&&Object(a.removeCuesInRange)(c,b,_)}},p}();i.default=h},"./src/controller/latency-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return p});var n=t("./src/errors.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts");function f(l,u){for(var m=0;m<u.length;m++){var y=u[m];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,y.key,y)}}function h(l,u,m){return u&&f(l.prototype,u),m&&f(l,m),l}var p=function(){function l(m){var y=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return y.timeupdate()},this.hls=m,this.config=m.config,this.registerListeners()}var u=l.prototype;return u.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},u.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},u.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},u.onMediaAttached=function(y,b){this.media=b.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},u.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},u.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},u.onLevelUpdated=function(y,b){var _=b.details;this.levelDetails=_,_.advanced&&this.timeupdate(),!_.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},u.onError=function(y,b){b.details===n.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,o.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},u.timeupdate=function(){var y=this.media,b=this.levelDetails;if(!(!y||!b)){this.currentTime=y.currentTime;var _=this.computeLatency();if(_!==null){this._latency=_;var g=this.config,c=g.lowLatencyMode,v=g.maxLiveSyncPlaybackRate;if(!(!c||v===1)){var E=this.targetLatency;if(E!==null){var d=_-E,x=Math.min(this.maxLatency,E+b.targetduration),S=d<x;if(b.live&&S&&d>.05&&this.forwardBufferLength>1){var T=Math.min(2,Math.max(1,v)),w=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20;y.playbackRate=Math.min(T,Math.max(1,w))}else y.playbackRate!==1&&y.playbackRate!==0&&(y.playbackRate=1)}}}}},u.estimateLiveEdge=function(){var y=this.levelDetails;return y===null?null:y.edge+y.age},u.computeLatency=function(){var y=this.estimateLiveEdge();return y===null?null:y-this.currentTime},h(l,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var y=this.config,b=this.levelDetails;return y.liveMaxLatencyDuration!==void 0?y.liveMaxLatencyDuration:b?y.liveMaxLatencyDurationCount*b.targetduration:0}},{key:"targetLatency",get:function(){var y=this.levelDetails;if(y===null)return null;var b=y.holdBack,_=y.partHoldBack,g=y.targetduration,c=this.config,v=c.liveSyncDuration,E=c.liveSyncDurationCount,d=c.lowLatencyMode,x=this.hls.userConfig,S=d&&_||b;(x.liveSyncDuration||x.liveSyncDurationCount||S===0)&&(S=v!==void 0?v:E*g);var T=g,w=1;return S+Math.min(this.stallCount*w,T)}},{key:"liveSyncPosition",get:function(){var y=this.estimateLiveEdge(),b=this.targetLatency,_=this.levelDetails;if(y===null||b===null||_===null)return null;var g=_.edge,c=y-b-this.edgeStalled,v=g-_.totalduration,E=g-(this.config.lowLatencyMode&&_.partTarget||_.targetduration);return Math.min(Math.max(v,c),E)}},{key:"drift",get:function(){var y=this.levelDetails;return y===null?1:y.drift}},{key:"edgeStalled",get:function(){var y=this.levelDetails;if(y===null)return 0;var b=(this.config.lowLatencyMode&&y.partTarget||y.targetduration)*3;return Math.max(y.age-b,0)}},{key:"forwardBufferLength",get:function(){var y=this.media,b=this.levelDetails;if(!y||!b)return 0;var _=y.buffered.length;return _?y.buffered.end(_-1):b.edge-this.currentTime}}]),l}()},"./src/controller/level-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return c});var n=t("./src/types/level.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),f=t("./src/utils/codecs.ts"),h=t("./src/controller/level-helper.ts"),p=t("./src/controller/base-playlist-controller.ts"),l=t("./src/types/loader.ts");function u(){return u=Object.assign||function(v){for(var E=1;E<arguments.length;E++){var d=arguments[E];for(var x in d)Object.prototype.hasOwnProperty.call(d,x)&&(v[x]=d[x])}return v},u.apply(this,arguments)}function m(v,E){for(var d=0;d<E.length;d++){var x=E[d];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(v,x.key,x)}}function y(v,E,d){return E&&m(v.prototype,E),d&&m(v,d),v}function b(v,E){v.prototype=Object.create(E.prototype),v.prototype.constructor=v,_(v,E)}function _(v,E){return _=Object.setPrototypeOf||function(x,S){return x.__proto__=S,x},_(v,E)}var g=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(v){b(E,v);function E(x){var S;return S=v.call(this,x,"[level-controller]")||this,S._levels=[],S._firstLevel=-1,S._startLevel=void 0,S.currentLevelIndex=-1,S.manualLevelIndex=-1,S.onParsedComplete=void 0,S._registerListeners(),S}var d=E.prototype;return d._registerListeners=function(){var S=this.hls;S.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),S.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),S.on(a.Events.ERROR,this.onError,this)},d._unregisterListeners=function(){var S=this.hls;S.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),S.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),S.off(a.Events.ERROR,this.onError,this)},d.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,v.prototype.destroy.call(this)},d.startLoad=function(){var S=this._levels;S.forEach(function(T){T.loadError=0}),v.prototype.startLoad.call(this)},d.onManifestLoaded=function(S,T){var w=[],L=[],I=[],A,O={},D,R=!1,C=!1,P=!1;if(T.levels.forEach(function(U){var F=U.attrs;R=R||!!(U.width&&U.height),C=C||!!U.videoCodec,P=P||!!U.audioCodec,g&&U.audioCodec&&U.audioCodec.indexOf("mp4a.40.34")!==-1&&(U.audioCodec=void 0);var j=U.bitrate+"-"+U.attrs.RESOLUTION+"-"+U.attrs.CODECS;D=O[j],D?D.url.push(U.url):(D=new n.Level(U),O[j]=D,w.push(D)),F&&(F.AUDIO&&Object(h.addGroupId)(D,"audio",F.AUDIO),F.SUBTITLES&&Object(h.addGroupId)(D,"text",F.SUBTITLES))}),(R||C)&&P&&(w=w.filter(function(U){var F=U.videoCodec,j=U.width,$=U.height;return!!F||!!(j&&$)})),w=w.filter(function(U){var F=U.audioCodec,j=U.videoCodec;return(!F||Object(f.isCodecSupportedInMp4)(F,"audio"))&&(!j||Object(f.isCodecSupportedInMp4)(j,"video"))}),T.audioTracks&&(L=T.audioTracks.filter(function(U){return!U.audioCodec||Object(f.isCodecSupportedInMp4)(U.audioCodec,"audio")}),Object(h.assignTrackIdsByGroup)(L)),T.subtitles&&(I=T.subtitles,Object(h.assignTrackIdsByGroup)(I)),w.length>0){A=w[0].bitrate,w.sort(function(U,F){return U.bitrate-F.bitrate}),this._levels=w;for(var M=0;M<w.length;M++)if(w[M].bitrate===A){this._firstLevel=M,this.log("manifest loaded, "+w.length+" level(s) found, first bitrate: "+A);break}var N=P&&!C,B={levels:w,audioTracks:L,subtitleTracks:I,firstLevel:this._firstLevel,stats:T.stats,audio:P,video:C,altAudio:!N&&L.some(function(U){return!!U.url})};this.hls.trigger(a.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:T.url,reason:"no level with compatible codecs found in manifest"})},d.onError=function(S,T){if(v.prototype.onError.call(this,S,T),!T.fatal){var w=T.context,L=this._levels[this.currentLevelIndex];if(w&&(w.type===l.PlaylistContextType.AUDIO_TRACK&&L.audioGroupIds&&w.groupId===L.audioGroupIds[L.urlId]||w.type===l.PlaylistContextType.SUBTITLE_TRACK&&L.textGroupIds&&w.groupId===L.textGroupIds[L.urlId])){this.redundantFailover(this.currentLevelIndex);return}var I=!1,A=!0,O;switch(T.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(T.frag){var D=this._levels[T.frag.level];D?(D.fragmentError++,D.fragmentError>this.hls.config.fragLoadingMaxRetry&&(O=T.frag.level)):O=T.frag.level}break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:w&&(w.deliveryDirectives&&(A=!1),O=w.level),I=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:O=T.level,I=!0;break}O!==void 0&&this.recoverLevel(T,O,I,A)}},d.recoverLevel=function(S,T,w,L){var I=S.details,A=this._levels[T];if(A.loadError++,w){var O=this.retryLoadingOrFail(S);if(O)S.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(L){var D=A.url.length;if(D>1&&A.loadError<D)S.levelRetry=!0,this.redundantFailover(T);else if(this.manualLevelIndex===-1){var R=T===0?this._levels.length-1:T-1;this.currentLevelIndex!==R&&this._levels[R].loadError===0&&(this.warn(I+": switch to "+R),S.levelRetry=!0,this.hls.nextAutoLevel=R)}}},d.redundantFailover=function(S){var T=this._levels[S],w=T.url.length;if(w>1){var L=(T.urlId+1)%w;this.warn("Switching to redundant URL-id "+L),this._levels.forEach(function(I){I.urlId=L}),this.level=S}},d.onFragLoaded=function(S,T){var w=T.frag;if(w!==void 0&&w.type===l.PlaylistLevelType.MAIN){var L=this._levels[w.level];L!==void 0&&(L.fragmentError=0,L.loadError=0)}},d.onLevelLoaded=function(S,T){var w,L=T.level,I=T.details,A=this._levels[L];if(!A){var O;this.warn("Invalid level index "+L),(O=T.deliveryDirectives)!==null&&O!==void 0&&O.skip&&(I.deltaUpdateFailed=!0);return}L===this.currentLevelIndex?(A.fragmentError===0&&(A.loadError=0,this.retryCount=0),this.playlistLoaded(L,T,A.details)):(w=T.deliveryDirectives)!==null&&w!==void 0&&w.skip&&(I.deltaUpdateFailed=!0)},d.onAudioTrackSwitched=function(S,T){var w=this.hls.levels[this.currentLevelIndex];if(!!w&&w.audioGroupIds){for(var L=-1,I=this.hls.audioTracks[T.id].groupId,A=0;A<w.audioGroupIds.length;A++)if(w.audioGroupIds[A]===I){L=A;break}L!==w.urlId&&(w.urlId=L,this.startLoad())}},d.loadPlaylist=function(S){var T=this.currentLevelIndex,w=this._levels[T];if(this.canLoad&&w&&w.url.length>0){var L=w.urlId,I=w.url[L];if(S)try{I=S.addDirectives(I)}catch(A){this.warn("Could not construct new URL with HLS Delivery Directives: "+A)}this.log("Attempt loading level index "+T+(S?" at sn "+S.msn+" part "+S.part:"")+" with URL-id "+L+" "+I),this.clearTimer(),this.hls.trigger(a.Events.LEVEL_LOADING,{url:I,level:T,id:L,deliveryDirectives:S||null})}},d.removeLevel=function(S,T){var w=function(A,O){return O!==T},L=this._levels.filter(function(I,A){return A!==S?!0:I.url.length>1&&T!==void 0?(I.url=I.url.filter(w),I.audioGroupIds&&(I.audioGroupIds=I.audioGroupIds.filter(w)),I.textGroupIds&&(I.textGroupIds=I.textGroupIds.filter(w)),I.urlId=0,!0):!1}).map(function(I,A){var O=I.details;return O!=null&&O.fragments&&O.fragments.forEach(function(D){D.level=A}),I});this._levels=L,this.hls.trigger(a.Events.LEVELS_UPDATED,{levels:L})},y(E,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(S){var T,w=this._levels;if(w.length!==0&&!(this.currentLevelIndex===S&&(T=w[S])!==null&&T!==void 0&&T.details)){if(S<0||S>=w.length){var L=S<0;if(this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:S,fatal:L,reason:"invalid level idx"}),L)return;S=Math.min(S,w.length-1)}this.clearTimer();var I=this.currentLevelIndex,A=w[I],O=w[S];this.log("switching to level "+S+" from "+I),this.currentLevelIndex=S;var D=u({},O,{level:S,maxBitrate:O.maxBitrate,uri:O.uri,urlId:O.urlId});delete D._urlId,this.hls.trigger(a.Events.LEVEL_SWITCHING,D);var R=O.details;if(!R||R.live){var C=this.switchParams(O.uri,A==null?void 0:A.details);this.loadPlaylist(C)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(S){this.manualLevelIndex=S,this._startLevel===void 0&&(this._startLevel=S),S!==-1&&(this.level=S)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(S){this._firstLevel=S}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var S=this.hls.config.startLevel;return S!==void 0?S:this._firstLevel}else return this._startLevel},set:function(S){this._startLevel=S}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(S){this.level=S,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=S)}}]),E}(p.default)},"./src/controller/level-helper.ts":function(r,i,t){t.r(i),t.d(i,"addGroupId",function(){return o}),t.d(i,"assignTrackIdsByGroup",function(){return f}),t.d(i,"updatePTS",function(){return h}),t.d(i,"updateFragPTSDTS",function(){return l}),t.d(i,"mergeDetails",function(){return u}),t.d(i,"mapPartIntersection",function(){return m}),t.d(i,"mapFragmentIntersection",function(){return y}),t.d(i,"adjustSliding",function(){return b}),t.d(i,"addSliding",function(){return _}),t.d(i,"computeReloadInterval",function(){return g}),t.d(i,"getFragmentWithSN",function(){return c}),t.d(i,"getPartWith",function(){return v});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts");function o(E,d,x){switch(d){case"audio":E.audioGroupIds||(E.audioGroupIds=[]),E.audioGroupIds.push(x);break;case"text":E.textGroupIds||(E.textGroupIds=[]),E.textGroupIds.push(x);break}}function f(E){var d={};E.forEach(function(x){var S=x.groupId||"";x.id=d[S]=d[S]||0,d[S]++})}function h(E,d,x){var S=E[d],T=E[x];p(S,T)}function p(E,d){var x=d.startPTS;if(Object(n.isFiniteNumber)(x)){var S=0,T;d.sn>E.sn?(S=x-E.start,T=E):(S=E.start-x,T=d),T.duration!==S&&(T.duration=S)}else if(d.sn>E.sn){var w=E.cc===d.cc;w&&E.minEndPTS?d.start=E.start+(E.minEndPTS-E.start):d.start=E.start+E.duration}else d.start=Math.max(E.start-d.duration,0)}function l(E,d,x,S,T,w){var L=S-x;L<=0&&(a.logger.warn("Fragment should have a positive duration",d),S=x+d.duration,w=T+d.duration);var I=x,A=S,O=d.startPTS,D=d.endPTS;if(Object(n.isFiniteNumber)(O)){var R=Math.abs(O-x);Object(n.isFiniteNumber)(d.deltaPTS)?d.deltaPTS=Math.max(R,d.deltaPTS):d.deltaPTS=R,I=Math.max(x,O),x=Math.min(x,O),T=Math.min(T,d.startDTS),A=Math.min(S,D),S=Math.max(S,D),w=Math.max(w,d.endDTS)}d.duration=S-x;var C=x-d.start;d.appendedPTS=S,d.start=d.startPTS=x,d.maxStartPTS=I,d.startDTS=T,d.endPTS=S,d.minEndPTS=A,d.endDTS=w;var P=d.sn;if(!E||P<E.startSN||P>E.endSN)return 0;var M,N=P-E.startSN,B=E.fragments;for(B[N]=d,M=N;M>0;M--)p(B[M],B[M-1]);for(M=N;M<B.length-1;M++)p(B[M],B[M+1]);return E.fragmentHint&&p(B[B.length-1],E.fragmentHint),E.PTSKnown=E.alignedSliding=!0,C}function u(E,d){for(var x=null,S=E.fragments,T=S.length-1;T>=0;T--){var w=S[T].initSegment;if(w){x=w;break}}E.fragmentHint&&delete E.fragmentHint.endPTS;var L=0,I;if(y(E,d,function(M,N){M.relurl&&(L=M.cc-N.cc),Object(n.isFiniteNumber)(M.startPTS)&&Object(n.isFiniteNumber)(M.endPTS)&&(N.start=N.startPTS=M.startPTS,N.startDTS=M.startDTS,N.appendedPTS=M.appendedPTS,N.maxStartPTS=M.maxStartPTS,N.endPTS=M.endPTS,N.endDTS=M.endDTS,N.minEndPTS=M.minEndPTS,N.duration=M.endPTS-M.startPTS,N.duration&&(I=N),d.PTSKnown=d.alignedSliding=!0),N.elementaryStreams=M.elementaryStreams,N.loader=M.loader,N.stats=M.stats,N.urlId=M.urlId,M.initSegment&&(N.initSegment=M.initSegment,x=M.initSegment)}),x){var A=d.fragmentHint?d.fragments.concat(d.fragmentHint):d.fragments;A.forEach(function(M){var N;(!M.initSegment||M.initSegment.relurl===((N=x)===null||N===void 0?void 0:N.relurl))&&(M.initSegment=x)})}if(d.skippedSegments&&(d.deltaUpdateFailed=d.fragments.some(function(M){return!M}),d.deltaUpdateFailed)){a.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var O=d.skippedSegments;O--;)d.fragments.shift();d.startSN=d.fragments[0].sn,d.startCC=d.fragments[0].cc}var D=d.fragments;if(L){a.logger.warn("discontinuity sliding from playlist, take drift into account");for(var R=0;R<D.length;R++)D[R].cc+=L}d.skippedSegments&&(d.startCC=d.fragments[0].cc),m(E.partList,d.partList,function(M,N){N.elementaryStreams=M.elementaryStreams,N.stats=M.stats}),I?l(d,I,I.startPTS,I.endPTS,I.startDTS,I.endDTS):b(E,d),D.length&&(d.totalduration=d.edge-D[0].start),d.driftStartTime=E.driftStartTime,d.driftStart=E.driftStart;var C=d.advancedDateTime;if(d.advanced&&C){var P=d.edge;d.driftStart||(d.driftStartTime=C,d.driftStart=P),d.driftEndTime=C,d.driftEnd=P}else d.driftEndTime=E.driftEndTime,d.driftEnd=E.driftEnd,d.advancedDateTime=E.advancedDateTime}function m(E,d,x){if(E&&d)for(var S=0,T=0,w=E.length;T<=w;T++){var L=E[T],I=d[T+S];L&&I&&L.index===I.index&&L.fragment.sn===I.fragment.sn?x(L,I):S--}}function y(E,d,x){for(var S=d.skippedSegments,T=Math.max(E.startSN,d.startSN)-d.startSN,w=(E.fragmentHint?1:0)+(S?d.endSN:Math.min(E.endSN,d.endSN))-d.startSN,L=d.startSN-E.startSN,I=d.fragmentHint?d.fragments.concat(d.fragmentHint):d.fragments,A=E.fragmentHint?E.fragments.concat(E.fragmentHint):E.fragments,O=T;O<=w;O++){var D=A[L+O],R=I[O];S&&!R&&O<S&&(R=d.fragments[O]=D),D&&R&&x(D,R)}}function b(E,d){var x=d.startSN+d.skippedSegments-E.startSN,S=E.fragments;x<0||x>=S.length||_(d,S[x].start)}function _(E,d){if(d){for(var x=E.fragments,S=E.skippedSegments;S<x.length;S++)x[S].start+=d;E.fragmentHint&&(E.fragmentHint.start+=d)}}function g(E,d){var x=1e3*E.levelTargetDuration,S=x/2,T=E.age,w=T>0&&T<x*3,L=d.loading.end-d.loading.start,I,A=E.availabilityDelay;if(E.updated===!1)if(w){var O=333*E.misses;I=Math.max(Math.min(S,L*2),O),E.availabilityDelay=(E.availabilityDelay||0)+I}else I=S;else w?(A=Math.min(A||x/2,T),E.availabilityDelay=A,I=A+x-T):I=x-L;return Math.round(I)}function c(E,d,x){if(!E||!E.details)return null;var S=E.details,T=S.fragments[d-S.startSN];return T||(T=S.fragmentHint,T&&T.sn===d)?T:d<S.startSN&&x&&x.sn===d?x:null}function v(E,d,x){if(!E||!E.details)return null;var S=E.details.partList;if(S)for(var T=S.length;T--;){var w=S[T];if(w.index===x&&w.fragment.sn===d)return w}return null}},"./src/controller/stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S});var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/is-supported.ts"),f=t("./src/events.ts"),h=t("./src/utils/buffer-helper.ts"),p=t("./src/controller/fragment-tracker.ts"),l=t("./src/types/loader.ts"),u=t("./src/loader/fragment.ts"),m=t("./src/demux/transmuxer-interface.ts"),y=t("./src/types/transmuxer.ts"),b=t("./src/controller/gap-controller.ts"),_=t("./src/errors.ts"),g=t("./src/utils/logger.ts");function c(T,w){for(var L=0;L<w.length;L++){var I=w[L];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}function v(T,w,L){return w&&c(T.prototype,w),L&&c(T,L),T}function E(T,w){T.prototype=Object.create(w.prototype),T.prototype.constructor=T,d(T,w)}function d(T,w){return d=Object.setPrototypeOf||function(I,A){return I.__proto__=A,I},d(T,w)}var x=100,S=function(T){E(w,T);function w(I,A){var O;return O=T.call(this,I,A,"[stream-controller]")||this,O.audioCodecSwap=!1,O.gapController=null,O.level=-1,O._forceStartLoad=!1,O.altAudio=!1,O.audioOnly=!1,O.fragPlaying=null,O.onvplaying=null,O.onvseeked=null,O.fragLastKbps=0,O.stalled=!1,O.couldBacktrack=!1,O.audioCodecSwitch=!1,O.videoBuffer=null,O._registerListeners(),O}var L=w.prototype;return L._registerListeners=function(){var A=this.hls;A.on(f.Events.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),A.on(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),A.on(f.Events.LEVEL_LOADING,this.onLevelLoading,this),A.on(f.Events.LEVEL_LOADED,this.onLevelLoaded,this),A.on(f.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),A.on(f.Events.ERROR,this.onError,this),A.on(f.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.on(f.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.on(f.Events.BUFFER_CREATED,this.onBufferCreated,this),A.on(f.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),A.on(f.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),A.on(f.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var A=this.hls;A.off(f.Events.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(f.Events.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),A.off(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),A.off(f.Events.LEVEL_LOADED,this.onLevelLoaded,this),A.off(f.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),A.off(f.Events.ERROR,this.onError,this),A.off(f.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.off(f.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.off(f.Events.BUFFER_CREATED,this.onBufferCreated,this),A.off(f.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),A.off(f.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),A.off(f.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},L.startLoad=function(A){if(this.levels){var O=this.lastCurrentTime,D=this.hls;if(this.stopLoad(),this.setInterval(x),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var R=D.startLevel;R===-1&&(D.config.testBandwidth?(R=0,this.bitrateTest=!0):R=D.nextAutoLevel),this.level=D.nextLoadLevel=R,this.loadedmetadata=!1}O>0&&A===-1&&(this.log("Override startPosition with lastCurrentTime @"+O.toFixed(3)),A=O),this.state=a.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=A,this.tick()}else this._forceStartLoad=!0,this.state=a.State.STOPPED},L.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},L.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_LEVEL:{var A,O=this.levels,D=this.level,R=O==null||(A=O[D])===null||A===void 0?void 0:A.details;if(R&&(!R.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(R))break;this.state=a.State.IDLE;break}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var C,P=self.performance.now(),M=this.retryDate;(!M||P>=M||(C=this.media)!==null&&C!==void 0&&C.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=a.State.IDLE)}break}this.onTickEnd()},L.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},L.doTickIdle=function(){var A,O,D=this.hls,R=this.levelLastLoaded,C=this.levels,P=this.media,M=D.config,N=D.nextLoadLevel;if(!(R===null||!P&&(this.startFragRequested||!M.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!C||!C[N])){var B=C[N];this.level=D.nextLoadLevel=N;var U=B.details;if(!U||this.state===a.State.WAITING_LEVEL||U.live&&this.levelLastLoaded!==N){this.state=a.State.WAITING_LEVEL;return}var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:P,l.PlaylistLevelType.MAIN);if(F!==null){var j=F.len,$=this.getMaxBufferLength(B.maxBitrate);if(!(j>=$)){if(this._streamEnded(F,U)){var G={};this.altAudio&&(G.type="video"),this.hls.trigger(f.Events.BUFFER_EOS,G),this.state=a.State.ENDED;return}var Y=F.end,X=this.getNextFragment(Y,U);if(this.couldBacktrack&&!this.fragPrevious&&X&&X.sn!=="initSegment"){var ie=X.sn-U.startSN;ie>1&&(X=U.fragments[ie-1],this.fragmentTracker.removeFragment(X))}if(X&&this.fragmentTracker.getState(X)===p.FragmentState.OK&&this.nextLoadPosition>Y){var pe=this.audioOnly&&!this.altAudio?u.ElementaryStreamTypes.AUDIO:u.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(P,pe,l.PlaylistLevelType.MAIN),X=this.getNextFragment(this.nextLoadPosition,U)}!X||(X.initSegment&&!X.initSegment.data&&!this.bitrateTest&&(X=X.initSegment),((A=X.decryptdata)===null||A===void 0?void 0:A.keyFormat)==="identity"&&!((O=X.decryptdata)!==null&&O!==void 0&&O.key)?this.loadKey(X,U):this.loadFragment(X,U,Y))}}}},L.loadFragment=function(A,O,D){var R,C=this.fragmentTracker.getState(A);if(this.fragCurrent=A,C===p.FragmentState.BACKTRACKED){var P=this.fragmentTracker.getBacktrackData(A);if(P){this._handleFragmentLoadProgress(P),this._handleFragmentLoadComplete(P);return}else C=p.FragmentState.NOT_LOADED}C===p.FragmentState.NOT_LOADED||C===p.FragmentState.PARTIAL?A.sn==="initSegment"?this._loadInitSegment(A):this.bitrateTest?(A.bitrateTest=!0,this.log("Fragment "+A.sn+" of level "+A.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(A)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,A,O,D)):C===p.FragmentState.APPENDING?this.reduceMaxBufferLength(A.duration)&&this.fragmentTracker.removeFragment(A):((R=this.media)===null||R===void 0?void 0:R.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},L.getAppendedFrag=function(A){var O=this.fragmentTracker.getAppendedFrag(A,l.PlaylistLevelType.MAIN);return O&&"fragment"in O?O.fragment:O},L.getBufferedFrag=function(A){return this.fragmentTracker.getBufferedFrag(A,l.PlaylistLevelType.MAIN)},L.followingBufferedFrag=function(A){return A?this.getBufferedFrag(A.end+.5):null},L.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},L.nextLevelSwitch=function(){var A=this.levels,O=this.media;if(O!=null&&O.readyState){var D,R=this.getAppendedFrag(O.currentTime);if(R&&R.start>1&&this.flushMainBuffer(0,R.start-1),!O.paused&&A){var C=this.hls.nextLoadLevel,P=A[C],M=this.fragLastKbps;M&&this.fragCurrent?D=this.fragCurrent.duration*P.maxBitrate/(1e3*M)+1:D=0}else D=0;var N=this.getBufferedFrag(O.currentTime+D);if(N){var B=this.followingBufferedFrag(N);if(B){this.abortCurrentFrag();var U=B.maxStartPTS?B.maxStartPTS:B.start,F=B.duration,j=Math.max(N.end,U+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,F*.5),F*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},L.abortCurrentFrag=function(){var A=this.fragCurrent;this.fragCurrent=null,A!=null&&A.loader&&A.loader.abort(),this.state===a.State.KEY_LOADING&&(this.state=a.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},L.flushMainBuffer=function(A,O){T.prototype.flushMainBuffer.call(this,A,O,this.altAudio?"video":null)},L.onMediaAttached=function(A,O){T.prototype.onMediaAttached.call(this,A,O);var D=O.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),D.addEventListener("playing",this.onvplaying),D.addEventListener("seeked",this.onvseeked),this.gapController=new b.default(this.config,D,this.fragmentTracker,this.hls)},L.onMediaDetaching=function(){var A=this.media;A&&(A.removeEventListener("playing",this.onvplaying),A.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},L.onMediaPlaying=function(){this.tick()},L.onMediaSeeked=function(){var A=this.media,O=A?A.currentTime:null;Object(n.isFiniteNumber)(O)&&this.log("Media seeked to "+O.toFixed(3)),this.tick()},L.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(f.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},L.onManifestParsed=function(A,O){var D=!1,R=!1,C;O.levels.forEach(function(P){C=P.audioCodec,C&&(C.indexOf("mp4a.40.2")!==-1&&(D=!0),C.indexOf("mp4a.40.5")!==-1&&(R=!0))}),this.audioCodecSwitch=D&&R&&!Object(o.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=O.levels,this.startFragRequested=!1},L.onLevelLoading=function(A,O){var D=this.levels;if(!(!D||this.state!==a.State.IDLE)){var R=D[O.level];(!R.details||R.details.live&&this.levelLastLoaded!==O.level||this.waitForCdnTuneIn(R.details))&&(this.state=a.State.WAITING_LEVEL)}},L.onLevelLoaded=function(A,O){var D,R=this.levels,C=O.level,P=O.details,M=P.totalduration;if(!R){this.warn("Levels were reset while loading level "+C);return}this.log("Level "+C+" loaded ["+P.startSN+","+P.endSN+"], cc ["+P.startCC+", "+P.endCC+"] duration:"+M);var N=this.fragCurrent;N&&(this.state===a.State.FRAG_LOADING||this.state===a.State.FRAG_LOADING_WAITING_RETRY)&&N.level!==O.level&&N.loader&&(this.state=a.State.IDLE,N.loader.abort());var B=R[C],U=0;if(P.live||(D=B.details)!==null&&D!==void 0&&D.live){if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed)return;U=this.alignPlaylists(P,B.details)}if(B.details=P,this.levelLastLoaded=C,this.hls.trigger(f.Events.LEVEL_UPDATED,{details:P,level:C}),this.state===a.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(P))return;this.state=a.State.IDLE}this.startFragRequested?P.live&&this.synchronizeToLiveEdge(P):this.setStartPosition(P,U),this.tick()},L._handleFragmentLoadProgress=function(A){var O,D=A.frag,R=A.part,C=A.payload,P=this.levels;if(!P){this.warn("Levels were reset while fragment load was in progress. Fragment "+D.sn+" of level "+D.level+" will not be buffered");return}var M=P[D.level],N=M.details;if(!N){this.warn("Dropping fragment "+D.sn+" of level "+D.level+" after level details were reset");return}var B=M.videoCodec,U=N.PTSKnown||!N.live,F=(O=D.initSegment)===null||O===void 0?void 0:O.data,j=this._getAudioCodec(M),$=this.transmuxer=this.transmuxer||new m.default(this.hls,l.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=R?R.index:-1,Y=G!==-1,X=new y.ChunkMetadata(D.level,D.sn,D.stats.chunkCount,C.byteLength,G,Y),ie=this.initPTS[D.cc];$.push(C,F,j,B,D,R,N.totalduration,U,X,ie)},L.onAudioTrackSwitching=function(A,O){var D=this.altAudio,R=!!O.url,C=O.id;if(!R){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var P=this.fragCurrent;P!=null&&P.loader&&(this.log("Switching to main audio track, cancel main fragment load"),P.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var M=this.hls;D&&M.trigger(f.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),M.trigger(f.Events.AUDIO_TRACK_SWITCHED,{id:C})}},L.onAudioTrackSwitched=function(A,O){var D=O.id,R=!!this.hls.audioTracks[D].url;if(R){var C=this.videoBuffer;C&&this.mediaBuffer!==C&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=C)}this.altAudio=R,this.tick()},L.onBufferCreated=function(A,O){var D=O.tracks,R,C,P=!1;for(var M in D){var N=D[M];if(N.id==="main"){if(C=M,R=N,M==="video"){var B=D[M];B&&(this.videoBuffer=B.buffer)}}else P=!0}P&&R?(this.log("Alternate track found, use "+C+".buffered to schedule main fragment loading"),this.mediaBuffer=R.buffer):this.mediaBuffer=this.media},L.onFragBuffered=function(A,O){var D=O.frag,R=O.part;if(!(D&&D.type!==l.PlaylistLevelType.MAIN)){if(this.fragContextChanged(D)){this.warn("Fragment "+D.sn+(R?" p: "+R.index:"")+" of level "+D.level+" finished buffering, but was aborted. state: "+this.state),this.state===a.State.PARSED&&(this.state=a.State.IDLE);return}var C=R?R.stats:D.stats;this.fragLastKbps=Math.round(8*C.total/(C.buffering.end-C.loading.first)),D.sn!=="initSegment"&&(this.fragPrevious=D),this.fragBufferedComplete(D,R)}},L.onError=function(A,O){switch(O.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:case _.ErrorDetails.KEY_LOAD_ERROR:case _.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.MAIN,O);break;case _.ErrorDetails.LEVEL_LOAD_ERROR:case _.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==a.State.ERROR&&(O.fatal?(this.warn(""+O.details),this.state=a.State.ERROR):!O.levelRetry&&this.state===a.State.WAITING_LEVEL&&(this.state=a.State.IDLE));break;case _.ErrorDetails.BUFFER_FULL_ERROR:if(O.parent==="main"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var D=!0,R=this.getFwdBufferInfo(this.media,l.PlaylistLevelType.MAIN);R&&R.len>.5&&(D=!this.reduceMaxBufferLength(R.len)),D&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},L.checkBuffer=function(){var A=this.media,O=this.gapController;if(!(!A||!O||!A.readyState)){var D=h.BufferHelper.getBuffered(A);!this.loadedmetadata&&D.length?(this.loadedmetadata=!0,this.seekToStartPos()):O.poll(this.lastCurrentTime),this.lastCurrentTime=A.currentTime}},L.onFragLoadEmergencyAborted=function(){this.state=a.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},L.onBufferFlushed=function(A,O){var D=O.type;if(D!==u.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var R=(D===u.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(R,D,l.PlaylistLevelType.MAIN)}},L.onLevelsUpdated=function(A,O){this.levels=O.levels},L.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},L.seekToStartPos=function(){var A=this.media,O=A.currentTime,D=this.startPosition;if(D>=0&&O<D){if(A.seeking){g.logger.log("could not seek to "+D+", already seeking at "+O);return}var R=h.BufferHelper.getBuffered(A),C=R.length?R.start(0):0,P=C-D;P>0&&(P<this.config.maxBufferHole||P<this.config.maxFragLookUpTolerance)&&(g.logger.log("adjusting start position by "+P+" to match buffer start"),D+=P,this.startPosition=D),this.log("seek to target start position "+D+" from current time "+O),A.currentTime=D}},L._getAudioCodec=function(A){var O=this.config.defaultAudioCodec||A.audioCodec;return this.audioCodecSwap&&O&&(this.log("Swapping audio codec"),O.indexOf("mp4a.40.5")!==-1?O="mp4a.40.2":O="mp4a.40.5"),O},L._loadBitrateTestFrag=function(A){var O=this;this._doFragLoad(A).then(function(D){var R=O.hls;if(!(!D||R.nextLoadLevel||O.fragContextChanged(A))){O.fragLoadError=0,O.state=a.State.IDLE,O.startFragRequested=!1,O.bitrateTest=!1;var C=A.stats;C.parsing.start=C.parsing.end=C.buffering.start=C.buffering.end=self.performance.now(),R.trigger(f.Events.FRAG_LOADED,D)}})},L._handleTransmuxComplete=function(A){var O,D="main",R=this.hls,C=A.remuxResult,P=A.chunkMeta,M=this.getCurrentContext(P);if(!M){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(P.level);return}var N=M.frag,B=M.part,U=M.level,F=C.video,j=C.text,$=C.id3,G=C.initSegment,Y=this.altAudio?void 0:C.audio;if(!this.fragContextChanged(N)){if(this.state=a.State.PARSING,G){G.tracks&&(this._bufferInitSegment(U,G.tracks,N,P),R.trigger(f.Events.FRAG_PARSING_INIT_SEGMENT,{frag:N,id:D,tracks:G.tracks}));var X=G.initPTS,ie=G.timescale;Object(n.isFiniteNumber)(X)&&(this.initPTS[N.cc]=X,R.trigger(f.Events.INIT_PTS_FOUND,{frag:N,id:D,initPTS:X,timescale:ie}))}if(F&&C.independent!==!1){if(U.details){var pe=F.startPTS,ue=F.endPTS,we=F.startDTS,de=F.endDTS;if(B)B.elementaryStreams[F.type]={startPTS:pe,endPTS:ue,startDTS:we,endDTS:de};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){var oe=this.getLoadPosition()+this.config.maxBufferHole;if(oe<pe){this.backtrack(N);return}N.setElementaryStreamInfo(F.type,N.start,ue,N.start,de,!0)}N.setElementaryStreamInfo(F.type,pe,ue,we,de),this.bufferFragmentData(F,N,B,P)}}else if(C.independent===!1){this.backtrack(N);return}if(Y){var De=Y.startPTS,Ce=Y.endPTS,Ue=Y.startDTS,Me=Y.endDTS;B&&(B.elementaryStreams[u.ElementaryStreamTypes.AUDIO]={startPTS:De,endPTS:Ce,startDTS:Ue,endDTS:Me}),N.setElementaryStreamInfo(u.ElementaryStreamTypes.AUDIO,De,Ce,Ue,Me),this.bufferFragmentData(Y,N,B,P)}if($!=null&&(O=$.samples)!==null&&O!==void 0&&O.length){var ze={frag:N,id:D,samples:$.samples};R.trigger(f.Events.FRAG_PARSING_METADATA,ze)}if(j){var Ge={frag:N,id:D,samples:j.samples};R.trigger(f.Events.FRAG_PARSING_USERDATA,Ge)}}},L._bufferInitSegment=function(A,O,D,R){var C=this;if(this.state===a.State.PARSING){this.audioOnly=!!O.audio&&!O.video,this.altAudio&&!this.audioOnly&&delete O.audio;var P=O.audio,M=O.video,N=O.audiovideo;if(P){var B=A.audioCodec,U=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),P.metadata.channelCount!==1&&U.indexOf("firefox")===-1&&(B="mp4a.40.5")),U.indexOf("android")!==-1&&P.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),A.audioCodec&&A.audioCodec!==B&&this.log('Swapping manifest audio codec "'+A.audioCodec+'" for "'+B+'"'),P.levelCodec=B,P.id="main",this.log("Init audio buffer, container:"+P.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(A.audioCodec||"")+"/"+P.codec+"]")}M&&(M.levelCodec=A.videoCodec,M.id="main",this.log("Init video buffer, container:"+M.container+", codecs[level/parsed]=["+(A.videoCodec||"")+"/"+M.codec+"]")),N&&this.log("Init audiovideo buffer, container:"+N.container+", codecs[level/parsed]=["+(A.attrs.CODECS||"")+"/"+N.codec+"]"),this.hls.trigger(f.Events.BUFFER_CODECS,O),Object.keys(O).forEach(function(F){var j=O[F],$=j.initSegment;$!=null&&$.byteLength&&C.hls.trigger(f.Events.BUFFER_APPENDING,{type:F,data:$,frag:D,part:null,chunkMeta:R,parent:D.type})}),this.tick()}},L.backtrack=function(A){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(A);var O=this.fragmentTracker.backtrack(A);this.fragPrevious=null,this.nextLoadPosition=A.start,O?this.resetFragmentLoading(A):this.state=a.State.BACKTRACKING},L.checkFragmentChanged=function(){var A=this.media,O=null;if(A&&A.readyState>1&&A.seeking===!1){var D=A.currentTime;if(h.BufferHelper.isBuffered(A,D)?O=this.getAppendedFrag(D):h.BufferHelper.isBuffered(A,D+.1)&&(O=this.getAppendedFrag(D+.1)),O){var R=this.fragPlaying,C=O.level;(!R||O.sn!==R.sn||R.level!==C||O.urlId!==R.urlId)&&(this.hls.trigger(f.Events.FRAG_CHANGED,{frag:O}),(!R||R.level!==C)&&this.hls.trigger(f.Events.LEVEL_SWITCHED,{level:C}),this.fragPlaying=O)}}},v(w,[{key:"nextLevel",get:function(){var A=this.nextBufferedFrag;return A?A.level:-1}},{key:"currentLevel",get:function(){var A=this.media;if(A){var O=this.getAppendedFrag(A.currentTime);if(O)return O.level}return-1}},{key:"nextBufferedFrag",get:function(){var A=this.media;if(A){var O=this.getAppendedFrag(A.currentTime);return this.followingBufferedFrag(O)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),w}(a.default)},"./src/controller/subtitle-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"SubtitleStreamController",function(){return v});var n=t("./src/events.ts"),a=t("./src/utils/buffer-helper.ts"),o=t("./src/controller/fragment-finders.ts"),f=t("./src/utils/discontinuities.ts"),h=t("./src/controller/level-helper.ts"),p=t("./src/controller/fragment-tracker.ts"),l=t("./src/controller/base-stream-controller.ts"),u=t("./src/types/loader.ts"),m=t("./src/types/level.ts");function y(E,d){for(var x=0;x<d.length;x++){var S=d[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}function b(E,d,x){return d&&y(E.prototype,d),x&&y(E,x),E}function _(E,d){E.prototype=Object.create(d.prototype),E.prototype.constructor=E,g(E,d)}function g(E,d){return g=Object.setPrototypeOf||function(S,T){return S.__proto__=T,S},g(E,d)}var c=500,v=function(E){_(d,E);function d(S,T){var w;return w=E.call(this,S,T,"[subtitle-stream-controller]")||this,w.levels=[],w.currentTrackId=-1,w.tracksBuffered=[],w.mainDetails=null,w._registerListeners(),w}var x=d.prototype;return x.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},x._registerListeners=function(){var T=this.hls;T.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(n.Events.ERROR,this.onError,this),T.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.on(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.on(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},x._unregisterListeners=function(){var T=this.hls;T.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(n.Events.ERROR,this.onError,this),T.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.off(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.off(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},x.startLoad=function(){this.stopLoad(),this.state=l.State.IDLE,this.setInterval(c),this.tick()},x.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},x.onLevelLoaded=function(T,w){this.mainDetails=w.details},x.onSubtitleFragProcessed=function(T,w){var L=w.frag,I=w.success;if(this.fragPrevious=L,this.state=l.State.IDLE,!!I){var A=this.tracksBuffered[this.currentTrackId];if(!!A){for(var O,D=L.start,R=0;R<A.length;R++)if(D>=A[R].start&&D<=A[R].end){O=A[R];break}var C=L.start+L.duration;O?O.end=C:(O={start:D,end:C},A.push(O)),this.fragmentTracker.fragBuffered(L)}}},x.onBufferFlushing=function(T,w){var L=w.startOffset,I=w.endOffset;if(L===0&&I!==Number.POSITIVE_INFINITY){var A=this.currentTrackId,O=this.levels;if(!O.length||!O[A]||!O[A].details)return;var D=O[A].details,R=D.targetduration,C=I-R;if(C<=0)return;w.endOffsetSubtitles=Math.max(0,C),this.tracksBuffered.forEach(function(P){for(var M=0;M<P.length;){if(P[M].end<=C){P.shift();continue}else if(P[M].start<C)P[M].start=C;else break;M++}}),this.fragmentTracker.removeFragmentsInRange(L,C,u.PlaylistLevelType.SUBTITLE)}},x.onError=function(T,w){var L,I=w.frag;!I||I.type!==u.PlaylistLevelType.SUBTITLE||((L=this.fragCurrent)!==null&&L!==void 0&&L.loader&&this.fragCurrent.loader.abort(),this.state=l.State.IDLE)},x.onSubtitleTracksUpdated=function(T,w){var L=this,I=w.subtitleTracks;this.tracksBuffered=[],this.levels=I.map(function(A){return new m.Level(A)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(A){L.tracksBuffered[A.id]=[]}),this.mediaBuffer=null},x.onSubtitleTrackSwitch=function(T,w){if(this.currentTrackId=w.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var L=this.levels[this.currentTrackId];L!=null&&L.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,L&&this.setInterval(c)},x.onSubtitleTrackLoaded=function(T,w){var L,I=w.details,A=w.id,O=this.currentTrackId,D=this.levels;if(!!D.length){var R=D[O];if(!(A>=D.length||A!==O||!R)){if(this.mediaBuffer=this.mediaBufferTimeRanges,I.live||(L=R.details)!==null&&L!==void 0&&L.live){var C=this.mainDetails;if(I.deltaUpdateFailed||!C)return;var P=C.fragments[0];if(!R.details)I.hasProgramDateTime&&C.hasProgramDateTime?Object(f.alignMediaPlaylistByPDT)(I,C):P&&Object(h.addSliding)(I,P.start);else{var M=this.alignPlaylists(I,R.details);M===0&&P&&Object(h.addSliding)(I,P.start)}}if(R.details=I,this.levelLastLoaded=A,this.tick(),I.live&&!this.fragCurrent&&this.media&&this.state===l.State.IDLE){var N=Object(o.findFragmentByPTS)(null,I.fragments,this.media.currentTime,0);N||(this.warn("Subtitle playlist not aligned with playback"),R.details=void 0)}}}},x._handleFragmentLoadComplete=function(T){var w=T.frag,L=T.payload,I=w.decryptdata,A=this.hls;if(!this.fragContextChanged(w)&&L&&L.byteLength>0&&I&&I.key&&I.iv&&I.method==="AES-128"){var O=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(L),I.key.buffer,I.iv.buffer).then(function(D){var R=performance.now();A.trigger(n.Events.FRAG_DECRYPTED,{frag:w,payload:D,stats:{tstart:O,tdecrypt:R}})})}},x.doTick=function(){if(!this.media){this.state=l.State.IDLE;return}if(this.state===l.State.IDLE){var T,w=this.currentTrackId,L=this.levels;if(!L.length||!L[w]||!L[w].details)return;var I=L[w].details,A=I.targetduration,O=this.config,D=this.media,R=a.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,D.currentTime-A,O.maxBufferHole),C=R.end,P=R.len,M=this.getMaxBufferLength()+A;if(P>M)return;console.assert(I,"Subtitle track details are defined on idle subtitle stream controller tick");var N=I.fragments,B=N.length,U=I.edge,F,j=this.fragPrevious;if(C<U){var $=O.maxFragLookUpTolerance;F=Object(o.findFragmentByPTS)(j,N,C,$),!F&&j&&j.start<N[0].start&&(F=N[0])}else F=N[B-1];(T=F)!==null&&T!==void 0&&T.encrypted?this.loadKey(F,I):F&&this.fragmentTracker.getState(F)===p.FragmentState.NOT_LOADED&&this.loadFragment(F,I,C)}},x.loadFragment=function(T,w,L){this.fragCurrent=T,E.prototype.loadFragment.call(this,T,w,L)},b(d,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),d}(l.default)},"./src/controller/subtitle-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/controller/base-playlist-controller.ts"),f=t("./src/types/loader.ts");function h(b,_){for(var g=0;g<_.length;g++){var c=_[g];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(b,c.key,c)}}function p(b,_,g){return _&&h(b.prototype,_),g&&h(b,g),b}function l(b,_){b.prototype=Object.create(_.prototype),b.prototype.constructor=b,u(b,_)}function u(b,_){return u=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c},u(b,_)}var m=function(b){l(_,b);function _(c){var v;return v=b.call(this,c,"[subtitle-track-controller]")||this,v.media=null,v.tracks=[],v.groupId=null,v.tracksInGroup=[],v.trackId=-1,v.selectDefaultTrack=!0,v.queuedDefaultTrack=-1,v.trackChangeListener=function(){return v.onTextTracksChanged()},v.asyncPollTrackChange=function(){return v.pollTrackChange(0)},v.useTextTrackPolling=!1,v.subtitlePollingInterval=-1,v.subtitleDisplay=!0,v.registerListeners(),v}var g=_.prototype;return g.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,b.prototype.destroy.call(this)},g.registerListeners=function(){var v=this.hls;v.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),v.on(n.Events.ERROR,this.onError,this)},g.unregisterListeners=function(){var v=this.hls;v.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),v.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),v.off(n.Events.ERROR,this.onError,this)},g.onMediaAttached=function(v,E){this.media=E.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},g.pollTrackChange=function(v){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,v)},g.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var v=y(this.media.textTracks);v.forEach(function(E){Object(a.clearCurrentCues)(E)}),this.subtitleTrack=-1,this.media=null}},g.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},g.onManifestParsed=function(v,E){this.tracks=E.subtitleTracks},g.onSubtitleTrackLoaded=function(v,E){var d=E.id,x=E.details,S=this.trackId,T=this.tracksInGroup[S];if(!T){this.warn("Invalid subtitle track id "+d);return}var w=T.details;T.details=E.details,this.log("subtitle track "+d+" loaded ["+x.startSN+"-"+x.endSN+"]"),d===this.trackId&&(this.retryCount=0,this.playlistLoaded(d,E,w))},g.onLevelLoading=function(v,E){this.switchLevel(E.level)},g.onLevelSwitching=function(v,E){this.switchLevel(E.level)},g.switchLevel=function(v){var E=this.hls.levels[v];if(!!(E!=null&&E.textGroupIds)){var d=E.textGroupIds[E.urlId];if(this.groupId!==d){var x=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,S=this.tracks.filter(function(L){return!d||L.groupId===d});this.tracksInGroup=S;var T=this.findTrackId(x==null?void 0:x.name)||this.findTrackId();this.groupId=d;var w={subtitleTracks:S};this.log("Updating subtitle tracks, "+S.length+' track(s) found in "'+d+'" group-id'),this.hls.trigger(n.Events.SUBTITLE_TRACKS_UPDATED,w),T!==-1&&this.setSubtitleTrack(T,x)}}},g.findTrackId=function(v){for(var E=this.tracksInGroup,d=0;d<E.length;d++){var x=E[d];if((!this.selectDefaultTrack||x.default)&&(!v||v===x.name))return x.id}return-1},g.onError=function(v,E){b.prototype.onError.call(this,v,E),!(E.fatal||!E.context)&&E.context.type===f.PlaylistContextType.SUBTITLE_TRACK&&E.context.id===this.trackId&&E.context.groupId===this.groupId&&this.retryLoadingOrFail(E)},g.loadPlaylist=function(v){var E=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(E)){var d=E.id,x=E.groupId,S=E.url;if(v)try{S=v.addDirectives(S)}catch(T){this.warn("Could not construct new URL with HLS Delivery Directives: "+T)}this.log("Loading subtitle playlist for id "+d),this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADING,{url:S,id:d,groupId:x,deliveryDirectives:v||null})}},g.toggleTrackModes=function(v){var E=this,d=this.media,x=this.subtitleDisplay,S=this.trackId;if(!!d){var T=y(d.textTracks),w=T.filter(function(A){return A.groupId===E.groupId});if(v===-1)[].slice.call(T).forEach(function(A){A.mode="disabled"});else{var L=w[S];L&&(L.mode="disabled")}var I=w[v];I&&(I.mode=x?"showing":"hidden")}},g.setSubtitleTrack=function(v,E){var d,x=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=v;return}if(this.trackId!==v&&this.toggleTrackModes(v),!(this.trackId===v&&(v===-1||(d=x[v])!==null&&d!==void 0&&d.details)||v<-1||v>=x.length)){this.clearTimer();var S=x[v];if(this.log("Switching to subtitle track "+v),this.trackId=v,S){var T=S.id,w=S.groupId,L=w===void 0?"":w,I=S.name,A=S.type,O=S.url;this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:T,groupId:L,name:I,type:A,url:O});var D=this.switchParams(S.url,E==null?void 0:E.details);this.loadPlaylist(D)}else this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:v})}},g.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var v=-1,E=y(this.media.textTracks),d=0;d<E.length;d++)if(E[d].mode==="hidden")v=d;else if(E[d].mode==="showing"){v=d;break}this.subtitleTrack!==v&&(this.subtitleTrack=v)}},p(_,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(v){this.selectDefaultTrack=!1;var E=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(v,E)}}]),_}(o.default);function y(b){for(var _=[],g=0;g<b.length;g++){var c=b[g];c.kind==="subtitles"&&c.label&&_.push(b[g])}return _}i.default=m},"./src/controller/timeline-controller.ts":function(r,i,t){t.r(i),t.d(i,"TimelineController",function(){return y});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/cea-608-parser.ts"),f=t("./src/utils/output-filter.ts"),h=t("./src/utils/webvtt-parser.ts"),p=t("./src/utils/texttrack-utils.ts"),l=t("./src/utils/imsc1-ttml-parser.ts"),u=t("./src/types/loader.ts"),m=t("./src/utils/logger.ts"),y=function(){function c(E){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this.captionsProperties=void 0,this.hls=E,this.config=E.config,this.Cues=E.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var d=new f.default(this,"textTrack1"),x=new f.default(this,"textTrack2"),S=new f.default(this,"textTrack3"),T=new f.default(this,"textTrack4");this.cea608Parser1=new o.default(1,d,x),this.cea608Parser2=new o.default(3,S,T)}E.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),E.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),E.on(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),E.on(a.Events.FRAG_LOADING,this.onFragLoading,this),E.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),E.on(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),E.on(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),E.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),E.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var v=c.prototype;return v.destroy=function(){var d=this.hls;d.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),d.off(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),d.off(a.Events.FRAG_LOADING,this.onFragLoading,this),d.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),d.off(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),d.off(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),d.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),d.off(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),d.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},v.addCues=function(d,x,S,T,w){for(var L=!1,I=w.length;I--;){var A=w[I],O=_(A[0],A[1],x,S);if(O>=0&&(A[0]=Math.min(A[0],x),A[1]=Math.max(A[1],S),L=!0,O/(S-x)>.5))return}if(L||w.push([x,S]),this.config.renderTextTracksNatively){var D=this.captionsTracks[d];this.Cues.newCue(D,x,S,T)}else{var R=this.Cues.newCue(null,x,S,T);this.hls.trigger(a.Events.CUES_PARSED,{type:"captions",cues:R,track:d})}},v.onInitPtsFound=function(d,x){var S=this,T=x.frag,w=x.id,L=x.initPTS,I=x.timescale,A=this.unparsedVttFrags;w==="main"&&(this.initPTS[T.cc]=L,this.timescale[T.cc]=I),A.length&&(this.unparsedVttFrags=[],A.forEach(function(O){S.onFragLoaded(a.Events.FRAG_LOADED,O)}))},v.getExistingTrack=function(d){var x=this.media;if(x)for(var S=0;S<x.textTracks.length;S++){var T=x.textTracks[S];if(T[d])return T}return null},v.createCaptionsTrack=function(d){this.config.renderTextTracksNatively?this.createNativeTrack(d):this.createNonNativeTrack(d)},v.createNativeTrack=function(d){if(!this.captionsTracks[d]){var x=this.captionsProperties,S=this.captionsTracks,T=this.media,w=x[d],L=w.label,I=w.languageCode,A=this.getExistingTrack(d);if(A)S[d]=A,Object(p.clearCurrentCues)(S[d]),Object(p.sendAddTrackEvent)(S[d],T);else{var O=this.createTextTrack("captions",L,I);O&&(O[d]=!0,S[d]=O)}}},v.createNonNativeTrack=function(d){if(!this.nonNativeCaptionsTracks[d]){var x=this.captionsProperties[d];if(!!x){var S=x.label,T={_id:d,label:S,kind:"captions",default:x.media?!!x.media.default:!1,closedCaptions:x.media};this.nonNativeCaptionsTracks[d]=T,this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[T]})}}},v.createTextTrack=function(d,x,S){var T=this.media;if(!!T)return T.addTextTrack(d,x,S)},v.onMediaAttaching=function(d,x){this.media=x.media,this._cleanTracks()},v.onMediaDetaching=function(){var d=this.captionsTracks;Object.keys(d).forEach(function(x){Object(p.clearCurrentCues)(d[x]),delete d[x]}),this.nonNativeCaptionsTracks={}},v.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},v._cleanTracks=function(){var d=this.media;if(!!d){var x=d.textTracks;if(x)for(var S=0;S<x.length;S++)Object(p.clearCurrentCues)(x[S])}},v.onSubtitleTracksUpdated=function(d,x){var S=this;this.textTracks=[];var T=x.subtitleTracks||[],w=T.some(function(O){return O.textCodec===l.IMSC1_CODEC});if(this.config.enableWebVTT||w&&this.config.enableIMSC1){var L=this.tracks&&T&&this.tracks.length===T.length;if(this.tracks=T||[],this.config.renderTextTracksNatively){var I=this.media?this.media.textTracks:[];this.tracks.forEach(function(O,D){var R;if(D<I.length){for(var C=null,P=0;P<I.length;P++)if(b(I[P],O)){C=I[P];break}C&&(R=C)}R?Object(p.clearCurrentCues)(R):(R=S.createTextTrack("subtitles",O.name,O.lang),R&&(R.mode="disabled")),R&&(R.groupId=O.groupId,S.textTracks.push(R))})}else if(!L&&this.tracks&&this.tracks.length){var A=this.tracks.map(function(O){return{label:O.name,kind:O.type.toLowerCase(),default:O.default,subtitleTrack:O}});this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:A})}}},v.onManifestLoaded=function(d,x){var S=this;this.config.enableCEA708Captions&&x.captions&&x.captions.forEach(function(T){var w=/(?:CC|SERVICE)([1-4])/.exec(T.instreamId);if(!!w){var L="textTrack"+w[1],I=S.captionsProperties[L];!I||(I.label=T.name,T.lang&&(I.languageCode=T.lang),I.media=T)}})},v.onFragLoading=function(d,x){var S=this.cea608Parser1,T=this.cea608Parser2,w=this.lastSn,L=this.lastPartIndex;if(!(!this.enabled||!(S&&T))&&x.frag.type===u.PlaylistLevelType.MAIN){var I,A,O=x.frag.sn,D=(I=x==null||(A=x.part)===null||A===void 0?void 0:A.index)!=null?I:-1;O===w+1||O===w&&D===L+1||(S.reset(),T.reset()),this.lastSn=O,this.lastPartIndex=D}},v.onFragLoaded=function(d,x){var S=x.frag,T=x.payload,w=this.initPTS,L=this.unparsedVttFrags;if(S.type===u.PlaylistLevelType.SUBTITLE)if(T.byteLength){if(!Object(n.isFiniteNumber)(w[S.cc])){L.push(x),w.length&&this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:S,error:new Error("Missing initial subtitle PTS")});return}var I=S.decryptdata,A="stats"in x;if(I==null||I.key==null||I.method!=="AES-128"||A){var O=this.tracks[S.level],D=this.vttCCs;D[S.cc]||(D[S.cc]={start:S.start,prevCC:this.prevCC,new:!0},this.prevCC=S.cc),O&&O.textCodec===l.IMSC1_CODEC?this._parseIMSC1(S,T):this._parseVTTs(S,T,D)}}else this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:S,error:new Error("Empty subtitle payload")})},v._parseIMSC1=function(d,x){var S=this,T=this.hls;Object(l.parseIMSC1)(x,this.initPTS[d.cc],this.timescale[d.cc],function(w){S._appendCues(w,d.level),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(w){m.logger.log("Failed to parse IMSC1: "+w),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:w})})},v._parseVTTs=function(d,x,S){var T=this,w=this.hls;Object(h.parseWebVTT)(x,this.initPTS[d.cc],this.timescale[d.cc],S,d.cc,d.start,function(L){T._appendCues(L,d.level),w.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(L){T._fallbackToIMSC1(d,x),m.logger.log("Failed to parse VTT cue: "+L),w.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:L})})},v._fallbackToIMSC1=function(d,x){var S=this,T=this.tracks[d.level];T.textCodec||Object(l.parseIMSC1)(x,this.initPTS[d.cc],this.timescale[d.cc],function(){T.textCodec=l.IMSC1_CODEC,S._parseIMSC1(d,x)},function(){T.textCodec="wvtt"})},v._appendCues=function(d,x){var S=this.hls;if(this.config.renderTextTracksNatively){var T=this.textTracks[x];if(T.mode==="disabled")return;d.forEach(function(I){return Object(p.addCueToTrack)(T,I)})}else{var w=this.tracks[x],L=w.default?"default":"subtitles"+x;S.trigger(a.Events.CUES_PARSED,{type:"subtitles",cues:d,track:L})}},v.onFragDecrypted=function(d,x){var S=x.frag;if(S.type===u.PlaylistLevelType.SUBTITLE){if(!Object(n.isFiniteNumber)(this.initPTS[S.cc])){this.unparsedVttFrags.push(x);return}this.onFragLoaded(a.Events.FRAG_LOADED,x)}},v.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},v.onFragParsingUserdata=function(d,x){var S=this.cea608Parser1,T=this.cea608Parser2;if(!(!this.enabled||!(S&&T)))for(var w=0;w<x.samples.length;w++){var L=x.samples[w].bytes;if(L){var I=this.extractCea608Data(L);S.addData(x.samples[w].pts,I[0]),T.addData(x.samples[w].pts,I[1])}}},v.onBufferFlushing=function(d,x){var S=x.startOffset,T=x.endOffset,w=x.endOffsetSubtitles,L=x.type,I=this.media;if(!(!I||I.currentTime<T)){if(!L||L==="video"){var A=this.captionsTracks;Object.keys(A).forEach(function(D){return Object(p.removeCuesInRange)(A[D],S,T)})}if(this.config.renderTextTracksNatively&&S===0&&w!==void 0){var O=this.textTracks;Object.keys(O).forEach(function(D){return Object(p.removeCuesInRange)(O[D],S,w)})}}},v.extractCea608Data=function(d){for(var x=d[0]&31,S=2,T=[[],[]],w=0;w<x;w++){var L=d[S++],I=127&d[S++],A=127&d[S++],O=(4&L)!=0,D=3&L;I===0&&A===0||O&&(D===0||D===1)&&(T[D].push(I),T[D].push(A))}return T},c}();function b(c,v){return c&&c.label===v.name&&!(c.textTrack1||c.textTrack2)}function _(c,v,E,d){return Math.min(v,d)-Math.max(c,E)}function g(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(f,h){this.subtle=void 0,this.aesIV=void 0,this.subtle=f,this.aesIV=h}var o=a.prototype;return o.decrypt=function(h,p){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},p,h)},a}()},"./src/crypt/aes-decryptor.ts":function(r,i,t){t.r(i),t.d(i,"removePadding",function(){return a}),t.d(i,"default",function(){return o});var n=t("./src/utils/typed-array.ts");function a(f){var h=f.byteLength,p=h&&new DataView(f.buffer).getUint8(h-1);return p?Object(n.sliceUint8)(f,0,h-p):f}var o=function(){function f(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var h=f.prototype;return h.uint8ArrayToUint32Array_=function(l){for(var u=new DataView(l),m=new Uint32Array(4),y=0;y<4;y++)m[y]=u.getUint32(y*4);return m},h.initTable=function(){var l=this.sBox,u=this.invSBox,m=this.subMix,y=m[0],b=m[1],_=m[2],g=m[3],c=this.invSubMix,v=c[0],E=c[1],d=c[2],x=c[3],S=new Uint32Array(256),T=0,w=0,L=0;for(L=0;L<256;L++)L<128?S[L]=L<<1:S[L]=L<<1^283;for(L=0;L<256;L++){var I=w^w<<1^w<<2^w<<3^w<<4;I=I>>>8^I&255^99,l[T]=I,u[I]=T;var A=S[T],O=S[A],D=S[O],R=S[I]*257^I*16843008;y[T]=R<<24|R>>>8,b[T]=R<<16|R>>>16,_[T]=R<<8|R>>>24,g[T]=R,R=D*16843009^O*65537^A*257^T*16843008,v[I]=R<<24|R>>>8,E[I]=R<<16|R>>>16,d[I]=R<<8|R>>>24,x[I]=R,T?(T=A^S[S[S[D^A]]],w^=S[S[w]]):T=w=1}},h.expandKey=function(l){for(var u=this.uint8ArrayToUint32Array_(l),m=!0,y=0;y<u.length&&m;)m=u[y]===this.key[y],y++;if(!m){this.key=u;var b=this.keySize=u.length;if(b!==4&&b!==6&&b!==8)throw new Error("Invalid aes key size="+b);var _=this.ksRows=(b+6+1)*4,g,c,v=this.keySchedule=new Uint32Array(_),E=this.invKeySchedule=new Uint32Array(_),d=this.sBox,x=this.rcon,S=this.invSubMix,T=S[0],w=S[1],L=S[2],I=S[3],A,O;for(g=0;g<_;g++){if(g<b){A=v[g]=u[g];continue}O=A,g%b==0?(O=O<<8|O>>>24,O=d[O>>>24]<<24|d[O>>>16&255]<<16|d[O>>>8&255]<<8|d[O&255],O^=x[g/b|0]<<24):b>6&&g%b==4&&(O=d[O>>>24]<<24|d[O>>>16&255]<<16|d[O>>>8&255]<<8|d[O&255]),v[g]=A=(v[g-b]^O)>>>0}for(c=0;c<_;c++)g=_-c,c&3?O=v[g]:O=v[g-4],c<4||g<=4?E[c]=O:E[c]=T[d[O>>>24]]^w[d[O>>>16&255]]^L[d[O>>>8&255]]^I[d[O&255]],E[c]=E[c]>>>0}},h.networkToHostOrderSwap=function(l){return l<<24|(l&65280)<<8|(l&16711680)>>8|l>>>24},h.decrypt=function(l,u,m){for(var y=this.keySize+6,b=this.invKeySchedule,_=this.invSBox,g=this.invSubMix,c=g[0],v=g[1],E=g[2],d=g[3],x=this.uint8ArrayToUint32Array_(m),S=x[0],T=x[1],w=x[2],L=x[3],I=new Int32Array(l),A=new Int32Array(I.length),O,D,R,C,P,M,N,B,U,F,j,$,G,Y,X=this.networkToHostOrderSwap;u<I.length;){for(U=X(I[u]),F=X(I[u+1]),j=X(I[u+2]),$=X(I[u+3]),P=U^b[0],M=$^b[1],N=j^b[2],B=F^b[3],G=4,Y=1;Y<y;Y++)O=c[P>>>24]^v[M>>16&255]^E[N>>8&255]^d[B&255]^b[G],D=c[M>>>24]^v[N>>16&255]^E[B>>8&255]^d[P&255]^b[G+1],R=c[N>>>24]^v[B>>16&255]^E[P>>8&255]^d[M&255]^b[G+2],C=c[B>>>24]^v[P>>16&255]^E[M>>8&255]^d[N&255]^b[G+3],P=O,M=D,N=R,B=C,G=G+4;O=_[P>>>24]<<24^_[M>>16&255]<<16^_[N>>8&255]<<8^_[B&255]^b[G],D=_[M>>>24]<<24^_[N>>16&255]<<16^_[B>>8&255]<<8^_[P&255]^b[G+1],R=_[N>>>24]<<24^_[B>>16&255]<<16^_[P>>8&255]<<8^_[M&255]^b[G+2],C=_[B>>>24]<<24^_[P>>16&255]<<16^_[M>>8&255]<<8^_[N&255]^b[G+3],A[u]=X(O^S),A[u+1]=X(C^T),A[u+2]=X(R^w),A[u+3]=X(D^L),S=U,T=F,w=j,L=$,u=u+4}return A.buffer},f}()},"./src/crypt/decrypter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return u});var n=t("./src/crypt/aes-crypto.ts"),a=t("./src/crypt/fast-aes-key.ts"),o=t("./src/crypt/aes-decryptor.ts"),f=t("./src/utils/logger.ts"),h=t("./src/utils/mp4-tools.ts"),p=t("./src/utils/typed-array.ts"),l=16,u=function(){function m(b,_,g){var c=g===void 0?{}:g,v=c.removePKCS7Padding,E=v===void 0?!0:v;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=b,this.config=_,this.removePKCS7Padding=E,E)try{var d=self.crypto;d&&(this.subtle=d.subtle||d.webkitSubtle)}catch(x){}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var y=m.prototype;return y.destroy=function(){this.observer=null},y.isSync=function(){return this.config.enableSoftwareAES},y.flush=function(){var _=this.currentResult;if(!_){this.reset();return}var g=new Uint8Array(_);return this.reset(),this.removePKCS7Padding?Object(o.removePadding)(g):g},y.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},y.decrypt=function(_,g,c,v){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(_),g,c);var E=this.flush();E&&v(E.buffer)}else this.webCryptoDecrypt(new Uint8Array(_),g,c).then(v)},y.softwareDecrypt=function(_,g,c){var v=this.currentIV,E=this.currentResult,d=this.remainderData;this.logOnce("JS AES decrypt"),d&&(_=Object(h.appendUint8Array)(d,_),this.remainderData=null);var x=this.getValidChunk(_);if(!x.length)return null;v&&(c=v);var S=this.softwareDecrypter;S||(S=this.softwareDecrypter=new o.default),S.expandKey(g);var T=E;return this.currentResult=S.decrypt(x.buffer,0,c),this.currentIV=Object(p.sliceUint8)(x,-16).buffer,T||null},y.webCryptoDecrypt=function(_,g,c){var v=this,E=this.subtle;return(this.key!==g||!this.fastAesKey)&&(this.key=g,this.fastAesKey=new a.default(E,g)),this.fastAesKey.expandKey().then(function(d){if(!E)return Promise.reject(new Error("web crypto not initialized"));var x=new n.default(E,c);return x.decrypt(_.buffer,d)}).catch(function(d){return v.onWebCryptoError(d,_,g,c)})},y.onWebCryptoError=function(_,g,c,v){return f.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",_),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(g,c,v)},y.getValidChunk=function(_){var g=_,c=_.length-_.length%l;return c!==_.length&&(g=Object(p.sliceUint8)(_,0,c),this.remainderData=Object(p.sliceUint8)(_,c)),g},y.logOnce=function(_){!this.logEnabled||(f.logger.log("[decrypter.ts]: "+_),this.logEnabled=!1)},m}()},"./src/crypt/fast-aes-key.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(f,h){this.subtle=void 0,this.key=void 0,this.subtle=f,this.key=h}var o=a.prototype;return o.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},a}()},"./src/demux/aacdemuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/adts.ts"),o=t("./src/utils/logger.ts"),f=t("./src/demux/id3.ts");function h(u,m){u.prototype=Object.create(m.prototype),u.prototype.constructor=u,p(u,m)}function p(u,m){return p=Object.setPrototypeOf||function(b,_){return b.__proto__=_,b},p(u,m)}var l=function(u){h(m,u);function m(b,_){var g;return g=u.call(this)||this,g.observer=void 0,g.config=void 0,g.observer=b,g.config=_,g}var y=m.prototype;return y.resetInitSegment=function(_,g,c){u.prototype.resetInitSegment.call(this,_,g,c),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:_,duration:c,inputTimeScale:9e4,dropped:0}},m.probe=function(_){if(!_)return!1;for(var g=f.getID3Data(_,0)||[],c=g.length,v=_.length;c<v;c++)if(a.probe(_,c))return o.logger.log("ADTS sync word found !"),!0;return!1},y.canParse=function(_,g){return a.canParse(_,g)},y.appendFrame=function(_,g,c){a.initTrackConfig(_,this.observer,g,c,_.manifestCodec);var v=a.appendFrame(_,g,c,this.initPTS,this.frameIndex);if(v&&v.missing===0)return v},m}(n.default);l.minProbeByteLength=9,i.default=l},"./src/demux/adts.ts":function(r,i,t){t.r(i),t.d(i,"getAudioConfig",function(){return f}),t.d(i,"isHeaderPattern",function(){return h}),t.d(i,"getHeaderLength",function(){return p}),t.d(i,"getFullFrameLength",function(){return l}),t.d(i,"canGetFrameLength",function(){return u}),t.d(i,"isHeader",function(){return m}),t.d(i,"canParse",function(){return y}),t.d(i,"probe",function(){return b}),t.d(i,"initTrackConfig",function(){return _}),t.d(i,"getFrameDuration",function(){return g}),t.d(i,"parseFrameHeader",function(){return c}),t.d(i,"appendFrame",function(){return v});var n=t("./src/utils/logger.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts");function f(E,d,x,S){var T,w,L,I,A=navigator.userAgent.toLowerCase(),O=S,D=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];T=((d[x+2]&192)>>>6)+1;var R=(d[x+2]&60)>>>2;if(R>D.length-1){E.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+R});return}return L=(d[x+2]&1)<<2,L|=(d[x+3]&192)>>>6,n.logger.log("manifest codec:"+S+", ADTS type:"+T+", samplingIndex:"+R),/firefox/i.test(A)?R>=6?(T=5,I=new Array(4),w=R-3):(T=2,I=new Array(2),w=R):A.indexOf("android")!==-1?(T=2,I=new Array(2),w=R):(T=5,I=new Array(4),S&&(S.indexOf("mp4a.40.29")!==-1||S.indexOf("mp4a.40.5")!==-1)||!S&&R>=6?w=R-3:((S&&S.indexOf("mp4a.40.2")!==-1&&(R>=6&&L===1||/vivaldi/i.test(A))||!S&&L===1)&&(T=2,I=new Array(2)),w=R)),I[0]=T<<3,I[0]|=(R&14)>>1,I[1]|=(R&1)<<7,I[1]|=L<<3,T===5&&(I[1]|=(w&14)>>1,I[2]=(w&1)<<7,I[2]|=2<<2,I[3]=0),{config:I,samplerate:D[R],channelCount:L,codec:"mp4a.40."+T,manifestCodec:O}}function h(E,d){return E[d]===255&&(E[d+1]&246)==240}function p(E,d){return E[d+1]&1?7:9}function l(E,d){return(E[d+3]&3)<<11|E[d+4]<<3|(E[d+5]&224)>>>5}function u(E,d){return d+5<E.length}function m(E,d){return d+1<E.length&&h(E,d)}function y(E,d){return u(E,d)&&h(E,d)&&l(E,d)<=E.length-d}function b(E,d){if(m(E,d)){var x=p(E,d);if(d+x>=E.length)return!1;var S=l(E,d);if(S<=x)return!1;var T=d+S;return T===E.length||m(E,T)}return!1}function _(E,d,x,S,T){if(!E.samplerate){var w=f(d,x,S,T);if(!w)return;E.config=w.config,E.samplerate=w.samplerate,E.channelCount=w.channelCount,E.codec=w.codec,E.manifestCodec=w.manifestCodec,n.logger.log("parsed codec:"+E.codec+", rate:"+w.samplerate+", channels:"+w.channelCount)}}function g(E){return 1024*9e4/E}function c(E,d,x,S,T){var w=p(E,d),L=l(E,d);if(L-=w,L>0){var I=x+S*T;return{headerLength:w,frameLength:L,stamp:I}}}function v(E,d,x,S,T){var w=g(E.samplerate),L=c(d,x,S,T,w);if(L){var I=L.frameLength,A=L.headerLength,O=L.stamp,D=A+I,R=Math.max(0,x+D-d.length),C;R?(C=new Uint8Array(D-A),C.set(d.subarray(x+A,d.length),0)):C=d.subarray(x+A,x+D);var P={unit:C,pts:O};return R||E.samples.push(P),{sample:P,length:D,missing:R}}}},"./src/demux/base-audio-demuxer.ts":function(r,i,t){t.r(i),t.d(i,"initPTSFn",function(){return l});var n=t("./src/polyfills/number.ts"),a=t("./src/demux/id3.ts"),o=t("./src/demux/dummy-demuxed-track.ts"),f=t("./src/utils/mp4-tools.ts"),h=t("./src/utils/typed-array.ts"),p=function(){function u(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var m=u.prototype;return m.resetInitSegment=function(b,_,g){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},m.resetTimeStamp=function(){},m.resetContiguity=function(){},m.canParse=function(b,_){return!1},m.appendFrame=function(b,_,g){},m.demux=function(b,_){this.cachedData&&(b=Object(f.appendUint8Array)(this.cachedData,b),this.cachedData=null);var g=a.getID3Data(b,0),c=g?g.length:0,v,E,d=this._audioTrack,x=this._id3Track,S=g?a.getTimeStamp(g):void 0,T=b.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=l(S,_)),g&&g.length>0&&x.samples.push({pts:this.initPTS,dts:this.initPTS,data:g}),E=this.initPTS;c<T;){if(this.canParse(b,c)){var w=this.appendFrame(d,b,c);w?(this.frameIndex++,E=w.sample.pts,c+=w.length,v=c):c=T}else a.canParse(b,c)?(g=a.getID3Data(b,c),x.samples.push({pts:E,dts:E,data:g}),c+=g.length,v=c):c++;if(c===T&&v!==T){var L=Object(h.sliceUint8)(b,v);this.cachedData?this.cachedData=Object(f.appendUint8Array)(this.cachedData,L):this.cachedData=L}}return{audioTrack:d,avcTrack:Object(o.dummyTrack)(),id3Track:x,textTrack:Object(o.dummyTrack)()}},m.demuxSampleAes=function(b,_,g){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},m.flush=function(b){var _=this.cachedData;return _&&(this.cachedData=null,this.demux(_,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(o.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(o.dummyTrack)()}},m.destroy=function(){},u}(),l=function(m,y){return Object(n.isFiniteNumber)(m)?m*90:y*9e4};i.default=p},"./src/demux/chunk-cache.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function o(){this.chunks=[],this.dataLength=0}var f=o.prototype;return f.push=function(p){this.chunks.push(p),this.dataLength+=p.length},f.flush=function(){var p=this.chunks,l=this.dataLength,u;if(p.length)p.length===1?u=p[0]:u=a(p,l);else return new Uint8Array(0);return this.reset(),u},f.reset=function(){this.chunks.length=0,this.dataLength=0},o}();function a(o,f){for(var h=new Uint8Array(f),p=0,l=0;l<o.length;l++){var u=o[l];h.set(u,p),p+=u.length}return h}},"./src/demux/dummy-demuxed-track.ts":function(r,i,t){t.r(i),t.d(i,"dummyTrack",function(){return n});function n(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=function(){function o(h){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=h,this.bytesAvailable=h.byteLength,this.word=0,this.bitsAvailable=0}var f=o.prototype;return f.loadWord=function(){var p=this.data,l=this.bytesAvailable,u=p.byteLength-l,m=new Uint8Array(4),y=Math.min(4,l);if(y===0)throw new Error("no bytes available");m.set(p.subarray(u,u+y)),this.word=new DataView(m.buffer).getUint32(0),this.bitsAvailable=y*8,this.bytesAvailable-=y},f.skipBits=function(p){var l;this.bitsAvailable>p?(this.word<<=p,this.bitsAvailable-=p):(p-=this.bitsAvailable,l=p>>3,p-=l>>3,this.bytesAvailable-=l,this.loadWord(),this.word<<=p,this.bitsAvailable-=p)},f.readBits=function(p){var l=Math.min(this.bitsAvailable,p),u=this.word>>>32-l;return p>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=l,this.bitsAvailable>0?this.word<<=l:this.bytesAvailable>0&&this.loadWord(),l=p-l,l>0&&this.bitsAvailable?u<<l|this.readBits(l):u},f.skipLZ=function(){var p;for(p=0;p<this.bitsAvailable;++p)if((this.word&2147483648>>>p)!=0)return this.word<<=p,this.bitsAvailable-=p,p;return this.loadWord(),p+this.skipLZ()},f.skipUEG=function(){this.skipBits(1+this.skipLZ())},f.skipEG=function(){this.skipBits(1+this.skipLZ())},f.readUEG=function(){var p=this.skipLZ();return this.readBits(p+1)-1},f.readEG=function(){var p=this.readUEG();return 1&p?1+p>>>1:-1*(p>>>1)},f.readBoolean=function(){return this.readBits(1)===1},f.readUByte=function(){return this.readBits(8)},f.readUShort=function(){return this.readBits(16)},f.readUInt=function(){return this.readBits(32)},f.skipScalingList=function(p){for(var l=8,u=8,m,y=0;y<p;y++)u!==0&&(m=this.readEG(),u=(l+m+256)%256),l=u===0?l:u},f.readSPS=function(){var p=0,l=0,u=0,m=0,y,b,_,g=this.readUByte.bind(this),c=this.readBits.bind(this),v=this.readUEG.bind(this),E=this.readBoolean.bind(this),d=this.skipBits.bind(this),x=this.skipEG.bind(this),S=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);g();var w=g();if(c(5),d(3),g(),S(),w===100||w===110||w===122||w===244||w===44||w===83||w===86||w===118||w===128){var L=v();if(L===3&&d(1),S(),S(),d(1),E())for(b=L!==3?8:12,_=0;_<b;_++)E()&&(_<6?T(16):T(64))}S();var I=v();if(I===0)v();else if(I===1)for(d(1),x(),x(),y=v(),_=0;_<y;_++)x();S(),d(1);var A=v(),O=v(),D=c(1);D===0&&d(1),d(1),E()&&(p=v(),l=v(),u=v(),m=v());var R=[1,1];if(E()&&E()){var C=g();switch(C){case 1:R=[1,1];break;case 2:R=[12,11];break;case 3:R=[10,11];break;case 4:R=[16,11];break;case 5:R=[40,33];break;case 6:R=[24,11];break;case 7:R=[20,11];break;case 8:R=[32,11];break;case 9:R=[80,33];break;case 10:R=[18,11];break;case 11:R=[15,11];break;case 12:R=[64,33];break;case 13:R=[160,99];break;case 14:R=[4,3];break;case 15:R=[3,2];break;case 16:R=[2,1];break;case 255:{R=[g()<<8|g(),g()<<8|g()];break}}}return{width:Math.ceil((A+1)*16-p*2-l*2),height:(2-D)*(O+1)*16-(D?2:4)*(u+m),pixelRatio:R}},f.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o}();i.default=a},"./src/demux/id3.ts":function(r,i,t){t.r(i),t.d(i,"isHeader",function(){return n}),t.d(i,"isFooter",function(){return a}),t.d(i,"getID3Data",function(){return o}),t.d(i,"canParse",function(){return h}),t.d(i,"getTimeStamp",function(){return p}),t.d(i,"isTimeStampFrame",function(){return l}),t.d(i,"getID3Frames",function(){return m}),t.d(i,"decodeFrame",function(){return y}),t.d(i,"utf8ArrayToStr",function(){return v}),t.d(i,"testables",function(){return E});var n=function(T,w){return w+10<=T.length&&T[w]===73&&T[w+1]===68&&T[w+2]===51&&T[w+3]<255&&T[w+4]<255&&T[w+6]<128&&T[w+7]<128&&T[w+8]<128&&T[w+9]<128},a=function(T,w){return w+10<=T.length&&T[w]===51&&T[w+1]===68&&T[w+2]===73&&T[w+3]<255&&T[w+4]<255&&T[w+6]<128&&T[w+7]<128&&T[w+8]<128&&T[w+9]<128},o=function(T,w){for(var L=w,I=0;n(T,w);){I+=10;var A=f(T,w+6);I+=A,a(T,w+10)&&(I+=10),w+=I}if(I>0)return T.subarray(L,L+I)},f=function(T,w){var L=0;return L=(T[w]&127)<<21,L|=(T[w+1]&127)<<14,L|=(T[w+2]&127)<<7,L|=T[w+3]&127,L},h=function(T,w){return n(T,w)&&f(T,w+6)+10<=T.length-w},p=function(T){for(var w=m(T),L=0;L<w.length;L++){var I=w[L];if(l(I))return c(I)}},l=function(T){return T&&T.key==="PRIV"&&T.info==="com.apple.streaming.transportStreamTimestamp"},u=function(T){var w=String.fromCharCode(T[0],T[1],T[2],T[3]),L=f(T,4),I=10;return{type:w,size:L,data:T.subarray(I,I+L)}},m=function(T){for(var w=0,L=[];n(T,w);){var I=f(T,w+6);w+=10;for(var A=w+I;w+8<A;){var O=u(T.subarray(w)),D=y(O);D&&L.push(D),w+=O.size+10}a(T,w)&&(w+=10)}return L},y=function(T){return T.type==="PRIV"?b(T):T.type[0]==="W"?g(T):_(T)},b=function(T){if(!(T.size<2)){var w=v(T.data,!0),L=new Uint8Array(T.data.subarray(w.length+1));return{key:T.type,info:w,data:L.buffer}}},_=function(T){if(!(T.size<2)){if(T.type==="TXXX"){var w=1,L=v(T.data.subarray(w),!0);w+=L.length+1;var I=v(T.data.subarray(w));return{key:T.type,info:L,data:I}}var A=v(T.data.subarray(1));return{key:T.type,data:A}}},g=function(T){if(T.type==="WXXX"){if(T.size<2)return;var w=1,L=v(T.data.subarray(w),!0);w+=L.length+1;var I=v(T.data.subarray(w));return{key:T.type,info:L,data:I}}var A=v(T.data);return{key:T.type,data:A}},c=function(T){if(T.data.byteLength===8){var w=new Uint8Array(T.data),L=w[3]&1,I=(w[4]<<23)+(w[5]<<15)+(w[6]<<7)+w[7];return I/=45,L&&(I+=4772185884e-2),Math.round(I)}},v=function(T,w){w===void 0&&(w=!1);var L=x();if(L){var I=L.decode(T);if(w){var A=I.indexOf("\0");return A!==-1?I.substring(0,A):I}return I.replace(/\0/g,"")}for(var O=T.length,D,R,C,P="",M=0;M<O;){if(D=T[M++],D===0&&w)return P;if(D===0||D===3)continue;switch(D>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:P+=String.fromCharCode(D);break;case 12:case 13:R=T[M++],P+=String.fromCharCode((D&31)<<6|R&63);break;case 14:R=T[M++],C=T[M++],P+=String.fromCharCode((D&15)<<12|(R&63)<<6|(C&63)<<0);break}}return P},E={decodeTextFrame:_},d;function x(){return!d&&typeof self.TextDecoder!="undefined"&&(d=new self.TextDecoder("utf-8")),d}},"./src/demux/mp3demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/id3.ts"),o=t("./src/utils/logger.ts"),f=t("./src/demux/mpegaudio.ts");function h(u,m){u.prototype=Object.create(m.prototype),u.prototype.constructor=u,p(u,m)}function p(u,m){return p=Object.setPrototypeOf||function(b,_){return b.__proto__=_,b},p(u,m)}var l=function(u){h(m,u);function m(){return u.apply(this,arguments)||this}var y=m.prototype;return y.resetInitSegment=function(_,g,c){u.prototype.resetInitSegment.call(this,_,g,c),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:_,duration:c,inputTimeScale:9e4,dropped:0}},m.probe=function(_){if(!_)return!1;for(var g=a.getID3Data(_,0)||[],c=g.length,v=_.length;c<v;c++)if(f.probe(_,c))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},y.canParse=function(_,g){return f.canParse(_,g)},y.appendFrame=function(_,g,c){if(this.initPTS!==null)return f.appendFrame(_,g,c,this.initPTS,this.frameIndex)},m}(n.default);l.minProbeByteLength=4,i.default=l},"./src/demux/mp4demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/utils/mp4-tools.ts"),a=t("./src/demux/dummy-demuxed-track.ts"),o=function(){function f(p,l){this.remainderData=null,this.config=void 0,this.config=l}var h=f.prototype;return h.resetTimeStamp=function(){},h.resetInitSegment=function(){},h.resetContiguity=function(){},f.probe=function(l){return Object(n.findBox)({data:l,start:0,end:Math.min(l.length,16384)},["moof"]).length>0},h.demux=function(l){var u=l,m=Object(a.dummyTrack)();if(this.config.progressive){this.remainderData&&(u=Object(n.appendUint8Array)(this.remainderData,l));var y=Object(n.segmentValidRange)(u);this.remainderData=y.remainder,m.samples=y.valid||new Uint8Array}else m.samples=u;return{audioTrack:Object(a.dummyTrack)(),avcTrack:m,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},h.flush=function(){var l=Object(a.dummyTrack)();return l.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(a.dummyTrack)(),avcTrack:l,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},h.demuxSampleAes=function(l,u,m){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},h.destroy=function(){},f}();o.minProbeByteLength=1024,i.default=o},"./src/demux/mpegaudio.ts":function(r,i,t){t.r(i),t.d(i,"appendFrame",function(){return p}),t.d(i,"parseHeader",function(){return l}),t.d(i,"isHeaderPattern",function(){return u}),t.d(i,"isHeader",function(){return m}),t.d(i,"canParse",function(){return y}),t.d(i,"probe",function(){return b});var n=null,a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],f=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],h=[0,1,1,4];function p(_,g,c,v,E){if(!(c+24>g.length)){var d=l(g,c);if(d&&c+d.frameLength<=g.length){var x=d.samplesPerFrame*9e4/d.sampleRate,S=v+E*x,T={unit:g.subarray(c,c+d.frameLength),pts:S,dts:S};return _.config=[],_.channelCount=d.channelCount,_.samplerate=d.sampleRate,_.samples.push(T),{sample:T,length:d.frameLength,missing:0}}}}function l(_,g){var c=_[g+1]>>3&3,v=_[g+1]>>1&3,E=_[g+2]>>4&15,d=_[g+2]>>2&3;if(c!==1&&E!==0&&E!==15&&d!==3){var x=_[g+2]>>1&1,S=_[g+3]>>6,T=c===3?3-v:v===3?3:4,w=a[T*14+E-1]*1e3,L=c===3?0:c===2?1:2,I=o[L*3+d],A=S===3?1:2,O=f[c][v],D=h[v],R=O*8*D,C=Math.floor(O*w/I+x)*D;if(n===null){var P=navigator.userAgent||"",M=P.match(/Chrome\/(\d+)/i);n=M?parseInt(M[1]):0}var N=!!n&&n<=87;return N&&v===2&&w>=224e3&&S===0&&(_[g+3]=_[g+3]|128),{sampleRate:I,channelCount:A,frameLength:C,samplesPerFrame:R}}}function u(_,g){return _[g]===255&&(_[g+1]&224)==224&&(_[g+1]&6)!=0}function m(_,g){return g+1<_.length&&u(_,g)}function y(_,g){var c=4;return u(_,g)&&c<=_.length-g}function b(_,g){if(g+1<_.length&&u(_,g)){var c=4,v=l(_,g),E=c;v!=null&&v.frameLength&&(E=v.frameLength);var d=g+E;return d===_.length||m(_,d)}return!1}},"./src/demux/sample-aes.ts":function(r,i,t){t.r(i);var n=t("./src/crypt/decrypter.ts"),a=t("./src/demux/tsdemuxer.ts"),o=function(){function f(p,l,u){this.keyData=void 0,this.decrypter=void 0,this.keyData=u,this.decrypter=new n.default(p,l,{removePKCS7Padding:!1})}var h=f.prototype;return h.decryptBuffer=function(l,u){this.decrypter.decrypt(l,this.keyData.key.buffer,this.keyData.iv.buffer,u)},h.decryptAacSample=function(l,u,m,y){var b=l[u].unit,_=b.subarray(16,b.length-b.length%16),g=_.buffer.slice(_.byteOffset,_.byteOffset+_.length),c=this;this.decryptBuffer(g,function(v){var E=new Uint8Array(v);b.set(E,16),y||c.decryptAacSamples(l,u+1,m)})},h.decryptAacSamples=function(l,u,m){for(;;u++){if(u>=l.length){m();return}if(!(l[u].unit.length<32)){var y=this.decrypter.isSync();if(this.decryptAacSample(l,u,m,y),!y)return}}},h.getAvcEncryptedData=function(l){for(var u=Math.floor((l.length-48)/160)*16+16,m=new Int8Array(u),y=0,b=32;b<l.length-16;b+=160,y+=16)m.set(l.subarray(b,b+16),y);return m},h.getAvcDecryptedUnit=function(l,u){for(var m=new Uint8Array(u),y=0,b=32;b<l.length-16;b+=160,y+=16)l.set(m.subarray(y,y+16),b);return l},h.decryptAvcSample=function(l,u,m,y,b,_){var g=Object(a.discardEPB)(b.data),c=this.getAvcEncryptedData(g),v=this;this.decryptBuffer(c.buffer,function(E){b.data=v.getAvcDecryptedUnit(g,E),_||v.decryptAvcSamples(l,u,m+1,y)})},h.decryptAvcSamples=function(l,u,m,y){if(l instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;u++,m=0){if(u>=l.length){y();return}for(var b=l[u].units;!(m>=b.length);m++){var _=b[m];if(!(_.data.length<=48||_.type!==1&&_.type!==5)){var g=this.decrypter.isSync();if(this.decryptAvcSample(l,u,m,y,_,g),!g)return}}}},f}();i.default=o},"./src/demux/transmuxer-interface.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return m});var n=t("./node_modules/webworkify-webpack/index.js"),a=t("./src/events.ts"),o=t("./src/demux/transmuxer.ts"),f=t("./src/utils/logger.ts"),h=t("./src/errors.ts"),p=t("./src/utils/mediasource-helper.ts"),l=t("./node_modules/eventemitter3/index.js"),u=Object(p.getMediaSource)()||{isTypeSupported:function(){return!1}},m=function(){function y(_,g,c,v){var E=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=_,this.id=g,this.onTransmuxComplete=c,this.onFlush=v;var d=_.config,x=function(I,A){A=A||{},A.frag=E.frag,A.id=E.id,_.trigger(I,A)};this.observer=new l.EventEmitter,this.observer.on(a.Events.FRAG_DECRYPTED,x),this.observer.on(a.Events.ERROR,x);var S={mp4:u.isTypeSupported("video/mp4"),mpeg:u.isTypeSupported("audio/mpeg"),mp3:u.isTypeSupported('audio/mp4; codecs="mp3"')},T=navigator.vendor;if(d.enableWorker&&typeof Worker!="undefined"){f.logger.log("demuxing in webworker");var w;try{w=this.worker=n("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),w.addEventListener("message",this.onwmsg),w.onerror=function(L){_.trigger(a.Events.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(L.message+"  ("+L.filename+":"+L.lineno+")")})},w.postMessage({cmd:"init",typeSupported:S,vendor:T,id:g,config:JSON.stringify(d)})}catch(L){f.logger.warn("Error in worker:",L),f.logger.error("Error while initializing DemuxerWorker, fallback to inline"),w&&self.URL.revokeObjectURL(w.objectURL),this.transmuxer=new o.default(this.observer,S,d,T,g),this.worker=null}}else this.transmuxer=new o.default(this.observer,S,d,T,g)}var b=y.prototype;return b.destroy=function(){var g=this.worker;if(g)g.removeEventListener("message",this.onwmsg),g.terminate(),this.worker=null;else{var c=this.transmuxer;c&&(c.destroy(),this.transmuxer=null)}var v=this.observer;v&&v.removeAllListeners(),this.observer=null},b.push=function(g,c,v,E,d,x,S,T,w,L){var I,A,O=this;w.transmuxing.start=self.performance.now();var D=this.transmuxer,R=this.worker,C=x?x.start:d.start,P=d.decryptdata,M=this.frag,N=!(M&&d.cc===M.cc),B=!(M&&w.level===M.level),U=M?w.sn-M.sn:-1,F=this.part?w.part-this.part.index:1,j=!B&&(U===1||U===0&&F===1),$=self.performance.now();(B||U||d.stats.parsing.start===0)&&(d.stats.parsing.start=$),x&&(F||!j)&&(x.stats.parsing.start=$);var G=!(M&&((I=d.initSegment)===null||I===void 0?void 0:I.url)===((A=M.initSegment)===null||A===void 0?void 0:A.url)),Y=new o.TransmuxState(N,j,T,B,C,G);if(!j||N||G){f.logger.log("[transmuxer-interface, "+d.type+"]: Starting new transmux session for sn: "+w.sn+" p: "+w.part+" level: "+w.level+" id: "+w.id+`
        discontinuity: `+N+`
        trackSwitch: `+B+`
        contiguous: `+j+`
        accurateTimeOffset: `+T+`
        timeOffset: `+C+`
        initSegmentChange: `+G);var X=new o.TransmuxConfig(v,E,c,S,L);this.configureTransmuxer(X)}if(this.frag=d,this.part=x,R)R.postMessage({cmd:"demux",data:g,decryptdata:P,chunkMeta:w,state:Y},g instanceof ArrayBuffer?[g]:[]);else if(D){var ie=D.push(g,P,w,Y);Object(o.isPromise)(ie)?ie.then(function(pe){O.handleTransmuxComplete(pe)}):this.handleTransmuxComplete(ie)}},b.flush=function(g){var c=this;g.transmuxing.start=self.performance.now();var v=this.transmuxer,E=this.worker;if(E)E.postMessage({cmd:"flush",chunkMeta:g});else if(v){var d=v.flush(g);Object(o.isPromise)(d)?d.then(function(x){c.handleFlushResult(x,g)}):this.handleFlushResult(d,g)}},b.handleFlushResult=function(g,c){var v=this;g.forEach(function(E){v.handleTransmuxComplete(E)}),this.onFlush(c)},b.onWorkerMessage=function(g){var c=g.data,v=this.hls;switch(c.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.id=this.id,v.trigger(c.event,c.data);break}}},b.configureTransmuxer=function(g){var c=this.worker,v=this.transmuxer;c?c.postMessage({cmd:"configure",config:g}):v&&v.configure(g)},b.handleTransmuxComplete=function(g){g.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(g)},y}()},"./src/demux/transmuxer-worker.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return h});var n=t("./src/demux/transmuxer.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),f=t("./node_modules/eventemitter3/index.js");function h(y){var b=new f.EventEmitter,_=function(c,v){y.postMessage({event:c,data:v})};b.on(a.Events.FRAG_DECRYPTED,_),b.on(a.Events.ERROR,_),y.addEventListener("message",function(g){var c=g.data;switch(c.cmd){case"init":{var v=JSON.parse(c.config);y.transmuxer=new n.default(b,c.typeSupported,v,c.vendor,c.id),Object(o.enableLogs)(v.debug),_("init",null);break}case"configure":{y.transmuxer.configure(c.config);break}case"demux":{var E=y.transmuxer.push(c.data,c.decryptdata,c.chunkMeta,c.state);Object(n.isPromise)(E)?E.then(function(S){p(y,S)}):p(y,E);break}case"flush":{var d=c.chunkMeta,x=y.transmuxer.flush(d);Object(n.isPromise)(x)?x.then(function(S){u(y,S,d)}):u(y,x,d);break}}})}function p(y,b){if(!m(b.remuxResult)){var _=[],g=b.remuxResult,c=g.audio,v=g.video;c&&l(_,c),v&&l(_,v),y.postMessage({event:"transmuxComplete",data:b},_)}}function l(y,b){b.data1&&y.push(b.data1.buffer),b.data2&&y.push(b.data2.buffer)}function u(y,b,_){b.forEach(function(g){p(y,g)}),y.postMessage({event:"flush",data:_})}function m(y){return!y.audio&&!y.video&&!y.text&&!y.id3&&!y.initSegment}},"./src/demux/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return E}),t.d(i,"isPromise",function(){return S}),t.d(i,"TransmuxConfig",function(){return T}),t.d(i,"TransmuxState",function(){return w});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/crypt/decrypter.ts"),f=t("./src/demux/aacdemuxer.ts"),h=t("./src/demux/mp4demuxer.ts"),p=t("./src/demux/tsdemuxer.ts"),l=t("./src/demux/mp3demuxer.ts"),u=t("./src/remux/mp4-remuxer.ts"),m=t("./src/remux/passthrough-remuxer.ts"),y=t("./src/demux/chunk-cache.ts"),b=t("./src/utils/mp4-tools.ts"),_=t("./src/utils/logger.ts"),g;try{g=self.performance.now.bind(self.performance)}catch(L){_.logger.debug("Unable to use Performance API on this environment"),g=self.Date.now}var c=[{demux:p.default,remux:u.default},{demux:h.default,remux:m.default},{demux:f.default,remux:u.default},{demux:l.default,remux:u.default}],v=1024;c.forEach(function(L){var I=L.demux;v=Math.max(v,I.minProbeByteLength)});var E=function(){function L(A,O,D,R,C){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new y.default,this.observer=A,this.typeSupported=O,this.config=D,this.vendor=R,this.id=C}var I=L.prototype;return I.configure=function(O){this.transmuxConfig=O,this.decrypter&&this.decrypter.reset()},I.push=function(O,D,R,C){var P=this,M=R.transmuxing;M.executeStart=g();var N=new Uint8Array(O),B=this.cache,U=this.config,F=this.currentTransmuxState,j=this.transmuxConfig;C&&(this.currentTransmuxState=C);var $=d(N,D);if($&&$.method==="AES-128"){var G=this.getDecrypter();if(U.enableSoftwareAES){var Y=G.softwareDecrypt(N,$.key.buffer,$.iv.buffer);if(!Y)return M.executeEnd=g(),x(R);N=new Uint8Array(Y)}else return this.decryptionPromise=G.webCryptoDecrypt(N,$.key.buffer,$.iv.buffer).then(function(Fe){var Se=P.push(Fe,null,R);return P.decryptionPromise=null,Se}),this.decryptionPromise}var X=C||F,ie=X.contiguous,pe=X.discontinuity,ue=X.trackSwitch,we=X.accurateTimeOffset,de=X.timeOffset,oe=X.initSegmentChange,De=j.audioCodec,Ce=j.videoCodec,Ue=j.defaultInitPts,Me=j.duration,ze=j.initSegmentData;if((pe||ue||oe)&&this.resetInitSegment(ze,De,Ce,Me),(pe||oe)&&this.resetInitialTimestamp(Ue),ie||this.resetContiguity(),this.needsProbing(N,pe,ue)){if(B.dataLength){var Ge=B.flush();N=Object(b.appendUint8Array)(Ge,N)}this.configureTransmuxer(N,j)}var Ke=this.transmux(N,$,de,we,R),He=this.currentTransmuxState;return He.contiguous=!0,He.discontinuity=!1,He.trackSwitch=!1,M.executeEnd=g(),Ke},I.flush=function(O){var D=this,R=O.transmuxing;R.executeStart=g();var C=this.decrypter,P=this.cache,M=this.currentTransmuxState,N=this.decryptionPromise;if(N)return N.then(function(){return D.flush(O)});var B=[],U=M.timeOffset;if(C){var F=C.flush();F&&B.push(this.push(F,null,O))}var j=P.dataLength;P.reset();var $=this.demuxer,G=this.remuxer;if(!$||!G)return j>=v&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),R.executeEnd=g(),[x(O)];var Y=$.flush(U);return S(Y)?Y.then(function(X){return D.flushRemux(B,X,O),B}):(this.flushRemux(B,Y,O),B)},I.flushRemux=function(O,D,R){var C=D.audioTrack,P=D.avcTrack,M=D.id3Track,N=D.textTrack,B=this.currentTransmuxState,U=B.accurateTimeOffset,F=B.timeOffset;_.logger.log("[transmuxer.ts]: Flushed fragment "+R.sn+(R.part>-1?" p: "+R.part:"")+" of level "+R.level);var j=this.remuxer.remux(C,P,M,N,F,U,!0,this.id);O.push({remuxResult:j,chunkMeta:R}),R.transmuxing.executeEnd=g()},I.resetInitialTimestamp=function(O){var D=this.demuxer,R=this.remuxer;!D||!R||(D.resetTimeStamp(O),R.resetTimeStamp(O))},I.resetContiguity=function(){var O=this.demuxer,D=this.remuxer;!O||!D||(O.resetContiguity(),D.resetNextTimestamp())},I.resetInitSegment=function(O,D,R,C){var P=this.demuxer,M=this.remuxer;!P||!M||(P.resetInitSegment(D,R,C),M.resetInitSegment(O,D,R))},I.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},I.transmux=function(O,D,R,C,P){var M;return D&&D.method==="SAMPLE-AES"?M=this.transmuxSampleAes(O,D,R,C,P):M=this.transmuxUnencrypted(O,R,C,P),M},I.transmuxUnencrypted=function(O,D,R,C){var P=this.demuxer.demux(O,D,!1,!this.config.progressive),M=P.audioTrack,N=P.avcTrack,B=P.id3Track,U=P.textTrack,F=this.remuxer.remux(M,N,B,U,D,R,!1,this.id);return{remuxResult:F,chunkMeta:C}},I.transmuxSampleAes=function(O,D,R,C,P){var M=this;return this.demuxer.demuxSampleAes(O,D,R).then(function(N){var B=M.remuxer.remux(N.audioTrack,N.avcTrack,N.id3Track,N.textTrack,R,C,!1,M.id);return{remuxResult:B,chunkMeta:P}})},I.configureTransmuxer=function(O,D){for(var R=this.config,C=this.observer,P=this.typeSupported,M=this.vendor,N=D.audioCodec,B=D.defaultInitPts,U=D.duration,F=D.initSegmentData,j=D.videoCodec,$,G=0,Y=c.length;G<Y;G++)if(c[G].demux.probe(O)){$=c[G];break}$||(_.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),$={demux:h.default,remux:m.default});var X=this.demuxer,ie=this.remuxer,pe=$.remux,ue=$.demux;(!ie||!(ie instanceof pe))&&(this.remuxer=new pe(C,R,P,M)),(!X||!(X instanceof ue))&&(this.demuxer=new ue(C,R,P),this.probe=ue.probe),this.resetInitSegment(F,N,j,U),this.resetInitialTimestamp(B)},I.needsProbing=function(O,D,R){return!this.demuxer||!this.remuxer||D||R},I.getDecrypter=function(){var O=this.decrypter;return O||(O=this.decrypter=new o.default(this.observer,this.config)),O},L}();function d(L,I){var A=null;return L.byteLength>0&&I!=null&&I.key!=null&&I.iv!==null&&I.method!=null&&(A=I),A}var x=function(I){return{remuxResult:{},chunkMeta:I}};function S(L){return"then"in L&&L.then instanceof Function}var T=function(I,A,O,D,R){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=I,this.videoCodec=A,this.initSegmentData=O,this.duration=D,this.defaultInitPts=R},w=function(I,A,O,D,R,C){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=I,this.contiguous=A,this.accurateTimeOffset=O,this.trackSwitch=D,this.timeOffset=R,this.initSegmentChange=C}},"./src/demux/tsdemuxer.ts":function(r,i,t){t.r(i),t.d(i,"discardEPB",function(){return x});var n=t("./src/demux/adts.ts"),a=t("./src/demux/mpegaudio.ts"),o=t("./src/demux/exp-golomb.ts"),f=t("./src/demux/id3.ts"),h=t("./src/demux/sample-aes.ts"),p=t("./src/events.ts"),l=t("./src/utils/mp4-tools.ts"),u=t("./src/utils/logger.ts"),m=t("./src/errors.ts"),y={video:1,audio:2,id3:3,text:4},b=function(){function S(w,L,I){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=w,this.config=L,this.typeSupported=I}S.probe=function(L){var I=S.syncOffset(L);return I<0?!1:(I&&u.logger.warn("MPEG2-TS detected but first sync word found @ offset "+I+", junk ahead ?"),!0)},S.syncOffset=function(L){for(var I=Math.min(1e3,L.length-3*188),A=0;A<I;){if(L[A]===71&&L[A+188]===71&&L[A+2*188]===71)return A;A++}return-1},S.createTrack=function(L,I){return{container:L==="video"||L==="audio"?"video/mp2t":void 0,type:L,id:y[L],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:L==="audio"?I:void 0}};var T=S.prototype;return T.resetInitSegment=function(L,I,A){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=S.createTrack("video",A),this._audioTrack=S.createTrack("audio",A),this._id3Track=S.createTrack("id3",A),this._txtTrack=S.createTrack("text",A),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=L,this.videoCodec=I,this._duration=A},T.resetTimeStamp=function(){},T.resetContiguity=function(){var L=this._audioTrack,I=this._avcTrack,A=this._id3Track;L&&(L.pesData=null),I&&(I.pesData=null),A&&(A.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},T.demux=function(L,I,A,O){A===void 0&&(A=!1),O===void 0&&(O=!1),A||(this.sampleAes=null);var D,R=this._avcTrack,C=this._audioTrack,P=this._id3Track,M=R.pid,N=R.pesData,B=C.pid,U=P.pid,F=C.pesData,j=P.pesData,$=!1,G=this.pmtParsed,Y=this._pmtId,X=L.length;if(this.remainderData&&(L=Object(l.appendUint8Array)(this.remainderData,L),X=L.length,this.remainderData=null),X<188&&!O)return this.remainderData=L,{audioTrack:C,avcTrack:R,id3Track:P,textTrack:this._txtTrack};var ie=Math.max(0,S.syncOffset(L));X-=(X+ie)%188,X<L.byteLength&&!O&&(this.remainderData=new Uint8Array(L.buffer,X,L.buffer.byteLength-X));for(var pe=0,ue=ie;ue<X;ue+=188)if(L[ue]===71){var we=!!(L[ue+1]&64),de=((L[ue+1]&31)<<8)+L[ue+2],oe=(L[ue+3]&48)>>4,De=void 0;if(oe>1){if(De=ue+5+L[ue+4],De===ue+188)continue}else De=ue+4;switch(de){case M:we&&(N&&(D=v(N))&&this.parseAVCPES(D,!1),N={data:[],size:0}),N&&(N.data.push(L.subarray(De,ue+188)),N.size+=ue+188-De);break;case B:we&&(F&&(D=v(F))&&(C.isAAC?this.parseAACPES(D):this.parseMPEGPES(D)),F={data:[],size:0}),F&&(F.data.push(L.subarray(De,ue+188)),F.size+=ue+188-De);break;case U:we&&(j&&(D=v(j))&&this.parseID3PES(D),j={data:[],size:0}),j&&(j.data.push(L.subarray(De,ue+188)),j.size+=ue+188-De);break;case 0:we&&(De+=L[De]+1),Y=this._pmtId=g(L,De);break;case Y:{we&&(De+=L[De]+1);var Ce=c(L,De,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,A);M=Ce.avc,M>0&&(R.pid=M),B=Ce.audio,B>0&&(C.pid=B,C.isAAC=Ce.isAAC),U=Ce.id3,U>0&&(P.pid=U),$&&!G&&(u.logger.log("reparse from beginning"),$=!1,ue=ie-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:$=!0;break}}else pe++;pe>0&&this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+pe+" TS packet/s that do not start with 0x47"}),R.pesData=N,C.pesData=F,P.pesData=j;var Ue={audioTrack:C,avcTrack:R,id3Track:P,textTrack:this._txtTrack};return O&&this.extractRemainingSamples(Ue),Ue},T.flush=function(){var L=this.remainderData;this.remainderData=null;var I;return L?I=this.demux(L,-1,!1,!0):I={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(I),this.sampleAes?this.decrypt(I,this.sampleAes):I},T.extractRemainingSamples=function(L){var I=L.audioTrack,A=L.avcTrack,O=L.id3Track,D=A.pesData,R=I.pesData,C=O.pesData,P;D&&(P=v(D))?(this.parseAVCPES(P,!0),A.pesData=null):A.pesData=D,R&&(P=v(R))?(I.isAAC?this.parseAACPES(P):this.parseMPEGPES(P),I.pesData=null):(R!=null&&R.size&&u.logger.log("last AAC PES packet truncated,might overlap between fragments"),I.pesData=R),C&&(P=v(C))?(this.parseID3PES(P),O.pesData=null):O.pesData=C},T.demuxSampleAes=function(L,I,A){var O=this.demux(L,A,!0,!this.config.progressive),D=this.sampleAes=new h.default(this.observer,this.config,I);return this.decrypt(O,D)},T.decrypt=function(L,I){return new Promise(function(A){var O=L.audioTrack,D=L.avcTrack;O.samples&&O.isAAC?I.decryptAacSamples(O.samples,0,function(){D.samples?I.decryptAvcSamples(D.samples,0,0,function(){A(L)}):A(L)}):D.samples&&I.decryptAvcSamples(D.samples,0,0,function(){A(L)})})},T.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},T.parseAVCPES=function(L,I){var A=this,O=this._avcTrack,D=this.parseAVCNALu(L.data),R=this.avcSample,C,P=!1;L.data=null,R&&D.length&&!O.audFound&&(E(R,O),R=this.avcSample=_(!1,L.pts,L.dts,"")),D.forEach(function(M){switch(M.type){case 1:{C=!0,R||(R=A.avcSample=_(!0,L.pts,L.dts,"")),R.frame=!0;var N=M.data;if(P&&N.length>4){var B=new o.default(N).readSliceType();(B===2||B===4||B===7||B===9)&&(R.key=!0)}break}case 5:C=!0,R||(R=A.avcSample=_(!0,L.pts,L.dts,"")),R.key=!0,R.frame=!0;break;case 6:{C=!0;var U=new o.default(x(M.data));U.readUByte();for(var F=0,j=0,$=!1,G=0;!$&&U.bytesAvailable>1;){F=0;do G=U.readUByte(),F+=G;while(G===255);j=0;do G=U.readUByte(),j+=G;while(G===255);if(F===4&&U.bytesAvailable!==0){$=!0;var Y=U.readUByte();if(Y===181){var X=U.readUShort();if(X===49){var ie=U.readUInt();if(ie===1195456820){var pe=U.readUByte();if(pe===3){for(var ue=U.readUByte(),we=U.readUByte(),de=31&ue,oe=[ue,we],De=0;De<de;De++)oe.push(U.readUByte()),oe.push(U.readUByte()),oe.push(U.readUByte());d(A._txtTrack.samples,{type:3,pts:L.pts,bytes:oe})}}}}}else if(F===5&&U.bytesAvailable!==0){if($=!0,j>16){for(var Ce=[],Ue=0;Ue<16;Ue++)Ce.push(U.readUByte().toString(16)),(Ue===3||Ue===5||Ue===7||Ue===9)&&Ce.push("-");for(var Me=j-16,ze=new Uint8Array(Me),Ge=0;Ge<Me;Ge++)ze[Ge]=U.readUByte();d(A._txtTrack.samples,{pts:L.pts,payloadType:F,uuid:Ce.join(""),userData:Object(f.utf8ArrayToStr)(ze),userDataBytes:ze})}}else if(j<U.bytesAvailable)for(var Ke=0;Ke<j;Ke++)U.readUByte()}break}case 7:if(C=!0,P=!0,!O.sps){var He=new o.default(M.data),Fe=He.readSPS();O.width=Fe.width,O.height=Fe.height,O.pixelRatio=Fe.pixelRatio,O.sps=[M.data],O.duration=A._duration;for(var Se=M.data.subarray(1,4),Xe="avc1.",st=0;st<3;st++){var et=Se[st].toString(16);et.length<2&&(et="0"+et),Xe+=et}O.codec=Xe}break;case 8:C=!0,O.pps||(O.pps=[M.data]);break;case 9:C=!1,O.audFound=!0,R&&E(R,O),R=A.avcSample=_(!1,L.pts,L.dts,"");break;case 12:C=!1;break;default:C=!1,R&&(R.debug+="unknown NAL "+M.type+" ");break}if(R&&C){var ot=R.units;ot.push(M)}}),I&&R&&(E(R,O),this.avcSample=null)},T.getLastNalUnit=function(){var L,I=this.avcSample,A;if(!I||I.units.length===0){var O=this._avcTrack.samples;I=O[O.length-1]}if((L=I)!==null&&L!==void 0&&L.units){var D=I.units;A=D[D.length-1]}return A},T.parseAVCNALu=function(L){var I=L.byteLength,A=this._avcTrack,O=A.naluState||0,D=O,R=[],C=0,P,M,N,B=-1,U=0;for(O===-1&&(B=0,U=L[0]&31,O=0,C=1);C<I;){if(P=L[C++],!O){O=P?0:1;continue}if(O===1){O=P?0:2;continue}if(!P)O=3;else if(P===1){if(B>=0){var F={data:L.subarray(B,C-O-1),type:U};R.push(F)}else{var j=this.getLastNalUnit();if(j&&(D&&C<=4-D&&j.state&&(j.data=j.data.subarray(0,j.data.byteLength-D)),M=C-O-1,M>0)){var $=new Uint8Array(j.data.byteLength+M);$.set(j.data,0),$.set(L.subarray(0,M),j.data.byteLength),j.data=$,j.state=0}}C<I?(N=L[C]&31,B=C,U=N,O=0):O=-1}else O=0}if(B>=0&&O>=0){var G={data:L.subarray(B,I),type:U,state:O};R.push(G)}if(R.length===0){var Y=this.getLastNalUnit();if(Y){var X=new Uint8Array(Y.data.byteLength+L.byteLength);X.set(Y.data,0),X.set(L,Y.data.byteLength),Y.data=X}}return A.naluState=O,R},T.parseAACPES=function(L){var I=0,A=this._audioTrack,O=this.aacOverFlow,D=L.data;if(O){this.aacOverFlow=null;var R=O.sample.unit.byteLength,C=Math.min(O.missing,R),P=R-C;O.sample.unit.set(D.subarray(0,C),P),A.samples.push(O.sample),I=O.missing}var M,N;for(M=I,N=D.length;M<N-1&&!n.isHeader(D,M);M++);if(M!==I){var B,U;if(M<N-1?(B="AAC PES did not start with ADTS header,offset:"+M,U=!1):(B="no ADTS header found in AAC PES",U=!0),u.logger.warn("parsing error:"+B),this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_PARSING_ERROR,fatal:U,reason:B}),U)return}n.initTrackConfig(A,this.observer,D,M,this.audioCodec);var F;if(L.pts!==void 0)F=L.pts;else if(O){var j=n.getFrameDuration(A.samplerate);F=O.sample.pts+j}else{u.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var $=0;M<N;)if(n.isHeader(D,M)){if(M+5<N){var G=n.appendFrame(A,D,M,F,$);if(G)if(G.missing)this.aacOverFlow=G;else{M+=G.length,$++;continue}}break}else M++},T.parseMPEGPES=function(L){var I=L.data,A=I.length,O=0,D=0,R=L.pts;if(R===void 0){u.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;D<A;)if(a.isHeader(I,D)){var C=a.appendFrame(this._audioTrack,I,D,R,O);if(C)D+=C.length,O++;else break}else D++},T.parseID3PES=function(L){if(L.pts===void 0){u.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(L)},S}();b.minProbeByteLength=188;function _(S,T,w,L){return{key:S,frame:!1,pts:T,dts:w,units:[],debug:L,length:0}}function g(S,T){return(S[T+10]&31)<<8|S[T+11]}function c(S,T,w,L){var I={audio:-1,avc:-1,id3:-1,isAAC:!0},A=(S[T+1]&15)<<8|S[T+2],O=T+3+A-4,D=(S[T+10]&15)<<8|S[T+11];for(T+=12+D;T<O;){var R=(S[T+1]&31)<<8|S[T+2];switch(S[T]){case 207:if(!L){u.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:I.audio===-1&&(I.audio=R);break;case 21:I.id3===-1&&(I.id3=R);break;case 219:if(!L){u.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:I.avc===-1&&(I.avc=R);break;case 3:case 4:w?I.audio===-1&&(I.audio=R,I.isAAC=!1):u.logger.log("MPEG audio found, not supported in this browser");break;case 36:u.logger.warn("Unsupported HEVC stream type found");break}T+=((S[T+3]&15)<<8|S[T+4])+5}return I}function v(S){var T=0,w,L,I,A,O,D=S.data;if(!S||S.size===0)return null;for(;D[0].length<19&&D.length>1;){var R=new Uint8Array(D[0].length+D[1].length);R.set(D[0]),R.set(D[1],D[0].length),D[0]=R,D.splice(1,1)}w=D[0];var C=(w[0]<<16)+(w[1]<<8)+w[2];if(C===1){if(L=(w[4]<<8)+w[5],L&&L>S.size-6)return null;var P=w[7];P&192&&(A=(w[9]&14)*536870912+(w[10]&255)*4194304+(w[11]&254)*16384+(w[12]&255)*128+(w[13]&254)/2,P&64?(O=(w[14]&14)*536870912+(w[15]&255)*4194304+(w[16]&254)*16384+(w[17]&255)*128+(w[18]&254)/2,A-O>60*9e4&&(u.logger.warn(Math.round((A-O)/9e4)+"s delta between PTS and DTS, align them"),A=O)):O=A),I=w[8];var M=I+9;if(S.size<=M)return null;S.size-=M;for(var N=new Uint8Array(S.size),B=0,U=D.length;B<U;B++){w=D[B];var F=w.byteLength;if(M)if(M>F){M-=F;continue}else w=w.subarray(M),F-=M,M=0;N.set(w,T),T+=F}return L&&(L-=I+3),{data:N,pts:A,dts:O,len:L}}return null}function E(S,T){if(S.units.length&&S.frame){if(S.pts===void 0){var w=T.samples,L=w.length;if(L){var I=w[L-1];S.pts=I.pts,S.dts=I.dts}else{T.dropped++;return}}T.samples.push(S)}S.debug.length&&u.logger.log(S.pts+"/"+S.dts+":"+S.debug)}function d(S,T){var w=S.length;if(w>0){if(T.pts>=S[w-1].pts)S.push(T);else for(var L=w-1;L>=0;L--)if(T.pts<S[L].pts){S.splice(L,0,T);break}}else S.push(T)}function x(S){for(var T=S.byteLength,w=[],L=1;L<T-2;)S[L]===0&&S[L+1]===0&&S[L+2]===3?(w.push(L+2),L+=2):L++;if(w.length===0)return S;var I=T-w.length,A=new Uint8Array(I),O=0;for(L=0;L<I;O++,L++)O===w[0]&&(O++,w.shift()),A[L]=S[O];return A}i.default=b},"./src/errors.ts":function(r,i,t){t.r(i),t.d(i,"ErrorTypes",function(){return n}),t.d(i,"ErrorDetails",function(){return a});var n;(function(o){o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError"})(n||(n={}));var a;(function(o){o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown"})(a||(a={}))},"./src/events.ts":function(r,i,t){t.r(i),t.d(i,"Events",function(){return n});var n;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(n||(n={}))},"./src/hls.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return d});var n=t("./node_modules/url-toolkit/src/url-toolkit.js"),a=t("./src/loader/playlist-loader.ts"),o=t("./src/loader/key-loader.ts"),f=t("./src/controller/id3-track-controller.ts"),h=t("./src/controller/latency-controller.ts"),p=t("./src/controller/level-controller.ts"),l=t("./src/controller/fragment-tracker.ts"),u=t("./src/controller/stream-controller.ts"),m=t("./src/is-supported.ts"),y=t("./src/utils/logger.ts"),b=t("./src/config.ts"),_=t("./node_modules/eventemitter3/index.js"),g=t("./src/events.ts"),c=t("./src/errors.ts");function v(x,S){for(var T=0;T<S.length;T++){var w=S[T];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(x,w.key,w)}}function E(x,S,T){return S&&v(x.prototype,S),T&&v(x,T),x}var d=function(){x.isSupported=function(){return Object(m.isSupported)()};function x(T){T===void 0&&(T={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new _.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var w=this.config=Object(b.mergeConfig)(x.DefaultConfig,T);this.userConfig=T,Object(y.enableLogs)(w.debug),this._autoLevelCapping=-1,w.progressive&&Object(b.enableStreamingMode)(w);var L=w.abrController,I=w.bufferController,A=w.capLevelController,O=w.fpsController,D=this.abrController=new L(this),R=this.bufferController=new I(this),C=this.capLevelController=new A(this),P=new O(this),M=new a.default(this),N=new o.default(this),B=new f.default(this),U=this.levelController=new p.default(this),F=new l.FragmentTracker(this),j=this.streamController=new u.default(this,F);C.setStreamController(j),P.setStreamController(j);var $=[U,j];this.networkControllers=$;var G=[M,N,D,R,C,P,B,F];this.audioTrackController=this.createController(w.audioTrackController,null,$),this.createController(w.audioStreamController,F,$),this.subtitleTrackController=this.createController(w.subtitleTrackController,null,$),this.createController(w.subtitleStreamController,F,$),this.createController(w.timelineController,null,G),this.emeController=this.createController(w.emeController,null,G),this.cmcdController=this.createController(w.cmcdController,null,G),this.latencyController=this.createController(h.default,null,G),this.coreComponents=G}var S=x.prototype;return S.createController=function(w,L,I){if(w){var A=L?new w(this,L):new w(this);return I&&I.push(A),A}return null},S.on=function(w,L,I){I===void 0&&(I=this),this._emitter.on(w,L,I)},S.once=function(w,L,I){I===void 0&&(I=this),this._emitter.once(w,L,I)},S.removeAllListeners=function(w){this._emitter.removeAllListeners(w)},S.off=function(w,L,I,A){I===void 0&&(I=this),this._emitter.off(w,L,I,A)},S.listeners=function(w){return this._emitter.listeners(w)},S.emit=function(w,L,I){return this._emitter.emit(w,L,I)},S.trigger=function(w,L){if(this.config.debug)return this.emit(w,w,L);try{return this.emit(w,w,L)}catch(I){y.logger.error("An internal error happened while handling event "+w+'. Error message: "'+I.message+'". Here is a stacktrace:',I),this.trigger(g.Events.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:w,error:I})}return!1},S.listenerCount=function(w){return this._emitter.listenerCount(w)},S.destroy=function(){y.logger.log("destroy"),this.trigger(g.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(w){return w.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(w){return w.destroy()}),this.coreComponents.length=0},S.attachMedia=function(w){y.logger.log("attachMedia"),this._media=w,this.trigger(g.Events.MEDIA_ATTACHING,{media:w})},S.detachMedia=function(){y.logger.log("detachMedia"),this.trigger(g.Events.MEDIA_DETACHING,void 0),this._media=null},S.loadSource=function(w){this.stopLoad();var L=this.media,I=this.url,A=this.url=n.buildAbsoluteURL(self.location.href,w,{alwaysNormalize:!0});y.logger.log("loadSource:"+A),L&&I&&I!==A&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(L)),this.trigger(g.Events.MANIFEST_LOADING,{url:w})},S.startLoad=function(w){w===void 0&&(w=-1),y.logger.log("startLoad("+w+")"),this.networkControllers.forEach(function(L){L.startLoad(w)})},S.stopLoad=function(){y.logger.log("stopLoad"),this.networkControllers.forEach(function(w){w.stopLoad()})},S.swapAudioCodec=function(){y.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},S.recoverMediaError=function(){y.logger.log("recoverMediaError");var w=this._media;this.detachMedia(),w&&this.attachMedia(w)},S.removeLevel=function(w,L){L===void 0&&(L=0),this.levelController.removeLevel(w,L)},E(x,[{key:"levels",get:function(){var w=this.levelController.levels;return w||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(w){y.logger.log("set currentLevel:"+w),this.loadLevel=w,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(w){y.logger.log("set nextLevel:"+w),this.levelController.manualLevel=w,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(w){y.logger.log("set loadLevel:"+w),this.levelController.manualLevel=w}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(w){this.levelController.nextLoadLevel=w}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(w){y.logger.log("set firstLevel:"+w),this.levelController.firstLevel=w}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(w){y.logger.log("set startLevel:"+w),w!==-1&&(w=Math.max(w,this.minAutoLevel)),this.levelController.startLevel=w}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(w){var L=!!w;L!==this.config.capLevelToPlayerSize&&(L?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=L)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(w){this._autoLevelCapping!==w&&(y.logger.log("set autoLevelCapping:"+w),this._autoLevelCapping=w)}},{key:"bandwidthEstimate",get:function(){var w=this.abrController.bwEstimator;return w?w.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var w=this.levels,L=this.config.minAutoBitrate;if(!w)return 0;for(var I=w.length,A=0;A<I;A++)if(w[A].maxBitrate>L)return A;return 0}},{key:"maxAutoLevel",get:function(){var w=this.levels,L=this.autoLevelCapping,I;return L===-1&&w&&w.length?I=w.length-1:I=L,I}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(w){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,w)}},{key:"audioTracks",get:function(){var w=this.audioTrackController;return w?w.audioTracks:[]}},{key:"audioTrack",get:function(){var w=this.audioTrackController;return w?w.audioTrack:-1},set:function(w){var L=this.audioTrackController;L&&(L.audioTrack=w)}},{key:"subtitleTracks",get:function(){var w=this.subtitleTrackController;return w?w.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var w=this.subtitleTrackController;return w?w.subtitleTrack:-1},set:function(w){var L=this.subtitleTrackController;L&&(L.subtitleTrack=w)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var w=this.subtitleTrackController;return w?w.subtitleDisplay:!1},set:function(w){var L=this.subtitleTrackController;L&&(L.subtitleDisplay=w)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(w){this.config.lowLatencyMode=w}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return g.Events}},{key:"ErrorTypes",get:function(){return c.ErrorTypes}},{key:"ErrorDetails",get:function(){return c.ErrorDetails}},{key:"DefaultConfig",get:function(){return x.defaultConfig?x.defaultConfig:b.hlsDefaultConfig},set:function(w){x.defaultConfig=w}}]),x}();d.defaultConfig=void 0},"./src/is-supported.ts":function(r,i,t){t.r(i),t.d(i,"isSupported",function(){return o}),t.d(i,"changeTypeSupported",function(){return f});var n=t("./src/utils/mediasource-helper.ts");function a(){return self.SourceBuffer||self.WebKitSourceBuffer}function o(){var h=Object(n.getMediaSource)();if(!h)return!1;var p=a(),l=h&&typeof h.isTypeSupported=="function"&&h.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),u=!p||p.prototype&&typeof p.prototype.appendBuffer=="function"&&typeof p.prototype.remove=="function";return!!l&&!!u}function f(){var h,p=a();return typeof(p==null||(h=p.prototype)===null||h===void 0?void 0:h.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return b}),t.d(i,"LoadError",function(){return g});var n=t("./src/polyfills/number.ts"),a=t("./src/errors.ts");function o(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,u(c,v)}function f(c){var v=typeof Map=="function"?new Map:void 0;return f=function(d){if(d===null||!l(d))return d;if(typeof d!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(d))return v.get(d);v.set(d,x)}function x(){return h(d,arguments,m(this).constructor)}return x.prototype=Object.create(d.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),u(x,d)},f(c)}function h(c,v,E){return p()?h=Reflect.construct:h=function(x,S,T){var w=[null];w.push.apply(w,S);var L=Function.bind.apply(x,w),I=new L;return T&&u(I,T.prototype),I},h.apply(null,arguments)}function p(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function l(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function u(c,v){return u=Object.setPrototypeOf||function(d,x){return d.__proto__=x,d},u(c,v)}function m(c){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},m(c)}var y=Math.pow(2,17),b=function(){function c(E){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=E}var v=c.prototype;return v.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},v.abort=function(){this.loader&&this.loader.abort()},v.load=function(d,x){var S=this,T=d.url;if(!T)return Promise.reject(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,networkDetails:null},"Fragment does not have a "+(T?"part list":"url")));this.abort();var w=this.config,L=w.fLoader,I=w.loader;return new Promise(function(A,O){S.loader&&S.loader.destroy();var D=S.loader=d.loader=L?new L(w):new I(w),R=_(d),C={timeout:w.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:w.fragLoadingMaxRetryTimeout,highWaterMark:y};d.stats=D.stats,D.load(R,C,{onSuccess:function(M,N,B,U){S.resetLoader(d,D),A({frag:d,part:null,payload:M.data,networkDetails:U})},onError:function(M,N,B){S.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,response:M,networkDetails:B}))},onAbort:function(M,N,B){S.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:d,networkDetails:B}))},onTimeout:function(M,N,B){S.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:d,networkDetails:B}))},onProgress:function(M,N,B,U){x&&x({frag:d,part:null,payload:B,networkDetails:U})}})})},v.loadPart=function(d,x,S){var T=this;this.abort();var w=this.config,L=w.fLoader,I=w.loader;return new Promise(function(A,O){T.loader&&T.loader.destroy();var D=T.loader=d.loader=L?new L(w):new I(w),R=_(d,x),C={timeout:w.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:w.fragLoadingMaxRetryTimeout,highWaterMark:y};x.stats=D.stats,D.load(R,C,{onSuccess:function(M,N,B,U){T.resetLoader(d,D),T.updateStatsFromPart(d,x);var F={frag:d,part:x,payload:M.data,networkDetails:U};S(F),A(F)},onError:function(M,N,B){T.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,part:x,response:M,networkDetails:B}))},onAbort:function(M,N,B){d.stats.aborted=x.stats.aborted,T.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:d,part:x,networkDetails:B}))},onTimeout:function(M,N,B){T.resetLoader(d,D),O(new g({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:d,part:x,networkDetails:B}))}})})},v.updateStatsFromPart=function(d,x){var S=d.stats,T=x.stats,w=T.total;if(S.loaded+=T.loaded,w){var L=Math.round(d.duration/x.duration),I=Math.min(Math.round(S.loaded/w),L),A=L-I,O=A*Math.round(S.loaded/I);S.total=S.loaded+O}else S.total=Math.max(S.loaded,S.total);var D=S.loading,R=T.loading;D.start?D.first+=R.first-R.start:(D.start=R.start,D.first=R.first),D.end=R.end},v.resetLoader=function(d,x){d.loader=null,this.loader===x&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),x.destroy()},c}();function _(c,v){v===void 0&&(v=null);var E=v||c,d={frag:c,part:v,responseType:"arraybuffer",url:E.url,headers:{},rangeStart:0,rangeEnd:0},x=E.byteRangeStartOffset,S=E.byteRangeEndOffset;return Object(n.isFiniteNumber)(x)&&Object(n.isFiniteNumber)(S)&&(d.rangeStart=x,d.rangeEnd=S),d}var g=function(c){o(v,c);function v(E){for(var d,x=arguments.length,S=new Array(x>1?x-1:0),T=1;T<x;T++)S[T-1]=arguments[T];return d=c.call.apply(c,[this].concat(S))||this,d.data=void 0,d.data=E,d}return v}(f(Error))},"./src/loader/fragment.ts":function(r,i,t){t.r(i),t.d(i,"ElementaryStreamTypes",function(){return y}),t.d(i,"BaseSegment",function(){return b}),t.d(i,"Fragment",function(){return _}),t.d(i,"Part",function(){return g});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/utils/logger.ts"),f=t("./src/loader/level-key.ts"),h=t("./src/loader/load-stats.ts");function p(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,l(c,v)}function l(c,v){return l=Object.setPrototypeOf||function(d,x){return d.__proto__=x,d},l(c,v)}function u(c,v){for(var E=0;E<v.length;E++){var d=v[E];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function m(c,v,E){return v&&u(c.prototype,v),E&&u(c,E),c}var y;(function(c){c.AUDIO="audio",c.VIDEO="video",c.AUDIOVIDEO="audiovideo"})(y||(y={}));var b=function(){function c(E){var d;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(d={},d[y.AUDIO]=null,d[y.VIDEO]=null,d[y.AUDIOVIDEO]=null,d),this.baseurl=E}var v=c.prototype;return v.setByteRange=function(d,x){var S=d.split("@",2),T=[];S.length===1?T[0]=x?x.byteRangeEndOffset:0:T[0]=parseInt(S[1]),T[1]=parseInt(S[0])+T[0],this._byteRange=T},m(c,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(d){this._url=d}}]),c}(),_=function(c){p(v,c);function v(d,x){var S;return S=c.call(this,x)||this,S._decryptdata=null,S.rawProgramDateTime=null,S.programDateTime=null,S.tagList=[],S.duration=0,S.sn=0,S.levelkey=void 0,S.type=void 0,S.loader=null,S.level=-1,S.cc=0,S.startPTS=void 0,S.endPTS=void 0,S.appendedPTS=void 0,S.startDTS=void 0,S.endDTS=void 0,S.start=0,S.deltaPTS=void 0,S.maxStartPTS=void 0,S.minEndPTS=void 0,S.stats=new h.LoadStats,S.urlId=0,S.data=void 0,S.bitrateTest=!1,S.title=null,S.initSegment=null,S.type=d,S}var E=v.prototype;return E.createInitializationVector=function(x){for(var S=new Uint8Array(16),T=12;T<16;T++)S[T]=x>>8*(15-T)&255;return S},E.setDecryptDataFromLevelKey=function(x,S){var T=x;return(x==null?void 0:x.method)==="AES-128"&&x.uri&&!x.iv&&(T=f.LevelKey.fromURI(x.uri),T.method=x.method,T.iv=this.createInitializationVector(S),T.keyFormat="identity"),T},E.setElementaryStreamInfo=function(x,S,T,w,L,I){I===void 0&&(I=!1);var A=this.elementaryStreams,O=A[x];if(!O){A[x]={startPTS:S,endPTS:T,startDTS:w,endDTS:L,partial:I};return}O.startPTS=Math.min(O.startPTS,S),O.endPTS=Math.max(O.endPTS,T),O.startDTS=Math.min(O.startDTS,w),O.endDTS=Math.max(O.endDTS,L)},E.clearElementaryStreamInfo=function(){var x=this.elementaryStreams;x[y.AUDIO]=null,x[y.VIDEO]=null,x[y.AUDIOVIDEO]=null},m(v,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var x=this.sn;typeof x!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),x=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,x)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(n.isFiniteNumber)(this.programDateTime))return null;var x=Object(n.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+x*1e3}},{key:"encrypted",get:function(){var x;return!!((x=this.decryptdata)!==null&&x!==void 0&&x.keyFormat&&this.decryptdata.uri)}}]),v}(b),g=function(c){p(v,c);function v(E,d,x,S,T){var w;w=c.call(this,x)||this,w.fragOffset=0,w.duration=0,w.gap=!1,w.independent=!1,w.relurl=void 0,w.fragment=void 0,w.index=void 0,w.stats=new h.LoadStats,w.duration=E.decimalFloatingPoint("DURATION"),w.gap=E.bool("GAP"),w.independent=E.bool("INDEPENDENT"),w.relurl=E.enumeratedString("URI"),w.fragment=d,w.index=S;var L=E.enumeratedString("BYTERANGE");return L&&w.setByteRange(L,T),T&&(w.fragOffset=T.fragOffset+T.duration),w}return m(v,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var d=this.elementaryStreams;return!!(d.audio||d.video||d.audiovideo)}}]),v}(b)},"./src/loader/key-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return f});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),f=function(){function h(l){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=l,this._registerListeners()}var p=h.prototype;return p._registerListeners=function(){this.hls.on(n.Events.KEY_LOADING,this.onKeyLoading,this)},p._unregisterListeners=function(){this.hls.off(n.Events.KEY_LOADING,this.onKeyLoading)},p.destroy=function(){this._unregisterListeners();for(var u in this.loaders){var m=this.loaders[u];m&&m.destroy()}this.loaders={}},p.onKeyLoading=function(u,m){var y=m.frag,b=y.type,_=this.loaders[b];if(!y.decryptdata){o.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var g=y.decryptdata.uri;if(g!==this.decrypturl||this.decryptkey===null){var c=this.hls.config;if(_&&(o.logger.warn("abort previous key loader for type:"+b),_.abort()),!g){o.logger.warn("key uri is falsy");return}var v=c.loader,E=y.loader=this.loaders[b]=new v(c);this.decrypturl=g,this.decryptkey=null;var d={url:g,frag:y,responseType:"arraybuffer"},x={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:0},S={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};E.load(d,x,S)}else this.decryptkey&&(y.decryptdata.key=this.decryptkey,this.hls.trigger(n.Events.KEY_LOADED,{frag:y}))},p.loadsuccess=function(u,m,y){var b=y.frag;if(!b.decryptdata){o.logger.error("after key load, decryptdata unset");return}this.decryptkey=b.decryptdata.key=new Uint8Array(u.data),b.loader=null,delete this.loaders[b.type],this.hls.trigger(n.Events.KEY_LOADED,{frag:b})},p.loaderror=function(u,m){var y=m.frag,b=y.loader;b&&b.abort(),delete this.loaders[y.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:y,response:u})},p.loadtimeout=function(u,m){var y=m.frag,b=y.loader;b&&b.abort(),delete this.loaders[y.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:y})},h}()},"./src/loader/level-details.ts":function(r,i,t){t.r(i),t.d(i,"LevelDetails",function(){return h});var n=t("./src/polyfills/number.ts");function a(p,l){for(var u=0;u<l.length;u++){var m=l[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(p,m.key,m)}}function o(p,l,u){return l&&a(p.prototype,l),u&&a(p,u),p}var f=10,h=function(){function p(u){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=u}var l=p.prototype;return l.reloaded=function(m){if(!m){this.advanced=!0,this.updated=!0;return}var y=this.lastPartSn-m.lastPartSn,b=this.lastPartIndex-m.lastPartIndex;this.updated=this.endSN!==m.endSN||!!b||!!y,this.advanced=this.endSN>m.endSN||y>0||y===0&&b>0,this.updated||this.advanced?this.misses=Math.floor(m.misses*.6):this.misses=m.misses+1,this.availabilityDelay=m.availabilityDelay},o(p,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(n.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||f}},{key:"drift",get:function(){var m=this.driftEndTime-this.driftStartTime;if(m>0){var y=this.driftEnd-this.driftStart;return y*1e3/m}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var m;return(m=this.partList)!==null&&m!==void 0&&m.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var m;return(m=this.fragments)!==null&&m!==void 0&&m.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var m;return(m=this.partList)!==null&&m!==void 0&&m.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var m;return(m=this.partList)!==null&&m!==void 0&&m.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),p}()},"./src/loader/level-key.ts":function(r,i,t){t.r(i),t.d(i,"LevelKey",function(){return f});var n=t("./node_modules/url-toolkit/src/url-toolkit.js");function a(h,p){for(var l=0;l<p.length;l++){var u=p[l];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(h,u.key,u)}}function o(h,p,l){return p&&a(h.prototype,p),l&&a(h,l),h}var f=function(){h.fromURL=function(l,u){return new h(l,u)},h.fromURI=function(l){return new h(l)};function h(p,l){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,l?this._uri=Object(n.buildAbsoluteURL)(p,l,{alwaysNormalize:!0}):this._uri=p}return o(h,[{key:"uri",get:function(){return this._uri}}]),h}()},"./src/loader/load-stats.ts":function(r,i,t){t.r(i),t.d(i,"LoadStats",function(){return n});var n=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return v});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/loader/fragment.ts"),f=t("./src/loader/level-details.ts"),h=t("./src/loader/level-key.ts"),p=t("./src/utils/attr-list.ts"),l=t("./src/utils/logger.ts"),u=t("./src/utils/codecs.ts"),m=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,y=/#EXT-X-MEDIA:(.*)/g,b=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),_=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),g=/\.(mp4|m4s|m4v|m4a)$/i;function c(T){var w,L;return g.test((w=(L=a.parseURL(T))===null||L===void 0?void 0:L.path)!=null?w:"")}var v=function(){function T(){}return T.findGroup=function(L,I){for(var A=0;A<L.length;A++){var O=L[A];if(O.id===I)return O}},T.convertAVC1ToAVCOTI=function(L){var I=L.split(".");if(I.length>2){var A=I.shift()+".";return A+=parseInt(I.shift()).toString(16),A+=("000"+parseInt(I.shift()).toString(16)).substr(-4),A}return L},T.resolve=function(L,I){return a.buildAbsoluteURL(I,L,{alwaysNormalize:!0})},T.parseMasterPlaylist=function(L,I){var A=[],O={},D=!1;m.lastIndex=0;for(var R;(R=m.exec(L))!=null;)if(R[1]){var C=new p.AttrList(R[1]),P={attrs:C,bitrate:C.decimalInteger("AVERAGE-BANDWIDTH")||C.decimalInteger("BANDWIDTH"),name:C.NAME,url:T.resolve(R[2],I)},M=C.decimalResolution("RESOLUTION");M&&(P.width=M.width,P.height=M.height),E((C.CODECS||"").split(/[ ,]+/).filter(function(B){return B}),P),P.videoCodec&&P.videoCodec.indexOf("avc1")!==-1&&(P.videoCodec=T.convertAVC1ToAVCOTI(P.videoCodec)),A.push(P)}else if(R[3]){var N=new p.AttrList(R[3]);N["DATA-ID"]&&(D=!0,O[N["DATA-ID"]]=N)}return{levels:A,sessionData:D?O:null}},T.parseMasterPlaylistMedia=function(L,I,A,O){O===void 0&&(O=[]);var D,R=[],C=0;for(y.lastIndex=0;(D=y.exec(L))!==null;){var P=new p.AttrList(D[1]);if(P.TYPE===A){var M={attrs:P,bitrate:0,id:C++,groupId:P["GROUP-ID"],instreamId:P["INSTREAM-ID"],name:P.NAME||P.LANGUAGE||"",type:A,default:P.bool("DEFAULT"),autoselect:P.bool("AUTOSELECT"),forced:P.bool("FORCED"),lang:P.LANGUAGE,url:P.URI?T.resolve(P.URI,I):""};if(O.length){var N=T.findGroup(O,M.groupId)||O[0];d(M,N,"audioCodec"),d(M,N,"textCodec")}R.push(M)}}return R},T.parseLevelPlaylist=function(L,I,A,O,D){var R=new f.LevelDetails(I),C=R.fragments,P=null,M=0,N=0,B=0,U=0,F=null,j=new o.Fragment(O,I),$,G,Y,X=-1,ie=!1;for(b.lastIndex=0,R.m3u8=L;($=b.exec(L))!==null;){ie&&(ie=!1,j=new o.Fragment(O,I),j.start=B,j.sn=M,j.cc=U,j.level=A,P&&(j.initSegment=P,j.rawProgramDateTime=P.rawProgramDateTime));var pe=$[1];if(pe){j.duration=parseFloat(pe);var ue=(" "+$[2]).slice(1);j.title=ue||null,j.tagList.push(ue?["INF",pe,ue]:["INF",pe])}else if($[3])Object(n.isFiniteNumber)(j.duration)&&(j.start=B,Y&&(j.levelkey=Y),j.sn=M,j.level=A,j.cc=U,j.urlId=D,C.push(j),j.relurl=(" "+$[3]).slice(1),S(j,F),F=j,B+=j.duration,M++,N=0,ie=!0);else if($[4]){var we=(" "+$[4]).slice(1);F?j.setByteRange(we,F):j.setByteRange(we)}else if($[5])j.rawProgramDateTime=(" "+$[5]).slice(1),j.tagList.push(["PROGRAM-DATE-TIME",j.rawProgramDateTime]),X===-1&&(X=C.length);else{if($=$[0].match(_),!$){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<$.length&&typeof $[G]=="undefined";G++);var de=(" "+$[G]).slice(1),oe=(" "+$[G+1]).slice(1),De=$[G+2]?(" "+$[G+2]).slice(1):"";switch(de){case"PLAYLIST-TYPE":R.type=oe.toUpperCase();break;case"MEDIA-SEQUENCE":M=R.startSN=parseInt(oe);break;case"SKIP":{var Ce=new p.AttrList(oe),Ue=Ce.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(Ue)){R.skippedSegments=Ue;for(var Me=Ue;Me--;)C.unshift(null);M+=Ue}var ze=Ce.enumeratedString("RECENTLY-REMOVED-DATERANGES");ze&&(R.recentlyRemovedDateranges=ze.split("	"));break}case"TARGETDURATION":R.targetduration=parseFloat(oe);break;case"VERSION":R.version=parseInt(oe);break;case"EXTM3U":break;case"ENDLIST":R.live=!1;break;case"#":(oe||De)&&j.tagList.push(De?[oe,De]:[oe]);break;case"DIS":U++;case"GAP":j.tagList.push([de]);break;case"BITRATE":j.tagList.push([de,oe]);break;case"DISCONTINUITY-SEQ":U=parseInt(oe);break;case"KEY":{var Ge,Ke=new p.AttrList(oe),He=Ke.enumeratedString("METHOD"),Fe=Ke.URI,Se=Ke.hexadecimalInteger("IV"),Xe=Ke.enumeratedString("KEYFORMATVERSIONS"),st=Ke.enumeratedString("KEYID"),et=(Ge=Ke.enumeratedString("KEYFORMAT"))!=null?Ge:"identity",ot=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(ot.indexOf(et)>-1){l.logger.warn("Keyformat "+et+" is not supported from the manifest");continue}else if(et!=="identity")continue;He&&(Y=h.LevelKey.fromURL(I,Fe),Fe&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(He)>=0&&(Y.method=He,Y.keyFormat=et,st&&(Y.keyID=st),Xe&&(Y.keyFormatVersions=Xe),Y.iv=Se));break}case"START":{var nt=new p.AttrList(oe),dt=nt.decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(dt)&&(R.startTimeOffset=dt);break}case"MAP":{var ne=new p.AttrList(oe);j.relurl=ne.URI,ne.BYTERANGE&&j.setByteRange(ne.BYTERANGE),j.level=A,j.sn="initSegment",Y&&(j.levelkey=Y),j.initSegment=null,P=j,ie=!0;break}case"SERVER-CONTROL":{var Ee=new p.AttrList(oe);R.canBlockReload=Ee.bool("CAN-BLOCK-RELOAD"),R.canSkipUntil=Ee.optionalFloat("CAN-SKIP-UNTIL",0),R.canSkipDateRanges=R.canSkipUntil>0&&Ee.bool("CAN-SKIP-DATERANGES"),R.partHoldBack=Ee.optionalFloat("PART-HOLD-BACK",0),R.holdBack=Ee.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var xe=new p.AttrList(oe);R.partTarget=xe.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Ae=R.partList;Ae||(Ae=R.partList=[]);var be=N>0?Ae[Ae.length-1]:void 0,je=N++,V=new o.Part(new p.AttrList(oe),j,I,je,be);Ae.push(V),j.duration+=V.duration;break}case"PRELOAD-HINT":{var he=new p.AttrList(oe);R.preloadHint=he;break}case"RENDITION-REPORT":{var _e=new p.AttrList(oe);R.renditionReports=R.renditionReports||[],R.renditionReports.push(_e);break}default:l.logger.warn("line parsed but not handled: "+$);break}}}F&&!F.relurl?(C.pop(),B-=F.duration,R.partList&&(R.fragmentHint=F)):R.partList&&(S(j,F),j.cc=U,R.fragmentHint=j);var Ie=C.length,Z=C[0],fe=C[Ie-1];if(B+=R.skippedSegments*R.targetduration,B>0&&Ie&&fe){R.averagetargetduration=B/Ie;var W=fe.sn;R.endSN=W!=="initSegment"?W:0,Z&&(R.startCC=Z.cc,Z.initSegment||R.fragments.every(function(ge){return ge.relurl&&c(ge.relurl)})&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),j=new o.Fragment(O,I),j.relurl=fe.relurl,j.level=A,j.sn="initSegment",Z.initSegment=j,R.needSidxRanges=!0))}else R.endSN=0,R.startCC=0;return R.fragmentHint&&(B+=R.fragmentHint.duration),R.totalduration=B,R.endCC=U,X>0&&x(C,X),R},T}();function E(T,w){["video","audio","text"].forEach(function(L){var I=T.filter(function(O){return Object(u.isCodecType)(O,L)});if(I.length){var A=I.filter(function(O){return O.lastIndexOf("avc1",0)===0||O.lastIndexOf("mp4a",0)===0});w[L+"Codec"]=A.length>0?A[0]:I[0],T=T.filter(function(O){return I.indexOf(O)===-1})}}),w.unknownCodecs=T}function d(T,w,L){var I=w[L];I&&(T[L]=I)}function x(T,w){for(var L=T[w],I=w;I--;){var A=T[I];if(!A)return;A.programDateTime=L.programDateTime-A.duration*1e3,L=A}}function S(T,w){T.rawProgramDateTime?T.programDateTime=Date.parse(T.rawProgramDateTime):w!=null&&w.programDateTime&&(T.programDateTime=w.endProgramDateTime),Object(n.isFiniteNumber)(T.programDateTime)||(T.programDateTime=null,T.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),f=t("./src/utils/logger.ts"),h=t("./src/utils/mp4-tools.ts"),p=t("./src/loader/m3u8-parser.ts"),l=t("./src/types/loader.ts"),u=t("./src/utils/attr-list.ts");function m(_){var g=_.type;switch(g){case l.PlaylistContextType.AUDIO_TRACK:return l.PlaylistLevelType.AUDIO;case l.PlaylistContextType.SUBTITLE_TRACK:return l.PlaylistLevelType.SUBTITLE;default:return l.PlaylistLevelType.MAIN}}function y(_,g){var c=_.url;return(c===void 0||c.indexOf("data:")===0)&&(c=g.url),c}var b=function(){function _(c){this.hls=void 0,this.loaders=Object.create(null),this.hls=c,this.registerListeners()}var g=_.prototype;return g.registerListeners=function(){var v=this.hls;v.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),v.on(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},g.unregisterListeners=function(){var v=this.hls;v.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(a.Events.LEVEL_LOADING,this.onLevelLoading,this),v.off(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),v.off(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},g.createInternalLoader=function(v){var E=this.hls.config,d=E.pLoader,x=E.loader,S=d||x,T=new S(E);return v.loader=T,this.loaders[v.type]=T,T},g.getInternalLoader=function(v){return this.loaders[v.type]},g.resetInternalLoader=function(v){this.loaders[v]&&delete this.loaders[v]},g.destroyInternalLoaders=function(){for(var v in this.loaders){var E=this.loaders[v];E&&E.destroy(),this.resetInternalLoader(v)}},g.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},g.onManifestLoading=function(v,E){var d=E.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:l.PlaylistContextType.MANIFEST,url:d,deliveryDirectives:null})},g.onLevelLoading=function(v,E){var d=E.id,x=E.level,S=E.url,T=E.deliveryDirectives;this.load({id:d,groupId:null,level:x,responseType:"text",type:l.PlaylistContextType.LEVEL,url:S,deliveryDirectives:T})},g.onAudioTrackLoading=function(v,E){var d=E.id,x=E.groupId,S=E.url,T=E.deliveryDirectives;this.load({id:d,groupId:x,level:null,responseType:"text",type:l.PlaylistContextType.AUDIO_TRACK,url:S,deliveryDirectives:T})},g.onSubtitleTrackLoading=function(v,E){var d=E.id,x=E.groupId,S=E.url,T=E.deliveryDirectives;this.load({id:d,groupId:x,level:null,responseType:"text",type:l.PlaylistContextType.SUBTITLE_TRACK,url:S,deliveryDirectives:T})},g.load=function(v){var E,d=this.hls.config,x=this.getInternalLoader(v);if(x){var S=x.context;if(S&&S.url===v.url){f.logger.trace("[playlist-loader]: playlist request ongoing");return}f.logger.log("[playlist-loader]: aborting previous loader for type: "+v.type),x.abort()}var T,w,L,I;switch(v.type){case l.PlaylistContextType.MANIFEST:T=d.manifestLoadingMaxRetry,w=d.manifestLoadingTimeOut,L=d.manifestLoadingRetryDelay,I=d.manifestLoadingMaxRetryTimeout;break;case l.PlaylistContextType.LEVEL:case l.PlaylistContextType.AUDIO_TRACK:case l.PlaylistContextType.SUBTITLE_TRACK:T=0,w=d.levelLoadingTimeOut;break;default:T=d.levelLoadingMaxRetry,w=d.levelLoadingTimeOut,L=d.levelLoadingRetryDelay,I=d.levelLoadingMaxRetryTimeout;break}if(x=this.createInternalLoader(v),(E=v.deliveryDirectives)!==null&&E!==void 0&&E.part){var A;if(v.type===l.PlaylistContextType.LEVEL&&v.level!==null?A=this.hls.levels[v.level].details:v.type===l.PlaylistContextType.AUDIO_TRACK&&v.id!==null?A=this.hls.audioTracks[v.id].details:v.type===l.PlaylistContextType.SUBTITLE_TRACK&&v.id!==null&&(A=this.hls.subtitleTracks[v.id].details),A){var O=A.partTarget,D=A.targetduration;O&&D&&(w=Math.min(Math.max(O*3,D*.8)*1e3,w))}}var R={timeout:w,maxRetry:T,retryDelay:L,maxRetryDelay:I,highWaterMark:0},C={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};x.load(v,R,C)},g.loadsuccess=function(v,E,d,x){if(x===void 0&&(x=null),d.isSidxRequest){this.handleSidxRequest(v,d),this.handlePlaylistLoaded(v,E,d,x);return}this.resetInternalLoader(d.type);var S=v.data;if(S.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(v,d,"no EXTM3U delimiter",x);return}E.parsing.start=performance.now(),S.indexOf("#EXTINF:")>0||S.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(v,E,d,x):this.handleMasterPlaylist(v,E,d,x)},g.loaderror=function(v,E,d){d===void 0&&(d=null),this.handleNetworkError(E,d,!1,v)},g.loadtimeout=function(v,E,d){d===void 0&&(d=null),this.handleNetworkError(E,d,!0)},g.handleMasterPlaylist=function(v,E,d,x){var S=this.hls,T=v.data,w=y(v,d),L=p.default.parseMasterPlaylist(T,w),I=L.levels,A=L.sessionData;if(!I.length){this.handleManifestParsingError(v,d,"no level found in manifest",x);return}var O=I.map(function(N){return{id:N.attrs.AUDIO,audioCodec:N.audioCodec}}),D=I.map(function(N){return{id:N.attrs.SUBTITLES,textCodec:N.textCodec}}),R=p.default.parseMasterPlaylistMedia(T,w,"AUDIO",O),C=p.default.parseMasterPlaylistMedia(T,w,"SUBTITLES",D),P=p.default.parseMasterPlaylistMedia(T,w,"CLOSED-CAPTIONS");if(R.length){var M=R.some(function(N){return!N.url});!M&&I[0].audioCodec&&!I[0].attrs.AUDIO&&(f.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),R.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new u.AttrList({}),bitrate:0,url:""}))}S.trigger(a.Events.MANIFEST_LOADED,{levels:I,audioTracks:R,subtitles:C,captions:P,url:w,stats:E,networkDetails:x,sessionData:A})},g.handleTrackOrLevelPlaylist=function(v,E,d,x){var S=this.hls,T=d.id,w=d.level,L=d.type,I=y(v,d),A=Object(n.isFiniteNumber)(T)?T:0,O=Object(n.isFiniteNumber)(w)?w:A,D=m(d),R=p.default.parseLevelPlaylist(v.data,I,O,D,A);if(!R.fragments.length){S.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:I,reason:"no fragments found in level",level:typeof d.level=="number"?d.level:void 0});return}if(L===l.PlaylistContextType.MANIFEST){var C={attrs:new u.AttrList({}),bitrate:0,details:R,name:"",url:I};S.trigger(a.Events.MANIFEST_LOADED,{levels:[C],audioTracks:[],url:I,stats:E,networkDetails:x,sessionData:null})}if(E.parsing.end=performance.now(),R.needSidxRanges){var P,M=(P=R.fragments[0].initSegment)===null||P===void 0?void 0:P.url;this.load({url:M,isSidxRequest:!0,type:L,level:w,levelDetails:R,id:T,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}d.levelDetails=R,this.handlePlaylistLoaded(v,E,d,x)},g.handleSidxRequest=function(v,E){var d=Object(h.parseSegmentIndex)(new Uint8Array(v.data));if(!!d){var x=d.references,S=E.levelDetails;x.forEach(function(T,w){var L=T.info,I=S.fragments[w];I.byteRange.length===0&&I.setByteRange(String(1+L.end-L.start)+"@"+String(L.start)),I.initSegment&&I.initSegment.setByteRange(String(d.moovEndOffset)+"@0")})}},g.handleManifestParsingError=function(v,E,d,x){this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:E.type===l.PlaylistContextType.MANIFEST,url:v.url,reason:d,response:v,context:E,networkDetails:x})},g.handleNetworkError=function(v,E,d,x){d===void 0&&(d=!1),f.logger.warn("[playlist-loader]: A network "+(d?"timeout":"error")+" occurred while loading "+v.type+" level: "+v.level+" id: "+v.id+' group-id: "'+v.groupId+'"');var S=o.ErrorDetails.UNKNOWN,T=!1,w=this.getInternalLoader(v);switch(v.type){case l.PlaylistContextType.MANIFEST:S=d?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,T=!0;break;case l.PlaylistContextType.LEVEL:S=d?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,T=!1;break;case l.PlaylistContextType.AUDIO_TRACK:S=d?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,T=!1;break;case l.PlaylistContextType.SUBTITLE_TRACK:S=d?o.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:o.ErrorDetails.SUBTITLE_LOAD_ERROR,T=!1;break}w&&this.resetInternalLoader(v.type);var L={type:o.ErrorTypes.NETWORK_ERROR,details:S,fatal:T,url:v.url,loader:w,context:v,networkDetails:E};x&&(L.response=x),this.hls.trigger(a.Events.ERROR,L)},g.handlePlaylistLoaded=function(v,E,d,x){var S=d.type,T=d.level,w=d.id,L=d.groupId,I=d.loader,A=d.levelDetails,O=d.deliveryDirectives;if(!(A!=null&&A.targetduration)){this.handleManifestParsingError(v,d,"invalid target duration",x);return}if(!!I)switch(A.live&&(I.getCacheAge&&(A.ageHeader=I.getCacheAge()||0),(!I.getCacheAge||isNaN(A.ageHeader))&&(A.ageHeader=0)),S){case l.PlaylistContextType.MANIFEST:case l.PlaylistContextType.LEVEL:this.hls.trigger(a.Events.LEVEL_LOADED,{details:A,level:T||0,id:w||0,stats:E,networkDetails:x,deliveryDirectives:O});break;case l.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(a.Events.AUDIO_TRACK_LOADED,{details:A,id:w||0,groupId:L||"",stats:E,networkDetails:x,deliveryDirectives:O});break;case l.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(a.Events.SUBTITLE_TRACK_LOADED,{details:A,id:w||0,groupId:L||"",stats:E,networkDetails:x,deliveryDirectives:O});break}},_}();i.default=b},"./src/polyfills/number.ts":function(r,i,t){t.r(i),t.d(i,"isFiniteNumber",function(){return n}),t.d(i,"MAX_SAFE_INTEGER",function(){return a});var n=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(r,i,t){t.r(i);var n=function(){function a(){}return a.getSilentFrame=function(f,h){switch(f){case"mp4a.40.2":if(h===1)return new Uint8Array([0,200,0,128,35,128]);if(h===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(h===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(h===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(h===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(h===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(h===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},a}();i.default=n},"./src/remux/mp4-generator.ts":function(r,i,t){t.r(i);var n=Math.pow(2,32)-1,a=function(){function o(){}return o.init=function(){o.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var h;for(h in o.types)o.types.hasOwnProperty(h)&&(o.types[h]=[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]);var p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),l=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);o.HDLR_TYPES={video:p,audio:l};var u=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),m=new Uint8Array([0,0,0,0,0,0,0,0]);o.STTS=o.STSC=o.STCO=m,o.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),o.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),o.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),o.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var y=new Uint8Array([105,115,111,109]),b=new Uint8Array([97,118,99,49]),_=new Uint8Array([0,0,0,1]);o.FTYP=o.box(o.types.ftyp,y,_,y,b),o.DINF=o.box(o.types.dinf,o.box(o.types.dref,u))},o.box=function(h){for(var p=8,l=arguments.length,u=new Array(l>1?l-1:0),m=1;m<l;m++)u[m-1]=arguments[m];for(var y=u.length,b=y;y--;)p+=u[y].byteLength;var _=new Uint8Array(p);for(_[0]=p>>24&255,_[1]=p>>16&255,_[2]=p>>8&255,_[3]=p&255,_.set(h,4),y=0,p=8;y<b;y++)_.set(u[y],p),p+=u[y].byteLength;return _},o.hdlr=function(h){return o.box(o.types.hdlr,o.HDLR_TYPES[h])},o.mdat=function(h){return o.box(o.types.mdat,h)},o.mdhd=function(h,p){p*=h;var l=Math.floor(p/(n+1)),u=Math.floor(p%(n+1));return o.box(o.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,h&255,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,85,196,0,0]))},o.mdia=function(h){return o.box(o.types.mdia,o.mdhd(h.timescale,h.duration),o.hdlr(h.type),o.minf(h))},o.mfhd=function(h){return o.box(o.types.mfhd,new Uint8Array([0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255]))},o.minf=function(h){return h.type==="audio"?o.box(o.types.minf,o.box(o.types.smhd,o.SMHD),o.DINF,o.stbl(h)):o.box(o.types.minf,o.box(o.types.vmhd,o.VMHD),o.DINF,o.stbl(h))},o.moof=function(h,p,l){return o.box(o.types.moof,o.mfhd(h),o.traf(l,p))},o.moov=function(h){for(var p=h.length,l=[];p--;)l[p]=o.trak(h[p]);return o.box.apply(null,[o.types.moov,o.mvhd(h[0].timescale,h[0].duration)].concat(l).concat(o.mvex(h)))},o.mvex=function(h){for(var p=h.length,l=[];p--;)l[p]=o.trex(h[p]);return o.box.apply(null,[o.types.mvex].concat(l))},o.mvhd=function(h,p){p*=h;var l=Math.floor(p/(n+1)),u=Math.floor(p%(n+1)),m=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,h&255,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o.box(o.types.mvhd,m)},o.sdtp=function(h){var p=h.samples||[],l=new Uint8Array(4+p.length),u,m;for(u=0;u<p.length;u++)m=p[u].flags,l[u+4]=m.dependsOn<<4|m.isDependedOn<<2|m.hasRedundancy;return o.box(o.types.sdtp,l)},o.stbl=function(h){return o.box(o.types.stbl,o.stsd(h),o.box(o.types.stts,o.STTS),o.box(o.types.stsc,o.STSC),o.box(o.types.stsz,o.STSZ),o.box(o.types.stco,o.STCO))},o.avc1=function(h){var p=[],l=[],u,m,y;for(u=0;u<h.sps.length;u++)m=h.sps[u],y=m.byteLength,p.push(y>>>8&255),p.push(y&255),p=p.concat(Array.prototype.slice.call(m));for(u=0;u<h.pps.length;u++)m=h.pps[u],y=m.byteLength,l.push(y>>>8&255),l.push(y&255),l=l.concat(Array.prototype.slice.call(m));var b=o.box(o.types.avcC,new Uint8Array([1,p[3],p[4],p[5],252|3,224|h.sps.length].concat(p).concat([h.pps.length]).concat(l))),_=h.width,g=h.height,c=h.pixelRatio[0],v=h.pixelRatio[1];return o.box(o.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>8&255,_&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),b,o.box(o.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),o.box(o.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,v>>24,v>>16&255,v>>8&255,v&255])))},o.esds=function(h){var p=h.config.length;return new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(h.config).concat([6,1,2]))},o.mp4a=function(h){var p=h.samplerate;return o.box(o.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]),o.box(o.types.esds,o.esds(h)))},o.mp3=function(h){var p=h.samplerate;return o.box(o.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]))},o.stsd=function(h){return h.type==="audio"?!h.isAAC&&h.codec==="mp3"?o.box(o.types.stsd,o.STSD,o.mp3(h)):o.box(o.types.stsd,o.STSD,o.mp4a(h)):o.box(o.types.stsd,o.STSD,o.avc1(h))},o.tkhd=function(h){var p=h.id,l=h.duration*h.timescale,u=h.width,m=h.height,y=Math.floor(l/(n+1)),b=Math.floor(l%(n+1));return o.box(o.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,p>>24&255,p>>16&255,p>>8&255,p&255,0,0,0,0,y>>24,y>>16&255,y>>8&255,y&255,b>>24,b>>16&255,b>>8&255,b&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,u>>8&255,u&255,0,0,m>>8&255,m&255,0,0]))},o.traf=function(h,p){var l=o.sdtp(h),u=h.id,m=Math.floor(p/(n+1)),y=Math.floor(p%(n+1));return o.box(o.types.traf,o.box(o.types.tfhd,new Uint8Array([0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255])),o.box(o.types.tfdt,new Uint8Array([1,0,0,0,m>>24,m>>16&255,m>>8&255,m&255,y>>24,y>>16&255,y>>8&255,y&255])),o.trun(h,l.length+16+20+8+16+8+8),l)},o.trak=function(h){return h.duration=h.duration||4294967295,o.box(o.types.trak,o.tkhd(h),o.mdia(h))},o.trex=function(h){var p=h.id;return o.box(o.types.trex,new Uint8Array([0,0,0,0,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},o.trun=function(h,p){var l=h.samples||[],u=l.length,m=12+16*u,y=new Uint8Array(m),b,_,g,c,v,E;for(p+=8+m,y.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,u&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255],0),b=0;b<u;b++)_=l[b],g=_.duration,c=_.size,v=_.flags,E=_.cts,y.set([g>>>24&255,g>>>16&255,g>>>8&255,g&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,v.isLeading<<2|v.dependsOn,v.isDependedOn<<6|v.hasRedundancy<<4|v.paddingValue<<1|v.isNonSync,v.degradPrio&240<<8,v.degradPrio&15,E>>>24&255,E>>>16&255,E>>>8&255,E&255],12+16*b);return o.box(o.types.trun,y)},o.initSegment=function(h){o.types||o.init();var p=o.moov(h),l=new Uint8Array(o.FTYP.byteLength+p.byteLength);return l.set(o.FTYP),l.set(p,o.FTYP.byteLength),l},o}();a.types=void 0,a.HDLR_TYPES=void 0,a.STTS=void 0,a.STSC=void 0,a.STCO=void 0,a.STSZ=void 0,a.VMHD=void 0,a.SMHD=void 0,a.STSD=void 0,a.FTYP=void 0,a.DINF=void 0,i.default=a},"./src/remux/mp4-remuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return E}),t.d(i,"normalizePts",function(){return d});var n=t("./src/polyfills/number.ts"),a=t("./src/remux/aac-helper.ts"),o=t("./src/remux/mp4-generator.ts"),f=t("./src/events.ts"),h=t("./src/errors.ts"),p=t("./src/utils/logger.ts"),l=t("./src/types/loader.ts"),u=t("./src/utils/timescale-conversion.ts");function m(){return m=Object.assign||function(w){for(var L=1;L<arguments.length;L++){var I=arguments[L];for(var A in I)Object.prototype.hasOwnProperty.call(I,A)&&(w[A]=I[A])}return w},m.apply(this,arguments)}var y=10*1e3,b=1024,_=1152,g=null,c=null,v=!1,E=function(){function w(I,A,O,D){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=I,this.config=A,this.typeSupported=O,this.ISGenerated=!1,g===null){var R=navigator.userAgent||"",C=R.match(/Chrome\/(\d+)/i);g=C?parseInt(C[1]):0}if(c===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);c=P?parseInt(P[1]):0}v=!!g&&g<75||!!c&&c<600}var L=w.prototype;return L.destroy=function(){},L.resetTimeStamp=function(A){p.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=A},L.resetNextTimestamp=function(){p.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},L.resetInitSegment=function(){p.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},L.getVideoStartPts=function(A){var O=!1,D=A.reduce(function(R,C){var P=C.pts-R;return P<-4294967296?(O=!0,d(R,C.pts)):P>0?R:C.pts},A[0].pts);return O&&p.logger.debug("PTS rollover detected"),D},L.remux=function(A,O,D,R,C,P,M,N){var B,U,F,j,$,G,Y=C,X=C,ie=A.pid>-1,pe=O.pid>-1,ue=O.samples.length,we=A.samples.length>0,de=ue>1,oe=(!ie||we)&&(!pe||de)||this.ISGenerated||M;if(oe){this.ISGenerated||(F=this.generateIS(A,O,C));var De=this.isVideoContiguous,Ce=-1;if(de&&(Ce=x(O.samples),!De&&this.config.forceKeyFrameOnDiscontinuity))if(G=!0,Ce>0){p.logger.warn("[mp4-remuxer]: Dropped "+Ce+" out of "+ue+" video samples due to a missing keyframe");var Ue=this.getVideoStartPts(O.samples);O.samples=O.samples.slice(Ce),O.dropped+=Ce,X+=(O.samples[0].pts-Ue)/(O.timescale||9e4)}else Ce===-1&&(p.logger.warn("[mp4-remuxer]: No keyframe found out of "+ue+" video samples"),G=!1);if(this.ISGenerated){if(we&&de){var Me=this.getVideoStartPts(O.samples),ze=d(A.samples[0].pts,Me)-Me,Ge=ze/O.inputTimeScale;Y+=Math.max(0,Ge),X+=Math.max(0,-Ge)}if(we){if(A.samplerate||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),F=this.generateIS(A,O,C)),U=this.remuxAudio(A,Y,this.isAudioContiguous,P,pe||de||N===l.PlaylistLevelType.AUDIO?X:void 0),de){var Ke=U?U.endPTS-U.startPTS:0;O.inputTimeScale||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),F=this.generateIS(A,O,C)),B=this.remuxVideo(O,X,De,Ke)}}else de&&(B=this.remuxVideo(O,X,De,0));B&&(B.firstKeyFrame=Ce,B.independent=Ce!==-1)}}return this.ISGenerated&&(D.samples.length&&($=this.remuxID3(D,C)),R.samples.length&&(j=this.remuxText(R,C))),{audio:U,video:B,initSegment:F,independent:G,text:j,id3:$}},L.generateIS=function(A,O,D){var R=A.samples,C=O.samples,P=this.typeSupported,M={},N=!Object(n.isFiniteNumber)(this._initPTS),B="audio/mp4",U,F,j;if(N&&(U=F=1/0),A.config&&R.length&&(A.timescale=A.samplerate,A.isAAC||(P.mpeg?(B="audio/mpeg",A.codec=""):P.mp3&&(A.codec="mp3")),M.audio={id:"audio",container:B,codec:A.codec,initSegment:!A.isAAC&&P.mpeg?new Uint8Array(0):o.default.initSegment([A]),metadata:{channelCount:A.channelCount}},N&&(j=A.inputTimeScale,U=F=R[0].pts-Math.round(j*D))),O.sps&&O.pps&&C.length&&(O.timescale=O.inputTimeScale,M.video={id:"main",container:"video/mp4",codec:O.codec,initSegment:o.default.initSegment([O]),metadata:{width:O.width,height:O.height}},N)){j=O.inputTimeScale;var $=this.getVideoStartPts(C),G=Math.round(j*D);F=Math.min(F,d(C[0].dts,$)-G),U=Math.min(U,$-G)}if(Object.keys(M).length)return this.ISGenerated=!0,N&&(this._initPTS=U,this._initDTS=F),{tracks:M,initPTS:U,timescale:j}},L.remuxVideo=function(A,O,D,R){var C=A.inputTimeScale,P=A.samples,M=[],N=P.length,B=this._initPTS,U=this.nextAvcDts,F=8,j,$,G,Y=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,ie=0,pe=!1;if(!D||U===null){var ue=O*C,we=P[0].pts-d(P[0].dts,P[0].pts);U=ue-we}for(var de=0;de<N;de++){var oe=P[de];if(oe.pts=d(oe.pts-B,U),oe.dts=d(oe.dts-B,U),oe.dts>oe.pts){var De=9e4*.2;ie=Math.max(Math.min(ie,oe.pts-oe.dts),-1*De)}oe.dts<P[de>0?de-1:de].dts&&(pe=!0)}pe&&P.sort(function(ke,Ne){var rt=ke.dts-Ne.dts,ar=ke.pts-Ne.pts;return rt||ar}),$=P[0].dts,G=P[P.length-1].dts;var Ce=Math.round((G-$)/(N-1));if(ie<0){if(ie<Ce*-2){p.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(u.toMsFromMpegTsClock)(-Ce,!0)+" ms");for(var Ue=ie,Me=0;Me<N;Me++)P[Me].dts=Ue=Math.max(Ue,P[Me].pts-Ce),P[Me].pts=Math.max(Ue,P[Me].pts)}else{p.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(u.toMsFromMpegTsClock)(ie,!0)+" ms to overcome this issue");for(var ze=0;ze<N;ze++)P[ze].dts=P[ze].dts+ie}$=P[0].dts}if(D){var Ge=$-U,Ke=Ge>Ce,He=Ge<-1;if(Ke||He){Ke?p.logger.warn("AVC: "+Object(u.toMsFromMpegTsClock)(Ge,!0)+" ms ("+Ge+"dts) hole between fragments detected, filling it"):p.logger.warn("AVC: "+Object(u.toMsFromMpegTsClock)(-Ge,!0)+" ms ("+Ge+"dts) overlapping between fragments detected"),$=U;var Fe=P[0].pts-Ge;P[0].dts=$,P[0].pts=Fe,p.logger.log("Video: First PTS/DTS adjusted: "+Object(u.toMsFromMpegTsClock)(Fe,!0)+"/"+Object(u.toMsFromMpegTsClock)($,!0)+", delta: "+Object(u.toMsFromMpegTsClock)(Ge,!0)+" ms")}}v&&($=Math.max(0,$));for(var Se=0,Xe=0,st=0;st<N;st++){for(var et=P[st],ot=et.units,nt=ot.length,dt=0,ne=0;ne<nt;ne++)dt+=ot[ne].data.length;Xe+=dt,Se+=nt,et.length=dt,et.dts=Math.max(et.dts,$),et.pts=Math.max(et.pts,et.dts,0),Y=Math.min(et.pts,Y),X=Math.max(et.pts,X)}G=P[N-1].dts;var Ee=Xe+4*Se+8,xe;try{xe=new Uint8Array(Ee)}catch(ke){this.observer.emit(f.Events.ERROR,f.Events.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ee,reason:"fail allocating video mdat "+Ee});return}var Ae=new DataView(xe.buffer);Ae.setUint32(0,Ee),xe.set(o.default.types.mdat,4);for(var be=0;be<N;be++){for(var je=P[be],V=je.units,he=0,_e=0,Ie=V.length;_e<Ie;_e++){var Z=V[_e],fe=Z.data,W=Z.data.byteLength;Ae.setUint32(F,W),F+=4,xe.set(fe,F),F+=W,he+=4+W}if(be<N-1)j=P[be+1].dts-je.dts;else{var ge=this.config,Ve=je.dts-P[be>0?be-1:be].dts;if(ge.stretchShortVideoTrack&&this.nextAudioPts!==null){var k=Math.floor(ge.maxBufferHole*C),le=(R?Y+R*C:this.nextAudioPts)-je.pts;le>k?(j=le-Ve,j<0&&(j=Ve),p.logger.log("[mp4-remuxer]: It is approximately "+le/90+" ms to the next segment; using duration "+j/90+" ms for the last video frame.")):j=Ve}else j=Ve}var ce=Math.round(je.pts-je.dts);M.push(new S(je.key,j,he,ce))}if(M.length&&g&&g<70){var z=M[0].flags;z.dependsOn=2,z.isNonSync=0}console.assert(j!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=U=G+j,this.isVideoContiguous=!0;var J=o.default.moof(A.sequenceNumber++,$,m({},A,{samples:M})),ae="video",We={data1:J,data2:xe,startPTS:Y/C,endPTS:(X+j)/C,startDTS:$/C,endDTS:U/C,type:ae,hasAudio:!1,hasVideo:!0,nb:M.length,dropped:A.dropped};return A.samples=[],A.dropped=0,console.assert(xe.length,"MDAT length must not be zero"),We},L.remuxAudio=function(A,O,D,R,C){var P=A.inputTimeScale,M=A.samplerate?A.samplerate:P,N=P/M,B=A.isAAC?b:_,U=B*N,F=this._initPTS,j=!A.isAAC&&this.typeSupported.mpeg,$=[],G=A.samples,Y=j?0:8,X=this.nextAudioPts||-1,ie=O*P;if(this.isAudioContiguous=D=D||G.length&&X>0&&(R&&Math.abs(ie-X)<9e3||Math.abs(d(G[0].pts-F,ie)-X)<20*U),G.forEach(function(fe){fe.pts=d(fe.pts-F,ie)}),!D||X<0){if(G=G.filter(function(fe){return fe.pts>=0}),!G.length)return;C===0?X=0:R?X=Math.max(0,ie):X=G[0].pts}if(A.isAAC)for(var pe=C!==void 0,ue=this.config.maxAudioFramesDrift,we=0,de=X;we<G.length;we++){var oe=G[we],De=oe.pts,Ce=De-de,Ue=Math.abs(1e3*Ce/P);if(Ce<=-ue*U&&pe)we===0&&(p.logger.warn("Audio frame @ "+(De/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Ce/P)+" ms."),this.nextAudioPts=X=de=De);else if(Ce>=ue*U&&Ue<y&&pe){var Me=Math.round(Ce/U);de=De-Me*U,de<0&&(Me--,de+=U),we===0&&(this.nextAudioPts=X=de),p.logger.warn("[mp4-remuxer]: Injecting "+Me+" audio frame @ "+(de/P).toFixed(3)+"s due to "+Math.round(1e3*Ce/P)+" ms gap.");for(var ze=0;ze<Me;ze++){var Ge=Math.max(de,0),Ke=a.default.getSilentFrame(A.manifestCodec||A.codec,A.channelCount);Ke||(p.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ke=oe.unit.subarray()),G.splice(we,0,{unit:Ke,pts:Ge}),de+=U,we++}}oe.pts=de,de+=U}for(var He=null,Fe=null,Se,Xe=0,st=G.length;st--;)Xe+=G[st].unit.byteLength;for(var et=0,ot=G.length;et<ot;et++){var nt=G[et],dt=nt.unit,ne=nt.pts;if(Fe!==null){var Ee=$[et-1];Ee.duration=Math.round((ne-Fe)/N)}else if(D&&A.isAAC&&(ne=X),He=ne,Xe>0){Xe+=Y;try{Se=new Uint8Array(Xe)}catch(fe){this.observer.emit(f.Events.ERROR,f.Events.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Xe,reason:"fail allocating audio mdat "+Xe});return}if(!j){var xe=new DataView(Se.buffer);xe.setUint32(0,Xe),Se.set(o.default.types.mdat,4)}}else return;Se.set(dt,Y);var Ae=dt.byteLength;Y+=Ae,$.push(new S(!0,B,Ae,0)),Fe=ne}var be=$.length;if(!!be){var je=$[$.length-1];this.nextAudioPts=X=Fe+N*je.duration;var V=j?new Uint8Array(0):o.default.moof(A.sequenceNumber++,He/N,m({},A,{samples:$}));A.samples=[];var he=He/P,_e=X/P,Ie="audio",Z={data1:V,data2:Se,startPTS:he,endPTS:_e,startDTS:he,endDTS:_e,type:Ie,hasAudio:!0,hasVideo:!1,nb:be};return this.isAudioContiguous=!0,console.assert(Se.length,"MDAT length must not be zero"),Z}},L.remuxEmptyAudio=function(A,O,D,R){var C=A.inputTimeScale,P=A.samplerate?A.samplerate:C,M=C/P,N=this.nextAudioPts,B=(N!==null?N:R.startDTS*C)+this._initDTS,U=R.endDTS*C+this._initDTS,F=M*b,j=Math.ceil((U-B)/F),$=a.default.getSilentFrame(A.manifestCodec||A.codec,A.channelCount);if(p.logger.warn("[mp4-remuxer]: remux empty Audio"),!$){p.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var G=[],Y=0;Y<j;Y++){var X=B+Y*F;G.push({unit:$,pts:X,dts:X})}return A.samples=G,this.remuxAudio(A,O,D,!1)},L.remuxID3=function(A,O){var D=A.samples.length;if(!!D){for(var R=A.inputTimeScale,C=this._initPTS,P=this._initDTS,M=0;M<D;M++){var N=A.samples[M];N.pts=d(N.pts-C,O*R)/R,N.dts=d(N.dts-P,O*R)/R}var B=A.samples;return A.samples=[],{samples:B}}},L.remuxText=function(A,O){var D=A.samples.length;if(!!D){for(var R=A.inputTimeScale,C=this._initPTS,P=0;P<D;P++){var M=A.samples[P];M.pts=d(M.pts-C,O*R)/R}A.samples.sort(function(B,U){return B.pts-U.pts});var N=A.samples;return A.samples=[],{samples:N}}},w}();function d(w,L){var I;if(L===null)return w;for(L<w?I=-8589934592:I=8589934592;Math.abs(w-L)>4294967296;)w+=I;return w}function x(w){for(var L=0;L<w.length;L++)if(w[L].key)return L;return-1}var S=function(L,I,A,O){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=I,this.size=A,this.cts=O,this.flags=new T(L)},T=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},"./src/remux/passthrough-remuxer.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/mp4-tools.ts"),o=t("./src/loader/fragment.ts"),f=t("./src/utils/logger.ts"),h=function(){function u(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var m=u.prototype;return m.destroy=function(){},m.resetTimeStamp=function(b){this.initPTS=b,this.lastEndDTS=null},m.resetNextTimestamp=function(){this.lastEndDTS=null},m.resetInitSegment=function(b,_,g){this.audioCodec=_,this.videoCodec=g,this.generateInitSegment(b),this.emitInitSegment=!0},m.generateInitSegment=function(b){var _=this.audioCodec,g=this.videoCodec;if(!b||!b.byteLength){this.initTracks=void 0,this.initData=void 0;return}var c=this.initData=Object(a.parseInitSegment)(b);_||(_=l(c.audio,o.ElementaryStreamTypes.AUDIO)),g||(g=l(c.video,o.ElementaryStreamTypes.VIDEO));var v={};c.audio&&c.video?v.audiovideo={container:"video/mp4",codec:_+","+g,initSegment:b,id:"main"}:c.audio?v.audio={container:"audio/mp4",codec:_,initSegment:b,id:"audio"}:c.video?v.video={container:"video/mp4",codec:g,initSegment:b,id:"main"}:f.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=v},m.remux=function(b,_,g,c,v){var E=this.initPTS,d=this.lastEndDTS,x={audio:void 0,video:void 0,text:c,id3:g,initSegment:void 0};Object(n.isFiniteNumber)(d)||(d=this.lastEndDTS=v||0);var S=_.samples;if(!S||!S.length)return x;var T={initPTS:void 0,timescale:1},w=this.initData;if((!w||!w.length)&&(this.generateInitSegment(S),w=this.initData),!w||!w.length)return f.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),x;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1),Object(n.isFiniteNumber)(E)||(this.initPTS=T.initPTS=E=p(w,S,d));var L=Object(a.getDuration)(S,w),I=d,A=L+I;Object(a.offsetStartDTS)(w,S,E),L>0?this.lastEndDTS=A:(f.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var O=!!w.audio,D=!!w.video,R="";O&&(R+="audio"),D&&(R+="video");var C={data1:S,startPTS:I,startDTS:I,endPTS:A,endDTS:A,type:R,hasAudio:O,hasVideo:D,nb:1,dropped:0};return x.audio=C.type==="audio"?C:void 0,x.video=C.type!=="audio"?C:void 0,x.text=c,x.id3=g,x.initSegment=T,x},u}(),p=function(m,y,b){return Object(a.getStartDTS)(m,y)-b};function l(u,m){var y=u==null?void 0:u.codec;return y&&y.length>4?y:y==="hvc1"?"hvc1.1.c.L120.90":y==="av01"?"av01.0.04M.08":y==="avc1"||m===o.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}i.default=h},"./src/task-loop.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=a.prototype;return o.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function(){},o.hasInterval=function(){return!!this._tickInterval},o.hasNextTick=function(){return!!this._tickTimer},o.setInterval=function(h){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,h),!0)},o.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},o.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},o.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function(){},a}()},"./src/types/cmcd.ts":function(r,i,t){t.r(i),t.d(i,"CMCDVersion",function(){return n}),t.d(i,"CMCDObjectType",function(){return a}),t.d(i,"CMCDStreamingFormat",function(){return o}),t.d(i,"CMCDStreamType",function(){return f});var n=1,a;(function(h){h.MANIFEST="m",h.AUDIO="a",h.VIDEO="v",h.MUXED="av",h.INIT="i",h.CAPTION="c",h.TIMED_TEXT="tt",h.KEY="k",h.OTHER="o"})(a||(a={}));var o;(function(h){h.DASH="d",h.HLS="h",h.SMOOTH="s",h.OTHER="o"})(o||(o={}));var f;(function(h){h.VOD="v",h.LIVE="l"})(f||(f={}))},"./src/types/level.ts":function(r,i,t){t.r(i),t.d(i,"HlsSkip",function(){return o}),t.d(i,"getSkipValue",function(){return f}),t.d(i,"HlsUrlParameters",function(){return h}),t.d(i,"Level",function(){return p});function n(l,u){for(var m=0;m<u.length;m++){var y=u[m];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,y.key,y)}}function a(l,u,m){return u&&n(l.prototype,u),m&&n(l,m),l}var o;(function(l){l.No="",l.Yes="YES",l.v2="v2"})(o||(o={}));function f(l,u){var m=l.canSkipUntil,y=l.canSkipDateRanges,b=l.endSN,_=u!==void 0?u-b:0;return m&&_<m?y?o.v2:o.Yes:o.No}var h=function(){function l(m,y,b){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=m,this.part=y,this.skip=b}var u=l.prototype;return u.addDirectives=function(y){var b=new self.URL(y);return this.msn!==void 0&&b.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&b.searchParams.set("_HLS_part",this.part.toString()),this.skip&&b.searchParams.set("_HLS_skip",this.skip),b.toString()},l}(),p=function(){function l(u){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[u.url],this.attrs=u.attrs,this.bitrate=u.bitrate,u.details&&(this.details=u.details),this.id=u.id||0,this.name=u.name,this.width=u.width||0,this.height=u.height||0,this.audioCodec=u.audioCodec,this.videoCodec=u.videoCodec,this.unknownCodecs=u.unknownCodecs,this.codecSet=[u.videoCodec,u.audioCodec].filter(function(m){return m}).join(",").replace(/\.[^.,]+/g,"")}return a(l,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(m){var y=m%this.url.length;this._urlId!==y&&(this.details=void 0,this._urlId=y)}}]),l}()},"./src/types/loader.ts":function(r,i,t){t.r(i),t.d(i,"PlaylistContextType",function(){return n}),t.d(i,"PlaylistLevelType",function(){return a});var n;(function(o){o.MANIFEST="manifest",o.LEVEL="level",o.AUDIO_TRACK="audioTrack",o.SUBTITLE_TRACK="subtitleTrack"})(n||(n={}));var a;(function(o){o.MAIN="main",o.AUDIO="audio",o.SUBTITLE="subtitle"})(a||(a={}))},"./src/types/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"ChunkMetadata",function(){return n});var n=function(f,h,p,l,u,m){l===void 0&&(l=0),u===void 0&&(u=-1),m===void 0&&(m=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=a(),this.buffering={audio:a(),video:a(),audiovideo:a()},this.level=f,this.sn=h,this.id=p,this.size=l,this.part=u,this.partial=m};function a(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(r,i,t){t.r(i),t.d(i,"AttrList",function(){return o});var n=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function f(p){typeof p=="string"&&(p=f.parseAttrList(p));for(var l in p)p.hasOwnProperty(l)&&(this[l]=p[l])}var h=f.prototype;return h.decimalInteger=function(l){var u=parseInt(this[l],10);return u>Number.MAX_SAFE_INTEGER?1/0:u},h.hexadecimalInteger=function(l){if(this[l]){var u=(this[l]||"0x").slice(2);u=(u.length&1?"0":"")+u;for(var m=new Uint8Array(u.length/2),y=0;y<u.length/2;y++)m[y]=parseInt(u.slice(y*2,y*2+2),16);return m}else return null},h.hexadecimalIntegerAsNumber=function(l){var u=parseInt(this[l],16);return u>Number.MAX_SAFE_INTEGER?1/0:u},h.decimalFloatingPoint=function(l){return parseFloat(this[l])},h.optionalFloat=function(l,u){var m=this[l];return m?parseFloat(m):u},h.enumeratedString=function(l){return this[l]},h.bool=function(l){return this[l]==="YES"},h.decimalResolution=function(l){var u=n.exec(this[l]);if(u!==null)return{width:parseInt(u[1],10),height:parseInt(u[2],10)}},f.parseAttrList=function(l){var u,m={},y='"';for(a.lastIndex=0;(u=a.exec(l))!==null;){var b=u[2];b.indexOf(y)===0&&b.lastIndexOf(y)===b.length-1&&(b=b.slice(1,-1)),m[u[1]]=b}return m},f}()},"./src/utils/binary-search.ts":function(r,i,t){t.r(i);var n={search:function(o,f){for(var h=0,p=o.length-1,l=null,u=null;h<=p;){l=(h+p)/2|0,u=o[l];var m=f(u);if(m>0)h=l+1;else if(m<0)p=l-1;else return u}return null}};i.default=n},"./src/utils/buffer-helper.ts":function(r,i,t){t.r(i),t.d(i,"BufferHelper",function(){return o});var n=t("./src/utils/logger.ts"),a={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function f(){}return f.isBuffered=function(p,l){try{if(p){for(var u=f.getBuffered(p),m=0;m<u.length;m++)if(l>=u.start(m)&&l<=u.end(m))return!0}}catch(y){}return!1},f.bufferInfo=function(p,l,u){try{if(p){var m=f.getBuffered(p),y=[],b;for(b=0;b<m.length;b++)y.push({start:m.start(b),end:m.end(b)});return this.bufferedInfo(y,l,u)}}catch(_){}return{len:0,start:l,end:l,nextStart:void 0}},f.bufferedInfo=function(p,l,u){l=Math.max(0,l),p.sort(function(T,w){var L=T.start-w.start;return L||w.end-T.end});var m=[];if(u)for(var y=0;y<p.length;y++){var b=m.length;if(b){var _=m[b-1].end;p[y].start-_<u?p[y].end>_&&(m[b-1].end=p[y].end):m.push(p[y])}else m.push(p[y])}else m=p;for(var g=0,c,v=l,E=l,d=0;d<m.length;d++){var x=m[d].start,S=m[d].end;if(l+u>=x&&l<S)v=x,E=S,g=E-l;else if(l+u<x){c=x;break}}return{len:g,start:v||0,end:E||0,nextStart:c}},f.getBuffered=function(p){try{return p.buffered}catch(l){return n.logger.log("failed to get media.buffered",l),a}},f}()},"./src/utils/cea-608-parser.ts":function(r,i,t){t.r(i),t.d(i,"Row",function(){return E}),t.d(i,"CaptionScreen",function(){return d});var n=t("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(A){var O=A;return a.hasOwnProperty(A)&&(O=a[A]),String.fromCharCode(O)},f=15,h=100,p={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},u={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},m={25:2,26:4,29:6,30:8,31:10,27:13,28:15},y=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],b;(function(I){I[I.ERROR=0]="ERROR",I[I.TEXT=1]="TEXT",I[I.WARNING=2]="WARNING",I[I.INFO=2]="INFO",I[I.DEBUG=3]="DEBUG",I[I.DATA=3]="DATA"})(b||(b={}));var _=function(){function I(){this.time=null,this.verboseLevel=b.ERROR}var A=I.prototype;return A.log=function(D,R){this.verboseLevel>=D&&n.logger.log(this.time+" ["+D+"] "+R)},I}(),g=function(A){for(var O=[],D=0;D<A.length;D++)O.push(A[D].toString(16));return O},c=function(){function I(O,D,R,C,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=O||"white",this.underline=D||!1,this.italics=R||!1,this.background=C||"black",this.flash=P||!1}var A=I.prototype;return A.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},A.setStyles=function(D){for(var R=["foreground","underline","italics","background","flash"],C=0;C<R.length;C++){var P=R[C];D.hasOwnProperty(P)&&(this[P]=D[P])}},A.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},A.equals=function(D){return this.foreground===D.foreground&&this.underline===D.underline&&this.italics===D.italics&&this.background===D.background&&this.flash===D.flash},A.copy=function(D){this.foreground=D.foreground,this.underline=D.underline,this.italics=D.italics,this.background=D.background,this.flash=D.flash},A.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},I}(),v=function(){function I(O,D,R,C,P,M){this.uchar=void 0,this.penState=void 0,this.uchar=O||" ",this.penState=new c(D,R,C,P,M)}var A=I.prototype;return A.reset=function(){this.uchar=" ",this.penState.reset()},A.setChar=function(D,R){this.uchar=D,this.penState.copy(R)},A.setPenState=function(D){this.penState.copy(D)},A.equals=function(D){return this.uchar===D.uchar&&this.penState.equals(D.penState)},A.copy=function(D){this.uchar=D.uchar,this.penState.copy(D.penState)},A.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},I}(),E=function(){function I(O){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var D=0;D<h;D++)this.chars.push(new v);this.logger=O,this.pos=0,this.currPenState=new c}var A=I.prototype;return A.equals=function(D){for(var R=!0,C=0;C<h;C++)if(!this.chars[C].equals(D.chars[C])){R=!1;break}return R},A.copy=function(D){for(var R=0;R<h;R++)this.chars[R].copy(D.chars[R])},A.isEmpty=function(){for(var D=!0,R=0;R<h;R++)if(!this.chars[R].isEmpty()){D=!1;break}return D},A.setCursor=function(D){this.pos!==D&&(this.pos=D),this.pos<0?(this.logger.log(b.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>h&&(this.logger.log(b.DEBUG,"Too large cursor position "+this.pos),this.pos=h)},A.moveCursor=function(D){var R=this.pos+D;if(D>1)for(var C=this.pos+1;C<R+1;C++)this.chars[C].setPenState(this.currPenState);this.setCursor(R)},A.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},A.insertChar=function(D){D>=144&&this.backSpace();var R=o(D);if(this.pos>=h){this.logger.log(b.ERROR,"Cannot insert "+D.toString(16)+" ("+R+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(R,this.currPenState),this.moveCursor(1)},A.clearFromPos=function(D){var R;for(R=D;R<h;R++)this.chars[R].reset()},A.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},A.clearToEndOfRow=function(){this.clearFromPos(this.pos)},A.getTextString=function(){for(var D=[],R=!0,C=0;C<h;C++){var P=this.chars[C].uchar;P!==" "&&(R=!1),D.push(P)}return R?"":D.join("")},A.setPenStyles=function(D){this.currPenState.setStyles(D);var R=this.chars[this.pos];R.setPenState(this.currPenState)},I}(),d=function(){function I(O){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var D=0;D<f;D++)this.rows.push(new E(O));this.logger=O,this.currRow=f-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var A=I.prototype;return A.reset=function(){for(var D=0;D<f;D++)this.rows[D].clear();this.currRow=f-1},A.equals=function(D){for(var R=!0,C=0;C<f;C++)if(!this.rows[C].equals(D.rows[C])){R=!1;break}return R},A.copy=function(D){for(var R=0;R<f;R++)this.rows[R].copy(D.rows[R])},A.isEmpty=function(){for(var D=!0,R=0;R<f;R++)if(!this.rows[R].isEmpty()){D=!1;break}return D},A.backSpace=function(){var D=this.rows[this.currRow];D.backSpace()},A.clearToEndOfRow=function(){var D=this.rows[this.currRow];D.clearToEndOfRow()},A.insertChar=function(D){var R=this.rows[this.currRow];R.insertChar(D)},A.setPen=function(D){var R=this.rows[this.currRow];R.setPenStyles(D)},A.moveCursor=function(D){var R=this.rows[this.currRow];R.moveCursor(D)},A.setCursor=function(D){this.logger.log(b.INFO,"setCursor: "+D);var R=this.rows[this.currRow];R.setCursor(D)},A.setPAC=function(D){this.logger.log(b.INFO,"pacData = "+JSON.stringify(D));var R=D.row-1;if(this.nrRollUpRows&&R<this.nrRollUpRows-1&&(R=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==R){for(var C=0;C<f;C++)this.rows[C].clear();var P=this.currRow+1-this.nrRollUpRows,M=this.lastOutputScreen;if(M){var N=M.rows[P].cueStartTime,B=this.logger.time;if(N&&B!==null&&N<B)for(var U=0;U<this.nrRollUpRows;U++)this.rows[R-this.nrRollUpRows+U+1].copy(M.rows[P+U])}}this.currRow=R;var F=this.rows[this.currRow];if(D.indent!==null){var j=D.indent,$=Math.max(j-1,0);F.setCursor(D.indent),D.color=F.chars[$].penState.foreground}var G={foreground:D.color,underline:D.underline,italics:D.italics,background:"black",flash:!1};this.setPen(G)},A.setBkgData=function(D){this.logger.log(b.INFO,"bkgData = "+JSON.stringify(D)),this.backSpace(),this.setPen(D),this.insertChar(32)},A.setRollUpRows=function(D){this.nrRollUpRows=D},A.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(b.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(b.TEXT,this.getDisplayText());var D=this.currRow+1-this.nrRollUpRows,R=this.rows.splice(D,1)[0];R.clear(),this.rows.splice(this.currRow,0,R),this.logger.log(b.INFO,"Rolling up")},A.getDisplayText=function(D){D=D||!1;for(var R=[],C="",P=-1,M=0;M<f;M++){var N=this.rows[M].getTextString();N&&(P=M+1,D?R.push("Row "+P+": '"+N+"'"):R.push(N.trim()))}return R.length>0&&(D?C="["+R.join(" | ")+"]":C=R.join(`
`)),C},A.getTextAndFormat=function(){return this.rows},I}(),x=function(){function I(O,D,R){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=O,this.outputFilter=D,this.mode=null,this.verbose=0,this.displayedMemory=new d(R),this.nonDisplayedMemory=new d(R),this.lastOutputScreen=new d(R),this.currRollUpRow=this.displayedMemory.rows[f-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=R}var A=I.prototype;return A.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[f-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},A.getHandler=function(){return this.outputFilter},A.setHandler=function(D){this.outputFilter=D},A.setPAC=function(D){this.writeScreen.setPAC(D)},A.setBkgData=function(D){this.writeScreen.setBkgData(D)},A.setMode=function(D){D!==this.mode&&(this.mode=D,this.logger.log(b.INFO,"MODE="+D),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=D)},A.insertChars=function(D){for(var R=0;R<D.length;R++)this.writeScreen.insertChar(D[R]);var C=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(b.INFO,C+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(b.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},A.ccRCL=function(){this.logger.log(b.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},A.ccBS=function(){this.logger.log(b.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},A.ccAOF=function(){},A.ccAON=function(){},A.ccDER=function(){this.logger.log(b.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},A.ccRU=function(D){this.logger.log(b.INFO,"RU("+D+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(D)},A.ccFON=function(){this.logger.log(b.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},A.ccRDC=function(){this.logger.log(b.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},A.ccTR=function(){this.logger.log(b.INFO,"TR"),this.setMode("MODE_TEXT")},A.ccRTD=function(){this.logger.log(b.INFO,"RTD"),this.setMode("MODE_TEXT")},A.ccEDM=function(){this.logger.log(b.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},A.ccCR=function(){this.logger.log(b.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},A.ccENM=function(){this.logger.log(b.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},A.ccEOC=function(){if(this.logger.log(b.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var D=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=D,this.writeScreen=this.nonDisplayedMemory,this.logger.log(b.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},A.ccTO=function(D){this.logger.log(b.INFO,"TO("+D+") - Tab Offset"),this.writeScreen.moveCursor(D)},A.ccMIDROW=function(D){var R={flash:!1};if(R.underline=D%2==1,R.italics=D>=46,R.italics)R.foreground="white";else{var C=Math.floor(D/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];R.foreground=P[C]}this.logger.log(b.INFO,"MIDROW: "+JSON.stringify(R)),this.writeScreen.setPen(R)},A.outputDataUpdate=function(D){D===void 0&&(D=!1);var R=this.logger.time;R!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=R:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,R,this.lastOutputScreen),D&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:R),this.lastOutputScreen.copy(this.displayedMemory))},A.cueSplitAtTime=function(D){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,D,this.displayedMemory),this.cueStartTime=D))},I}(),S=function(){function I(O,D,R){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var C=new _;this.channels=[null,new x(O,D,C),new x(O+1,R,C)],this.cmdHistory=L(),this.logger=C}var A=I.prototype;return A.getHandler=function(D){return this.channels[D].getHandler()},A.setHandler=function(D,R){this.channels[D].setHandler(R)},A.addData=function(D,R){var C,P,M,N=!1;this.logger.time=D;for(var B=0;B<R.length;B+=2)if(P=R[B]&127,M=R[B+1]&127,!(P===0&&M===0)){if(this.logger.log(b.DATA,"["+g([R[B],R[B+1]])+"] -> ("+g([P,M])+")"),C=this.parseCmd(P,M),C||(C=this.parseMidrow(P,M)),C||(C=this.parsePAC(P,M)),C||(C=this.parseBackgroundAttributes(P,M)),!C&&(N=this.parseChars(P,M),N)){var U=this.currentChannel;if(U&&U>0){var F=this.channels[U];F.insertChars(N)}else this.logger.log(b.WARNING,"No channel found yet. TEXT-MODE?")}!C&&!N&&this.logger.log(b.WARNING,"Couldn't parse cleaned data "+g([P,M])+" orig: "+g([R[B],R[B+1]]))}},A.parseCmd=function(D,R){var C=this.cmdHistory,P=(D===20||D===28||D===21||D===29)&&R>=32&&R<=47,M=(D===23||D===31)&&R>=33&&R<=35;if(!(P||M))return!1;if(w(D,R,C))return T(null,null,C),this.logger.log(b.DEBUG,"Repeated command ("+g([D,R])+") is dropped"),!0;var N=D===20||D===21||D===23?1:2,B=this.channels[N];return D===20||D===21||D===28||D===29?R===32?B.ccRCL():R===33?B.ccBS():R===34?B.ccAOF():R===35?B.ccAON():R===36?B.ccDER():R===37?B.ccRU(2):R===38?B.ccRU(3):R===39?B.ccRU(4):R===40?B.ccFON():R===41?B.ccRDC():R===42?B.ccTR():R===43?B.ccRTD():R===44?B.ccEDM():R===45?B.ccCR():R===46?B.ccENM():R===47&&B.ccEOC():B.ccTO(R-32),T(D,R,C),this.currentChannel=N,!0},A.parseMidrow=function(D,R){var C=0;if((D===17||D===25)&&R>=32&&R<=47){if(D===17?C=1:C=2,C!==this.currentChannel)return this.logger.log(b.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[C];return P?(P.ccMIDROW(R),this.logger.log(b.DEBUG,"MIDROW ("+g([D,R])+")"),!0):!1}return!1},A.parsePAC=function(D,R){var C,P=this.cmdHistory,M=(D>=17&&D<=23||D>=25&&D<=31)&&R>=64&&R<=127,N=(D===16||D===24)&&R>=64&&R<=95;if(!(M||N))return!1;if(w(D,R,P))return T(null,null,P),!0;var B=D<=23?1:2;R>=64&&R<=95?C=B===1?p[D]:u[D]:C=B===1?l[D]:m[D];var U=this.channels[B];return U?(U.setPAC(this.interpretPAC(C,R)),T(D,R,P),this.currentChannel=B,!0):!1},A.interpretPAC=function(D,R){var C,P={color:null,italics:!1,indent:null,underline:!1,row:D};return R>95?C=R-96:C=R-64,P.underline=(C&1)==1,C<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((C-16)/2)*4,P},A.parseChars=function(D,R){var C,P=null,M=null;if(D>=25?(C=2,M=D-8):(C=1,M=D),M>=17&&M<=19){var N;M===17?N=R+80:M===18?N=R+112:N=R+144,this.logger.log(b.INFO,"Special char '"+o(N)+"' in channel "+C),P=[N]}else D>=32&&D<=127&&(P=R===0?[D]:[D,R]);if(P){var B=g(P);this.logger.log(b.DEBUG,"Char codes =  "+B.join(",")),T(D,R,this.cmdHistory)}return P},A.parseBackgroundAttributes=function(D,R){var C=(D===16||D===24)&&R>=32&&R<=47,P=(D===23||D===31)&&R>=45&&R<=47;if(!(C||P))return!1;var M,N={};D===16||D===24?(M=Math.floor((R-32)/2),N.background=y[M],R%2==1&&(N.background=N.background+"_semi")):R===45?N.background="transparent":(N.foreground="black",R===47&&(N.underline=!0));var B=D<=23?1:2,U=this.channels[B];return U.setBkgData(N),T(D,R,this.cmdHistory),!0},A.reset=function(){for(var D=0;D<Object.keys(this.channels).length;D++){var R=this.channels[D];R&&R.reset()}this.cmdHistory=L()},A.cueSplitAtTime=function(D){for(var R=0;R<this.channels.length;R++){var C=this.channels[R];C&&C.cueSplitAtTime(D)}},I}();function T(I,A,O){O.a=I,O.b=A}function w(I,A,O){return O.a===I&&O.b===A}function L(){return{a:null,b:null}}i.default=S},"./src/utils/codecs.ts":function(r,i,t){t.r(i),t.d(i,"isCodecType",function(){return a}),t.d(i,"isCodecSupportedInMp4",function(){return o});var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function a(f,h){var p=n[h];return!!p&&p[f.slice(0,4)]===!0}function o(f,h){return MediaSource.isTypeSupported((h||"video")+'/mp4;codecs="'+f+'"')}},"./src/utils/cues.ts":function(r,i,t){t.r(i);var n=t("./src/utils/vttparser.ts"),a=t("./src/utils/webvtt-parser.ts"),o=t("./src/utils/texttrack-utils.ts"),f=/\s/,h={newCue:function(l,u,m,y){for(var b=[],_,g,c,v,E,d=self.VTTCue||self.TextTrackCue,x=0;x<y.rows.length;x++)if(_=y.rows[x],c=!0,v=0,E="",!_.isEmpty()){for(var S=0;S<_.chars.length;S++)f.test(_.chars[S].uchar)&&c?v++:(E+=_.chars[S].uchar,c=!1);_.cueStartTime=u,u===m&&(m+=1e-4),v>=16?v--:v++;var T=Object(n.fixLineBreaks)(E.trim()),w=Object(a.generateCueId)(u,m,T);(!l||!l.cues||!l.cues.getCueById(w))&&(g=new d(u,m,T),g.id=w,g.line=x+1,g.align="left",g.position=10+Math.min(80,Math.floor(v*8/32)*10),b.push(g))}return l&&b.length&&(b.sort(function(L,I){return L.line==="auto"||I.line==="auto"?0:L.line>8&&I.line>8?I.line-L.line:L.line-I.line}),b.forEach(function(L){return Object(o.addCueToTrack)(l,L)})),b}};i.default=h},"./src/utils/discontinuities.ts":function(r,i,t){t.r(i),t.d(i,"findFirstFragWithCC",function(){return f}),t.d(i,"shouldAlignOnDiscontinuities",function(){return h}),t.d(i,"findDiscontinuousReferenceFrag",function(){return p}),t.d(i,"adjustSlidingStart",function(){return u}),t.d(i,"alignStream",function(){return m}),t.d(i,"alignPDT",function(){return b}),t.d(i,"alignFragmentByPDTDelta",function(){return _}),t.d(i,"alignMediaPlaylistByPDT",function(){return g});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts"),o=t("./src/controller/level-helper.ts");function f(c,v){for(var E=null,d=0,x=c.length;d<x;d++){var S=c[d];if(S&&S.cc===v){E=S;break}}return E}function h(c,v,E){return!!(v.details&&(E.endCC>E.startCC||c&&c.cc<E.startCC))}function p(c,v){var E=c.fragments,d=v.fragments;if(!d.length||!E.length){a.logger.log("No fragments to align");return}var x=f(E,d[0].cc);if(!x||x&&!x.startPTS){a.logger.log("No frag in previous level to align on");return}return x}function l(c,v){if(c){var E=c.start+v;c.start=c.startPTS=E,c.endPTS=E+c.duration}}function u(c,v){for(var E=v.fragments,d=0,x=E.length;d<x;d++)l(E[d],c);v.fragmentHint&&l(v.fragmentHint,c),v.alignedSliding=!0}function m(c,v,E){!v||(y(c,E,v),!E.alignedSliding&&v.details&&b(E,v.details),!E.alignedSliding&&v.details&&!E.skippedSegments&&Object(o.adjustSliding)(v.details,E))}function y(c,v,E){if(h(c,E,v)){var d=p(E.details,v);d&&Object(n.isFiniteNumber)(d.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+v.url),u(d.start,v))}}function b(c,v){if(!(!v.fragments.length||!c.hasProgramDateTime||!v.hasProgramDateTime)){var E=v.fragments[0].programDateTime,d=c.fragments[0].programDateTime,x=(d-E)/1e3+v.fragments[0].start;x&&Object(n.isFiniteNumber)(x)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(d-E)+"ms, sliding:"+x.toFixed(3)+" "+c.url+" "),u(x,c))}}function _(c,v){var E=c.programDateTime;if(!!E){var d=(E-v)/1e3;c.start=c.startPTS=d,c.endPTS=d+c.duration}}function g(c,v){if(!(!v.fragments.length||!c.hasProgramDateTime||!v.hasProgramDateTime)){var E=v.fragments[0].programDateTime,d=v.fragments[0].start,x=E-d*1e3;c.fragments.forEach(function(S){_(S,x)}),c.fragmentHint&&_(c.fragmentHint,x),c.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(r,i,t){t.r(i);var n=t("./src/utils/ewma.ts"),a=function(){function o(h,p,l){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=l,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(h),this.fast_=new n.default(p)}var f=o.prototype;return f.update=function(p,l){var u=this.slow_,m=this.fast_;this.slow_.halfLife!==p&&(this.slow_=new n.default(p,u.getEstimate(),u.getTotalWeight())),this.fast_.halfLife!==l&&(this.fast_=new n.default(l,m.getEstimate(),m.getTotalWeight()))},f.sample=function(p,l){p=Math.max(p,this.minDelayMs_);var u=8*l,m=p/1e3,y=u/m;this.fast_.sample(m,y),this.slow_.sample(m,y)},f.canEstimate=function(){var p=this.fast_;return p&&p.getTotalWeight()>=this.minWeight_},f.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},f.destroy=function(){},o}();i.default=a},"./src/utils/ewma.ts":function(r,i,t){t.r(i);var n=function(){function a(f,h,p){h===void 0&&(h=0),p===void 0&&(p=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=f,this.alpha_=f?Math.exp(Math.log(.5)/f):0,this.estimate_=h,this.totalWeight_=p}var o=a.prototype;return o.sample=function(h,p){var l=Math.pow(this.alpha_,h);this.estimate_=p*(1-l)+l*this.estimate_,this.totalWeight_+=h},o.getTotalWeight=function(){return this.totalWeight_},o.getEstimate=function(){if(this.alpha_){var h=1-Math.pow(this.alpha_,this.totalWeight_);if(h)return this.estimate_/h}return this.estimate_},a}();i.default=n},"./src/utils/fetch-loader.ts":function(r,i,t){t.r(i),t.d(i,"fetchSupported",function(){return _});var n=t("./src/polyfills/number.ts"),a=t("./src/loader/load-stats.ts"),o=t("./src/demux/chunk-cache.ts");function f(d,x){d.prototype=Object.create(x.prototype),d.prototype.constructor=d,m(d,x)}function h(d){var x=typeof Map=="function"?new Map:void 0;return h=function(T){if(T===null||!u(T))return T;if(typeof T!="function")throw new TypeError("Super expression must either be null or a function");if(typeof x!="undefined"){if(x.has(T))return x.get(T);x.set(T,w)}function w(){return p(T,arguments,y(this).constructor)}return w.prototype=Object.create(T.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),m(w,T)},h(d)}function p(d,x,S){return l()?p=Reflect.construct:p=function(w,L,I){var A=[null];A.push.apply(A,L);var O=Function.bind.apply(w,A),D=new O;return I&&m(D,I.prototype),D},p.apply(null,arguments)}function l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(d){return!1}}function u(d){return Function.toString.call(d).indexOf("[native code]")!==-1}function m(d,x){return m=Object.setPrototypeOf||function(T,w){return T.__proto__=w,T},m(d,x)}function y(d){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)},y(d)}function b(){return b=Object.assign||function(d){for(var x=1;x<arguments.length;x++){var S=arguments[x];for(var T in S)Object.prototype.hasOwnProperty.call(S,T)&&(d[T]=S[T])}return d},b.apply(this,arguments)}function _(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(d){}return!1}var g=function(){function d(S){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=S.fetchSetup||v,this.controller=new self.AbortController,this.stats=new a.LoadStats}var x=d.prototype;return x.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},x.abortInternal=function(){var T=this.response;(!T||!T.ok)&&(this.stats.aborted=!0,this.controller.abort())},x.abort=function(){var T;this.abortInternal(),(T=this.callbacks)!==null&&T!==void 0&&T.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},x.load=function(T,w,L){var I=this,A=this.stats;if(A.loading.start)throw new Error("Loader can only be used once.");A.loading.start=self.performance.now();var O=c(T,this.controller.signal),D=L.onProgress,R=T.responseType==="arraybuffer",C=R?"byteLength":"length";this.context=T,this.config=w,this.callbacks=L,this.request=this.fetchSetup(T,O),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){I.abortInternal(),L.onTimeout(A,T,I.response)},w.timeout),self.fetch(this.request).then(function(P){if(I.response=I.loader=P,!P.ok){var M=P.status,N=P.statusText;throw new E(N||"fetch, bad network response",M,P)}return A.loading.first=Math.max(self.performance.now(),A.loading.start),A.total=parseInt(P.headers.get("Content-Length")||"0"),D&&Object(n.isFiniteNumber)(w.highWaterMark)?I.loadProgressively(P,A,T,w.highWaterMark,D):R?P.arrayBuffer():P.text()}).then(function(P){var M=I.response;self.clearTimeout(I.requestTimeout),A.loading.end=Math.max(self.performance.now(),A.loading.first),A.loaded=A.total=P[C];var N={url:M.url,data:P};D&&!Object(n.isFiniteNumber)(w.highWaterMark)&&D(A,T,P,M),L.onSuccess(N,A,T,M)}).catch(function(P){if(self.clearTimeout(I.requestTimeout),!A.aborted){var M=P.code||0;L.onError({code:M,text:P.message},T,P.details)}})},x.getCacheAge=function(){var T=null;if(this.response){var w=this.response.headers.get("age");T=w?parseFloat(w):null}return T},x.loadProgressively=function(T,w,L,I,A){I===void 0&&(I=0);var O=new o.default,D=T.body.getReader(),R=function C(){return D.read().then(function(P){if(P.done)return O.dataLength&&A(w,L,O.flush(),T),Promise.resolve(new ArrayBuffer(0));var M=P.value,N=M.length;return w.loaded+=N,N<I||O.dataLength?(O.push(M),O.dataLength>=I&&A(w,L,O.flush(),T)):A(w,L,M,T),C()}).catch(function(){return Promise.reject()})};return R()},d}();function c(d,x){var S={method:"GET",mode:"cors",credentials:"same-origin",signal:x,headers:new self.Headers(b({},d.headers))};return d.rangeEnd&&S.headers.set("Range","bytes="+d.rangeStart+"-"+String(d.rangeEnd-1)),S}function v(d,x){return new self.Request(d.url,x)}var E=function(d){f(x,d);function x(S,T,w){var L;return L=d.call(this,S)||this,L.code=void 0,L.details=void 0,L.code=T,L.details=w,L}return x}(h(Error));i.default=g},"./src/utils/imsc1-ttml-parser.ts":function(r,i,t){t.r(i),t.d(i,"IMSC1_CODEC",function(){return u}),t.d(i,"parseIMSC1",function(){return _});var n=t("./src/utils/mp4-tools.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/utils/vttcue.ts"),f=t("./src/demux/id3.ts"),h=t("./src/utils/timescale-conversion.ts"),p=t("./src/utils/webvtt-parser.ts");function l(){return l=Object.assign||function(I){for(var A=1;A<arguments.length;A++){var O=arguments[A];for(var D in O)Object.prototype.hasOwnProperty.call(O,D)&&(I[D]=O[D])}return I},l.apply(this,arguments)}var u="stpp.ttml.im1t",m=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,y=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,b={left:"start",center:"center",right:"end",start:"start",end:"end"};function _(I,A,O,D,R){var C=Object(n.findBox)(new Uint8Array(I),["mdat"]);if(C.length===0){R(new Error("Could not parse IMSC1 mdat"));return}var P=C[0],M=Object(f.utf8ArrayToStr)(new Uint8Array(I,P.start,P.end-P.start)),N=Object(h.toTimescaleFromScale)(A,1,O);try{D(g(M,N))}catch(B){R(B)}}function g(I,A){var O=new DOMParser,D=O.parseFromString(I,"text/xml"),R=D.getElementsByTagName("tt")[0];if(!R)throw new Error("Invalid ttml");var C={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(C).reduce(function(F,j){return F[j]=R.getAttribute("ttp:"+j)||C[j],F},{}),M=R.getAttribute("xml:space")!=="preserve",N=v(c(R,"styling","style")),B=v(c(R,"layout","region")),U=c(R,"body","[begin]");return[].map.call(U,function(F){var j=E(F,M);if(!j||!F.hasAttribute("begin"))return null;var $=T(F.getAttribute("begin"),P),G=T(F.getAttribute("dur"),P),Y=T(F.getAttribute("end"),P);if($===null)throw S(F);if(Y===null){if(G===null)throw S(F);Y=$+G}var X=new o.default($-A,Y-A,j);X.id=Object(p.generateCueId)(X.startTime,X.endTime,X.text);var ie=B[F.getAttribute("region")],pe=N[F.getAttribute("style")];X.position=10,X.size=80;var ue=d(ie,pe),we=ue.textAlign;if(we){var de=b[we];de&&(X.lineAlign=de),X.align=we}return l(X,ue),X}).filter(function(F){return F!==null})}function c(I,A,O){var D=I.getElementsByTagName(A)[0];return D?[].slice.call(D.querySelectorAll(O)):[]}function v(I){return I.reduce(function(A,O){var D=O.getAttribute("xml:id");return D&&(A[D]=O),A},{})}function E(I,A){return[].slice.call(I.childNodes).reduce(function(O,D,R){var C;return D.nodeName==="br"&&R?O+`
`:(C=D.childNodes)!==null&&C!==void 0&&C.length?E(D,A):A?O+D.textContent.trim().replace(/\s+/g," "):O+D.textContent},"")}function d(I,A){var O="http://www.w3.org/ns/ttml#styling",D=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return D.reduce(function(R,C){var P=x(A,O,C)||x(I,O,C);return P&&(R[C]=P),R},{})}function x(I,A,O){return I.hasAttributeNS(A,O)?I.getAttributeNS(A,O):null}function S(I){return new Error("Could not parse ttml timestamp "+I)}function T(I,A){if(!I)return null;var O=Object(a.parseTimeStamp)(I);return O===null&&(m.test(I)?O=w(I,A):y.test(I)&&(O=L(I,A))),O}function w(I,A){var O=m.exec(I),D=(O[4]|0)+(O[5]|0)/A.subFrameRate;return(O[1]|0)*3600+(O[2]|0)*60+(O[3]|0)+D/A.frameRate}function L(I,A){var O=y.exec(I),D=Number(O[1]),R=O[2];switch(R){case"h":return D*3600;case"m":return D*60;case"ms":return D*1e3;case"f":return D/A.frameRate;case"t":return D/A.tickRate}return D}},"./src/utils/logger.ts":function(r,i,t){t.r(i),t.d(i,"enableLogs",function(){return p}),t.d(i,"logger",function(){return l});var n=function(){},a={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=a;function f(u){var m=self.console[u];return m?m.bind(self.console,"["+u+"] >"):n}function h(u){for(var m=arguments.length,y=new Array(m>1?m-1:0),b=1;b<m;b++)y[b-1]=arguments[b];y.forEach(function(_){o[_]=u[_]?u[_].bind(u):f(_)})}function p(u){if(self.console&&u===!0||typeof u=="object"){h(u,"debug","log","info","warn","error");try{o.log()}catch(m){o=a}}else o=a}var l=o},"./src/utils/mediakeys-helper.ts":function(r,i,t){t.r(i),t.d(i,"KeySystems",function(){return n}),t.d(i,"requestMediaKeySystemAccess",function(){return a});var n;(function(o){o.WIDEVINE="com.widevine.alpha",o.PLAYREADY="com.microsoft.playready"})(n||(n={}));var a=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(r,i,t){t.r(i),t.d(i,"getMediaSource",function(){return n});function n(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(r,i,t){t.r(i),t.d(i,"bin2str",function(){return h}),t.d(i,"readUint16",function(){return p}),t.d(i,"readUint32",function(){return l}),t.d(i,"writeUint32",function(){return u}),t.d(i,"findBox",function(){return m}),t.d(i,"parseSegmentIndex",function(){return y}),t.d(i,"parseInitSegment",function(){return b}),t.d(i,"getStartDTS",function(){return _}),t.d(i,"getDuration",function(){return g}),t.d(i,"computeRawDurationFromSamples",function(){return c}),t.d(i,"offsetStartDTS",function(){return v}),t.d(i,"segmentValidRange",function(){return E}),t.d(i,"appendUint8Array",function(){return d});var n=t("./src/utils/typed-array.ts"),a=t("./src/loader/fragment.ts"),o=Math.pow(2,32)-1,f=[].push;function h(x){return String.fromCharCode.apply(null,x)}function p(x,S){"data"in x&&(S+=x.start,x=x.data);var T=x[S]<<8|x[S+1];return T<0?65536+T:T}function l(x,S){"data"in x&&(S+=x.start,x=x.data);var T=x[S]<<24|x[S+1]<<16|x[S+2]<<8|x[S+3];return T<0?4294967296+T:T}function u(x,S,T){"data"in x&&(S+=x.start,x=x.data),x[S]=T>>24,x[S+1]=T>>16&255,x[S+2]=T>>8&255,x[S+3]=T&255}function m(x,S){var T=[];if(!S.length)return T;var w,L,I;"data"in x?(w=x.data,L=x.start,I=x.end):(w=x,L=0,I=w.byteLength);for(var A=L;A<I;){var O=l(w,A),D=h(w.subarray(A+4,A+8)),R=O>1?A+O:I;if(D===S[0])if(S.length===1)T.push({data:w,start:A+8,end:R});else{var C=m({data:w,start:A+8,end:R},S.slice(1));C.length&&f.apply(T,C)}A=R}return T}function y(x){var S=m(x,["moov"]),T=S[0],w=T?T.end:null,L=m(x,["sidx"]);if(!L||!L[0])return null;var I=[],A=L[0],O=A.data[0],D=O===0?8:16,R=l(A,D);D+=4;var C=0,P=0;O===0?D+=8:D+=16,D+=2;var M=A.end+P,N=p(A,D);D+=2;for(var B=0;B<N;B++){var U=D,F=l(A,U);U+=4;var j=F&2147483647,$=(F&2147483648)>>>31;if($===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var G=l(A,U);U+=4,I.push({referenceSize:j,subsegmentDuration:G,info:{duration:G/R,start:M,end:M+j-1}}),M+=j,U+=4,D=U}return{earliestPresentationTime:C,timescale:R,version:O,referencesCount:N,references:I,moovEndOffset:w}}function b(x){for(var S=[],T=m(x,["moov","trak"]),w=0;w<T.length;w++){var L=T[w],I=m(L,["tkhd"])[0];if(I){var A=I.data[I.start],O=A===0?12:20,D=l(I,O),R=m(L,["mdia","mdhd"])[0];if(R){A=R.data[R.start],O=A===0?12:20;var C=l(R,O),P=m(L,["mdia","hdlr"])[0];if(P){var M=h(P.data.subarray(P.start+8,P.start+12)),N={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[M];if(N){var B=m(L,["mdia","minf","stbl","stsd"])[0],U=void 0;B&&(U=h(B.data.subarray(B.start+12,B.start+16))),S[D]={timescale:C,type:N},S[N]={timescale:C,id:D,codec:U}}}}}}var F=m(x,["moov","mvex","trex"]);return F.forEach(function(j){var $=l(j,4),G=S[$];G&&(G.default={duration:l(j,12),flags:l(j,20)})}),S}function _(x,S){return m(S,["moof","traf"]).reduce(function(T,w){var L=m(w,["tfdt"])[0],I=L.data[L.start],A=m(w,["tfhd"]).reduce(function(O,D){var R=l(D,4),C=x[R];if(C){var P=l(L,4);I===1&&(P*=Math.pow(2,32),P+=l(L,8));var M=C.timescale||9e4,N=P/M;if(isFinite(N)&&(O===null||N<O))return N}return O},null);return A!==null&&isFinite(A)&&(T===null||A<T)?A:T},null)||0}function g(x,S){for(var T=0,w=0,L=0,I=m(x,["moof","traf"]),A=0;A<I.length;A++){var O=I[A],D=m(O,["tfhd"])[0],R=l(D,4),C=S[R];if(!!C){var P=C.default,M=l(D,0)|(P==null?void 0:P.flags),N=P==null?void 0:P.duration;M&8&&(M&2?N=l(D,12):N=l(D,8));for(var B=C.timescale||9e4,U=m(O,["trun"]),F=0;F<U.length;F++){if(T=c(U[F]),!T&&N){var j=l(U[F],4);T=N*j}C.type===a.ElementaryStreamTypes.VIDEO?w+=T/B:C.type===a.ElementaryStreamTypes.AUDIO&&(L+=T/B)}}}if(w===0&&L===0){var $=y(x);if($!=null&&$.references)return $.references.reduce(function(G,Y){return G+Y.info.duration||0},0)}return w||L}function c(x){var S=l(x,0),T=8;S&1&&(T+=4),S&4&&(T+=4);for(var w=0,L=l(x,4),I=0;I<L;I++){if(S&256){var A=l(x,T);w+=A,T+=4}S&512&&(T+=4),S&1024&&(T+=4),S&2048&&(T+=4)}return w}function v(x,S,T){m(S,["moof","traf"]).forEach(function(w){m(w,["tfhd"]).forEach(function(L){var I=l(L,4),A=x[I];if(!!A){var O=A.timescale||9e4;m(w,["tfdt"]).forEach(function(D){var R=D.data[D.start],C=l(D,4);if(R===0)u(D,4,C-T*O);else{C*=Math.pow(2,32),C+=l(D,8),C-=T*O,C=Math.max(C,0);var P=Math.floor(C/(o+1)),M=Math.floor(C%(o+1));u(D,4,P),u(D,8,M)}})}})})}function E(x){var S={valid:null,remainder:null},T=m(x,["moof"]);if(T){if(T.length<2)return S.remainder=x,S}else return S;var w=T[T.length-1];return S.valid=Object(n.sliceUint8)(x,0,w.start-8),S.remainder=Object(n.sliceUint8)(x,w.start-8),S}function d(x,S){var T=new Uint8Array(x.length+S.length);return T.set(x),T.set(S,x.length),T}},"./src/utils/output-filter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(f,h){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=f,this.trackName=h}var o=a.prototype;return o.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function(h,p,l){(this.startTime===null||this.startTime>h)&&(this.startTime=h),this.endTime=p,this.screen=l,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function(){this.cueRanges=[],this.startTime=null},a}()},"./src/utils/texttrack-utils.ts":function(r,i,t){t.r(i),t.d(i,"sendAddTrackEvent",function(){return a}),t.d(i,"addCueToTrack",function(){return o}),t.d(i,"clearCurrentCues",function(){return f}),t.d(i,"removeCuesInRange",function(){return h}),t.d(i,"getCuesInRange",function(){return l});var n=t("./src/utils/logger.ts");function a(u,m){var y;try{y=new Event("addtrack")}catch(b){y=document.createEvent("Event"),y.initEvent("addtrack",!1,!1)}y.track=u,m.dispatchEvent(y)}function o(u,m){var y=u.mode;if(y==="disabled"&&(u.mode="hidden"),u.cues&&!u.cues.getCueById(m.id))try{if(u.addCue(m),!u.cues.getCueById(m.id))throw new Error("addCue is failed for: "+m)}catch(_){n.logger.debug("[texttrack-utils]: "+_);var b=new self.TextTrackCue(m.startTime,m.endTime,m.text);b.id=m.id,u.addCue(b)}y==="disabled"&&(u.mode=y)}function f(u){var m=u.mode;if(m==="disabled"&&(u.mode="hidden"),u.cues)for(var y=u.cues.length;y--;)u.removeCue(u.cues[y]);m==="disabled"&&(u.mode=m)}function h(u,m,y){var b=u.mode;if(b==="disabled"&&(u.mode="hidden"),u.cues&&u.cues.length>0)for(var _=l(u.cues,m,y),g=0;g<_.length;g++)u.removeCue(_[g]);b==="disabled"&&(u.mode=b)}function p(u,m){if(m<u[0].startTime)return 0;var y=u.length-1;if(m>u[y].endTime)return-1;for(var b=0,_=y;b<=_;){var g=Math.floor((_+b)/2);if(m<u[g].startTime)_=g-1;else if(m>u[g].startTime&&b<y)b=g+1;else return g}return u[b].startTime-m<m-u[_].startTime?b:_}function l(u,m,y){var b=[],_=p(u,m);if(_>-1)for(var g=_,c=u.length;g<c;g++){var v=u[g];if(v.startTime>=m&&v.endTime<=y)b.push(v);else if(v.startTime>y)return b}return b}},"./src/utils/time-ranges.ts":function(r,i,t){t.r(i);var n={toString:function(o){for(var f="",h=o.length,p=0;p<h;p++)f+="["+o.start(p).toFixed(3)+","+o.end(p).toFixed(3)+"]";return f}};i.default=n},"./src/utils/timescale-conversion.ts":function(r,i,t){t.r(i),t.d(i,"toTimescaleFromBase",function(){return a}),t.d(i,"toTimescaleFromScale",function(){return o}),t.d(i,"toMsFromMpegTsClock",function(){return f}),t.d(i,"toMpegTsClockFromTimescale",function(){return h});var n=9e4;function a(p,l,u,m){u===void 0&&(u=1),m===void 0&&(m=!1);var y=p*l*u;return m?Math.round(y):y}function o(p,l,u,m){return u===void 0&&(u=1),m===void 0&&(m=!1),a(p,l,1/u,m)}function f(p,l){return l===void 0&&(l=!1),a(p,1e3,1/n,l)}function h(p,l){return l===void 0&&(l=1),a(p,n,1/l)}},"./src/utils/typed-array.ts":function(r,i,t){t.r(i),t.d(i,"sliceUint8",function(){return n});function n(a,o,f){return Uint8Array.prototype.slice?a.slice(o,f):new Uint8Array(Array.prototype.slice.call(a,o,f))}},"./src/utils/vttcue.ts":function(r,i,t){t.r(i),i.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var n=["","lr","rl"],a=["start","middle","end","left","right"];function o(u,m){if(typeof m!="string"||!Array.isArray(u))return!1;var y=m.toLowerCase();return~u.indexOf(y)?y:!1}function f(u){return o(n,u)}function h(u){return o(a,u)}function p(u){for(var m=arguments.length,y=new Array(m>1?m-1:0),b=1;b<m;b++)y[b-1]=arguments[b];for(var _=1;_<arguments.length;_++){var g=arguments[_];for(var c in g)u[c]=g[c]}return u}function l(u,m,y){var b=this,_={enumerable:!0};b.hasBeenReset=!1;var g="",c=!1,v=u,E=m,d=y,x=null,S="",T=!0,w="auto",L="start",I=50,A="middle",O=50,D="middle";Object.defineProperty(b,"id",p({},_,{get:function(){return g},set:function(C){g=""+C}})),Object.defineProperty(b,"pauseOnExit",p({},_,{get:function(){return c},set:function(C){c=!!C}})),Object.defineProperty(b,"startTime",p({},_,{get:function(){return v},set:function(C){if(typeof C!="number")throw new TypeError("Start time must be set to a number.");v=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"endTime",p({},_,{get:function(){return E},set:function(C){if(typeof C!="number")throw new TypeError("End time must be set to a number.");E=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"text",p({},_,{get:function(){return d},set:function(C){d=""+C,this.hasBeenReset=!0}})),Object.defineProperty(b,"region",p({},_,{get:function(){return x},set:function(C){x=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"vertical",p({},_,{get:function(){return S},set:function(C){var P=f(C);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");S=P,this.hasBeenReset=!0}})),Object.defineProperty(b,"snapToLines",p({},_,{get:function(){return T},set:function(C){T=!!C,this.hasBeenReset=!0}})),Object.defineProperty(b,"line",p({},_,{get:function(){return w},set:function(C){if(typeof C!="number"&&C!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");w=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"lineAlign",p({},_,{get:function(){return L},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");L=P,this.hasBeenReset=!0}})),Object.defineProperty(b,"position",p({},_,{get:function(){return I},set:function(C){if(C<0||C>100)throw new Error("Position must be between 0 and 100.");I=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"positionAlign",p({},_,{get:function(){return A},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");A=P,this.hasBeenReset=!0}})),Object.defineProperty(b,"size",p({},_,{get:function(){return O},set:function(C){if(C<0||C>100)throw new Error("Size must be between 0 and 100.");O=C,this.hasBeenReset=!0}})),Object.defineProperty(b,"align",p({},_,{get:function(){return D},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");D=P,this.hasBeenReset=!0}})),b.displayState=void 0}return l.prototype.getCueAsHTML=function(){var u=self.WebVTT;return u.convertCueToDOMTree(self,this.text)},l}()},"./src/utils/vttparser.ts":function(r,i,t){t.r(i),t.d(i,"parseTimeStamp",function(){return o}),t.d(i,"fixLineBreaks",function(){return m}),t.d(i,"VTTParser",function(){return y});var n=t("./src/utils/vttcue.ts"),a=function(){function b(){}var _=b.prototype;return _.decode=function(c,v){if(!c)return"";if(typeof c!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(c))},b}();function o(b){function _(c,v,E,d){return(c|0)*3600+(v|0)*60+(E|0)+parseFloat(d||0)}var g=b.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return g?parseFloat(g[2])>59?_(g[2],g[3],0,g[4]):_(g[1],g[2],g[3],g[4]):null}var f=function(){function b(){this.values=Object.create(null)}var _=b.prototype;return _.set=function(c,v){!this.get(c)&&v!==""&&(this.values[c]=v)},_.get=function(c,v,E){return E?this.has(c)?this.values[c]:v[E]:this.has(c)?this.values[c]:v},_.has=function(c){return c in this.values},_.alt=function(c,v,E){for(var d=0;d<E.length;++d)if(v===E[d]){this.set(c,v);break}},_.integer=function(c,v){/^-?\d+$/.test(v)&&this.set(c,parseInt(v,10))},_.percent=function(c,v){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(v)){var E=parseFloat(v);if(E>=0&&E<=100)return this.set(c,E),!0}return!1},b}();function h(b,_,g,c){var v=c?b.split(c):[b];for(var E in v)if(typeof v[E]=="string"){var d=v[E].split(g);if(d.length===2){var x=d[0],S=d[1];_(x,S)}}}var p=new n.default(0,0,""),l=p.align==="middle"?"middle":"center";function u(b,_,g){var c=b;function v(){var x=o(b);if(x===null)throw new Error("Malformed timestamp: "+c);return b=b.replace(/^[^\sa-zA-Z-]+/,""),x}function E(x,S){var T=new f;h(x,function(I,A){var O;switch(I){case"region":for(var D=g.length-1;D>=0;D--)if(g[D].id===A){T.set(I,g[D].region);break}break;case"vertical":T.alt(I,A,["rl","lr"]);break;case"line":O=A.split(","),T.integer(I,O[0]),T.percent(I,O[0])&&T.set("snapToLines",!1),T.alt(I,O[0],["auto"]),O.length===2&&T.alt("lineAlign",O[1],["start",l,"end"]);break;case"position":O=A.split(","),T.percent(I,O[0]),O.length===2&&T.alt("positionAlign",O[1],["start",l,"end","line-left","line-right","auto"]);break;case"size":T.percent(I,A);break;case"align":T.alt(I,A,["start",l,"end","left","right"]);break}},/:/,/\s/),S.region=T.get("region",null),S.vertical=T.get("vertical","");var w=T.get("line","auto");w==="auto"&&p.line===-1&&(w=-1),S.line=w,S.lineAlign=T.get("lineAlign","start"),S.snapToLines=T.get("snapToLines",!0),S.size=T.get("size",100),S.align=T.get("align",l);var L=T.get("position","auto");L==="auto"&&p.position===50&&(L=S.align==="start"||S.align==="left"?0:S.align==="end"||S.align==="right"?100:50),S.position=L}function d(){b=b.replace(/^\s+/,"")}if(d(),_.startTime=v(),d(),b.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+c);b=b.substr(3),d(),_.endTime=v(),d(),E(b,_)}function m(b){return b.replace(/<br(?: \/)?>/gi,`
`)}var y=function(){function b(){this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var _=b.prototype;return _.parse=function(c){var v=this;c&&(v.buffer+=v.decoder.decode(c,{stream:!0}));function E(){var L=v.buffer,I=0;for(L=m(L);I<L.length&&L[I]!=="\r"&&L[I]!==`
`;)++I;var A=L.substr(0,I);return L[I]==="\r"&&++I,L[I]===`
`&&++I,v.buffer=L.substr(I),A}function d(L){h(L,function(I,A){},/:/)}try{var x="";if(v.state==="INITIAL"){if(!/\r\n|\n/.test(v.buffer))return this;x=E();var S=x.match(/^()?WEBVTT([ \t].*)?$/);if(!S||!S[0])throw new Error("Malformed WebVTT signature.");v.state="HEADER"}for(var T=!1;v.buffer;){if(!/\r\n|\n/.test(v.buffer))return this;switch(T?T=!1:x=E(),v.state){case"HEADER":/:/.test(x)?d(x):x||(v.state="ID");continue;case"NOTE":x||(v.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(x)){v.state="NOTE";break}if(!x)continue;if(v.cue=new n.default(0,0,""),v.state="CUE",x.indexOf("-->")===-1){v.cue.id=x;continue}case"CUE":if(!v.cue){v.state="BADCUE";continue}try{u(x,v.cue,v.regionList)}catch(L){v.cue=null,v.state="BADCUE";continue}v.state="CUETEXT";continue;case"CUETEXT":{var w=x.indexOf("-->")!==-1;if(!x||w&&(T=!0)){v.oncue&&v.cue&&v.oncue(v.cue),v.cue=null,v.state="ID";continue}if(v.cue===null)continue;v.cue.text&&(v.cue.text+=`
`),v.cue.text+=x}continue;case"BADCUE":x||(v.state="ID")}}}catch(L){v.state==="CUETEXT"&&v.cue&&v.oncue&&v.oncue(v.cue),v.cue=null,v.state=v.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},_.flush=function(){var c=this;try{if((c.cue||c.state==="HEADER")&&(c.buffer+=`

`,c.parse()),c.state==="INITIAL"||c.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(v){c.onparsingerror&&c.onparsingerror(v)}return c.onflush&&c.onflush(),this},b}()},"./src/utils/webvtt-parser.ts":function(r,i,t){t.r(i),t.d(i,"generateCueId",function(){return y}),t.d(i,"parseWebVTT",function(){return _});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/demux/id3.ts"),f=t("./src/utils/timescale-conversion.ts"),h=t("./src/remux/mp4-remuxer.ts"),p=/\r\n|\n\r|\n|\r/g,l=function(c,v,E){return E===void 0&&(E=0),c.substr(E,v.length)===v},u=function(c){var v=parseInt(c.substr(-3)),E=parseInt(c.substr(-6,2)),d=parseInt(c.substr(-9,2)),x=c.length>9?parseInt(c.substr(0,c.indexOf(":"))):0;if(!Object(n.isFiniteNumber)(v)||!Object(n.isFiniteNumber)(E)||!Object(n.isFiniteNumber)(d)||!Object(n.isFiniteNumber)(x))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+c);return v+=1e3*E,v+=60*1e3*d,v+=60*60*1e3*x,v},m=function(c){for(var v=5381,E=c.length;E;)v=v*33^c.charCodeAt(--E);return(v>>>0).toString()};function y(g,c,v){return m(g.toString())+m(c.toString())+m(v)}var b=function(c,v,E){var d=c[v],x=c[d.prevCC];if(!x||!x.new&&d.new){c.ccOffset=c.presentationOffset=d.start,d.new=!1;return}for(;(S=x)!==null&&S!==void 0&&S.new;){var S;c.ccOffset+=d.start-x.start,d.new=!1,d=x,x=c[d.prevCC]}c.presentationOffset=E};function _(g,c,v,E,d,x,S,T){var w=new a.VTTParser,L=Object(o.utf8ArrayToStr)(new Uint8Array(g)).trim().replace(p,`
`).split(`
`),I=[],A=Object(f.toMpegTsClockFromTimescale)(c,v),O="00:00.000",D=0,R=0,C,P=!0,M=!1;w.oncue=function(N){var B=E[d],U=E.ccOffset,F=(D-A)/9e4;if(B!=null&&B.new&&(R!==void 0?U=E.ccOffset=B.start:b(E,d,F)),F&&(U=F-E.presentationOffset),M){var j=N.endTime-N.startTime,$=Object(h.normalizePts)((N.startTime+U-R)*9e4,x*9e4)/9e4;N.startTime=$,N.endTime=$+j}var G=N.text.trim();N.text=decodeURIComponent(encodeURIComponent(G)),N.id||(N.id=y(N.startTime,N.endTime,G)),N.endTime>0&&I.push(N)},w.onparsingerror=function(N){C=N},w.onflush=function(){if(C){T(C);return}S(I)},L.forEach(function(N){if(P)if(l(N,"X-TIMESTAMP-MAP=")){P=!1,M=!0,N.substr(16).split(",").forEach(function(B){l(B,"LOCAL:")?O=B.substr(6):l(B,"MPEGTS:")&&(D=parseInt(B.substr(7)))});try{R=u(O)/1e3}catch(B){M=!1,C=B}return}else N===""&&(P=!1);w.parse(N+`
`)}),w.flush()}},"./src/utils/xhr-loader.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=t("./src/loader/load-stats.ts"),o=/^age:\s*[\d.]+\s*$/m,f=function(){function h(l){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=l?l.xhrSetup:null,this.stats=new a.LoadStats,this.retryDelay=0}var p=h.prototype;return p.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},p.abortInternal=function(){var u=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),u&&(u.onreadystatechange=null,u.onprogress=null,u.readyState!==4&&(this.stats.aborted=!0,u.abort()))},p.abort=function(){var u;this.abortInternal(),(u=this.callbacks)!==null&&u!==void 0&&u.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},p.load=function(u,m,y){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=u,this.config=m,this.callbacks=y,this.retryDelay=m.retryDelay,this.loadInternal()},p.loadInternal=function(){var u=this.config,m=this.context;if(!!u){var y=this.loader=new self.XMLHttpRequest,b=this.stats;b.loading.first=0,b.loaded=0;var _=this.xhrSetup;try{if(_)try{_(y,m.url)}catch(v){y.open("GET",m.url,!0),_(y,m.url)}y.readyState||y.open("GET",m.url,!0);var g=this.context.headers;if(g)for(var c in g)y.setRequestHeader(c,g[c])}catch(v){this.callbacks.onError({code:y.status,text:v.message},m,y);return}m.rangeEnd&&y.setRequestHeader("Range","bytes="+m.rangeStart+"-"+(m.rangeEnd-1)),y.onreadystatechange=this.readystatechange.bind(this),y.onprogress=this.loadprogress.bind(this),y.responseType=m.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.timeout),y.send()}},p.readystatechange=function(){var u=this.context,m=this.loader,y=this.stats;if(!(!u||!m)){var b=m.readyState,_=this.config;if(!y.aborted&&b>=2)if(self.clearTimeout(this.requestTimeout),y.loading.first===0&&(y.loading.first=Math.max(self.performance.now(),y.loading.start)),b===4){m.onreadystatechange=null,m.onprogress=null;var g=m.status;if(g>=200&&g<300){y.loading.end=Math.max(self.performance.now(),y.loading.first);var c,v;if(u.responseType==="arraybuffer"?(c=m.response,v=c.byteLength):(c=m.responseText,v=c.length),y.loaded=y.total=v,!this.callbacks)return;var E=this.callbacks.onProgress;if(E&&E(y,u,c,m),!this.callbacks)return;var d={url:m.responseURL,data:c};this.callbacks.onSuccess(d,y,u,m)}else y.retry>=_.maxRetry||g>=400&&g<499?(n.logger.error(g+" while loading "+u.url),this.callbacks.onError({code:g,text:m.statusText},u,m)):(n.logger.warn(g+" while loading "+u.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,_.maxRetryDelay),y.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),_.timeout)}},p.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url);var u=this.callbacks;u&&(this.abortInternal(),u.onTimeout(this.stats,this.context,this.loader))},p.loadprogress=function(u){var m=this.stats;m.loaded=u.loaded,u.lengthComputable&&(m.total=u.total)},p.getCacheAge=function(){var u=null;if(this.loader&&o.test(this.loader.getAllResponseHeaders())){var m=this.loader.getResponseHeader("age");u=m?parseFloat(m):null}return u},h}();i.default=f}}).default})})(Rh);var BS=Ca(Rh.exports),Ch={exports:{}};/*!
 * artplayer-plugin-danmuku.js v4.4.6
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(s,e){(function(r,i,t,n,a){var o=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Mt!="undefined"?Mt:{},f=typeof o.parcelRequire93cf=="function"&&o.parcelRequire93cf,h=f.cache||{},p=typeof Er=="function"&&Er.bind(s);function l(y,b){if(!h[y]){if(!r[y]){var _=typeof o.parcelRequire93cf=="function"&&o.parcelRequire93cf;if(!b&&_)return _(y,!0);if(f)return f(y,!0);if(p&&typeof y=="string")return p(y);var g=new Error("Cannot find module '"+y+"'");throw g.code="MODULE_NOT_FOUND",g}v.resolve=function(E){var d=r[y][1][E];return d!=null?d:E},v.cache={};var c=h[y]=new l.Module(y);r[y][0].call(c.exports,v,c,c.exports,this)}return h[y].exports;function v(E){var d=v.resolve(E);return d===!1?{}:l(d)}}l.isParcelRequire=!0,l.Module=function(y){this.id=y,this.bundle=l,this.exports={}},l.modules=r,l.cache=h,l.parent=f,l.register=function(y,b){r[y]=[function(_,g){g.exports=b},{}]},Object.defineProperty(l,"root",{get:function(){return o.parcelRequire93cf}}),o.parcelRequire93cf=l;for(var u=0;u<i.length;u++)l(i[u]);var m=l(t);s.exports=m})({E13ST:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./danmuku"),o=n.interopDefault(a),f=r("./setting"),h=n.interopDefault(f);function p(l){return u=>{(function(y){const{version:b,utils:{errorHandle:_}}=y.constructor,g=b.split(".").map(Number);_(g[0]+g[1]/100>=4.04,`Artplayer.js@${b} \u4E0D\u517C\u5BB9\u8BE5\u5F39\u5E55\u5E93\uFF0C\u8BF7\u66F4\u65B0\u5230 4.4.x \u7248\u672C\u4EE5\u4E0A`)})(u);const m=new o.default(u,l);return h.default(u,m),{name:"artplayerPluginDanmuku",emit:m.emit.bind(m),load:m.load.bind(m),config:m.config.bind(m),hide:m.hide.bind(m),show:m.show.bind(m),get isHide(){return m.isHide},get isStop(){return m.isStop}}}}t.default=p,p.env="production",p.version="4.4.6",p.build="1654928277149",typeof window!="undefined"&&(window.artplayerPluginDanmuku=p)},{"./danmuku":"8Gtnh","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY","./setting":"jAkJm"}],"8Gtnh":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./bilibili"),o=r("./getDanmuTop"),f=n.interopDefault(o);class h{constructor(l,u){const{constructor:m,template:y}=l;if(this.utils=m.utils,this.validator=m.validator,this.$danmuku=y.$danmuku,this.$player=y.$player,this.art=l,this.queue=[],this.option={},this.$refs=[],this.isStop=!1,this.isHide=!1,this.timer=null,this.config(u),this.option.useWorker)try{this.worker=new Worker(r("85d40535eae5f839"))}catch(b){}this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.reset=this.reset.bind(this),this.destroy=this.destroy.bind(this),l.on("video:play",this.start),l.on("video:playing",this.start),l.on("video:pause",this.stop),l.on("video:waiting",this.stop),l.on("fullscreen",this.reset),l.on("fullscreenWeb",this.reset),l.on("destroy",this.destroy),this.load()}static get option(){return{danmuku:[],speed:5,margin:["2%","25%"],opacity:1,color:"#FFFFFF",mode:0,fontSize:25,filter:()=>!0,antiOverlap:!0,useWorker:!0,synchronousPlayback:!1,lockTime:5,maxLength:100,minWidth:200,maxWidth:400,mount:void 0,theme:"dark",beforeEmit:()=>!0}}static get scheme(){return{danmuku:"array|function|string",speed:"number",margin:"array",opacity:"number",color:"string",mode:"number",fontSize:"number|string",filter:"function",antiOverlap:"boolean",useWorker:"boolean",synchronousPlayback:"boolean",lockTime:"number",maxLength:"number",minWidth:"number",maxWidth:"number",mount:"undefined|htmldivelement",theme:"string",beforeEmit:"function"}}get isRotate(){return this.art.plugins.autoOrientation&&this.art.plugins.autoOrientation.state}get marginTop(){const{clamp:l}=this.utils,u=this.option.margin[0],{clientHeight:m}=this.$player;return typeof u=="number"?l(u,0,m):typeof u=="string"&&u.endsWith("%")?l(m*(parseFloat(u)/100),0,m):h.option.margin[0]}get marginBottom(){const{clamp:l}=this.utils,u=this.option.margin[1],{clientHeight:m}=this.$player;return typeof u=="number"?l(u,0,m):typeof u=="string"&&u.endsWith("%")?l(m*(parseFloat(u)/100),0,m):h.option.margin[1]}filter(l,u){return this.queue.filter(m=>m.$state===l).map(u)}getLeft(l){const u=l.getBoundingClientRect();return this.isRotate?u.top:u.left}getRef(){const l=this.$refs.pop();if(l)return l;const u=document.createElement("div");return u.style.cssText=`
            user-select: none;
            position: absolute;
            white-space: pre;
            pointer-events: none;
            perspective: 500px;
            display: inline-block;
            will-change: transform;
            font-weight: normal;
            line-height: 1.125;
            visibility: hidden;
            font-family: SimHei, "Microsoft JhengHei", Arial, Helvetica, sans-serif;
            text-shadow: rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px;
        `,u}getReady(){const{currentTime:l}=this.art;return this.queue.filter(u=>u.$state==="ready"||u.$state==="wait"&&l+.1>=u.time&&u.time>=l-.1)}getEmits(){const l=[],{clientWidth:u}=this.$player,m=this.getLeft(this.$player);return this.filter("emit",y=>{const b=y.$ref.offsetTop,_=this.getLeft(y.$ref)-m,g=y.$ref.clientHeight,c=y.$ref.clientWidth,v=_+c,E=u-v,d=v/y.$restTime,x={};x.top=b,x.left=_,x.height=g,x.width=c,x.right=E,x.speed=d,x.distance=v,x.time=y.$restTime,x.mode=y.mode,l.push(x)}),l}getFontSize(l){const{clamp:u}=this.utils,{clientHeight:m}=this.$player;return typeof l=="number"?u(l,12,m):typeof l=="string"&&l.endsWith("%")?u(m*(parseFloat(l)/100),12,m):h.option.fontSize}postMessage(l={}){return new Promise(u=>{if(this.option.useWorker&&this.worker&&this.worker.postMessage)l.id=Date.now(),this.worker.postMessage(l),this.worker.onmessage=m=>{const{data:y}=m;y.id===l.id&&u(y)};else{const m=f.default(l);u({top:m})}})}load(){return er(this,null,function*(){try{let l=[];l=typeof this.option.danmuku=="function"?yield this.option.danmuku():typeof this.option.danmuku.then=="function"?yield this.option.danmuku:typeof this.option.danmuku=="string"?yield a.bilibiliDanmuParseFromUrl(this.option.danmuku):this.option.danmuku,this.utils.errorHandle(Array.isArray(l),"Danmuku need return an array as result"),this.art.emit("artplayerPluginDanmuku:loaded",l),this.queue=[],this.$danmuku.innerText="",l.forEach(u=>this.emit(u))}catch(l){throw this.art.emit("artplayerPluginDanmuku:error",l),l}return this})}config(l){const{clamp:u}=this.utils;return this.option=Object.assign({},h.option,this.option,l),this.validator(this.option,h.scheme),this.option.speed=u(this.option.speed,1,10),this.option.opacity=u(this.option.opacity,0,1),this.option.lockTime=u(Math.floor(this.option.lockTime),0,60),this.option.maxLength=u(this.option.maxLength,0,500),this.option.minWidth=u(this.option.minWidth,0,500),this.option.maxWidth=u(this.option.maxWidth,0,1/0),l.fontSize&&(this.option.fontSize=this.getFontSize(this.option.fontSize),this.reset()),this.art.emit("artplayerPluginDanmuku:config",this.option),this}makeWait(l){l.$state="wait",l.$ref&&(l.$ref.style.visibility="hidden",l.$ref.style.marginLeft="0px",l.$ref.style.transform="translateX(0px)",l.$ref.style.transition="transform 0s linear 0s",this.$refs.push(l.$ref),l.$ref=null)}continue(){const{clientWidth:l}=this.$player;return this.filter("stop",u=>{switch(u.$state="emit",u.$lastStartTime=Date.now(),u.mode){case 0:{const m=l+u.$ref.clientWidth;u.$ref.style.transform=`translateX(${-m}px)`,u.$ref.style.transition=`transform ${u.$restTime}s linear 0s`;break}}}),this}suspend(){const{clientWidth:l}=this.$player;return this.filter("emit",u=>{switch(u.$state="stop",u.mode){case 0:{const m=l-(this.getLeft(u.$ref)-this.getLeft(this.$player));u.$ref.style.transform=`translateX(${-m}px)`,u.$ref.style.transition="transform 0s linear 0s";break}}}),this}reset(){return this.queue.forEach(l=>this.makeWait(l)),this}update(){return this.timer=window.requestAnimationFrame(()=>er(this,null,function*(){if(this.art.playing&&!this.isHide){this.filter("emit",y=>{const b=(Date.now()-y.$lastStartTime)/1e3;y.$restTime-=b,y.$lastStartTime=Date.now(),y.$restTime<=0&&this.makeWait(y)});const l=this.getReady(),{clientWidth:u,clientHeight:m}=this.$player;for(let y=0;y<l.length;y++){const b=l[y];b.$ref=this.getRef(),b.$ref.innerText=b.text,this.$danmuku.appendChild(b.$ref),b.$ref.style.left=`${u}px`,b.$ref.style.opacity=this.option.opacity,b.$ref.style.fontSize=`${this.option.fontSize}px`,b.$ref.style.color=b.color,b.$ref.style.border=b.border?`1px solid ${b.color}`:null,b.$ref.style.backgroundColor=b.border?"rgb(0 0 0 / 50%)":null,b.$ref.style.marginLeft="0px",b.$lastStartTime=Date.now(),b.$restTime=this.option.synchronousPlayback&&this.art.playbackRate?this.option.speed/Number(this.art.playbackRate):this.option.speed;const _={mode:b.mode,height:b.$ref.clientHeight,speed:(u+b.$ref.clientWidth)/b.$restTime},{top:g}=yield this.postMessage({target:_,emits:this.getEmits(),antiOverlap:this.option.antiOverlap,clientWidth:u,clientHeight:m,marginBottom:this.marginBottom,marginTop:this.marginTop});if(b.$ref)if(this.isStop||g===void 0)b.$state="ready",this.$refs.push(b.$ref),b.$ref=null;else switch(b.$state="emit",b.$ref.style.visibility="visible",b.mode){case 0:{b.$ref.style.top=`${g}px`;const c=u+b.$ref.clientWidth;b.$ref.style.transform=`translateX(${-c}px)`,b.$ref.style.transition=`transform ${b.$restTime}s linear 0s`;break}case 1:b.$ref.style.left="50%",b.$ref.style.top=`${g}px`,b.$ref.style.marginLeft=`-${b.$ref.clientWidth/2}px`}}}this.isStop||this.update()})),this}stop(){return this.isStop=!0,this.suspend(),window.cancelAnimationFrame(this.timer),this.art.emit("artplayerPluginDanmuku:stop"),this}start(){return this.isStop=!1,this.continue(),this.update(),this.art.emit("artplayerPluginDanmuku:start"),this}show(){return this.isHide=!1,this.start(),this.$danmuku.style.display="block",this.art.emit("artplayerPluginDanmuku:show"),this}hide(){return this.isHide=!0,this.stop(),this.queue.forEach(l=>this.makeWait(l)),this.$danmuku.style.display="none",this.art.emit("artplayerPluginDanmuku:hide"),this}emit(l){return this.validator(l,{text:"string",mode:"number|undefined",color:"string|undefined",time:"number|undefined",border:"boolean|undefined"}),l.text.trim()&&this.option.filter(l)?(l.time?l.time=this.utils.clamp(l.time,0,1/0):l.time=this.art.currentTime+.5,l.mode===void 0&&(l.mode=this.option.mode),l.color===void 0&&(l.color=this.option.color),this.queue.push(bt(mt({},l),{$state:"wait",$ref:null,$restTime:0,$lastStartTime:0})),this):this}destroy(){this.stop(),this.worker&&this.worker.terminate&&this.worker.terminate(),this.art.off("video:play",this.start),this.art.off("video:playing",this.start),this.art.off("video:pause",this.stop),this.art.off("video:waiting",this.stop),this.art.off("fullscreen",this.reset),this.art.off("fullscreenWeb",this.reset),this.art.off("destroy",this.destroy),this.art.emit("artplayerPluginDanmuku:destroy")}}t.default=h},{"./bilibili":"KnwDr","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY","85d40535eae5f839":"5sXKb","./getDanmuTop":"2Abxf"}],KnwDr:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h){switch(h){case 1:case 2:case 3:default:return 0;case 4:case 5:return 1}}function o(h){if(typeof h!="string")return[];const p=h.matchAll(/<d (?:.*? )??p="(?<p>.+?)"(?: .*?)?>(?<text>.+?)<\/d>/gs);return Array.from(p).map(l=>{const u=l.groups.p.split(",");return u.length===8?{text:l.groups.text.trim().replaceAll("&quot;",'"').replaceAll("&apos;","'").replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),time:Number(u[0]),mode:a(Number(u[1])),fontSize:Number(u[2]),color:`#${Number(u[3]).toString(16)}`,timestamp:Number(u[4]),pool:Number(u[5]),userID:u[6],rowID:Number(u[7])}:null}).filter(l=>l)}function f(h){return fetch(h).then(p=>p.text()).then(p=>o(p))}n.defineInteropFlag(t),n.export(t,"getMode",()=>a),n.export(t,"bilibiliDanmuParseFromXml",()=>o),n.export(t,"bilibiliDanmuParseFromUrl",()=>f)},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],b7MJY:[function(r,i,t){t.interopDefault=function(n){return n&&n.__esModule?n:{default:n}},t.defineInteropFlag=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.exportAll=function(n,a){return Object.keys(n).forEach(function(o){o==="default"||o==="__esModule"||a.hasOwnProperty(o)||Object.defineProperty(a,o,{enumerable:!0,get:function(){return n[o]}})}),a},t.export=function(n,a,o){Object.defineProperty(n,a,{enumerable:!0,get:o})}},{}],"5sXKb":[function(r,i,t){i.exports="data:application/javascript,function%20getDanmuTop%28%7Btarget%3At%2Cemits%3Ae%2CclientWidth%3An%2CclientHeight%3Ai%2CmarginBottom%3As%2CmarginTop%3Ah%2CantiOverlap%3Ao%7D%29%7Bconst%20r%3De.filter%28%28e%3D%3Ee.mode%3D%3D%3Dt.mode%26%26e.top%3C%3Di-s%29%29.sort%28%28%28t%2Ce%29%3D%3Et.top-e.top%29%29%3Bif%280%3D%3D%3Dr.length%29return%20h%3Br.unshift%28%7Btop%3A0%2Cleft%3A0%2Cright%3A0%2Cheight%3Ah%2Cwidth%3An%2Cspeed%3A0%2Cdistance%3An%7D%29%2Cr.push%28%7Btop%3Ai-s%2Cleft%3A0%2Cright%3A0%2Cheight%3As%2Cwidth%3An%2Cspeed%3A0%2Cdistance%3An%7D%29%3Bfor%28let%20e%3D1%3Be%3Cr.length%3Be%2B%3D1%29%7Bconst%20n%3Dr%5Be%5D%2Ci%3Dr%5Be-1%5D%2Cs%3Di.top%2Bi.height%3Bif%28n.top-s%3E%3Dt.height%29return%20s%7Dconst%20p%3D%5B%5D%3Bfor%28let%20t%3D1%3Bt%3Cr.length-1%3Bt%2B%3D1%29%7Bconst%20e%3Dr%5Bt%5D%3Bif%28p.length%29%7Bconst%20t%3Dp%5Bp.length-1%5D%3Bt%5B0%5D.top%3D%3D%3De.top%3Ft.push%28e%29%3Ap.push%28%5Be%5D%29%7Delse%20p.push%28%5Be%5D%29%7Dif%28%21o%29%7Bswitch%28t.mode%29%7Bcase%200%3Ap.sort%28%28%28t%2Ce%29%3D%3E%7Bconst%20n%3DMath.min%28...e.map%28%28t%3D%3Et.right%29%29%29%2Ci%3DMath.min%28...t.map%28%28t%3D%3Et.right%29%29%29%3Breturn%20n%2ae.length-i%2at.length%7D%29%29%3Bbreak%3Bcase%201%3Ap.sort%28%28%28t%2Ce%29%3D%3E%7Bconst%20n%3DMath.max%28...e.map%28%28t%3D%3Et.width%29%29%29%3Breturn%20Math.max%28...t.map%28%28t%3D%3Et.width%29%29%29%2at.length-n%2ae.length%7D%29%29%7Dreturn%20p%5B0%5D%5B0%5D.top%7Dswitch%28t.mode%29%7Bcase%200%3A%7Bconst%20e%3Dp.find%28%28e%3D%3Ee.every%28%28e%3D%3E%7Bif%28n%3Ce.distance%29return%211%3Bif%28t.speed%3Ce.speed%29return%210%3Breturn%20e.right%2F%28t.speed-e.speed%29%3Ee.time%7D%29%29%29%29%3Breturn%20e%26%26e%5B0%5D%3Fe%5B0%5D.top%3Avoid%200%7Dcase%201%3Areturn%7D%7Donmessage%3Dt%3D%3E%7Bconst%7Bdata%3Ae%7D%3Dt%2Cn%3DgetDanmuTop%28e%29%3Bself.postMessage%28%7Btop%3An%2Cid%3Ae.id%7D%29%7D%3B"},{}],"2Abxf":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function({target:n,emits:a,clientWidth:o,clientHeight:f,marginBottom:h,marginTop:p,antiOverlap:l}){const u=a.filter(y=>y.mode===n.mode&&y.top<=f-h).sort((y,b)=>y.top-b.top);if(u.length===0)return p;u.unshift({top:0,left:0,right:0,height:p,width:o,speed:0,distance:o}),u.push({top:f-h,left:0,right:0,height:h,width:o,speed:0,distance:o});for(let y=1;y<u.length;y+=1){const b=u[y],_=u[y-1],g=_.top+_.height;if(b.top-g>=n.height)return g}const m=[];for(let y=1;y<u.length-1;y+=1){const b=u[y];if(m.length){const _=m[m.length-1];_[0].top===b.top?_.push(b):m.push([b])}else m.push([b])}if(!l){switch(n.mode){case 0:m.sort((y,b)=>{const _=Math.min(...b.map(c=>c.right)),g=Math.min(...y.map(c=>c.right));return _*b.length-g*y.length});break;case 1:m.sort((y,b)=>{const _=Math.max(...b.map(g=>g.width));return Math.max(...y.map(g=>g.width))*y.length-_*b.length})}return m[0][0].top}switch(n.mode){case 0:{const y=m.find(b=>b.every(_=>o<_.distance?!1:n.speed<_.speed?!0:_.right/(n.speed-_.speed)>_.time));return y&&y[0]?y[0].top:void 0}case 1:return}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],jAkJm:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("bundle-text:./style.less"),o=n.interopDefault(a),f=r("bundle-text:./img/danmu-on.svg"),h=n.interopDefault(f),p=r("bundle-text:./img/danmu-off.svg"),l=n.interopDefault(p),u=r("bundle-text:./img/danmu-config.svg"),m=n.interopDefault(u),y=r("bundle-text:./img/danmu-style.svg"),b=n.interopDefault(y);if(t.default=function(_,g){const{option:c}=g,{template:{$controlsCenter:v,$player:E},constructor:{utils:{removeClass:d,addClass:x,append:S,setStyle:T,tooltip:w,query:L,inverseClass:I}}}=_;function A(P,M){const N=document.createElement("i");return S(N,P),x(N,"art-icon"),x(N,`art-icon-${M}`),N}const O=A(h.default,"danmu-on"),D=A(l.default,"danmu-off"),R=A(m.default,"danmu-config"),C=A(b.default,"danmu-style");(function(){const P=["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"].map(de=>`<div class="art-danmuku-style-panel-color${c.color===de?" art-current":""}" data-color="${de}" style="background-color:${de}"></div>`),M=S(v,`<div class="art-danmuku-emitter" style="max-width: ${c.maxWidth?`${c.maxWidth}px`:"100%"}"><div class="art-danmuku-left"><div class="art-danmuku-style"><div class="art-danmuku-style-panel"><div class="art-danmuku-style-panel-inner"><div class="art-danmuku-style-panel-title">\u6A21\u5F0F</div><div class="art-danmuku-style-panel-modes"><div class="art-danmuku-style-panel-mode art-current" data-mode="0">\u6EDA\u52A8</div><div class="art-danmuku-style-panel-mode" data-mode="1">\u9759\u6B62</div></div><div class="art-danmuku-style-panel-title">\u989C\u8272</div><div class="art-danmuku-style-panel-colors">${P.join("")}</div></div></div></div><input class="art-danmuku-input" maxlength="${c.maxLength}" placeholder="\u53D1\u4E2A\u5F39\u5E55\u89C1\u8BC1\u5F53\u4E0B" /></div><div class="art-danmuku-send">\u53D1\u9001</div></div>`),N=L(".art-danmuku-style",M),B=L(".art-danmuku-input",M),U=L(".art-danmuku-send",M),F=L(".art-danmuku-style-panel-inner",M),j=L(".art-danmuku-style-panel-modes",M),$=L(".art-danmuku-style-panel-colors",M),G=c.mount||S(E,'<div class="art-layer-danmuku-emitter"></div>');_.option.backdrop&&x(F,"art-backdrop-filter"),c.theme&&x(M,`art-danmuku-theme-${c.theme}`);let Y=null,X=c.mode,ie=c.color;function pe(de){de<=0?(Y=null,U.innerText="\u53D1\u9001",d(U,"art-disabled")):(U.innerText=de,Y=setTimeout(()=>pe(de-1),1e3))}function ue(){const de={mode:X,color:ie,border:!0,text:B.value.trim()};Y===null&&c.beforeEmit(de)&&(B.value="",g.emit(de),x(U,"art-disabled"),pe(c.lockTime),_.emit("artplayerPluginDanmuku:emit",de))}function we(){v.clientWidth<c.minWidth?(S(G,M),T(G,"display","flex"),x(M,"art-danmuku-mount"),c.mount||T(E,"marginBottom","40px")):(S(v,M),T(G,"display","none"),d(M,"art-danmuku-mount"),c.mount||T(E,"marginBottom",null))}S(N,C),_.proxy(U,"click",ue),_.proxy(B,"keypress",de=>{de.key==="Enter"&&(de.preventDefault(),ue())}),_.proxy(j,"click",de=>{const{dataset:oe}=de.target;oe.mode&&(X=Number(oe.mode),I(de.target,"art-current"))}),_.proxy($,"click",de=>{const{dataset:oe}=de.target;oe.color&&(ie=oe.color,I(de.target,"art-current"))}),we(),_.on("resize",we),_.on("destroy",()=>{c.mount&&M.parentElement===c.mount&&c.mount.removeChild(M)})})(),_.controls.add({position:"right",name:"danmuku",click:function(){g.isHide?(g.show(),_.notice.show="\u5F39\u5E55\u663E\u793A",T(O,"display",null),T(D,"display","none")):(g.hide(),_.notice.show="\u5F39\u5E55\u9690\u85CF",T(O,"display","none"),T(D,"display",null))},mounted(P){S(P,O),S(P,D),w(P,"\u5F39\u5E55\u5F00\u5173"),T(D,"display","none")}}),_.setting.add({name:"danmuku",html:"\u5F39\u5E55\u8BBE\u7F6E",tooltip:"\u66F4\u591A",icon:R,selector:[{width:200,html:"\u64AD\u653E\u901F\u5EA6",icon:"",tooltip:"\u9002\u4E2D",selector:[{html:"\u6781\u6162",time:10},{html:"\u8F83\u6162",time:7.5},{default:!0,html:"\u9002\u4E2D",time:5},{html:"\u8F83\u5FEB",time:2.5},{html:"\u6781\u5FEB",time:1}],onSelect:function(P){return g.config({speed:P.time}),P.html}},{width:200,html:"\u5B57\u4F53\u5927\u5C0F",icon:"",tooltip:"\u9002\u4E2D",selector:[{html:"\u6781\u5C0F",fontSize:"4%"},{html:"\u8F83\u5C0F",fontSize:"5%"},{default:!0,html:"\u9002\u4E2D",fontSize:"6%"},{html:"\u8F83\u5927",fontSize:"7%"},{html:"\u6781\u5927",fontSize:"8%"}],onSelect:function(P){return g.config({fontSize:P.fontSize}),P.html}},{width:200,html:"\u4E0D\u900F\u660E\u5EA6",icon:"",tooltip:"100%",selector:[{default:!0,opacity:1,html:"100%"},{opacity:.75,html:"75%"},{opacity:.5,html:"50%"},{opacity:.25,html:"25%"},{opacity:0,html:"0%"}],onSelect:function(P){return g.config({opacity:P.opacity}),P.html}},{width:200,html:"\u663E\u793A\u8303\u56F4",icon:"",tooltip:"3/4",selector:[{html:"1/4",margin:[10,"75%"]},{html:"\u534A\u5C4F",margin:[10,"50%"]},{default:!0,html:"3/4",margin:[10,"25%"]},{html:"\u6EE1\u5C4F",margin:[10,10]}],onSelect:function(P){return g.config({margin:P.margin}),P.html}},{html:"\u5F39\u5E55\u9632\u91CD\u53E0",icon:"",tooltip:c.antiOverlap?"\u5F00\u542F":"\u5173\u95ED",switch:c.antiOverlap,onSwitch:P=>(g.config({antiOverlap:!P.switch}),P.tooltip=P.switch?"\u5173\u95ED":"\u5F00\u542F",!P.switch)},{html:"\u540C\u6B65\u89C6\u9891\u901F\u5EA6",icon:"",tooltip:c.synchronousPlayback?"\u5F00\u542F":"\u5173\u95ED",switch:c.synchronousPlayback,onSwitch:P=>(g.config({synchronousPlayback:!P.switch}),P.tooltip=P.switch?"\u5173\u95ED":"\u5F00\u542F",!P.switch)}]})},typeof document!="undefined"&&!document.getElementById("artplayer-plugin-danmuku")){const _=document.createElement("style");_.id="artplayer-plugin-danmuku",_.textContent=o.default,document.head.appendChild(_)}},{"bundle-text:./img/danmu-on.svg":"6RWYp","bundle-text:./img/danmu-off.svg":"oGdIw","bundle-text:./img/danmu-config.svg":"RQdxd","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY","bundle-text:./style.less":"4DV40","bundle-text:./img/danmu-style.svg":"1PtrH"}],"6RWYp":[function(r,i,t){i.exports='<svg viewBox="0 0 1152 1024" width="22" height="22" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M311.467 661.333c0 4.267-4.267 8.534-8.534 12.8 0 4.267 0 4.267-4.266 8.534h-12.8c-4.267 0-8.534-4.267-17.067-8.534-8.533-8.533-17.067-8.533-25.6-8.533-8.533 0-12.8 4.267-17.067 12.8-4.266 12.8-8.533 21.333-4.266 29.867 4.266 8.533 12.8 17.066 25.6 21.333 17.066 8.533 34.133 17.067 46.933 17.067 12.8 0 21.333-4.267 34.133-8.534 8.534-4.266 17.067-17.066 25.6-29.866 8.534-12.8 12.8-34.134 17.067-55.467 4.267-21.333 4.267-51.2 4.267-85.333 0-12.8 0-21.334-4.267-29.867 0-8.533-4.267-12.8-8.533-17.067-4.267-4.266-8.534-8.533-12.8-8.533-4.267 0-12.8-4.267-21.334-4.267h-55.466s-4.267-4.266 0-8.533l4.266-38.4c0-4.267 0-8.533 4.267-8.533h46.933c17.067 0 25.6-4.267 34.134-12.8 8.533-8.534 12.8-21.334 12.8-42.667v-72.533c0-17.067-4.267-34.134-8.534-42.667-12.8-12.8-25.6-17.067-42.666-17.067H243.2c-8.533 0-17.067 0-21.333 4.267-4.267 8.533-4.267 12.8-4.267 25.6 0 8.533 0 17.067 4.267 21.333 4.266 4.267 12.8 8.534 21.333 8.534h64c4.267 0 8.533 0 8.533 4.266v34.134c0 8.533 0 12.8-4.266 12.8 0 0-4.267 4.266-8.534 4.266H268.8c-8.533 0-12.8 0-21.333 4.267-4.267 0-8.534 4.267-8.534 4.267-4.266 4.266-8.533 12.8-8.533 17.066 0 8.534-4.267 17.067-4.267 25.6l-8.533 72.534v29.866c0 8.534 4.267 12.8 8.533 17.067 4.267 4.267 8.534 4.267 17.067 8.533h68.267c4.266 0 8.533 0 8.533 4.267s4.267 8.533 4.267 17.067c0 21.333 0 42.666-4.267 55.466 0 8.534-4.267 21.334-8.533 25.6zM896 486.4c-93.867 0-174.933 51.2-217.6 123.733H571.733V576H640c21.333 0 34.133-4.267 42.667-12.8 8.533-8.533 12.8-21.333 12.8-42.667V358.4c0-21.333-4.267-34.133-12.8-42.667-8.534-8.533-21.334-12.8-42.667-12.8 0-4.266 4.267-4.266 4.267-8.533-4.267 0-4.267-4.267-4.267-4.267 4.267-12.8 8.533-21.333 4.267-25.6 0-8.533-4.267-12.8-12.8-21.333-8.534-4.267-17.067-4.267-21.334-4.267-8.533 4.267-12.8 8.534-21.333 21.334-4.267 8.533-8.533 12.8-12.8 21.333-4.267 8.533-8.533 12.8-12.8 21.333H512c-4.267-8.533-8.533-17.066-8.533-21.333-4.267-8.533-8.534-12.8-12.8-21.333-4.267-12.8-12.8-17.067-21.334-17.067s-17.066 0-25.6 8.533c-8.533 8.534-12.8 12.8-12.8 21.334s0 17.066 8.534 25.6l4.266 4.266L448 307.2c-17.067 0-29.867 4.267-38.4 12.8-8.533 4.267-12.8 21.333-12.8 38.4v157.867c0 21.333 4.267 34.133 12.8 42.666 8.533 8.534 21.333 12.8 42.667 12.8H512v34.134h-98.133c-12.8 0-21.334 0-25.6 4.266-4.267 4.267-8.534 8.534-8.534 21.334v17.066c0 4.267 4.267 8.534 4.267 8.534 4.267 0 4.267 4.266 8.533 4.266H512V716.8c0 12.8 4.267 21.333 8.533 25.6 4.267 4.267 12.8 8.533 21.334 8.533 12.8 0 21.333-4.266 25.6-8.533 4.266-4.267 4.266-12.8 4.266-25.6v-55.467H652.8c-8.533 25.6-12.8 51.2-12.8 76.8 0 140.8 115.2 256 256 256s256-115.2 256-256S1036.8 486.4 896 486.4zm-328.533-128h55.466c4.267 0 4.267 0 4.267 4.267V409.6h-59.733v-51.2zm0 102.4H627.2V512h-55.467v-51.2zM512 516.267h-55.467v-51.2H512v51.2zm0-102.4h-59.733V362.667H512v51.2zm384 499.2c-93.867 0-170.667-76.8-170.667-170.667S802.133 571.733 896 571.733s170.667 76.8 170.667 170.667S989.867 913.067 896 913.067z"/><path fill="#fff" d="M951.467 669.867 878.933 742.4l-29.866-25.6C832 699.733 806.4 704 789.333 721.067c-17.066 17.066-12.8 42.666 4.267 59.733l59.733 51.2c8.534 8.533 17.067 8.533 29.867 8.533s21.333-4.266 29.867-12.8l102.4-102.4c17.066-17.066 17.066-42.666 0-59.733-21.334-12.8-46.934-12.8-64 4.267zm-371.2 209.066H213.333c-72.533 0-128-55.466-128-119.466V230.4c0-64 55.467-119.467 128-119.467h512c72.534 0 128 55.467 128 119.467v140.8c0 25.6 17.067 42.667 42.667 42.667s42.667-17.067 42.667-42.667V230.4c0-115.2-93.867-204.8-213.334-204.8h-512C93.867 25.6 0 119.467 0 230.4v529.067c0 115.2 93.867 204.8 213.333 204.8h366.934c25.6 0 42.666-17.067 42.666-42.667s-21.333-42.667-42.666-42.667z"/></svg>'},{}],oGdIw:[function(r,i,t){i.exports='<svg viewBox="0 0 1152 1024" width="22" height="22" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M311.296 661.504c0 4.096-4.096 8.704-8.704 12.8 0 4.096 0 4.096-4.096 8.704h-12.8c-4.096 0-8.704-4.096-16.896-8.704-8.704-8.704-16.896-8.704-25.6-8.704s-12.8 4.096-16.896 12.8c-4.096 12.8-8.704 21.504-4.096 29.696 4.096 8.704 12.8 16.896 25.6 21.504 16.896 8.704 34.304 16.896 47.104 16.896 12.8 0 21.504-4.096 34.304-8.704 8.704-4.096 16.896-16.896 25.6-29.696s12.8-34.304 16.896-55.296c4.096-21.504 4.096-51.2 4.096-85.504 0-12.8 0-21.504-4.096-29.696 0-8.704-4.096-12.8-8.704-16.896-4.096-4.096-8.704-8.704-12.8-8.704s-12.8-4.096-21.504-4.096h-55.808s-4.096-4.096 0-8.704l4.096-38.4c0-4.096 0-8.704 4.096-8.704h47.104c16.896 0 25.6-4.096 34.304-12.8s12.8-21.504 12.8-42.496v-72.704c0-16.896-4.096-34.304-8.704-42.496-12.8-12.8-25.6-16.896-42.496-16.896H243.2c-8.704 0-16.896 0-21.504 4.096-4.096 8.704-4.096 12.8-4.096 25.6 0 8.704 0 16.896 4.096 21.504 4.096 4.096 12.8 8.704 21.504 8.704h64c4.096 0 8.704 0 8.704 4.096v34.304c0 8.704 0 12.8-4.096 12.8 0 0-4.096 4.096-8.704 4.096H268.8c-8.704 0-12.8 0-21.504 4.096-4.096 0-8.704 4.096-8.704 4.096-4.096 4.096-8.704 12.8-8.704 16.896 0 8.704-4.096 16.896-4.096 25.6l-8.704 72.704v29.696c0 8.704 4.096 12.8 8.704 16.896s8.704 4.096 16.896 8.704h68.096c4.096 0 8.704 0 8.704 4.096s4.096 8.704 4.096 16.896c0 21.504 0 42.496-4.096 55.296.512 9.216-3.584 22.016-8.192 26.624zM896 486.4c-93.696 0-175.104 51.2-217.6 123.904H571.904V576H640c21.504 0 34.304-4.096 42.496-12.8 8.704-8.704 12.8-21.504 12.8-42.496V358.4c0-21.504-4.096-34.304-12.8-42.496-8.704-8.704-21.504-12.8-42.496-12.8 0-4.096 4.096-4.096 4.096-8.704-4.096 0-4.096-4.096-4.096-4.096 4.096-12.8 8.704-21.504 4.096-25.6 0-8.704-4.096-12.8-12.8-21.504-8.704-4.096-16.896-4.096-21.504-4.096-8.704 4.096-12.8 8.704-21.504 21.504-4.096 8.704-8.704 12.8-12.8 21.504s-8.704 12.8-12.8 21.504h-51.2c-4.096-8.704-8.704-16.896-8.704-21.504-4.096-8.704-8.704-12.8-12.8-21.504-4.096-12.8-12.8-16.896-21.504-16.896s-16.896 0-25.6 8.704-12.8 12.8-12.8 21.504 0 16.896 8.704 25.6l4.096 4.096 4.096 4.096c-16.896 0-29.696 4.096-38.4 12.8-8.704 4.096-12.8 21.504-12.8 38.4v157.696c0 21.504 4.096 34.304 12.8 42.496 8.704 8.704 21.504 12.8 42.496 12.8H512v34.304h-98.304c-12.8 0-21.504 0-25.6 4.096s-8.704 8.704-8.704 21.504v16.896c0 4.096 4.096 8.704 4.096 8.704 4.096 0 4.096 4.096 8.704 4.096H512V716.8c0 12.8 4.096 21.504 8.704 25.6 4.096 4.096 12.8 8.704 21.504 8.704 12.8 0 21.504-4.096 25.6-8.704 4.096-4.096 4.096-12.8 4.096-25.6v-55.296H652.8c-8.704 25.6-12.8 51.2-12.8 76.8 0 140.8 115.2 256 256 256s256-115.2 256-256S1036.8 486.4 896 486.4zm-328.704-128h55.296c4.096 0 4.096 0 4.096 4.096V409.6h-59.904v-51.2zm0 102.4H627.2V512h-55.296v-51.2h-4.608zM512 516.096h-55.296v-51.2H512v51.2zm0-102.4h-59.904v-51.2H512v51.2zm384 499.2c-93.696 0-170.496-76.8-170.496-170.496S802.304 571.904 896 571.904s170.496 76.8 170.496 170.496S989.696 912.896 896 912.896z"/><path fill="#fff" d="M580.096 879.104H213.504c-72.704 0-128-55.296-128-119.296V230.4c0-64 55.296-119.296 128-119.296h512c72.704 0 128 55.296 128 119.296v140.8c0 25.6 16.896 42.496 42.496 42.496s42.496-16.896 42.496-42.496V230.4c0-115.2-93.696-204.8-213.504-204.8h-512C93.696 25.6 0 119.296 0 230.4v528.896c0 115.2 93.696 204.8 213.504 204.8h367.104c25.6 0 42.496-16.896 42.496-42.496s-21.504-42.496-43.008-42.496zm171.52 10.752c-15.36-15.36-15.36-40.96 0-56.32l237.568-237.568c15.36-15.36 40.96-15.36 56.32 0s15.36 40.96 0 56.32L807.936 889.856c-15.36 15.36-40.448 15.36-56.32 0z"/></svg>'},{}],RQdxd:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><path d="M16.5 8c1.289 0 2.49.375 3.5 1.022V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7.022A6.5 6.5 0 0 1 16.5 8zM7 13H5a1 1 0 0 1 0-2h2a1 1 0 0 1 0 2zm2-4H5a1 1 0 0 1 0-2h4a1 1 0 0 1 0 2z"/><path d="m20.587 13.696-.787-.131a3.503 3.503 0 0 0-.593-1.051l.301-.804a.46.46 0 0 0-.21-.56l-1.005-.581a.52.52 0 0 0-.656.113l-.499.607a3.53 3.53 0 0 0-1.276 0l-.499-.607a.52.52 0 0 0-.656-.113l-1.005.581a.46.46 0 0 0-.21.56l.301.804c-.254.31-.456.665-.593 1.051l-.787.131a.48.48 0 0 0-.413.465v1.209a.48.48 0 0 0 .413.465l.811.135c.144.382.353.733.614 1.038l-.292.78a.46.46 0 0 0 .21.56l1.005.581a.52.52 0 0 0 .656-.113l.515-.626a3.549 3.549 0 0 0 1.136 0l.515.626a.52.52 0 0 0 .656.113l1.005-.581a.46.46 0 0 0 .21-.56l-.292-.78c.261-.305.47-.656.614-1.038l.811-.135A.48.48 0 0 0 21 15.37v-1.209a.48.48 0 0 0-.413-.465zM16.5 16.057a1.29 1.29 0 1 1 .002-2.582 1.29 1.29 0 0 1-.002 2.582z"/></svg>'},{}],"4DV40":[function(r,i,t){i.exports='.art-danmuku-emitter{height:32px;width:100%;max-width:100%;color:#fff;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#ffffff4d;border-radius:3px;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:12px;line-height:1;display:flex;position:relative}.art-danmuku-emitter *,.art-danmuku-emitter :before,.art-danmuku-emitter :after{box-sizing:border-box;margin:0;padding:0}.art-danmuku-emitter .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-danmuku-emitter .art-icon svg{fill:#fff}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-danmuku-emitter .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-danmuku-emitter .art-danmuku-left{border-radius:3px 0 0 3px;flex:1;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style{width:32px;justify-content:center;align-items:center;display:flex;position:relative}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel{z-index:999;width:200px;padding-bottom:10px;display:none;position:absolute;bottom:30px;left:-85px}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner{background-color:#000000e6;border-radius:3px;flex-direction:column;padding:10px 10px 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-title{margin-bottom:10px;font-size:13px}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes{justify-content:space-between;margin-bottom:15px;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes .art-danmuku-style-panel-mode{width:47%;cursor:pointer;color:#fff;border:1px solid #fff;justify-content:center;padding:5px 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes .art-danmuku-style-panel-mode.art-current{background-color:#00a1d6;border:1px solid #00a1d6}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors{flex-wrap:wrap;justify-content:space-between;gap:5px;margin-bottom:10px;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color{cursor:pointer;width:20px;height:20px;border:1px solid #fff}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color.art-current{position:relative;box-shadow:0 0 2px #fff}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color.art-current:before{content:"";width:100%;height:100%;border:2px solid #000;position:absolute;inset:0}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style:hover .art-danmuku-style-panel{display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-icon{opacity:.75;cursor:pointer}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-icon:hover{opacity:1}.art-danmuku-emitter .art-danmuku-left .art-danmuku-input{width:100%;color:#fff;background-color:#0000;border:0;outline:0;flex:1;padding:0 10px 0 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-input::placeholder,.art-danmuku-emitter .art-danmuku-left .art-danmuku-input::-webkit-input-placeholder{color:#ffffff80}.art-danmuku-emitter .art-danmuku-send{width:50px;cursor:pointer;background-color:#00a1d6;border-radius:0 3px 3px 0;justify-content:center;align-items:center;display:flex}.art-danmuku-emitter .art-danmuku-send:hover{background-color:#00b5e5}.art-danmuku-emitter .art-danmuku-send.art-disabled{opacity:.5;pointer-events:none}.art-danmuku-emitter.art-danmuku-mount{height:34px;max-width:100%!important}.art-danmuku-emitter.art-danmuku-mount .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel{left:0}.art-danmuku-emitter.art-danmuku-mount .art-danmuku-send{width:60px}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left{background:#f4f4f4;border:1px solid #dadada}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-style .art-icon svg{fill:#666}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input{color:#000}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input::placeholder,.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input::-webkit-input-placeholder{color:#00000080}.art-layer-danmuku-emitter{z-index:99;width:100%;position:absolute;bottom:-40px;left:0;right:0}'},{}],"1PtrH":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><path d="M17 16H5c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1zM6.96 15c.39 0 .74-.24.89-.6l.65-1.6h5l.66 1.6c.15.36.5.6.89.6.69 0 1.15-.71.88-1.34l-3.88-8.97C11.87 4.27 11.46 4 11 4s-.87.27-1.05.69l-3.88 8.97c-.27.63.2 1.34.89 1.34zM11 5.98 12.87 11H9.13L11 5.98z"/></svg>'},{}]},["E13ST"],"E13ST")})(Ch);var US=Ca(Ch.exports);const Ph=3,jS=["m3u8"],WS=({file:s})=>{const{getSetting:e,lastFiles:r}=Ye.exports.useContext($r),i=r.filter(u=>u.type===Ph),{i18n:t}=kn();let n=ui(),a=n();const o=pp(!0),f=a,h=rp();let p;const l=hu({base:"30px",md:"50px"});return Ye.exports.useEffect(()=>{let u={container:"#video-player",title:s.name,url:f,autoplay:e("autoplay video")==="true",autoMini:!0,autoSize:!1,playbackRate:!0,flip:!0,rotate:!0,aspectRatio:!0,fullscreen:!0,fullscreenWeb:!0,mutex:!0,light:!0,backdrop:!0,subtitleOffset:!0,miniProgressBar:!0,localVideo:!0,localSubtitle:!0,lang:t.language==="zh"?"zh-cn":"en",setting:!0,pip:!0,customType:{flv:function(c,v){const E=NS.createPlayer({type:"flv",url:v},{referrerPolicy:"no-referrer"});E.attachMediaElement(c),E.load()},m3u8:function(c,v){var E=new BS;E.loadSource(v),E.attachMedia(c)}},moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0}};s.name.toLowerCase().endsWith(".flv")&&(u.type="flv"),e("artplayer whitelist")?u.whitelist=e("artplayer whitelist").split(","):u.whitelist=[],!FS||u.whitelist.some(c=>c==="*"||La.indexOf(c)>-1)||(u.moreVideoAttr.controls=!0),e("artplayer autoSize")==="true"&&(u.autoSize=!0);const y=s.name.substring(0,s.name.lastIndexOf("."));let b="";const _=r.find(c=>{const v=c.name;if(!v.startsWith(y))return!1;for(const E of[".srt",".ass",".vtt"])if(v.endsWith(E))return!0;return!1});_&&(o+""+_.name,u.subtitle={type:b,url:n(_),bilingual:!0,style:{color:"#03A9F4","font-size":l}});const g=r.find(c=>{const v=c.name;if(!v.startsWith(y))return!1;for(const E of["xml"])if(v.endsWith(E))return!0;return!1});return g&&(u.plugins=[US({danmuku:n(g),speed:5,opacity:1,fontSize:25,color:"#FFFFFF",mode:0,margin:[0,"0%"],antiOverlap:!1,useWorker:!0,synchronousPlayback:!1,lockTime:5,maxLength:100,minWidth:200,maxWidth:400,theme:"dark"})]),p=new kS(u),p.on("video:ended",()=>{const c=i.findIndex(v=>v.name===s.name);c<i.length-1&&h.push(encodeURI(i[c+1].name))}),()=>{p&&p.destroy&&p.destroy()}},[]),q.createElement(Xi,{w:"full",className:"video-preview-box"},q.createElement(ip,null,q.createElement(np,{rightIcon:q.createElement(Nn,{boxSize:6,as:hp}),w:"full",colorScheme:"gray",as:_r,mb:2},q.createElement(ap,{w:"full",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},s.name)),q.createElement(sp,{w:"full",maxH:"65vh",overflowY:"auto",zIndex:999},i.map(u=>q.createElement(op,{key:u.name,w:"full"},q.createElement(xo,{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxW:"85vw",w:"full",as:lp,_hover:{textDecoration:"none"},to:encodeURI(u.name)},u.name))))),q.createElement(Xi,{w:"full",h:"60vh",id:"video-player"}),q.createElement(up,{mt:"2",spacing:"2",justify:"center"},q.createElement(_r,{colorScheme:"purple",as:Qi.a,href:`iina://weblink?url=${a}`},"IINA"),q.createElement(_r,{colorScheme:"yellow",as:Qi.a,href:`potplayer://${a}`},"PotPlayer"),q.createElement(_r,{colorScheme:"orange",as:Qi.a,href:`vlc://${a}`},"VLC"),q.createElement(_r,{colorScheme:"teal",as:Qi.a,href:`nplayer-${a}`},"nPlayer"),q.createElement(_r,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.ad;S.title=${s.name};end`},"MXPlayer"),q.createElement(_r,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.pro;S.title=${s.name};end`},"MXPlayer Pro")))};var zS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:Ph,exts:jS,default:WS});const Mh={"../preview/audio.tsx":K0,"../preview/codeeditor.tsx":vp,"../preview/epub.tsx":pS,"../preview/image.tsx":yS,"../preview/ipa.tsx":SS,"../preview/markdown.tsx":mp,"../preview/office.tsx":IS,"../preview/pdf.tsx":AS,"../preview/plist.tsx":MS,"../preview/video.tsx":zS},$S=({file:s})=>{const{getSetting:e}=Ye.exports.useContext($r),r=s.name.split(".").pop()||"",i=ui(),{t}=kn();return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ra,{size:"md"},s.name),q.createElement(_r,{onClick:()=>{window.open(i(),"_blank")}},t("Download"))))},qS=()=>{const{files:s}=Ye.exports.useContext($r);gp(s[0].name);for(const e in Mh){const r=Mh[e],i=r.default;if(r.type===s[0].type||r.exts.includes(s[0].name.split(".").pop()))return q.createElement(i,{file:s[0]})}return q.createElement($S,{file:s[0]})};export{qS as default};

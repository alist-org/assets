var Me=Object.defineProperty;var ce=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var ie=(e,a,r)=>a in e?Me(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,q=(e,a)=>{for(var r in a||(a={}))ze.call(a,r)&&ie(e,r,a[r]);if(ce)for(var r of ce(a))Ie.call(a,r)&&ie(e,r,a[r]);return e};var ue=(e,a,r)=>new Promise((n,l)=>{var s=d=>{try{i(r.next(d))}catch(c){l(c)}},u=d=>{try{i(r.throw(d))}catch(c){l(c)}},i=d=>d.done?n(d.value):Promise.resolve(d.value).then(s,u);i((r=r.apply(e,a)).next())});import{r as o,u as I,h as V,j as k,k as de,l as W,R as t,n as S,I as G,H as J,P as Ae,o as pe,p as A,q as L,s as R,F as X,L as P,t as Le,v as N,x as Re,C as H,V as Y,y as me,z as Pe,A as ge,D as fe,E as $,G as Z,J as He,K as Te,M as De,N as Ne,O as $e,Q as Ue,U as je,W as Oe,X as Ve,Y as We,Z as Ke,_ as qe}from"./vendor.03ff3900.js";import{a as he,i as Q,b as U,I as y,G as b,M as Ge,B as Je,c as Xe,d as Ye,F as Ze,g as Qe,e as et,f as tt,h as at,j as rt,k as nt,l as xe,m as st,n as lt,o as ot,p as ct,q as it,r as ut,s as dt,D as pt,t as mt,u as gt,v as ft,w as ht,O as xt,x as Et}from"./index.esm.ef5c8b53.js";import{_ as Ee}from"./index.78f9d4ac.js";import{c as wt}from"./copy-clip.08e8f9de.js";const we=(...e)=>e.join("/").replace(/\/{2,}/g,"/");let ee;const yt=he.CancelToken,bt=()=>{const{password:e,page:a}=o.exports.useContext(y),{pathname:r}=I();let n=r;return{path:()=>Q.post("path",{path:n,password:e,page_num:a.page_num,page_size:a.page_size},{cancelToken:new yt(function(s){ee=s})}),cancelPath:()=>{ee&&ee()},mkdir:l=>{const s=we(n,l);return U.post("mkdir",{path:s})},rename:(l,s)=>{const u=we(n,s);return U.post("rename",{name:l,path:u})},move:(l,s)=>U.post("move",{src_dir:n,dst_dir:s,names:l}),copy:(l,s)=>U.post("copy",{src_dir:n,dst_dir:s,names:l}),refresh:()=>U.post("refresh",{path:n})}};function Ft(e){return b({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M352 115h90c3.3 0 6-2.7 6-6 0-8.2-3.7-16-10-21.3l-77.1-64.2c-4.9-4.1-14.2-7.4-20.6-7.4-4.1 0-7.4 3.3-7.4 7.4V96c.1 10.5 8.6 19 19.1 19z"}},{tag:"path",attr:{d:"M307 96V16H176c-17.6 0-32 14.4-32 32v336c0 17.6 14.4 32 32 32h240c17.6 0 32-14.4 32-32V141h-96c-24.8 0-45-20.2-45-45z"}},{tag:"path",attr:{d:"M116 412V80H96c-17.6 0-32 14.4-32 32v352c0 17.6 14.4 32 32 32h256c17.6 0 32-14.4 32-32v-20H148c-17.6 0-32-14.4-32-32z"}}]})(e)}function Ct(e){return b({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M480 119c0-13.3-9.4-23-22.8-23H198.9c-2.8 0-4.3-.6-6.1-2.4l-22.5-22.5-.2-.2c-4.9-4.6-8.9-6.9-17.3-6.9H56.7C42.9 64 32 74.3 32 87v73.7c0 1.6 1.7 1.5 3 .7s5-1.4 7-1.4h428c2 0 5.7.6 7 1.4 1.3.8 3 .9 3-.7V119zM32 416.4c0 17.5 14.2 31.6 31.6 31.6H448c17.6 0 32-14.4 32-32V204c0-8.8-7.2-16-16-16H48c-8.8 0-16 7.2-16 16v212.4z"}}]})(e)}const vt=(e=!1)=>{const{type:a}=o.exports.useContext(y);let{pathname:r}=I(),n="/";n==="/"&&(n=window.location.origin+"/");let l=r.endsWith("/")?r.slice(0,-1):r;return a==="file"&&(l=l.substring(0,l.lastIndexOf("/"))),e?`${n}p${l}`:`${n}d${l}`},kt=e=>Ge.hashStr(e),ye=e=>kt(e).slice(8,24),St=()=>{const{getSetting:e,password:a,loggedIn:r}=o.exports.useContext(y);return(n,l=!0)=>{const s=l?encodeURI(n):n;if(e("check down link")!=="true")return s;const u=n.split("/").pop(),i=localStorage.getItem("admin-token");if(r){const c=ye(`alist-${i}-${u}`);return s+(l?encodeURI(`?sign=${c}`):`?sign=${c}`)}if(!a)return s;const d=ye(`alist-${a}-${u}`);return s+(l?encodeURI(`?pw=${d}`):`?pw=${d}`)}},be=(e=!1,a=!0)=>{const r=vt(e),n=St(),{files:l}=o.exports.useContext(y);return(s=void 0)=>{s||(s=l[0]);let u=r;return u.endsWith(s.name)||(u=`${u}/${s.name}`),n(u,a)}};function _t(e){return{all:e=e||new Map,on:function(a,r){var n=e.get(a);n?n.push(r):e.set(a,[r])},off:function(a,r){var n=e.get(a);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(a,[]))},emit:function(a,r){var n=e.get(a);n&&n.slice().map(function(l){l(r)}),(n=e.get("*"))&&n.slice().map(function(l){l(a,r)})}}}const te=_t();function Fe(e){if(!e)return"-";const a=1024;return e<a?e+"B":e<Math.pow(a,2)?(e/a).toFixed(2)+"K":e<Math.pow(a,3)?(e/Math.pow(a,2)).toFixed(2)+"M":e<Math.pow(a,4)?(e/Math.pow(a,3)).toFixed(2)+"G":(e/Math.pow(a,4)).toFixed(2)+"T"}const Ce=(...e)=>e.join("/").replace(/\/{2,}/g,"/");let ve=new Date().valueOf(),ke=0;const Bt=o.exports.forwardRef((e,a)=>{o.exports.useImperativeHandle(a,()=>({upload:()=>{u(0),document.querySelector("#upload-input").click()}}));const{password:r}=o.exports.useContext(y),{pathname:n}=I(),l=V(),[s,u]=o.exports.useState(50),{t:i}=k(),{isOpen:d,onOpen:c,onClose:m}=de(),E=W("gray.100","gray.600"),[F,h]=o.exports.useState("Uploading");return t.createElement(S,null,t.createElement(G,{display:"none",type:"file",multiple:!0,id:"upload-input",onChange:g=>{const C=g.target.files,_=C[0];if(!C||!_)return;c();const w=new FormData;for(let p=0;p<C.length;p++)w.append("files",C[p],C[p].name);w.append("path",n),w.append("password",r),Q.post("upload",w,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:p=>{if(p.lengthComputable){const v=p.loaded/p.total*100|0;console.log("complete",v),u(v);const M=new Date().valueOf(),j=(M-ve)/1e3;if(j>1){const D=(p.loaded-ke)/j,z=(p.total-p.loaded)/D;h(`${Fe(D)}/s  (${i("about remaining")} ${Math.round(z)}${i("s")})`),ve=M,ke=p.loaded}v===100&&h("Back-end processing")}}}).then(p=>{m();const v=document.querySelector("#upload-input");v.value="";const M=p.data;l({title:i(M.message),status:M.code===200?"success":"error",duration:3e3,isClosable:!0}),te.emit("refresh")})}}),t.createElement(S,{zIndex:99,w:{base:"80vw",md:"40vw"},position:"fixed",bottom:"20px",right:"20px",bgColor:E,rounded:"lg",p:4,display:d?"block":"none"},t.createElement(J,{mb:2,fontSize:20},i(F),"..."),t.createElement(Ae,{hasStripe:!0,isAnimated:!0,rounded:"lg",value:s})))});function Qt(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#546E7A",points:"38,33 38,5 34,5 34,33 28,33 36,43 44,33"}},{tag:"g",attr:{fill:"#2196F3"},child:[{tag:"path",attr:{d:"M16.8,17.2h-5.3l-1.1,3H6.9L12.6,5h2.9l5.7,15.2h-3.2L16.8,17.2z M12.2,14.5H16l-1.9-5.7L12.2,14.5z"}},{tag:"path",attr:{d:"M12.4,40.5H20V43H8.4v-1.9L16,30.3H8.4v-2.5h11.4v1.7L12.4,40.5z"}}]}]})(e)}function ea(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#00ACC1",cx:"24",cy:"24",r:"20"}},{tag:"circle",attr:{fill:"#eee",cx:"24",cy:"24",r:"16"}},{tag:"rect",attr:{x:"23",y:"11",width:"2",height:"13"}},{tag:"rect",attr:{x:"26.1",y:"22.7",transform:"matrix(-.707 .707 -.707 -.707 65.787 27.25)",width:"2.3",height:"9.2"}},{tag:"circle",attr:{cx:"24",cy:"24",r:"2"}},{tag:"circle",attr:{fill:"#00ACC1",cx:"24",cy:"24",r:"1"}}]})(e)}function ta(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#B3E5FC",cx:"24",cy:"30",r:"15"}},{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"polygon",attr:{points:"24,38.7 15,28 33,28"}},{tag:"rect",attr:{x:"21",y:"5",width:"6",height:"26"}}]}]})(e)}function aa(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#1976D2"},child:[{tag:"path",attr:{d:"M38,13h-3c-5.5,0-10,4.5-10,10s4.5,10,10,10h3c5.5,0,10-4.5,10-10S43.5,13,38,13z M38,29h-3 c-3.3,0-6-2.7-6-6s2.7-6,6-6h3c3.3,0,6,2.7,6,6S41.3,29,38,29z"}},{tag:"path",attr:{d:"M13,13h-3C4.5,13,0,17.5,0,23s4.5,10,10,10h3c5.5,0,10-4.5,10-10S18.5,13,13,13z M13,29h-3 c-3.3,0-6-2.7-6-6s2.7-6,6-6h3c3.3,0,6,2.7,6,6S16.3,29,13,29z"}}]},{tag:"path",attr:{fill:"#42A5F5",d:"M33,21H15c-1.1,0-2,0.9-2,2s0.9,2,2,2h18c1.1,0,2-0.9,2-2S34.1,21,33,21z"}}]})(e)}function ra(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#546E7A",points:"38,33 38,5 34,5 34,33 28,33 36,43 44,33"}},{tag:"g",attr:{fill:"#2196F3"},child:[{tag:"path",attr:{d:"M16.4,20h-3V8.6L9.9,9.7V7.3L16,5.1h0.3V20z"}},{tag:"path",attr:{d:"M19.4,43H9.2v-2l4.8-5.1c0.4-0.4,0.7-0.8,0.9-1.1c0.2-0.3,0.5-0.6,0.6-0.9c0.2-0.3,0.3-0.5,0.3-0.8 c0.1-0.2,0.1-0.5,0.1-0.7c0-0.7-0.2-1.2-0.5-1.6c-0.3-0.4-0.8-0.6-1.4-0.6c-0.3,0-0.7,0.1-0.9,0.2c-0.3,0.1-0.5,0.3-0.7,0.5 c-0.2,0.2-0.3,0.5-0.4,0.8s-0.1,0.6-0.1,1h-3c0-0.7,0.1-1.3,0.4-1.9c0.2-0.6,0.6-1.1,1-1.6c0.5-0.4,1-0.8,1.6-1.1 c0.6-0.3,1.4-0.4,2.2-0.4c0.8,0,1.5,0.1,2.1,0.3c0.6,0.2,1.1,0.5,1.5,0.8s0.7,0.8,0.9,1.3s0.3,1.1,0.3,1.8c0,0.5-0.1,1-0.2,1.4 S18.3,34.5,18,35s-0.6,0.9-1,1.4c-0.4,0.5-0.9,1-1.4,1.5L13,40.6h6.4V43z"}}]}]})(e)}function na(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#4CAF50",cx:"24",cy:"24",r:"21"}},{tag:"g",attr:{fill:"#fff"},child:[{tag:"rect",attr:{x:"21",y:"14",width:"6",height:"20"}},{tag:"rect",attr:{x:"14",y:"21",width:"20",height:"6"}}]}]})(e)}function sa(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"path",attr:{d:"M13,13c0-3.3,2.7-6,6-6h10c3.3,0,6,2.7,6,6h4c0-5.5-4.5-10-10-10H19C13.5,3,9,7.5,9,13v11.2h4V13z"}},{tag:"polygon",attr:{points:"4.6,22 11,30.4 17.4,22"}}]},{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"path",attr:{d:"M35,35c0,3.3-2.7,6-6,6H19c-3.3,0-6-2.7-6-6H9c0,5.5,4.5,10,10,10h10c5.5,0,10-4.5,10-10V23h-4V35z"}},{tag:"polygon",attr:{points:"30.6,26 37,17.6 43.4,26"}}]}]})(e)}function Mt(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#616161"},child:[{tag:"rect",attr:{x:"34.6",y:"28.1",transform:"matrix(.707 -.707 .707 .707 -15.154 36.586)",width:"4",height:"17"}},{tag:"circle",attr:{cx:"20",cy:"20",r:"16"}}]},{tag:"rect",attr:{x:"36.2",y:"32.1",transform:"matrix(.707 -.707 .707 .707 -15.839 38.239)",fill:"#37474F",width:"4",height:"12.3"}},{tag:"circle",attr:{fill:"#64B5F6",cx:"20",cy:"20",r:"13"}},{tag:"path",attr:{fill:"#BBDEFB",d:"M26.9,14.2c-1.7-2-4.2-3.2-6.9-3.2s-5.2,1.2-6.9,3.2c-0.4,0.4-0.3,1.1,0.1,1.4c0.4,0.4,1.1,0.3,1.4-0.1 C16,13.9,17.9,13,20,13s4,0.9,5.4,2.5c0.2,0.2,0.5,0.4,0.8,0.4c0.2,0,0.5-0.1,0.6-0.2C27.2,15.3,27.2,14.6,26.9,14.2z"}}]})(e)}function la(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#607D8B",d:"M44.7,11L36,19.6c0,0-2.6,0-5.2-2.6s-2.6-5.2-2.6-5.2l8.7-8.7c-4.9-1.2-10.8,0.4-14.4,4 c-5.4,5.4-0.6,12.3-2,13.7C12.9,28.7,5.1,34.7,4.9,35c-2.3,2.3-2.4,6-0.2,8.2c2.2,2.2,5.9,2.1,8.2-0.2c0.3-0.3,6.7-8.4,14.2-15.9 c1.4-1.4,8,3.7,13.6-1.8C44.2,21.7,45.9,15.9,44.7,11z M9.4,41.1c-1.4,0-2.5-1.1-2.5-2.5C6.9,37.1,8,36,9.4,36 c1.4,0,2.5,1.1,2.5,2.5C11.9,39.9,10.8,41.1,9.4,41.1z"}}]})(e)}function oa(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FF6F00",d:"M38.7,11.9l-3.1,2.5c2.2,2.7,3.4,6.1,3.4,9.5c0,8.3-6.7,15-15,15c-0.9,0-1.9-0.1-2.8-0.3l-0.7,3.9 c1.2,0.2,2.4,0.3,3.5,0.3c10.5,0,19-8.5,19-19C43,19.6,41.5,15.3,38.7,11.9z"}},{tag:"polygon",attr:{fill:"#FF6F02",points:"31,8 42.9,9.6 33.1,19.4"}},{tag:"path",attr:{fill:"#FF6F00",d:"M24,5C13.5,5,5,13.5,5,24c0,4.6,1.6,9,4.6,12.4l3-2.6C10.3,31.1,9,27.6,9,24c0-8.3,6.7-15,15-15 c0.9,0,1.9,0.1,2.8,0.3l0.7-3.9C26.4,5.1,25.2,5,24,5z"}},{tag:"polygon",attr:{fill:"#FF6F02",points:"17,40 5.1,38.4 14.9,28.6"}}]})(e)}function ca(e){return b({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#3F51B5"},child:[{tag:"polygon",attr:{points:"17.8,18.1 10.4,25.4 6.2,21.3 4,23.5 10.4,29.9 20,20.3"}},{tag:"polygon",attr:{points:"17.8,5.1 10.4,12.4 6.2,8.3 4,10.5 10.4,16.9 20,7.3"}},{tag:"polygon",attr:{points:"17.8,31.1 10.4,38.4 6.2,34.3 4,36.5 10.4,42.9 20,33.3"}}]},{tag:"g",attr:{fill:"#90CAF9"},child:[{tag:"rect",attr:{x:"24",y:"22",width:"20",height:"4"}},{tag:"rect",attr:{x:"24",y:"9",width:"20",height:"4"}},{tag:"rect",attr:{x:"24",y:"35",width:"20",height:"4"}}]}]})(e)}const zt=e=>{const a=o.exports.useRef(null),{t:r}=k();o.exports.useContext(y);const[n,l]=o.exports.useState(""),s=()=>{u.push(`?s=${n}`)},u=pe();return o.exports.useEffect(()=>{var c;e.isSearch&&((c=a.current)==null||c.focus());const i=m=>{["f","F"].includes(m.key)&&m.ctrlKey&&(e.setIsSearch(!e.isSearch),m.preventDefault())};document.addEventListener("keydown",i);const d=m=>{e.setIsSearch(!1)};return document.addEventListener("click",d),()=>{document.removeEventListener("keydown",i),document.removeEventListener("click",d)}},[e.isSearch]),t.createElement(A,{spacing:2,onClick:i=>{i.stopPropagation()}},t.createElement(G,{display:e.isSearch?"block":"none",value:n,onKeyUp:i=>{i.key==="Enter"&&s()},onChange:i=>{l(i.target.value)},ref:a}),t.createElement(L,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:r("Search files")},t.createElement(R,{boxSize:7,cursor:"pointer",onClick:()=>{e.isSearch?s():e.setIsSearch(!0)},as:Mt})))},It=()=>{const{t:e}=k(),a=be(),r=V(),{show:n,setShow:l,type:s,getSetting:u,files:i,multiSelect:d,selectFiles:c,meta:m,loggedIn:E}=o.exports.useContext(y),F=u("logo"),h=W(F.split(",").shift(),F.split(",").pop()),g=o.exports.useRef(null),[C,_]=o.exports.useState(!1);return t.createElement(X,{className:"header",px:"2",py:"2",justify:"space-between",w:"full"},t.createElement(P,{to:"/",className:"logo"},h.includes("http")?t.createElement(Le,{fallback:t.createElement(N,{color:u("icon color")||"#1890ff"}),rounded:"lg",h:"44px",w:"auto",src:h}):t.createElement(J,null,h)),t.createElement(A,{className:"buttons",spacing:"2"},["folder","search"].includes(s)&&t.createElement(zt,{isSearch:C,setIsSearch:_}),!C&&t.createElement(Re,{in:!C,offsetX:"20px",offsetY:0},t.createElement(A,{spacing:"2"},s==="file"&&t.createElement(L,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Download")},t.createElement(R,{cursor:"pointer",boxSize:6,as:Je,onClick:()=>{if(s==="file"){let w=a();window.open(w,"_blank");return}}})),s==="folder"&&!u("no upload").split(",").includes(m.driver)&&(m.upload||E)&&t.createElement(S,null,t.createElement(L,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Upload file")},t.createElement(R,{cursor:"pointer",boxSize:6,as:Xe,onClick:()=>{g.current.upload()}})),t.createElement(Bt,{ref:g})),s!=="error"&&t.createElement(L,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Copy direct link")},t.createElement(R,{cursor:"pointer",boxSize:6,as:Ft,onClick:()=>{let w="";if(s==="file")w=a();else{let p=i;d&&(p=c),w=p.filter(v=>v.type!==1).map(v=>a(v)).join(`
`)}wt(w),r({title:e("Copied"),status:"success",duration:3e3,isClosable:!0})}})),t.createElement(L,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("switch to layout view",{layout:e(n==="list"?"grid":"list")})},t.createElement(R,{boxSize:6,cursor:"pointer",onClick:()=>{l(n==="list"?"grid":"list"),localStorage.setItem("show",n==="list"?"grid":"list")},as:n==="list"?Ye:Ze}))))))},At=()=>{const{t:e}=k(),{getSetting:a}=o.exports.useContext(y);return t.createElement(H,{py:"4",className:"footer"},t.createElement(Y,null,t.createElement(A,{spacing:"2",className:"line0"},t.createElement(me,{isExternal:!0,href:"https://github.com/Xhofe/alist"},e("Powered by {{project}}",{project:"Alist"})),t.createElement("span",null,"|"),t.createElement(P,{to:"/@manage"},e("Manage"))),a("site beian")&&t.createElement(me,{className:"line1",isExternal:!0,href:"https://beian.miit.gov.cn/"},a("site beian"))))},Lt=()=>{const e=I(),{t:a}=k();return t.createElement(Pe,{spacing:"1",className:"nav",w:"full",px:"2"},t.createElement(ge,null,t.createElement(fe,{_hover:{textDecoration:"none",bg:"rgba(132,133,141,0.18)"},p:"1",rounded:"lg",as:P,to:"/"},Qe("home emoji"),a("Home"))),e.pathname.slice(1).split("/").map((r,n)=>{const l=n===e.pathname.split("/").length-2,s=e.pathname.split("/").slice(0,n+2).join("/");return t.createElement(ge,{key:s,isCurrentPage:l},t.createElement(fe,{isCurrentPage:l,wordBreak:"break-word",as:l?void 0:P,to:encodeURI(s),_hover:{textDecoration:"none",bg:"rgba(132,133,141,0.18)"},p:"1",rounded:"lg"},r))}))},Rt=({msg:e})=>{const{t:a}=k();return t.createElement(S,{className:"error",textAlign:"center",py:10,px:6},t.createElement(J,{display:"inline-block",size:"xl"},a("ERROR")),t.createElement($,{fontSize:"18px",my:3},a(e)),t.createElement(P,{to:"/"},t.createElement(Z,{variant:"solid"},a("Back Home"))))},Pt=5,Ht=[],Se=({file:e,readme:a})=>{W("light","dark");const[r,n]=t.useState(""),[l,s]=t.useState(""),{getSetting:u}=o.exports.useContext(y);let i=be(!0)(e);k();const d=e.name.endsWith(".html"),[c,m]=t.useState(!1),E=()=>{a&&e.type===-1&&(i=e.url),he.get(i,{responseType:"blob"}).then(F=>ue(void 0,null,function*(){const h=F.data;let g=yield h.text();g.includes("\uFFFD")&&(g=new TextDecoder("gbk").decode(yield h.arrayBuffer())),d&&s(g),e.name.endsWith(".md")?n(g):n("```"+e.name.split(".").pop()+`
`+g+"\n```")}))};return o.exports.useEffect(()=>(E(),()=>{n("")}),[]),r?t.createElement(S,{w:"full"},d&&t.createElement(He,{display:"flex",alignItems:"center",m:"1"},t.createElement(Te,{htmlFor:"render",mb:"0"},"Render?"),t.createElement(De,{id:"render",isChecked:c,onChange:()=>{m(!c)}})),c?t.createElement("iframe",{srcDoc:l,style:{width:"100%",borderRadius:"0.75rem",boxShadow:"#00000031 0px 1px 10px 5px",minHeight:"70vh"}}):t.createElement(S,{className:"markdown-body"},t.createElement(et,null,r))):t.createElement(H,{w:"full"},t.createElement(N,{color:u("icon color"),size:"xl"}))};var ia=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:Pt,exts:Ht,default:Se});const Tt={"dmg,ipa,plist":it,"exe,msi":ut,"zip,gz,rar,7z,tar,jar,xz":dt,apk:pt,db:mt,md:gt,epub:ft,iso:ht,m3u8:xe},Dt=(e,a)=>{if(e!==1){for(const[r,n]of Object.entries(Tt))if(r.split(",").includes(a.toLowerCase()))return n}switch(e){case 1:return Ct;case 2:return a==="doc"||a==="docx"?st:a==="xls"||a==="xlsx"?lt:a==="ppt"||a==="pptx"?ot:ct;case 3:return xe;case 4:return nt;case 5:return rt;case 6:return at;default:return tt}},Nt=e=>{const{getSetting:a}=o.exports.useContext(y);return t.createElement(S,{w:"full"},t.createElement(L,{placement:"bottom-start",label:Ce(e.path,e.name)},t.createElement(Ne,{className:"result",p:"2",w:"full",rounded:"lg",transition:"all 0.3s",_hover:{transform:"scale(1.01)",bgColor:"rgba(132,133,141,0.18)"}},t.createElement($e,{as:P,to:encodeURI(Ce(e.path,e.name))},t.createElement(A,{spacing:2},t.createElement(X,{className:"result-name",align:"center",w:{base:3/4,md:"50%"}},t.createElement(R,{color:a("icon color"),boxSize:6,as:Dt(e.type,e.name.split(".").pop()||""),mr:2}),t.createElement($,{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"md"},e.name)),t.createElement($,{className:"result-size",w:{base:1/4,md:1/6},textAlign:"right"},Fe(e.size)),t.createElement($,{className:"result-path",w:{base:0,md:1/3},display:{base:"none",md:"unset"},textAlign:"right"},e.path))))))},$t=()=>{const e=I(),[a,r]=o.exports.useState(!0),{getSetting:n}=o.exports.useContext(y),l=V(),[s,u]=o.exports.useState([]),i=()=>{const c=new URLSearchParams(e.search),m=e.pathname,E=c.get("s");!E||(r(!0),Q.post("search",{path:m,keyword:E}).then(F=>{r(!1);const h=F.data;h.code===200?u(h.data):l({title:h.message,status:"error",duration:3e3,isClosable:!0})}))};o.exports.useEffect(()=>{i()},[e.search]);const{t:d}=k();return a?t.createElement(H,{w:"full",py:"4"},t.createElement(N,{color:n("icon color")||"#1890ff",size:"xl"})):t.createElement(Y,{className:"results-box",w:"full"},t.createElement(A,{className:"results-title",w:"full",p:"2"},[{name:"name",base:2/3,md:"50%",textAlign:"left"},{name:"size",base:1/3,md:1/6,textAlign:"right"},{name:"path",base:0,md:1/3,textAlign:"right"}].map(c=>t.createElement(X,{w:{base:c.base,md:c.md},key:c.name,align:"center"},t.createElement($,{w:"full",className:`results-title-${c.name}`,fontSize:"sm",fontWeight:"bold",color:"gray.500",textAlign:c.textAlign,cursor:"pointer",display:c.name==="path"?{base:"none",md:"unset"}:"unset"},d(c.name))))),s.map(c=>t.createElement(Nt,q({key:c.name},c))))},Ut=o.exports.lazy(()=>Ee(()=>import(""+(window.__dynamicImportHandler__||function(e){return e})("./index.d6ae886c.js")+""),(window.__dynamicImportPreload__ || function(importer) { return importer; })(["assets/index.d6ae886c.js","assets/index.884c354a.css","assets/vendor.03ff3900.js","assets/index.esm.ef5c8b53.js","assets/index.esm.5483c5f7.css","assets/index.78f9d4ac.js","assets/clsx.m.c6439cc2.js","assets/copy-clip.08e8f9de.js"]))),jt=o.exports.lazy(()=>Ee(()=>import(""+(window.__dynamicImportHandler__||function(e){return e})("./file.f5d36b60.js")+""),(window.__dynamicImportPreload__ || function(importer) { return importer; })(["assets/file.f5d36b60.js","assets/file.450b80be.css","assets/vendor.03ff3900.js","assets/clsx.m.c6439cc2.js","assets/index.esm.ef5c8b53.js","assets/index.esm.5483c5f7.css","assets/index.78f9d4ac.js","assets/useTitle.2bc9150c.js","assets/copy-clip.08e8f9de.js"]))),Ot=()=>{const e=W("white","gray.700");k();const{getSetting:a,setPassword:r,password:n,settingLoaded:l,type:s,msg:u,files:i,meta:d}=o.exports.useContext(y),c=o.exports.useMemo(()=>{if(s==="file")return;const m={name:"README.md",size:0,type:-1,driver:"local",updated_at:"",thumbnail:"",url:d.readme};if(d.readme)return m;const E=i.find(F=>F.name.toLowerCase()==="readme.md");if(E)return E;if(a("global readme url"))return m.url=a("global readme url"),m},[i,s,l]);return t.createElement(H,{className:"index-box",w:"full"},t.createElement(xt,{list:!0}),t.createElement(Y,{className:"root-box",w:{base:"95%",lg:"980px"}},t.createElement(It,null),t.createElement(Lt,null),t.createElement(S,{className:"main-box",rounded:"xl",shadow:"lg",bgColor:e,w:"full"},s==="loading"?t.createElement(H,{w:"full",py:"4"},t.createElement(N,{color:a("icon color")||"#1890ff",size:"xl"})):t.createElement(S,{className:"content-box",w:"full",p:"2"},t.createElement(o.exports.Suspense,{fallback:t.createElement(H,{h:"full"},t.createElement(N,{color:a("icon color")||"#1890ff",size:"xl"}))},s==="folder"||s==="nexting"?t.createElement(Ut,null):s==="file"?t.createElement(jt,null):s==="search"?t.createElement($t,null):t.createElement(Rt,{msg:u})))),s==="folder"&&c&&t.createElement(S,{className:"readme-box",rounded:"xl",shadow:"lg",bgColor:e,w:"full",p:"4"},t.createElement(Se,{file:c,readme:!0})),t.createElement(At,null)))};const Vt=(e,a)=>{const r=o.exports.useRef(!1);o.exports.useEffect(()=>{r.current?e():r.current=!0},a)},Wt=e=>{const[a,r]=o.exports.useState({current:!1}),n=o.exports.useCallback(()=>{r({current:!0})},[a]);return o.exports.useEffect(()=>{a.current===!0&&r({current:!1})},[a]),o.exports.useEffect(()=>{a.current&&e()}),n};let ae=!1,K=!1;const Kt=e=>{const{type:a,setType:r,setSelectFiles:n,setFiles:l,setLastFiles:s,files:u,setMsg:i,sort:d,password:c,setPassword:m,setMeta:E,getSetting:F,setPage:h,page:g,settingLoaded:C}=o.exports.useContext(y),{t:_}=k(),w=pe(),p=I(),v=V(),{path:M,cancelPath:j}=bt(),T=Wt(()=>{if(!C||ne())return;j(),console.log("refresh"),console.log(g);const x=F("load type");a==="folder"&&s(u),g.page_num===1||x==="all"||x==="pagination"?(r("loading"),n([]),l([])):r("nexting"),M().then(B=>{const f=B.data;i(f.message),f.code===200?(f.data.type==="file"?l(f.data.files):g.page_num===1||x==="all"||x==="pagination"?l(D(f.data.files)):l([...u,...f.data.files]),E(f.data.meta),r(f.data.type)):(f.code===401&&K&&(v({title:_(f.message),status:"error",duration:3e3,isClosable:!0}),K=!1),f.code===1001&&(v({title:_(f.message),status:"warning",duration:3e3,isClosable:!0}),w.push("/@manage")),f.code===401?r("unauthorized"):r("error"))})}),D=x=>{const{orderBy:B,reverse:f}=d;return B?x.sort((le,oe)=>le[B]<oe[B]?f?1:-1:le[B]>oe[B]?f?-1:1:0):x},re=()=>{if(ae){ae=!1;return}T()},z=()=>{g.page_num!==1&&(ae=!0,h({page_num:1,page_size:g.page_size})),T()};o.exports.useEffect(()=>{const x=D(u);l([...x])},[d]),o.exports.useEffect(()=>(z(),te.on("refresh",z),()=>{te.off("refresh",z)}),[p.pathname]),Vt(()=>{re()},[g]);const ne=()=>new URLSearchParams(p.search).get("s")?(r("search"),!0):!1;o.exports.useEffect(()=>{ne()||z()},[p.search]);const{isOpen:_e,onClose:O,onOpen:Be}=de(),se=t.useRef();return o.exports.useEffect(()=>{a==="unauthorized"&&Be()},[a]),t.createElement(t.Fragment,null,t.createElement(t.Fragment,q({},e)),t.createElement(Ue,{initialFocusRef:se,isOpen:_e,onClose:()=>{O()}},t.createElement(je,null),t.createElement(Oe,null,t.createElement(Ve,null,_("Input password")),t.createElement(We,null),t.createElement(Ke,{pb:6},t.createElement(G,{type:"password",ref:se,value:c,onChange:x=>{m(x.target.value)},onKeyUp:x=>{x.key==="Enter"&&(localStorage.setItem("password",c),K=!0,T(),O())}})),t.createElement(qe,null,t.createElement(Z,{onClick:()=>{localStorage.setItem("password",c),K=!0,T(),O()},mr:3},_("Ok")),t.createElement(Z,{colorScheme:"gray",onClick:()=>{w.goBack(),O()}},_("Cancel"))))))},qt=()=>t.createElement(Et,null,t.createElement(Kt,null,t.createElement(Ot,null)));var ua=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:qt});export{na as F,Ct as I,ia as _,St as a,bt as b,te as c,oa as d,be as e,ca as f,la as g,ta as h,aa as i,sa as j,Qt as k,ra as l,ea as m,Dt as n,Fe as o,Ce as p,ua as q,vt as u};

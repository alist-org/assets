var Vh=Object.defineProperty,Kh=Object.defineProperties;var Hh=Object.getOwnPropertyDescriptors;var fu=Object.getOwnPropertySymbols;var $h=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable;var du=(s,e,r)=>e in s?Vh(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,yt=(s,e)=>{for(var r in e||(e={}))$h.call(e,r)&&du(s,r,e[r]);if(fu)for(var r of fu(e))Gh.call(e,r)&&du(s,r,e[r]);return s},Ot=(s,e)=>Kh(s,Hh(e));var yr=(s,e,r)=>new Promise((i,t)=>{var n=l=>{try{o(r.next(l))}catch(h){t(h)}},a=l=>{try{o(r.throw(l))}catch(h){t(h)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(n,a);o((r=r.apply(s,e)).next())});import{ae as Wt,r as Ye,ad as Mn,an as yo,ao as cu,R as q,J as se,l as Yh,j as kn,am as hu,n as Xi,C as Zi,H as Da,s as Nn,ap as zr,t as Xh,v as Zh,V as Eo,p as pu,G as Er,y as _o,u as Qh,aq as Jh,a8 as qh,ar as ep,af as xo,o as tp,a4 as rp,a5 as ip,E as np,a6 as ap,a7 as sp,L as op,as as lp,aj as Qi}from"./vendor.53f783ab.js";import{a as up}from"./clsx.m.c6439cc2.js";import{I as Vr,R as fp,i as dp,S as cp}from"./index.esm.b0b0f889.js";import{e as ui,q as Ca,u as hp,_ as pp,s as vp}from"./index.3cff8ff4.js";import{u as gp}from"./useTitle.de6d2013.js";import"./index.12fd3178.js";import"./copy-clip.08e8f9de.js";var Ji={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function r(){for(var i=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!!n){var a=typeof n;if(a==="string"||a==="number")i.push(n);else if(Array.isArray(n)){if(n.length){var o=r.apply(null,n);o&&i.push(o)}}else if(a==="object")if(n.toString===Object.prototype.toString)for(var l in n)e.call(n,l)&&n[l]&&i.push(l);else i.push(n.toString())}}return i.join(" ")}s.exports?(r.default=r,s.exports=r):window.classNames=r})()})(Ji);var Ft=Ji.exports,vu={exports:{}};(function(s,e){(function(r,i){s.exports=i()})(Wt,function(){return function r(i,t,n){var a=window,o="application/octet-stream",l=n||o,h=i,p=!t&&!n&&h,u=document.createElement("a"),f=function(b){return String(b)},g=a.Blob||a.MozBlob||a.WebKitBlob||f,E=t||"download",S,_;if(g=g.call?g.bind(a):Blob,String(this)==="true"&&(h=[h,l],l=h[0],h=h[1]),p&&p.length<2048&&(E=p.split("/").pop().split("?")[0],u.href=p,u.href.indexOf(p)!==-1)){var m=new XMLHttpRequest;return m.open("GET",p,!0),m.responseType="blob",m.onload=function(b){r(b.target.response,E,o)},setTimeout(function(){m.send()},0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(h))if(h.length>1024*1024*1.999&&g!==f)h=d(h),l=h.type||o;else return navigator.msSaveBlob?navigator.msSaveBlob(d(h),E):x(h);else if(/([\x80-\xff])/.test(h)){var c=0,v=new Uint8Array(h.length),y=v.length;for(c;c<y;++c)v[c]=h.charCodeAt(c);h=new g([v],{type:l})}S=h instanceof g?h:new g([h],{type:l});function d(b){var T=b.split(/[:;,]/),A=T[1],L=T[2]=="base64"?atob:decodeURIComponent,R=L(T.pop()),w=R.length,O=0,I=new Uint8Array(w);for(O;O<w;++O)I[O]=R.charCodeAt(O);return new g([I],{type:A})}function x(b,T){if("download"in u)return u.href=b,u.setAttribute("download",E),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout(function(){u.click(),document.body.removeChild(u),T===!0&&setTimeout(function(){a.URL.revokeObjectURL(u.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(b)&&(b="data:"+b.replace(/^data:([\w\/\-\+]+)/,o)),window.open(b)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=b),!0;var A=document.createElement("iframe");document.body.appendChild(A),!T&&/^data:/.test(b)&&(b="data:"+b.replace(/^data:([\w\/\-\+]+)/,o)),A.src=b,setTimeout(function(){document.body.removeChild(A)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(S,E);if(a.URL)x(a.URL.createObjectURL(S),!0);else{if(typeof S=="string"||S.constructor===f)try{return x("data:"+l+";base64,"+a.btoa(S))}catch(b){return x("data:"+l+","+encodeURIComponent(S))}_=new FileReader,_.onload=function(b){x(this.result)},_.readAsDataURL(S)}return!0}})})(vu);var gu=vu.exports,Pa={exports:{}};Pa.exports=bo;Pa.exports.isMobile=bo;Pa.exports.default=bo;var mp=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,yp=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function bo(s){s||(s={});var e=s.ua;if(!e&&typeof navigator!="undefined"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var r=s.tablet?yp.test(e):mp.test(e);return!r&&s.tablet&&s.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(r=!0),r}var Ep=Pa.exports,So={},To={exports:{}},Ma={exports:{}};(function(s){function e(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?(s.exports=e=function(t){return typeof t},s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=e=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s.exports.default=s.exports,s.exports.__esModule=!0),e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ma);(function(s){var e=Ma.exports.default;function r(t){if(typeof WeakMap!="function")return null;var n=new WeakMap,a=new WeakMap;return(r=function(l){return l?a:n})(t)}function i(t,n){if(!n&&t&&t.__esModule)return t;if(t===null||e(t)!=="object"&&typeof t!="function")return{default:t};var a=r(n);if(a&&a.has(t))return a.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if(h!=="default"&&Object.prototype.hasOwnProperty.call(t,h)){var p=l?Object.getOwnPropertyDescriptor(t,h):null;p&&(p.get||p.set)?Object.defineProperty(o,h,p):o[h]=t[h]}return o.default=t,a&&a.set(t,o),o}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(To);var fi={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(fi);var Ti={exports:{}},Ai={exports:{}};(function(s){function e(r,i,t){return i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t,r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ai);(function(s){var e=Ai.exports;function r(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,o)}return a}function i(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?r(Object(a),!0).forEach(function(o){e(t,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(a,o))})}return t}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Ti);var ka={exports:{}};(function(s){function e(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(ka);var Na={exports:{}};(function(s){function e(i,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function r(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Na);var Fa={exports:{}},mu={exports:{}};(function(s){function e(r,i){return s.exports=e=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},s.exports.default=s.exports,s.exports.__esModule=!0,e(r,i)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(mu);(function(s){var e=mu.exports;function r(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&e(i,t)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Fa);var Ba={exports:{}},Ua={exports:{}};(function(s){function e(r){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s.exports.default=s.exports,s.exports.__esModule=!0,e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ua);var yu={exports:{}};(function(s){function e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(yu);var Eu={exports:{}},_u={exports:{}};(function(s){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(_u);(function(s){var e=Ma.exports.default,r=_u.exports;function i(t,n){if(n&&(e(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Eu);(function(s){var e=Ua.exports,r=yu.exports,i=Eu.exports;function t(n){var a=r();return function(){var l=e(n),h;if(a){var p=e(this).constructor;h=Reflect.construct(l,arguments,p)}else h=l.apply(this,arguments);return i(this,h)}}s.exports=t,s.exports.default=s.exports,s.exports.__esModule=!0})(Ba);var _r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.warning=xu;_r.note=bu;_r.resetWarned=_p;_r.call=wo;_r.warningOnce=Su;_r.noteOnce=xp;_r.default=void 0;var Ao={};function xu(s,e){}function bu(s,e){}function _p(){Ao={}}function wo(s,e,r){!e&&!Ao[r]&&(s(!1,r),Ao[r]=!0)}function Su(s,e){wo(xu,s,e)}function xp(s,e){wo(bu,s,e)}var bp=Su;_r.default=bp;var ja={},Oo=fi.exports;Object.defineProperty(ja,"__esModule",{value:!0});ja.default=void 0;var Tu=Oo(Ti.exports),qi=Oo(Ai.exports),Sp=Oo(Ye.exports),Tp=function(e){var r,i,t=e.className,n=e.included,a=e.vertical,o=e.style,l=e.length,h=e.offset,p=e.reverse;l<0&&(p=!p,l=Math.abs(l),h=100-h);var u=a?(r={},(0,qi.default)(r,p?"top":"bottom","".concat(h,"%")),(0,qi.default)(r,p?"bottom":"top","auto"),(0,qi.default)(r,"height","".concat(l,"%")),r):(i={},(0,qi.default)(i,p?"right":"left","".concat(h,"%")),(0,qi.default)(i,p?"left":"right","auto"),(0,qi.default)(i,"width","".concat(l,"%")),i),f=(0,Tu.default)((0,Tu.default)({},o),u);return n?Sp.default.createElement("div",{className:t,style:f}):null},Ap=Tp;ja.default=Ap;var Lo={},Io={exports:{}};(function(s){function e(){return s.exports=e=Object.assign||function(r){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},s.exports.default=s.exports,s.exports.__esModule=!0,e.apply(this,arguments)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Io);var Ro={exports:{}},Au={exports:{}};(function(s){function e(r,i){if(r==null)return{};var t={},n=Object.keys(r),a,o;for(o=0;o<n.length;o++)a=n[o],!(i.indexOf(a)>=0)&&(t[a]=r[a]);return t}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Au);(function(s){var e=Au.exports;function r(i,t){if(i==null)return{};var n=e(i,t),a,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(i);for(o=0;o<l.length;o++)a=l[o],!(t.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(n[a]=i[a]))}return n}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ro);var Do={exports:{}},wu={exports:{}},Co={exports:{}};(function(s){function e(r,i){(i==null||i>r.length)&&(i=r.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=r[t];return n}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Co);(function(s){var e=Co.exports;function r(i){if(Array.isArray(i))return e(i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(wu);var Ou={exports:{}};(function(s){function e(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ou);var Lu={exports:{}};(function(s){var e=Co.exports;function r(i,t){if(!!i){if(typeof i=="string")return e(i,t);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(i,t)}}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Lu);var Iu={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Iu);(function(s){var e=wu.exports,r=Ou.exports,i=Lu.exports,t=Iu.exports;function n(a){return e(a)||r(a)||i(a)||t()}s.exports=n,s.exports.default=s.exports,s.exports.__esModule=!0})(Do);var Ru={exports:{}},Du={exports:{}};(function(s){var e=Ua.exports;function r(i,t){for(;!Object.prototype.hasOwnProperty.call(i,t)&&(i=e(i),i!==null););return i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Du);(function(s){var e=Du.exports;function r(i,t,n){return typeof Reflect!="undefined"&&Reflect.get?(s.exports=r=Reflect.get,s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=r=function(o,l,h){var p=e(o,l);if(!!p){var u=Object.getOwnPropertyDescriptor(p,l);return u.get?u.get.call(h):u.value}},s.exports.default=s.exports,s.exports.__esModule=!0),r(i,t,n||i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ru);var Wa={},Cu={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Cu);var wp=Cu.exports;Object.defineProperty(Wa,"__esModule",{value:!0});Wa.default=Op;var Pu=wp(Mn.exports);function Op(s,e,r,i){var t=Pu.default.unstable_batchedUpdates?function(a){Pu.default.unstable_batchedUpdates(r,a)}:r;return s.addEventListener&&s.addEventListener(e,t,i),{remove:function(){s.removeEventListener&&s.removeEventListener(e,t)}}}var za={},Fn=fi.exports;Object.defineProperty(za,"__esModule",{value:!0});za.default=void 0;var Bn=Fn(Ai.exports),en=Fn(Ti.exports),Mu=Fn(Ye.exports),Lp=Fn(Ji.exports),Ip=Fn(_r),Rp=function(e,r,i,t,n,a){(0,Ip.default)(i?t>0:!0,"`Slider[step]` should be a positive number in order to make Slider[dots] work.");var o=Object.keys(r).map(parseFloat).sort(function(h,p){return h-p});if(i&&t)for(var l=n;l<=a;l+=t)o.indexOf(l)===-1&&o.push(l);return o},Dp=function(e){var r=e.prefixCls,i=e.vertical,t=e.reverse,n=e.marks,a=e.dots,o=e.step,l=e.included,h=e.lowerBound,p=e.upperBound,u=e.max,f=e.min,g=e.dotStyle,E=e.activeDotStyle,S=u-f,_=Rp(i,n,a,o,f,u).map(function(m){var c,v="".concat(Math.abs(m-f)/S*100,"%"),y=!l&&m===p||l&&m<=p&&m>=h,d=i?(0,en.default)((0,en.default)({},g),{},(0,Bn.default)({},t?"top":"bottom",v)):(0,en.default)((0,en.default)({},g),{},(0,Bn.default)({},t?"right":"left",v));y&&(d=(0,en.default)((0,en.default)({},d),E));var x=(0,Lp.default)((c={},(0,Bn.default)(c,"".concat(r,"-dot"),!0),(0,Bn.default)(c,"".concat(r,"-dot-active"),y),(0,Bn.default)(c,"".concat(r,"-dot-reverse"),t),c));return Mu.default.createElement("span",{className:x,style:d,key:m})});return Mu.default.createElement("div",{className:"".concat(r,"-step")},_)},Cp=Dp;za.default=Cp;var Va={},Un=fi.exports;Object.defineProperty(Va,"__esModule",{value:!0});Va.default=void 0;var ku=Un(Ti.exports),Ka=Un(Ai.exports),Pp=Un(Ma.exports),Po=Un(Ye.exports),Mp=Un(Ji.exports),kp=function(e){var r=e.className,i=e.vertical,t=e.reverse,n=e.marks,a=e.included,o=e.upperBound,l=e.lowerBound,h=e.max,p=e.min,u=e.onClickLabel,f=Object.keys(n),g=h-p,E=f.map(parseFloat).sort(function(S,_){return S-_}).map(function(S){var _,m=n[S],c=(0,Pp.default)(m)==="object"&&!Po.default.isValidElement(m),v=c?m.label:m;if(!v&&v!==0)return null;var y=!a&&S===o||a&&S<=o&&S>=l,d=(0,Mp.default)((_={},(0,Ka.default)(_,"".concat(r,"-text"),!0),(0,Ka.default)(_,"".concat(r,"-text-active"),y),_)),x=(0,Ka.default)({marginBottom:"-50%"},t?"top":"bottom","".concat((S-p)/g*100,"%")),b=(0,Ka.default)({transform:"translateX(".concat(t?"50%":"-50%",")"),msTransform:"translateX(".concat(t?"50%":"-50%",")")},t?"right":"left","".concat((S-p)/g*100,"%")),T=i?x:b,A=c?(0,ku.default)((0,ku.default)({},T),m.style):T;return Po.default.createElement("span",{className:d,style:A,key:S,onMouseDown:function(R){return u(R,S)},onTouchStart:function(R){return u(R,S)}},v)});return Po.default.createElement("div",{className:r},E)},Np=kp;Va.default=Np;var Ha={},Cr=fi.exports;Object.defineProperty(Ha,"__esModule",{value:!0});Ha.default=void 0;var Fp=Cr(Io.exports),Nu=Cr(Ti.exports),wi=Cr(Ai.exports),Bp=Cr(Ro.exports),Up=Cr(ka.exports),jp=Cr(Na.exports),Wp=Cr(Fa.exports),zp=Cr(Ba.exports),Fu=Cr(Ye.exports),Vp=Cr(Ji.exports),Kp=Cr(Wa),Hp=["prefixCls","vertical","reverse","offset","style","disabled","min","max","value","tabIndex","ariaLabel","ariaLabelledBy","ariaValueTextFormatter"],$p=function(s){(0,Wp.default)(r,s);var e=(0,zp.default)(r);function r(){var i;(0,Up.default)(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),i.state={clickFocused:!1},i.onMouseUpListener=void 0,i.handle=void 0,i.setHandleRef=function(o){i.handle=o},i.handleMouseUp=function(){document.activeElement===i.handle&&i.setClickFocus(!0)},i.handleMouseDown=function(o){o.preventDefault(),i.focus()},i.handleBlur=function(){i.setClickFocus(!1)},i.handleKeyDown=function(){i.setClickFocus(!1)},i}return(0,jp.default)(r,[{key:"componentDidMount",value:function(){this.onMouseUpListener=(0,Kp.default)(document,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"setClickFocus",value:function(t){this.setState({clickFocused:t})}},{key:"clickFocus",value:function(){this.setClickFocus(!0),this.focus()}},{key:"focus",value:function(){this.handle.focus()}},{key:"blur",value:function(){this.handle.blur()}},{key:"render",value:function(){var t,n,a=this.props,o=a.prefixCls,l=a.vertical,h=a.reverse,p=a.offset,u=a.style,f=a.disabled,g=a.min,E=a.max,S=a.value,_=a.tabIndex,m=a.ariaLabel,c=a.ariaLabelledBy,v=a.ariaValueTextFormatter,y=(0,Bp.default)(a,Hp),d=(0,Vp.default)(this.props.className,(0,wi.default)({},"".concat(o,"-handle-click-focused"),this.state.clickFocused)),x=l?(t={},(0,wi.default)(t,h?"top":"bottom","".concat(p,"%")),(0,wi.default)(t,h?"bottom":"top","auto"),(0,wi.default)(t,"transform",h?null:"translateY(+50%)"),t):(n={},(0,wi.default)(n,h?"right":"left","".concat(p,"%")),(0,wi.default)(n,h?"left":"right","auto"),(0,wi.default)(n,"transform","translateX(".concat(h?"+":"-","50%)")),n),b=(0,Nu.default)((0,Nu.default)({},u),x),T=_||0;(f||_===null)&&(T=null);var A;return v&&(A=v(S)),Fu.default.createElement("div",(0,Fp.default)({ref:this.setHandleRef,tabIndex:T},y,{className:d,style:b,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,role:"slider","aria-valuemin":g,"aria-valuemax":E,"aria-valuenow":S,"aria-disabled":!!f,"aria-label":m,"aria-labelledby":c,"aria-valuetext":A}))}}]),r}(Fu.default.Component);Ha.default=$p;var zt={},$a={};Object.defineProperty($a,"__esModule",{value:!0});$a.default=void 0;var Qe={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Qe.F1&&r<=Qe.F12)return!1;switch(r){case Qe.ALT:case Qe.CAPS_LOCK:case Qe.CONTEXT_MENU:case Qe.CTRL:case Qe.DOWN:case Qe.END:case Qe.ESC:case Qe.HOME:case Qe.INSERT:case Qe.LEFT:case Qe.MAC_FF_META:case Qe.META:case Qe.NUMLOCK:case Qe.NUM_CENTER:case Qe.PAGE_DOWN:case Qe.PAGE_UP:case Qe.PAUSE:case Qe.PRINT_SCREEN:case Qe.RIGHT:case Qe.SHIFT:case Qe.UP:case Qe.WIN_KEY:case Qe.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Qe.ZERO&&e<=Qe.NINE||e>=Qe.NUM_ZERO&&e<=Qe.NUM_MULTIPLY||e>=Qe.A&&e<=Qe.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Qe.SPACE:case Qe.QUESTION_MARK:case Qe.NUM_PLUS:case Qe.NUM_MINUS:case Qe.NUM_PERIOD:case Qe.NUM_DIVISION:case Qe.SEMICOLON:case Qe.DASH:case Qe.EQUALS:case Qe.COMMA:case Qe.PERIOD:case Qe.SLASH:case Qe.APOSTROPHE:case Qe.SINGLE_QUOTE:case Qe.OPEN_SQUARE_BRACKET:case Qe.BACKSLASH:case Qe.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Gp=Qe;$a.default=Gp;var Bu=fi.exports;Object.defineProperty(zt,"__esModule",{value:!0});zt.calculateNextValue=Uu;zt.ensureValueInRange=rv;zt.ensureValuePrecision=iv;zt.getClosestPoint=Mo;zt.getHandleCenterPosition=tv;zt.getKeyboardValueMutator=av;zt.getMousePosition=qp;zt.getPrecision=ko;zt.getTouchPosition=ev;zt.isEventFromHandle=Zp;zt.isNotTouchEvent=Jp;zt.isValueOutOfRange=Qp;zt.pauseEvent=nv;var Yp=Bu(Do.exports),Xp=Mn.exports,di=Bu($a);function Zp(s,e){try{return Object.keys(e).some(function(r){return s.target===(0,Xp.findDOMNode)(e[r])})}catch(r){return!1}}function Qp(s,e){var r=e.min,i=e.max;return s<r||s>i}function Jp(s){return s.touches.length>1||s.type.toLowerCase()==="touchend"&&s.touches.length>0}function Mo(s,e){var r=e.marks,i=e.step,t=e.min,n=e.max,a=Object.keys(r).map(parseFloat);if(i!==null){var o=Math.pow(10,ko(i)),l=Math.floor((n*o-t*o)/(i*o)),h=Math.min((s-t)/i,l),p=Math.round(h)*i+t;a.push(p)}var u=a.map(function(f){return Math.abs(s-f)});return a[u.indexOf(Math.min.apply(Math,(0,Yp.default)(u)))]}function ko(s){var e=s.toString(),r=0;return e.indexOf(".")>=0&&(r=e.length-e.indexOf(".")-1),r}function qp(s,e){return s?e.clientY:e.pageX}function ev(s,e){return s?e.touches[0].clientY:e.touches[0].pageX}function tv(s,e){var r=e.getBoundingClientRect();return s?r.top+r.height*.5:window.pageXOffset+r.left+r.width*.5}function rv(s,e){var r=e.max,i=e.min;return s<=i?i:s>=r?r:s}function iv(s,e){var r=e.step,i=isFinite(Mo(s,e))?Mo(s,e):0;return r===null?i:parseFloat(i.toFixed(ko(r)))}function nv(s){s.stopPropagation(),s.preventDefault()}function Uu(s,e,r){var i={increase:function(o,l){return o+l},decrease:function(o,l){return o-l}},t=i[s](Object.keys(r.marks).indexOf(JSON.stringify(e)),1),n=Object.keys(r.marks)[t];return r.step?i[s](e,r.step):!!Object.keys(r.marks).length&&!!r.marks[n]?r.marks[n]:e}function av(s,e,r){var i="increase",t="decrease",n=i;switch(s.keyCode){case di.default.UP:n=e&&r?t:i;break;case di.default.RIGHT:n=!e&&r?t:i;break;case di.default.DOWN:n=e&&r?i:t;break;case di.default.LEFT:n=!e&&r?i:t;break;case di.default.END:return function(a,o){return o.max};case di.default.HOME:return function(a,o){return o.min};case di.default.PAGE_UP:return function(a,o){return a+o.step*2};case di.default.PAGE_DOWN:return function(a,o){return a-o.step*2};default:return}return function(a,o){return Uu(n,a,o)}}var Mt=fi.exports,sv=To.exports;Object.defineProperty(Lo,"__esModule",{value:!0});Lo.default=_v;var ov=Mt(Io.exports),lv=Mt(Ro.exports),Ga=Mt(Ti.exports),Ya=Mt(Ai.exports),uv=Mt(Do.exports),fv=Mt(ka.exports),dv=Mt(Na.exports),No=Mt(Ru.exports),Fo=Mt(Ua.exports),cv=Mt(Fa.exports),hv=Mt(Ba.exports),jn=Mt(Ye.exports),Xa=Mt(Wa),pv=Mt(Ji.exports),vv=Mt(_r),gv=Mt(za),mv=Mt(Va),yv=Mt(Ha),ar=sv(zt),Ev=["index"];function Kr(){}function _v(s){var e,r;return r=e=function(i){(0,cv.default)(n,i);var t=(0,hv.default)(n);function n(a){var o;(0,fv.default)(this,n),o=t.call(this,a),o.handlesRefs=void 0,o.sliderRef=void 0,o.document=void 0,o.dragOffset=void 0,o.prevMovedHandleIndex=void 0,o.onTouchMoveListener=void 0,o.onTouchUpListener=void 0,o.onMouseMoveListener=void 0,o.onMouseUpListener=void 0,o.dragTrack=void 0,o.startBounds=void 0,o.onDown=function(f,g){var E=g,S=o.props,_=S.draggableTrack,m=S.vertical,c=o.state.bounds,v=_&&o.positionGetValue?o.positionGetValue(E)||[]:[],y=ar.isEventFromHandle(f,o.handlesRefs);if(o.dragTrack=_&&c.length>=2&&!y&&!v.map(function(x,b){var T=b?!0:x>=c[b];return b===v.length-1?x<=c[b]:T}).some(function(x){return!x}),o.dragTrack)o.dragOffset=E,o.startBounds=(0,uv.default)(c);else{if(!y)o.dragOffset=0;else{var d=ar.getHandleCenterPosition(m,f.target);o.dragOffset=E-d,E=d}o.onStart(E)}},o.onMouseDown=function(f){if(f.button===0){o.removeDocumentEvents();var g=o.props.vertical,E=ar.getMousePosition(g,f);o.onDown(f,E),o.addDocumentMouseEvents()}},o.onTouchStart=function(f){if(!ar.isNotTouchEvent(f)){var g=o.props.vertical,E=ar.getTouchPosition(g,f);o.onDown(f,E),o.addDocumentTouchEvents(),ar.pauseEvent(f)}},o.onFocus=function(f){var g=o.props,E=g.onFocus,S=g.vertical;if(ar.isEventFromHandle(f,o.handlesRefs)&&!o.dragTrack){var _=ar.getHandleCenterPosition(S,f.target);o.dragOffset=0,o.onStart(_),ar.pauseEvent(f),E&&E(f)}},o.onBlur=function(f){var g=o.props.onBlur;o.dragTrack||o.onEnd(),g&&g(f)},o.onMouseUp=function(){o.handlesRefs[o.prevMovedHandleIndex]&&o.handlesRefs[o.prevMovedHandleIndex].clickFocus()},o.onMouseMove=function(f){if(!o.sliderRef){o.onEnd();return}var g=ar.getMousePosition(o.props.vertical,f);o.onMove(f,g-o.dragOffset,o.dragTrack,o.startBounds)},o.onTouchMove=function(f){if(ar.isNotTouchEvent(f)||!o.sliderRef){o.onEnd();return}var g=ar.getTouchPosition(o.props.vertical,f);o.onMove(f,g-o.dragOffset,o.dragTrack,o.startBounds)},o.onKeyDown=function(f){o.sliderRef&&ar.isEventFromHandle(f,o.handlesRefs)&&o.onKeyboard(f)},o.onClickMarkLabel=function(f,g){f.stopPropagation(),o.onChange({value:g}),o.setState({value:g},function(){return o.onEnd(!0)})},o.saveSlider=function(f){o.sliderRef=f};var l=a.step,h=a.max,p=a.min,u=isFinite(h-p)?(h-p)%l==0:!0;return(0,vv.default)(l&&Math.floor(l)===l?u:!0,"Slider[max] - Slider[min] (".concat(h-p,") should be a multiple of Slider[step] (").concat(l,")")),o.handlesRefs={},o}return(0,dv.default)(n,[{key:"componentDidMount",value:function(){this.document=this.sliderRef&&this.sliderRef.ownerDocument;var o=this.props,l=o.autoFocus,h=o.disabled;l&&!h&&this.focus()}},{key:"componentWillUnmount",value:function(){(0,No.default)((0,Fo.default)(n.prototype),"componentWillUnmount",this)&&(0,No.default)((0,Fo.default)(n.prototype),"componentWillUnmount",this).call(this),this.removeDocumentEvents()}},{key:"getSliderStart",value:function(){var o=this.sliderRef,l=this.props,h=l.vertical,p=l.reverse,u=o.getBoundingClientRect();return h?p?u.bottom:u.top:window.pageXOffset+(p?u.right:u.left)}},{key:"getSliderLength",value:function(){var o=this.sliderRef;if(!o)return 0;var l=o.getBoundingClientRect();return this.props.vertical?l.height:l.width}},{key:"addDocumentTouchEvents",value:function(){this.onTouchMoveListener=(0,Xa.default)(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=(0,Xa.default)(this.document,"touchend",this.onEnd)}},{key:"addDocumentMouseEvents",value:function(){this.onMouseMoveListener=(0,Xa.default)(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=(0,Xa.default)(this.document,"mouseup",this.onEnd)}},{key:"removeDocumentEvents",value:function(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"focus",value:function(){var o;this.props.disabled||(o=this.handlesRefs[0])===null||o===void 0||o.focus()}},{key:"blur",value:function(){var o=this;this.props.disabled||Object.keys(this.handlesRefs).forEach(function(l){var h,p;(h=o.handlesRefs[l])===null||h===void 0||(p=h.blur)===null||p===void 0||p.call(h)})}},{key:"calcValue",value:function(o){var l=this.props,h=l.vertical,p=l.min,u=l.max,f=Math.abs(Math.max(o,0)/this.getSliderLength()),g=h?(1-f)*(u-p)+p:f*(u-p)+p;return g}},{key:"calcValueByPos",value:function(o){var l=this.props.reverse?-1:1,h=l*(o-this.getSliderStart()),p=this.trimAlignValue(this.calcValue(h));return p}},{key:"calcOffset",value:function(o){var l=this.props,h=l.min,p=l.max,u=(o-h)/(p-h);return Math.max(0,u*100)}},{key:"saveHandle",value:function(o,l){this.handlesRefs[o]=l}},{key:"render",value:function(){var o,l=this.props,h=l.prefixCls,p=l.className,u=l.marks,f=l.dots,g=l.step,E=l.included,S=l.disabled,_=l.vertical,m=l.reverse,c=l.min,v=l.max,y=l.children,d=l.maximumTrackStyle,x=l.style,b=l.railStyle,T=l.dotStyle,A=l.activeDotStyle,L=(0,No.default)((0,Fo.default)(n.prototype),"render",this).call(this),R=L.tracks,w=L.handles,O=(0,pv.default)(h,(o={},(0,Ya.default)(o,"".concat(h,"-with-marks"),Object.keys(u).length),(0,Ya.default)(o,"".concat(h,"-disabled"),S),(0,Ya.default)(o,"".concat(h,"-vertical"),_),(0,Ya.default)(o,p,p),o));return jn.default.createElement("div",{ref:this.saveSlider,className:O,onTouchStart:S?Kr:this.onTouchStart,onMouseDown:S?Kr:this.onMouseDown,onMouseUp:S?Kr:this.onMouseUp,onKeyDown:S?Kr:this.onKeyDown,onFocus:S?Kr:this.onFocus,onBlur:S?Kr:this.onBlur,style:x},jn.default.createElement("div",{className:"".concat(h,"-rail"),style:(0,Ga.default)((0,Ga.default)({},d),b)}),R,jn.default.createElement(gv.default,{prefixCls:h,vertical:_,reverse:m,marks:u,dots:f,step:g,included:E,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:v,min:c,dotStyle:T,activeDotStyle:A}),w,jn.default.createElement(mv.default,{className:"".concat(h,"-mark"),onClickLabel:S?Kr:this.onClickMarkLabel,vertical:_,marks:u,included:E,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:v,min:c,reverse:m}),y)}}]),n}(s),e.displayName="ComponentEnhancer(".concat(s.displayName,")"),e.defaultProps=(0,Ga.default)((0,Ga.default)({},s.defaultProps),{},{prefixCls:"rc-slider",className:"",min:0,max:100,step:1,marks:{},handle:function(t){var n=t.index,a=(0,lv.default)(t,Ev);return delete a.dragging,a.value===null?null:jn.default.createElement(yv.default,(0,ov.default)({},a,{key:n}))},onBeforeChange:Kr,onChange:Kr,onAfterChange:Kr,included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),r}var xv=To.exports,ti=fi.exports;Object.defineProperty(So,"__esModule",{value:!0});var Bo=So.default=void 0,tn=ti(Ti.exports),bv=ti(ka.exports),Sv=ti(Na.exports),Tv=ti(Fa.exports),Av=ti(Ba.exports),ju=ti(Ye.exports),Wu=ti(_r),wv=ti(ja),Ov=ti(Lo),rn=xv(zt),Lv=function(s){(0,Tv.default)(r,s);var e=(0,Av.default)(r);function r(i){var t;(0,bv.default)(this,r),t=e.call(this,i),t.positionGetValue=function(o){return[]},t.startValue=void 0,t.startPosition=void 0,t.prevMovedHandleIndex=void 0,t.onEnd=function(o){var l=t.state.dragging;t.removeDocumentEvents(),(l||o)&&t.props.onAfterChange(t.getValue()),t.setState({dragging:!1})};var n=i.defaultValue!==void 0?i.defaultValue:i.min,a=i.value!==void 0?i.value:n;return t.state={value:t.trimAlignValue(a),dragging:!1},(0,Wu.default)(!("minimumTrackStyle"in i),"minimumTrackStyle will be deprecated, please use trackStyle instead."),(0,Wu.default)(!("maximumTrackStyle"in i),"maximumTrackStyle will be deprecated, please use railStyle instead."),t}return(0,Sv.default)(r,[{key:"calcValueByPos",value:function(t){return 0}},{key:"calcOffset",value:function(t){return 0}},{key:"saveHandle",value:function(t,n){}},{key:"removeDocumentEvents",value:function(){}},{key:"componentDidUpdate",value:function(t,n){var a=this.props,o=a.min,l=a.max,h=a.value,p=a.onChange;if("min"in this.props||"max"in this.props){var u=h!==void 0?h:n.value,f=this.trimAlignValue(u,this.props);f!==n.value&&(this.setState({value:f}),!(o===t.min&&l===t.max)&&rn.isValueOutOfRange(u,this.props)&&p(f))}}},{key:"onChange",value:function(t){var n=this.props,a=!("value"in n),o=t.value>this.props.max?(0,tn.default)((0,tn.default)({},t),{},{value:this.props.max}):t;a&&this.setState(o);var l=o.value;n.onChange(l)}},{key:"onStart",value:function(t){this.setState({dragging:!0});var n=this.props,a=this.getValue();n.onBeforeChange(a);var o=this.calcValueByPos(t);this.startValue=o,this.startPosition=t,o!==a&&(this.prevMovedHandleIndex=0,this.onChange({value:o}))}},{key:"onMove",value:function(t,n){rn.pauseEvent(t);var a=this.state.value,o=this.calcValueByPos(n);o!==a&&this.onChange({value:o})}},{key:"onKeyboard",value:function(t){var n=this.props,a=n.reverse,o=n.vertical,l=rn.getKeyboardValueMutator(t,o,a);if(l){rn.pauseEvent(t);var h=this.state,p=h.value,u=l(p,this.props),f=this.trimAlignValue(u);if(f===p)return;this.onChange({value:f}),this.props.onAfterChange(f),this.onEnd()}}},{key:"getValue",value:function(){return this.state.value}},{key:"getLowerBound",value:function(){var t=this.props.startPoint||this.props.min;return this.state.value>t?t:this.state.value}},{key:"getUpperBound",value:function(){return this.state.value<this.props.startPoint?this.props.startPoint:this.state.value}},{key:"trimAlignValue",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t===null)return null;var a=(0,tn.default)((0,tn.default)({},this.props),n),o=rn.ensureValueInRange(t,a);return rn.ensureValuePrecision(o,a)}},{key:"render",value:function(){var t=this,n=this.props,a=n.prefixCls,o=n.vertical,l=n.included,h=n.disabled,p=n.minimumTrackStyle,u=n.trackStyle,f=n.handleStyle,g=n.tabIndex,E=n.ariaLabelForHandle,S=n.ariaLabelledByForHandle,_=n.ariaValueTextFormatterForHandle,m=n.min,c=n.max,v=n.startPoint,y=n.reverse,d=n.handle,x=this.state,b=x.value,T=x.dragging,A=this.calcOffset(b),L=d({className:"".concat(a,"-handle"),prefixCls:a,vertical:o,offset:A,value:b,dragging:T,disabled:h,min:m,max:c,reverse:y,index:0,tabIndex:g,ariaLabel:E,ariaLabelledBy:S,ariaValueTextFormatter:_,style:f[0]||f,ref:function(D){return t.saveHandle(0,D)}}),R=v!==void 0?this.calcOffset(v):0,w=u[0]||u,O=ju.default.createElement(wv.default,{className:"".concat(a,"-track"),vertical:o,included:l,offset:R,reverse:y,length:A-R,style:(0,tn.default)((0,tn.default)({},p),w)});return{tracks:O,handles:L}}}]),r}(ju.default.Component),Iv=(0,Ov.default)(Lv);Bo=So.default=Iv;function zu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Rv(s){if(Array.isArray(s))return s}function Dv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Vu(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Cv(s,e){if(!!s){if(typeof s=="string")return Vu(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vu(s,e)}}function Pv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mv(s,e){return Rv(s)||Dv(s,e)||Cv(s,e)||Pv()}function kv(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Nv(s,e){if(s==null)return{};var r=kv(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function Fv(s){if(Array.isArray(s))return s}function Bv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Ku(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Uv(s,e){if(!!s){if(typeof s=="string")return Ku(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ku(s,e)}}function jv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wv(s,e){return Fv(s)||Bv(s,e)||Uv(s,e)||jv()}function zv(s,e){var r=e||{},i=r.defaultValue,t=r.value,n=r.onChange,a=r.postState,o=Ye.exports.useState(function(){return t!==void 0?t:i!==void 0?typeof i=="function"?i():i:typeof s=="function"?s():s}),l=Wv(o,2),h=l[0],p=l[1],u=t!==void 0?t:h;a&&(u=a(u));function f(E){p(E),u!==E&&n&&n(E,u)}var g=Ye.exports.useRef(!0);return Ye.exports.useEffect(function(){if(g.current){g.current=!1;return}t===void 0&&p(t)},[t]),[u,f]}var Ze={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Ze.F1&&r<=Ze.F12)return!1;switch(r){case Ze.ALT:case Ze.CAPS_LOCK:case Ze.CONTEXT_MENU:case Ze.CTRL:case Ze.DOWN:case Ze.END:case Ze.ESC:case Ze.HOME:case Ze.INSERT:case Ze.LEFT:case Ze.MAC_FF_META:case Ze.META:case Ze.NUMLOCK:case Ze.NUM_CENTER:case Ze.PAGE_DOWN:case Ze.PAGE_UP:case Ze.PAUSE:case Ze.PRINT_SCREEN:case Ze.RIGHT:case Ze.SHIFT:case Ze.UP:case Ze.WIN_KEY:case Ze.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Ze.ZERO&&e<=Ze.NINE||e>=Ze.NUM_ZERO&&e<=Ze.NUM_MULTIPLY||e>=Ze.A&&e<=Ze.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Ze.SPACE:case Ze.QUESTION_MARK:case Ze.NUM_PLUS:case Ze.NUM_MINUS:case Ze.NUM_PERIOD:case Ze.NUM_DIVISION:case Ze.SEMICOLON:case Ze.DASH:case Ze.EQUALS:case Ze.COMMA:case Ze.PERIOD:case Ze.SLASH:case Ze.APOSTROPHE:case Ze.SINGLE_QUOTE:case Ze.OPEN_SQUARE_BRACKET:case Ze.BACKSLASH:case Ze.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Hu=Ye.exports.forwardRef(function(s,e){var r,i=s.prefixCls,t=i===void 0?"rc-switch":i,n=s.className,a=s.checked,o=s.defaultChecked,l=s.disabled,h=s.loadingIcon,p=s.checkedChildren,u=s.unCheckedChildren,f=s.onClick,g=s.onChange,E=s.onKeyDown,S=Nv(s,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),_=zv(!1,{value:a,defaultValue:o}),m=Mv(_,2),c=m[0],v=m[1];function y(T,A){var L=c;return l||(L=T,v(L),g==null||g(L,A)),L}function d(T){T.which===Ze.LEFT?y(!1,T):T.which===Ze.RIGHT&&y(!0,T),E==null||E(T)}function x(T){var A=y(!c,T);f==null||f(A,T)}var b=Ft(t,n,(r={},zu(r,"".concat(t,"-checked"),c),zu(r,"".concat(t,"-disabled"),l),r));return Ye.exports.createElement("button",Object.assign({},S,{type:"button",role:"switch","aria-checked":c,disabled:l,className:b,ref:e,onKeyDown:d,onClick:x}),h,Ye.exports.createElement("span",{className:"".concat(t,"-inner")},c?p:u))});Hu.displayName="Switch";var Za={exports:{}},$u={},Vv=yo(up),bt={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.findInArray=Kv;Hr.isFunction=Hv;Hr.isNum=$v;Hr.int=Gv;Hr.dontSetMe=Yv;function Kv(s,e){for(var r=0,i=s.length;r<i;r++)if(e.apply(e,[s[r],r,s]))return s[r]}function Hv(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Function]"}function $v(s){return typeof s=="number"&&!isNaN(s)}function Gv(s){return parseInt(s,10)}function Yv(s,e,r){if(s[e])return new Error("Invalid prop ".concat(e," passed to ").concat(r," - do not set this, set it on the child."))}var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.getPrefix=Gu;Oi.browserPrefixToKey=Yu;Oi.browserPrefixToStyle=Xv;Oi.default=void 0;var Uo=["Moz","Webkit","O","ms"];function Gu(){var s,e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";var i=(s=window.document)===null||s===void 0||(e=s.documentElement)===null||e===void 0?void 0:e.style;if(!i||r in i)return"";for(var t=0;t<Uo.length;t++)if(Yu(r,Uo[t])in i)return Uo[t];return""}function Yu(s,e){return e?"".concat(e).concat(Zv(s)):s}function Xv(s,e){return e?"-".concat(e.toLowerCase(),"-").concat(s):s}function Zv(s){for(var e="",r=!0,i=0;i<s.length;i++)r?(e+=s[i].toUpperCase(),r=!1):s[i]==="-"?r=!0:e+=s[i];return e}var Qv=Gu();Oi.default=Qv;function Qa(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qa=function(r){return typeof r}:Qa=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Qa(s)}Object.defineProperty(bt,"__esModule",{value:!0});bt.matchesSelector=ef;bt.matchesSelectorAndParentsTo=qv;bt.addEvent=eg;bt.removeEvent=tg;bt.outerHeight=rg;bt.outerWidth=ig;bt.innerHeight=ng;bt.innerWidth=ag;bt.offsetXYFromParent=sg;bt.createCSSTransform=og;bt.createSVGTransform=lg;bt.getTranslation=jo;bt.getTouch=ug;bt.getTouchIdentifier=fg;bt.addUserSelectStyles=dg;bt.removeUserSelectStyles=cg;bt.addClassName=tf;bt.removeClassName=rf;var sr=Hr,Xu=Jv(Oi);function Zu(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Zu=function(t){return t?r:e})(s)}function Jv(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||Qa(s)!=="object"&&typeof s!="function")return{default:s};var r=Zu(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Qu(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function Ju(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qu(Object(r),!0).forEach(function(i){qu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qu(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function qu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var Ja="";function ef(s,e){return Ja||(Ja=(0,sr.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,sr.isFunction)(s[r])})),(0,sr.isFunction)(s[Ja])?s[Ja](e):!1}function qv(s,e,r){var i=s;do{if(ef(i,e))return!0;if(i===r)return!1;i=i.parentNode}while(i);return!1}function eg(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.addEventListener?s.addEventListener(e,r,t):s.attachEvent?s.attachEvent("on"+e,r):s["on"+e]=r}}function tg(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.removeEventListener?s.removeEventListener(e,r,t):s.detachEvent?s.detachEvent("on"+e,r):s["on"+e]=null}}function rg(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,sr.int)(r.borderTopWidth),e+=(0,sr.int)(r.borderBottomWidth),e}function ig(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,sr.int)(r.borderLeftWidth),e+=(0,sr.int)(r.borderRightWidth),e}function ng(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,sr.int)(r.paddingTop),e-=(0,sr.int)(r.paddingBottom),e}function ag(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,sr.int)(r.paddingLeft),e-=(0,sr.int)(r.paddingRight),e}function sg(s,e,r){var i=e===e.ownerDocument.body,t=i?{left:0,top:0}:e.getBoundingClientRect(),n=(s.clientX+e.scrollLeft-t.left)/r,a=(s.clientY+e.scrollTop-t.top)/r;return{x:n,y:a}}function og(s,e){var r=jo(s,e,"px");return qu({},(0,Xu.browserPrefixToKey)("transform",Xu.default),r)}function lg(s,e){var r=jo(s,e,"");return r}function jo(s,e,r){var i=s.x,t=s.y,n="translate(".concat(i).concat(r,",").concat(t).concat(r,")");if(e){var a="".concat(typeof e.x=="string"?e.x:e.x+r),o="".concat(typeof e.y=="string"?e.y:e.y+r);n="translate(".concat(a,", ").concat(o,")")+n}return n}function ug(s,e){return s.targetTouches&&(0,sr.findInArray)(s.targetTouches,function(r){return e===r.identifier})||s.changedTouches&&(0,sr.findInArray)(s.changedTouches,function(r){return e===r.identifier})}function fg(s){if(s.targetTouches&&s.targetTouches[0])return s.targetTouches[0].identifier;if(s.changedTouches&&s.changedTouches[0])return s.changedTouches[0].identifier}function dg(s){if(!!s){var e=s.getElementById("react-draggable-style-el");e||(e=s.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,s.getElementsByTagName("head")[0].appendChild(e)),s.body&&tf(s.body,"react-draggable-transparent-selection")}}function cg(s){if(!!s)try{if(s.body&&rf(s.body,"react-draggable-transparent-selection"),s.selection)s.selection.empty();else{var e=(s.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch(r){}}function tf(s,e){s.classList?s.classList.add(e):s.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(s.className+=" ".concat(e))}function rf(s,e){s.classList?s.classList.remove(e):s.className=s.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var $r={};Object.defineProperty($r,"__esModule",{value:!0});$r.getBoundPosition=hg;$r.snapToGrid=pg;$r.canDragX=vg;$r.canDragY=gg;$r.getControlPosition=mg;$r.createCoreData=yg;$r.createDraggableData=Eg;var or=Hr,nn=bt;function hg(s,e,r){if(!s.props.bounds)return[e,r];var i=s.props.bounds;i=typeof i=="string"?i:_g(i);var t=Wo(s);if(typeof i=="string"){var n=t.ownerDocument,a=n.defaultView,o;if(i==="parent"?o=t.parentNode:o=n.querySelector(i),!(o instanceof a.HTMLElement))throw new Error('Bounds selector "'+i+'" could not find an element.');var l=o,h=a.getComputedStyle(t),p=a.getComputedStyle(l);i={left:-t.offsetLeft+(0,or.int)(p.paddingLeft)+(0,or.int)(h.marginLeft),top:-t.offsetTop+(0,or.int)(p.paddingTop)+(0,or.int)(h.marginTop),right:(0,nn.innerWidth)(l)-(0,nn.outerWidth)(t)-t.offsetLeft+(0,or.int)(p.paddingRight)-(0,or.int)(h.marginRight),bottom:(0,nn.innerHeight)(l)-(0,nn.outerHeight)(t)-t.offsetTop+(0,or.int)(p.paddingBottom)-(0,or.int)(h.marginBottom)}}return(0,or.isNum)(i.right)&&(e=Math.min(e,i.right)),(0,or.isNum)(i.bottom)&&(r=Math.min(r,i.bottom)),(0,or.isNum)(i.left)&&(e=Math.max(e,i.left)),(0,or.isNum)(i.top)&&(r=Math.max(r,i.top)),[e,r]}function pg(s,e,r){var i=Math.round(e/s[0])*s[0],t=Math.round(r/s[1])*s[1];return[i,t]}function vg(s){return s.props.axis==="both"||s.props.axis==="x"}function gg(s){return s.props.axis==="both"||s.props.axis==="y"}function mg(s,e,r){var i=typeof e=="number"?(0,nn.getTouch)(s,e):null;if(typeof e=="number"&&!i)return null;var t=Wo(r),n=r.props.offsetParent||t.offsetParent||t.ownerDocument.body;return(0,nn.offsetXYFromParent)(i||s,n,r.props.scale)}function yg(s,e,r){var i=s.state,t=!(0,or.isNum)(i.lastX),n=Wo(s);return t?{node:n,deltaX:0,deltaY:0,lastX:e,lastY:r,x:e,y:r}:{node:n,deltaX:e-i.lastX,deltaY:r-i.lastY,lastX:i.lastX,lastY:i.lastY,x:e,y:r}}function Eg(s,e){var r=s.props.scale;return{node:e.node,x:s.state.x+e.deltaX/r,y:s.state.y+e.deltaY/r,deltaX:e.deltaX/r,deltaY:e.deltaY/r,lastX:s.state.x,lastY:s.state.y}}function _g(s){return{left:s.left,top:s.top,right:s.right,bottom:s.bottom}}function Wo(s){var e=s.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var qa={},es={};Object.defineProperty(es,"__esModule",{value:!0});es.default=xg;function xg(){}function Wn(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wn=function(r){return typeof r}:Wn=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wn(s)}Object.defineProperty(qa,"__esModule",{value:!0});qa.default=void 0;var zo=Sg(Ye.exports),lr=Ko(cu.exports),bg=Ko(Mn.exports),Vt=bt,Li=$r,Vo=Hr,zn=Ko(es);function Ko(s){return s&&s.__esModule?s:{default:s}}function nf(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(nf=function(t){return t?r:e})(s)}function Sg(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||Wn(s)!=="object"&&typeof s!="function")return{default:s};var r=nf(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Tg(s,e){return Lg(s)||Og(s,e)||wg(s,e)||Ag()}function Ag(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wg(s,e){if(!!s){if(typeof s=="string")return af(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return af(s,e)}}function af(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Og(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Lg(s){if(Array.isArray(s))return s}function Ig(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function sf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function Rg(s,e,r){return e&&sf(s.prototype,e),r&&sf(s,r),s}function Dg(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&Ho(s,e)}function Ho(s,e){return Ho=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},Ho(s,e)}function Cg(s){var e=Mg();return function(){var i=ts(s),t;if(e){var n=ts(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return Pg(this,t)}}function Pg(s,e){if(e&&(Wn(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kt(s)}function Kt(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Mg(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function ts(s){return ts=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ts(s)}function xr(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var Pr={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},ci=Pr.mouse,rs=function(s){Dg(r,s);var e=Cg(r);function r(){var i;Ig(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),xr(Kt(i),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),xr(Kt(i),"mounted",!1),xr(Kt(i),"handleDragStart",function(o){if(i.props.onMouseDown(o),!i.props.allowAnyClick&&typeof o.button=="number"&&o.button!==0)return!1;var l=i.findDOMNode();if(!l||!l.ownerDocument||!l.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var h=l.ownerDocument;if(!(i.props.disabled||!(o.target instanceof h.defaultView.Node)||i.props.handle&&!(0,Vt.matchesSelectorAndParentsTo)(o.target,i.props.handle,l)||i.props.cancel&&(0,Vt.matchesSelectorAndParentsTo)(o.target,i.props.cancel,l))){o.type==="touchstart"&&o.preventDefault();var p=(0,Vt.getTouchIdentifier)(o);i.setState({touchIdentifier:p});var u=(0,Li.getControlPosition)(o,p,Kt(i));if(u!=null){var f=u.x,g=u.y,E=(0,Li.createCoreData)(Kt(i),f,g);(0,zn.default)("DraggableCore: handleDragStart: %j",E),(0,zn.default)("calling",i.props.onStart);var S=i.props.onStart(o,E);S===!1||i.mounted===!1||(i.props.enableUserSelectHack&&(0,Vt.addUserSelectStyles)(h),i.setState({dragging:!0,lastX:f,lastY:g}),(0,Vt.addEvent)(h,ci.move,i.handleDrag),(0,Vt.addEvent)(h,ci.stop,i.handleDragStop))}}}),xr(Kt(i),"handleDrag",function(o){var l=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Kt(i));if(l!=null){var h=l.x,p=l.y;if(Array.isArray(i.props.grid)){var u=h-i.state.lastX,f=p-i.state.lastY,g=(0,Li.snapToGrid)(i.props.grid,u,f),E=Tg(g,2);if(u=E[0],f=E[1],!u&&!f)return;h=i.state.lastX+u,p=i.state.lastY+f}var S=(0,Li.createCoreData)(Kt(i),h,p);(0,zn.default)("DraggableCore: handleDrag: %j",S);var _=i.props.onDrag(o,S);if(_===!1||i.mounted===!1){try{i.handleDragStop(new MouseEvent("mouseup"))}catch(c){var m=document.createEvent("MouseEvents");m.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.handleDragStop(m)}return}i.setState({lastX:h,lastY:p})}}),xr(Kt(i),"handleDragStop",function(o){if(!!i.state.dragging){var l=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Kt(i));if(l!=null){var h=l.x,p=l.y,u=(0,Li.createCoreData)(Kt(i),h,p),f=i.props.onStop(o,u);if(f===!1||i.mounted===!1)return!1;var g=i.findDOMNode();g&&i.props.enableUserSelectHack&&(0,Vt.removeUserSelectStyles)(g.ownerDocument),(0,zn.default)("DraggableCore: handleDragStop: %j",u),i.setState({dragging:!1,lastX:NaN,lastY:NaN}),g&&((0,zn.default)("DraggableCore: Removing handlers"),(0,Vt.removeEvent)(g.ownerDocument,ci.move,i.handleDrag),(0,Vt.removeEvent)(g.ownerDocument,ci.stop,i.handleDragStop))}}}),xr(Kt(i),"onMouseDown",function(o){return ci=Pr.mouse,i.handleDragStart(o)}),xr(Kt(i),"onMouseUp",function(o){return ci=Pr.mouse,i.handleDragStop(o)}),xr(Kt(i),"onTouchStart",function(o){return ci=Pr.touch,i.handleDragStart(o)}),xr(Kt(i),"onTouchEnd",function(o){return ci=Pr.touch,i.handleDragStop(o)}),i}return Rg(r,[{key:"componentDidMount",value:function(){this.mounted=!0;var t=this.findDOMNode();t&&(0,Vt.addEvent)(t,Pr.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var t=this.findDOMNode();if(t){var n=t.ownerDocument;(0,Vt.removeEvent)(n,Pr.mouse.move,this.handleDrag),(0,Vt.removeEvent)(n,Pr.touch.move,this.handleDrag),(0,Vt.removeEvent)(n,Pr.mouse.stop,this.handleDragStop),(0,Vt.removeEvent)(n,Pr.touch.stop,this.handleDragStop),(0,Vt.removeEvent)(t,Pr.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Vt.removeUserSelectStyles)(n)}}},{key:"findDOMNode",value:function(){var t,n,a;return(t=(n=this.props)===null||n===void 0||(a=n.nodeRef)===null||a===void 0?void 0:a.current)!==null&&t!==void 0?t:bg.default.findDOMNode(this)}},{key:"render",value:function(){return zo.cloneElement(zo.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),r}(zo.Component);qa.default=rs;xr(rs,"displayName","DraggableCore");xr(rs,"propTypes",{allowAnyClick:lr.default.bool,disabled:lr.default.bool,enableUserSelectHack:lr.default.bool,offsetParent:function(e,r){if(e[r]&&e[r].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:lr.default.arrayOf(lr.default.number),handle:lr.default.string,cancel:lr.default.string,nodeRef:lr.default.object,onStart:lr.default.func,onDrag:lr.default.func,onStop:lr.default.func,onMouseDown:lr.default.func,scale:lr.default.number,className:Vo.dontSetMe,style:Vo.dontSetMe,transform:Vo.dontSetMe});xr(rs,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(s){function e(F){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(V){return typeof V}:e=function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},e(F)}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"DraggableCore",{enumerable:!0,get:function(){return h.default}}),s.default=void 0;var r=E(Ye.exports),i=f(cu.exports),t=f(Mn.exports),n=f(Vv),a=bt,o=$r,l=Hr,h=f(qa),p=f(es),u=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function f(F){return F&&F.__esModule?F:{default:F}}function g(F){if(typeof WeakMap!="function")return null;var j=new WeakMap,V=new WeakMap;return(g=function(Y){return Y?V:j})(F)}function E(F,j){if(!j&&F&&F.__esModule)return F;if(F===null||e(F)!=="object"&&typeof F!="function")return{default:F};var V=g(j);if(V&&V.has(F))return V.get(F);var G={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in F)if(X!=="default"&&Object.prototype.hasOwnProperty.call(F,X)){var ie=Y?Object.getOwnPropertyDescriptor(F,X):null;ie&&(ie.get||ie.set)?Object.defineProperty(G,X,ie):G[X]=F[X]}return G.default=F,V&&V.set(F,G),G}function S(){return S=Object.assign||function(F){for(var j=1;j<arguments.length;j++){var V=arguments[j];for(var G in V)Object.prototype.hasOwnProperty.call(V,G)&&(F[G]=V[G])}return F},S.apply(this,arguments)}function _(F,j){if(F==null)return{};var V=m(F,j),G,Y;if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(F);for(Y=0;Y<X.length;Y++)G=X[Y],!(j.indexOf(G)>=0)&&(!Object.prototype.propertyIsEnumerable.call(F,G)||(V[G]=F[G]))}return V}function m(F,j){if(F==null)return{};var V={},G=Object.keys(F),Y,X;for(X=0;X<G.length;X++)Y=G[X],!(j.indexOf(Y)>=0)&&(V[Y]=F[Y]);return V}function c(F,j){var V=Object.keys(F);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(F);j&&(G=G.filter(function(Y){return Object.getOwnPropertyDescriptor(F,Y).enumerable})),V.push.apply(V,G)}return V}function v(F){for(var j=1;j<arguments.length;j++){var V=arguments[j]!=null?arguments[j]:{};j%2?c(Object(V),!0).forEach(function(G){B(F,G,V[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(V)):c(Object(V)).forEach(function(G){Object.defineProperty(F,G,Object.getOwnPropertyDescriptor(V,G))})}return F}function y(F,j){return A(F)||T(F,j)||x(F,j)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x(F,j){if(!!F){if(typeof F=="string")return b(F,j);var V=Object.prototype.toString.call(F).slice(8,-1);if(V==="Object"&&F.constructor&&(V=F.constructor.name),V==="Map"||V==="Set")return Array.from(F);if(V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V))return b(F,j)}}function b(F,j){(j==null||j>F.length)&&(j=F.length);for(var V=0,G=new Array(j);V<j;V++)G[V]=F[V];return G}function T(F,j){var V=F==null?null:typeof Symbol!="undefined"&&F[Symbol.iterator]||F["@@iterator"];if(V!=null){var G=[],Y=!0,X=!1,ie,he;try{for(V=V.call(F);!(Y=(ie=V.next()).done)&&(G.push(ie.value),!(j&&G.length===j));Y=!0);}catch(de){X=!0,he=de}finally{try{!Y&&V.return!=null&&V.return()}finally{if(X)throw he}}return G}}function A(F){if(Array.isArray(F))return F}function L(F,j){if(!(F instanceof j))throw new TypeError("Cannot call a class as a function")}function R(F,j){for(var V=0;V<j.length;V++){var G=j[V];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(F,G.key,G)}}function w(F,j,V){return j&&R(F.prototype,j),V&&R(F,V),F}function O(F,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(j&&j.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),j&&I(F,j)}function I(F,j){return I=Object.setPrototypeOf||function(G,Y){return G.__proto__=Y,G},I(F,j)}function D(F){var j=M();return function(){var G=N(F),Y;if(j){var X=N(this).constructor;Y=Reflect.construct(G,arguments,X)}else Y=G.apply(this,arguments);return C(this,Y)}}function C(F,j){if(j&&(e(j)==="object"||typeof j=="function"))return j;if(j!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P(F)}function P(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(F){return!1}}function N(F){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(V){return V.__proto__||Object.getPrototypeOf(V)},N(F)}function B(F,j,V){return j in F?Object.defineProperty(F,j,{value:V,enumerable:!0,configurable:!0,writable:!0}):F[j]=V,F}var U=function(F){O(V,F);var j=D(V);function V(G){var Y;return L(this,V),Y=j.call(this,G),B(P(Y),"onDragStart",function(X,ie){(0,p.default)("Draggable: onDragStart: %j",ie);var he=Y.props.onStart(X,(0,o.createDraggableData)(P(Y),ie));if(he===!1)return!1;Y.setState({dragging:!0,dragged:!0})}),B(P(Y),"onDrag",function(X,ie){if(!Y.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",ie);var he=(0,o.createDraggableData)(P(Y),ie),de={x:he.x,y:he.y};if(Y.props.bounds){var Ae=de.x,pe=de.y;de.x+=Y.state.slackX,de.y+=Y.state.slackY;var le=(0,o.getBoundPosition)(P(Y),de.x,de.y),Ie=y(le,2),Ce=Ie[0],Ue=Ie[1];de.x=Ce,de.y=Ue,de.slackX=Y.state.slackX+(Ae-de.x),de.slackY=Y.state.slackY+(pe-de.y),he.x=de.x,he.y=de.y,he.deltaX=de.x-Y.state.x,he.deltaY=de.y-Y.state.y}var Me=Y.props.onDrag(X,he);if(Me===!1)return!1;Y.setState(de)}),B(P(Y),"onDragStop",function(X,ie){if(!Y.state.dragging)return!1;var he=Y.props.onStop(X,(0,o.createDraggableData)(P(Y),ie));if(he===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",ie);var de={dragging:!1,slackX:0,slackY:0},Ae=Boolean(Y.props.position);if(Ae){var pe=Y.props.position,le=pe.x,Ie=pe.y;de.x=le,de.y=Ie}Y.setState(de)}),Y.state={dragging:!1,dragged:!1,x:G.position?G.position.x:G.defaultPosition.x,y:G.position?G.position.y:G.defaultPosition.y,prevPropsPosition:v({},G.position),slackX:0,slackY:0,isElementSVG:!1},G.position&&!(G.onDrag||G.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),Y}return w(V,[{key:"componentDidMount",value:function(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var Y,X,ie;return(Y=(X=this.props)===null||X===void 0||(ie=X.nodeRef)===null||ie===void 0?void 0:ie.current)!==null&&Y!==void 0?Y:t.default.findDOMNode(this)}},{key:"render",value:function(){var Y,X=this.props;X.axis,X.bounds;var ie=X.children,he=X.defaultPosition,de=X.defaultClassName,Ae=X.defaultClassNameDragging,pe=X.defaultClassNameDragged,le=X.position,Ie=X.positionOffset;X.scale;var Ce=_(X,u),Ue={},Me=null,ze=Boolean(le),Ge=!ze||this.state.dragging,$e=le||he,He={x:(0,o.canDragX)(this)&&Ge?this.state.x:$e.x,y:(0,o.canDragY)(this)&&Ge?this.state.y:$e.y};this.state.isElementSVG?Me=(0,a.createSVGTransform)(He,Ie):Ue=(0,a.createCSSTransform)(He,Ie);var Fe=(0,n.default)(ie.props.className||"",de,(Y={},B(Y,Ae,this.state.dragging),B(Y,pe,this.state.dragged),Y));return r.createElement(h.default,S({},Ce,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(ie),{className:Fe,style:v(v({},ie.props.style),Ue),transform:Me}))}}],[{key:"getDerivedStateFromProps",value:function(Y,X){var ie=Y.position,he=X.prevPropsPosition;return ie&&(!he||ie.x!==he.x||ie.y!==he.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:ie,prevPropsPosition:he}),{x:ie.x,y:ie.y,prevPropsPosition:v({},ie)}):null}}]),V}(r.Component);s.default=U,B(U,"displayName","Draggable"),B(U,"propTypes",v(v({},h.default.propTypes),{},{axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe})),B(U,"defaultProps",v(v({},h.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))})($u);var of=$u,lf=of.default,kg=of.DraggableCore;Za.exports=lf;Za.exports.default=lf;Za.exports.DraggableCore=kg;var uf=Za.exports;/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ff(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function Gr(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ff(Object(r),!0).forEach(function(i){Ng(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ff(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function is(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?is=function(e){return typeof e}:is=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},is(s)}function Ng(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Yr(){return Yr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Yr.apply(this,arguments)}function Fg(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Bg(s,e){if(s==null)return{};var r=Fg(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}var Ug="1.14.0";function ri(s){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(s)}var ii=ri(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Vn=ri(/Edge/i),df=ri(/firefox/i),Kn=ri(/safari/i)&&!ri(/chrome/i)&&!ri(/android/i),cf=ri(/iP(ad|od|hone)/i),jg=ri(/chrome/i)&&ri(/android/i),hf={capture:!1,passive:!1};function ut(s,e,r){s.addEventListener(e,r,!ii&&hf)}function lt(s,e,r){s.removeEventListener(e,r,!ii&&hf)}function ns(s,e){if(!!e){if(e[0]===">"&&(e=e.substring(1)),s)try{if(s.matches)return s.matches(e);if(s.msMatchesSelector)return s.msMatchesSelector(e);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(e)}catch(r){return!1}return!1}}function Wg(s){return s.host&&s!==document&&s.host.nodeType?s.host:s.parentNode}function Xr(s,e,r,i){if(s){r=r||document;do{if(e!=null&&(e[0]===">"?s.parentNode===r&&ns(s,e):ns(s,e))||i&&s===r)return s;if(s===r)break}while(s=Wg(s))}return null}var pf=/\s+/g;function Ht(s,e,r){if(s&&e)if(s.classList)s.classList[r?"add":"remove"](e);else{var i=(" "+s.className+" ").replace(pf," ").replace(" "+e+" "," ");s.className=(i+(r?" "+e:"")).replace(pf," ")}}function qe(s,e,r){var i=s&&s.style;if(i){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(r=s.currentStyle),e===void 0?r:r[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=r+(typeof r=="string"?"":"px")}}function an(s,e){var r="";if(typeof s=="string")r=s;else do{var i=qe(s,"transform");i&&i!=="none"&&(r=i+" "+r)}while(!e&&(s=s.parentNode));var t=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return t&&new t(r)}function vf(s,e,r){if(s){var i=s.getElementsByTagName(e),t=0,n=i.length;if(r)for(;t<n;t++)r(i[t],t);return i}return[]}function Zr(){var s=document.scrollingElement;return s||document.documentElement}function Ct(s,e,r,i,t){if(!(!s.getBoundingClientRect&&s!==window)){var n,a,o,l,h,p,u;if(s!==window&&s.parentNode&&s!==Zr()?(n=s.getBoundingClientRect(),a=n.top,o=n.left,l=n.bottom,h=n.right,p=n.height,u=n.width):(a=0,o=0,l=window.innerHeight,h=window.innerWidth,p=window.innerHeight,u=window.innerWidth),(e||r)&&s!==window&&(t=t||s.parentNode,!ii))do if(t&&t.getBoundingClientRect&&(qe(t,"transform")!=="none"||r&&qe(t,"position")!=="static")){var f=t.getBoundingClientRect();a-=f.top+parseInt(qe(t,"border-top-width")),o-=f.left+parseInt(qe(t,"border-left-width")),l=a+n.height,h=o+n.width;break}while(t=t.parentNode);if(i&&s!==window){var g=an(t||s),E=g&&g.a,S=g&&g.d;g&&(a/=S,o/=E,u/=E,p/=S,l=a+p,h=o+u)}return{top:a,left:o,bottom:l,right:h,width:u,height:p}}}function gf(s,e,r){for(var i=hi(s,!0),t=Ct(s)[e];i;){var n=Ct(i)[r],a=void 0;if(r==="top"||r==="left"?a=t>=n:a=t<=n,!a)return i;if(i===Zr())break;i=hi(i,!1)}return!1}function sn(s,e,r,i){for(var t=0,n=0,a=s.children;n<a.length;){if(a[n].style.display!=="none"&&a[n]!==Je.ghost&&(i||a[n]!==Je.dragged)&&Xr(a[n],r.draggable,s,!1)){if(t===e)return a[n];t++}n++}return null}function $o(s,e){for(var r=s.lastElementChild;r&&(r===Je.ghost||qe(r,"display")==="none"||e&&!ns(r,e));)r=r.previousElementSibling;return r||null}function er(s,e){var r=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()!=="TEMPLATE"&&s!==Je.clone&&(!e||ns(s,e))&&r++;return r}function mf(s){var e=0,r=0,i=Zr();if(s)do{var t=an(s),n=t.a,a=t.d;e+=s.scrollLeft*n,r+=s.scrollTop*a}while(s!==i&&(s=s.parentNode));return[e,r]}function zg(s,e){for(var r in s)if(!!s.hasOwnProperty(r)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===s[r][i])return Number(r)}return-1}function hi(s,e){if(!s||!s.getBoundingClientRect)return Zr();var r=s,i=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var t=qe(r);if(r.clientWidth<r.scrollWidth&&(t.overflowX=="auto"||t.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(t.overflowY=="auto"||t.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return Zr();if(i||e)return r;i=!0}}while(r=r.parentNode);return Zr()}function Vg(s,e){if(s&&e)for(var r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);return s}function Go(s,e){return Math.round(s.top)===Math.round(e.top)&&Math.round(s.left)===Math.round(e.left)&&Math.round(s.height)===Math.round(e.height)&&Math.round(s.width)===Math.round(e.width)}var Hn;function yf(s,e){return function(){if(!Hn){var r=arguments,i=this;r.length===1?s.call(i,r[0]):s.apply(i,r),Hn=setTimeout(function(){Hn=void 0},e)}}}function Kg(){clearTimeout(Hn),Hn=void 0}function Ef(s,e,r){s.scrollLeft+=e,s.scrollTop+=r}function _f(s){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(s).cloneNode(!0):r?r(s).clone(!0)[0]:s.cloneNode(!0)}var ur="Sortable"+new Date().getTime();function Hg(){var s=[],e;return{captureAnimationState:function(){if(s=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(t){if(!(qe(t,"display")==="none"||t===Je.ghost)){s.push({target:t,rect:Ct(t)});var n=Gr({},s[s.length-1].rect);if(t.thisAnimationDuration){var a=an(t,!0);a&&(n.top-=a.f,n.left-=a.e)}t.fromRect=n}})}},addAnimationState:function(i){s.push(i)},removeAnimationState:function(i){s.splice(zg(s,{target:i}),1)},animateAll:function(i){var t=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var n=!1,a=0;s.forEach(function(o){var l=0,h=o.target,p=h.fromRect,u=Ct(h),f=h.prevFromRect,g=h.prevToRect,E=o.rect,S=an(h,!0);S&&(u.top-=S.f,u.left-=S.e),h.toRect=u,h.thisAnimationDuration&&Go(f,u)&&!Go(p,u)&&(E.top-u.top)/(E.left-u.left)==(p.top-u.top)/(p.left-u.left)&&(l=Gg(E,f,g,t.options)),Go(u,p)||(h.prevFromRect=p,h.prevToRect=u,l||(l=t.options.animation),t.animate(h,E,u,l)),l&&(n=!0,a=Math.max(a,l),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},l),h.thisAnimationDuration=l)}),clearTimeout(e),n?e=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),s=[]},animate:function(i,t,n,a){if(a){qe(i,"transition",""),qe(i,"transform","");var o=an(this.el),l=o&&o.a,h=o&&o.d,p=(t.left-n.left)/(l||1),u=(t.top-n.top)/(h||1);i.animatingX=!!p,i.animatingY=!!u,qe(i,"transform","translate3d("+p+"px,"+u+"px,0)"),this.forRepaintDummy=$g(i),qe(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),qe(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){qe(i,"transition",""),qe(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function $g(s){return s.offsetWidth}function Gg(s,e,r,i){return Math.sqrt(Math.pow(e.top-s.top,2)+Math.pow(e.left-s.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*i.animation}var on=[],Yo={initializeByDefault:!0},$n={mount:function(e){for(var r in Yo)Yo.hasOwnProperty(r)&&!(r in e)&&(e[r]=Yo[r]);on.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),on.push(e)},pluginEvent:function(e,r,i){var t=this;this.eventCanceled=!1,i.cancel=function(){t.eventCanceled=!0};var n=e+"Global";on.forEach(function(a){!r[a.pluginName]||(r[a.pluginName][n]&&r[a.pluginName][n](Gr({sortable:r},i)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e](Gr({sortable:r},i)))})},initializePlugins:function(e,r,i,t){on.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var h=new o(e,r,e.options);h.sortable=e,h.options=e.options,e[l]=h,Yr(i,h.defaults)}});for(var n in e.options)if(!!e.options.hasOwnProperty(n)){var a=this.modifyOption(e,n,e.options[n]);typeof a!="undefined"&&(e.options[n]=a)}},getEventProperties:function(e,r){var i={};return on.forEach(function(t){typeof t.eventProperties=="function"&&Yr(i,t.eventProperties.call(r[t.pluginName],e))}),i},modifyOption:function(e,r,i){var t;return on.forEach(function(n){!e[n.pluginName]||n.optionListeners&&typeof n.optionListeners[r]=="function"&&(t=n.optionListeners[r].call(e[n.pluginName],i))}),t}};function Yg(s){var e=s.sortable,r=s.rootEl,i=s.name,t=s.targetEl,n=s.cloneEl,a=s.toEl,o=s.fromEl,l=s.oldIndex,h=s.newIndex,p=s.oldDraggableIndex,u=s.newDraggableIndex,f=s.originalEvent,g=s.putSortable,E=s.extraEventProperties;if(e=e||r&&r[ur],!!e){var S,_=e.options,m="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!ii&&!Vn?S=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(i,!0,!0)),S.to=a||r,S.from=o||r,S.item=t||r,S.clone=n,S.oldIndex=l,S.newIndex=h,S.oldDraggableIndex=p,S.newDraggableIndex=u,S.originalEvent=f,S.pullMode=g?g.lastPutMode:void 0;var c=Gr(Gr({},E),$n.getEventProperties(i,e));for(var v in c)S[v]=c[v];r&&r.dispatchEvent(S),_[m]&&_[m].call(e,S)}}var Xg=["evt"],tr=function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=i.evt,n=Bg(i,Xg);$n.pluginEvent.bind(Je)(e,r,Gr({dragEl:Pe,parentEl:St,ghostEl:tt,rootEl:gt,nextEl:Ii,lastDownEl:as,cloneEl:Tt,cloneHidden:pi,dragStarted:Yn,putSortable:Bt,activeSortable:Je.active,originalEvent:t,oldIndex:ln,oldDraggableIndex:Gn,newIndex:fr,newDraggableIndex:vi,hideGhostForTarget:Of,unhideGhostForTarget:Lf,cloneNowHidden:function(){pi=!0},cloneNowShown:function(){pi=!1},dispatchSortableEvent:function(o){Zt({sortable:r,name:o,originalEvent:t})}},n))};function Zt(s){Yg(Gr({putSortable:Bt,cloneEl:Tt,targetEl:Pe,rootEl:gt,oldIndex:ln,oldDraggableIndex:Gn,newIndex:fr,newDraggableIndex:vi},s))}var Pe,St,tt,gt,Ii,as,Tt,pi,ln,fr,Gn,vi,ss,Bt,un=!1,os=!1,ls=[],Ri,Mr,Xo,Zo,xf,bf,Yn,fn,Xn,Zn=!1,us=!1,fs,$t,Qo=[],Jo=!1,ds=[],cs=typeof document!="undefined",hs=cf,Sf=Vn||ii?"cssFloat":"float",Zg=cs&&!jg&&!cf&&"draggable"in document.createElement("div"),Tf=function(){if(!!cs){if(ii)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),Af=function(e,r){var i=qe(e),t=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=sn(e,0,r),a=sn(e,1,r),o=n&&qe(n),l=a&&qe(a),h=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Ct(n).width,p=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Ct(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&o.float&&o.float!=="none"){var u=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===u)?"vertical":"horizontal"}return n&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||h>=t&&i[Sf]==="none"||a&&i[Sf]==="none"&&h+p>t)?"vertical":"horizontal"},Qg=function(e,r,i){var t=i?e.left:e.top,n=i?e.right:e.bottom,a=i?e.width:e.height,o=i?r.left:r.top,l=i?r.right:r.bottom,h=i?r.width:r.height;return t===o||n===l||t+a/2===o+h/2},Jg=function(e,r){var i;return ls.some(function(t){var n=t[ur].options.emptyInsertThreshold;if(!(!n||$o(t))){var a=Ct(t),o=e>=a.left-n&&e<=a.right+n,l=r>=a.top-n&&r<=a.bottom+n;if(o&&l)return i=t}}),i},wf=function(e){function r(n,a){return function(o,l,h,p){var u=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(n==null&&(a||u))return!0;if(n==null||n===!1)return!1;if(a&&n==="clone")return n;if(typeof n=="function")return r(n(o,l,h,p),a)(o,l,h,p);var f=(a?o:l).options.group.name;return n===!0||typeof n=="string"&&n===f||n.join&&n.indexOf(f)>-1}}var i={},t=e.group;(!t||is(t)!="object")&&(t={name:t}),i.name=t.name,i.checkPull=r(t.pull,!0),i.checkPut=r(t.put),i.revertClone=t.revertClone,e.group=i},Of=function(){!Tf&&tt&&qe(tt,"display","none")},Lf=function(){!Tf&&tt&&qe(tt,"display","")};cs&&document.addEventListener("click",function(s){if(os)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),os=!1,!1},!0);var Di=function(e){if(Pe){e=e.touches?e.touches[0]:e;var r=Jg(e.clientX,e.clientY);if(r){var i={};for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);i.target=i.rootEl=r,i.preventDefault=void 0,i.stopPropagation=void 0,r[ur]._onDragOver(i)}}},qg=function(e){Pe&&Pe.parentNode[ur]._isOutsideThisEl(e.target)};function Je(s,e){if(!(s&&s.nodeType&&s.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=e=Yr({},e),s[ur]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Af(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Je.supportPointer!==!1&&"PointerEvent"in window&&!Kn,emptyInsertThreshold:5};$n.initializePlugins(this,s,r);for(var i in r)!(i in e)&&(e[i]=r[i]);wf(e);for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this));this.nativeDraggable=e.forceFallback?!1:Zg,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ut(s,"pointerdown",this._onTapStart):(ut(s,"mousedown",this._onTapStart),ut(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(ut(s,"dragover",this),ut(s,"dragenter",this)),ls.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Yr(this,Hg())}Je.prototype={constructor:Je,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(fn=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,Pe):this.options.direction},_onTapStart:function(e){if(!!e.cancelable){var r=this,i=this.el,t=this.options,n=t.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,h=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,p=t.filter;if(om(i),!Pe&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||t.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&Kn&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Xr(l,t.draggable,i,!1),!(l&&l.animated)&&as!==l)){if(ln=er(l),Gn=er(l,t.draggable),typeof p=="function"){if(p.call(this,e,l,this)){Zt({sortable:r,rootEl:h,name:"filter",targetEl:l,toEl:i,fromEl:i}),tr("filter",r,{evt:e}),n&&e.cancelable&&e.preventDefault();return}}else if(p&&(p=p.split(",").some(function(u){if(u=Xr(h,u.trim(),i,!1),u)return Zt({sortable:r,rootEl:u,name:"filter",targetEl:l,fromEl:i,toEl:i}),tr("filter",r,{evt:e}),!0}),p)){n&&e.cancelable&&e.preventDefault();return}t.handle&&!Xr(h,t.handle,i,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,i){var t=this,n=t.el,a=t.options,o=n.ownerDocument,l;if(i&&!Pe&&i.parentNode===n){var h=Ct(i);if(gt=n,Pe=i,St=Pe.parentNode,Ii=Pe.nextSibling,as=i,ss=a.group,Je.dragged=Pe,Ri={target:Pe,clientX:(r||e).clientX,clientY:(r||e).clientY},xf=Ri.clientX-h.left,bf=Ri.clientY-h.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,Pe.style["will-change"]="all",l=function(){if(tr("delayEnded",t,{evt:e}),Je.eventCanceled){t._onDrop();return}t._disableDelayedDragEvents(),!df&&t.nativeDraggable&&(Pe.draggable=!0),t._triggerDragStart(e,r),Zt({sortable:t,name:"choose",originalEvent:e}),Ht(Pe,a.chosenClass,!0)},a.ignore.split(",").forEach(function(p){vf(Pe,p.trim(),qo)}),ut(o,"dragover",Di),ut(o,"mousemove",Di),ut(o,"touchmove",Di),ut(o,"mouseup",t._onDrop),ut(o,"touchend",t._onDrop),ut(o,"touchcancel",t._onDrop),df&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Pe.draggable=!0),tr("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(Vn||ii))){if(Je.eventCanceled){this._onDrop();return}ut(o,"mouseup",t._disableDelayedDrag),ut(o,"touchend",t._disableDelayedDrag),ut(o,"touchcancel",t._disableDelayedDrag),ut(o,"mousemove",t._delayedDragTouchMoveHandler),ut(o,"touchmove",t._delayedDragTouchMoveHandler),a.supportPointer&&ut(o,"pointermove",t._delayedDragTouchMoveHandler),t._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Pe&&qo(Pe),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._disableDelayedDrag),lt(e,"touchend",this._disableDelayedDrag),lt(e,"touchcancel",this._disableDelayedDrag),lt(e,"mousemove",this._delayedDragTouchMoveHandler),lt(e,"touchmove",this._delayedDragTouchMoveHandler),lt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?ut(document,"pointermove",this._onTouchMove):r?ut(document,"touchmove",this._onTouchMove):ut(document,"mousemove",this._onTouchMove):(ut(Pe,"dragend",this),ut(gt,"dragstart",this._onDragStart));try{document.selection?vs(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(e,r){if(un=!1,gt&&Pe){tr("dragStarted",this,{evt:r}),this.nativeDraggable&&ut(document,"dragover",qg);var i=this.options;!e&&Ht(Pe,i.dragClass,!1),Ht(Pe,i.ghostClass,!0),Je.active=this,e&&this._appendGhost(),Zt({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(Mr){this._lastX=Mr.clientX,this._lastY=Mr.clientY,Of();for(var e=document.elementFromPoint(Mr.clientX,Mr.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Mr.clientX,Mr.clientY),e!==r);)r=e;if(Pe.parentNode[ur]._isOutsideThisEl(e),r)do{if(r[ur]){var i=void 0;if(i=r[ur]._onDragOver({clientX:Mr.clientX,clientY:Mr.clientY,target:e,rootEl:r}),i&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);Lf()}},_onTouchMove:function(e){if(Ri){var r=this.options,i=r.fallbackTolerance,t=r.fallbackOffset,n=e.touches?e.touches[0]:e,a=tt&&an(tt,!0),o=tt&&a&&a.a,l=tt&&a&&a.d,h=hs&&$t&&mf($t),p=(n.clientX-Ri.clientX+t.x)/(o||1)+(h?h[0]-Qo[0]:0)/(o||1),u=(n.clientY-Ri.clientY+t.y)/(l||1)+(h?h[1]-Qo[1]:0)/(l||1);if(!Je.active&&!un){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(tt){a?(a.e+=p-(Xo||0),a.f+=u-(Zo||0)):a={a:1,b:0,c:0,d:1,e:p,f:u};var f="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");qe(tt,"webkitTransform",f),qe(tt,"mozTransform",f),qe(tt,"msTransform",f),qe(tt,"transform",f),Xo=p,Zo=u,Mr=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!tt){var e=this.options.fallbackOnBody?document.body:gt,r=Ct(Pe,!0,hs,!0,e),i=this.options;if(hs){for($t=e;qe($t,"position")==="static"&&qe($t,"transform")==="none"&&$t!==document;)$t=$t.parentNode;$t!==document.body&&$t!==document.documentElement?($t===document&&($t=Zr()),r.top+=$t.scrollTop,r.left+=$t.scrollLeft):$t=Zr(),Qo=mf($t)}tt=Pe.cloneNode(!0),Ht(tt,i.ghostClass,!1),Ht(tt,i.fallbackClass,!0),Ht(tt,i.dragClass,!0),qe(tt,"transition",""),qe(tt,"transform",""),qe(tt,"box-sizing","border-box"),qe(tt,"margin",0),qe(tt,"top",r.top),qe(tt,"left",r.left),qe(tt,"width",r.width),qe(tt,"height",r.height),qe(tt,"opacity","0.8"),qe(tt,"position",hs?"absolute":"fixed"),qe(tt,"zIndex","100000"),qe(tt,"pointerEvents","none"),Je.ghost=tt,e.appendChild(tt),qe(tt,"transform-origin",xf/parseInt(tt.style.width)*100+"% "+bf/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(e,r){var i=this,t=e.dataTransfer,n=i.options;if(tr("dragStart",this,{evt:e}),Je.eventCanceled){this._onDrop();return}tr("setupClone",this),Je.eventCanceled||(Tt=_f(Pe),Tt.draggable=!1,Tt.style["will-change"]="",this._hideClone(),Ht(Tt,this.options.chosenClass,!1),Je.clone=Tt),i.cloneId=vs(function(){tr("clone",i),!Je.eventCanceled&&(i.options.removeCloneOnHide||gt.insertBefore(Tt,Pe),i._hideClone(),Zt({sortable:i,name:"clone"}))}),!r&&Ht(Pe,n.dragClass,!0),r?(os=!0,i._loopId=setInterval(i._emulateDragOver,50)):(lt(document,"mouseup",i._onDrop),lt(document,"touchend",i._onDrop),lt(document,"touchcancel",i._onDrop),t&&(t.effectAllowed="move",n.setData&&n.setData.call(i,t,Pe)),ut(document,"drop",i),qe(Pe,"transform","translateZ(0)")),un=!0,i._dragStartId=vs(i._dragStarted.bind(i,r,e)),ut(document,"selectstart",i),Yn=!0,Kn&&qe(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,i=e.target,t,n,a,o=this.options,l=o.group,h=Je.active,p=ss===l,u=o.sort,f=Bt||h,g,E=this,S=!1;if(Jo)return;function _(M,N){tr(M,E,Gr({evt:e,isOwner:p,axis:g?"vertical":"horizontal",revert:a,dragRect:t,targetRect:n,canSort:u,fromSortable:f,target:i,completed:c,onMove:function(U,F){return ps(gt,r,Pe,t,U,Ct(U),e,F)},changed:v},N))}function m(){_("dragOverAnimationCapture"),E.captureAnimationState(),E!==f&&f.captureAnimationState()}function c(M){return _("dragOverCompleted",{insertion:M}),M&&(p?h._hideClone():h._showClone(E),E!==f&&(Ht(Pe,Bt?Bt.options.ghostClass:h.options.ghostClass,!1),Ht(Pe,o.ghostClass,!0)),Bt!==E&&E!==Je.active?Bt=E:E===Je.active&&Bt&&(Bt=null),f===E&&(E._ignoreWhileAnimating=i),E.animateAll(function(){_("dragOverAnimationComplete"),E._ignoreWhileAnimating=null}),E!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(i===Pe&&!Pe.animated||i===r&&!i.animated)&&(fn=null),!o.dragoverBubble&&!e.rootEl&&i!==document&&(Pe.parentNode[ur]._isOutsideThisEl(e.target),!M&&Di(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),S=!0}function v(){fr=er(Pe),vi=er(Pe,o.draggable),Zt({sortable:E,name:"change",toEl:r,newIndex:fr,newDraggableIndex:vi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=Xr(i,o.draggable,r,!0),_("dragOver"),Je.eventCanceled)return S;if(Pe.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||E._ignoreWhileAnimating===i)return c(!1);if(os=!1,h&&!o.disabled&&(p?u||(a=St!==gt):Bt===this||(this.lastPutMode=ss.checkPull(this,h,Pe,e))&&l.checkPut(this,h,Pe,e))){if(g=this._getDirection(e,i)==="vertical",t=Ct(Pe),_("dragOverValid"),Je.eventCanceled)return S;if(a)return St=gt,m(),this._hideClone(),_("revert"),Je.eventCanceled||(Ii?gt.insertBefore(Pe,Ii):gt.appendChild(Pe)),c(!0);var y=$o(r,o.draggable);if(!y||im(e,g,this)&&!y.animated){if(y===Pe)return c(!1);if(y&&r===e.target&&(i=y),i&&(n=Ct(i)),ps(gt,r,Pe,t,i,n,e,!!i)!==!1)return m(),r.appendChild(Pe),St=r,v(),c(!0)}else if(y&&rm(e,g,this)){var d=sn(r,0,o,!0);if(d===Pe)return c(!1);if(i=d,n=Ct(i),ps(gt,r,Pe,t,i,n,e,!1)!==!1)return m(),r.insertBefore(Pe,d),St=r,v(),c(!0)}else if(i.parentNode===r){n=Ct(i);var x=0,b,T=Pe.parentNode!==r,A=!Qg(Pe.animated&&Pe.toRect||t,i.animated&&i.toRect||n,g),L=g?"top":"left",R=gf(i,"top","top")||gf(Pe,"top","top"),w=R?R.scrollTop:void 0;fn!==i&&(b=n[L],Zn=!1,us=!A&&o.invertSwap||T),x=nm(e,i,n,g,A?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,us,fn===i);var O;if(x!==0){var I=er(Pe);do I-=x,O=St.children[I];while(O&&(qe(O,"display")==="none"||O===tt))}if(x===0||O===i)return c(!1);fn=i,Xn=x;var D=i.nextElementSibling,C=!1;C=x===1;var P=ps(gt,r,Pe,t,i,n,e,C);if(P!==!1)return(P===1||P===-1)&&(C=P===1),Jo=!0,setTimeout(tm,30),m(),C&&!D?r.appendChild(Pe):i.parentNode.insertBefore(Pe,C?D:i),R&&Ef(R,0,w-R.scrollTop),St=Pe.parentNode,b!==void 0&&!us&&(fs=Math.abs(b-Ct(i)[L])),v(),c(!0)}if(r.contains(Pe))return c(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){lt(document,"mousemove",this._onTouchMove),lt(document,"touchmove",this._onTouchMove),lt(document,"pointermove",this._onTouchMove),lt(document,"dragover",Di),lt(document,"mousemove",Di),lt(document,"touchmove",Di)},_offUpEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._onDrop),lt(e,"touchend",this._onDrop),lt(e,"pointerup",this._onDrop),lt(e,"touchcancel",this._onDrop),lt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,i=this.options;if(fr=er(Pe),vi=er(Pe,i.draggable),tr("drop",this,{evt:e}),St=Pe&&Pe.parentNode,fr=er(Pe),vi=er(Pe,i.draggable),Je.eventCanceled){this._nulling();return}un=!1,us=!1,Zn=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),el(this.cloneId),el(this._dragStartId),this.nativeDraggable&&(lt(document,"drop",this),lt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Kn&&qe(document.body,"user-select",""),qe(Pe,"transform",""),e&&(Yn&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(gt===St||Bt&&Bt.lastPutMode!=="clone")&&Tt&&Tt.parentNode&&Tt.parentNode.removeChild(Tt),Pe&&(this.nativeDraggable&&lt(Pe,"dragend",this),qo(Pe),Pe.style["will-change"]="",Yn&&!un&&Ht(Pe,Bt?Bt.options.ghostClass:this.options.ghostClass,!1),Ht(Pe,this.options.chosenClass,!1),Zt({sortable:this,name:"unchoose",toEl:St,newIndex:null,newDraggableIndex:null,originalEvent:e}),gt!==St?(fr>=0&&(Zt({rootEl:St,name:"add",toEl:St,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"remove",toEl:St,originalEvent:e}),Zt({rootEl:St,name:"sort",toEl:St,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:St,originalEvent:e})),Bt&&Bt.save()):fr!==ln&&fr>=0&&(Zt({sortable:this,name:"update",toEl:St,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:St,originalEvent:e})),Je.active&&((fr==null||fr===-1)&&(fr=ln,vi=Gn),Zt({sortable:this,name:"end",toEl:St,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){tr("nulling",this),gt=Pe=St=tt=Ii=Tt=as=pi=Ri=Mr=Yn=fr=vi=ln=Gn=fn=Xn=Bt=ss=Je.dragged=Je.ghost=Je.clone=Je.active=null,ds.forEach(function(e){e.checked=!0}),ds.length=Xo=Zo=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Pe&&(this._onDragOver(e),em(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,i=this.el.children,t=0,n=i.length,a=this.options;t<n;t++)r=i[t],Xr(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||sm(r));return e},sort:function(e,r){var i={},t=this.el;this.toArray().forEach(function(n,a){var o=t.children[a];Xr(o,this.options.draggable,t,!1)&&(i[n]=o)},this),r&&this.captureAnimationState(),e.forEach(function(n){i[n]&&(t.removeChild(i[n]),t.appendChild(i[n]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return Xr(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var i=this.options;if(r===void 0)return i[e];var t=$n.modifyOption(this,e,r);typeof t!="undefined"?i[e]=t:i[e]=r,e==="group"&&wf(i)},destroy:function(){tr("destroy",this);var e=this.el;e[ur]=null,lt(e,"mousedown",this._onTapStart),lt(e,"touchstart",this._onTapStart),lt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(lt(e,"dragover",this),lt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ls.splice(ls.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!pi){if(tr("hideClone",this),Je.eventCanceled)return;qe(Tt,"display","none"),this.options.removeCloneOnHide&&Tt.parentNode&&Tt.parentNode.removeChild(Tt),pi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(pi){if(tr("showClone",this),Je.eventCanceled)return;Pe.parentNode==gt&&!this.options.group.revertClone?gt.insertBefore(Tt,Pe):Ii?gt.insertBefore(Tt,Ii):gt.appendChild(Tt),this.options.group.revertClone&&this.animate(Pe,Tt),qe(Tt,"display",""),pi=!1}}};function em(s){s.dataTransfer&&(s.dataTransfer.dropEffect="move"),s.cancelable&&s.preventDefault()}function ps(s,e,r,i,t,n,a,o){var l,h=s[ur],p=h.options.onMove,u;return window.CustomEvent&&!ii&&!Vn?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=s,l.dragged=r,l.draggedRect=i,l.related=t||e,l.relatedRect=n||Ct(e),l.willInsertAfter=o,l.originalEvent=a,s.dispatchEvent(l),p&&(u=p.call(h,l,a)),u}function qo(s){s.draggable=!1}function tm(){Jo=!1}function rm(s,e,r){var i=Ct(sn(r.el,0,r.options,!0)),t=10;return e?s.clientX<i.left-t||s.clientY<i.top&&s.clientX<i.right:s.clientY<i.top-t||s.clientY<i.bottom&&s.clientX<i.left}function im(s,e,r){var i=Ct($o(r.el,r.options.draggable)),t=10;return e?s.clientX>i.right+t||s.clientX<=i.right&&s.clientY>i.bottom&&s.clientX>=i.left:s.clientX>i.right&&s.clientY>i.top||s.clientX<=i.right&&s.clientY>i.bottom+t}function nm(s,e,r,i,t,n,a,o){var l=i?s.clientY:s.clientX,h=i?r.height:r.width,p=i?r.top:r.left,u=i?r.bottom:r.right,f=!1;if(!a){if(o&&fs<h*t){if(!Zn&&(Xn===1?l>p+h*n/2:l<u-h*n/2)&&(Zn=!0),Zn)f=!0;else if(Xn===1?l<p+fs:l>u-fs)return-Xn}else if(l>p+h*(1-t)/2&&l<u-h*(1-t)/2)return am(e)}return f=f||a,f&&(l<p+h*n/2||l>u-h*n/2)?l>p+h/2?1:-1:0}function am(s){return er(Pe)<er(s)?1:-1}function sm(s){for(var e=s.tagName+s.className+s.src+s.href+s.textContent,r=e.length,i=0;r--;)i+=e.charCodeAt(r);return i.toString(36)}function om(s){ds.length=0;for(var e=s.getElementsByTagName("input"),r=e.length;r--;){var i=e[r];i.checked&&ds.push(i)}}function vs(s){return setTimeout(s,0)}function el(s){return clearTimeout(s)}cs&&ut(document,"touchmove",function(s){(Je.active||un)&&s.cancelable&&s.preventDefault()});Je.utils={on:ut,off:lt,css:qe,find:vf,is:function(e,r){return!!Xr(e,r,e,!1)},extend:Vg,throttle:yf,closest:Xr,toggleClass:Ht,clone:_f,index:er,nextTick:vs,cancelNextTick:el,detectDirection:Af,getChild:sn};Je.get=function(s){return s[ur]};Je.mount=function(){for(var s=arguments.length,e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(Je.utils=Gr(Gr({},Je.utils),i.utils)),$n.mount(i)})};Je.create=function(s,e){return new Je(s,e)};Je.version=Ug;var Rt=[],Qn,tl,rl=!1,il,nl,gs,Jn;function lm(){function s(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return s.prototype={dragStarted:function(r){var i=r.originalEvent;this.sortable.nativeDraggable?ut(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ut(document,"pointermove",this._handleFallbackAutoScroll):i.touches?ut(document,"touchmove",this._handleFallbackAutoScroll):ut(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var i=r.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?lt(document,"dragover",this._handleAutoScroll):(lt(document,"pointermove",this._handleFallbackAutoScroll),lt(document,"touchmove",this._handleFallbackAutoScroll),lt(document,"mousemove",this._handleFallbackAutoScroll)),If(),ms(),Kg()},nulling:function(){gs=tl=Qn=rl=Jn=il=nl=null,Rt.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,i){var t=this,n=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(n,a);if(gs=r,i||this.options.forceAutoScrollFallback||Vn||ii||Kn){al(r,this.options,o,i);var l=hi(o,!0);rl&&(!Jn||n!==il||a!==nl)&&(Jn&&If(),Jn=setInterval(function(){var h=hi(document.elementFromPoint(n,a),!0);h!==l&&(l=h,ms()),al(r,t.options,h,i)},10),il=n,nl=a)}else{if(!this.options.bubbleScroll||hi(o,!0)===Zr()){ms();return}al(r,this.options,hi(o,!1),!1)}}},Yr(s,{pluginName:"scroll",initializeByDefault:!0})}function ms(){Rt.forEach(function(s){clearInterval(s.pid)}),Rt=[]}function If(){clearInterval(Jn)}var al=yf(function(s,e,r,i){if(!!e.scroll){var t=(s.touches?s.touches[0]:s).clientX,n=(s.touches?s.touches[0]:s).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=Zr(),h=!1,p;tl!==r&&(tl=r,ms(),Qn=e.scroll,p=e.scrollFn,Qn===!0&&(Qn=hi(r,!0)));var u=0,f=Qn;do{var g=f,E=Ct(g),S=E.top,_=E.bottom,m=E.left,c=E.right,v=E.width,y=E.height,d=void 0,x=void 0,b=g.scrollWidth,T=g.scrollHeight,A=qe(g),L=g.scrollLeft,R=g.scrollTop;g===l?(d=v<b&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),x=y<T&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):(d=v<b&&(A.overflowX==="auto"||A.overflowX==="scroll"),x=y<T&&(A.overflowY==="auto"||A.overflowY==="scroll"));var w=d&&(Math.abs(c-t)<=a&&L+v<b)-(Math.abs(m-t)<=a&&!!L),O=x&&(Math.abs(_-n)<=a&&R+y<T)-(Math.abs(S-n)<=a&&!!R);if(!Rt[u])for(var I=0;I<=u;I++)Rt[I]||(Rt[I]={});(Rt[u].vx!=w||Rt[u].vy!=O||Rt[u].el!==g)&&(Rt[u].el=g,Rt[u].vx=w,Rt[u].vy=O,clearInterval(Rt[u].pid),(w!=0||O!=0)&&(h=!0,Rt[u].pid=setInterval(function(){i&&this.layer===0&&Je.active._onTouchMove(gs);var D=Rt[this.layer].vy?Rt[this.layer].vy*o:0,C=Rt[this.layer].vx?Rt[this.layer].vx*o:0;typeof p=="function"&&p.call(Je.dragged.parentNode[ur],C,D,s,gs,Rt[this.layer].el)!=="continue"||Ef(Rt[this.layer].el,C,D)}.bind({layer:u}),24))),u++}while(e.bubbleScroll&&f!==l&&(f=hi(f,!1)));rl=h}},30),Rf=function(e){var r=e.originalEvent,i=e.putSortable,t=e.dragEl,n=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(!!r){var h=i||n;o();var p=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,u=document.elementFromPoint(p.clientX,p.clientY);l(),h&&!h.el.contains(u)&&(a("spill"),this.onSpill({dragEl:t,putSortable:i}))}};function sl(){}sl.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var t=sn(this.sortable.el,this.startIndex,this.options);t?this.sortable.el.insertBefore(r,t):this.sortable.el.appendChild(r),this.sortable.animateAll(),i&&i.animateAll()},drop:Rf};Yr(sl,{pluginName:"revertOnSpill"});function ol(){}ol.prototype={onSpill:function(e){var r=e.dragEl,i=e.putSortable,t=i||this.sortable;t.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),t.animateAll()},drop:Rf};Yr(ol,{pluginName:"removeOnSpill"});var br;function um(){function s(){this.defaults={swapClass:"sortable-swap-highlight"}}return s.prototype={dragStart:function(r){var i=r.dragEl;br=i},dragOverValid:function(r){var i=r.completed,t=r.target,n=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(!!a.options.swap){var h=this.sortable.el,p=this.options;if(t&&t!==h){var u=br;n(t)!==!1?(Ht(t,p.swapClass,!0),br=t):br=null,u&&u!==br&&Ht(u,p.swapClass,!1)}o(),i(!0),l()}},drop:function(r){var i=r.activeSortable,t=r.putSortable,n=r.dragEl,a=t||this.sortable,o=this.options;br&&Ht(br,o.swapClass,!1),br&&(o.swap||t&&t.options.swap)&&n!==br&&(a.captureAnimationState(),a!==i&&i.captureAnimationState(),fm(n,br),a.animateAll(),a!==i&&i.animateAll())},nulling:function(){br=null}},Yr(s,{pluginName:"swap",eventProperties:function(){return{swapItem:br}}})}function fm(s,e){var r=s.parentNode,i=e.parentNode,t,n;!r||!i||r.isEqualNode(e)||i.isEqualNode(s)||(t=er(s),n=er(e),r.isEqualNode(i)&&t<n&&n++,r.insertBefore(e,r.children[t]),i.insertBefore(s,i.children[n]))}Je.mount(new lm);Je.mount(ol,sl);var qn=0,dm=1,cm=-1,mt="__PLAYER_KEY__",ll={selector:"audio-lists-panel-content-wrap",swapClass:"audio-lists-panel-sortable-highlight-bg",swap:!0,animation:100,easing:"cubic-bezier(0.43, -0.1, 0.16, 1.1)"},hm=function(e){var r=e.audioLists,i=e.onCancel,t=e.onDelete,n=e.onPlay,a=e.playId,o=e.loading,l=e.panelToggleAnimate,h=e.glassBg,p=e.remove,u=e.removeId,f=e.isMobile,g=e.locale,E=e.icon,S=e.playing;return q.createElement("div",{className:Ft("audio-lists-panel",l,{"audio-lists-panel-mobile":f,"glass-bg":h})},q.createElement("div",{className:"audio-lists-panel-header"},q.createElement("h2",{className:"audio-lists-panel-header-title"},q.createElement("span",null,g.playListsText," / "),q.createElement("span",{className:"audio-lists-panel-header-num"},r.length),q.createElement("span",{className:"audio-lists-panel-header-actions"},p&&q.createElement(q.Fragment,null,q.createElement("span",{className:"audio-lists-panel-header-delete-btn",title:g.removeAudioListsText,onClick:t()},E.delete),q.createElement("span",{className:"audio-lists-panel-header-line"})),q.createElement("span",{className:"audio-lists-panel-header-close-btn",title:g.closeText,onClick:i},f?E.packUpPanelMobile:E.close)))),q.createElement("div",{className:Ft("audio-lists-panel-content",{"no-content":r.length<1})},r.length>=1?q.createElement("ul",{className:ll.selector},r.map(function(_){var m=_.name,c=_.singer,v=_[mt],y=a===v;return q.createElement("li",{key:v,title:S&&y?g.clickToPauseText:g.clickToPlayText,className:Ft("audio-item",{playing:y},{pause:!S},{remove:u===v}),onClick:function(){return n(v)}},q.createElement("span",{className:"group player-status"},q.createElement("span",{className:"player-icons"},y&&o?E.loading:y?S?E.pause:E.play:void 0)),q.createElement("span",{className:"group player-name",title:m},m),q.createElement("span",{className:"group player-singer",title:c},c),p&&q.createElement("span",{className:"group player-delete",title:g.clickToDeleteText(m),onClick:t(v)},E.close))})):q.createElement(q.Fragment,null,q.createElement("span",null,E.empty),q.createElement("span",{className:"no-data"},g.emptyText||g.notContentText))))},pm=Ye.exports.memo(hm),vm=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.progress,i=r===void 0?0:r,t=e.r,n=t===void 0?40:t,a=i.toFixed(2),o=Math.PI*2*n,l="".concat(Math.floor(o*a)," ").concat(Math.floor(o*(1-a)));return q.createElement("svg",{className:"audio-circle-process-bar"},q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"stroke",strokeDasharray:l}),q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"bg",strokeDasharray:"0 1000"}))},gm=Ye.exports.memo(vm),mm=[{id:"fa",name:"Font Awesome",projectUrl:"https://fontawesome.com/",license:"CC BY 4.0 License",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"},{id:"io",name:"Ionicons 4",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"io5",name:"Ionicons 5",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"md",name:"Material Design icons",projectUrl:"http://google.github.io/material-design-icons/",license:"Apache License Version 2.0",licenseUrl:"https://github.com/google/material-design-icons/blob/master/LICENSE"},{id:"ti",name:"Typicons",projectUrl:"http://s-ings.com/typicons/",license:"CC BY-SA 3.0",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"},{id:"go",name:"Github Octicons icons",projectUrl:"https://octicons.github.com/",license:"MIT",licenseUrl:"https://github.com/primer/octicons/blob/master/LICENSE"},{id:"fi",name:"Feather",projectUrl:"https://feathericons.com/",license:"MIT",licenseUrl:"https://github.com/feathericons/feather/blob/master/LICENSE"},{id:"gi",name:"Game Icons",projectUrl:"https://game-icons.net/",license:"CC BY 3.0",licenseUrl:"https://creativecommons.org/licenses/by/3.0/"},{id:"wi",name:"Weather Icons",projectUrl:"https://erikflowers.github.io/weather-icons/",license:"SIL OFL 1.1",licenseUrl:"http://scripts.sil.org/OFL"},{id:"di",name:"Devicons",projectUrl:"https://vorillaz.github.io/devicons/",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ai",name:"Ant Design Icons",projectUrl:"https://github.com/ant-design/ant-design-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"bs",name:"Bootstrap Icons",projectUrl:"https://github.com/twbs/icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ri",name:"Remix Icon",projectUrl:"https://github.com/Remix-Design/RemixIcon",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"fc",name:"Flat Color Icons",projectUrl:"https://github.com/icons8/flat-color-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"gr",name:"Grommet-Icons",projectUrl:"https://github.com/grommet/grommet-icons",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"hi",name:"Heroicons",projectUrl:"https://github.com/refactoringui/heroicons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"si",name:"Simple Icons",projectUrl:"https://simpleicons.org/",license:"CC0 1.0 Universal",licenseUrl:"https://creativecommons.org/publicdomain/zero/1.0/"},{id:"im",name:"IcoMoon Free",projectUrl:"https://github.com/Keyamoon/IcoMoon-Free",license:"CC BY 4.0 License"},{id:"bi",name:"BoxIcons",projectUrl:"https://github.com/atisawd/boxicons",license:"CC BY 4.0 License"},{id:"cg",name:"css.gg",projectUrl:"https://github.com/astrit/css.gg",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"vsc",name:"VS Code Icons",projectUrl:"https://github.com/microsoft/vscode-codicons",license:"CC BY 4.0",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"}],ul={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},fl=q.createContext&&q.createContext(ul),gi=globalThis&&globalThis.__assign||function(){return gi=Object.assign||function(s){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}return s},gi.apply(this,arguments)},ym=globalThis&&globalThis.__rest||function(s,e){var r={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,i=Object.getOwnPropertySymbols(s);t<i.length;t++)e.indexOf(i[t])<0&&Object.prototype.propertyIsEnumerable.call(s,i[t])&&(r[i[t]]=s[i[t]]);return r};function Df(s){return s&&s.map(function(e,r){return q.createElement(e.tag,gi({key:r},e.attr),Df(e.child))})}function Em(s){return function(e){return q.createElement(Cf,gi({attr:gi({},s.attr)},e),Df(s.child))}}function Cf(s){var e=function(r){var i=s.attr,t=s.size,n=s.title,a=ym(s,["attr","size","title"]),o=t||r.size||"1em",l;return r.className&&(l=r.className),s.className&&(l=(l?l+" ":"")+s.className),q.createElement("svg",gi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:gi(gi({color:s.color||r.color},r.style),s.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&q.createElement("title",null,n),s.children)};return fl!==void 0?q.createElement(fl.Consumer,null,function(r){return e(r)}):e(ul)}var _m=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",IconsManifest:mm,GenIcon:Em,IconBase:Cf,DefaultContext:ul,IconContext:fl}),Lt=yo(_m),xm=Lt.GenIcon,bm=function(e){return xm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-16 328c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160zm112 0c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160z"}}]})(e)},Sm=Lt.GenIcon,Tm=function(e){return Sm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"}}]})(e)},Am=Lt.GenIcon,wm=function(e){return Am({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"}}]})(e)},Om=Lt.GenIcon,Pf=function(e){return Om({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.52 32 0 146.496 0 288v48a32 32 0 0 0 17.689 28.622l14.383 7.191C34.083 431.903 83.421 480 144 480h24c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-24c-31.342 0-59.671 12.879-80 33.627V288c0-105.869 86.131-192 192-192s192 86.131 192 192v1.627C427.671 268.879 399.342 256 368 256h-24c-13.255 0-24 10.745-24 24v176c0 13.255 10.745 24 24 24h24c60.579 0 109.917-48.098 111.928-108.187l14.382-7.191A32 32 0 0 0 512 336v-48c0-141.479-114.496-256-256-256z"}}]})(e)},Lm=Lt.GenIcon,Im=function(e){return Lm({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M108 284c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h232c6.6 0 12 5.4 12 12v32c0 6.6-5.4 12-12 12H108zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"}}]})(e)},Rm=Lt.GenIcon,Dm=function(e){return Rm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}}]})(e)},Cm=Lt.GenIcon,Pm=function(e){return Cm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"}}]})(e)},Mm=Lt.GenIcon,km=function(e){return Mm({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"7 13 12 18 17 13"}},{tag:"polyline",attr:{points:"7 6 12 11 17 6"}}]})(e)},Nm=Lt.GenIcon,Fm=function(e){return Nm({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"}}]})(e)},Bm=Lt.GenIcon,Um=function(e){return Bm({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 8.02c0 1.09-.45 2.09-1.17 2.83l-.67-.67c.55-.56.89-1.31.89-2.16 0-.85-.34-1.61-.89-2.16l.67-.67A3.99 3.99 0 0 1 12 8.02zM7.72 2.28L4 6H2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h2l3.72 3.72c.47.47 1.28.14 1.28-.53V2.81c0-.67-.81-1-1.28-.53zm5.94.08l-.67.67a6.996 6.996 0 0 1 2.06 4.98c0 1.94-.78 3.7-2.06 4.98l.67.67A7.973 7.973 0 0 0 16 8c0-2.22-.89-4.22-2.34-5.66v.02zm-1.41 1.41l-.69.67a5.05 5.05 0 0 1 1.48 3.58c0 1.39-.56 2.66-1.48 3.56l.69.67A5.971 5.971 0 0 0 14 8.02c0-1.65-.67-3.16-1.75-4.25z"}}]})(e)},jm=Lt.GenIcon,Mf=function(e){return jm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)},Wm=Lt.GenIcon,zm=function(e){return Wm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 5h-3v5.5c0 1.38-1.12 2.5-2.5 2.5S10 13.88 10 12.5s1.12-2.5 2.5-2.5c.57 0 1.08.19 1.5.51V5h4v2zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"}}]})(e)},Vm=Lt.GenIcon,Km=function(e){return Vm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}}]})(e)},Hm=Lt.GenIcon,$m=function(e){return Hm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4zm-4-2V9h-1l-2 1v1h1.5v4H13z"}}]})(e)},Gm=Lt.GenIcon,Ym=function(e){return Gm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"}}]})(e)},Xm=Lt.GenIcon,Zm=function(e){return Xm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}}]})(e)},Qm=Lt.GenIcon,Jm=function(e){return Qm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"}}]})(e)},qm=Lt.GenIcon,e0=function(e){return qm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"}}]}]})(e)},t0=Lt.GenIcon,r0=function(e){return t0({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0H24V24H0z"}},{tag:"path",attr:{d:"M22 18v2H2v-2h20zM2 3.5l8 5-8 5v-10zM22 11v2H12v-2h10zm0-7v2H12V4h10z"}}]}]})(e)},i0=Lt.GenIcon,n0=function(e){return i0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 9h3.5c.736 0 1.393.391 1.851 1.001.325-.604.729-1.163 1.191-1.662-.803-.823-1.866-1.339-3.042-1.339h-3.5c-.553 0-1 .448-1 1s.447 1 1 1zM11.685 12.111c.551-1.657 2.256-3.111 3.649-3.111h1.838l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-1.838c-2.274 0-4.711 1.967-5.547 4.479l-.472 1.411c-.641 1.926-2.072 3.11-2.815 3.11h-2.5c-.553 0-1 .448-1 1s.447 1 1 1h2.5c1.837 0 3.863-1.925 4.713-4.479l.472-1.41zM15.879 13.293c-.391.391-.391 1.023 0 1.414l1.293 1.293h-2.338c-1.268 0-2.33-.891-2.691-2.108-.256.75-.627 1.499-1.09 2.185.886 1.162 2.243 1.923 3.781 1.923h2.338l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0z"}}]})(e)},a0=Lt.GenIcon,s0=function(e){return a0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.707 7.404c-.189-.188-.448-.283-.707-.283s-.518.095-.707.283l-2.293 2.293v-6.697c0-.552-.448-1-1-1s-1 .448-1 1v6.697l-2.293-2.293c-.189-.188-.44-.293-.707-.293s-.518.105-.707.293c-.39.39-.39 1.024 0 1.414l4.707 4.682 4.709-4.684c.388-.387.388-1.022-.002-1.412zM20.987 16c0-.105-.004-.211-.039-.316l-2-6c-.136-.409-.517-.684-.948-.684h-.219c-.094.188-.21.368-.367.525l-1.482 1.475h1.348l1.667 5h-13.893l1.667-5h1.348l-1.483-1.475c-.157-.157-.274-.337-.367-.525h-.219c-.431 0-.812.275-.948.684l-2 6c-.035.105-.039.211-.039.316-.013 0-.013 5-.013 5 0 .553.447 1 1 1h16c.553 0 1-.447 1-1 0 0 0-5-.013-5z"}}]})(e)},o0=function(){return q.createElement(Tm,{className:"react-jinke-music-player-play-icon"})},l0=function(){return q.createElement(bm,{className:"react-jinke-music-player-pause-icon"})},u0=function(e){var r=e.prefix,i=e.visible,t=e.title,n=e.text;return q.createElement("div",{className:Ft("".concat(r,"-play-model-tip"),{show:i})},q.createElement("span",{className:"".concat(r,"-play-model-tip-title")},t),q.createElement("span",{className:"".concat(r,"-play-model-tip-text")},n))},f0=Ye.exports.memo(u0),dr="react-jinke-music-player-mobile",kf=function(e){var r=e.name,i=e.cover,t=e.singer,n=e.playing,a=e.duration,o=e.currentTime,l=e.loading,h=e.themeSwitch,p=e.progressBar,u=e.openAudioListsPanel,f=e.audioPrevPlay,g=e.audioNextPlay,E=e.playMode,S=e.onClose,_=e.playModeTipVisible,m=e.currentPlayModeName,c=e.extendsContent,v=e.onPlay,y=e.glassBg,d=e.onCoverClick,x=e.autoHiddenCover,b=e.icon,T=e.locale,A=e.toggleMode,L=e.renderAudioTitle,R=e.shouldShowPlayIcon,w=e.isResetCoverRotate;return q.createElement("div",{className:Ft(dr,{"default-bg":!y,"glass-bg":y})},q.createElement(f0,{prefix:dr,visible:_,title:E,text:m}),q.createElement("div",{className:"".concat(dr,"-header group")},q.createElement("div",{className:"".concat(dr,"-header-title"),title:r},L()),A&&q.createElement("div",{className:"".concat(dr,"-header-right"),onClick:S},b.close)),q.createElement("div",{className:"".concat(dr,"-singer text-center group")},q.createElement("span",{className:"".concat(dr,"-singer-name"),title:t},t)),q.createElement("div",{className:"".concat(dr,"-switch text-center group")},h),(!x||x&&i)&&q.createElement("div",{className:"".concat(dr,"-cover text-center"),onClick:function(){return d()}},q.createElement("img",{src:i,alt:"cover",className:Ft("cover",{"img-rotate-pause":!n||!i,"img-rotate-reset":w})})),q.createElement("div",{className:"".concat(dr,"-progress group")},q.createElement("span",{className:"current-time"},l?"--":o),q.createElement("span",{className:"".concat(dr,"-progress-bar")},p),q.createElement("span",{className:"duration text-right"},l?"--":a)),q.createElement("div",{className:"".concat(dr,"-toggle text-center group")},q.createElement("span",{className:"group prev-audio",title:T.previousTrackText,onClick:f},b.prev),l?q.createElement("span",{className:"group loading-icon"},b.loading):q.createElement("span",{className:"group play-btn",title:R?T.clickToPlayText:T.clickToPauseText,onClick:v},R?b.play:b.pause),q.createElement("span",{className:"group next-audio",title:T.nextTrackText,onClick:g},b.next)),q.createElement("div",{className:"".concat(dr,"-operation group")},q.createElement("ul",{className:"items"},[E,b.download,b.reload,b.lyric].filter(Ye.exports.isValidElement).map(function(O){return q.createElement("li",{className:"item",key:O.props.className},O)}),c,q.createElement("li",{className:"item",onClick:u},b.playLists))))};kf.defaultProps={icon:{},renderAudioTitle:function(){}};var d0=Ye.exports.memo(kf),c0=function(e){var r=e.visible,i=e.value;return q.createElement("div",{className:Ft("play-mode-title",{"play-mode-title-visible":r})},i)},h0=Ye.exports.memo(c0),p0=350,v0=32,ea={en_US:"en_US",zh_CN:"zh_CN"},Nf={MOBILE:"(max-width: 768px) and (orientation : portrait)",DARK_THEME:"screen and (prefers-color-scheme: dark)",LIGHT_THEME:"screen and (prefers-color-scheme: light)"},Sr={FULL:"full",MINI:"mini"},Ff={NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3,NETWORK_READY_SUCCESS_STATE:4},g0={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},Et={order:"order",orderLoop:"orderLoop",singleLoop:"singleLoop",shufflePlay:"shufflePlay"},Tr={LIGHT:"light",DARK:"dark",AUTO:"auto"},Bf=se.oneOf(["order","orderLoop","singleLoop","shufflePlay"]),m0={audioLists:se.array.isRequired,locale:se.oneOfType([se.object,se.oneOf(Object.values(ea))]),theme:se.oneOf(Object.values(Tr)),mode:se.oneOf(Object.values(Sr)),defaultPlayMode:Bf,playMode:Bf,drag:se.bool,seeked:se.bool,autoPlay:se.bool,clearPriorAudioLists:se.bool,autoPlayInitLoadPlayList:se.bool,playModeText:se.object,panelTitle:se.string,closeText:se.oneOfType([se.string,se.object]),openText:se.oneOfType([se.string,se.object]),clickToPlayText:se.oneOfType([se.string,se.object]),clickToPauseText:se.oneOfType([se.string,se.object]),nextTrackText:se.oneOfType([se.string,se.object]),previousTrackText:se.oneOfType([se.string,se.object]),reloadText:se.oneOfType([se.string,se.object]),volumeText:se.oneOfType([se.string,se.object]),playListsText:se.oneOfType([se.string,se.object]),toggleLyricText:se.oneOfType([se.string,se.object]),toggleMiniModeText:se.oneOfType([se.string,se.object]),destroyText:se.oneOfType([se.string,se.object]),downloadText:se.oneOfType([se.string,se.object]),emptyText:se.oneOfType([se.string,se.object]),controllerTitle:se.oneOfType([se.string,se.object]),defaultPosition:se.shape({top:se.oneOfType([se.number,se.string]),left:se.oneOfType([se.number,se.string]),right:se.oneOfType([se.number,se.string]),bottom:se.oneOfType([se.number,se.string])}),onAudioPlay:se.func,onAudioPause:se.func,onAudioEnded:se.func,onAudioAbort:se.func,onAudioVolumeChange:se.func,onAudioError:se.func,onAudioProgress:se.func,onAudioSeeked:se.func,onAudioDownload:se.func,onAudioReload:se.func,onThemeChange:se.func,onAudioListsChange:se.func,onPlayModeChange:se.func,onModeChange:se.func,onAudioListsPanelChange:se.func,onAudioPlayTrackChange:se.func,onAudioListsSortEnd:se.func,onAudioLyricChange:se.func,showDownload:se.bool,showPlay:se.bool,showReload:se.bool,showPlayMode:se.bool,showThemeSwitch:se.bool,showMiniModeCover:se.bool,toggleMode:se.bool,once:se.bool,extendsContent:se.oneOfType([se.array,se.bool,se.object,se.node,se.element,se.string]),checkedText:se.oneOfType([se.string,se.object]),unCheckedText:se.oneOfType([se.string,se.object]),defaultVolume:se.number,playModeShowTime:se.number,bounds:se.oneOfType([se.string,se.object]),showMiniProcessBar:se.bool,loadAudioErrorPlayNext:se.bool,preload:se.oneOfType([se.bool,se.oneOf(["auto","metadata","none"])]),glassBg:se.bool,remember:se.bool,remove:se.bool,defaultPlayIndex:se.number,playIndex:se.number,lyricClassName:se.string,emptyLyricText:se.oneOfType([se.string,se.object]),showLyric:se.bool,getContainer:se.func,getAudioInstance:se.func,onBeforeAudioDownload:se.func,autoHiddenCover:se.bool,spaceBar:se.bool,showDestroy:se.bool,onBeforeDestroy:se.func,onDestroyed:se.func,customDownloader:se.func,audioTitle:se.oneOfType([se.string,se.func]),responsive:se.bool,quietUpdate:se.bool,renderAudioTitle:se.func,mobileMediaQuery:se.string,volumeFade:se.shape({fadeIn:se.number,fadeOut:se.number}),sortableOptions:se.object},y0={min:0,step:1},E0={min:0,max:1,step:.01},kr={IN:"in",OUT:"out",NONE:"none"},_0={playModeText:{order:"Play in order",orderLoop:"List loop",singleLoop:"Single loop",shufflePlay:"Shuffle playback"},openText:"Open",closeText:"Close",emptyText:"No music",clickToPlayText:"Click to play",clickToPauseText:"Click to pause",nextTrackText:"Next track",previousTrackText:"Previous track",reloadText:"Reload",volumeText:"Volume",playListsText:"Playlists",toggleLyricText:"Toggle lyric",toggleMiniModeText:"Minimize",destroyText:"Destroy",downloadText:"Download",lightThemeText:"L",darkThemeText:"D",switchThemeText:"Dark/Light mode",removeAudioListsText:"Delete audio lists",clickToDeleteText:function(e){return"Click to delete ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"No lyric",loadingText:"Loading"},x0={playModeText:{order:"\u987A\u5E8F\u64AD\u653E",orderLoop:"\u5217\u8868\u5FAA\u73AF",singleLoop:"\u5355\u66F2\u5FAA\u73AF",shufflePlay:"\u968F\u673A\u64AD\u653E"},openText:"\u6253\u5F00",closeText:"\u5173\u95ED",emptyText:"\u97F3\u4E50\u64AD\u653E\u5217\u8868\u4E3A\u7A7A",clickToPlayText:"\u70B9\u51FB\u64AD\u653E",clickToPauseText:"\u70B9\u51FB\u6682\u505C",nextTrackText:"\u4E0B\u4E00\u9996",previousTrackText:"\u4E0A\u4E00\u9996",reloadText:"\u91CD\u65B0\u64AD\u653E",volumeText:"\u97F3\u91CF",playListsText:"\u64AD\u653E\u5217\u8868",toggleLyricText:"\u663E\u793A/\u9690\u85CF \u6B4C\u8BCD",toggleMiniModeText:"\u5207\u6362\u81F3\u8FF7\u4F60\u6A21\u5F0F",destroyText:"\u79FB\u9664\u64AD\u653E\u5668",downloadText:"\u4E0B\u8F7D",lightThemeText:"\u4EAE",darkThemeText:"\u6697",switchThemeText:"\u6697\u9ED1/\u660E\u4EAE \u4E3B\u9898",removeAudioListsText:"\u6E05\u7A7A\u64AD\u653E\u5217\u8868",clickToDeleteText:function(e){return"\u70B9\u51FB\u5220\u9664 ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"\u6682\u65E0\u6B4C\u8BCD",loadingText:"\u52A0\u8F7D\u4E2D"},ys;function Uf(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var b0=(ys={},Uf(ys,ea.en_US,_0),Uf(ys,ea.zh_CN,x0),ys),jf=b0;function S0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Wf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function T0(s,e,r){return e&&Wf(s.prototype,e),r&&Wf(s,r),s}var zf=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g,Vf=0,Es=1,Kf={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"},A0=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};S0(this,s),this.lrc=e,this.tags={},this.lines=[],this.handler=r,this.state=Vf,this.curLine=0,this._init()}return T0(s,[{key:"_init",value:function(){this._initTag(),this._initLines()}},{key:"_initTag",value:function(){for(var r in Kf){var i=this.lrc.match(new RegExp("\\[".concat(Kf[r],":([^\\]]*)]"),"i"));this.tags[r]=i&&i[1]||""}}},{key:"_initLines",value:function(){for(var r=this.lrc.split(`
`),i=parseInt(this.tags.offset,10)||0,t=0;t<r.length;t++){var n=r[t],a=zf.exec(n);if(a){var o=n.replace(zf,"").trim();o&&this.lines.push({time:a[1]*60*1e3+a[2]*1e3+(a[3]||0)*10+i,txt:o})}}this.lines.sort(function(l,h){return l.time-h.time})}},{key:"_findCurNum",value:function(r){for(var i=0;i<this.lines.length;i++)if(r<=this.lines[i].time)return i;return this.lines.length-1}},{key:"_callHandler",value:function(r){r<0||this.handler({txt:this.lines[r].txt,lineNum:r})}},{key:"_playRest",value:function(){var r=this,i=this.lines[this.curNum],t=i.time-(+new Date-this.startStamp);this.timer=setTimeout(function(){r._callHandler(r.curNum++),r.curNum<r.lines.length&&r.state===Es&&r._playRest()},t)}},{key:"play",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;!this.lines.length||(this.state=Es,this.curNum=this._findCurNum(r),this.startStamp=+new Date-r,i||this._callHandler(this.curNum-1),this.curNum<this.lines.length&&(clearTimeout(this.timer),this._playRest()))}},{key:"togglePlay",value:function(){var r=+new Date;this.state===Es?(this.stop(),this.pauseStamp=r):(this.state=Es,this.play((this.pauseStamp||r)-(this.startStamp||r),!0),this.pauseStamp=0)}},{key:"stop",value:function(){this.state=Vf,clearTimeout(this.timer)}},{key:"seek",value:function(r){this.play(r)}}]),s}();function Hf(s){var e=0,r=0,i=parseInt(s);i>=60&&(e=parseInt(i/60),i=parseInt(i%60),e>=60&&(r=parseInt(e/60),e=parseInt(e%60)));var t=function(a){return a>>0<10?"0".concat(a):a};return r>0?[t(r),t(e),t(i)].join(":"):[t(e),t(i)].join(":")}function w0(s,e){return parseInt(Math.random()*(e-s+1)+s,10)}var O0=function(e){return function(r){return JSON.stringify(e)===JSON.stringify(r)}},mi=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},$f=function(){return"".concat(mi()+mi(),"-").concat(mi(),"-").concat(mi(),"-").concat(mi(),"-").concat(mi()).concat(mi()).concat(mi())},L0=function(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)};function I0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function R0(s){return .5-Math.cos(s*Math.PI)/2}function Gf(s,e,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},t=i.duration,n=t===void 0?1e3:t,a=i.easing,o=a===void 0?R0:a,l=i.interval,h=l===void 0?13:l,p=arguments.length>4?arguments[4]:void 0,u=r-e;if(!u||!n||!o||!h||I0())return s.volume=r,p(),{fadeInterval:void 0,updateIntervalEndVolume:void 0};var f=Math.floor(n/h),g=1,E=function(m){r=m},S=setInterval(function(){var _=r-e;_!==u&&(u=_),s.volume=e+o(g/f)*u,++g>=f&&(s.volume=r,clearInterval(S),p())},h);return{fadeInterval:S,updateIntervalEndVolume:E}}function dn(){return dn=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},dn.apply(this,arguments)}function D0(s,e){if(s==null)return{};var r=C0(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function C0(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Yf(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function ht(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yf(Object(r),!0).forEach(function(i){ge(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Yf(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function cn(s){return N0(s)||k0(s)||M0(s)||P0()}function P0(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M0(s,e){if(!!s){if(typeof s=="string")return dl(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dl(s,e)}}function k0(s){if(typeof Symbol!="undefined"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function N0(s){if(Array.isArray(s))return dl(s)}function dl(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function yi(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yi=function(r){return typeof r}:yi=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yi(s)}function F0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Xf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function B0(s,e,r){return e&&Xf(s.prototype,e),r&&Xf(s,r),s}function U0(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&cl(s,e)}function cl(s,e){return cl=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},cl(s,e)}function j0(s){var e=z0();return function(){var i=_s(s),t;if(e){var n=_s(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return W0(this,t)}}function W0(s,e){return e&&(yi(e)==="object"||typeof e=="function")?e:ye(s)}function ye(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function z0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function _s(s){return _s=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_s(s)}function ge(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}Je.mount(new um);var hl=Ep(),Zf={pause:q.createElement(l0,null),play:q.createElement(o0,null),destroy:q.createElement(Mf,null),close:q.createElement(Mf,null),delete:q.createElement(e0,{size:24}),download:q.createElement(s0,{size:26}),toggle:q.createElement(Im,null),lyric:q.createElement(wm,null),volume:q.createElement(Um,{size:26}),mute:q.createElement(Fm,{size:26}),next:q.createElement(Jm,null),prev:q.createElement(Ym,null),playLists:q.createElement(r0,null),reload:q.createElement(Pm,{size:22}),loop:q.createElement($m,{size:26}),order:q.createElement(Zm,{size:26}),orderLoop:q.createElement(Km,{size:26}),shuffle:q.createElement(n0,{size:26}),loading:q.createElement(Dm,null),packUpPanelMobile:q.createElement(km,{size:26}),empty:q.createElement(zm,null)},pl=function(s){U0(r,s);var e=j0(r);function r(i){var t;return F0(this,r),t=e.call(this,i),ge(ye(t),"isDrag",!1),ge(ye(t),"initPlayId",""),ge(ye(t),"state",{audioLists:[],playId:t.initPlayId,name:"",cover:"",singer:"",musicSrc:"",lyric:"",currentLyric:"",isMobile:hl,toggle:t.props.mode===Sr.FULL,playing:!1,currentTime:0,soundValue:dm,moveX:0,moveY:0,loading:!1,audioListsPanelVisible:!1,playModelNameVisible:!1,theme:t.props.theme||t.darkThemeName,playMode:t.props.playMode||t.props.defaultPlayMode||"",currentAudioVolume:0,initAnimate:!1,isInitAutoPlay:t.props.autoPlay,isInitRemember:!1,loadedProgress:0,removeId:cm,isNeedMobileHack:hl,audioLyricVisible:!1,isAutoPlayWhenUserClicked:!1,playIndex:t.props.playIndex||t.props.defaultPlayIndex||qn,canPlay:!1,currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0,isAudioSeeking:!1,isResetCoverRotate:!1}),ge(ye(t),"getPlayIndex",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.playIndex,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.state.audioLists;return Math.max(qn,Math.min(a.length-1,n))}),ge(ye(t),"onCoverClick",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Sr.FULL,a=t.props.showMiniModeCover,o=t.state.cover;!a&&n===Sr.MINI||t.props.onCoverClick&&o&&t.props.onCoverClick(n,t.state.audioLists,t.getBaseAudioInfo())}),ge(ye(t),"getAudioTitle",function(){var n=t.locale||{},a=n.audioTitle,o=t.state,l=o.name,h=o.singer;return typeof a=="function"&&t.audio?a(t.getBaseAudioInfo()):a||"".concat(l).concat(h?" - ".concat(h):"")}),ge(ye(t),"renderAudioTitle",function(){var n=t.state,a=n.isMobile,o=n.name;return t.props.renderAudioTitle?t.props.renderAudioTitle(t.getBaseAudioInfo(),a):a?o:t.getAudioTitle()}),ge(ye(t),"toggleAudioLyric",function(){t.setState({audioLyricVisible:!t.state.audioLyricVisible})}),ge(ye(t),"togglePlayMode",function(){var n=t._PLAY_MODE_.findIndex(function(o){return o===t.state.playMode}),a=n===t._PLAY_MODE_LENGTH_-1?t._PLAY_MODE_[0]:t._PLAY_MODE_[++n];t.setState({playMode:a,playModelNameVisible:!0,playModeTipVisible:!0}),t.props.onPlayModeChange&&t.props.onPlayModeChange(a),clearTimeout(t.playModelTimer),t.playModelTimer=setTimeout(function(){t.setState({playModelNameVisible:!1,playModeTipVisible:!1})},t.props.playModeShowTime)}),ge(ye(t),"renderPlayModeIcon",function(n){var a={className:"react-jinke-music-player-mode-icon"},o=null;switch(n){case Et.order:o=Ye.exports.cloneElement(t.iconMap.order,a);break;case Et.orderLoop:o=Ye.exports.cloneElement(t.iconMap.orderLoop,a);break;case Et.singleLoop:o=Ye.exports.cloneElement(t.iconMap.loop,a);break;case Et.shufflePlay:o=Ye.exports.cloneElement(t.iconMap.shuffle,a);break;default:o=Ye.exports.cloneElement(t.iconMap.order,a)}return o}),ge(ye(t),"audioListsPlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.state,l=o.playId,h=o.playing,p=o.audioLists,u=o.loading,f=o.canPlay;if(Array.isArray(p)&&p.length===0)return console.warn("Warning: Your playlist has no songs. and cannot play !");if(!(u&&n===l)){var g=p.findIndex(function(x){return x[mt]===n}),E=p[g]||{},S=E.name,_=E.cover,m=E.musicSrc,c=E.singer,v=E.lyric,y=v===void 0?"":v,d=function(b){t.setState({name:S,cover:_,musicSrc:b,singer:c,playId:n,lyric:y,currentTime:0,playing:!1,loading:!0,canPlay:!1,loadedProgress:0,playIndex:g,isAutoPlayWhenUserClicked:!0},function(){t.lyric&&t.lyric.stop(),t.audio.load(),t.updateMediaSessionMetadata(),setTimeout(function(){t.initLyricParser()},0)})};if(n===l&&!a){if(t.setState({playing:!h}),!h){if(f){t.play();return}return d(m)}return t.audio.pause()}switch(t.props.onAudioPlayTrackChange&&t.props.onAudioPlayTrackChange(n,p,t.getBaseAudioInfo()),t.props.onPlayIndexChange&&t.props.onPlayIndexChange(g),yi(m)){case"function":m().then(d,t.onAudioError);break;default:d(m)}}}),ge(ye(t),"resetAudioStatus",function(){t.audio.pause(),t.lyric&&t.lyric.stop(),t.initPlayInfo([]),t.resetAudioPlayStatus(),t.resetAudioPlayId()}),ge(ye(t),"resetAudioPlayId",function(){t.setState({playId:t.initPlayId})}),ge(ye(t),"clearAudioLists",function(){t.props.onAudioListsChange&&t.props.onAudioListsChange("",[],{}),t.resetAudioStatus()}),ge(ye(t),"onDeleteAudioLists",function(n){return function(a){a.stopPropagation();var o=t.state,l=o.audioLists,h=o.playId;if(!(l.length<1)){if(t.lyric&&t.lyric.stop(),!n){t.clearAudioLists();return}var p=cn(l).filter(function(u){return u[mt]!==n});t.setState({removeId:n}),setTimeout(function(){t.setState({audioLists:p,removeId:-1},function(){if(!p.length)return t.resetAudioStatus();n===h&&t.handlePlay(Et.orderLoop)})},p0),t.props.onAudioListsChange&&t.props.onAudioListsChange(h,p,t.getBaseAudioInfo())}}}),ge(ye(t),"openAudioListsPanel",function(){t.setState(function(n){var a=n.audioListsPanelVisible;return{initAnimate:!0,audioListsPanelVisible:!a}}),t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!t.state.audioListsPanelVisible)}),ge(ye(t),"closeAudioListsPanel",function(n){n.stopPropagation(),t._closeAudioListsPanel()}),ge(ye(t),"_closeAudioListsPanel",function(){var n=t.state.audioListsPanelVisible;t.setState({audioListsPanelVisible:!1}),n&&t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!1)}),ge(ye(t),"themeChange",function(n){var a=n?Tr.LIGHT:Tr.DARK;t.setState({theme:a}),t.props.onThemeChange&&t.props.onThemeChange(a)}),ge(ye(t),"onAudioDownload",function(){var n=t.state.musicSrc;if(t.state.musicSrc){var a=t.props.customDownloader,o=t.getBaseAudioInfo(),l=t.props.onBeforeAudioDownload(o),h={};l&&l.then?l.then(function(p){var u=p.src,f=p.filename,g=p.mimeType;h=p,a?a(p):gu(u,f,g)}):a?a({src:n}):gu(n),t.props.onAudioDownload&&t.props.onAudioDownload(o,h)}}),ge(ye(t),"onControllerDrag",function(n,a){var o=a.x,l=a.y,h=t.state,p=h.moveX,u=h.moveY;t.isDrag=!0,p===o&&u===l&&(t.isDrag=!1)}),ge(ye(t),"onControllerDragStart",function(n,a){var o=a.x,l=a.y;t.isDrag=!1,t.setState({moveX:o,moveY:l})}),ge(ye(t),"onControllerDragStop",function(n,a){var o=a.x,l=a.y;if(t.props.showDestroy&&t.destroyBtn&&t.destroyBtn.current&&t.destroyBtn.current.contains(n.target)){t.onDestroyPlayer();return}t.isDrag||(t.state.isNeedMobileHack&&(t.loadAndPlayAudio(),t.setState({isNeedMobileHack:!1})),t.onOpenPanel()),t.setState({moveX:o,moveY:l})}),ge(ye(t),"onResetVolume",function(){var n=t.state.currentAudioVolume;t.setAudioVolume(t.getVolumeBarValue(n||.1))}),ge(ye(t),"setAudioVolume",function(n){t.audio.volume=t.getListeningVolume(n),t.setState({currentAudioVolume:n,soundValue:n}),t.state.currentVolumeFade===kr.IN&&t.state.updateIntervalEndVolume&&t.state.updateIntervalEndVolume(n)}),ge(ye(t),"stopAll",function(n){n.stopPropagation(),n.preventDefault()}),ge(ye(t),"getBoundingClientRect",function(n){var a=n.getBoundingClientRect(),o=a.left,l=a.top;return{left:o,top:l}}),ge(ye(t),"getListeningVolume",function(n){return Math.pow(n,2)}),ge(ye(t),"getVolumeBarValue",function(n){return Math.sqrt(n)}),ge(ye(t),"onAudioReload",function(){t.props.audioLists.length&&(t.handlePlay(Et.singleLoop),t.props.onAudioReload&&t.props.onAudioReload(t.getBaseAudioInfo()))}),ge(ye(t),"onOpenPanel",function(){var n=t.props,a=n.toggleMode,o=n.spaceBar;a&&(t.setState({toggle:!0}),t.props.onModeChange&&t.props.onModeChange(Sr.FULL),o&&t.player.current&&t.player.current.focus({preventScroll:!0})),t.onCoverClick(Sr.MINI)}),ge(ye(t),"onHidePanel",function(){t.setState({toggle:!1,audioListsPanelVisible:!1}),t.props.onModeChange&&t.props.onModeChange(Sr.MINI)}),ge(ye(t),"onDestroyPlayer",function(){if(t.props.onBeforeDestroy){var n=Promise.resolve(t.props.onBeforeDestroy(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()));n&&n.then&&n.then(function(){t._onDestroyPlayer()}).catch(function(){});return}t._onDestroyPlayer()}),ge(ye(t),"_onDestroyPlayer",function(){t.unInstallPlayer()}),ge(ye(t),"_onDestroyed",function(){t.setState({isPlayDestroyed:!0}),t.props.onDestroyed&&t.props.onDestroyed(t.state.playId,t.state.audioLists,t.getBaseAudioInfo())}),ge(ye(t),"getCurrentPlayIndex",function(){return t.state.audioLists.findIndex(function(n){return n[mt]===t.state.playId})}),ge(ye(t),"resetAudioPlayStatus",function(){return new Promise(function(n){t.setState({currentTime:0,loading:!1,playing:!1,canPlay:!1,lyric:"",currentLyric:"",loadedProgress:0,playIndex:qn},n)})}),ge(ye(t),"onTogglePlay",function(){if(t.setState({isAudioSeeking:!1}),t.state.audioLists.length>=1){var n=t.props.volumeFade||{},a=n.fadeIn,o=n.fadeOut,l=t.state,h=l.currentVolumeFade,p=l.currentVolumeFadeInterval,u=h===kr.IN||h===kr.OUT;if(u&&(clearInterval(p),t.setState({currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0})),!u&&t.state.playing||h===kr.IN){t.setState({currentVolumeFade:kr.OUT});var f=Gf(t.audio,t.audio.volume,0,{duration:o},function(){t.audio.pause(),t.setState({currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,playing:!1,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),g=f.fadeInterval,E=f.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:g,updateIntervalEndVolume:E})}else{t.setState({currentVolumeFade:kr.IN});var S=u?t.audio.volume:0,_=t.getListeningVolume(t.state.soundValue),m=Gf(t.audio,S,_,{duration:a},function(){t.setState({currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),c=m.fadeInterval,v=m.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:c,updateIntervalEndVolume:v,isAutoPlayWhenUserClicked:!0},function(){c&&(t.audio.volume=S),t.loadAndPlayAudio()})}}}),ge(ye(t),"playAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;(t.isAudioCanPlay||n)&&(n&&t.setAudioLoaded(),t.loadAndPlayAudio(n))}),ge(ye(t),"setAudioLoaded",function(){t.setState({loading:!1,playing:!1})}),ge(ye(t),"onAudioPause",function(){t.setState({playing:!1}),t.props.onAudioPause&&t.props.onAudioPause(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay()}),ge(ye(t),"onAudioPlay",function(){t.state.isAudioSeeking||(t.setState({playing:!0,loading:!1}),t.props.onAudioPlay&&t.props.onAudioPlay(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay())}),ge(ye(t),"onSetAudioLoadedProgress",function(){var n=t.audio,a=n.buffered,o=n.duration;if(a.length&&a.end){var l=a.end(a.length-1)/o*100;t.setState({loadedProgress:l})}}),ge(ye(t),"loadAndPlayAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=t.props.remember,o=t.state,l=o.isInitRemember,h=o.musicSrc,p=t.audio,u=p.networkState,f=p.readyState;if(!!h){if(u===Ff.NETWORK_NO_SOURCE||u===Ff.NETWORK_EMPTY)return t.onAudioError({reason:`
          [loadAndPlayAudio]: Failed to load because no supported source was found.
          current network status is `.concat(u,`.
        `)});if(t.setState({playing:!1,loading:!0,isAudioSeeking:!1,isResetCoverRotate:!1}),n||f>=g0.HAVE_FUTURE_DATA){var g=t.getLastPlayStatus(),E=g.playing,S=a&&!l&&!E,_=a?!S:t.isAudioCanPlay;t.setState({playing:_,loading:!1},function(){_&&t.play(),t.setState({isInitAutoPlay:!0,isInitRemember:!0,isAutoPlayWhenUserClicked:!1})})}else t.audio.load()}}),ge(ye(t),"onAudioError",function(n){var a=t.state,o=a.playMode,l=a.audioLists,h=a.playId,p=a.musicSrc,u=t.props.loadAudioErrorPlayNext,f=o===Et.singleLoop,g=f?Et.order:o;if(t.lyric&&t.lyric.stop(),p){if(u&&l.length){var E=(o===Et.order||o===Et.orderLoop)&&h===l[l.length-1][mt];E||t.handlePlay(g,!0)}t.props.onAudioError&&t.props.onAudioError(t.audio.error||n&&n.reason||null,h,l,t.getBaseAudioInfo())}}),ge(ye(t),"handlePlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=t.state,l=o.playId,h=o.audioLists,p=h.length;if(!!p){var u=t.getCurrentPlayIndex();switch(n){case Et.order:if(u===p-1){t.audio.pause();return}t.audioListsPlay(a?h[u+1][mt]:h[u-1][mt]);break;case Et.orderLoop:if(a){if(u===p-1)return t.audioListsPlay(h[0][mt]);t.audioListsPlay(h[u+1][mt])}else{if(u===0)return t.audioListsPlay(h[p-1][mt]);t.audioListsPlay(h[u-1][mt])}break;case Et.singleLoop:t.audio.currentTime=0,t.audioListsPlay(l,!0);break;case Et.shufflePlay:{var f=w0(0,p-1);f===t.getCurrentPlayIndex()&&(f=t.getPlayIndex(f+1));var g=(h[f]||{})[mt];t.audioListsPlay(g,!0)}break}}}),ge(ye(t),"onAudioEnd",function(){t.props.onAudioEnded&&t.props.onAudioEnded(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()),t.handlePlay(t.state.playMode)}),ge(ye(t),"audioPrevAndNextBasePlayHandle",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=t.state.playMode,o="";switch(a){case Et.shufflePlay:o=a;break;default:o=Et.orderLoop;break}t.handlePlay(o,n)}),ge(ye(t),"onPlayPrevAudio",function(){var n=t.props.restartCurrentOnPrev;if(n&&t.audio.currentTime>1){t.audio.currentTime=0;return}t.audioPrevAndNextBasePlayHandle(!1)}),ge(ye(t),"onPlayNextAudio",function(){t.audioPrevAndNextBasePlayHandle(!0)}),ge(ye(t),"audioTimeUpdate",function(){var n=t.audio.currentTime;t.setState({currentTime:n}),t.props.remember&&t.saveLastPlayStatus(),t.props.onAudioProgress&&t.props.onAudioProgress(t.getBaseAudioInfo())}),ge(ye(t),"onAudioSoundChange",function(n){t.setAudioVolume(n)}),ge(ye(t),"onAudioVolumeChange",function(){var n=t.audio.volume,a=t.state,o=a.currentVolumeFade,l=a.currentAudioVolume;if(!(o!==kr.NONE||l===n)){var h=t.getVolumeBarValue(n);if(t.setState({soundValue:h}),t.props.onAudioVolumeChange){var p=parseFloat(n.toFixed(4));t.props.onAudioVolumeChange(p)}}}),ge(ye(t),"onProgressChange",function(n){t.audio&&(t.audio.currentTime=n),t.setState({currentTime:n,isAudioSeeking:!0})}),ge(ye(t),"onAudioSeeked",function(n){t.setState({isAudioSeeking:!0}),!!t.state.audioLists.length&&(t.lyric&&t.lyric.seek(n*1e3),t.state.playing||t.lyric&&t.lyric.stop(),t.audio&&(t.audio.currentTime=n),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo()),setTimeout(function(){t.setState({isAudioSeeking:!1})},500))}),ge(ye(t),"onAudioMute",function(){t.setState({soundValue:0,currentAudioVolume:t.audio.volume},function(){t.audio.volume=0})}),ge(ye(t),"onAudioAbort",function(n){var a=t.state,o=a.audioLists,l=a.playId,h=t.getBaseAudioInfo(),p=ht(ht({},n),h);t.props.onAudioAbort&&t.props.onAudioAbort(l,o,p)}),ge(ye(t),"toggleMode",function(n){n===Sr.FULL&&t.setState({toggle:!0})}),ge(ye(t),"toggleTheme",function(n){t.setState({theme:n})}),ge(ye(t),"onAudioListsSortEnd",function(n){var a=n.oldIndex,o=n.newIndex;if(a!==o){var l=t.state,h=l.playId,p=l.audioLists,u=cn(p),f=u.splice(a,1)[0];u.splice(o,0,f);var g=a===h?o:h;t.setState({audioLists:u,playId:g}),t.props.onAudioListsSortEnd&&t.props.onAudioListsSortEnd(a,o),t.props.onAudioListsChange&&t.props.onAudioListsChange(g,u,t.getBaseAudioInfo()),t.props.onAudioListsDragEnd&&(console.warn("[Deprecated] onAudioListsDragEnd is deprecated. please use onAudioListsSortEnd(oldIndex, newIndex){}"),t.props.onAudioListsDragEnd(a,o))}}),ge(ye(t),"saveLastPlayStatus",function(){var n=t.state,a=n.currentTime,o=n.playId,l=n.theme,h=n.soundValue,p=n.playMode,u=n.name,f=n.cover,g=n.singer,E=n.musicSrc,S=JSON.stringify({currentTime:a,playId:o,theme:l,playMode:p,soundValue:h,name:u,cover:f,singer:g,musicSrc:E});localStorage.setItem("lastPlayStatus",S)}),ge(ye(t),"getLastPlayStatus",function(){var n=t.props,a=n.theme,o=n.defaultPlayMode,l=n.playMode,h=n.defaultPlayIndex,p=n.playIndex,u={currentTime:0,playMode:l||o||Et.order,name:"",cover:"",singer:"",musicSrc:"",lyric:"",playId:t.getDefaultPlayId(),theme:a,playing:!0,playIndex:p||h||0};try{return JSON.parse(localStorage.getItem("lastPlayStatus"))||u}catch(f){return u}}),ge(ye(t),"checkCurrentPlayingAudioIsInUpdatedAudioLists",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props,a=t.state,o=a.playId,l=a.musicSrc;return!n.quietUpdate||!Array.isArray(n.audioLists)?!1:o&&n.audioLists.some(function(h){return h[mt]===o||h.musicSrc===l})}),ge(ye(t),"play",function(){var n=t.audio.play();n&&n.then&&n.then(function(){t.setState({loading:!1,playing:!0})}).catch(function(){t.setState({loading:!1,playing:!1})})}),ge(ye(t),"mockAutoPlayForMobile",function(){t.props.autoPlay&&!t.state.playing&&(t.audio.load(),t.play())}),ge(ye(t),"bindMobileAutoPlayEvents",function(){document.addEventListener("touchstart",function(){t.mockAutoPlayForMobile()},{once:!0}),document.addEventListener("WeixinJSBridgeReady",function(){t.mockAutoPlayForMobile()})}),ge(ye(t),"bindSafariAutoPlayEvents",function(){document.addEventListener("click",function(){t.mockAutoPlayForMobile()},{once:!0})}),ge(ye(t),"unBindEvents",function(){var n;(n=t).bindEvents.apply(n,arguments)}),ge(ye(t),"bindEvents",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.audio,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{waiting:t.loadAndPlayAudio,canplay:t.onAudioCanPlay,error:t.onAudioError,ended:t.onAudioEnd,pause:t.onAudioPause,play:t.onAudioPlay,timeupdate:t.audioTimeUpdate,volumechange:t.onAudioVolumeChange,abort:t.onAudioAbort,progress:t.onSetAudioLoadedProgress},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=t.props.once;for(var h in a){var p=a[h];n&&(o?n.addEventListener(h,p,{once:!!(l&&h==="play")}):n.removeEventListener(h,p))}}),ge(ye(t),"getPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.audioLists,a=t.getPlayIndex(void 0,n),o=t.state.playId||n[a]&&n[a][mt];return o}),ge(ye(t),"_getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=t.getPlayId(n),o=n.find(function(c){return c[mt]===a})||{},l=o.name,h=l===void 0?"":l,p=o.cover,u=p===void 0?"":p,f=o.singer,g=f===void 0?"":f,E=o.musicSrc,S=E===void 0?"":E,_=o.lyric,m=_===void 0?"":_;return{name:h,cover:u,singer:g,musicSrc:S,lyric:m,audioLists:n,playId:a}}),ge(ye(t),"getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=n.filter(function(h){return!h[mt]}),o=n.filter(function(h){return h[mt]}),l=[].concat(cn(o),cn(a.map(function(h){return ht(ht({},h),{},ge({},mt,$f()))})));return t._getPlayInfo(l)}),ge(ye(t),"getPlayInfoOfNewList",function(n){var a=n.audioLists,o=a===void 0?[]:a,l=o.map(function(h){var p=n.quietUpdate&&t.state.audioLists.find(function(u){var f=u.musicSrc;return f===h.musicSrc})||{};return ht(ht({},h),{},ge({},mt,p[mt]||$f()))});return t._getPlayInfo(l)}),ge(ye(t),"initPlayInfo",function(n,a){var o=t.getPlayInfo(n);switch(yi(o.musicSrc)){case"function":o.musicSrc().then(function(l){t.setState(ht(ht({},o),{},{musicSrc:l}),a)},t.onAudioError);break;default:t.setState(o,a)}}),ge(ye(t),"addMatchMediaListener",function(n,a){var o=window.matchMedia(n);return a(o),"addEventListener"in o?o.addEventListener("change",a):o.addListener(a),o}),ge(ye(t),"removeMatchMediaListener",function(n,a){n&&("removeEventListener"in n?n.removeEventListener("change",a):n.removeListener&&n.removeListener(a))}),ge(ye(t),"addMobileListener",function(){t.mobileMedia=t.addMatchMediaListener(t.props.mobileMediaQuery,t.mobileMediaHandler)}),ge(ye(t),"removeMobileListener",function(){t.removeMatchMediaListener(t.mobileMedia,t.mobileMediaHandler)}),ge(ye(t),"addSystemThemeListener",function(){t.systemThemeMedia=t.addMatchMediaListener(Nf.DARK_THEME,t.systemThemeMediaHandler)}),ge(ye(t),"removeSystemThemeListener",function(){t.removeMatchMediaListener(t.systemThemeMedia,t.systemThemeMediaHandler)}),ge(ye(t),"mobileMediaHandler",function(n){var a=n.matches;t.setState({isMobile:!!a})}),ge(ye(t),"systemThemeMediaHandler",function(n){var a=n.matches;if(t.props.theme===Tr.AUTO){var o=a?Tr.DARK:Tr.LIGHT;t.updateTheme(o)}}),ge(ye(t),"setDefaultAudioVolume",function(){var n=t.props,a=n.defaultVolume,o=n.remember;t.defaultVolume=Math.max(0,Math.min(a,1));var l=t.getLastPlayStatus(),h=l.soundValue,p=h===void 0?t.defaultVolume:h;t.setAudioVolume(o?p:t.defaultVolume)}),ge(ye(t),"getDefaultPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=t.getPlayIndex();return n[a]&&n[a][mt]}),ge(ye(t),"initLyricParser",function(){t.lyric=new A0(t.state.lyric,t.onLyricChange),t.setState({currentLyric:t.lyric.lines[0]&&t.lyric.lines[0].text})}),ge(ye(t),"onLyricChange",function(n){var a=n.lineNum,o=n.txt;t.setState({currentLyric:o}),t.props.onAudioLyricChange&&t.props.onAudioLyricChange(a,o)}),ge(ye(t),"updateTheme",function(n){n&&n!==t.props.theme&&Object.values(Tr).includes(n)&&t.setState({theme:n})}),ge(ye(t),"updateMode",function(n){n&&n!==t.props.mode&&Object.values(Sr).includes(n)&&(t.setState({toggle:n===Sr.FULL}),n===Sr.MINI&&t._closeAudioListsPanel())}),ge(ye(t),"updatePlayMode",function(n){!Object.values(Et).includes(n)||n!==t.props.playMode&&t.setState({playMode:n})}),ge(ye(t),"updateAudioLists",function(n){var a=[].concat(cn(t.state.audioLists),cn(n.filter(function(o){return t.state.audioLists.findIndex(function(l){return l.musicSrc===o.musicSrc})===-1})));t.initPlayInfo(a),t.bindEvents(t.audio),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n,t.getBaseAudioInfo())}),ge(ye(t),"loadNewAudioLists",function(n){var a=n.audioLists,o=n.remember,l=n.playMode,h=n.theme,p=n.autoPlayInitLoadPlayList,u=n.playIndex;if(!(!Array.isArray(a)||!a.length)){var f=t.getPlayInfoOfNewList(n),g=o?t.getLastPlayStatus():{playMode:l||Et.order,playIndex:u||qn};h!==Tr.AUTO&&(g.theme=h);var E=ht(ht(ht({},f),g),{},{isInitAutoPlay:p,playing:t.isAudioCanPlay});if(t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)){t.setState({audioLists:f.audioLists});return}switch(yi(f.musicSrc)){case"function":f.musicSrc().then(function(S){t.setState(ht(ht({},E),{},{musicSrc:S}))},t.onAudioError);break;default:t.setState(E)}}}),ge(ye(t),"resetPlayId",function(){return new Promise(function(n){t.setState({playId:t.initPlayId},n)})}),ge(ye(t),"changeAudioLists",function(n){t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)||t.resetAudioStatus(),t.resetPlayId().then(function(){t.loadNewAudioLists(n),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n.audioLists,t.getBaseAudioInfo())})}),ge(ye(t),"updatePlayIndex",function(n){var a=t.getCurrentPlayIndex();n!==void 0&&a!==n&&t.resetAudioPlayStatus().then(function(){var o=t.state.audioLists[t.getPlayIndex(n)];o&&o[mt]&&t.audioListsPlay(o[mt],!0)})}),ge(ye(t),"playByIndex",function(n){t.updatePlayIndex(n)}),ge(ye(t),"getEnhanceAudio",function(){var n=ye(t),a=n.audio;return[{name:"destroy",value:t.onDestroyPlayer},{name:"updatePlayIndex",value:t.updatePlayIndex},{name:"playByIndex",value:t.playByIndex},{name:"playNext",value:t.onPlayNextAudio},{name:"playPrev",value:t.onPlayPrevAudio},{name:"togglePlay",value:t.onTogglePlay},{name:"clear",value:t.clearAudioLists},{name:"sortable",value:t.sortable}].forEach(function(o){var l=o.name,h=o.value;Object.defineProperty(a,l,{value:h,writable:!1})}),a}),ge(ye(t),"onGetAudioInstance",function(){t.props.getAudioInstance&&t.props.getAudioInstance(t.getEnhanceAudio())}),ge(ye(t),"updateMediaSessionMetadata",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=t.state,a=n.name,o=n.cover,l=n.singer,h={title:a,artist:l,album:a};o&&(h.artwork=["96x96","128x128","192x192","256x256","384x384","512x512"].map(function(p){return{src:o,sizes:p,type:"image/png"}})),navigator.mediaSession.metadata=new MediaMetadata(h),t.updateMediaSessionPositionState()}}),ge(ye(t),"updateMediaSessionPositionState",function(){if("setPositionState"in navigator.mediaSession)try{var n=ye(t),a=n.audio;navigator.mediaSession.setPositionState({duration:t.audioDuration,playbackRate:a.playbackRate||1,position:a.currentTime||0})}catch(o){console.error("Update media session position state failed: ",o)}}),ge(ye(t),"onAddMediaSession",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=10;navigator.mediaSession.setActionHandler("play",t.onTogglePlay),navigator.mediaSession.setActionHandler("pause",t.onTogglePlay),navigator.mediaSession.setActionHandler("seekbackward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.max(t.audio.currentTime-o,0),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("seekforward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.min(t.audio.currentTime+o,t.audioDuration),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("previoustrack",t.onPlayPrevAudio),navigator.mediaSession.setActionHandler("nexttrack",t.onPlayNextAudio),setTimeout(function(){t.updateMediaSessionMetadata()},0);try{navigator.mediaSession.setActionHandler("seekto",function(a){if(a.fastSeek&&"fastSeek"in t.audio){t.audio.fastSeek(a.seekTime);return}t.audio.currentTime=a.seekTime,t.updateMediaSessionPositionState()})}catch(a){console.warn('Warning! The "seekto" media session action is not supported.')}}}),ge(ye(t),"bindUnhandledRejection",function(){window.addEventListener("unhandledrejection",t.onAudioError)}),ge(ye(t),"unBindUnhandledRejection",function(){window.removeEventListener("unhandledrejection",t.onAudioError)}),ge(ye(t),"bindKeyDownEvents",function(){t.props.spaceBar&&t.player.current&&(t.player.current.addEventListener("keydown",t.onKeyDown,!1),t.player.current.focus({preventScroll:!0}))}),ge(ye(t),"unBindKeyDownEvents",function(){t.player.current&&t.player.current.removeEventListener("keydown",t.onKeyDown,!1)}),ge(ye(t),"onKeyDown",function(n){var a=t.props.spaceBar;a&&n.keyCode===v0&&t.onTogglePlay()}),ge(ye(t),"initPlayer",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;o&&t.setDefaultAudioVolume(),!(!Array.isArray(n)||!n.length)&&(t.bindUnhandledRejection(),t.bindEvents(t.audio),t.initLyricParser(),t.onAddMediaSession(),hl?t.bindMobileAutoPlayEvents():(a&&t.bindKeyDownEvents(),L0()&&t.bindSafariAutoPlayEvents()))}),ge(ye(t),"removeLyric",function(){t.lyric&&(t.lyric.stop(),t.lyric=void 0)}),ge(ye(t),"unInstallPlayer",function(){t.unBindEvents(t.audio,void 0,!1),t.unBindUnhandledRejection(),t.unBindKeyDownEvents(),t.removeMobileListener(),t.removeLyric(),t._onDestroyed(),t.sortable&&t.sortable.destroy()}),ge(ye(t),"onAudioCanPlay",function(){t.state.isAudioSeeking||t.setState({canPlay:!0},function(){t.playAudio(!0)})}),ge(ye(t),"initSortableAudioLists",function(){var n=t.props,a=n.audioLists,o=n.sortableOptions,l=ll.selector,h=D0(ll,["selector"]),p=document.querySelector(".".concat(l));Array.isArray(a)&&!a.length||!p||(t.sortable&&t.sortable.destroy(),t.sortable=new Je(p,ht(ht({onEnd:t.onAudioListsSortEnd},h),o)))}),t.audio=null,t.targetId="music-player-controller",t._PLAY_MODE_=Object.values(Et),t._PLAY_MODE_LENGTH_=t._PLAY_MODE_.length,t.player=Ye.exports.createRef(),t.destroyBtn=Ye.exports.createRef(),t}return B0(r,[{key:"locale",get:function(){var t=this.props.locale;return typeof t=="string"?jf[this.props.locale]:t?ht(ht({},jf[ea.en_US]),t):{}}},{key:"audioDuration",get:function(){var t=this.state,n=t.audioLists,a=t.playId;if(!n.length||!this.audio)return 0;var o=n.find(function(h){return h[mt]===a})||{},l=o.duration;return Math.max(Number(l)||this.audio.duration||0,0)}},{key:"isAudioCanPlay",get:function(){var t=this.props.autoPlay,n=this.state,a=n.isInitAutoPlay,o=n.isAutoPlayWhenUserClicked,l=n.canPlay;return l&&(a||t||o)}},{key:"iconMap",get:function(){var t=this,n=function(){return q.createElement("span",{className:"loading group"},t.props.icon.loading)};return ht(ht(ht({},Zf),this.props.icon),{},{loading:q.createElement(n,null)})}},{key:"render",value:function(){var t=this,n=this.props,a=n.className,o=n.drag,l=n.style,h=n.showDownload,p=n.showPlay,u=n.showReload,f=n.showPlayMode,g=n.showThemeSwitch,E=n.toggleMode,S=n.showMiniModeCover,_=n.extendsContent,m=n.defaultPlayMode,c=n.seeked,v=n.showProgressLoadBar,y=n.bounds,d=n.defaultPosition,x=n.showMiniProcessBar,b=n.preload,T=n.glassBg,A=n.remove,L=n.lyricClassName,R=n.showLyric,w=n.getContainer,O=n.autoHiddenCover,I=n.showDestroy,D=n.responsive,C=this.locale,P=this.state,M=P.toggle,N=P.playing,B=P.currentTime,U=P.soundValue,F=P.moveX,j=P.moveY,V=P.loading,G=P.audioListsPanelVisible,Y=P.theme,X=P.name,ie=P.cover,he=P.singer,de=P.musicSrc,Ae=P.playId,pe=P.isMobile,le=P.playMode,Ie=P.playModeTipVisible,Ce=P.playModelNameVisible,Ue=P.initAnimate,Me=P.loadedProgress,ze=P.audioLists,Ge=P.removeId,$e=P.currentLyric,He=P.audioLyricVisible,Fe=P.isPlayDestroyed,Se=P.isResetCoverRotate,Xe=b===!1||b==="none"?{}:b===!0?{preload:"auto"}:{preload:b},st=Ue?{show:G,hide:!G}:{show:G},et=Et[le||m]||Et.order,ot=C.playModeText[et],nt=S&&!O||O&&ie?{style:{backgroundImage:"url(".concat(ie,")")}}:{},dt=Hf(B),ne=Hf(this.audioDuration),Ee=c?{onChange:this.onProgressChange,onAfterChange:this.onAudioSeeked}:{},xe=q.createElement(q.Fragment,null,v&&q.createElement("div",{className:"progress-load-bar",style:{width:"".concat(Math.min(Me,100),"%")}}),q.createElement(Bo,dn({max:Math.ceil(this.audioDuration),defaultValue:0,value:Math.ceil(B)},Ee,y0))),we=h&&q.createElement("span",{className:"group audio-download",onClick:this.onAudioDownload,title:C.downloadText},this.iconMap.download),be=g&&q.createElement("span",{className:"group theme-switch"},q.createElement(Hu,{className:"theme-switch-container",onChange:this.themeChange,checkedChildren:C.lightThemeText,unCheckedChildren:C.darkThemeText,checked:Y===Tr.LIGHT,title:C.switchThemeText})),je=u&&q.createElement("span",{className:"group reload-btn",onClick:this.onAudioReload,title:C.reloadText},this.iconMap.reload),K=R&&q.createElement("span",{className:Ft("group lyric-btn",{"lyric-btn-active":He}),onClick:this.toggleAudioLyric,title:C.toggleLyricText},this.iconMap.lyric),ce=f&&q.createElement("span",{className:Ft("group loop-btn"),onClick:this.togglePlayMode,title:C.playModeText[et]},this.renderPlayModeIcon(et)),_e=pe?30:40,Re=I&&q.createElement("span",{title:C.destroyText,className:"group destroy-btn",ref:this.destroyBtn,onClick:!o||M?this.onDestroyPlayer:void 0},this.iconMap.destroy),Z=q.createElement("div",{className:Ft("react-jinke-music-player"),style:d,tabIndex:"-1"},q.createElement("div",{className:Ft("music-player")},x&&q.createElement(gm,{progress:B/this.audioDuration,r:_e}),q.createElement("div",dn({id:this.targetId,className:Ft("scale","music-player-controller",{"music-player-playing":N})},nt,{onClick:o?void 0:this.onOpenPanel}),V?this.iconMap.loading:q.createElement(q.Fragment,null,q.createElement("span",{className:"controller-title"},C.controllerTitle),q.createElement("div",{className:"music-player-controller-setting"},M?C.closeText:C.openText))),Re)),ue=w()||document.body,W=this.getAudioTitle();if(Fe)return null;var me=!N||this.state.currentVolumeFade===kr.OUT;return Mn.exports.createPortal(q.createElement("div",{className:Ft("react-jinke-music-player-main",{"light-theme":Y===Tr.LIGHT,"dark-theme":Y===Tr.DARK},a),style:l,ref:this.player,tabIndex:"-1"},M&&pe&&D&&q.createElement(d0,{playing:N,loading:V,name:X,singer:he,cover:ie,themeSwitch:be,duration:ne,currentTime:dt,progressBar:xe,onPlay:this.onTogglePlay,currentPlayModeName:ot,playMode:ce,audioNextPlay:this.onPlayNextAudio,audioPrevPlay:this.onPlayPrevAudio,icon:ht(ht({},this.iconMap),{},{reload:je,download:we,lyric:K}),playModeTipVisible:Ie,openAudioListsPanel:this.openAudioListsPanel,onClose:this.onHidePanel,extendsContent:_,glassBg:T,autoHiddenCover:O,onCoverClick:this.onCoverClick,locale:C,toggleMode:E,renderAudioTitle:this.renderAudioTitle,shouldShowPlayIcon:me,isResetCoverRotate:Se}),M?void 0:o?q.createElement(uf,{bounds:y,position:{x:F,y:j},onDrag:this.onControllerDrag,onStop:this.onControllerDragStop,onStart:this.onControllerDragStart},Z):Z,M&&(!pe||!D)&&q.createElement("div",{className:Ft("music-player-panel","translate",{"glass-bg":T})},q.createElement("section",{className:"panel-content"},(!O||O&&ie)&&q.createElement("div",{className:Ft("img-content","img-rotate",{"img-rotate-pause":!N||!ie,"img-rotate-reset":Se}),style:{backgroundImage:"url(".concat(ie,")")},onClick:function(){return t.onCoverClick()}}),q.createElement("div",{className:"progress-bar-content"},q.createElement("span",{className:"audio-title",title:W},this.renderAudioTitle()),q.createElement("section",{className:"audio-main"},q.createElement("span",{className:"current-time",title:dt},V?"--":dt),q.createElement("div",{className:"progress-bar"},xe),q.createElement("span",{className:"duration",title:ne},V?"--":ne))),q.createElement("div",{className:"player-content"},p?q.createElement("span",{className:"group"},q.createElement("span",{className:"group prev-audio",title:C.previousTrackText,onClick:this.onPlayPrevAudio},this.iconMap.prev),V?q.createElement("span",{className:"group loading-icon",title:C.loadingText},this.iconMap.loading):q.createElement("span",{className:"group play-btn",onClick:this.onTogglePlay,title:me?C.clickToPlayText:C.clickToPauseText},me?this.iconMap.play:this.iconMap.pause),q.createElement("span",{className:"group next-audio",title:C.nextTrackText,onClick:this.onPlayNextAudio},this.iconMap.next)):V&&this.iconMap.loading,je,we,be,_||null,q.createElement("span",{className:"group play-sounds",title:C.volumeText},U===0?q.createElement("span",{className:"sounds-icon",onClick:this.onResetVolume},this.iconMap.mute):q.createElement("span",{className:"sounds-icon",onClick:this.onAudioMute},this.iconMap.volume),q.createElement(Bo,dn({value:U,onChange:this.onAudioSoundChange,className:"sound-operation"},E0))),ce,K,q.createElement("span",{className:"group audio-lists-btn",title:C.playListsText,onClick:this.openAudioListsPanel},q.createElement("span",{className:"audio-lists-icon"},this.iconMap.playLists),q.createElement("span",{className:"audio-lists-num"},ze.length)),E&&q.createElement("span",{className:"group hide-panel",title:C.toggleMiniModeText,onClick:this.onHidePanel},this.iconMap.toggle),Re))),q.createElement(pm,{playing:N,playId:Ae,loading:V,visible:G,audioLists:ze,onPlay:this.audioListsPlay,onCancel:this.closeAudioListsPanel,icon:this.iconMap,isMobile:pe,panelToggleAnimate:st,glassBg:T,cover:ie,remove:A,onDelete:this.onDeleteAudioLists,removeId:Ge,locale:C}),!pe&&q.createElement(h0,{visible:Ce,value:ot}),He&&q.createElement(uf,null,q.createElement("div",{className:Ft("music-player-lyric",L)},$e||C.emptyLyricText)),q.createElement("audio",dn({className:"music-player-audio",title:W},Xe,{src:de,ref:function(k){t.audio=k}}))),ue)}},{key:"getBaseAudioInfo",value:function(){var t=this.state,n=t.cover,a=t.name,o=t.musicSrc,l=t.soundValue,h=t.lyric,p=t.audioLists,u=t.currentLyric,f=this.audio||{},g=f.currentTime,E=f.muted,S=f.networkState,_=f.readyState,m=f.played,c=f.paused,v=f.ended,y=f.startDate,d=this.getCurrentPlayIndex(),x=p[d]||{};return ht(ht({},x),{},{cover:n,name:a,musicSrc:o,volume:l,currentTime:g,duration:this.audioDuration,muted:E,networkState:S,readyState:_,played:m,paused:c,ended:v,startDate:y,lyric:h,currentLyric:u,playIndex:d})}},{key:"componentDidUpdate",value:function(t,n){n.musicSrc!==this.state.musicSrc&&this.setState({isResetCoverRotate:!0})}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){var n=this,a=t.audioLists,o=t.playIndex,l=t.theme,h=t.mode,p=t.playMode,u=t.clearPriorAudioLists,f=O0(a)(this.props.audioLists);f||(u?this.changeAudioLists(t):this.updateAudioLists(a),this.checkCurrentPlayingAudioIsInUpdatedAudioLists(t)||this.initPlayer(a,!1,!1),setTimeout(function(){return n.initSortableAudioLists()},200)),this.updatePlayIndex(!f&&u?qn:o),this.updateTheme(l),this.updateMode(h),this.updatePlayMode(p)}},{key:"UNSAFE_componentWillMount",value:function(){var t=this,n=this.props,a=n.audioLists,o=n.remember;if(Array.isArray(a)&&a.length>=1){var l=this.getPlayInfo(a),h=o?this.getLastPlayStatus():{};switch(yi(l.musicSrc)){case"function":l.musicSrc().then(function(p){t.setState(ht(ht({},l),{},{musicSrc:p},h))},this.onAudioError);break;default:this.setState(ht(ht({},l),h))}}}},{key:"componentWillUnmount",value:function(){this.unInstallPlayer()}},{key:"componentDidMount",value:function(){this.addMobileListener(),this.addSystemThemeListener(),this.initPlayer(),this.initSortableAudioLists(),this.onGetAudioInstance()}}]),r}(Ye.exports.PureComponent);ge(pl,"defaultProps",{audioLists:[],theme:Tr.DARK,mode:Sr.MINI,defaultPlayMode:Et.order,defaultPosition:{left:0,top:0},once:!1,drag:!0,toggleMode:!0,showMiniModeCover:!0,showDownload:!0,showPlay:!0,showReload:!0,showPlayMode:!0,showThemeSwitch:!0,showLyric:!1,playModeTipVisible:!1,autoPlay:!0,defaultVolume:1,showProgressLoadBar:!0,seeked:!0,playModeShowTime:600,bounds:"body",showMiniProcessBar:!1,loadAudioErrorPlayNext:!0,preload:!1,glassBg:!1,remember:!1,remove:!0,defaultPlayIndex:0,getContainer:function(){return document.body},autoHiddenCover:!1,onBeforeAudioDownload:function(){},spaceBar:!1,showDestroy:!1,showMediaSession:!1,locale:ea.en_US,responsive:!0,icon:Zf,quietUpdate:!1,mobileMediaQuery:Nf.MOBILE,volumeFade:{fadeIn:0,fadeOut:0},restartCurrentOnPrev:!1,sortableOptions:{}});ge(pl,"propTypes",m0);const Qf=4,V0=[],K0=({file:s})=>{const{lastFiles:e,getSetting:r}=Ye.exports.useContext(Vr),i=Yh("light","dark"),{t,i18n:n}=kn(),[a,o]=q.useState([]),l=ui(),[h,p]=fp("volume",.5),u=hu({base:!0,md:!1}),f=r("music cover")||"https://store.heytapimage.com/cdo-portal/feedback/202110/30/d43c41c5d257c9bc36366e310374fb19.png",g=t("unknown"),[E,S]=q.useState(0);return Ye.exports.useEffect(()=>{const _={name:s.name,musicSrc:l(),cover:f,singer:g};s.thumbnail&&(_.cover=s.thumbnail);const m=e.filter(c=>c.type===Qf).map(c=>{let v=l(c);const y={name:c.name,musicSrc:v,cover:f,singer:g};return c.thumbnail&&(y.cover=c.thumbnail),y});m.length>0?o(m):o([_]),S(m.findIndex(c=>c.name===s.name))},[]),q.createElement(Xi,{className:"audio-box",w:"full"},q.createElement(Zi,{p:"8",w:"full"},q.createElement(Da,{display:"inline-flex",alignItems:"center"},q.createElement(Nn,{color:r("icon color")||"#1890ff",as:Ca(s.type,"")}),t("Enjoy the music"),"...")),q.createElement(pl,{audioLists:a,theme:i,locale:n.language==="zh"?"zh_CN":"en_US",mode:"full",autoPlay:r("autoplay audio")==="true",defaultPosition:{left:20,bottom:20},playIndex:E,onPlayIndexChange:S,sortableOptions:{disabled:u},defaultVolume:h,onAudioVolumeChange:_=>p(_)}))};var H0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:Qf,exts:V0,default:K0}),vl={},xs={},gl={exports:{}},$0="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",G0=$0,Y0=G0;function Jf(){}function qf(){}qf.resetWarningCache=Jf;var X0=function(){function s(i,t,n,a,o,l){if(l!==Y0){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}s.isRequired=s;function e(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:e,element:s,elementType:s,instanceOf:e,node:s,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:qf,resetWarningCache:Jf};return r.PropTypes=r,r};gl.exports=X0();var ed={},ta={},Ar={exports:{}},td={exports:{}},Z0=void 0,rd=function(s){return s!==Z0&&s!==null},Q0=rd,J0={object:!0,function:!0,undefined:!0},q0=function(s){return Q0(s)?hasOwnProperty.call(J0,typeof s):!1},ey=q0,ty=function(s){if(!ey(s))return!1;try{return s.constructor?s.constructor.prototype===s:!1}catch(e){return!1}},ry=ty,iy=function(s){if(typeof s!="function"||!hasOwnProperty.call(s,"length"))return!1;try{if(typeof s.length!="number"||typeof s.call!="function"||typeof s.apply!="function")return!1}catch(e){return!1}return!ry(s)},ny=iy,ay=/^\s*class[\s{/}]/,sy=Function.prototype.toString,oy=function(s){return!(!ny(s)||ay.test(sy.call(s)))},ly=function(){var s=Object.assign,e;return typeof s!="function"?!1:(e={foo:"raz"},s(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},uy=function(){try{return Object.keys("primitive"),!0}catch(s){return!1}},fy=function(){},dy=fy(),ml=function(s){return s!==dy&&s!==null},cy=ml,hy=Object.keys,py=function(s){return hy(cy(s)?Object(s):s)},vy=uy()?Object.keys:py,gy=ml,my=function(s){if(!gy(s))throw new TypeError("Cannot use null or undefined");return s},yy=vy,Ey=my,_y=Math.max,xy=function(s,e){var r,i,t=_y(arguments.length,2),n;for(s=Object(Ey(s)),n=function(a){try{s[a]=e[a]}catch(o){r||(r=o)}},i=1;i<t;++i)e=arguments[i],yy(e).forEach(n);if(r!==void 0)throw r;return s},by=ly()?Object.assign:xy,Sy=ml,Ty=Array.prototype.forEach,Ay=Object.create,wy=function(s,e){var r;for(r in s)e[r]=s[r]},Oy=function(s){var e=Ay(null);return Ty.call(arguments,function(r){!Sy(r)||wy(Object(r),e)}),e},yl="razdwatrzy",Ly=function(){return typeof yl.contains!="function"?!1:yl.contains("dwa")===!0&&yl.contains("foo")===!1},Iy=String.prototype.indexOf,Ry=function(s){return Iy.call(this,s,arguments[1])>-1},Dy=Ly()?String.prototype.contains:Ry,bs=rd,id=oy,nd=by,ad=Oy,ra=Dy,Cy=td.exports=function(s,e){var r,i,t,n,a;return arguments.length<2||typeof s!="string"?(n=e,e=s,s=null):n=arguments[2],bs(s)?(r=ra.call(s,"c"),i=ra.call(s,"e"),t=ra.call(s,"w")):(r=t=!0,i=!1),a={value:e,configurable:r,enumerable:i,writable:t},n?nd(ad(n),a):a};Cy.gs=function(s,e,r){var i,t,n,a;return typeof s!="string"?(n=r,r=e,e=s,s=null):n=arguments[3],bs(e)?id(e)?bs(r)?id(r)||(n=r,r=void 0):r=void 0:(n=e,e=r=void 0):e=void 0,bs(s)?(i=ra.call(s,"c"),t=ra.call(s,"e")):(i=!0,t=!1),a={get:e,set:r,configurable:i,enumerable:t},n?nd(ad(n),a):a};var Py=function(s){if(typeof s!="function")throw new TypeError(s+" is not a function");return s};(function(s,e){var r=td.exports,i=Py,t=Function.prototype.apply,n=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,h=Object.prototype.hasOwnProperty,p={configurable:!0,enumerable:!1,writable:!0},u,f,g,E,S,_,m;u=function(c,v){var y;return i(v),h.call(this,"__ee__")?y=this.__ee__:(y=p.value=a(null),o(this,"__ee__",p),p.value=null),y[c]?typeof y[c]=="object"?y[c].push(v):y[c]=[y[c],v]:y[c]=v,this},f=function(c,v){var y,d;return i(v),d=this,u.call(this,c,y=function(){g.call(d,c,y),t.call(v,this,arguments)}),y.__eeOnceListener__=v,this},g=function(c,v){var y,d,x,b;if(i(v),!h.call(this,"__ee__"))return this;if(y=this.__ee__,!y[c])return this;if(d=y[c],typeof d=="object")for(b=0;x=d[b];++b)(x===v||x.__eeOnceListener__===v)&&(d.length===2?y[c]=d[b?0:1]:d.splice(b,1));else(d===v||d.__eeOnceListener__===v)&&delete y[c];return this},E=function(c){var v,y,d,x,b;if(!!h.call(this,"__ee__")&&(x=this.__ee__[c],!!x))if(typeof x=="object"){for(y=arguments.length,b=new Array(y-1),v=1;v<y;++v)b[v-1]=arguments[v];for(x=x.slice(),v=0;d=x[v];++v)t.call(d,this,b)}else switch(arguments.length){case 1:n.call(x,this);break;case 2:n.call(x,this,arguments[1]);break;case 3:n.call(x,this,arguments[1],arguments[2]);break;default:for(y=arguments.length,b=new Array(y-1),v=1;v<y;++v)b[v-1]=arguments[v];t.call(x,this,b)}},S={on:u,once:f,off:g,emit:E},_={on:r(u),once:r(f),off:r(g),emit:r(E)},m=l({},_),s.exports=e=function(c){return c==null?a(m):l(Object(c),_)},e.methods=S})(Ar,Ar.exports);var Be={},ia={},ni={},Ci={};function El(s,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(s):s}var sd=El({HTML:"text/html",isHTML:function(s){return s===sd.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),od=El({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===od.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ci.freeze=El;Ci.MIME_TYPE=sd;Ci.NAMESPACE=od;var My=Ci,na=My.NAMESPACE;function ky(s){return s!==""}function Ny(s){return s?s.split(/[\t\n\f\r ]+/).filter(ky):[]}function Fy(s,e){return s.hasOwnProperty(e)||(s[e]=!0),s}function ld(s){if(!s)return[];var e=Ny(s);return Object.keys(e.reduce(Fy,{}))}function By(s){return function(e){return s&&s.indexOf(e)!==-1}}function aa(s,e){for(var r in s)e[r]=s[r]}function rr(s,e){var r=s.prototype;if(!(r instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,aa(r,i),s.prototype=r=i}r.constructor!=s&&(typeof s!="function"&&console.error("unknown Class:"+s),r.constructor=s)}var ir={},Nr=ir.ELEMENT_NODE=1,hn=ir.ATTRIBUTE_NODE=2,Ss=ir.TEXT_NODE=3,ud=ir.CDATA_SECTION_NODE=4,fd=ir.ENTITY_REFERENCE_NODE=5,Uy=ir.ENTITY_NODE=6,dd=ir.PROCESSING_INSTRUCTION_NODE=7,cd=ir.COMMENT_NODE=8,hd=ir.DOCUMENT_NODE=9,pd=ir.DOCUMENT_TYPE_NODE=10,ai=ir.DOCUMENT_FRAGMENT_NODE=11,jy=ir.NOTATION_NODE=12,Gt={},kt={};Gt.INDEX_SIZE_ERR=(kt[1]="Index size error",1);Gt.DOMSTRING_SIZE_ERR=(kt[2]="DOMString size error",2);var Wy=Gt.HIERARCHY_REQUEST_ERR=(kt[3]="Hierarchy request error",3);Gt.WRONG_DOCUMENT_ERR=(kt[4]="Wrong document",4);Gt.INVALID_CHARACTER_ERR=(kt[5]="Invalid character",5);Gt.NO_DATA_ALLOWED_ERR=(kt[6]="No data allowed",6);Gt.NO_MODIFICATION_ALLOWED_ERR=(kt[7]="No modification allowed",7);var zy=Gt.NOT_FOUND_ERR=(kt[8]="Not found",8);Gt.NOT_SUPPORTED_ERR=(kt[9]="Not supported",9);var vd=Gt.INUSE_ATTRIBUTE_ERR=(kt[10]="Attribute in use",10);Gt.INVALID_STATE_ERR=(kt[11]="Invalid state",11);Gt.SYNTAX_ERR=(kt[12]="Syntax error",12);Gt.INVALID_MODIFICATION_ERR=(kt[13]="Invalid modification",13);Gt.NAMESPACE_ERR=(kt[14]="Invalid namespace",14);Gt.INVALID_ACCESS_ERR=(kt[15]="Invalid access",15);function Pi(s,e){if(e instanceof Error)var r=e;else r=this,Error.call(this,kt[s]),this.message=kt[s],Error.captureStackTrace&&Error.captureStackTrace(this,Pi);return r.code=s,e&&(this.message=this.message+": "+e),r}Pi.prototype=Error.prototype;aa(Gt,Pi);function si(){}si.prototype={length:0,item:function(s){return this[s]||null},toString:function(s,e){for(var r=[],i=0;i<this.length;i++)vn(this[i],r,s,e);return r.join("")}};function pn(s,e){this._node=s,this._refresh=e,_l(this)}function _l(s){var e=s._node._inc||s._node.ownerDocument._inc;if(s._inc!=e){var r=s._refresh(s._node);Rd(s,"length",r.length),aa(r,s),s._inc=e}}pn.prototype.item=function(s){return _l(this),this[s]};rr(pn,si);function Ts(){}function gd(s,e){for(var r=s.length;r--;)if(s[r]===e)return r}function md(s,e,r,i){if(i?e[gd(e,i)]=r:e[e.length++]=r,s){r.ownerElement=s;var t=s.ownerDocument;t&&(i&&xd(t,s,i),Vy(t,s,r))}}function yd(s,e,r){var i=gd(e,r);if(i>=0){for(var t=e.length-1;i<t;)e[i]=e[++i];if(e.length=t,s){var n=s.ownerDocument;n&&(xd(n,s,r),r.ownerElement=null)}}else throw Pi(zy,new Error(s.tagName+"@"+r))}Ts.prototype={length:0,item:si.prototype.item,getNamedItem:function(s){for(var e=this.length;e--;){var r=this[e];if(r.nodeName==s)return r}},setNamedItem:function(s){var e=s.ownerElement;if(e&&e!=this._ownerElement)throw new Pi(vd);var r=this.getNamedItem(s.nodeName);return md(this._ownerElement,this,s,r),r},setNamedItemNS:function(s){var e=s.ownerElement,r;if(e&&e!=this._ownerElement)throw new Pi(vd);return r=this.getNamedItemNS(s.namespaceURI,s.localName),md(this._ownerElement,this,s,r),r},removeNamedItem:function(s){var e=this.getNamedItem(s);return yd(this._ownerElement,this,e),e},removeNamedItemNS:function(s,e){var r=this.getNamedItemNS(s,e);return yd(this._ownerElement,this,r),r},getNamedItemNS:function(s,e){for(var r=this.length;r--;){var i=this[r];if(i.localName==e&&i.namespaceURI==s)return i}return null}};function Ed(){}Ed.prototype={hasFeature:function(s,e){return!0},createDocument:function(s,e,r){var i=new oa;if(i.implementation=this,i.childNodes=new si,i.doctype=r||null,r&&i.appendChild(r),e){var t=i.createElementNS(s,e);i.appendChild(t)}return i},createDocumentType:function(s,e,r){var i=new ws;return i.name=s,i.nodeName=s,i.publicId=e||"",i.systemId=r||"",i}};function Yt(){}Yt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(s,e){return Sd(this,s,e)},replaceChild:function(s,e){this.insertBefore(s,e),e&&this.removeChild(e)},removeChild:function(s){return bd(this,s)},appendChild:function(s){return this.insertBefore(s,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(s){return Ll(this.ownerDocument||this,this,s)},normalize:function(){for(var s=this.firstChild;s;){var e=s.nextSibling;e&&e.nodeType==Ss&&s.nodeType==Ss?(this.removeChild(e),s.appendData(e.data)):(s.normalize(),s=e)}},isSupported:function(s,e){return this.ownerDocument.implementation.hasFeature(s,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(s){for(var e=this;e;){var r=e._nsMap;if(r){for(var i in r)if(r[i]==s)return i}e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(s){for(var e=this;e;){var r=e._nsMap;if(r&&s in r)return r[s];e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(s){var e=this.lookupPrefix(s);return e==null}};function _d(s){return s=="<"&&"&lt;"||s==">"&&"&gt;"||s=="&"&&"&amp;"||s=='"'&&"&quot;"||"&#"+s.charCodeAt()+";"}aa(ir,Yt);aa(ir,Yt.prototype);function sa(s,e){if(e(s))return!0;if(s=s.firstChild)do if(sa(s,e))return!0;while(s=s.nextSibling)}function oa(){}function Vy(s,e,r){s&&s._inc++;var i=r.namespaceURI;i===na.XMLNS&&(e._nsMap[r.prefix?r.localName:""]=r.value)}function xd(s,e,r,i){s&&s._inc++;var t=r.namespaceURI;t===na.XMLNS&&delete e._nsMap[r.prefix?r.localName:""]}function xl(s,e,r){if(s&&s._inc){s._inc++;var i=e.childNodes;if(r)i[i.length++]=r;else{for(var t=e.firstChild,n=0;t;)i[n++]=t,t=t.nextSibling;i.length=n}}}function bd(s,e){var r=e.previousSibling,i=e.nextSibling;return r?r.nextSibling=i:s.firstChild=i,i?i.previousSibling=r:s.lastChild=r,xl(s.ownerDocument,s),e}function Sd(s,e,r){var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===ai){var t=e.firstChild;if(t==null)return e;var n=e.lastChild}else t=n=e;var a=r?r.previousSibling:s.lastChild;t.previousSibling=a,n.nextSibling=r,a?a.nextSibling=t:s.firstChild=t,r==null?s.lastChild=n:r.previousSibling=n;do t.parentNode=s;while(t!==n&&(t=t.nextSibling));return xl(s.ownerDocument||s,s),e.nodeType==ai&&(e.firstChild=e.lastChild=null),e}function Ky(s,e){var r=e.parentNode;if(r){var i=s.lastChild;r.removeChild(e);var i=s.lastChild}var i=s.lastChild;return e.parentNode=s,e.previousSibling=i,e.nextSibling=null,i?i.nextSibling=e:s.firstChild=e,s.lastChild=e,xl(s.ownerDocument,s,e),e}oa.prototype={nodeName:"#document",nodeType:hd,doctype:null,documentElement:null,_inc:1,insertBefore:function(s,e){if(s.nodeType==ai){for(var r=s.firstChild;r;){var i=r.nextSibling;this.insertBefore(r,e),r=i}return s}return this.documentElement==null&&s.nodeType==Nr&&(this.documentElement=s),Sd(this,s,e),s.ownerDocument=this,s},removeChild:function(s){return this.documentElement==s&&(this.documentElement=null),bd(this,s)},importNode:function(s,e){return Id(this,s,e)},getElementById:function(s){var e=null;return sa(this.documentElement,function(r){if(r.nodeType==Nr&&r.getAttribute("id")==s)return e=r,!0}),e},getElementsByClassName:function(s){var e=ld(s);return new pn(this,function(r){var i=[];return e.length>0&&sa(r.documentElement,function(t){if(t!==r&&t.nodeType===Nr){var n=t.getAttribute("class");if(n){var a=s===n;if(!a){var o=ld(n);a=e.every(By(o))}a&&i.push(t)}}}),i})},createElement:function(s){var e=new Mi;e.ownerDocument=this,e.nodeName=s,e.tagName=s,e.localName=s,e.childNodes=new si;var r=e.attributes=new Ts;return r._ownerElement=e,e},createDocumentFragment:function(){var s=new Os;return s.ownerDocument=this,s.childNodes=new si,s},createTextNode:function(s){var e=new bl;return e.ownerDocument=this,e.appendData(s),e},createComment:function(s){var e=new Sl;return e.ownerDocument=this,e.appendData(s),e},createCDATASection:function(s){var e=new Tl;return e.ownerDocument=this,e.appendData(s),e},createProcessingInstruction:function(s,e){var r=new wl;return r.ownerDocument=this,r.tagName=r.target=s,r.nodeValue=r.data=e,r},createAttribute:function(s){var e=new As;return e.ownerDocument=this,e.name=s,e.nodeName=s,e.localName=s,e.specified=!0,e},createEntityReference:function(s){var e=new Al;return e.ownerDocument=this,e.nodeName=s,e},createElementNS:function(s,e){var r=new Mi,i=e.split(":"),t=r.attributes=new Ts;return r.childNodes=new si,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=s,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,t._ownerElement=r,r},createAttributeNS:function(s,e){var r=new As,i=e.split(":");return r.ownerDocument=this,r.nodeName=e,r.name=e,r.namespaceURI=s,r.specified=!0,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,r}};rr(oa,Yt);function Mi(){this._nsMap={}}Mi.prototype={nodeType:Nr,hasAttribute:function(s){return this.getAttributeNode(s)!=null},getAttribute:function(s){var e=this.getAttributeNode(s);return e&&e.value||""},getAttributeNode:function(s){return this.attributes.getNamedItem(s)},setAttribute:function(s,e){var r=this.ownerDocument.createAttribute(s);r.value=r.nodeValue=""+e,this.setAttributeNode(r)},removeAttribute:function(s){var e=this.getAttributeNode(s);e&&this.removeAttributeNode(e)},appendChild:function(s){return s.nodeType===ai?this.insertBefore(s,null):Ky(this,s)},setAttributeNode:function(s){return this.attributes.setNamedItem(s)},setAttributeNodeNS:function(s){return this.attributes.setNamedItemNS(s)},removeAttributeNode:function(s){return this.attributes.removeNamedItem(s.nodeName)},removeAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(s,e){return this.getAttributeNodeNS(s,e)!=null},getAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);return r&&r.value||""},setAttributeNS:function(s,e,r){var i=this.ownerDocument.createAttributeNS(s,e);i.value=i.nodeValue=""+r,this.setAttributeNode(i)},getAttributeNodeNS:function(s,e){return this.attributes.getNamedItemNS(s,e)},getElementsByTagName:function(s){return new pn(this,function(e){var r=[];return sa(e,function(i){i!==e&&i.nodeType==Nr&&(s==="*"||i.tagName==s)&&r.push(i)}),r})},getElementsByTagNameNS:function(s,e){return new pn(this,function(r){var i=[];return sa(r,function(t){t!==r&&t.nodeType===Nr&&(s==="*"||t.namespaceURI===s)&&(e==="*"||t.localName==e)&&i.push(t)}),i})}};oa.prototype.getElementsByTagName=Mi.prototype.getElementsByTagName;oa.prototype.getElementsByTagNameNS=Mi.prototype.getElementsByTagNameNS;rr(Mi,Yt);function As(){}As.prototype.nodeType=hn;rr(As,Yt);function la(){}la.prototype={data:"",substringData:function(s,e){return this.data.substring(s,s+e)},appendData:function(s){s=this.data+s,this.nodeValue=this.data=s,this.length=s.length},insertData:function(s,e){this.replaceData(s,0,e)},appendChild:function(s){throw new Error(kt[Wy])},deleteData:function(s,e){this.replaceData(s,e,"")},replaceData:function(s,e,r){var i=this.data.substring(0,s),t=this.data.substring(s+e);r=i+r+t,this.nodeValue=this.data=r,this.length=r.length}};rr(la,Yt);function bl(){}bl.prototype={nodeName:"#text",nodeType:Ss,splitText:function(s){var e=this.data,r=e.substring(s);e=e.substring(0,s),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};rr(bl,la);function Sl(){}Sl.prototype={nodeName:"#comment",nodeType:cd};rr(Sl,la);function Tl(){}Tl.prototype={nodeName:"#cdata-section",nodeType:ud};rr(Tl,la);function ws(){}ws.prototype.nodeType=pd;rr(ws,Yt);function Td(){}Td.prototype.nodeType=jy;rr(Td,Yt);function Ad(){}Ad.prototype.nodeType=Uy;rr(Ad,Yt);function Al(){}Al.prototype.nodeType=fd;rr(Al,Yt);function Os(){}Os.prototype.nodeName="#document-fragment";Os.prototype.nodeType=ai;rr(Os,Yt);function wl(){}wl.prototype.nodeType=dd;rr(wl,Yt);function wd(){}wd.prototype.serializeToString=function(s,e,r){return Od.call(s,e,r)};Yt.prototype.toString=Od;function Od(s,e){var r=[],i=this.nodeType==9&&this.documentElement||this,t=i.prefix,n=i.namespaceURI;if(n&&t==null){var t=i.lookupPrefix(n);if(t==null)var a=[{namespace:n,prefix:null}]}return vn(this,r,s,e,a),r.join("")}function Ld(s,e,r){var i=s.prefix||"",t=s.namespaceURI;if(!t||i==="xml"&&t===na.XML||t===na.XMLNS)return!1;for(var n=r.length;n--;){var a=r[n];if(a.prefix===i)return a.namespace!==t}return!0}function Ol(s,e,r){s.push(" ",e,'="',r.replace(/[<&"]/g,_d),'"')}function vn(s,e,r,i,t){if(t||(t=[]),i)if(s=i(s),s){if(typeof s=="string"){e.push(s);return}}else return;switch(s.nodeType){case Nr:var n=s.attributes,a=n.length,o=s.firstChild,l=s.tagName;r=na.isHTML(s.namespaceURI)||r;var h=l;if(!r&&!s.prefix&&s.namespaceURI){for(var p,u=0;u<n.length;u++)if(n.item(u).name==="xmlns"){p=n.item(u).value;break}if(!p)for(var f=t.length-1;f>=0;f--){var g=t[f];if(g.prefix===""&&g.namespace===s.namespaceURI){p=g.namespace;break}}if(p!==s.namespaceURI)for(var f=t.length-1;f>=0;f--){var g=t[f];if(g.namespace===s.namespaceURI){g.prefix&&(h=g.prefix+":"+l);break}}}e.push("<",h);for(var E=0;E<a;E++){var S=n.item(E);S.prefix=="xmlns"?t.push({prefix:S.localName,namespace:S.value}):S.nodeName=="xmlns"&&t.push({prefix:"",namespace:S.value})}for(var E=0;E<a;E++){var S=n.item(E);if(Ld(S,r,t)){var _=S.prefix||"",m=S.namespaceURI;Ol(e,_?"xmlns:"+_:"xmlns",m),t.push({prefix:_,namespace:m})}vn(S,e,r,i,t)}if(l===h&&Ld(s,r,t)){var _=s.prefix||"",m=s.namespaceURI;Ol(e,_?"xmlns:"+_:"xmlns",m),t.push({prefix:_,namespace:m})}if(o||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(e.push(">"),r&&/^script$/i.test(l))for(;o;)o.data?e.push(o.data):vn(o,e,r,i,t.slice()),o=o.nextSibling;else for(;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;e.push("</",h,">")}else e.push("/>");return;case hd:case ai:for(var o=s.firstChild;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;return;case hn:return Ol(e,s.name,s.value);case Ss:return e.push(s.data.replace(/[<&]/g,_d).replace(/]]>/g,"]]&gt;"));case ud:return e.push("<![CDATA[",s.data,"]]>");case cd:return e.push("<!--",s.data,"-->");case pd:var c=s.publicId,v=s.systemId;if(e.push("<!DOCTYPE ",s.name),c)e.push(" PUBLIC ",c),v&&v!="."&&e.push(" ",v),e.push(">");else if(v&&v!=".")e.push(" SYSTEM ",v,">");else{var y=s.internalSubset;y&&e.push(" [",y,"]"),e.push(">")}return;case dd:return e.push("<?",s.target," ",s.data,"?>");case fd:return e.push("&",s.nodeName,";");default:e.push("??",s.nodeName)}}function Id(s,e,r){var i;switch(e.nodeType){case Nr:i=e.cloneNode(!1),i.ownerDocument=s;case ai:break;case hn:r=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=s,i.parentNode=null,r)for(var t=e.firstChild;t;)i.appendChild(Id(s,t,r)),t=t.nextSibling;return i}function Ll(s,e,r){var i=new e.constructor;for(var t in e){var n=e[t];typeof n!="object"&&n!=i[t]&&(i[t]=n)}switch(e.childNodes&&(i.childNodes=new si),i.ownerDocument=s,i.nodeType){case Nr:var a=e.attributes,o=i.attributes=new Ts,l=a.length;o._ownerElement=i;for(var h=0;h<l;h++)i.setAttributeNode(Ll(s,a.item(h),!0));break;case hn:r=!0}if(r)for(var p=e.firstChild;p;)i.appendChild(Ll(s,p,r)),p=p.nextSibling;return i}function Rd(s,e,r){s[e]=r}try{if(Object.defineProperty){let s=function(e){switch(e.nodeType){case Nr:case ai:var r=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&r.push(s(e)),e=e.nextSibling;return r.join("");default:return e.nodeValue}};Object.defineProperty(pn.prototype,"length",{get:function(){return _l(this),this.$$length}}),Object.defineProperty(Yt.prototype,"textContent",{get:function(){return s(this)},set:function(e){switch(this.nodeType){case Nr:case ai:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Rd=function(e,r,i){e["$$"+r]=i}}}catch(s){}ni.DocumentType=ws;ni.DOMException=Pi;ni.DOMImplementation=Ed;ni.Element=Mi;ni.Node=Yt;ni.NodeList=si;ni.XMLSerializer=wd;var ua={},Dd={};(function(s){var e=Ci.freeze;s.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),s.HTML_ENTITIES=e({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),s.entityMap=s.HTML_ENTITIES})(Dd);var Il={},fa=Ci.NAMESPACE,Rl=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cd=new RegExp("[\\-\\.0-9"+Rl.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Pd=new RegExp("^"+Rl.source+Cd.source+"*(?::"+Rl.source+Cd.source+"*)?$"),da=0,Ei=1,gn=2,ca=3,mn=4,yn=5,ha=6,Ls=7;function En(s,e){this.message=s,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,En)}En.prototype=new Error;En.prototype.name=En.name;function Md(){}Md.prototype={parse:function(s,e,r){var i=this.domBuilder;i.startDocument(),Fd(e,e={}),Hy(s,e,r,i,this.errorHandler),i.endDocument()}};function Hy(s,e,r,i,t){function n(C){if(C>65535){C-=65536;var P=55296+(C>>10),M=56320+(C&1023);return String.fromCharCode(P,M)}else return String.fromCharCode(C)}function a(C){var P=C.slice(1,-1);return P in r?r[P]:P.charAt(0)==="#"?n(parseInt(P.substr(1).replace("x","0x"))):(t.error("entity not found:"+C),C)}function o(C){if(C>S){var P=s.substring(S,C).replace(/&#?\w+;/g,a);f&&l(S),i.characters(P,0,C-S),S=C}}function l(C,P){for(;C>=p&&(P=u.exec(s));)h=P.index,p=h+P[0].length,f.lineNumber++;f.columnNumber=C-h+1}for(var h=0,p=0,u=/.*(?:\r\n?|\n)|.*$/g,f=i.locator,g=[{currentNSMap:e}],E={},S=0;;){try{var _=s.indexOf("<",S);if(_<0){if(!s.substr(S).match(/^\s*$/)){var m=i.doc,c=m.createTextNode(s.substr(S));m.appendChild(c),i.currentElement=c}return}switch(_>S&&o(_),s.charAt(_+1)){case"/":var v=s.indexOf(">",_+3),y=s.substring(_+2,v).replace(/[ \t\n\r]+$/g,""),d=g.pop();v<0?(y=s.substring(_+2).replace(/[\s<].*/,""),t.error("end tag name: "+y+" is not complete:"+d.tagName),v=_+1+y.length):y.match(/\s</)&&(y=y.replace(/[\s<].*/,""),t.error("end tag name: "+y+" maybe not complete"),v=_+1+y.length);var x=d.localNSMap,b=d.tagName==y,T=b||d.tagName&&d.tagName.toLowerCase()==y.toLowerCase();if(T){if(i.endElement(d.uri,d.localName,y),x)for(var A in x)i.endPrefixMapping(A);b||t.fatalError("end tag name: "+y+" is not match the current start tagName:"+d.tagName)}else g.push(d);v++;break;case"?":f&&l(_),v=Zy(s,_,i);break;case"!":f&&l(_),v=Xy(s,_,i,t);break;default:f&&l(_);var L=new Bd,R=g[g.length-1].currentNSMap,v=$y(s,_,L,R,a,t),w=L.length;if(!L.closed&&Yy(s,v,L.tagName,E)&&(L.closed=!0,r.nbsp||t.warning("unclosed xml attribute")),f&&w){for(var O=kd(f,{}),I=0;I<w;I++){var D=L[I];l(D.offset),D.locator=kd(f,{})}i.locator=O,Nd(L,i,R)&&g.push(L),i.locator=f}else Nd(L,i,R)&&g.push(L);fa.isHTML(L.uri)&&!L.closed?v=Gy(s,v,L.tagName,a,i):v++}}catch(C){if(C instanceof En)throw C;t.error("element parse error: "+C),v=-1}v>S?S=v:o(Math.max(_,S)+1)}}function kd(s,e){return e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber,e}function $y(s,e,r,i,t,n){function a(f,g,E){r.attributeNames.hasOwnProperty(f)&&n.fatalError("Attribute "+f+" redefined"),r.addValue(f,g,E)}for(var o,l,h=++e,p=da;;){var u=s.charAt(h);switch(u){case"=":if(p===Ei)o=s.slice(e,h),p=ca;else if(p===gn)p=ca;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(p===ca||p===Ei)if(p===Ei&&(n.warning('attribute value must after "="'),o=s.slice(e,h)),e=h+1,h=s.indexOf(u,e),h>0)l=s.slice(e,h).replace(/&#?\w+;/g,t),a(o,l,e-1),p=yn;else throw new Error("attribute value no end '"+u+"' match");else if(p==mn)l=s.slice(e,h).replace(/&#?\w+;/g,t),a(o,l,e),n.warning('attribute "'+o+'" missed start quot('+u+")!!"),e=h+1,p=yn;else throw new Error('attribute value must after "="');break;case"/":switch(p){case da:r.setTagName(s.slice(e,h));case yn:case ha:case Ls:p=Ls,r.closed=!0;case mn:case Ei:case gn:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),p==da&&r.setTagName(s.slice(e,h)),h;case">":switch(p){case da:r.setTagName(s.slice(e,h));case yn:case ha:case Ls:break;case mn:case Ei:l=s.slice(e,h),l.slice(-1)==="/"&&(r.closed=!0,l=l.slice(0,-1));case gn:p===gn&&(l=o),p==mn?(n.warning('attribute "'+l+'" missed quot(")!'),a(o,l.replace(/&#?\w+;/g,t),e)):((!fa.isHTML(i[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,e));break;case ca:throw new Error("attribute value missed!!")}return h;case"\x80":u=" ";default:if(u<=" ")switch(p){case da:r.setTagName(s.slice(e,h)),p=ha;break;case Ei:o=s.slice(e,h),p=gn;break;case mn:var l=s.slice(e,h).replace(/&#?\w+;/g,t);n.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,e);case yn:p=ha;break}else switch(p){case gn:r.tagName,(!fa.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=h,p=Ei;break;case yn:n.warning('attribute space is required"'+o+'"!!');case ha:p=Ei,e=h;break;case ca:p=mn,e=h;break;case Ls:throw new Error("elements closed character '/' and '>' must be connected to")}}h++}}function Nd(s,e,r){for(var i=s.tagName,t=null,n=s.length;n--;){var a=s[n],o=a.qName,l=a.value,f=o.indexOf(":");if(f>0)var h=a.prefix=o.slice(0,f),p=o.slice(f+1),u=h==="xmlns"&&p;else p=o,h=null,u=o==="xmlns"&&"";a.localName=p,u!==!1&&(t==null&&(t={},Fd(r,r={})),r[u]=t[u]=l,a.uri=fa.XMLNS,e.startPrefixMapping(u,l))}for(var n=s.length;n--;){a=s[n];var h=a.prefix;h&&(h==="xml"&&(a.uri=fa.XML),h!=="xmlns"&&(a.uri=r[h||""]))}var f=i.indexOf(":");f>0?(h=s.prefix=i.slice(0,f),p=s.localName=i.slice(f+1)):(h=null,p=s.localName=i);var g=s.uri=r[h||""];if(e.startElement(g,p,i,s),s.closed){if(e.endElement(g,p,i),t)for(h in t)e.endPrefixMapping(h)}else return s.currentNSMap=r,s.localNSMap=t,!0}function Gy(s,e,r,i,t){if(/^(?:script|textarea)$/i.test(r)){var n=s.indexOf("</"+r+">",e),a=s.substring(e+1,n);if(/[&<]/.test(a))return/^script$/i.test(r)?(t.characters(a,0,a.length),n):(a=a.replace(/&#?\w+;/g,i),t.characters(a,0,a.length),n)}return e+1}function Yy(s,e,r,i){var t=i[r];return t==null&&(t=s.lastIndexOf("</"+r+">"),t<e&&(t=s.lastIndexOf("</"+r)),i[r]=t),t<e}function Fd(s,e){for(var r in s)e[r]=s[r]}function Xy(s,e,r,i){var t=s.charAt(e+2);switch(t){case"-":if(s.charAt(e+3)==="-"){var n=s.indexOf("-->",e+4);return n>e?(r.comment(s,e+4,n-e-4),n+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(s.substr(e+3,6)=="CDATA["){var n=s.indexOf("]]>",e+9);return r.startCDATA(),r.characters(s,e+9,n-e-9),r.endCDATA(),n+3}var a=Qy(s,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],h=!1,p=!1;o>3&&(/^public$/i.test(a[2][0])?(h=a[3][0],p=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(p=a[3][0]));var u=a[o-1];return r.startDTD(l,h,p),r.endDTD(),u.index+u[0].length}}return-1}function Zy(s,e,r){var i=s.indexOf("?>",e);if(i){var t=s.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return t?(t[0].length,r.processingInstruction(t[1],t[2]),i+2):-1}return-1}function Bd(){this.attributeNames={}}Bd.prototype={setTagName:function(s){if(!Pd.test(s))throw new Error("invalid tagName:"+s);this.tagName=s},addValue:function(s,e,r){if(!Pd.test(s))throw new Error("invalid attribute:"+s);this.attributeNames[s]=this.length,this[this.length++]={qName:s,value:e,offset:r}},length:0,getLocalName:function(s){return this[s].localName},getLocator:function(s){return this[s].locator},getQName:function(s){return this[s].qName},getURI:function(s){return this[s].uri},getValue:function(s){return this[s].value}};function Qy(s,e){var r,i=[],t=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(t.lastIndex=e,t.exec(s);r=t.exec(s);)if(i.push(r),r[1])return i}Il.XMLReader=Md;Il.ParseError=En;var Jy=Ci,Dl=ni,Ud=Dd,jd=Il,qy=Dl.DOMImplementation,Wd=Jy.NAMESPACE,eE=jd.ParseError,tE=jd.XMLReader;function zd(s){this.options=s||{locator:{}}}zd.prototype.parseFromString=function(s,e){var r=this.options,i=new tE,t=r.domBuilder||new pa,n=r.errorHandler,a=r.locator,o=r.xmlns||{},l=/\/x?html?$/.test(e),h=l?Ud.HTML_ENTITIES:Ud.XML_ENTITIES;return a&&t.setDocumentLocator(a),i.errorHandler=rE(n,t,a),i.domBuilder=r.domBuilder||t,l&&(o[""]=Wd.HTML),o.xml=o.xml||Wd.XML,s&&typeof s=="string"?i.parse(s,o,h):i.errorHandler.error("invalid doc source"),t.doc};function rE(s,e,r){if(!s){if(e instanceof pa)return e;s=e}var i={},t=s instanceof Function;r=r||{};function n(a){var o=s[a];!o&&t&&(o=s.length==2?function(l){s(a,l)}:s),i[a]=o&&function(l){o("[xmldom "+a+"]	"+l+Cl(r))}||function(){}}return n("warning"),n("error"),n("fatalError"),i}function pa(){this.cdata=!1}function _n(s,e){e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber}pa.prototype={startDocument:function(){this.doc=new qy().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(s,e,r,i){var t=this.doc,n=t.createElementNS(s,r||e),a=i.length;Is(this,n),this.currentElement=n,this.locator&&_n(this.locator,n);for(var o=0;o<a;o++){var s=i.getURI(o),l=i.getValue(o),r=i.getQName(o),h=t.createAttributeNS(s,r);this.locator&&_n(i.getLocator(o),h),h.value=h.nodeValue=l,n.setAttributeNode(h)}},endElement:function(s,e,r){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(s,e){},endPrefixMapping:function(s){},processingInstruction:function(s,e){var r=this.doc.createProcessingInstruction(s,e);this.locator&&_n(this.locator,r),Is(this,r)},ignorableWhitespace:function(s,e,r){},characters:function(s,e,r){if(s=Vd.apply(this,arguments),s){if(this.cdata)var i=this.doc.createCDATASection(s);else var i=this.doc.createTextNode(s);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(s)&&this.doc.appendChild(i),this.locator&&_n(this.locator,i)}},skippedEntity:function(s){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(s){(this.locator=s)&&(s.lineNumber=0)},comment:function(s,e,r){s=Vd.apply(this,arguments);var i=this.doc.createComment(s);this.locator&&_n(this.locator,i),Is(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(s,e,r){var i=this.doc.implementation;if(i&&i.createDocumentType){var t=i.createDocumentType(s,e,r);this.locator&&_n(this.locator,t),Is(this,t),this.doc.doctype=t}},warning:function(s){console.warn("[xmldom warning]	"+s,Cl(this.locator))},error:function(s){console.error("[xmldom error]	"+s,Cl(this.locator))},fatalError:function(s){throw new eE(s,this.locator)}};function Cl(s){if(s)return`
@`+(s.systemId||"")+"#[line:"+s.lineNumber+",col:"+s.columnNumber+"]"}function Vd(s,e,r){return typeof s=="string"?s.substr(e,r):s.length>=e+r||e?new java.lang.String(s,e,r)+"":s}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(s){pa.prototype[s]=function(){return null}});function Is(s,e){s.currentElement?s.currentElement.appendChild(e):s.doc.appendChild(e)}ua.__DOMHandler=pa;ua.DOMParser=zd;ua.DOMImplementation=Dl.DOMImplementation;ua.XMLSerializer=Dl.XMLSerializer;var Kd=ni;ia.DOMImplementation=Kd.DOMImplementation;ia.XMLSerializer=Kd.XMLSerializer;ia.DOMParser=ua.DOMParser;Object.defineProperty(Be,"__esModule",{value:!0});Be.RangeObject=void 0;Be.blob2base64=IE;Be.borders=vE;Be.bounds=pE;Be.createBase64Url=SE;Be.createBlob=Yd;Be.createBlobUrl=xE;Be.defaults=dE;Be.defer=RE;Be.documentHeight=oE;Be.extend=cE;Be.filterChildren=PE;Be.findChildren=CE;Be.getParentByTagName=ME;Be.indexOfElementNode=EE;Be.indexOfNode=Ml;Be.indexOfSorted=Pl;Be.indexOfTextNode=yE;Be.insert=hE;Be.isElement=lE;Be.isFloat=uE;Be.isNumber=Gd;Be.isXml=_E;Be.locationOf=Rs;Be.nodeBounds=gE;Be.parents=Nl;Be.parse=AE;Be.prefixed=fE;Be.qs=wE;Be.qsa=Xd;Be.qsp=OE;Be.querySelectorByType=DE;Be.requestAnimationFrame=void 0;Be.revokeBlobUrl=bE;Be.sprint=LE;Be.treeWalker=Zd;Be.type=TE;Be.uuid=$d;Be.walk=kl;Be.windowBounds=mE;var iE=ia;const nE=typeof window!="undefined"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;Be.requestAnimationFrame=nE;const aE=1,sE=3,Hd=typeof URL!="undefined"?URL:typeof window!="undefined"?window.URL||window.webkitURL||window.mozURL:void 0;function $d(){var s=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var i=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(r=="x"?i:i&7|8).toString(16)});return e}function oE(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function lE(s){return!!(s&&s.nodeType==1)}function Gd(s){return!isNaN(parseFloat(s))&&isFinite(s)}function uE(s){let e=parseFloat(s);return Gd(s)===!1?!1:typeof s=="string"&&s.indexOf(".")>-1?!0:Math.floor(e)!==e}function fE(s){var e=["Webkit","webkit","Moz","O","ms"],r=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=s.toLowerCase(),t=e.length;if(typeof document=="undefined"||typeof document.body.style[i]!="undefined")return s;for(var n=0;n<t;n++)if(typeof document.body.style[r[n]+i]!="undefined")return r[n]+i;return s}function dE(s){for(var e=1,r=arguments.length;e<r;e++){var i=arguments[e];for(var t in i)s[t]===void 0&&(s[t]=i[t])}return s}function cE(s){var e=[].slice.call(arguments,1);return e.forEach(function(r){!r||Object.getOwnPropertyNames(r).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}),s}function hE(s,e,r){var i=Rs(s,e,r);return e.splice(i,0,s),i}function Rs(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),l;return r||(r=function(h,p){if(h>p)return 1;if(h<p)return-1;if(h==p)return 0}),a-n<=0?o:(l=r(e[o],s),a-n==1?l>=0?o:o+1:l===0?o:l===-1?Rs(s,e,r,o,a):Rs(s,e,r,n,o))}function Pl(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),l;return r||(r=function(h,p){if(h>p)return 1;if(h<p)return-1;if(h==p)return 0}),a-n<=0?-1:(l=r(e[o],s),a-n==1?l===0?o:-1:l===0?o:l===-1?Pl(s,e,r,o,a):Pl(s,e,r,n,o))}function pE(s){var e=window.getComputedStyle(s),r=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function vE(s){var e=window.getComputedStyle(s),r=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function gE(s){let e,r=s.ownerDocument;if(s.nodeType==Node.TEXT_NODE){let i=r.createRange();i.selectNodeContents(s),e=i.getBoundingClientRect()}else e=s.getBoundingClientRect();return e}function mE(){var s=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:s,bottom:e,width:s,height:e}}function Ml(s,e){for(var r=s.parentNode,i=r.childNodes,t,n=-1,a=0;a<i.length&&(t=i[a],t.nodeType===e&&n++,t!=s);a++);return n}function yE(s){return Ml(s,sE)}function EE(s){return Ml(s,aE)}function _E(s){return["xml","opf","ncx"].indexOf(s)>-1}function Yd(s,e){return new Blob([s],{type:e})}function xE(s,e){var r,i=Yd(s,e);return r=Hd.createObjectURL(i),r}function bE(s){return Hd.revokeObjectURL(s)}function SE(s,e){var r,i;if(typeof s=="string")return r=btoa(s),i="data:"+e+";base64,"+r,i}function TE(s){return Object.prototype.toString.call(s).slice(8,-1)}function AE(s,e,r){var i,t;return typeof DOMParser=="undefined"||r?t=iE.DOMParser:t=DOMParser,s.charCodeAt(0)===65279&&(s=s.slice(1)),i=new t().parseFromString(s,e),i}function wE(s,e){var r;if(!s)throw new Error("No Element Provided");if(typeof s.querySelector!="undefined")return s.querySelector(e);if(r=s.getElementsByTagName(e),r.length)return r[0]}function Xd(s,e){return typeof s.querySelector!="undefined"?s.querySelectorAll(e):s.getElementsByTagName(e)}function OE(s,e,r){var i,t;if(typeof s.querySelector!="undefined"){e+="[";for(var n in r)e+=n+"~='"+r[n]+"'";return e+="]",s.querySelector(e)}else if(i=s.getElementsByTagName(e),t=Array.prototype.slice.call(i,0).filter(function(a){for(var o in r)if(a.getAttribute(o)===r[o])return!0;return!1}),t)return t[0]}function LE(s,e){var r=s.ownerDocument||s;typeof r.createTreeWalker!="undefined"?Zd(s,e,NodeFilter.SHOW_TEXT):kl(s,function(i){i&&i.nodeType===3&&e(i)})}function Zd(s,e,r){var i=document.createTreeWalker(s,r,null,!1);let t;for(;t=i.nextNode();)e(t)}function kl(s,e){if(e(s))return!0;if(s=s.firstChild,s)do{if(kl(s,e))return!0;s=s.nextSibling}while(s)}function IE(s){return new Promise(function(e,r){var i=new FileReader;i.readAsDataURL(s),i.onloadend=function(){e(i.result)}})}function RE(){this.resolve=null,this.reject=null,this.id=$d(),this.promise=new Promise((s,e)=>{this.resolve=s,this.reject=e}),Object.freeze(this)}function DE(s,e,r){var i;if(typeof s.querySelector!="undefined"&&(i=s.querySelector(`${e}[*|type="${r}"]`)),!i||i.length===0){i=Xd(s,e);for(var t=0;t<i.length;t++)if(i[t].getAttributeNS("http://www.idpf.org/2007/ops","type")===r||i[t].getAttribute("epub:type")===r)return i[t]}else return i}function CE(s){for(var e=[],r=s.childNodes,i=0;i<r.length;i++){let t=r[i];t.nodeType===1&&e.push(t)}return e}function Nl(s){for(var e=[s];s;s=s.parentNode)e.unshift(s);return e}function PE(s,e,r){for(var i=[],t=s.childNodes,n=0;n<t.length;n++){let a=t[n];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(r)return a;i.push(a)}}if(!r)return i}function ME(s,e){let r;if(!(s===null||e===""))for(r=s.parentNode;r.nodeType===1;){if(r.tagName.toLowerCase()===e)return r;r=r.parentNode}}class kE{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,r){this.startContainer=e,this.startOffset=r,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,r){this.endContainer=e,this.endOffset=r,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let r=e.parentNode,i=Array.prototype.indexOf.call(r.childNodes,e);this.setStart(r,i),this.setEnd(r,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let r=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,r)}_commonAncestorContainer(e,r){var i=Nl(e||this.startContainer),t=Nl(r||this.endContainer);if(i[0]==t[0]){for(var n=0;n<i.length;n++)if(i[n]!=t[n])return i[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}Be.RangeObject=kE;var ki={},Qr={};if(!Qd)var Qd={cwd:function(){return"/"}};function Jr(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+s)}function Jd(s,e){for(var r="",i=-1,t=0,n,a=0;a<=s.length;++a){if(a<s.length)n=s.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(i===a-1||t===1))if(i!==a-1&&t===2){if(r.length<2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){for(var o=r.length-1,l=o;l>=0&&r.charCodeAt(l)!==47;--l);if(l!==o){l===-1?r="":r=r.slice(0,l),i=a,t=0;continue}}else if(r.length===2||r.length===1){r="",i=a,t=0;continue}}e&&(r.length>0?r+="/..":r="..")}else r.length>0?r+="/"+s.slice(i+1,a):r=s.slice(i+1,a);i=a,t=0}else n===46&&t!==-1?++t:t=-1}return r}function NE(s,e){var r=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+i:r+s+i:i}var Ds={resolve:function(){for(var e="",r=!1,i,t=arguments.length-1;t>=-1&&!r;t--){var n;t>=0?n=arguments[t]:(i===void 0&&(i=Qd.cwd()),n=i),Jr(n),n.length!==0&&(e=n+"/"+e,r=n.charCodeAt(0)===47)}return e=Jd(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Jr(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=Jd(e,!r),e.length===0&&!r&&(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return Jr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var i=arguments[r];Jr(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Ds.normalize(e)},relative:function(e,r){if(Jr(e),Jr(r),e===r||(e=Ds.resolve(e),r=Ds.resolve(r),e===r))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var t=e.length,n=t-i,a=1;a<r.length&&r.charCodeAt(a)===47;++a);for(var o=r.length,l=o-a,h=n<l?n:l,p=-1,u=0;u<=h;++u){if(u===h){if(l>h){if(r.charCodeAt(a+u)===47)return r.slice(a+u+1);if(u===0)return r.slice(a+u)}else n>h&&(e.charCodeAt(i+u)===47?p=u:u===0&&(p=0));break}var f=e.charCodeAt(i+u),g=r.charCodeAt(a+u);if(f!==g)break;f===47&&(p=u)}var E="";for(u=i+p+1;u<=t;++u)(u===t||e.charCodeAt(u)===47)&&(E.length===0?E+="..":E+="/..");return E.length>0?E+r.slice(a+p):(a+=p,r.charCodeAt(a)===47&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Jr(e),e.length===0)return".";for(var r=e.charCodeAt(0),i=r===47,t=-1,n=!0,a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!n){t=a;break}}else n=!1;return t===-1?i?"/":".":i&&t===1?"//":e.slice(0,t)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');Jr(e);var i=0,t=-1,n=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var o=r.length-1,l=-1;for(a=e.length-1;a>=0;--a){var h=e.charCodeAt(a);if(h===47){if(!n){i=a+1;break}}else l===-1&&(n=!1,l=a+1),o>=0&&(h===r.charCodeAt(o)?--o==-1&&(t=a):(o=-1,t=l))}return i===t?t=l:t===-1&&(t=e.length),e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!n){i=a+1;break}}else t===-1&&(n=!1,t=a+1);return t===-1?"":e.slice(i,t)}},extname:function(e){Jr(e);for(var r=-1,i=0,t=-1,n=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!n){i=o+1;break}continue}t===-1&&(n=!1,t=o+1),l===46?r===-1?r=o:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1?"":e.slice(r,t)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return NE("/",e)},parse:function(e){Jr(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,n;t?(r.root="/",n=1):n=0;for(var a=-1,o=0,l=-1,h=!0,p=e.length-1,u=0;p>=n;--p){if(i=e.charCodeAt(p),i===47){if(!h){o=p+1;break}continue}l===-1&&(h=!1,l=p+1),i===46?a===-1?a=p:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?l!==-1&&(o===0&&t?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(o,l)):(o===0&&t?(r.name=e.slice(1,a),r.base=e.slice(1,l)):(r.name=e.slice(o,a),r.base=e.slice(o,l)),r.ext=e.slice(a,l)),o>0?r.dir=e.slice(0,o-1):t&&(r.dir="/"),r},sep:"/",delimiter:":",posix:null},Cs=Ds;Object.defineProperty(Qr,"__esModule",{value:!0});Qr.default=void 0;var Ps=FE(Cs);function FE(s){return s&&s.__esModule?s:{default:s}}class BE{constructor(e){var r,i;r=e.indexOf("://"),r>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return Ps.default.parse(e)}isAbsolute(e){return Ps.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Ps.default.resolve(this.directory,e)}relative(e){var r=e&&e.indexOf("://")>-1;return r?e:Ps.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var UE=BE;Qr.default=UE;Object.defineProperty(ki,"__esModule",{value:!0});ki.default=void 0;var qd=tc(Qr),ec=tc(Cs);function tc(s){return s&&s.__esModule?s:{default:s}}class jE{constructor(e,r){var i=e.indexOf("://")>-1,t=e,n;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=r,!i&&r!==!1&&typeof r!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,t=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(a){this.Url=void 0,this.base&&(n=new qd.default(this.base),t=n.resolve(t))}this.Path=new qd.default(t),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var r=e.indexOf("://")>-1,i;return r?e:(i=ec.default.resolve(this.directory,e),this.origin+i)}relative(e){return ec.default.relative(e,this.directory)}toString(){return this.href}}var WE=jE;ki.default=WE;var Ms={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.default=void 0;var _i=Be;const xn=1,wr=3,zE=9;class Ni{constructor(e,r,i){var t;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Ni))return new Ni(e,r,i);if(typeof r=="string"?this.base=this.parseComponent(r):typeof r=="object"&&r.steps&&(this.base=r),t=this.checkType(e),t==="string")return this.str=e,(0,_i.extend)(this,this.parse(e));if(t==="range")return(0,_i.extend)(this,this.fromRange(e,this.base,i));if(t==="node")return(0,_i.extend)(this,this.fromNode(e,this.base,i));if(t==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,_i.type)(e)==="Range"||typeof e.startContainer!="undefined")?"range":e&&typeof e=="object"&&typeof e.nodeType!="undefined"?"node":e&&typeof e=="object"&&e instanceof Ni?"EpubCFI":!1}parse(e){var r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,t,n;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(r.base=this.parseComponent(i),t=this.getPathComponent(e),r.path=this.parseComponent(t),n=this.getRange(e),n&&(r.range=!0,r.start=this.parseComponent(n[0]),r.end=this.parseComponent(n[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}parseComponent(e){var r={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),t=i[0].split("/"),n;return i.length>1&&(n=i[1],r.terminal=this.parseTerminal(n)),t[0]===""&&t.shift(),r.steps=t.map(function(a){return this.parseStep(a)}.bind(this)),r}parseStep(e){var r,i,t,n,a;if(n=e.match(/\[(.*)\]/),n&&n[1]&&(a=n[1]),i=parseInt(e),!isNaN(i))return i%2==0?(r="element",t=i/2-1):(r="text",t=(i-1)/2),{type:r,index:t,id:a||null}}parseTerminal(e){var r,i,t=e.match(/\[(.*)\]/);return t&&t[1]?(r=parseInt(e.split("[")[0]),i=t[1]):r=parseInt(e),(0,_i.isNumber)(r)||(r=null),{offset:r,assertion:i}}getChapterComponent(e){var r=e.split("!");return r[0]}getPathComponent(e){var r=e.split("!");if(r[1])return r[1].split(",")[0]}getRange(e){var r=e.split(",");return r.length===3?[r[1],r[2]]:!1}getCharecterOffsetComponent(e){var r=e.split(":");return r[1]||""}joinSteps(e){return e?e.map(function(r){var i="";return r.type==="element"&&(i+=(r.index+1)*2),r.type==="text"&&(i+=1+2*r.index),r.id&&(i+="["+r.id+"]"),i}).join("/"):""}segmentString(e){var r="/";return r+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(r+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(r+="["+e.terminal.assertion+"]"),r}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,r){var i,t,n,a;if(typeof e=="string"&&(e=new Ni(e)),typeof r=="string"&&(r=new Ni(r)),e.spinePos>r.spinePos)return 1;if(e.spinePos<r.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),n=e.start.terminal):(i=e.path.steps,n=e.path.terminal),r.range?(t=r.path.steps.concat(r.start.steps),a=r.start.terminal):(t=r.path.steps,a=r.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!t[o]||i[o].index>t[o].index)return 1;if(i[o].index<t[o].index)return-1}return i.length<t.length?-1:n.offset>a.offset?1:n.offset<a.offset?-1:0}step(e){var r=e.nodeType===wr?"text":"element";return{id:e.id,tagName:e.tagName,type:r,index:this.position(e)}}filteredStep(e,r){var i=this.filter(e,r),t;if(!!i)return t=i.nodeType===wr?"text":"element",{id:i.id,tagName:i.tagName,type:t,index:this.filteredPosition(i,r)}}pathTo(e,r,i){for(var t={steps:[],terminal:{offset:null,assertion:null}},n=e,a;n&&n.parentNode&&n.parentNode.nodeType!=zE;)i?a=this.filteredStep(n,i):a=this.step(n),a&&t.steps.unshift(a),n=n.parentNode;return r!=null&&r>=0&&(t.terminal.offset=r,t.steps[t.steps.length-1].type!="text"&&t.steps.push({type:"text",index:0})),t}equalStep(e,r){return!e||!r?!1:e.index===r.index&&e.id===r.id&&e.type===r.type}fromRange(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null},n=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,h=!1;if(i&&(h=n.ownerDocument.querySelector("."+i)!=null),typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),e.collapsed)h&&(o=this.patchOffset(n,o,i)),t.path=this.pathTo(n,o,i);else{t.range=!0,h&&(o=this.patchOffset(n,o,i)),t.start=this.pathTo(n,o,i),h&&(l=this.patchOffset(a,l,i)),t.end=this.pathTo(a,l,i),t.path={steps:[],terminal:null};var p=t.start.steps.length,u;for(u=0;u<p&&this.equalStep(t.start.steps[u],t.end.steps[u]);u++)u===p-1?t.start.terminal===t.end.terminal&&(t.path.steps.push(t.start.steps[u]),t.range=!1):t.path.steps.push(t.start.steps[u]);t.start.steps=t.start.steps.slice(t.path.steps.length),t.end.steps=t.end.steps.slice(t.path.steps.length)}return t}fromNode(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null};return typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),t.path=this.pathTo(e,null,i),t}filter(e,r){var i,t,n,a,o,l=!1;return e.nodeType===wr?(l=!0,n=e.parentNode,i=e.parentNode.classList.contains(r)):(l=!1,i=e.classList.contains(r)),i&&l?(a=n.previousSibling,o=n.nextSibling,a&&a.nodeType===wr?t=a:o&&o.nodeType===wr&&(t=o),t||e):i&&!l?!1:e}patchOffset(e,r,i){if(e.nodeType!=wr)throw new Error("Anchor must be a text node");var t=e,n=r;for(e.parentNode.classList.contains(i)&&(t=e.parentNode);t.previousSibling;){if(t.previousSibling.nodeType===xn)if(t.previousSibling.classList.contains(i))n+=t.previousSibling.textContent.length;else break;else n+=t.previousSibling.textContent.length;t=t.previousSibling}return n}normalizedMap(e,r,i){var t={},n=-1,a,o=e.length,l,h;for(a=0;a<o;a++)l=e[a].nodeType,l===xn&&e[a].classList.contains(i)&&(l=wr),a>0&&l===wr&&h===wr?t[a]=n:r===l&&(n=n+1,t[a]=n),h=l;return t}position(e){var r,i;return e.nodeType===xn?(r=e.parentNode.children,r||(r=(0,_i.findChildren)(e.parentNode)),i=Array.prototype.indexOf.call(r,e)):(r=this.textNodes(e.parentNode),i=r.indexOf(e)),i}filteredPosition(e,r){var i,t,n;return e.nodeType===xn?(i=e.parentNode.children,n=this.normalizedMap(i,xn,r)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(r)&&(e=e.parentNode,i=e.parentNode.childNodes),n=this.normalizedMap(i,wr,r)),t=Array.prototype.indexOf.call(i,e),n[t]}stepsToXpath(e){var r=[".","*"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("*[position()="+t+" and @id='"+i.id+"']"):i.type==="text"?r.push("text()["+t+"]"):r.push("*["+t+"]")}),r.join("/")}stepsToQuerySelector(e){var r=["html"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("#"+i.id):i.type==="text"||r.push("*:nth-child("+t+")")}),r.join(">")}textNodes(e,r){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===wr?!0:!!(r&&i.classList.contains(r))})}walkToNode(e,r,i){var t=r||document,n=t.documentElement,a,o,l=e.length,h;for(h=0;h<l&&(o=e[h],o.type==="element"?o.id?n=t.getElementById(o.id):(a=n.children||(0,_i.findChildren)(n),n=a[o.index]):o.type==="text"&&(n=this.textNodes(n,i)[o.index]),!!n);h++);return n}findNode(e,r,i){var t=r||document,n,a;return!i&&typeof t.evaluate!="undefined"?(a=this.stepsToXpath(e),n=t.evaluate(a,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?n=this.walkToNode(e,t,i):n=this.walkToNode(e,t),n}fixMiss(e,r,i,t){var n=this.findNode(e.slice(0,-1),i,t),a=n.childNodes,o=this.normalizedMap(a,wr,t),l,h,p=e[e.length-1].index;for(let u in o){if(!o.hasOwnProperty(u))return;if(o[u]===p)if(l=a[u],h=l.textContent.length,r>h)r=r-h;else{l.nodeType===xn?n=l.childNodes[0]:n=l;break}}return{container:n,offset:r}}toRange(e,r){var i=e||document,t,n,a,o,l,h=this,p,u,f=r?i.querySelector("."+r)!=null:!1,g;if(typeof i.createRange!="undefined"?t=i.createRange():t=new _i.RangeObject,h.range?(n=h.start,p=h.path.steps.concat(n.steps),o=this.findNode(p,i,f?r:null),a=h.end,u=h.path.steps.concat(a.steps),l=this.findNode(u,i,f?r:null)):(n=h.path,p=h.path.steps,o=this.findNode(h.path.steps,i,f?r:null)),o)try{n.terminal.offset!=null?t.setStart(o,n.terminal.offset):t.setStart(o,0)}catch(E){g=this.fixMiss(p,n.terminal.offset,i,f?r:null),t.setStart(g.container,g.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?t.setEnd(l,a.terminal.offset):t.setEnd(l,0)}catch(E){g=this.fixMiss(u,h.end.terminal.offset,i,f?r:null),t.setEnd(g.container,g.offset)}return t}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,r,i){var t=parseInt(r),n=(e+1)*2,a="/"+n+"/";return a+=(t+1)*2,i&&(a+="["+i+"]"),a}collapse(e){!this.range||(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var VE=Ni;Qt.default=VE;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.default=void 0;class KE{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var r=0;r<arguments[e].length;++r)this.hooks.push(arguments[e][r])}deregister(e){let r;for(let i=0;i<this.hooks.length;i++)if(r=this.hooks[i],r===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,r=this.context,i=[];return this.hooks.forEach(function(t){try{var n=t.apply(r,e)}catch(a){console.log(a)}n&&typeof n.then=="function"&&i.push(n)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}var HE=KE;bn.default=HE;var ks={},qr={};Object.defineProperty(qr,"__esModule",{value:!0});qr.replaceBase=GE;qr.replaceCanonical=YE;qr.replaceLinks=ZE;qr.replaceMeta=XE;qr.substitute=QE;var Fi=Be,$E=rc(ki);rc(Qr);function rc(s){return s&&s.__esModule?s:{default:s}}function GE(s,e){var r,i,t=e.url,n=t.indexOf("://")>-1;!s||(i=(0,Fi.qs)(s,"head"),r=(0,Fi.qs)(i,"base"),r||(r=s.createElement("base"),i.insertBefore(r,i.firstChild)),!n&&window&&window.location&&(t=window.location.origin+t),r.setAttribute("href",t))}function YE(s,e){var r,i,t=e.canonical;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[rel='canonical']"),i?i.setAttribute("href",t):(i=s.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",t),r.appendChild(i)))}function XE(s,e){var r,i,t=e.idref;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[property='dc.identifier']"),i?i.setAttribute("content",t):(i=s.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",t),r.appendChild(i)))}function ZE(s,e){var r=s.querySelectorAll("a[href]");if(!!r.length)for(var i=(0,Fi.qs)(s.ownerDocument,"base"),t=i?i.getAttribute("href"):void 0,n=function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var h=l.indexOf("://")>-1;if(h)o.setAttribute("target","_blank");else{var p;try{p=new $E.default(l,t)}catch(u){}o.onclick=function(){return p&&p.hash?e(p.Path.path+p.hash):e(p?p.Path.path:l),!1}}}}.bind(this),a=0;a<r.length;a++)n(r[a])}function QE(s,e,r){return e.forEach(function(i,t){i&&r[t]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),s=s.replace(new RegExp(i,"g"),r[t]))}),s}var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.default=void 0;var Sn=Be,JE=qE(Qr);function qE(s){return s&&s.__esModule?s:{default:s}}function e_(s,e,r,i){var t=typeof window!="undefined"?window.URL:!1,n=t?"blob":"arraybuffer",a=new Sn.defer,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,h;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),r&&(o.withCredentials=!0),o.onreadystatechange=u,o.onerror=p,o.open("GET",s,!0);for(h in i)o.setRequestHeader(h,i[h]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new JE.default(s).extension),e=="blob"&&(o.responseType=n),(0,Sn.isXml)(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function p(f){a.reject(f)}function u(){if(this.readyState===XMLHttpRequest.DONE){var f=!1;if((this.responseType===""||this.responseType==="document")&&(f=this.responseXML),this.status===200||this.status===0||f){var g;if(!this.response&&!f)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;f?g=this.responseXML:(0,Sn.isXml)(e)?g=(0,Sn.parse)(this.response,"text/xml"):e=="xhtml"?g=(0,Sn.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?g=(0,Sn.parse)(this.response,"text/html"):e=="json"?g=JSON.parse(this.response):e=="blob"?t?g=this.response:g=new Blob([this.response]):g=this.response,a.resolve(g)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}var t_=e_;Bi.default=t_;Object.defineProperty(ks,"__esModule",{value:!0});ks.default=void 0;var Fl=Be,ic=Bl(Qt),nc=Bl(bn),r_=qr,i_=Bl(Bi),n_=ia;function Bl(s){return s&&s.__esModule?s:{default:s}}class a_{constructor(e,r){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,r?this.hooks=r:(this.hooks={},this.hooks.serialize=new nc.default(this),this.hooks.content=new nc.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var r=e||this.request||i_.default,i=new Fl.defer,t=i.promise;return this.contents?i.resolve(this.contents):r(this.url).then(function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){i.resolve(this.contents)}.bind(this)).catch(function(n){i.reject(n)}),t}base(){return(0,r_.replaceBase)(this.document,this)}render(e){var r=new Fl.defer,i=r.promise;return this.output,this.load(e).then(function(t){var n=typeof navigator!="undefined"&&navigator.userAgent||"",a=n.indexOf("Trident")>=0,o;typeof XMLSerializer=="undefined"||a?o=n_.DOMParser:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){r.resolve(this.output)}.bind(this)).catch(function(t){r.reject(t)}),i}find(e){var r=this,i=[],t=e.toLowerCase(),n=function(a){for(var o=a.textContent.toLowerCase(),l=r.document.createRange(),h,p,u=-1,f,g=150;p!=-1;)p=o.indexOf(t,u+1),p!=-1&&(l=r.document.createRange(),l.setStart(a,p),l.setEnd(a,p+t.length),h=r.cfiFromRange(l),a.textContent.length<g?f=a.textContent:(f=a.textContent.substring(p-g/2,p+g/2),f="..."+f+"..."),i.push({cfi:h,excerpt:f})),u=p};return(0,Fl.sprint)(r.document,function(a){n(a)}),i}search(e,r=5){if(typeof document.createTreeWalker=="undefined")return this.find(e);let i=[];const t=150,n=this,a=e.toLowerCase(),o=function(u){const E=u.reduce((S,_)=>S+_.textContent,"").toLowerCase().indexOf(a);if(E!=-1){const S=0,_=E+a.length;let m=0,c=0;if(E<u[S].length){let v;for(;m<u.length-1&&(c+=u[m].length,!(_<=c));)m+=1;let y=u[S],d=u[m],x=n.document.createRange();x.setStart(y,E);let b=u.slice(0,m).reduce((A,L)=>A+L.textContent.length,0);x.setEnd(d,b>_?_:_-b),v=n.cfiFromRange(x);let T=u.slice(0,m+1).reduce((A,L)=>A+L.textContent,"");T.length>t&&(T=T.substring(E-t/2,E+t/2),T="..."+T+"..."),i.push({cfi:v,excerpt:T})}}},l=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let h,p=[];for(;h=l.nextNode();)p.push(h),p.length==r&&(o(p.slice(0,r)),p=p.slice(1,r));return p.length>0&&o(p),i}reconcileLayoutSettings(e){var r={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var t=i.replace("rendition:",""),n=t.indexOf("-"),a,o;n!=-1&&(a=t.slice(0,n),o=t.slice(n+1),r[a]=o)}),r}cfiFromRange(e){return new ic.default(e,this.cfiBase).toString()}cfiFromElement(e){return new ic.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var s_=a_;ks.default=s_;Object.defineProperty(Ms,"__esModule",{value:!0});Ms.default=void 0;var ac=jl(Qt),sc=jl(bn),o_=jl(ks),Ul=qr;function jl(s){return s&&s.__esModule?s:{default:s}}class l_{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new sc.default,this.hooks.content=new sc.default,this.hooks.content.register(Ul.replaceBase),this.hooks.content.register(Ul.replaceCanonical),this.hooks.content.register(Ul.replaceMeta),this.epubcfi=new ac.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,r,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((t,n)=>{var a=this.manifest[t.idref],o;t.index=n,t.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,t.index,t.id),t.href&&(t.url=r(t.href,!0),t.canonical=i(t.href)),a&&(t.href=a.href,t.url=r(t.href,!0),t.canonical=i(t.href),a.properties.length&&t.properties.push.apply(t.properties,a.properties)),t.linear==="yes"?(t.prev=function(){let l=t.index;for(;l>0;){let h=this.get(l-1);if(h&&h.linear)return h;l-=1}}.bind(this),t.next=function(){let l=t.index;for(;l<this.spineItems.length-1;){let h=this.get(l+1);if(h&&h.linear)return h;l+=1}}.bind(this)):(t.prev=function(){},t.next=function(){}),o=new o_.default(t,this.hooks),this.append(o)}),this.loaded=!0}get(e){var r=0;if(typeof e=="undefined")for(;r<this.spineItems.length;){let i=this.spineItems[r];if(i&&i.linear)break;r+=1}else this.epubcfi.isCfiString(e)?r=new ac.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?r=e:typeof e=="string"&&e.indexOf("#")===0?r=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],r=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[r]||null}append(e){var r=this.spineItems.length;return e.index=r,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=r,this.spineByHref[encodeURI(e.href)]=r,this.spineByHref[e.href]=r,this.spineById[e.idref]=r,r}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(r,i){r.index=i}),0}remove(e){var r=this.spineItems.indexOf(e);if(r>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(r,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let r=this.get(e);if(r&&r.linear)return r;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let r=this.get(e);if(r&&r.linear)return r;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var u_=l_;Ms.default=u_;var Ns={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.default=xi.Task=void 0;var Fs=Be;class f_{constructor(e){this._q=[],this.context=e,this.tick=Fs.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,r,i,t=[].shift.call(arguments),n=arguments;if(!t)throw new Error("No Task Provided");return typeof t=="function"?(e=new Fs.defer,r=e.promise,i={task:t,args:n,deferred:e,promise:r}):i={promise:t},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,r,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),r=e.task,r)return i=r.apply(this.context,e.args),i&&typeof i.then=="function"?i.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Fs.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Fs.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class d_{constructor(e,r,i){return function(){var t=arguments||[];return new Promise((n,a)=>{var o=function(l,h){!l&&h?a(h):n(l)};t.push(o),e.apply(i||this,t)})}}}xi.Task=d_;var c_=f_;xi.default=c_;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.EVENTS=Nt.EPUBJS_VERSION=Nt.DOM_EVENTS=void 0;const h_="0.3";Nt.EPUBJS_VERSION=h_;const p_=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];Nt.DOM_EVENTS=p_;const v_={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};Nt.EVENTS=v_;Object.defineProperty(Ns,"__esModule",{value:!0});Ns.default=void 0;var Ui=Be,g_=Wl(xi),bi=Wl(Qt),m_=Nt,y_=Wl(Ar.exports);function Wl(s){return s&&s.__esModule?s:{default:s}}class oc{constructor(e,r,i){this.spine=e,this.request=r,this.pause=i||100,this.q=new g_.default(this),this.epubcfi=new bi.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(r){r.linear&&this.q.enqueue(this.process.bind(this),r)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(r){var i=new Ui.defer,t=this.parse(r,e.cfiBase);return this._locations=this._locations.concat(t),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(t),this.pause),i.promise}.bind(this))}parse(e,r,i){var t=[],n,a=e.ownerDocument,o=(0,Ui.qs)(a,"body"),l=0,h,p=i||this.break,u=function(f){var g=f.length,E,S=0;if(f.textContent.trim().length===0)return!1;for(l==0&&(n=this.createRange(),n.startContainer=f,n.startOffset=0),E=p-l,E>g&&(l+=g,S=g);S<g;)if(E=p-l,l===0&&(S+=1,n=this.createRange(),n.startContainer=f,n.startOffset=S),S+E>=g)l+=g-S,S=g;else{S+=E,n.endContainer=f,n.endOffset=S;let _=new bi.default(n,r).toString();t.push(_),l=0}h=f};if((0,Ui.sprint)(o,u.bind(this)),n&&n.startContainer&&h){n.endContainer=h,n.endOffset=h.length;let f=new bi.default(n,r).toString();t.push(f),l=0}return t}generateFromWords(e,r,i){var t=e?new bi.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(n){n.linear&&(t?n.index>=t.spinePos&&this.q.enqueue(this.processWords.bind(this),n,r,t,i):this.q.enqueue(this.processWords.bind(this),n,r,t,i))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,r,i,t){return t&&this._locationsWords.length>=t?Promise.resolve():e.load(this.request).then(function(n){var a=new Ui.defer,o=this.parseWords(n,e,r,i),l=t-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=t?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,r,i,t){var n=r.cfiBase,a=[],o=e.ownerDocument,l=(0,Ui.qs)(o,"body"),h=i,p=t?t.spinePos!==r.index:!0,u;t&&r.index===t.spinePos&&(u=t.findNode(t.range?t.path.steps.concat(t.start.steps):t.path.steps,e.ownerDocument));var f=function(g){if(!p)if(g===u)p=!0;else return!1;if(g.textContent.length<10&&g.textContent.trim().length===0)return!1;var E=this.countWords(g.textContent),S,_=0;if(E===0)return!1;for(S=h-this._wordCounter,S>E&&(this._wordCounter+=E,_=E);_<E;)if(S=h-this._wordCounter,_+S>=E)this._wordCounter+=E-_,_=E;else{_+=S;let m=new bi.default(g,n);a.push({cfi:m.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,Ui.sprint)(l,f.bind(this)),a}locationFromCfi(e){let r;return bi.default.prototype.isCfiString(e)&&(e=new bi.default(e)),this._locations.length===0?-1:(r=(0,Ui.locationOf)(e,this._locations,this.epubcfi.compare),r>this.total?this.total:r)}percentageFromCfi(e){if(this._locations.length===0)return null;var r=this.locationFromCfi(e);return this.percentageFromLocation(r)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var r=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(r=this._locations[e]),r}cfiFromPercentage(e){let r;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new bi.default(this._locations[this.total]);return i.collapse(),i.toString()}return r=Math.ceil(this.total*e),this.cfiFromLocation(r)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var r;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(r=this.locationFromCfi(e),this._current=r):r=e,this.emit(m_.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(r)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,y_.default)(oc.prototype);var E_=oc;Ns.default=E_;var Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.default=void 0;var __=b_(Cs),x_=Be;function b_(s){return s&&s.__esModule?s:{default:s}}class S_{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var r;if(!e)throw new Error("Container File Not Found");if(r=(0,x_.qs)(e,"rootfile"),!r)throw new Error("No RootFile Found");this.packagePath=r.getAttribute("full-path"),this.directory=__.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}var T_=S_;Bs.default=T_;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.default=void 0;var Or=Be;class A_{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var r,i,t;if(!e)throw new Error("Package File Not Found");if(r=(0,Or.qs)(e,"metadata"),!r)throw new Error("No Metadata Found");if(i=(0,Or.qs)(e,"manifest"),!i)throw new Error("No Manifest Found");if(t=(0,Or.qs)(e,"spine"),!t)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,t),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,Or.indexOfElementNode)(t),this.spine=this.parseSpine(t,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(r),this.metadata.direction=t.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var r={};return r.title=this.getElementText(e,"title"),r.creator=this.getElementText(e,"creator"),r.description=this.getElementText(e,"description"),r.pubdate=this.getElementText(e,"date"),r.publisher=this.getElementText(e,"publisher"),r.identifier=this.getElementText(e,"identifier"),r.language=this.getElementText(e,"language"),r.rights=this.getElementText(e,"rights"),r.modified_date=this.getPropertyText(e,"dcterms:modified"),r.layout=this.getPropertyText(e,"rendition:layout"),r.orientation=this.getPropertyText(e,"rendition:orientation"),r.flow=this.getPropertyText(e,"rendition:flow"),r.viewport=this.getPropertyText(e,"rendition:viewport"),r.media_active_class=this.getPropertyText(e,"media:active-class"),r.spread=this.getPropertyText(e,"rendition:spread"),r}parseManifest(e){var r={},i=(0,Or.qsa)(e,"item"),t=Array.prototype.slice.call(i);return t.forEach(function(n){var a=n.getAttribute("id"),o=n.getAttribute("href")||"",l=n.getAttribute("media-type")||"",h=n.getAttribute("media-overlay")||"",p=n.getAttribute("properties")||"";r[a]={href:o,type:l,overlay:h,properties:p.length?p.split(" "):[]}}),r}parseSpine(e,r){var i=[],t=(0,Or.qsa)(e,"itemref"),n=Array.prototype.slice.call(t);return n.forEach(function(a,o){var l=a.getAttribute("idref"),h=a.getAttribute("properties")||"",p=h.length?h.split(" "):[],u={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:p,index:o};i.push(u)}),i}findUniqueIdentifier(e){var r=e.documentElement.getAttribute("unique-identifier");if(!r)return"";var i=e.getElementById(r);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var r=(0,Or.qsp)(e,"item",{properties:"nav"});return r?r.getAttribute("href"):!1}findNcxPath(e,r){var i=(0,Or.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),t;return i||(t=r.getAttribute("toc"),t&&(i=e.querySelector(`#${t}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var r=(0,Or.qs)(e,"package");r.getAttribute("version");var i=(0,Or.qsp)(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var t=(0,Or.qsp)(e,"meta",{name:"cover"});if(t){var n=t.getAttribute("content"),a=e.getElementById(n);return a?a.getAttribute("href"):""}else return!1}getElementText(e,r){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",r),t;return!i||i.length===0?"":(t=i[0],t.childNodes.length?t.childNodes[0].nodeValue:"")}getPropertyText(e,r){var i=(0,Or.qsp)(e,"meta",{property:r});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let r=e.readingOrder||e.spine;return this.spine=r.map((i,t)=>(i.index=t,i.linear=i.linear||"yes",i)),e.resources.forEach((i,t)=>{this.manifest[t]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,t)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var w_=A_;Us.default=w_;var js={};Object.defineProperty(js,"__esModule",{value:!0});js.default=void 0;var cr=Be;class O_{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let r=e.nodeType,i,t;r&&(i=(0,cr.qs)(e,"html"),t=(0,cr.qs)(e,"ncx")),r?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):t&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var r,i=0;i<e.length;i++)r=e[i],r.href&&(this.tocByHref[r.href]=i),r.id&&(this.tocById[r.id]=i),this.length++,r.subitems.length&&this.unpack(r.subitems)}get(e){var r;return e?(e.indexOf("#")===0?r=this.tocById[e.substring(1)]:e in this.tocByHref&&(r=this.tocByHref[e]),this.getByIndex(e,r,this.toc)):this.toc}getByIndex(e,r,i){if(i.length===0)return;const t=i[r];if(t&&(e===t.id||e===t.href))return t;{let n;for(let a=0;a<i.length&&(n=this.getByIndex(e,r,i[a].subitems),!n);++a);return n}}landmark(e){var r;return e?(r=this.landmarksByType[e],this.landmarks[r]):this.landmarks}parseNav(e){var r=(0,cr.querySelectorByType)(e,"nav","toc"),i=[];if(!r)return i;let t=(0,cr.filterChildren)(r,"ol",!0);return t&&(i=this.parseNavList(t)),i}parseNavList(e,r){const i=[];if(!e||!e.children)return i;for(let t=0;t<e.children.length;t++){const n=this.navItem(e.children[t],r);n&&i.push(n)}return i}navItem(e,r){let i=e.getAttribute("id")||void 0,t=(0,cr.filterChildren)(e,"a",!0)||(0,cr.filterChildren)(e,"span",!0);if(!t)return;let n=t.getAttribute("href")||"";i||(i=n);let a=t.textContent||"",o=[],l=(0,cr.filterChildren)(e,"ol",!0);return l&&(o=this.parseNavList(l,i)),{id:i,href:n,label:a,subitems:o,parent:r}}parseLandmarks(e){var r=(0,cr.querySelectorByType)(e,"nav","landmarks"),i=r?(0,cr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.landmarkItem(i[n]),o&&(a.push(o),this.landmarksByType[o.type]=n);return a}landmarkItem(e){let r=(0,cr.filterChildren)(e,"a",!0);if(!r)return;let i=r.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,t=r.getAttribute("href")||"",n=r.textContent||"";return{href:t,label:n,type:i}}parseNcx(e){var r=(0,cr.qsa)(e,"navPoint"),i=r.length,t,n={},a=[],o,l;if(!r||i===0)return a;for(t=0;t<i;++t)o=this.ncxItem(r[t]),n[o.id]=o,o.parent?(l=n[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var r=e.getAttribute("id")||!1,i=(0,cr.qs)(e,"content"),t=i.getAttribute("src"),n=(0,cr.qs)(e,"navLabel"),a=n.textContent?n.textContent:"",o=[],l=e.parentNode,h;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(h=l.getAttribute("id")),{id:r,href:t,label:a,subitems:o,parent:h}}load(e){return e.map(r=>(r.label=r.title,r.subitems=r.children?this.load(r.children):[],r))}forEach(e){return this.toc.forEach(e)}}var L_=O_;js.default=L_;var Ws={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.default=void 0;var va={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},I_=function(){var s,e,r,i,t={};for(s in va)if(va.hasOwnProperty(s)){for(e in va[s])if(va[s].hasOwnProperty(e))if(r=va[s][e],typeof r=="string")t[r]=s+"/"+e;else for(i=0;i<r.length;i++)t[r[i]]=s+"/"+e}return t}(),R_="text/plain";function D_(s){return s&&I_[s.split(".").pop().toLowerCase()]||R_}var C_={lookup:D_};Tn.default=C_;Object.defineProperty(Ws,"__esModule",{value:!0});Ws.default=void 0;var lc=qr,ga=Be,P_=zs(ki),M_=zs(Tn),uc=zs(Qr),k_=zs(Cs);function zs(s){return s&&s.__esModule?s:{default:s}}class N_{constructor(e,r){this.settings={replacements:r&&r.replacements||"base64",archive:r&&r.archive,resolver:r&&r.resolver,request:r&&r.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(r){return e[r]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var r=new P_.default(e),i=M_.default.lookup(r.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(t=>(0,ga.blob2base64)(t)).then(t=>(0,ga.createBase64Url)(t,i)):this.settings.request(e,"blob").then(t=>(0,ga.createBlobUrl)(t,i))}replacements(){if(this.settings.replacements==="none")return new Promise(function(r){r(this.urls)}.bind(this));var e=this.urls.map(r=>{var i=this.settings.resolver(r);return this.createUrl(i).catch(t=>(console.error(t),null))});return Promise.all(e).then(r=>(this.replacementUrls=r.filter(i=>typeof i=="string"),r))}replaceCss(e,r){var i=[];return e=e||this.settings.archive,r=r||this.settings.resolver,this.cssUrls.forEach(function(t){var n=this.createCssFile(t,e,r).then(function(a){var o=this.urls.indexOf(t);o>-1&&(this.replacementUrls[o]=a)}.bind(this));i.push(n)}.bind(this)),Promise.all(i)}createCssFile(e){var r;if(k_.default.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),t;this.settings.archive?t=this.settings.archive.getText(i):t=this.settings.request(i,"text");var n=this.urls.map(a=>{var o=this.settings.resolver(a),l=new uc.default(i).relative(o);return l});return t?t.then(a=>(a=(0,lc.substitute)(a,n,this.replacementUrls),this.settings.replacements==="base64"?r=(0,ga.createBase64Url)(a,"text/css"):r=(0,ga.createBlobUrl)(a,"text/css"),r),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,r){return r=r||this.settings.resolver,this.urls.map(function(i){var t=r(i),n=new uc.default(e).relative(t);return n}.bind(this))}get(e){var r=this.urls.indexOf(e);if(r!==-1)return this.replacementUrls.length?new Promise(function(i,t){i(this.replacementUrls[r])}.bind(this)):this.createUrl(e)}substitute(e,r){var i;return r?i=this.relativeTo(r):i=this.urls,(0,lc.substitute)(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var F_=N_;Ws.default=F_;var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.default=void 0;var B_=U_(Qt),Lr=Be;function U_(s){return s&&s.__esModule?s:{default:s}}class j_{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new B_.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var r=(0,Lr.qs)(e,"html"),i=(0,Lr.qs)(e,"ncx");if(r)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var r=(0,Lr.querySelectorByType)(e,"nav","page-list"),i=r?(0,Lr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.item(i[n]),a.push(o);return a}parseNcx(e){var r=[],i=0,t,n,a,o=0;if(n=(0,Lr.qs)(e,"pageList"),!n||(a=(0,Lr.qsa)(n,"pageTarget"),o=a.length,!a||a.length===0))return r;for(i=0;i<o;++i)t=this.ncxItem(a[i]),r.push(t);return r}ncxItem(e){var r=(0,Lr.qs)(e,"navLabel"),i=(0,Lr.qs)(r,"text"),t=i.textContent,n=(0,Lr.qs)(e,"content"),a=n.getAttribute("src"),o=parseInt(t,10);return{href:a,page:o}}item(e){var r=(0,Lr.qs)(e,"a"),i=r.getAttribute("href")||"",t=r.textContent||"",n=parseInt(t),a=i.indexOf("epubcfi"),o,l,h;return a!=-1?(o=i.split("#"),l=o[0],h=o.length>1?o[1]:!1,{cfi:h,href:i,packageUrl:l,page:n}):{href:i,page:n}}process(e){e.forEach(function(r){this.pages.push(r.page),r.cfi&&this.locations.push(r.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var r=-1;if(this.locations.length===0)return-1;var i=(0,Lr.indexOfSorted)(e,this.locations,this.epubcfi.compare);return i!=-1?r=this.pages[i]:(i=(0,Lr.locationOf)(e,this.locations,this.epubcfi.compare),r=i-1>=0?this.pages[i-1]:this.pages[0],r!==void 0||(r=-1)),r}cfiFromPage(e){var r=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(r=this.locations[i]),r}pageFromPercentage(e){var r=Math.round(this.totalPages*e);return r}percentageFromPage(e){var r=(e-this.firstPage)/this.totalPages;return Math.round(r*1e3)/1e3}percentageFromCfi(e){var r=this.pageFromCfi(e),i=this.percentageFromPage(r);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var W_=j_;Vs.default=W_;var An={},ma={};Object.defineProperty(ma,"__esModule",{value:!0});ma.default=void 0;var z_=Be,V_=Nt,K_=H_(Ar.exports);function H_(s){return s&&s.__esModule?s:{default:s}}class fc{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e!="undefined"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,r){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),r>=0&&(this._minSpreadWidth=r),this._spread}calculate(e,r,i){var t=1,n=i||0,a=e,o=r,l=Math.floor(a/12),h,p,u,f;this._spread&&a>=this._minSpreadWidth?t=2:t=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(n=l%2==0?l:l-1),this.name==="pre-paginated"&&(n=0),t>1?(h=a/t-n,u=h+n):(h=a,u=a),this.name==="pre-paginated"&&t>1&&(a=h),p=h*t+n,f=a,this.width=a,this.height=o,this.spreadWidth=p,this.pageWidth=u,this.delta=f,this.columnWidth=h,this.gap=n,this.divisor=t,this.update({width:a,height:o,spreadWidth:p,pageWidth:u,delta:f,columnWidth:h,gap:n,divisor:t})}format(e,r,i){var t;return this.name==="pre-paginated"?t=e.fit(this.columnWidth,this.height,r):this._flow==="paginated"?t=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?t=e.size(null,this.height):t=e.size(this.width,null),t}count(e,r){let i,t;return this.name==="pre-paginated"?(i=1,t=1):this._flow==="paginated"?(r=r||this.delta,i=Math.ceil(e/r),t=i*this.divisor):(r=r||this.height,i=Math.ceil(e/r),t=i),{spreads:i,pages:t}}update(e){if(Object.keys(e).forEach(r=>{this.props[r]===e[r]&&delete e[r]}),Object.keys(e).length>0){let r=(0,z_.extend)(this.props,e);this.emit(V_.EVENTS.LAYOUT.UPDATED,r,e)}}}(0,K_.default)(fc.prototype);var $_=fc;ma.default=$_;var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.default=void 0;var G_=Y_(ki);function Y_(s){return s&&s.__esModule?s:{default:s}}class X_{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(!!e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var r in e)e.hasOwnProperty(r)&&(typeof e[r]=="string"?this.registerUrl(r,e[r]):this.registerRules(r,e[r]))}registerCss(e,r){this._themes[e]={serialized:r},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,r){var i=new G_.default(r);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,r){this._themes[e]={rules:r},(this._injected[e]||e=="default")&&this.update(e)}select(e){var r=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(t=>{t.removeClass(r),t.addClass(e)})}update(e){var r=this.rendition.getContents();r.forEach(i=>{this.add(e,i)})}inject(e){var r=[],i=this._themes,t;for(var n in i)i.hasOwnProperty(n)&&(n===this._current||n==="default")&&(t=i[n],(t.rules&&Object.keys(t.rules).length>0||t.url&&r.indexOf(t.url)===-1)&&this.add(n,e),this._injected.push(n));this._current!="default"&&e.addClass(this._current)}add(e,r){var i=this._themes[e];!i||!r||(i.url?r.addStylesheet(i.url):i.serialized?(r.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(r.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,r,i){var t=this.rendition.getContents();this._overrides[e]={value:r,priority:i===!0},t.forEach(n=>{n.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var r=this.rendition.getContents();delete this._overrides[e],r.forEach(i=>{i.css(e)})}overrides(e){var r=this._overrides;for(var i in r)r.hasOwnProperty(i)&&e.css(i,r[i].value,r[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var Z_=X_;Ks.default=Z_;var ji={},ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.default=void 0;var Hs=Q_(Qt),dc=Be;function Q_(s){return s&&s.__esModule?s:{default:s}}class J_{constructor(e,r,i,t=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=r||"ltr",this._dev=t}section(e){var r=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,r);return i}page(e,r,i,t){var n=e&&e.document?e.document.body:!1,a;if(!!n){if(a=this.rangePairToCfiPair(r,{start:this.findStart(n,i,t),end:this.findEnd(n,i,t)}),this._dev===!0){let o=e.document,l=new Hs.default(a.start).toRange(o),h=new Hs.default(a.end).toRange(o),p=o.defaultView.getSelection(),u=o.createRange();p.removeAllRanges(),u.setStart(l.startContainer,l.startOffset),u.setEnd(h.endContainer,h.endOffset),p.addRange(u)}return a}}walk(e,r){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},t=i.acceptNode;t.acceptNode=i.acceptNode;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t,!1),a,o;(a=n.nextNode())&&(o=r(a),!o););return o}}findRanges(e){for(var r=[],i=e.contents.scrollWidth(),t=Math.ceil(i/this.layout.spreadWidth),n=t*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,h,p=0;p<n.pages;p++)l=(a+o)*p,h=a*(p+1)+o*p,r.push({start:this.findStart(e.document.body,l,h),end:this.findEnd(e.document.body,l,h)});return r}findStart(e,r,i){for(var t=[e],n,a,o=e;t.length;)if(n=t.shift(),a=this.walk(n,l=>{var h,p,u,f,g;if(g=(0,dc.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(h=this.horizontal?g.left:g.top,p=this.horizontal?g.right:g.bottom,h>=r&&h<=i)return l;if(p>r)return l;o=l,t.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(h=g.left,p=g.right,p<=i&&p>=r)return l;if(h<i)return l;o=l,t.push(l)}else{if(u=g.top,f=g.bottom,u>=r&&u<=i)return l;if(f>r)return l;o=l,t.push(l)}}),a)return this.findTextStartRange(a,r,i);return this.findTextStartRange(o,r,i)}findEnd(e,r,i){for(var t=[e],n,a=e,o;t.length;)if(n=t.shift(),o=this.walk(n,l=>{var h,p,u,f,g;if(g=(0,dc.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(h=Math.round(g.left),p=Math.round(g.right),h>i&&a)return a;if(p>i)return l;a=l,t.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(h=Math.round(this.horizontal?g.left:g.top),p=Math.round(this.horizontal?g.right:g.bottom),p<r&&a)return a;if(h<r)return l;a=l,t.push(l)}else{if(u=Math.round(g.top),f=Math.round(g.bottom),u>i&&a)return a;if(f>i)return l;a=l,t.push(l)}}),o)return this.findTextEndRange(o,r,i);return this.findTextEndRange(a,r,i)}findTextStartRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,l,h,p=0;p<t.length;p++)if(n=t[p],a=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=r)return n}else if(this.horizontal&&this.direction==="rtl"){if(h=a.right,h<=i)return n}else if(l=a.top,l>=r)return n;return t[0]}findTextEndRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,l,h,p,u,f=0;f<t.length;f++){if(a=t[f],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,h=o.right,l>i&&n)return n;if(h>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,h=o.right,h<r&&n)return n;if(l<r)return a}else{if(p=o.top,u=o.bottom,p>i&&n)return n;if(u>i)return a}n=a}return t[t.length-1]}splitTextNodeIntoRanges(e,r){var i=[],t=e.textContent||"",n=t.trim(),a,o=e.ownerDocument,l=r||" ",h=n.indexOf(l);if(h===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,h),i.push(a),a=!1;h!=-1;)h=n.indexOf(l,h+1),h>0&&(a&&(a.setEnd(e,h),i.push(a)),a=o.createRange(),a.setStart(e,h+1));return a&&(a.setEnd(e,n.length),i.push(a)),i}rangePairToCfiPair(e,r){var i=r.start,t=r.end;i.collapse(!0),t.collapse(!1);let n=new Hs.default(i,e).toString(),a=new Hs.default(t,e).toString();return{start:n,end:a}}rangeListToCfiList(e,r){for(var i=[],t,n=0;n<r.length;n++)t=this.rangePairToCfiPair(e,r[n]),i.push(t);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var q_=J_;ya.default=q_;Object.defineProperty(ji,"__esModule",{value:!0});ji.default=void 0;var ex=zl(Ar.exports),Fr=Be,wn=zl(Qt),cc=zl(ya),tx=qr,oi=Nt;function zl(s){return s&&s.__esModule?s:{default:s}}const hc=typeof navigator!="undefined",rx=hc&&/Chrome/.test(navigator.userAgent),pc=hc&&!rx&&/AppleWebKit/.test(navigator.userAgent),ix=1;class vc{constructor(e,r,i,t){this.epubcfi=new wn.default,this.document=e,this.documentElement=this.document.documentElement,this.content=r||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=t||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",oi.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return oi.DOM_EVENTS}width(e){var r=this.content;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}height(e){var r=this.content;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}contentWidth(e){var r=this.content||this.document.body;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}contentHeight(e){var r=this.content||this.document.body;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}textWidth(){let e,r,i=this.document.createRange(),t=this.content||this.document.body,n=(0,Fr.borders)(t);return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.width,n&&n.width&&(r+=n.width),Math.round(r)}textHeight(){let e,r,i=this.document.createRange(),t=this.content||this.document.body;return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.bottom,Math.round(r)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,r,i){var t=this.content||this.document.body;return r?t.style.setProperty(e,r,i?"important":""):t.style.removeProperty(e),this.window.getComputedStyle(t)[e]}viewport(e){var r=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},t=[],n={};if(r&&r.hasAttribute("content")){let a=r.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),h=a.match(/initial-scale\s*=\s*([^,]*)/),p=a.match(/minimum-scale\s*=\s*([^,]*)/),u=a.match(/maximum-scale\s*=\s*([^,]*)/),f=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]!="undefined"&&(i.width=o[1]),l&&l.length&&typeof l[1]!="undefined"&&(i.height=l[1]),h&&h.length&&typeof h[1]!="undefined"&&(i.scale=h[1]),p&&p.length&&typeof p[1]!="undefined"&&(i.minimum=p[1]),u&&u.length&&typeof u[1]!="undefined"&&(i.maximum=u[1]),f&&f.length&&typeof f[1]!="undefined"&&(i.scalable=f[1])}return n=(0,Fr.defaults)(e||{},i),e&&(n.width&&t.push("width="+n.width),n.height&&t.push("height="+n.height),n.scale&&t.push("initial-scale="+n.scale),n.scalable==="no"?(t.push("minimum-scale="+n.scale),t.push("maximum-scale="+n.scale),t.push("user-scalable="+n.scalable)):(n.scalable&&t.push("user-scalable="+n.scalable),n.minimum&&t.push("minimum-scale="+n.minimum),n.maximum&&t.push("minimum-scale="+n.maximum)),r||(r=this.document.createElement("meta"),r.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(r)),r.setAttribute("content",t.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(oi.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver=="undefined"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),r=this.textHeight();(e!=this._size.width||r!=this._size.height)&&(this._size={width:e,height:r},this.onResize&&this.onResize(this._size),this.emit(oi.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,r=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),i=0;i<e.length;i+=1){var t;try{t=e[i].cssRules}catch(o){return}if(!t)return;for(var n=0;n<t.length;n+=1)if(t[n].media){var a=this.window.matchMedia(t[n].media.mediaText);a.addListener(r)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(r=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),r,i=0;i<e.length;i++)r=e[i],typeof r.naturalWidth!="undefined"&&r.naturalWidth===0&&(r.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,r){var i,t={left:0,top:0};if(!this.document)return t;if(this.epubcfi.isCfiString(e)){let n=new wn.default(e).toRange(this.document,r);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let a=n.startContainer.textContent.indexOf(" ",n.startOffset);a==-1&&(a=n.startContainer.textContent.length),n.setEnd(n.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)i=n.startContainer.getBoundingClientRect(),t.left=i.left,t.top=i.top;else if(pc){let a=n.startContainer,o=new Range;try{a.nodeType===ix?i=a.getBoundingClientRect():n.startOffset+2<a.length?(o.setStart(a,n.startOffset),o.setEnd(a,n.startOffset+2),i=o.getBoundingClientRect()):n.startOffset-2>0?(o.setStart(a,n.startOffset-2),o.setEnd(a,n.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else i=n.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let n=e.substring(e.indexOf("#")+1),a=this.document.getElementById(n);if(a)if(pc){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(t.left=i.left,t.top=i.top),t}addStylesheet(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}if(t=this.document.querySelector("link[href='"+e+"']"),t){r(!0);return}t=this.document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}_getStylesheetNode(e){var r;return e="epubjs-inserted-css-"+(e||""),this.document?(r=this.document.getElementById(e),r||(r=this.document.createElement("style"),r.id=e,this.document.head.appendChild(r)),r):!1}addStylesheetCss(e,r){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(r),i.innerHTML=e,!0}addStylesheetRules(e,r){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(r).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var t=0,n=e.length;t<n;t++){var a=1,o=e[t],l=e[t][0],h="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var p=o.length;a<p;a++){var u=o[a];h+=u[0]+":"+u[1]+(u[2]?" !important":"")+`;
`}i.insertRule(l+"{"+h+"}",i.cssRules.length)}else Object.keys(e).forEach(g=>{const E=e[g];if(Array.isArray(E))E.forEach(S=>{const m=Object.keys(S).map(c=>`${c}:${S[c]}`).join(";");i.insertRule(`${g}{${m}}`,i.cssRules.length)});else{const _=Object.keys(E).map(m=>`${m}:${E[m]}`).join(";");i.insertRule(`${g}{${_}}`,i.cssRules.length)}})}addScript(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}t=this.document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}addClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.add(e))}removeClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.remove(e))}addEventListeners(){!this.document||(this._triggerEvent=this.triggerEvent.bind(this),oi.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){!this.document||(oi.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){!this.document||(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){!this.document||(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var r=this.window.getSelection();this.triggerSelectedEvent(r)}.bind(this),250)}triggerSelectedEvent(e){var r,i;e&&e.rangeCount>0&&(r=e.getRangeAt(0),r.collapsed||(i=new wn.default(r,this.cfiBase).toString(),this.emit(oi.EVENTS.CONTENTS.SELECTED,i),this.emit(oi.EVENTS.CONTENTS.SELECTED_RANGE,r)))}range(e,r){var i=new wn.default(e);return i.toRange(this.document,r)}cfiFromRange(e,r){return new wn.default(e,this.cfiBase,r).toString()}cfiFromNode(e,r){return new wn.default(e,this.cfiBase,r).toString()}map(e){var r=new cc.default(e);return r.section()}size(e,r){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),r>=0&&(this.height(r),i.height=r),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,r,i,t,n){let a=(0,Fr.prefixed)("column-axis"),o=(0,Fr.prefixed)("column-gap"),l=(0,Fr.prefixed)("column-width"),h=(0,Fr.prefixed)("column-fill"),u=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&u==="horizontal"&&this.direction(n),this.width(e),this.height(r),this.viewport({width:e,height:r,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),u==="vertical"?(this.css("padding-top",t/2+"px",!0),this.css("padding-bottom",t/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",t/2+"px",!0),this.css("padding-right",t/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(h,"auto"),this.css(o,t+"px"),this.css(l,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,r,i){var t="scale("+e+")",n="";this.css("transform-origin","top left"),(r>=0||i>=0)&&(n=" translate("+(r||0)+"px, "+(i||0)+"px )"),this.css("transform",t+n)}fit(e,r,i){var t=this.viewport(),n=parseInt(t.width),a=parseInt(t.height),o=e/n,l=r/a,h=o<l?o:l;if(this.layoutStyle("paginated"),this.width(n),this.height(a),this.overflow("hidden"),this.scaler(h,0,0),this.css("background-size",n*h+"px "+a*h+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var p=e-n*h;this.css("margin-left",p+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,r,i,t,n){var a=new cc.default(r,n);return a.page(this,e,i,t)}linksHandler(){(0,tx.replaceLinks)(this.content,e=>{this.emit(oi.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let r=(0,Fr.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[r]=e),this.window.getComputedStyle(this.documentElement)[r]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,r){return navigator.epubReadingSystem={name:e,version:r,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,ex.default)(vc.prototype);var nx=vc;ji.default=nx;var $s={};Object.defineProperty($s,"__esModule",{value:!0});$s.default=void 0;var ax=mc(Ar.exports),sx=mc(Qt),gc=Nt;function mc(s){return s&&s.__esModule?s:{default:s}}class ox{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,r,i,t,n,a){let o=encodeURI(r+e),h=new sx.default(r).spinePos,p=new yc({type:e,cfiRange:r,data:i,sectionIndex:h,cb:t,className:n,styles:a});return this._annotations[o]=p,h in this._annotationsBySectionIndex?this._annotationsBySectionIndex[h].push(o):this._annotationsBySectionIndex[h]=[o],this.rendition.views().forEach(f=>{p.sectionIndex===f.index&&p.attach(f)}),p}remove(e,r){let i=encodeURI(e+r);if(i in this._annotations){let t=this._annotations[i];if(r&&t.type!==r)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(t.sectionIndex,i),t.sectionIndex===a.index&&t.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,r){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==r)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,r,i,t,n){return this.add("highlight",e,r,i,t,n)}underline(e,r,i,t,n){return this.add("underline",e,r,i,t,n)}mark(e,r,i){return this.add("mark",e,r,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}}class yc{constructor({type:e,cfiRange:r,data:i,sectionIndex:t,cb:n,className:a,styles:o}){this.type=e,this.cfiRange=r,this.data=i,this.sectionIndex=t,this.mark=void 0,this.cb=n,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:r,data:i,type:t,mark:n,cb:a,className:o,styles:l}=this,h;return t==="highlight"?h=e.highlight(r,i,a,o,l):t==="underline"?h=e.underline(r,i,a,o,l):t==="mark"&&(h=e.mark(r,i,a)),this.mark=h,this.emit(gc.EVENTS.ANNOTATION.ATTACH,h),h}detach(e){let{cfiRange:r,type:i}=this,t;return e&&(i==="highlight"?t=e.unhighlight(r):i==="underline"?t=e.ununderline(r):i==="mark"&&(t=e.unmark(r))),this.mark=void 0,this.emit(gc.EVENTS.ANNOTATION.DETACH,t),t}text(){}}(0,ax.default)(yc.prototype);var lx=ox;$s.default=lx;var Ea={},ei={},Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.createElement=Ec;function Ec(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}Gs.default={createElement:Ec};var _a={};Object.defineProperty(_a,"__esModule",{value:!0});_a.proxyMouse=_c;_a.clone=xc;_a.default={proxyMouse:_c};function _c(s,e){function r(a){for(var o=e.length-1;o>=0;o--){var l=e[o],h=a.clientX,p=a.clientY;if(a.touches&&a.touches.length&&(h=a.touches[0].clientX,p=a.touches[0].clientY),!!ux(l,s,h,p)){l.dispatchEvent(xc(a));break}}}if(s.nodeName==="iframe"||s.nodeName==="IFRAME")try{this.target=s.contentDocument}catch(a){this.target=s}else this.target=s;for(var i=["mouseup","mousedown","click","touchstart"],t=0;t<i.length;t++){var n=i[t];this.target.addEventListener(n,function(a){return r(a)},!1)}}function xc(s){var e=Object.assign({},s,{bubbles:!1});try{return new MouseEvent(s.type,e)}catch(i){var r=document.createEvent("MouseEvents");return r.initMouseEvent(s.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),r}}function ux(s,e,r,i){var t=e.getBoundingClientRect();function n(p,u,f){var g=p.top-t.top,E=p.left-t.left,S=g+p.height,_=E+p.width;return g<=f&&E<=u&&S>f&&_>u}var a=s.getBoundingClientRect();if(!n(a,r,i))return!1;for(var o=s.getClientRects(),l=0,h=o.length;l<h;l++)if(n(o[l],r,i))return!0;return!1}Object.defineProperty(ei,"__esModule",{value:!0});ei.Underline=ei.Highlight=ei.Mark=ei.Pane=void 0;var fx=function s(e,r,i){e===null&&(e=Function.prototype);var t=Object.getOwnPropertyDescriptor(e,r);if(t===void 0){var n=Object.getPrototypeOf(e);return n===null?void 0:s(n,r,i)}else{if("value"in t)return t.value;var a=t.get;return a===void 0?void 0:a.call(i)}},Ys=function(){function s(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,i){return r&&s(e.prototype,r),i&&s(e,i),e}}(),dx=Gs,xa=bc(dx),cx=_a,hx=bc(cx);function bc(s){return s&&s.__esModule?s:{default:s}}function Sc(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:s}function Tc(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}function Xs(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}ei.Pane=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;Xs(this,s),this.target=e,this.element=xa.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),hx.default.proxyMouse(this.target,this.marks),this.container=r,this.container.appendChild(this.element),this.render()}return Ys(s,[{key:"addMark",value:function(r){var i=xa.default.createElement("g");return this.element.appendChild(i),r.bind(i,this.container),this.marks.push(r),r.render(),r}},{key:"removeMark",value:function(r){var i=this.marks.indexOf(r);if(i!==-1){var t=r.unbind();this.element.removeChild(t),this.marks.splice(i,1)}}},{key:"render",value:function(){mx(this.element,gx(this.target,this.container));var r=!0,i=!1,t=void 0;try{for(var n=this.marks[Symbol.iterator](),a;!(r=(a=n.next()).done);r=!0){var o=a.value;o.render()}}catch(l){i=!0,t=l}finally{try{!r&&n.return&&n.return()}finally{if(i)throw t}}}}]),s}();var px=ei.Mark=function(){function s(){Xs(this,s),this.element=null}return Ys(s,[{key:"bind",value:function(r,i){this.element=r,this.container=i}},{key:"unbind",value:function(){var r=this.element;return this.element=null,r}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(r){!this.element||this.element.dispatchEvent(r)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var r=[],i=this.element.firstChild;i;)r.push(i.getBoundingClientRect()),i=i.nextSibling;return r}},{key:"filteredRanges",value:function(){var r=Array.from(this.range.getClientRects());return r.filter(function(i){for(var t=0;t<r.length;t++){if(r[t]===i)return!0;var n=yx(r[t],i);if(n)return!1}return!0})}}]),s}(),vx=ei.Highlight=function(s){Tc(e,s);function e(r,i,t,n){Xs(this,e);var a=Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=r,a.className=i,a.data=t||{},a.attributes=n||{},a}return Ys(e,[{key:"bind",value:function(i,t){fx(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,t);for(var n in this.data)this.data.hasOwnProperty(n)&&(this.element.dataset[n]=this.data[n]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&this.element.setAttribute(n,this.attributes[n]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=t.length;o<l;o++){var h=t[o],p=xa.default.createElement("rect");p.setAttribute("x",h.left-n.left+a.left),p.setAttribute("y",h.top-n.top+a.top),p.setAttribute("height",h.height),p.setAttribute("width",h.width),i.appendChild(p)}this.element.appendChild(i)}}]),e}(px);ei.Underline=function(s){Tc(e,s);function e(r,i,t,n){return Xs(this,e),Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,i,t,n))}return Ys(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=t.length;o<l;o++){var h=t[o],p=xa.default.createElement("rect");p.setAttribute("x",h.left-n.left+a.left),p.setAttribute("y",h.top-n.top+a.top),p.setAttribute("height",h.height),p.setAttribute("width",h.width),p.setAttribute("fill","none");var u=xa.default.createElement("line");u.setAttribute("x1",h.left-n.left+a.left),u.setAttribute("x2",h.left-n.left+a.left+h.width),u.setAttribute("y1",h.top-n.top+a.top+h.height-1),u.setAttribute("y2",h.top-n.top+a.top+h.height-1),u.setAttribute("stroke-width",1),u.setAttribute("stroke","black"),u.setAttribute("stroke-linecap","square"),i.appendChild(p),i.appendChild(u)}this.element.appendChild(i)}}]),e}(vx);function gx(s,e){var r=e.getBoundingClientRect(),i=s.getBoundingClientRect();return{top:i.top-r.top,left:i.left-r.left,height:s.scrollHeight,width:s.scrollWidth}}function mx(s,e){s.style.setProperty("top",e.top+"px","important"),s.style.setProperty("left",e.left+"px","important"),s.style.setProperty("height",e.height+"px","important"),s.style.setProperty("width",e.width+"px","important")}function yx(s,e){return e.right<=s.right&&e.left>=s.left&&e.top>=s.top&&e.bottom<=s.bottom}Object.defineProperty(Ea,"__esModule",{value:!0});Ea.default=void 0;var Ex=Vl(Ar.exports),Ut=Be,_x=Vl(Qt),xx=Vl(ji),hr=Nt,Zs=ei;function Vl(s){return s&&s.__esModule?s:{default:s}}class Ac{constructor(e,r){this.settings=(0,Ut.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},r||{}),this.id="epubjs-view-"+(0,Ut.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new _x.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var r=document.createElement("div");return r.classList.add("epub-view"),r.style.height="0px",r.style.width="0px",r.style.overflow="hidden",r.style.position="relative",r.style.display="block",e&&e=="horizontal"?r.style.flex="none":r.style.flex="initial",r}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,Ut.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,r){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(i){return this.load(i)}.bind(this)).then(function(){let i=this.contents.writingMode(),t;return this.settings.flow==="scrolled"?t=i.indexOf("vertical")===0?"horizontal":"vertical":t=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(hr.EVENTS.VIEWS.AXIS,t),this.setWritingMode(i),this.emit(hr.EVENTS.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}.bind(this),function(i){return this.emit(hr.EVENTS.VIEWS.LOAD_ERROR,i),new Promise((t,n)=>{n(i)})}.bind(this)).then(function(){this.emit(hr.EVENTS.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,r){var i=e||this.settings.width,t=r||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,t):this.settings.axis==="horizontal"?this.lock("height",i,t):this.lock("width",i,t),this.settings.width=i,this.settings.height=t}lock(e,r,i){var t=(0,Ut.borders)(this.element),n;this.iframe?n=(0,Ut.borders)(this.iframe):n={width:0,height:0},e=="width"&&(0,Ut.isNumber)(r)&&(this.lockedWidth=r-t.width-n.width),e=="height"&&(0,Ut.isNumber)(i)&&(this.lockedHeight=i-t.height-n.height),e==="both"&&(0,Ut.isNumber)(r)&&(0,Ut.isNumber)(i)&&(this.lockedWidth=r-t.width-n.width,this.lockedHeight=i-t.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(e){var r=this.lockedWidth,i=this.lockedHeight,t;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(r=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(r=this.contents.textWidth(),r%this.layout.pageWidth>0&&(r=Math.ceil(r/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(t=r/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&t%2>0&&(r+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||r!=this._width||i!=this._height)&&this.reframe(r,i),this._expanding=!1)}reframe(e,r){var i;(0,Ut.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,Ut.isNumber)(r)&&(this.element.style.height=r+"px",this.iframe.style.height=r+"px",this._height=r);let t=this.prevBounds?e-this.prevBounds.width:e,n=this.prevBounds?r-this.prevBounds.height:r;i={width:e,height:r,widthDelta:t,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit(hr.EVENTS.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=(0,Ut.bounds)(this.element)}load(e){var r=new Ut.defer,i=r.promise;if(!this.iframe)return r.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=function(n){this.onLoad(n,r)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,Ut.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return r.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var t=this;MSApp.execUnsafeLocalFunction(function(){t.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,r){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new xx.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(hr.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(hr.EVENTS.CONTENTS.RESIZE,t=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),r.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var r=new Ut.defer;return this.displayed?r.resolve(this):this.render(e).then(function(){this.emit(hr.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,r.resolve(this)}.bind(this),function(i){r.reject(i,this)}),r.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(hr.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(hr.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var r=this.contents.locationOf(e,this.settings.ignoreClass);return{left:r.left,top:r.top}}onDisplayed(e){}onResize(e,r){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,Ut.bounds)(this.element)),this.elementBounds}highlight(e,r={},i,t="epubjs-hl",n={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),l=()=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Zs.Pane(this.iframe,this.element));let h=new Zs.Highlight(o,t,r,a),p=this.pane.addMark(h);return this.highlights[e]={mark:p,element:p.element,listeners:[l,i]},p.element.setAttribute("ref",t),p.element.addEventListener("click",l),p.element.addEventListener("touchstart",l),i&&(p.element.addEventListener("click",i),p.element.addEventListener("touchstart",i)),p}underline(e,r={},i,t="epubjs-ul",n={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),l=()=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Zs.Pane(this.iframe,this.element));let h=new Zs.Underline(o,t,r,a),p=this.pane.addMark(h);return this.underlines[e]={mark:p,element:p.element,listeners:[l,i]},p.element.setAttribute("ref",t),p.element.addEventListener("click",l),p.element.addEventListener("touchstart",l),i&&(p.element.addEventListener("click",i),p.element.addEventListener("touchstart",i)),p}mark(e,r={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let t=this.contents.range(e);if(!t)return;let n=t.commonAncestorContainer,a=n.nodeType===1?n:n.parentNode,o=h=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};t.collapsed&&n.nodeType===1?(t=new Range,t.selectNodeContents(n)):t.collapsed&&(t=new Range,t.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,r&&Object.keys(r).forEach(h=>{l.dataset[h]=r[h]}),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,t),this.element.appendChild(l),this.marks[e]={element:l,range:t,listeners:[o,i]},a}placeMark(e,r){let i,t,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=r.getBoundingClientRect();i=o.top,t=o.right}else{let o=r.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!n||l.left<n)&&(n=l.left,t=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=l.top)}e.style.top=`${i}px`,e.style.left=`${t}px`}unhighlight(e){let r;e in this.highlights&&(r=this.highlights[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let r;e in this.underlines&&(r=this.underlines[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let r;e in this.marks&&(r=this.marks[e],this.element.removeChild(r.element),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,Ut.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,Ex.default)(Ac.prototype);var bx=Ac;Ea.default=bx;var On={},Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.createDefiner=wc;Qs.default=Sx;function Sx(){var s="reverse",e=wc();return document.body.appendChild(e),e.scrollLeft>0?s="default":typeof Element!="undefined"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(s="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(s="negative")),document.body.removeChild(e),s}function wc(){var s=document.createElement("div");s.dir="rtl",s.style.position="fixed",s.style.width="1px",s.style.height="1px",s.style.top="0px",s.style.left="0px",s.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var r=document.createElement("span");r.style.width="1px",r.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(r),e.appendChild(i),s.appendChild(e),s}var Js={};function Tx(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var Kl=Tx,Ax=typeof Wt=="object"&&Wt&&Wt.Object===Object&&Wt,wx=Ax,Ox=wx,Lx=typeof self=="object"&&self&&self.Object===Object&&self,Ix=Ox||Lx||Function("return this")(),Oc=Ix,Rx=Oc,Dx=function(){return Rx.Date.now()},Cx=Dx,Px=/\s/;function Mx(s){for(var e=s.length;e--&&Px.test(s.charAt(e)););return e}var kx=Mx,Nx=kx,Fx=/^\s+/;function Bx(s){return s&&s.slice(0,Nx(s)+1).replace(Fx,"")}var Ux=Bx,jx=Oc,Wx=jx.Symbol,Lc=Wx,Ic=Lc,Rc=Object.prototype,zx=Rc.hasOwnProperty,Vx=Rc.toString,ba=Ic?Ic.toStringTag:void 0;function Kx(s){var e=zx.call(s,ba),r=s[ba];try{s[ba]=void 0;var i=!0}catch(n){}var t=Vx.call(s);return i&&(e?s[ba]=r:delete s[ba]),t}var Hx=Kx,$x=Object.prototype,Gx=$x.toString;function Yx(s){return Gx.call(s)}var Xx=Yx,Dc=Lc,Zx=Hx,Qx=Xx,Jx="[object Null]",qx="[object Undefined]",Cc=Dc?Dc.toStringTag:void 0;function eb(s){return s==null?s===void 0?qx:Jx:Cc&&Cc in Object(s)?Zx(s):Qx(s)}var tb=eb;function rb(s){return s!=null&&typeof s=="object"}var ib=rb,nb=tb,ab=ib,sb="[object Symbol]";function ob(s){return typeof s=="symbol"||ab(s)&&nb(s)==sb}var lb=ob,ub=Ux,Pc=Kl,fb=lb,Mc=0/0,db=/^[-+]0x[0-9a-f]+$/i,cb=/^0b[01]+$/i,hb=/^0o[0-7]+$/i,pb=parseInt;function vb(s){if(typeof s=="number")return s;if(fb(s))return Mc;if(Pc(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=Pc(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=ub(s);var r=cb.test(s);return r||hb.test(s)?pb(s.slice(2),r?2:8):db.test(s)?Mc:+s}var gb=vb,mb=Kl,Hl=Cx,kc=gb,yb="Expected a function",Eb=Math.max,_b=Math.min;function xb(s,e,r){var i,t,n,a,o,l,h=0,p=!1,u=!1,f=!0;if(typeof s!="function")throw new TypeError(yb);e=kc(e)||0,mb(r)&&(p=!!r.leading,u="maxWait"in r,n=u?Eb(kc(r.maxWait)||0,e):n,f="trailing"in r?!!r.trailing:f);function g(x){var b=i,T=t;return i=t=void 0,h=x,a=s.apply(T,b),a}function E(x){return h=x,o=setTimeout(m,e),p?g(x):a}function S(x){var b=x-l,T=x-h,A=e-b;return u?_b(A,n-T):A}function _(x){var b=x-l,T=x-h;return l===void 0||b>=e||b<0||u&&T>=n}function m(){var x=Hl();if(_(x))return c(x);o=setTimeout(m,S(x))}function c(x){return o=void 0,f&&i?g(x):(i=t=void 0,a)}function v(){o!==void 0&&clearTimeout(o),h=0,i=l=t=o=void 0}function y(){return o===void 0?a:c(Hl())}function d(){var x=Hl(),b=_(x);if(i=arguments,t=this,l=x,b){if(o===void 0)return E(l);if(u)return clearTimeout(o),o=setTimeout(m,e),g(l)}return o===void 0&&(o=setTimeout(m,e)),a}return d.cancel=v,d.flush=y,d}var Nc=xb,bb=Nc,Sb=Kl,Tb="Expected a function";function Ab(s,e,r){var i=!0,t=!0;if(typeof s!="function")throw new TypeError(Tb);return Sb(r)&&(i="leading"in r?!!r.leading:i,t="trailing"in r?!!r.trailing:t),bb(s,e,{leading:i,maxWait:e,trailing:t})}var wb=Ab;Object.defineProperty(Js,"__esModule",{value:!0});Js.default=void 0;var pr=Be,Ob=Lb(wb);function Lb(s){return s&&s.__esModule?s:{default:s}}class Ib{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,pr.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let r=e.height,i=e.width,t=e.overflow||!1,n=e.axis||"vertical",a=e.direction;(0,pr.extend)(this.settings,e),e.height&&(0,pr.isNumber)(e.height)&&(r=e.height+"px"),e.width&&(0,pr.isNumber)(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",n==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),r&&(o.style.height=r),t&&(t==="scroll"&&n==="vertical"?(o.style["overflow-y"]=t,o.style["overflow-x"]="hidden"):t==="scroll"&&n==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=t):o.style.overflow=t),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var r=document.createElement("div");return r.style.visibility="hidden",r.style.overflow="hidden",r.style.width="0",r.style.height="0",r.appendChild(e),r}getElement(e){var r;if((0,pr.isElement)(e)?r=e:typeof e=="string"&&(r=document.getElementById(e)),!r)throw new Error("Not an Element");return r}attachTo(e){var r=this.getElement(e),i;if(!!r)return this.settings.hidden?i=this.wrapper:i=this.container,r.appendChild(i),this.element=r,r}getContainer(){return this.container}onResize(e){(!(0,pr.isNumber)(this.settings.width)||!(0,pr.isNumber)(this.settings.height))&&(this.resizeFunc=(0,Ob.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,r){var i;let t=e||this.settings.width,n=r||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):(0,pr.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,r===null?(i=i||this.element.getBoundingClientRect(),i.height&&(r=i.height,this.container.style.height=r+"px")):(0,pr.isNumber)(r)?this.container.style.height=r+"px":this.container.style.height=r,(0,pr.isNumber)(e)||(e=this.container.clientWidth),(0,pr.isNumber)(r)||(r=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=(0,pr.windowBounds)(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return t||(e=a.width-l.left-l.right),(this.settings.fullsize&&!n||!n)&&(r=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:r-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,pr.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,r){var i="#"+this.id+" ",t="";this.sheet||(this.sheet=this.getSheet()),r.forEach(function(n){for(var a in n)n.hasOwnProperty(a)&&(t+=a+":"+n[a]+";")}),this.sheet.insertRule(i+e+" {"+t+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var Rb=Ib;Js.default=Rb;var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.default=void 0;class Db{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,r){return this._views.splice(r,0,e),this.container&&(r<this.container.children.length?this.container.insertBefore(e.element,this.container.children[r]):this.container.appendChild(e.element)),this.length++,e}remove(e){var r=this._views.indexOf(e);r>-1&&this._views.splice(r,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,r=this.length;if(!!this.length){for(var i=0;i<r;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var r,i=this.length,t=0;t<i;t++)if(r=this._views[t],r.displayed&&r.section.index==e.index)return r}displayed(){for(var e=[],r,i=this.length,t=0;t<i;t++)r=this._views[t],r.displayed&&e.push(r);return e}show(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}var Cb=Db;qs.default=Cb;Object.defineProperty(On,"__esModule",{value:!0});On.default=void 0;var Pb=In(Ar.exports),Ln=Be,Mb=In(Qs),Fc=In(ya),kb=In(xi),Nb=In(Js),Fb=In(qs),vr=Nt;function In(s){return s&&s.__esModule?s:{default:s}}class Bc{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new kb.default(this),this.settings=(0,Ln.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,Ln.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,r){let i=e.tagName;typeof this.settings.fullsize=="undefined"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=r,this.settings.rtlScrollType=(0,Mb.default)(),this.stage=new Nb.default({width:r.width,height:r.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new Fb.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(r){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:r}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(vr.EVENTS.MANAGERS.ORIENTATION_CHANGE,r)}.bind(this),500)}onResized(e){this.resize()}resize(e,r,i){let t=this.stage.size(e,r);if(this.winBounds=(0,Ln.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===t.width&&this._stageSize.height===t.height||(this._stageSize=t,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(vr.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,r){return new this.View(e,(0,Ln.extend)(this.viewSettings,{forceRight:r}))}handleNextPrePaginated(e,r,i){let t;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||r.index===0)return;if(t=r.next(),t&&!t.properties.includes("page-spread-left"))return i.call(this,t)}}display(e,r){var i=new Ln.defer,t=i.promise;(r===e.href||(0,Ln.isNumber)(r))&&(r=void 0);var n=this.views.find(e);if(n&&e&&this.layout.name!=="pre-paginated"){let o=n.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=n.width();this.scrollTo(o.left+l,o.top,!0)}if(r){let l=n.locationOf(r),h=n.width();this.moveTo(l,h)}return i.resolve(),t}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(o){if(r){let l=o.locationOf(r),h=o.width();this.moveTo(l,h)}}.bind(this),o=>{i.reject(o)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),i.resolve()}.bind(this)),t}afterDisplayed(e){this.emit(vr.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(vr.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,r){var i=0,t=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),t=Math.floor(e.top/this.layout.delta)*this.layout.delta,t+this.layout.delta>this.container.scrollHeight&&(t=this.container.scrollHeight-this.layout.delta)):t=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-r),this.scrollTo(i,t,!0)}add(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}append(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}prepend(e,r){var i=this.createView(e,r);return i.on(vr.EVENTS.VIEWS.RESIZED,t=>{this.counter(t)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,r<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft,r>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(r=this.container.scrollLeft+this.layout.delta*-1,r>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(t=!0),this.append(e,t).then(function(){return this.handleNextPrePaginated(t,e,this.append)}.bind(this),n=>n).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft,r>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft+this.container.offsetWidth,r<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(r=this.container.scrollLeft,r<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(t=!0),this.prepend(e,t).then(function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=e.prev(),n))return this.prepend(n)}.bind(this),n=>n).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=r.height<window.innerHeight?r.height:window.innerHeight,t=r.width<window.innerWidth?r.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=n?window.scrollY:window.scrollX),e.map(h=>{let{index:p,href:u}=h.section,f=h.position(),g=h.width(),E=h.height(),S,_,m,c;n?(S=a+r.top-f.top+o,_=S+i-o,c=this.layout.count(E,i).pages,m=i):(S=a+r.left-f.left+o,_=S+t-o,c=this.layout.count(g,t).pages,m=t);let v=Math.ceil(S/m),y=[],d=Math.ceil(_/m);if(this.settings.direction==="rtl"&&!n){let T=v;v=c-d,d=c-T}y=[];for(var x=v;x<=d;x++){let T=x+1;y.push(T)}let b=this.mapping.page(h.contents,h.section.cfiBase,S,_);return{index:p,href:u,pages:y,totalPages:c,mapping:b}})}paginatedLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=0,t=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,h,p=a.position(),u=a.width(),f,g,E;this.settings.direction==="rtl"?(h=r.right-i,E=Math.min(Math.abs(h-p.left),this.layout.width)-t,g=p.width-(p.right-h)-t,f=g-E):(h=r.left+i,E=Math.min(p.right-h,this.layout.width)-t,f=h-p.left+t,g=f+E),t+=E;let S=this.mapping.page(a.contents,a.section.cfiBase,f,g),_=this.layout.count(u).pages,m=Math.floor(f/this.layout.pageWidth),c=[],v=Math.floor(g/this.layout.pageWidth);if(m<0&&(m=0,v=v+1),this.settings.direction==="rtl"){let d=m;m=_-v,v=_-d}for(var y=m+1;y<=v;y++){let d=y;c.push(d)}return{index:o,href:l,pages:c,totalPages:_,mapping:S}})}isVisible(e,r,i,t){var n=e.position(),a=t||this.bounds();return this.settings.axis==="horizontal"&&n.right>a.left-r&&n.left<a.right+i?!0:this.settings.axis==="vertical"&&n.bottom>a.top-r&&n.top<a.bottom+i}visible(){for(var e=this.bounds(),r=this.views.displayed(),i=r.length,t=[],n,a,o=0;o<i;o++)a=r[o],n=this.isVisible(a,0,0,e),n===!0&&t.push(a);return t}scrollBy(e,r,i){let t=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*t,r*t):(e&&(this.container.scrollLeft+=e*t),r&&(this.container.scrollTop+=r)),this.scrolled=!0}scrollTo(e,r,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,r):(this.container.scrollLeft=e,this.container.scrollTop=r),this.scrolled=!0}onScroll(){let e,r;this.settings.fullsize?(e=window.scrollY,r=window.scrollX):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:(this.emit(vr.EVENTS.MANAGERS.SCROLL,{top:e,left:r}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(vr.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){!this.stage||(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Fc.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(r){r&&r.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,r){!r&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Fc.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,r="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":r,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(r){const i=r&&r.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,Pb.default)(Bc.prototype);var Bb=Bc;On.default=Bb;var Sa={},eo={};Object.defineProperty(eo,"__esModule",{value:!0});eo.default=void 0;var Uc=Be,jc=Nt,Ub=jb(Ar.exports);function jb(s){return s&&s.__esModule?s:{default:s}}const Wb=Math.PI/2,zb={easeOutSine:function(s){return Math.sin(s*Wb)},easeInOutSine:function(s){return-.5*(Math.cos(Math.PI*s)-1)},easeInOutQuint:function(s){return(s/=.5)<1?.5*Math.pow(s,5):.5*(Math.pow(s-2,5)+2)},easeInCubic:function(s){return Math.pow(s,3)}};class Wc{constructor(e,r){this.settings=(0,Uc.extend)({duration:80,minVelocity:.2,minDistance:10,easing:zb.easeInCubic},r||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let r=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{r.on(i,t=>this.triggerViewEvent(t,r))})}triggerViewEvent(e,r){this.emit(e.type,e,r)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:r,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=r,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:r,screenY:i}=e.touches[0],t=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&t<10&&(this.element.scrollLeft-=r-this.endTouchX),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let r=this.wasSwiped();r!==0?this.snap(r):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,r=this.endTouchX-this.startTouchX,i=Math.abs(r),t=this.endTime-this.startTime,n=r/t,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(n>a)return-1;if(n<-a)return 1}needsSnap(){let e=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor;return e%r!=0}snap(e=0){let r=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,t=Math.round(r/i)*i;return e&&(t+=e*i),this.smoothScrollTo(t)}smoothScrollTo(e){const r=new Uc.defer,i=this.scrollLeft,t=this.now(),n=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),h=Math.min(1,(l-t)/n);if(a(h),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,r.resolve();return}h<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*h,0)):(this.scrollTo(e,0),this.snapping=!1,r.resolve())}return o.call(this),r.promise}scrollTo(e=0,r=0){this.fullsize?window.scroll(e,r):(this.scroller.scrollLeft=e,this.scroller.scrollTop=r)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){!this.scroller||(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,Ub.default)(Wc.prototype);var Vb=Wc;eo.default=Vb;Object.defineProperty(Sa,"__esModule",{value:!0});Sa.default=void 0;var Wi=Be,zc=$l(On),Vc=$l(eo),Ir=Nt,Kb=$l(Nc);function $l(s){return s&&s.__esModule?s:{default:s}}class Hb extends zc.default{constructor(e){super(e);this.name="continuous",this.settings=(0,Wi.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,Wi.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,r){return zc.default.prototype.display.call(this,e,r).then(function(){return this.fill()}.bind(this))}fill(e){var r=e||new Wi.defer;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(r):r.resolve()}),r.promise}moveTo(e){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(r>0||i>0)&&this.scrollBy(r,i,!0)}afterResized(e){this.emit(Ir.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var r=this.createView(e);return this.views.append(r),r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.display(this.request)}append(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r}prepend(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{this.counter(i),r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var r=this.bounds(),i=this.views.all(),t=i.length,n=typeof e!="undefined"?e:this.settings.offset||0,a,o,l=new Wi.defer,h=[],p=0;p<t;p++)if(o=i[p],a=this.isVisible(o,n,n,r),a===!0)if(o.displayed)o.show();else{let u=o.display(this.request).then(function(f){f.show()},f=>{o.hide()});h.push(u)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return h.length?Promise.all(h).catch(u=>{l.reject(u)}):(l.resolve(),l.promise)}check(e,r){var i=new Wi.defer,t=[],n=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&n&&(a=e),r&&!n&&(a=r);var o=this._bounds;let l=n?this.scrollLeft:this.scrollTop,h=n?Math.floor(o.width):o.height,p=n?this.container.scrollWidth:this.container.scrollHeight,u=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",f=this.settings.rtlScrollType,g=this.settings.direction==="rtl";this.settings.fullsize?(n&&g&&f==="negative"||!n&&g&&f==="default")&&(l=l*-1):(g&&f==="default"&&u==="horizontal"&&(l=p-h-l),g&&f==="negative"&&u==="horizontal"&&(l=l*-1));let E=()=>{let v=this.views.first(),y=v&&v.section.prev();y&&t.push(this.prepend(y))},S=()=>{let v=this.views.last(),y=v&&v.section.next();y&&t.push(this.append(y))},_=l+h+a,m=l-a;_>=p&&S(),m<0&&E();let c=t.map(v=>v.display(this.request));return t.length?Promise.all(c).then(()=>this.check()).then(()=>this.update(a),v=>v):(this.q.enqueue(function(){this.update()}.bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Wi.defer,r=this.views.displayed(),i=r[0],t=r[r.length-1],n=this.views.indexOf(i),a=this.views.indexOf(t),o=this.views.slice(0,n),l=this.views.slice(a+1),h=0;h<o.length-1;h++)this.erase(o[h],o);for(var p=1;p<l.length;p++)this.erase(l[p]);return e.resolve(),e.promise}erase(e,r){var i,t;this.settings.fullsize?(i=window.scrollY,t=window.scrollX):(i=this.container.scrollTop,t=this.container.scrollLeft);var n=e.bounds();this.views.remove(e),r&&(this.settings.axis==="vertical"?this.scrollTo(0,i-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(t+Math.floor(n.width),0,!0):this.scrollTo(t,0,!0):this.scrollTo(t-Math.floor(n.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(r){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new Vc.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Wi.requestAnimationFrame;let r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*r,this.scrollLeft=window.scrollX*r):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,Kb.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,r,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,r=window.scrollX*i):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(r-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=r,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(Ir.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ir.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new Vc.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var $b=Hb;Sa.default=$b;Object.defineProperty(An,"__esModule",{value:!0});An.default=void 0;var Gb=Br(Ar.exports),Ta=Be,zi=Br(bn),Kc=Br(Qt),Yb=Br(xi),Xb=Br(ma),Zb=Br(Ks);Br(ji);var Qb=Br($s),pt=Nt,Jb=Br(Ea),qb=Br(On),eS=Br(Sa);function Br(s){return s&&s.__esModule?s:{default:s}}class Hc{constructor(e,r){this.settings=(0,Ta.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,Ta.extend)(this.settings,r),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new zi.default(this),this.hooks.serialize=new zi.default(this),this.hooks.content=new zi.default(this),this.hooks.unloaded=new zi.default(this),this.hooks.layout=new zi.default(this),this.hooks.render=new zi.default(this),this.hooks.show=new zi.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new Zb.default(this),this.annotations=new Qb.default(this),this.epubcfi=new Kc.default,this.q=new Yb.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Ta.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var r;return typeof e=="string"&&e==="default"?r=qb.default:typeof e=="string"&&e==="continuous"?r=eS.default:r=e,r}requireView(e){var r;return typeof e=="string"&&e==="iframe"?r=Jb.default:r=e,r}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(pt.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(pt.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(pt.EVENTS.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(!!this.book){this.epubcfi.isCfiString(e);var r=new Ta.defer,i=r.promise,t;return this.displaying=r,this.book.locations.length()&&(0,Ta.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),t=this.book.spine.get(e),t?(this.manager.display(t,e).then(()=>{r.resolve(t),this.displaying=void 0,this.emit(pt.EVENTS.RENDITION.DISPLAYED,t),this.reportLocation()},n=>{this.emit(pt.EVENTS.RENDITION.DISPLAY_ERROR,n)}),i):(r.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(pt.EVENTS.VIEWS.MARK_CLICKED,(r,i)=>this.triggerMarkEvent(r,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(pt.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,r){this.emit(pt.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},r),this.location&&this.location.start&&this.display(r||this.location.start.cfi)}onOrientationChange(e){this.emit(pt.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,r,i){e&&(this.settings.width=e),r&&(this.settings.height=r),this.manager.resize(e,r,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var r,i=this.settings.layout||e.layout||"reflowable",t=this.settings.spread||e.spread||"auto",n=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,h=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),r={layout:i,spread:t,orientation:n,flow:a,viewport:o,minSpreadWidth:l,direction:h},r}flow(e){var r=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(r="scrolled"),(e==="auto"||e==="paginated")&&(r="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(r),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(r),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Xb.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(pt.EVENTS.LAYOUT.UPDATED,(r,i)=>{this.emit(pt.EVENTS.RENDITION.LAYOUT,r,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,r){this.settings.spread=e,r&&(this.settings.minSpreadWidth=r),this._layout&&this._layout.spread(e,r),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then(function(t){let n=this.located(t);!n||!n.start||!n.end||(this.location=n,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location))}.bind(this));else if(i){let t=this.located(i);if(!t||!t.start||!t.end)return;this.location=t,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(r){return this.located(r)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let r=e[0],i=e[e.length-1],t={start:{index:r.index,href:r.href,cfi:r.mapping.start,displayed:{page:r.pages[0]||1,total:r.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},n=this.book.locations.locationFromCfi(r.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);n!=null&&(t.start.location=n,t.start.percentage=this.book.locations.percentageFromLocation(n)),a!=null&&(t.end.location=a,t.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(r.mapping.start),l=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(t.start.page=o),l!=-1&&(t.end.page=l),i.index===this.book.spine.last().index&&t.end.displayed.page>=t.end.displayed.total&&(t.atEnd=!0),r.index===this.book.spine.first().index&&t.start.displayed.page===1&&(t.atStart=!0),t}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){pt.DOM_EVENTS.forEach(r=>{e.on(r,i=>this.triggerViewEvent(i,e))}),e.on(pt.EVENTS.CONTENTS.SELECTED,r=>this.triggerSelectedEvent(r,e))}triggerViewEvent(e,r){this.emit(e.type,e,r)}triggerSelectedEvent(e,r){this.emit(pt.EVENTS.RENDITION.SELECTED,e,r)}triggerMarkEvent(e,r,i){this.emit(pt.EVENTS.RENDITION.MARK_CLICKED,e,r,i)}getRange(e,r){var i=new Kc.default(e),t=this.manager.visible().filter(function(n){if(i.spinePos===n.index)return!0});if(t.length)return t[0].contents.range(i,r)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let r=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)))*.95,t=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,a){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(pt.EVENTS.CONTENTS.LINK_CLICKED,r=>{let i=this.book.path.relative(r);this.display(i)})}injectStylesheet(e,r){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,r){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,r){let i=this.book.packaging.metadata.identifier,t=e.createElement("meta");t.setAttribute("name","dc.relation.ispartof"),i&&t.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(t)}}(0,Gb.default)(Hc.prototype);var tS=Hc;An.default=tS;var to={},$c={exports:{}};/*!

JSZip v3.7.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(h,p){if(!t[h]){if(!i[h]){var u=typeof zr=="function"&&zr;if(!p&&u)return u(h,!0);if(o)return o(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var g=t[h]={exports:{}};i[h][0].call(g.exports,function(E){var S=i[h][1][E];return a(S||E)},g,g.exports,r,i,t,n)}return t[h].exports}for(var o=typeof zr=="function"&&zr,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(r,i,t){var n=r("./utils"),a=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(l){for(var h=[],p,u,f,g,E,S,_,m=0,c=l.length,v=c,y=n.getTypeOf(l)!=="string";m<l.length;)v=c-m,y?(p=l[m++],u=m<c?l[m++]:0,f=m<c?l[m++]:0):(p=l.charCodeAt(m++),u=m<c?l.charCodeAt(m++):0,f=m<c?l.charCodeAt(m++):0),g=p>>2,E=(p&3)<<4|u>>4,S=v>1?(u&15)<<2|f>>6:64,_=v>2?f&63:64,h.push(o.charAt(g)+o.charAt(E)+o.charAt(S)+o.charAt(_));return h.join("")},t.decode=function(l){var h,p,u,f,g,E,S,_=0,m=0,c="data:";if(l.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");var v=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&v--,l.charAt(l.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");var y;for(a.uint8array?y=new Uint8Array(v|0):y=new Array(v|0);_<l.length;)f=o.indexOf(l.charAt(_++)),g=o.indexOf(l.charAt(_++)),E=o.indexOf(l.charAt(_++)),S=o.indexOf(l.charAt(_++)),h=f<<2|g>>4,p=(g&15)<<4|E>>2,u=(E&3)<<6|S,y[m++]=h,E!==64&&(y[m++]=p),S!==64&&(y[m++]=u);return y}},{"./support":30,"./utils":32}],2:[function(r,i,t){var n=r("./external"),a=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function h(p,u,f,g,E){this.compressedSize=p,this.uncompressedSize=u,this.crc32=f,this.compression=g,this.compressedContent=E}h.prototype={getContentWorker:function(){var p=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),u=this;return p.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(p,u,f){return p.pipe(new o).pipe(new l("uncompressedSize")).pipe(u.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",u)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,i,t){var n=r("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(a){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},t.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,i,t){var n=r("./utils");function a(){for(var p,u=[],f=0;f<256;f++){p=f;for(var g=0;g<8;g++)p=p&1?3988292384^p>>>1:p>>>1;u[f]=p}return u}var o=a();function l(p,u,f,g){var E=o,S=g+f;p=p^-1;for(var _=g;_<S;_++)p=p>>>8^E[(p^u[_])&255];return p^-1}function h(p,u,f,g){var E=o,S=g+f;p=p^-1;for(var _=g;_<S;_++)p=p>>>8^E[(p^u.charCodeAt(_))&255];return p^-1}i.exports=function(u,f){if(typeof u=="undefined"||!u.length)return 0;var g=n.getTypeOf(u)!=="string";return g?l(f|0,u,u.length,0):h(f|0,u,u.length,0)}},{"./utils":32}],5:[function(r,i,t){t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(r,i,t){var n=null;typeof Promise!="undefined"?n=Promise:n=r("lie"),i.exports={Promise:n}},{lie:37}],7:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",a=r("pako"),o=r("./utils"),l=r("./stream/GenericWorker"),h=n?"uint8array":"array";t.magic="\b\0";function p(u,f){l.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=f,this.meta={}}o.inherits(p,l),p.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(h,u.data),!1)},p.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(f){u.push({data:f,meta:u.meta})}},t.compressWorker=function(u){return new p("Deflate",u)},t.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker"),o=r("../utf8"),l=r("../crc32"),h=r("../signature"),p=function(m,c){var v="",y;for(y=0;y<c;y++)v+=String.fromCharCode(m&255),m=m>>>8;return v},u=function(m,c){var v=m;return m||(v=c?16893:33204),(v&65535)<<16},f=function(m,c){return(m||0)&63},g=function(m,c,v,y,d,x){var b=m.file,T=m.compression,A=x!==o.utf8encode,L=n.transformTo("string",x(b.name)),R=n.transformTo("string",o.utf8encode(b.name)),w=b.comment,O=n.transformTo("string",x(w)),I=n.transformTo("string",o.utf8encode(w)),D=R.length!==b.name.length,C=I.length!==w.length,P,M,N="",B="",U="",F=b.dir,j=b.date,V={crc32:0,compressedSize:0,uncompressedSize:0};(!c||v)&&(V.crc32=m.crc32,V.compressedSize=m.compressedSize,V.uncompressedSize=m.uncompressedSize);var G=0;c&&(G|=8),!A&&(D||C)&&(G|=2048);var Y=0,X=0;F&&(Y|=16),d==="UNIX"?(X=798,Y|=u(b.unixPermissions,F)):(X=20,Y|=f(b.dosPermissions)),P=j.getUTCHours(),P=P<<6,P=P|j.getUTCMinutes(),P=P<<5,P=P|j.getUTCSeconds()/2,M=j.getUTCFullYear()-1980,M=M<<4,M=M|j.getUTCMonth()+1,M=M<<5,M=M|j.getUTCDate(),D&&(B=p(1,1)+p(l(L),4)+R,N+="up"+p(B.length,2)+B),C&&(U=p(1,1)+p(l(O),4)+I,N+="uc"+p(U.length,2)+U);var ie="";ie+=`
\0`,ie+=p(G,2),ie+=T.magic,ie+=p(P,2),ie+=p(M,2),ie+=p(V.crc32,4),ie+=p(V.compressedSize,4),ie+=p(V.uncompressedSize,4),ie+=p(L.length,2),ie+=p(N.length,2);var he=h.LOCAL_FILE_HEADER+ie+L+N,de=h.CENTRAL_FILE_HEADER+p(X,2)+ie+p(O.length,2)+"\0\0\0\0"+p(Y,4)+p(y,4)+L+N+O;return{fileRecord:he,dirRecord:de}},E=function(m,c,v,y,d){var x="",b=n.transformTo("string",d(y));return x=h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(m,2)+p(m,2)+p(c,4)+p(v,4)+p(b.length,2)+b,x},S=function(m){var c="";return c=h.DATA_DESCRIPTOR+p(m.crc32,4)+p(m.compressedSize,4)+p(m.uncompressedSize,4),c};function _(m,c,v,y){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=v,this.encodeFileName=y,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(_,a),_.prototype.push=function(m){var c=m.meta.percent||0,v=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,a.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:v?(c+100*(v-y-1))/v:100}}))},_.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var c=this.streamFiles&&!m.file.dir;if(c){var v=g(m,c,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(m){this.accumulate=!1;var c=this.streamFiles&&!m.file.dir,v=g(m,c,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),c)this.push({data:S(m),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var m=this.bytesWritten,c=0;c<this.dirRecords.length;c++)this.push({data:this.dirRecords[c],meta:{percent:100}});var v=this.bytesWritten-m,y=E(this.dirRecords.length,v,m,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(m){this._sources.push(m);var c=this;return m.on("data",function(v){c.processChunk(v)}),m.on("end",function(){c.closedSource(c.previous.streamInfo),c._sources.length?c.prepareNextSource():c.end()}),m.on("error",function(v){c.error(v)}),this},_.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},_.prototype.error=function(m){var c=this._sources;if(!a.prototype.error.call(this,m))return!1;for(var v=0;v<c.length;v++)try{c[v].error(m)}catch(y){}return!0},_.prototype.lock=function(){a.prototype.lock.call(this);for(var m=this._sources,c=0;c<m.length;c++)m[c].lock()},i.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,i,t){var n=r("../compressions"),a=r("./ZipFileWorker"),o=function(l,h){var p=l||h,u=n[p];if(!u)throw new Error(p+" is not a valid compression method !");return u};t.generateWorker=function(l,h,p){var u=new a(h.streamFiles,p,h.platform,h.encodeFileName),f=0;try{l.forEach(function(g,E){f++;var S=o(E.options.compression,h.compression),_=E.options.compressionOptions||h.compressionOptions||{},m=E.dir,c=E.date;E._compressWorker(S,_).withStreamInfo("file",{name:g,dir:m,date:c,comment:E.comment||"",unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(g){u.error(g)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,i,t){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new n;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}n.prototype=r("./object"),n.prototype.loadAsync=r("./load"),n.support=r("./support"),n.defaults=r("./defaults"),n.version="3.7.1",n.loadAsync=function(a,o){return new n().loadAsync(a,o)},n.external=r("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,i,t){var n=r("./utils"),a=r("./external"),o=r("./utf8"),l=r("./zipEntries"),h=r("./stream/Crc32Probe"),p=r("./nodejsUtils");function u(f){return new a.Promise(function(g,E){var S=f.decompressed.getContentWorker().pipe(new h);S.on("error",function(_){E(_)}).on("end",function(){S.streamInfo.crc32!==f.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(f,g){var E=this;return g=n.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),p.isNode&&p.isStream(f)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",f,!0,g.optimizedBinaryString,g.base64).then(function(S){var _=new l(g);return _.load(S),_}).then(function(_){var m=[a.Promise.resolve(_)],c=_.files;if(g.checkCRC32)for(var v=0;v<c.length;v++)m.push(u(c[v]));return a.Promise.all(m)}).then(function(_){for(var m=_.shift(),c=m.files,v=0;v<c.length;v++){var y=c[v];E.file(y.fileNameStr,y.decompressed,{binary:!0,optimizedBinaryString:!0,date:y.date,dir:y.dir,comment:y.fileCommentStr.length?y.fileCommentStr:null,unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions,createFolders:g.createFolders})}return m.zipComment.length&&(E.comment=m.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker");function o(l,h){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(h)}n.inherits(o,a),o.prototype._bindStream=function(l){var h=this;this._stream=l,l.pause(),l.on("data",function(p){h.push({data:p,meta:{percent:0}})}).on("error",function(p){h.isPaused?this.generatedError=p:h.error(p)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,i,t){var n=r("readable-stream").Readable,a=r("../utils");a.inherits(o,n);function o(l,h,p){n.call(this,h),this._helper=l;var u=this;l.on("data",function(f,g){u.push(f)||u._helper.pause(),p&&p(g)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,i,t){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,a);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,a)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var a=new Buffer(n);return a.fill(0),a},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(r,i,t){var n=r("./utf8"),a=r("./utils"),o=r("./stream/GenericWorker"),l=r("./stream/StreamHelper"),h=r("./defaults"),p=r("./compressedObject"),u=r("./zipObject"),f=r("./generate"),g=r("./nodejsUtils"),E=r("./nodejs/NodejsStreamInputAdapter"),S=function(d,x,b){var T=a.getTypeOf(x),A,L=a.extend(b||{},h);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(d=m(d)),L.createFolders&&(A=_(d))&&c.call(this,A,!0);var R=T==="string"&&L.binary===!1&&L.base64===!1;(!b||typeof b.binary=="undefined")&&(L.binary=!R);var w=x instanceof p&&x.uncompressedSize===0;(w||L.dir||!x||x.length===0)&&(L.base64=!1,L.binary=!0,x="",L.compression="STORE",T="string");var O=null;x instanceof p||x instanceof o?O=x:g.isNode&&g.isStream(x)?O=new E(d,x):O=a.prepareContent(d,x,L.binary,L.optimizedBinaryString,L.base64);var I=new u(d,O,L);this.files[d]=I},_=function(d){d.slice(-1)==="/"&&(d=d.substring(0,d.length-1));var x=d.lastIndexOf("/");return x>0?d.substring(0,x):""},m=function(d){return d.slice(-1)!=="/"&&(d+="/"),d},c=function(d,x){return x=typeof x!="undefined"?x:h.createFolders,d=m(d),this.files[d]||S.call(this,d,null,{dir:!0,createFolders:x}),this.files[d]};function v(d){return Object.prototype.toString.call(d)==="[object RegExp]"}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(d){var x,b,T;for(x in this.files)T=this.files[x],b=x.slice(this.root.length,x.length),b&&x.slice(0,this.root.length)===this.root&&d(b,T)},filter:function(d){var x=[];return this.forEach(function(b,T){d(b,T)&&x.push(T)}),x},file:function(d,x,b){if(arguments.length===1)if(v(d)){var T=d;return this.filter(function(L,R){return!R.dir&&T.test(L)})}else{var A=this.files[this.root+d];return A&&!A.dir?A:null}else d=this.root+d,S.call(this,d,x,b);return this},folder:function(d){if(!d)return this;if(v(d))return this.filter(function(A,L){return L.dir&&d.test(A)});var x=this.root+d,b=c.call(this,x),T=this.clone();return T.root=b.name,T},remove:function(d){d=this.root+d;var x=this.files[d];if(x||(d.slice(-1)!=="/"&&(d+="/"),x=this.files[d]),x&&!x.dir)delete this.files[d];else for(var b=this.filter(function(A,L){return L.name.slice(0,d.length)===d}),T=0;T<b.length;T++)delete this.files[b[T].name];return this},generate:function(d){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(d){var x,b={};try{if(b=a.extend(d||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),b.type=b.type.toLowerCase(),b.compression=b.compression.toUpperCase(),b.type==="binarystring"&&(b.type="string"),!b.type)throw new Error("No output type specified.");a.checkSupport(b.type),(b.platform==="darwin"||b.platform==="freebsd"||b.platform==="linux"||b.platform==="sunos")&&(b.platform="UNIX"),b.platform==="win32"&&(b.platform="DOS");var T=b.comment||this.comment||"";x=f.generateWorker(this,b,T)}catch(A){x=new o("error"),x.error(A)}return new l(x,b.type||"string",b.mimeType)},generateAsync:function(d,x){return this.generateInternalStream(d).accumulate(x)},generateNodeStream:function(d,x){return d=d||{},d.type||(d.type="nodebuffer"),this.generateInternalStream(d).toNodejsStream(x)}};i.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,i,t){i.exports=r("stream")},{stream:void 0}],17:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(l){n.call(this,l);for(var h=0;h<this.data.length;h++)l[h]=l[h]&255}a.inherits(o,n),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var h=l.charCodeAt(0),p=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),g=this.length-4;g>=0;--g)if(this.data[g]===h&&this.data[g+1]===p&&this.data[g+2]===u&&this.data[g+3]===f)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var h=l.charCodeAt(0),p=l.charCodeAt(1),u=l.charCodeAt(2),f=l.charCodeAt(3),g=this.readData(4);return h===g[0]&&p===g[1]&&u===g[2]&&f===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,h},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,i,t){var n=r("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(o){},readInt:function(o){var l=0,h;for(this.checkOffset(o),h=this.index+o-1;h>=this.index;h--)l=(l<<8)+this.byteAt(h);return this.index+=o,l},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(o){},lastIndexOfSignature:function(o){},readAndCheckSignature:function(o){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(r,i,t){var n=r("./Uint8ArrayReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.readData=function(l){this.checkOffset(l);var h=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,h},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var h=this.readData(4);return l===h},o.prototype.readData=function(l){this.checkOffset(l);var h=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,h},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,i,t){var n=r("./ArrayReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,h},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,i,t){var n=r("../utils"),a=r("../support"),o=r("./ArrayReader"),l=r("./StringReader"),h=r("./NodeBufferReader"),p=r("./Uint8ArrayReader");i.exports=function(u){var f=n.getTypeOf(u);return n.checkSupport(f),f==="string"&&!a.uint8array?new l(u):f==="nodebuffer"?new h(u):a.uint8array?new p(n.transformTo("uint8array",u)):new o(n.transformTo("array",u))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,i,t){t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,i,t){var n=r("./GenericWorker"),a=r("../utils");function o(l){n.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,n),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,i,t){var n=r("./GenericWorker"),a=r("../crc32"),o=r("../utils");function l(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,n),l.prototype.processChunk=function(h){this.streamInfo.crc32=a(h.data,this.streamInfo.crc32||0),this.push(h)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}n.inherits(o,a),o.prototype.processChunk=function(l){if(l){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+l.data.length}a.prototype.processChunk.call(this,l)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker"),o=16*1024;function l(h){a.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(u){p.dataIsReady=!0,p.data=u,p.max=u&&u.length||0,p.type=n.getTypeOf(u),p.isPaused||p._tickAndRepeat()},function(u){p.error(u)})}n.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=o,p=null,u=Math.min(this.max,this.index+h);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,u);break;case"uint8array":p=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":p=this.data.slice(this.index,u);break}return this.index=u,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,i,t){function n(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)!this.extraStreamInfo.hasOwnProperty(a)||(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=n},{}],29:[function(r,i,t){var n=r("../utils"),a=r("./ConvertWorker"),o=r("./GenericWorker"),l=r("../base64"),h=r("../support"),p=r("../external"),u=null;if(h.nodestream)try{u=r("../nodejs/NodejsStreamOutputAdapter")}catch(_){}function f(_,m,c){switch(_){case"blob":return n.newBlob(n.transformTo("arraybuffer",m),c);case"base64":return l.encode(m);default:return n.transformTo(_,m)}}function g(_,m){var c,v=0,y=null,d=0;for(c=0;c<m.length;c++)d+=m[c].length;switch(_){case"string":return m.join("");case"array":return Array.prototype.concat.apply([],m);case"uint8array":for(y=new Uint8Array(d),c=0;c<m.length;c++)y.set(m[c],v),v+=m[c].length;return y;case"nodebuffer":return Buffer.concat(m);default:throw new Error("concat : unsupported type '"+_+"'")}}function E(_,m){return new p.Promise(function(c,v){var y=[],d=_._internalType,x=_._outputType,b=_._mimeType;_.on("data",function(T,A){y.push(T),m&&m(A)}).on("error",function(T){y=[],v(T)}).on("end",function(){try{var T=f(x,g(d,y),b);c(T)}catch(A){v(A)}y=[]}).resume()})}function S(_,m,c){var v=m;switch(m){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=m,this._mimeType=c,n.checkSupport(v),this._worker=_.pipe(new a(v)),_.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}S.prototype={accumulate:function(_){return E(this,_)},on:function(_,m){var c=this;return _==="data"?this._worker.on(_,function(v){m.call(c,v.data,v.meta)}):this._worker.on(_,function(){n.delay(m,arguments,c)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},_)}},i.exports=S},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,i,t){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",t.nodebuffer=typeof Buffer!="undefined",t.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")t.blob=!1;else{var n=new ArrayBuffer(0);try{t.blob=new Blob([n],{type:"application/zip"}).size===0}catch(l){try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(n),t.blob=o.getBlob("application/zip").size===0}catch(h){t.blob=!1}}}try{t.nodestream=!!r("readable-stream").Readable}catch(l){t.nodestream=!1}},{"readable-stream":16}],31:[function(r,i,t){for(var n=r("./utils"),a=r("./support"),o=r("./nodejsUtils"),l=r("./stream/GenericWorker"),h=new Array(256),p=0;p<256;p++)h[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;h[254]=h[254]=1;var u=function(_){var m,c,v,y,d,x=_.length,b=0;for(y=0;y<x;y++)c=_.charCodeAt(y),(c&64512)==55296&&y+1<x&&(v=_.charCodeAt(y+1),(v&64512)==56320&&(c=65536+(c-55296<<10)+(v-56320),y++)),b+=c<128?1:c<2048?2:c<65536?3:4;for(a.uint8array?m=new Uint8Array(b):m=new Array(b),d=0,y=0;d<b;y++)c=_.charCodeAt(y),(c&64512)==55296&&y+1<x&&(v=_.charCodeAt(y+1),(v&64512)==56320&&(c=65536+(c-55296<<10)+(v-56320),y++)),c<128?m[d++]=c:c<2048?(m[d++]=192|c>>>6,m[d++]=128|c&63):c<65536?(m[d++]=224|c>>>12,m[d++]=128|c>>>6&63,m[d++]=128|c&63):(m[d++]=240|c>>>18,m[d++]=128|c>>>12&63,m[d++]=128|c>>>6&63,m[d++]=128|c&63);return m},f=function(_,m){var c;for(m=m||_.length,m>_.length&&(m=_.length),c=m-1;c>=0&&(_[c]&192)==128;)c--;return c<0||c===0?m:c+h[_[c]]>m?c:m},g=function(_){var m,c,v,y,d=_.length,x=new Array(d*2);for(c=0,m=0;m<d;){if(v=_[m++],v<128){x[c++]=v;continue}if(y=h[v],y>4){x[c++]=65533,m+=y-1;continue}for(v&=y===2?31:y===3?15:7;y>1&&m<d;)v=v<<6|_[m++]&63,y--;if(y>1){x[c++]=65533;continue}v<65536?x[c++]=v:(v-=65536,x[c++]=55296|v>>10&1023,x[c++]=56320|v&1023)}return x.length!==c&&(x.subarray?x=x.subarray(0,c):x.length=c),n.applyFromCharCode(x)};t.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):u(m)},t.utf8decode=function(m){return a.nodebuffer?n.transformTo("nodebuffer",m).toString("utf-8"):(m=n.transformTo(a.uint8array?"uint8array":"array",m),g(m))};function E(){l.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(E,l),E.prototype.processChunk=function(_){var m=n.transformTo(a.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var c=m;m=new Uint8Array(c.length+this.leftOver.length),m.set(this.leftOver,0),m.set(c,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var v=f(m),y=m;v!==m.length&&(a.uint8array?(y=m.subarray(0,v),this.leftOver=m.subarray(v,m.length)):(y=m.slice(0,v),this.leftOver=m.slice(v,m.length))),this.push({data:t.utf8decode(y),meta:_.meta})},E.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=E;function S(){l.call(this,"utf-8 encode")}n.inherits(S,l),S.prototype.processChunk=function(_){this.push({data:t.utf8encode(_.data),meta:_.meta})},t.Utf8EncodeWorker=S},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,i,t){var n=r("./support"),a=r("./base64"),o=r("./nodejsUtils"),l=r("set-immediate-shim"),h=r("./external");function p(m){var c=null;return n.uint8array?c=new Uint8Array(m.length):c=new Array(m.length),f(m,c)}t.newBlob=function(m,c){t.checkSupport("blob");try{return new Blob([m],{type:c})}catch(d){try{var v=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,y=new v;return y.append(m),y.getBlob(c)}catch(x){throw new Error("Bug : can't construct the Blob.")}}};function u(m){return m}function f(m,c){for(var v=0;v<m.length;++v)c[v]=m.charCodeAt(v)&255;return c}var g={stringifyByChunk:function(m,c,v){var y=[],d=0,x=m.length;if(x<=v)return String.fromCharCode.apply(null,m);for(;d<x;)c==="array"||c==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(d,Math.min(d+v,x)))):y.push(String.fromCharCode.apply(null,m.subarray(d,Math.min(d+v,x)))),d+=v;return y.join("")},stringifyByChar:function(m){for(var c="",v=0;v<m.length;v++)c+=String.fromCharCode(m[v]);return c},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(m){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch(m){return!1}}()}};function E(m){var c=65536,v=t.getTypeOf(m),y=!0;if(v==="uint8array"?y=g.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=g.applyCanBeUsed.nodebuffer),y)for(;c>1;)try{return g.stringifyByChunk(m,v,c)}catch(d){c=Math.floor(c/2)}return g.stringifyByChar(m)}t.applyFromCharCode=E;function S(m,c){for(var v=0;v<m.length;v++)c[v]=m[v];return c}var _={};_.string={string:u,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return _.string.uint8array(m).buffer},uint8array:function(m){return f(m,new Uint8Array(m.length))},nodebuffer:function(m){return f(m,o.allocBuffer(m.length))}},_.array={string:E,array:u,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return o.newBufferFrom(m)}},_.arraybuffer={string:function(m){return E(new Uint8Array(m))},array:function(m){return S(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:u,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return o.newBufferFrom(new Uint8Array(m))}},_.uint8array={string:E,array:function(m){return S(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:u,nodebuffer:function(m){return o.newBufferFrom(m)}},_.nodebuffer={string:E,array:function(m){return S(m,new Array(m.length))},arraybuffer:function(m){return _.nodebuffer.uint8array(m).buffer},uint8array:function(m){return S(m,new Uint8Array(m.length))},nodebuffer:u},t.transformTo=function(m,c){if(c||(c=""),!m)return c;t.checkSupport(m);var v=t.getTypeOf(c),y=_[v][m](c);return y},t.getTypeOf=function(m){if(typeof m=="string")return"string";if(Object.prototype.toString.call(m)==="[object Array]")return"array";if(n.nodebuffer&&o.isBuffer(m))return"nodebuffer";if(n.uint8array&&m instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&m instanceof ArrayBuffer)return"arraybuffer"},t.checkSupport=function(m){var c=n[m.toLowerCase()];if(!c)throw new Error(m+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(m){var c="",v,y;for(y=0;y<(m||"").length;y++)v=m.charCodeAt(y),c+="\\x"+(v<16?"0":"")+v.toString(16).toUpperCase();return c},t.delay=function(m,c,v){l(function(){m.apply(v||null,c||[])})},t.inherits=function(m,c){var v=function(){};v.prototype=c.prototype,m.prototype=new v},t.extend=function(){var m={},c,v;for(c=0;c<arguments.length;c++)for(v in arguments[c])arguments[c].hasOwnProperty(v)&&typeof m[v]=="undefined"&&(m[v]=arguments[c][v]);return m},t.prepareContent=function(m,c,v,y,d){var x=h.Promise.resolve(c).then(function(b){var T=n.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1);return T&&typeof FileReader!="undefined"?new h.Promise(function(A,L){var R=new FileReader;R.onload=function(w){A(w.target.result)},R.onerror=function(w){L(w.target.error)},R.readAsArrayBuffer(b)}):b});return x.then(function(b){var T=t.getTypeOf(b);return T?(T==="arraybuffer"?b=t.transformTo("uint8array",b):T==="string"&&(d?b=a.decode(b):v&&y!==!0&&(b=p(b))),b):h.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./signature"),l=r("./zipEntry");r("./utf8");var h=r("./support");function p(u){this.files=[],this.loadOptions=u}p.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(f)+", expected "+a.pretty(u)+")")}},isSignature:function(u,f){var g=this.reader.index;this.reader.setIndex(u);var E=this.reader.readString(4),S=E===f;return this.reader.setIndex(g),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),f=h.uint8array?"uint8array":"array",g=a.transformTo(f,u);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u=this.zip64EndOfCentralSize-44,f=0,g,E,S;f<u;)g=this.reader.readInt(2),E=this.reader.readInt(4),S=this.reader.readData(E),this.zip64ExtensibleData[g]={id:g,length:E,value:S}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,f;for(u=0;u<this.files.length;u++)f=this.files[u],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)u=new l({zip64:this.zip64},this.loadOptions),u.readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(u<0){var f=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw f?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(u);var g=u;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,u=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),u<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var S=g-E;if(S>0)this.isSignature(g,o.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(u){this.reader=n(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./compressedObject"),l=r("./crc32"),h=r("./utf8"),p=r("./compressions"),u=r("./support"),f=0,g=3,E=function(_){for(var m in p)if(!!p.hasOwnProperty(m)&&p[m].magic===_)return p[m];return null};function S(_,m){this.options=_,this.loadOptions=m}S.prototype={isEncrypted:function(){return(this.bitFlag&1)==1},useUTF8:function(){return(this.bitFlag&2048)==2048},readLocalPart:function(_){var m,c;if(_.skip(22),this.fileNameLength=_.readInt(2),c=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(m=E(this.compressionMethod),m===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var m=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(m),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),_===f&&(this.dosPermissions=this.externalFileAttributes&63),_===g&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(_){if(!!this.extraFields[1]){var m=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(_){var m=_.index+this.extraFieldsLength,c,v,y;for(this.extraFields||(this.extraFields={});_.index+4<m;)c=_.readInt(2),v=_.readInt(2),y=_.readData(v),this.extraFields[c]={id:c,length:v,value:y};_.setIndex(m)},handleUTF8:function(){var _=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var c=a.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var y=a.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var m=n(_.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:h.utf8decode(m.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var m=n(_.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:h.utf8decode(m.readData(_.length-5))}return null}},i.exports=S},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,i,t){var n=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),o=r("./utf8"),l=r("./compressedObject"),h=r("./stream/GenericWorker"),p=function(E,S,_){this.name=E,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=S,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}};p.prototype={internalStream:function(E){var S=null,_="string";try{if(!E)throw new Error("No output type specified.");_=E.toLowerCase();var m=_==="string"||_==="text";(_==="binarystring"||_==="text")&&(_="string"),S=this._decompressWorker();var c=!this._dataBinary;c&&!m&&(S=S.pipe(new o.Utf8EncodeWorker)),!c&&m&&(S=S.pipe(new o.Utf8DecodeWorker))}catch(v){S=new h("error"),S.error(v)}return new n(S,_,"")},async:function(E,S){return this.internalStream(E).accumulate(S)},nodeStream:function(E,S){return this.internalStream(E||"nodebuffer").toNodejsStream(S)},_compressWorker:function(E,S){if(this._data instanceof l&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(_,E,S)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<u.length;g++)p.prototype[u[g]]=f;i.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var l=0,h=new a(E),p=n.document.createTextNode("");h.observe(p,{characterData:!0}),o=function(){p.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var u=new n.MessageChannel;u.port1.onmessage=E,o=function(){u.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var _=n.document.createElement("script");_.onreadystatechange=function(){E(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},n.document.documentElement.appendChild(_)}:o=function(){setTimeout(E,0)};var f,g=[];function E(){f=!0;for(var _,m,c=g.length;c;){for(m=g,g=[],_=-1;++_<c;)m[_]();c=g.length}f=!1}i.exports=S;function S(_){g.push(_)===1&&!f&&o()}}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(r,i,t){var n=r("immediate");function a(){}var o={},l=["REJECTED"],h=["FULFILLED"],p=["PENDING"];i.exports=u;function u(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,d!==a&&S(this,d)}u.prototype.finally=function(d){if(typeof d!="function")return this;var x=this.constructor;return this.then(b,T);function b(A){function L(){return A}return x.resolve(d()).then(L)}function T(A){function L(){throw A}return x.resolve(d()).then(L)}},u.prototype.catch=function(d){return this.then(null,d)},u.prototype.then=function(d,x){if(typeof d!="function"&&this.state===h||typeof x!="function"&&this.state===l)return this;var b=new this.constructor(a);if(this.state!==p){var T=this.state===h?d:x;g(b,T,this.outcome)}else this.queue.push(new f(b,d,x));return b};function f(d,x,b){this.promise=d,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(d){o.resolve(this.promise,d)},f.prototype.otherCallFulfilled=function(d){g(this.promise,this.onFulfilled,d)},f.prototype.callRejected=function(d){o.reject(this.promise,d)},f.prototype.otherCallRejected=function(d){g(this.promise,this.onRejected,d)};function g(d,x,b){n(function(){var T;try{T=x(b)}catch(A){return o.reject(d,A)}T===d?o.reject(d,new TypeError("Cannot resolve promise with itself")):o.resolve(d,T)})}o.resolve=function(d,x){var b=_(E,x);if(b.status==="error")return o.reject(d,b.value);var T=b.value;if(T)S(d,T);else{d.state=h,d.outcome=x;for(var A=-1,L=d.queue.length;++A<L;)d.queue[A].callFulfilled(x)}return d},o.reject=function(d,x){d.state=l,d.outcome=x;for(var b=-1,T=d.queue.length;++b<T;)d.queue[b].callRejected(x);return d};function E(d){var x=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof x=="function")return function(){x.apply(d,arguments)}}function S(d,x){var b=!1;function T(w){b||(b=!0,o.reject(d,w))}function A(w){b||(b=!0,o.resolve(d,w))}function L(){x(A,T)}var R=_(L);R.status==="error"&&T(R.value)}function _(d,x){var b={};try{b.value=d(x),b.status="success"}catch(T){b.status="error",b.value=T}return b}u.resolve=m;function m(d){return d instanceof this?d:o.resolve(new this(a),d)}u.reject=c;function c(d){var x=new this(a);return o.reject(x,d)}u.all=v;function v(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=d.length,T=!1;if(!b)return this.resolve([]);for(var A=new Array(b),L=0,R=-1,w=new this(a);++R<b;)O(d[R],R);return w;function O(I,D){x.resolve(I).then(C,function(P){T||(T=!0,o.reject(w,P))});function C(P){A[D]=P,++L===b&&!T&&(T=!0,o.resolve(w,A))}}}u.race=y;function y(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=d.length,T=!1;if(!b)return this.resolve([]);for(var A=-1,L=new this(a);++A<b;)R(d[A]);return L;function R(w){x.resolve(w).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{immediate:36}],38:[function(r,i,t){var n=r("./lib/utils/common").assign,a=r("./lib/deflate"),o=r("./lib/inflate"),l=r("./lib/zlib/constants"),h={};n(h,a,o,l),i.exports=h},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,i,t){var n=r("./zlib/deflate"),a=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/messages"),h=r("./zlib/zstream"),p=Object.prototype.toString,u=0,f=4,g=0,E=1,S=2,_=-1,m=0,c=8;function v(b){if(!(this instanceof v))return new v(b);this.options=a.assign({level:_,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},b||{});var T=this.options;T.raw&&T.windowBits>0?T.windowBits=-T.windowBits:T.gzip&&T.windowBits>0&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var A=n.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(A!==g)throw new Error(l[A]);if(T.header&&n.deflateSetHeader(this.strm,T.header),T.dictionary){var L;if(typeof T.dictionary=="string"?L=o.string2buf(T.dictionary):p.call(T.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(T.dictionary):L=T.dictionary,A=n.deflateSetDictionary(this.strm,L),A!==g)throw new Error(l[A]);this._dict_set=!0}}v.prototype.push=function(b,T){var A=this.strm,L=this.options.chunkSize,R,w;if(this.ended)return!1;w=T===~~T?T:T===!0?f:u,typeof b=="string"?A.input=o.string2buf(b):p.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(L),A.next_out=0,A.avail_out=L),R=n.deflate(A,w),R!==E&&R!==g)return this.onEnd(R),this.ended=!0,!1;(A.avail_out===0||A.avail_in===0&&(w===f||w===S))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(A.output,A.next_out))):this.onData(a.shrinkBuf(A.output,A.next_out)))}while((A.avail_in>0||A.avail_out===0)&&R!==E);return w===f?(R=n.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===g):(w===S&&(this.onEnd(g),A.avail_out=0),!0)},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function y(b,T){var A=new v(T);if(A.push(b,!0),A.err)throw A.msg||l[A.err];return A.result}function d(b,T){return T=T||{},T.raw=!0,y(b,T)}function x(b,T){return T=T||{},T.gzip=!0,y(b,T)}t.Deflate=v,t.deflate=y,t.deflateRaw=d,t.gzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,i,t){var n=r("./zlib/inflate"),a=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/constants"),h=r("./zlib/messages"),p=r("./zlib/zstream"),u=r("./zlib/gzheader"),f=Object.prototype.toString;function g(_){if(!(this instanceof g))return new g(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(_&&_.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var c=n.inflateInit2(this.strm,m.windowBits);if(c!==l.Z_OK)throw new Error(h[c]);this.header=new u,n.inflateGetHeader(this.strm,this.header)}g.prototype.push=function(_,m){var c=this.strm,v=this.options.chunkSize,y=this.options.dictionary,d,x,b,T,A,L,R=!1;if(this.ended)return!1;x=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof _=="string"?c.input=o.binstring2buf(_):f.call(_)==="[object ArrayBuffer]"?c.input=new Uint8Array(_):c.input=_,c.next_in=0,c.avail_in=c.input.length;do{if(c.avail_out===0&&(c.output=new a.Buf8(v),c.next_out=0,c.avail_out=v),d=n.inflate(c,l.Z_NO_FLUSH),d===l.Z_NEED_DICT&&y&&(typeof y=="string"?L=o.string2buf(y):f.call(y)==="[object ArrayBuffer]"?L=new Uint8Array(y):L=y,d=n.inflateSetDictionary(this.strm,L)),d===l.Z_BUF_ERROR&&R===!0&&(d=l.Z_OK,R=!1),d!==l.Z_STREAM_END&&d!==l.Z_OK)return this.onEnd(d),this.ended=!0,!1;c.next_out&&(c.avail_out===0||d===l.Z_STREAM_END||c.avail_in===0&&(x===l.Z_FINISH||x===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(b=o.utf8border(c.output,c.next_out),T=c.next_out-b,A=o.buf2string(c.output,b),c.next_out=T,c.avail_out=v-T,T&&a.arraySet(c.output,c.output,b,T,0),this.onData(A)):this.onData(a.shrinkBuf(c.output,c.next_out))),c.avail_in===0&&c.avail_out===0&&(R=!0)}while((c.avail_in>0||c.avail_out===0)&&d!==l.Z_STREAM_END);return d===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(d=n.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===l.Z_OK):(x===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),c.avail_out=0),!0)},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function E(_,m){var c=new g(m);if(c.push(_,!0),c.err)throw c.msg||h[c.err];return c.result}function S(_,m){return m=m||{},m.raw=!0,E(_,m)}t.Inflate=g,t.inflate=E,t.inflateRaw=S,t.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";t.assign=function(l){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var p=h.shift();if(!!p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var u in p)p.hasOwnProperty(u)&&(l[u]=p[u])}}return l},t.shrinkBuf=function(l,h){return l.length===h?l:l.subarray?l.subarray(0,h):(l.length=h,l)};var a={arraySet:function(l,h,p,u,f){if(h.subarray&&l.subarray){l.set(h.subarray(p,p+u),f);return}for(var g=0;g<u;g++)l[f+g]=h[p+g]},flattenChunks:function(l){var h,p,u,f,g,E;for(u=0,h=0,p=l.length;h<p;h++)u+=l[h].length;for(E=new Uint8Array(u),f=0,h=0,p=l.length;h<p;h++)g=l[h],E.set(g,f),f+=g.length;return E}},o={arraySet:function(l,h,p,u,f){for(var g=0;g<u;g++)l[f+g]=h[p+g]},flattenChunks:function(l){return[].concat.apply([],l)}};t.setTyped=function(l){l?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},{}],42:[function(r,i,t){var n=r("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(u){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){o=!1}for(var l=new n.Buf8(256),h=0;h<256;h++)l[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;l[254]=l[254]=1,t.string2buf=function(u){var f,g,E,S,_,m=u.length,c=0;for(S=0;S<m;S++)g=u.charCodeAt(S),(g&64512)==55296&&S+1<m&&(E=u.charCodeAt(S+1),(E&64512)==56320&&(g=65536+(g-55296<<10)+(E-56320),S++)),c+=g<128?1:g<2048?2:g<65536?3:4;for(f=new n.Buf8(c),_=0,S=0;_<c;S++)g=u.charCodeAt(S),(g&64512)==55296&&S+1<m&&(E=u.charCodeAt(S+1),(E&64512)==56320&&(g=65536+(g-55296<<10)+(E-56320),S++)),g<128?f[_++]=g:g<2048?(f[_++]=192|g>>>6,f[_++]=128|g&63):g<65536?(f[_++]=224|g>>>12,f[_++]=128|g>>>6&63,f[_++]=128|g&63):(f[_++]=240|g>>>18,f[_++]=128|g>>>12&63,f[_++]=128|g>>>6&63,f[_++]=128|g&63);return f};function p(u,f){if(f<65537&&(u.subarray&&o||!u.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(u,f));for(var g="",E=0;E<f;E++)g+=String.fromCharCode(u[E]);return g}t.buf2binstring=function(u){return p(u,u.length)},t.binstring2buf=function(u){for(var f=new n.Buf8(u.length),g=0,E=f.length;g<E;g++)f[g]=u.charCodeAt(g);return f},t.buf2string=function(u,f){var g,E,S,_,m=f||u.length,c=new Array(m*2);for(E=0,g=0;g<m;){if(S=u[g++],S<128){c[E++]=S;continue}if(_=l[S],_>4){c[E++]=65533,g+=_-1;continue}for(S&=_===2?31:_===3?15:7;_>1&&g<m;)S=S<<6|u[g++]&63,_--;if(_>1){c[E++]=65533;continue}S<65536?c[E++]=S:(S-=65536,c[E++]=55296|S>>10&1023,c[E++]=56320|S&1023)}return p(c,E)},t.utf8border=function(u,f){var g;for(f=f||u.length,f>u.length&&(f=u.length),g=f-1;g>=0&&(u[g]&192)==128;)g--;return g<0||g===0?f:g+l[u[g]]>f?g:f}},{"./common":41}],43:[function(r,i,t){function n(a,o,l,h){for(var p=a&65535|0,u=a>>>16&65535|0,f=0;l!==0;){f=l>2e3?2e3:l,l-=f;do p=p+o[h++]|0,u=u+p|0;while(--f);p%=65521,u%=65521}return p|u<<16|0}i.exports=n},{}],44:[function(r,i,t){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,i,t){function n(){for(var l,h=[],p=0;p<256;p++){l=p;for(var u=0;u<8;u++)l=l&1?3988292384^l>>>1:l>>>1;h[p]=l}return h}var a=n();function o(l,h,p,u){var f=a,g=u+p;l^=-1;for(var E=u;E<g;E++)l=l>>>8^f[(l^h[E])&255];return l^-1}i.exports=o},{}],46:[function(r,i,t){var n=r("../utils/common"),a=r("./trees"),o=r("./adler32"),l=r("./crc32"),h=r("./messages"),p=0,u=1,f=3,g=4,E=5,S=0,_=1,m=-2,c=-3,v=-5,y=-1,d=1,x=2,b=3,T=4,A=0,L=2,R=8,w=9,O=15,I=8,D=29,C=256,P=C+1+D,M=30,N=19,B=2*P+1,U=15,F=3,j=258,V=j+F+1,G=32,Y=42,X=69,ie=73,he=91,de=103,Ae=113,pe=666,le=1,Ie=2,Ce=3,Ue=4,Me=3;function ze(k,oe){return k.msg=h[oe],oe}function Ge(k){return(k<<1)-(k>4?9:0)}function $e(k){for(var oe=k.length;--oe>=0;)k[oe]=0}function He(k){var oe=k.state,fe=oe.pending;fe>k.avail_out&&(fe=k.avail_out),fe!==0&&(n.arraySet(k.output,oe.pending_buf,oe.pending_out,fe,k.next_out),k.next_out+=fe,oe.pending_out+=fe,k.total_out+=fe,k.avail_out-=fe,oe.pending-=fe,oe.pending===0&&(oe.pending_out=0))}function Fe(k,oe){a._tr_flush_block(k,k.block_start>=0?k.block_start:-1,k.strstart-k.block_start,oe),k.block_start=k.strstart,He(k.strm)}function Se(k,oe){k.pending_buf[k.pending++]=oe}function Xe(k,oe){k.pending_buf[k.pending++]=oe>>>8&255,k.pending_buf[k.pending++]=oe&255}function st(k,oe,fe,z){var J=k.avail_in;return J>z&&(J=z),J===0?0:(k.avail_in-=J,n.arraySet(oe,k.input,k.next_in,J,fe),k.state.wrap===1?k.adler=o(k.adler,oe,J,fe):k.state.wrap===2&&(k.adler=l(k.adler,oe,J,fe)),k.next_in+=J,k.total_in+=J,J)}function et(k,oe){var fe=k.max_chain_length,z=k.strstart,J,ae,We=k.prev_length,ke=k.nice_match,Ne=k.strstart>k.w_size-V?k.strstart-(k.w_size-V):0,rt=k.window,nr=k.w_mask,vt=k.prev,at=k.strstart+j,At=rt[z+We-1],Pt=rt[z+We];k.prev_length>=k.good_match&&(fe>>=2),ke>k.lookahead&&(ke=k.lookahead);do if(J=oe,!(rt[J+We]!==Pt||rt[J+We-1]!==At||rt[J]!==rt[z]||rt[++J]!==rt[z+1])){z+=2,J++;do;while(rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&z<at);if(ae=j-(at-z),z=at-j,ae>We){if(k.match_start=oe,We=ae,ae>=ke)break;At=rt[z+We-1],Pt=rt[z+We]}}while((oe=vt[oe&nr])>Ne&&--fe!=0);return We<=k.lookahead?We:k.lookahead}function ot(k){var oe=k.w_size,fe,z,J,ae,We;do{if(ae=k.window_size-k.lookahead-k.strstart,k.strstart>=oe+(oe-V)){n.arraySet(k.window,k.window,oe,oe,0),k.match_start-=oe,k.strstart-=oe,k.block_start-=oe,z=k.hash_size,fe=z;do J=k.head[--fe],k.head[fe]=J>=oe?J-oe:0;while(--z);z=oe,fe=z;do J=k.prev[--fe],k.prev[fe]=J>=oe?J-oe:0;while(--z);ae+=oe}if(k.strm.avail_in===0)break;if(z=st(k.strm,k.window,k.strstart+k.lookahead,ae),k.lookahead+=z,k.lookahead+k.insert>=F)for(We=k.strstart-k.insert,k.ins_h=k.window[We],k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+F-1])&k.hash_mask,k.prev[We&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=We,We++,k.insert--,!(k.lookahead+k.insert<F)););}while(k.lookahead<V&&k.strm.avail_in!==0)}function nt(k,oe){var fe=65535;for(fe>k.pending_buf_size-5&&(fe=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ot(k),k.lookahead===0&&oe===p)return le;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var z=k.block_start+fe;if((k.strstart===0||k.strstart>=z)&&(k.lookahead=k.strstart-z,k.strstart=z,Fe(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-V&&(Fe(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):(k.strstart>k.block_start&&(Fe(k,!1),k.strm.avail_out===0),le)}function dt(k,oe){for(var fe,z;;){if(k.lookahead<V){if(ot(k),k.lookahead<V&&oe===p)return le;if(k.lookahead===0)break}if(fe=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),fe!==0&&k.strstart-fe<=k.w_size-V&&(k.match_length=et(k,fe)),k.match_length>=F)if(z=a._tr_tally(k,k.strstart-k.match_start,k.match_length-F),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=F){k.match_length--;do k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart;while(--k.match_length!=0);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else z=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(z&&(Fe(k,!1),k.strm.avail_out===0))return le}return k.insert=k.strstart<F-1?k.strstart:F-1,oe===g?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?le:Ie}function ne(k,oe){for(var fe,z,J;;){if(k.lookahead<V){if(ot(k),k.lookahead<V&&oe===p)return le;if(k.lookahead===0)break}if(fe=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=F-1,fe!==0&&k.prev_length<k.max_lazy_match&&k.strstart-fe<=k.w_size-V&&(k.match_length=et(k,fe),k.match_length<=5&&(k.strategy===d||k.match_length===F&&k.strstart-k.match_start>4096)&&(k.match_length=F-1)),k.prev_length>=F&&k.match_length<=k.prev_length){J=k.strstart+k.lookahead-F,z=a._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-F),k.lookahead-=k.prev_length-1,k.prev_length-=2;do++k.strstart<=J&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart);while(--k.prev_length!=0);if(k.match_available=0,k.match_length=F-1,k.strstart++,z&&(Fe(k,!1),k.strm.avail_out===0))return le}else if(k.match_available){if(z=a._tr_tally(k,0,k.window[k.strstart-1]),z&&Fe(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return le}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(z=a._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<F-1?k.strstart:F-1,oe===g?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?le:Ie}function Ee(k,oe){for(var fe,z,J,ae,We=k.window;;){if(k.lookahead<=j){if(ot(k),k.lookahead<=j&&oe===p)return le;if(k.lookahead===0)break}if(k.match_length=0,k.lookahead>=F&&k.strstart>0&&(J=k.strstart-1,z=We[J],z===We[++J]&&z===We[++J]&&z===We[++J])){ae=k.strstart+j;do;while(z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&J<ae);k.match_length=j-(ae-J),k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=F?(fe=a._tr_tally(k,1,k.match_length-F),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(fe=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),fe&&(Fe(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?le:Ie}function xe(k,oe){for(var fe;;){if(k.lookahead===0&&(ot(k),k.lookahead===0)){if(oe===p)return le;break}if(k.match_length=0,fe=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,fe&&(Fe(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Fe(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Fe(k,!1),k.strm.avail_out===0)?le:Ie}function we(k,oe,fe,z,J){this.good_length=k,this.max_lazy=oe,this.nice_length=fe,this.max_chain=z,this.func=J}var be;be=[new we(0,0,0,0,nt),new we(4,4,8,4,dt),new we(4,5,16,8,dt),new we(4,6,32,32,dt),new we(4,4,16,16,ne),new we(8,16,32,32,ne),new we(8,16,128,128,ne),new we(8,32,128,256,ne),new we(32,128,258,1024,ne),new we(32,258,258,4096,ne)];function je(k){k.window_size=2*k.w_size,$e(k.head),k.max_lazy_match=be[k.level].max_lazy,k.good_match=be[k.level].good_length,k.nice_match=be[k.level].nice_length,k.max_chain_length=be[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=F-1,k.match_available=0,k.ins_h=0}function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(B*2),this.dyn_dtree=new n.Buf16((2*M+1)*2),this.bl_tree=new n.Buf16((2*N+1)*2),$e(this.dyn_ltree),$e(this.dyn_dtree),$e(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*P+1),$e(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*P+1),$e(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(k){var oe;return!k||!k.state?ze(k,m):(k.total_in=k.total_out=0,k.data_type=L,oe=k.state,oe.pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?Y:Ae,k.adler=oe.wrap===2?0:1,oe.last_flush=p,a._tr_init(oe),S)}function _e(k){var oe=ce(k);return oe===S&&je(k.state),oe}function Re(k,oe){return!k||!k.state||k.state.wrap!==2?m:(k.state.gzhead=oe,S)}function Z(k,oe,fe,z,J,ae){if(!k)return m;var We=1;if(oe===y&&(oe=6),z<0?(We=0,z=-z):z>15&&(We=2,z-=16),J<1||J>w||fe!==R||z<8||z>15||oe<0||oe>9||ae<0||ae>T)return ze(k,m);z===8&&(z=9);var ke=new K;return k.state=ke,ke.strm=k,ke.wrap=We,ke.gzhead=null,ke.w_bits=z,ke.w_size=1<<ke.w_bits,ke.w_mask=ke.w_size-1,ke.hash_bits=J+7,ke.hash_size=1<<ke.hash_bits,ke.hash_mask=ke.hash_size-1,ke.hash_shift=~~((ke.hash_bits+F-1)/F),ke.window=new n.Buf8(ke.w_size*2),ke.head=new n.Buf16(ke.hash_size),ke.prev=new n.Buf16(ke.w_size),ke.lit_bufsize=1<<J+6,ke.pending_buf_size=ke.lit_bufsize*4,ke.pending_buf=new n.Buf8(ke.pending_buf_size),ke.d_buf=1*ke.lit_bufsize,ke.l_buf=(1+2)*ke.lit_bufsize,ke.level=oe,ke.strategy=ae,ke.method=fe,_e(k)}function ue(k,oe){return Z(k,oe,R,O,I,A)}function W(k,oe){var fe,z,J,ae;if(!k||!k.state||oe>E||oe<0)return k?ze(k,m):m;if(z=k.state,!k.output||!k.input&&k.avail_in!==0||z.status===pe&&oe!==g)return ze(k,k.avail_out===0?v:m);if(z.strm=k,fe=z.last_flush,z.last_flush=oe,z.status===Y)if(z.wrap===2)k.adler=0,Se(z,31),Se(z,139),Se(z,8),z.gzhead?(Se(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),Se(z,z.gzhead.time&255),Se(z,z.gzhead.time>>8&255),Se(z,z.gzhead.time>>16&255),Se(z,z.gzhead.time>>24&255),Se(z,z.level===9?2:z.strategy>=x||z.level<2?4:0),Se(z,z.gzhead.os&255),z.gzhead.extra&&z.gzhead.extra.length&&(Se(z,z.gzhead.extra.length&255),Se(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(k.adler=l(k.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=X):(Se(z,0),Se(z,0),Se(z,0),Se(z,0),Se(z,0),Se(z,z.level===9?2:z.strategy>=x||z.level<2?4:0),Se(z,Me),z.status=Ae);else{var We=R+(z.w_bits-8<<4)<<8,ke=-1;z.strategy>=x||z.level<2?ke=0:z.level<6?ke=1:z.level===6?ke=2:ke=3,We|=ke<<6,z.strstart!==0&&(We|=G),We+=31-We%31,z.status=Ae,Xe(z,We),z.strstart!==0&&(Xe(z,k.adler>>>16),Xe(z,k.adler&65535)),k.adler=1}if(z.status===X)if(z.gzhead.extra){for(J=z.pending;z.gzindex<(z.gzhead.extra.length&65535)&&!(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size));)Se(z,z.gzhead.extra[z.gzindex]&255),z.gzindex++;z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=ie)}else z.status=ie;if(z.status===ie)if(z.gzhead.name){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.name.length?ae=z.gzhead.name.charCodeAt(z.gzindex++)&255:ae=0,Se(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.gzindex=0,z.status=he)}else z.status=he;if(z.status===he)if(z.gzhead.comment){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),He(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.comment.length?ae=z.gzhead.comment.charCodeAt(z.gzindex++)&255:ae=0,Se(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.status=de)}else z.status=de;if(z.status===de&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&He(k),z.pending+2<=z.pending_buf_size&&(Se(z,k.adler&255),Se(z,k.adler>>8&255),k.adler=0,z.status=Ae)):z.status=Ae),z.pending!==0){if(He(k),k.avail_out===0)return z.last_flush=-1,S}else if(k.avail_in===0&&Ge(oe)<=Ge(fe)&&oe!==g)return ze(k,v);if(z.status===pe&&k.avail_in!==0)return ze(k,v);if(k.avail_in!==0||z.lookahead!==0||oe!==p&&z.status!==pe){var Ne=z.strategy===x?xe(z,oe):z.strategy===b?Ee(z,oe):be[z.level].func(z,oe);if((Ne===Ce||Ne===Ue)&&(z.status=pe),Ne===le||Ne===Ce)return k.avail_out===0&&(z.last_flush=-1),S;if(Ne===Ie&&(oe===u?a._tr_align(z):oe!==E&&(a._tr_stored_block(z,0,0,!1),oe===f&&($e(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),He(k),k.avail_out===0))return z.last_flush=-1,S}return oe!==g?S:z.wrap<=0?_:(z.wrap===2?(Se(z,k.adler&255),Se(z,k.adler>>8&255),Se(z,k.adler>>16&255),Se(z,k.adler>>24&255),Se(z,k.total_in&255),Se(z,k.total_in>>8&255),Se(z,k.total_in>>16&255),Se(z,k.total_in>>24&255)):(Xe(z,k.adler>>>16),Xe(z,k.adler&65535)),He(k),z.wrap>0&&(z.wrap=-z.wrap),z.pending!==0?S:_)}function me(k){var oe;return!k||!k.state?m:(oe=k.state.status,oe!==Y&&oe!==X&&oe!==ie&&oe!==he&&oe!==de&&oe!==Ae&&oe!==pe?ze(k,m):(k.state=null,oe===Ae?ze(k,c):S))}function Ke(k,oe){var fe=oe.length,z,J,ae,We,ke,Ne,rt,nr;if(!k||!k.state||(z=k.state,We=z.wrap,We===2||We===1&&z.status!==Y||z.lookahead))return m;for(We===1&&(k.adler=o(k.adler,oe,fe,0)),z.wrap=0,fe>=z.w_size&&(We===0&&($e(z.head),z.strstart=0,z.block_start=0,z.insert=0),nr=new n.Buf8(z.w_size),n.arraySet(nr,oe,fe-z.w_size,z.w_size,0),oe=nr,fe=z.w_size),ke=k.avail_in,Ne=k.next_in,rt=k.input,k.avail_in=fe,k.next_in=0,k.input=oe,ot(z);z.lookahead>=F;){J=z.strstart,ae=z.lookahead-(F-1);do z.ins_h=(z.ins_h<<z.hash_shift^z.window[J+F-1])&z.hash_mask,z.prev[J&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=J,J++;while(--ae);z.strstart=J,z.lookahead=F-1,ot(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=F-1,z.match_available=0,k.next_in=Ne,k.input=rt,k.avail_in=ke,z.wrap=We,S}t.deflateInit=ue,t.deflateInit2=Z,t.deflateReset=_e,t.deflateResetKeep=ce,t.deflateSetHeader=Re,t.deflate=W,t.deflateEnd=me,t.deflateSetDictionary=Ke,t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,i,t){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=n},{}],48:[function(r,i,t){var n=30,a=12;i.exports=function(l,h){var p,u,f,g,E,S,_,m,c,v,y,d,x,b,T,A,L,R,w,O,I,D,C,P,M;p=l.state,u=l.next_in,P=l.input,f=u+(l.avail_in-5),g=l.next_out,M=l.output,E=g-(h-l.avail_out),S=g+(l.avail_out-257),_=p.dmax,m=p.wsize,c=p.whave,v=p.wnext,y=p.window,d=p.hold,x=p.bits,b=p.lencode,T=p.distcode,A=(1<<p.lenbits)-1,L=(1<<p.distbits)-1;e:do{x<15&&(d+=P[u++]<<x,x+=8,d+=P[u++]<<x,x+=8),R=b[d&A];t:for(;;){if(w=R>>>24,d>>>=w,x-=w,w=R>>>16&255,w===0)M[g++]=R&65535;else if(w&16){O=R&65535,w&=15,w&&(x<w&&(d+=P[u++]<<x,x+=8),O+=d&(1<<w)-1,d>>>=w,x-=w),x<15&&(d+=P[u++]<<x,x+=8,d+=P[u++]<<x,x+=8),R=T[d&L];r:for(;;){if(w=R>>>24,d>>>=w,x-=w,w=R>>>16&255,w&16){if(I=R&65535,w&=15,x<w&&(d+=P[u++]<<x,x+=8,x<w&&(d+=P[u++]<<x,x+=8)),I+=d&(1<<w)-1,I>_){l.msg="invalid distance too far back",p.mode=n;break e}if(d>>>=w,x-=w,w=g-E,I>w){if(w=I-w,w>c&&p.sane){l.msg="invalid distance too far back",p.mode=n;break e}if(D=0,C=y,v===0){if(D+=m-w,w<O){O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}}else if(v<w){if(D+=m+v-w,w-=v,w<O){O-=w;do M[g++]=y[D++];while(--w);if(D=0,v<O){w=v,O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}}}else if(D+=v-w,w<O){O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}for(;O>2;)M[g++]=C[D++],M[g++]=C[D++],M[g++]=C[D++],O-=3;O&&(M[g++]=C[D++],O>1&&(M[g++]=C[D++]))}else{D=g-I;do M[g++]=M[D++],M[g++]=M[D++],M[g++]=M[D++],O-=3;while(O>2);O&&(M[g++]=M[D++],O>1&&(M[g++]=M[D++]))}}else if((w&64)==0){R=T[(R&65535)+(d&(1<<w)-1)];continue r}else{l.msg="invalid distance code",p.mode=n;break e}break}}else if((w&64)==0){R=b[(R&65535)+(d&(1<<w)-1)];continue t}else if(w&32){p.mode=a;break e}else{l.msg="invalid literal/length code",p.mode=n;break e}break}}while(u<f&&g<S);O=x>>3,u-=O,x-=O<<3,d&=(1<<x)-1,l.next_in=u,l.next_out=g,l.avail_in=u<f?5+(f-u):5-(u-f),l.avail_out=g<S?257+(S-g):257-(g-S),p.hold=d,p.bits=x}},{}],49:[function(r,i,t){var n=r("../utils/common"),a=r("./adler32"),o=r("./crc32"),l=r("./inffast"),h=r("./inftrees"),p=0,u=1,f=2,g=4,E=5,S=6,_=0,m=1,c=2,v=-2,y=-3,d=-4,x=-5,b=8,T=1,A=2,L=3,R=4,w=5,O=6,I=7,D=8,C=9,P=10,M=11,N=12,B=13,U=14,F=15,j=16,V=17,G=18,Y=19,X=20,ie=21,he=22,de=23,Ae=24,pe=25,le=26,Ie=27,Ce=28,Ue=29,Me=30,ze=31,Ge=32,$e=852,He=592,Fe=15,Se=Fe;function Xe(Z){return(Z>>>24&255)+(Z>>>8&65280)+((Z&65280)<<8)+((Z&255)<<24)}function st(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function et(Z){var ue;return!Z||!Z.state?v:(ue=Z.state,Z.total_in=Z.total_out=ue.total=0,Z.msg="",ue.wrap&&(Z.adler=ue.wrap&1),ue.mode=T,ue.last=0,ue.havedict=0,ue.dmax=32768,ue.head=null,ue.hold=0,ue.bits=0,ue.lencode=ue.lendyn=new n.Buf32($e),ue.distcode=ue.distdyn=new n.Buf32(He),ue.sane=1,ue.back=-1,_)}function ot(Z){var ue;return!Z||!Z.state?v:(ue=Z.state,ue.wsize=0,ue.whave=0,ue.wnext=0,et(Z))}function nt(Z,ue){var W,me;return!Z||!Z.state||(me=Z.state,ue<0?(W=0,ue=-ue):(W=(ue>>4)+1,ue<48&&(ue&=15)),ue&&(ue<8||ue>15))?v:(me.window!==null&&me.wbits!==ue&&(me.window=null),me.wrap=W,me.wbits=ue,ot(Z))}function dt(Z,ue){var W,me;return Z?(me=new st,Z.state=me,me.window=null,W=nt(Z,ue),W!==_&&(Z.state=null),W):v}function ne(Z){return dt(Z,Se)}var Ee=!0,xe,we;function be(Z){if(Ee){var ue;for(xe=new n.Buf32(512),we=new n.Buf32(32),ue=0;ue<144;)Z.lens[ue++]=8;for(;ue<256;)Z.lens[ue++]=9;for(;ue<280;)Z.lens[ue++]=7;for(;ue<288;)Z.lens[ue++]=8;for(h(u,Z.lens,0,288,xe,0,Z.work,{bits:9}),ue=0;ue<32;)Z.lens[ue++]=5;h(f,Z.lens,0,32,we,0,Z.work,{bits:5}),Ee=!1}Z.lencode=xe,Z.lenbits=9,Z.distcode=we,Z.distbits=5}function je(Z,ue,W,me){var Ke,k=Z.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new n.Buf8(k.wsize)),me>=k.wsize?(n.arraySet(k.window,ue,W-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(Ke=k.wsize-k.wnext,Ke>me&&(Ke=me),n.arraySet(k.window,ue,W-me,Ke,k.wnext),me-=Ke,me?(n.arraySet(k.window,ue,W-me,me,0),k.wnext=me,k.whave=k.wsize):(k.wnext+=Ke,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=Ke))),0}function K(Z,ue){var W,me,Ke,k,oe,fe,z,J,ae,We,ke,Ne,rt,nr,vt=0,at,At,Pt,jt,$i,Gi,xt,qt,Dt=new n.Buf8(4),Dr,gr,Ia=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Z||!Z.state||!Z.output||!Z.input&&Z.avail_in!==0)return v;W=Z.state,W.mode===N&&(W.mode=B),oe=Z.next_out,Ke=Z.output,z=Z.avail_out,k=Z.next_in,me=Z.input,fe=Z.avail_in,J=W.hold,ae=W.bits,We=fe,ke=z,qt=_;e:for(;;)switch(W.mode){case T:if(W.wrap===0){W.mode=B;break}for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.wrap&2&&J===35615){W.check=0,Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0),J=0,ae=0,W.mode=A;break}if(W.flags=0,W.head&&(W.head.done=!1),!(W.wrap&1)||(((J&255)<<8)+(J>>8))%31){Z.msg="incorrect header check",W.mode=Me;break}if((J&15)!==b){Z.msg="unknown compression method",W.mode=Me;break}if(J>>>=4,ae-=4,xt=(J&15)+8,W.wbits===0)W.wbits=xt;else if(xt>W.wbits){Z.msg="invalid window size",W.mode=Me;break}W.dmax=1<<xt,Z.adler=W.check=1,W.mode=J&512?P:N,J=0,ae=0;break;case A:for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.flags=J,(W.flags&255)!==b){Z.msg="unknown compression method",W.mode=Me;break}if(W.flags&57344){Z.msg="unknown header flags set",W.mode=Me;break}W.head&&(W.head.text=J>>8&1),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0,W.mode=L;case L:for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.head&&(W.head.time=J),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,Dt[2]=J>>>16&255,Dt[3]=J>>>24&255,W.check=o(W.check,Dt,4,0)),J=0,ae=0,W.mode=R;case R:for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.head&&(W.head.xflags=J&255,W.head.os=J>>8),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0,W.mode=w;case w:if(W.flags&1024){for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.length=J,W.head&&(W.head.extra_len=J),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0}else W.head&&(W.head.extra=null);W.mode=O;case O:if(W.flags&1024&&(Ne=W.length,Ne>fe&&(Ne=fe),Ne&&(W.head&&(xt=W.head.extra_len-W.length,W.head.extra||(W.head.extra=new Array(W.head.extra_len)),n.arraySet(W.head.extra,me,k,Ne,xt)),W.flags&512&&(W.check=o(W.check,me,Ne,k)),fe-=Ne,k+=Ne,W.length-=Ne),W.length))break e;W.length=0,W.mode=I;case I:if(W.flags&2048){if(fe===0)break e;Ne=0;do xt=me[k+Ne++],W.head&&xt&&W.length<65536&&(W.head.name+=String.fromCharCode(xt));while(xt&&Ne<fe);if(W.flags&512&&(W.check=o(W.check,me,Ne,k)),fe-=Ne,k+=Ne,xt)break e}else W.head&&(W.head.name=null);W.length=0,W.mode=D;case D:if(W.flags&4096){if(fe===0)break e;Ne=0;do xt=me[k+Ne++],W.head&&xt&&W.length<65536&&(W.head.comment+=String.fromCharCode(xt));while(xt&&Ne<fe);if(W.flags&512&&(W.check=o(W.check,me,Ne,k)),fe-=Ne,k+=Ne,xt)break e}else W.head&&(W.head.comment=null);W.mode=C;case C:if(W.flags&512){for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J!==(W.check&65535)){Z.msg="header crc mismatch",W.mode=Me;break}J=0,ae=0}W.head&&(W.head.hcrc=W.flags>>9&1,W.head.done=!0),Z.adler=W.check=0,W.mode=N;break;case P:for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}Z.adler=W.check=Xe(J),J=0,ae=0,W.mode=M;case M:if(W.havedict===0)return Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,c;Z.adler=W.check=1,W.mode=N;case N:if(ue===E||ue===S)break e;case B:if(W.last){J>>>=ae&7,ae-=ae&7,W.mode=Ie;break}for(;ae<3;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}switch(W.last=J&1,J>>>=1,ae-=1,J&3){case 0:W.mode=U;break;case 1:if(be(W),W.mode=X,ue===S){J>>>=2,ae-=2;break e}break;case 2:W.mode=V;break;case 3:Z.msg="invalid block type",W.mode=Me}J>>>=2,ae-=2;break;case U:for(J>>>=ae&7,ae-=ae&7;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if((J&65535)!=(J>>>16^65535)){Z.msg="invalid stored block lengths",W.mode=Me;break}if(W.length=J&65535,J=0,ae=0,W.mode=F,ue===S)break e;case F:W.mode=j;case j:if(Ne=W.length,Ne){if(Ne>fe&&(Ne=fe),Ne>z&&(Ne=z),Ne===0)break e;n.arraySet(Ke,me,k,Ne,oe),fe-=Ne,k+=Ne,z-=Ne,oe+=Ne,W.length-=Ne;break}W.mode=N;break;case V:for(;ae<14;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.nlen=(J&31)+257,J>>>=5,ae-=5,W.ndist=(J&31)+1,J>>>=5,ae-=5,W.ncode=(J&15)+4,J>>>=4,ae-=4,W.nlen>286||W.ndist>30){Z.msg="too many length or distance symbols",W.mode=Me;break}W.have=0,W.mode=G;case G:for(;W.have<W.ncode;){for(;ae<3;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.lens[Ia[W.have++]]=J&7,J>>>=3,ae-=3}for(;W.have<19;)W.lens[Ia[W.have++]]=0;if(W.lencode=W.lendyn,W.lenbits=7,Dr={bits:W.lenbits},qt=h(p,W.lens,0,19,W.lencode,0,W.work,Dr),W.lenbits=Dr.bits,qt){Z.msg="invalid code lengths set",W.mode=Me;break}W.have=0,W.mode=Y;case Y:for(;W.have<W.nlen+W.ndist;){for(;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(Pt<16)J>>>=at,ae-=at,W.lens[W.have++]=Pt;else{if(Pt===16){for(gr=at+2;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J>>>=at,ae-=at,W.have===0){Z.msg="invalid bit length repeat",W.mode=Me;break}xt=W.lens[W.have-1],Ne=3+(J&3),J>>>=2,ae-=2}else if(Pt===17){for(gr=at+3;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Ne=3+(J&7),J>>>=3,ae-=3}else{for(gr=at+7;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Ne=11+(J&127),J>>>=7,ae-=7}if(W.have+Ne>W.nlen+W.ndist){Z.msg="invalid bit length repeat",W.mode=Me;break}for(;Ne--;)W.lens[W.have++]=xt}}if(W.mode===Me)break;if(W.lens[256]===0){Z.msg="invalid code -- missing end-of-block",W.mode=Me;break}if(W.lenbits=9,Dr={bits:W.lenbits},qt=h(u,W.lens,0,W.nlen,W.lencode,0,W.work,Dr),W.lenbits=Dr.bits,qt){Z.msg="invalid literal/lengths set",W.mode=Me;break}if(W.distbits=6,W.distcode=W.distdyn,Dr={bits:W.distbits},qt=h(f,W.lens,W.nlen,W.ndist,W.distcode,0,W.work,Dr),W.distbits=Dr.bits,qt){Z.msg="invalid distances set",W.mode=Me;break}if(W.mode=X,ue===S)break e;case X:W.mode=ie;case ie:if(fe>=6&&z>=258){Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,l(Z,ke),oe=Z.next_out,Ke=Z.output,z=Z.avail_out,k=Z.next_in,me=Z.input,fe=Z.avail_in,J=W.hold,ae=W.bits,W.mode===N&&(W.back=-1);break}for(W.back=0;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(At&&(At&240)==0){for(jt=at,$i=At,Gi=Pt;vt=W.lencode[Gi+((J&(1<<jt+$i)-1)>>jt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(jt+at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=jt,ae-=jt,W.back+=jt}if(J>>>=at,ae-=at,W.back+=at,W.length=Pt,At===0){W.mode=le;break}if(At&32){W.back=-1,W.mode=N;break}if(At&64){Z.msg="invalid literal/length code",W.mode=Me;break}W.extra=At&15,W.mode=he;case he:if(W.extra){for(gr=W.extra;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.length+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}W.was=W.length,W.mode=de;case de:for(;vt=W.distcode[J&(1<<W.distbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if((At&240)==0){for(jt=at,$i=At,Gi=Pt;vt=W.distcode[Gi+((J&(1<<jt+$i)-1)>>jt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(jt+at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=jt,ae-=jt,W.back+=jt}if(J>>>=at,ae-=at,W.back+=at,At&64){Z.msg="invalid distance code",W.mode=Me;break}W.offset=Pt,W.extra=At&15,W.mode=Ae;case Ae:if(W.extra){for(gr=W.extra;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.offset+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}if(W.offset>W.dmax){Z.msg="invalid distance too far back",W.mode=Me;break}W.mode=pe;case pe:if(z===0)break e;if(Ne=ke-z,W.offset>Ne){if(Ne=W.offset-Ne,Ne>W.whave&&W.sane){Z.msg="invalid distance too far back",W.mode=Me;break}Ne>W.wnext?(Ne-=W.wnext,rt=W.wsize-Ne):rt=W.wnext-Ne,Ne>W.length&&(Ne=W.length),nr=W.window}else nr=Ke,rt=oe-W.offset,Ne=W.length;Ne>z&&(Ne=z),z-=Ne,W.length-=Ne;do Ke[oe++]=nr[rt++];while(--Ne);W.length===0&&(W.mode=ie);break;case le:if(z===0)break e;Ke[oe++]=W.length,z--,W.mode=ie;break;case Ie:if(W.wrap){for(;ae<32;){if(fe===0)break e;fe--,J|=me[k++]<<ae,ae+=8}if(ke-=z,Z.total_out+=ke,W.total+=ke,ke&&(Z.adler=W.check=W.flags?o(W.check,Ke,ke,oe-ke):a(W.check,Ke,ke,oe-ke)),ke=z,(W.flags?J:Xe(J))!==W.check){Z.msg="incorrect data check",W.mode=Me;break}J=0,ae=0}W.mode=Ce;case Ce:if(W.wrap&&W.flags){for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J!==(W.total&4294967295)){Z.msg="incorrect length check",W.mode=Me;break}J=0,ae=0}W.mode=Ue;case Ue:qt=m;break e;case Me:qt=y;break e;case ze:return d;case Ge:default:return v}return Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,(W.wsize||ke!==Z.avail_out&&W.mode<Me&&(W.mode<Ie||ue!==g))&&je(Z,Z.output,Z.next_out,ke-Z.avail_out),We-=Z.avail_in,ke-=Z.avail_out,Z.total_in+=We,Z.total_out+=ke,W.total+=ke,W.wrap&&ke&&(Z.adler=W.check=W.flags?o(W.check,Ke,ke,Z.next_out-ke):a(W.check,Ke,ke,Z.next_out-ke)),Z.data_type=W.bits+(W.last?64:0)+(W.mode===N?128:0)+(W.mode===X||W.mode===F?256:0),(We===0&&ke===0||ue===g)&&qt===_&&(qt=x),qt}function ce(Z){if(!Z||!Z.state)return v;var ue=Z.state;return ue.window&&(ue.window=null),Z.state=null,_}function _e(Z,ue){var W;return!Z||!Z.state||(W=Z.state,(W.wrap&2)==0)?v:(W.head=ue,ue.done=!1,_)}function Re(Z,ue){var W=ue.length,me,Ke,k;return!Z||!Z.state||(me=Z.state,me.wrap!==0&&me.mode!==M)?v:me.mode===M&&(Ke=1,Ke=a(Ke,ue,W,0),Ke!==me.check)?y:(k=je(Z,ue,W,W),k?(me.mode=ze,d):(me.havedict=1,_))}t.inflateReset=ot,t.inflateReset2=nt,t.inflateResetKeep=et,t.inflateInit=ne,t.inflateInit2=dt,t.inflate=K,t.inflateEnd=ce,t.inflateGetHeader=_e,t.inflateSetDictionary=Re,t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,i,t){var n=r("../utils/common"),a=15,o=852,l=592,h=0,p=1,u=2,f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],S=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,c,v,y,d,x,b,T){var A=T.bits,L=0,R=0,w=0,O=0,I=0,D=0,C=0,P=0,M=0,N=0,B,U,F,j,V,G=null,Y=0,X,ie=new n.Buf16(a+1),he=new n.Buf16(a+1),de=null,Ae=0,pe,le,Ie;for(L=0;L<=a;L++)ie[L]=0;for(R=0;R<y;R++)ie[c[v+R]]++;for(I=A,O=a;O>=1&&ie[O]===0;O--);if(I>O&&(I=O),O===0)return d[x++]=1<<24|64<<16|0,d[x++]=1<<24|64<<16|0,T.bits=1,0;for(w=1;w<O&&ie[w]===0;w++);for(I<w&&(I=w),P=1,L=1;L<=a;L++)if(P<<=1,P-=ie[L],P<0)return-1;if(P>0&&(m===h||O!==1))return-1;for(he[1]=0,L=1;L<a;L++)he[L+1]=he[L]+ie[L];for(R=0;R<y;R++)c[v+R]!==0&&(b[he[c[v+R]]++]=R);if(m===h?(G=de=b,X=19):m===p?(G=f,Y-=257,de=g,Ae-=257,X=256):(G=E,de=S,X=-1),N=0,R=0,L=w,V=x,D=I,C=0,F=-1,M=1<<I,j=M-1,m===p&&M>o||m===u&&M>l)return 1;for(;;){pe=L-C,b[R]<X?(le=0,Ie=b[R]):b[R]>X?(le=de[Ae+b[R]],Ie=G[Y+b[R]]):(le=32+64,Ie=0),B=1<<L-C,U=1<<D,w=U;do U-=B,d[V+(N>>C)+U]=pe<<24|le<<16|Ie|0;while(U!==0);for(B=1<<L-1;N&B;)B>>=1;if(B!==0?(N&=B-1,N+=B):N=0,R++,--ie[L]==0){if(L===O)break;L=c[v+b[R]]}if(L>I&&(N&j)!==F){for(C===0&&(C=I),V+=w,D=L-C,P=1<<D;D+C<O&&(P-=ie[D+C],!(P<=0));)D++,P<<=1;if(M+=1<<D,m===p&&M>o||m===u&&M>l)return 1;F=N&j,d[F]=I<<24|D<<16|V-x|0}}return N!==0&&(d[V+N]=L-C<<24|64<<16|0),T.bits=I,0}},{"../utils/common":41}],51:[function(r,i,t){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,i,t){var n=r("../utils/common"),a=4,o=0,l=1,h=2;function p(K){for(var ce=K.length;--ce>=0;)K[ce]=0}var u=0,f=1,g=2,E=3,S=258,_=29,m=256,c=m+1+_,v=30,y=19,d=2*c+1,x=15,b=16,T=7,A=256,L=16,R=17,w=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,M=new Array((c+2)*2);p(M);var N=new Array(v*2);p(N);var B=new Array(P);p(B);var U=new Array(S-E+1);p(U);var F=new Array(_);p(F);var j=new Array(v);p(j);function V(K,ce,_e,Re,Z){this.static_tree=K,this.extra_bits=ce,this.extra_base=_e,this.elems=Re,this.max_length=Z,this.has_stree=K&&K.length}var G,Y,X;function ie(K,ce){this.dyn_tree=K,this.max_code=0,this.stat_desc=ce}function he(K){return K<256?B[K]:B[256+(K>>>7)]}function de(K,ce){K.pending_buf[K.pending++]=ce&255,K.pending_buf[K.pending++]=ce>>>8&255}function Ae(K,ce,_e){K.bi_valid>b-_e?(K.bi_buf|=ce<<K.bi_valid&65535,de(K,K.bi_buf),K.bi_buf=ce>>b-K.bi_valid,K.bi_valid+=_e-b):(K.bi_buf|=ce<<K.bi_valid&65535,K.bi_valid+=_e)}function pe(K,ce,_e){Ae(K,_e[ce*2],_e[ce*2+1])}function le(K,ce){var _e=0;do _e|=K&1,K>>>=1,_e<<=1;while(--ce>0);return _e>>>1}function Ie(K){K.bi_valid===16?(de(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=K.bi_buf&255,K.bi_buf>>=8,K.bi_valid-=8)}function Ce(K,ce){var _e=ce.dyn_tree,Re=ce.max_code,Z=ce.stat_desc.static_tree,ue=ce.stat_desc.has_stree,W=ce.stat_desc.extra_bits,me=ce.stat_desc.extra_base,Ke=ce.stat_desc.max_length,k,oe,fe,z,J,ae,We=0;for(z=0;z<=x;z++)K.bl_count[z]=0;for(_e[K.heap[K.heap_max]*2+1]=0,k=K.heap_max+1;k<d;k++)oe=K.heap[k],z=_e[_e[oe*2+1]*2+1]+1,z>Ke&&(z=Ke,We++),_e[oe*2+1]=z,!(oe>Re)&&(K.bl_count[z]++,J=0,oe>=me&&(J=W[oe-me]),ae=_e[oe*2],K.opt_len+=ae*(z+J),ue&&(K.static_len+=ae*(Z[oe*2+1]+J)));if(We!==0){do{for(z=Ke-1;K.bl_count[z]===0;)z--;K.bl_count[z]--,K.bl_count[z+1]+=2,K.bl_count[Ke]--,We-=2}while(We>0);for(z=Ke;z!==0;z--)for(oe=K.bl_count[z];oe!==0;)fe=K.heap[--k],!(fe>Re)&&(_e[fe*2+1]!==z&&(K.opt_len+=(z-_e[fe*2+1])*_e[fe*2],_e[fe*2+1]=z),oe--)}}function Ue(K,ce,_e){var Re=new Array(x+1),Z=0,ue,W;for(ue=1;ue<=x;ue++)Re[ue]=Z=Z+_e[ue-1]<<1;for(W=0;W<=ce;W++){var me=K[W*2+1];me!==0&&(K[W*2]=le(Re[me]++,me))}}function Me(){var K,ce,_e,Re,Z,ue=new Array(x+1);for(_e=0,Re=0;Re<_-1;Re++)for(F[Re]=_e,K=0;K<1<<O[Re];K++)U[_e++]=Re;for(U[_e-1]=Re,Z=0,Re=0;Re<16;Re++)for(j[Re]=Z,K=0;K<1<<I[Re];K++)B[Z++]=Re;for(Z>>=7;Re<v;Re++)for(j[Re]=Z<<7,K=0;K<1<<I[Re]-7;K++)B[256+Z++]=Re;for(ce=0;ce<=x;ce++)ue[ce]=0;for(K=0;K<=143;)M[K*2+1]=8,K++,ue[8]++;for(;K<=255;)M[K*2+1]=9,K++,ue[9]++;for(;K<=279;)M[K*2+1]=7,K++,ue[7]++;for(;K<=287;)M[K*2+1]=8,K++,ue[8]++;for(Ue(M,c+1,ue),K=0;K<v;K++)N[K*2+1]=5,N[K*2]=le(K,5);G=new V(M,O,m+1,c,x),Y=new V(N,I,0,v,x),X=new V(new Array(0),D,0,y,T)}function ze(K){var ce;for(ce=0;ce<c;ce++)K.dyn_ltree[ce*2]=0;for(ce=0;ce<v;ce++)K.dyn_dtree[ce*2]=0;for(ce=0;ce<y;ce++)K.bl_tree[ce*2]=0;K.dyn_ltree[A*2]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Ge(K){K.bi_valid>8?de(K,K.bi_buf):K.bi_valid>0&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function $e(K,ce,_e,Re){Ge(K),Re&&(de(K,_e),de(K,~_e)),n.arraySet(K.pending_buf,K.window,ce,_e,K.pending),K.pending+=_e}function He(K,ce,_e,Re){var Z=ce*2,ue=_e*2;return K[Z]<K[ue]||K[Z]===K[ue]&&Re[ce]<=Re[_e]}function Fe(K,ce,_e){for(var Re=K.heap[_e],Z=_e<<1;Z<=K.heap_len&&(Z<K.heap_len&&He(ce,K.heap[Z+1],K.heap[Z],K.depth)&&Z++,!He(ce,Re,K.heap[Z],K.depth));)K.heap[_e]=K.heap[Z],_e=Z,Z<<=1;K.heap[_e]=Re}function Se(K,ce,_e){var Re,Z,ue=0,W,me;if(K.last_lit!==0)do Re=K.pending_buf[K.d_buf+ue*2]<<8|K.pending_buf[K.d_buf+ue*2+1],Z=K.pending_buf[K.l_buf+ue],ue++,Re===0?pe(K,Z,ce):(W=U[Z],pe(K,W+m+1,ce),me=O[W],me!==0&&(Z-=F[W],Ae(K,Z,me)),Re--,W=he(Re),pe(K,W,_e),me=I[W],me!==0&&(Re-=j[W],Ae(K,Re,me)));while(ue<K.last_lit);pe(K,A,ce)}function Xe(K,ce){var _e=ce.dyn_tree,Re=ce.stat_desc.static_tree,Z=ce.stat_desc.has_stree,ue=ce.stat_desc.elems,W,me,Ke=-1,k;for(K.heap_len=0,K.heap_max=d,W=0;W<ue;W++)_e[W*2]!==0?(K.heap[++K.heap_len]=Ke=W,K.depth[W]=0):_e[W*2+1]=0;for(;K.heap_len<2;)k=K.heap[++K.heap_len]=Ke<2?++Ke:0,_e[k*2]=1,K.depth[k]=0,K.opt_len--,Z&&(K.static_len-=Re[k*2+1]);for(ce.max_code=Ke,W=K.heap_len>>1;W>=1;W--)Fe(K,_e,W);k=ue;do W=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Fe(K,_e,1),me=K.heap[1],K.heap[--K.heap_max]=W,K.heap[--K.heap_max]=me,_e[k*2]=_e[W*2]+_e[me*2],K.depth[k]=(K.depth[W]>=K.depth[me]?K.depth[W]:K.depth[me])+1,_e[W*2+1]=_e[me*2+1]=k,K.heap[1]=k++,Fe(K,_e,1);while(K.heap_len>=2);K.heap[--K.heap_max]=K.heap[1],Ce(K,ce),Ue(_e,Ke,K.bl_count)}function st(K,ce,_e){var Re,Z=-1,ue,W=ce[0*2+1],me=0,Ke=7,k=4;for(W===0&&(Ke=138,k=3),ce[(_e+1)*2+1]=65535,Re=0;Re<=_e;Re++)ue=W,W=ce[(Re+1)*2+1],!(++me<Ke&&ue===W)&&(me<k?K.bl_tree[ue*2]+=me:ue!==0?(ue!==Z&&K.bl_tree[ue*2]++,K.bl_tree[L*2]++):me<=10?K.bl_tree[R*2]++:K.bl_tree[w*2]++,me=0,Z=ue,W===0?(Ke=138,k=3):ue===W?(Ke=6,k=3):(Ke=7,k=4))}function et(K,ce,_e){var Re,Z=-1,ue,W=ce[0*2+1],me=0,Ke=7,k=4;for(W===0&&(Ke=138,k=3),Re=0;Re<=_e;Re++)if(ue=W,W=ce[(Re+1)*2+1],!(++me<Ke&&ue===W)){if(me<k)do pe(K,ue,K.bl_tree);while(--me!=0);else ue!==0?(ue!==Z&&(pe(K,ue,K.bl_tree),me--),pe(K,L,K.bl_tree),Ae(K,me-3,2)):me<=10?(pe(K,R,K.bl_tree),Ae(K,me-3,3)):(pe(K,w,K.bl_tree),Ae(K,me-11,7));me=0,Z=ue,W===0?(Ke=138,k=3):ue===W?(Ke=6,k=3):(Ke=7,k=4)}}function ot(K){var ce;for(st(K,K.dyn_ltree,K.l_desc.max_code),st(K,K.dyn_dtree,K.d_desc.max_code),Xe(K,K.bl_desc),ce=y-1;ce>=3&&K.bl_tree[C[ce]*2+1]===0;ce--);return K.opt_len+=3*(ce+1)+5+5+4,ce}function nt(K,ce,_e,Re){var Z;for(Ae(K,ce-257,5),Ae(K,_e-1,5),Ae(K,Re-4,4),Z=0;Z<Re;Z++)Ae(K,K.bl_tree[C[Z]*2+1],3);et(K,K.dyn_ltree,ce-1),et(K,K.dyn_dtree,_e-1)}function dt(K){var ce=4093624447,_e;for(_e=0;_e<=31;_e++,ce>>>=1)if(ce&1&&K.dyn_ltree[_e*2]!==0)return o;if(K.dyn_ltree[9*2]!==0||K.dyn_ltree[10*2]!==0||K.dyn_ltree[13*2]!==0)return l;for(_e=32;_e<m;_e++)if(K.dyn_ltree[_e*2]!==0)return l;return o}var ne=!1;function Ee(K){ne||(Me(),ne=!0),K.l_desc=new ie(K.dyn_ltree,G),K.d_desc=new ie(K.dyn_dtree,Y),K.bl_desc=new ie(K.bl_tree,X),K.bi_buf=0,K.bi_valid=0,ze(K)}function xe(K,ce,_e,Re){Ae(K,(u<<1)+(Re?1:0),3),$e(K,ce,_e,!0)}function we(K){Ae(K,f<<1,3),pe(K,A,M),Ie(K)}function be(K,ce,_e,Re){var Z,ue,W=0;K.level>0?(K.strm.data_type===h&&(K.strm.data_type=dt(K)),Xe(K,K.l_desc),Xe(K,K.d_desc),W=ot(K),Z=K.opt_len+3+7>>>3,ue=K.static_len+3+7>>>3,ue<=Z&&(Z=ue)):Z=ue=_e+5,_e+4<=Z&&ce!==-1?xe(K,ce,_e,Re):K.strategy===a||ue===Z?(Ae(K,(f<<1)+(Re?1:0),3),Se(K,M,N)):(Ae(K,(g<<1)+(Re?1:0),3),nt(K,K.l_desc.max_code+1,K.d_desc.max_code+1,W+1),Se(K,K.dyn_ltree,K.dyn_dtree)),ze(K),Re&&Ge(K)}function je(K,ce,_e){return K.pending_buf[K.d_buf+K.last_lit*2]=ce>>>8&255,K.pending_buf[K.d_buf+K.last_lit*2+1]=ce&255,K.pending_buf[K.l_buf+K.last_lit]=_e&255,K.last_lit++,ce===0?K.dyn_ltree[_e*2]++:(K.matches++,ce--,K.dyn_ltree[(U[_e]+m+1)*2]++,K.dyn_dtree[he(ce)*2]++),K.last_lit===K.lit_bufsize-1}t._tr_init=Ee,t._tr_stored_block=xe,t._tr_flush_block=be,t._tr_tally=je,t._tr_align=we},{"../utils/common":41}],53:[function(r,i,t){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=n},{}],54:[function(r,i,t){i.exports=typeof setImmediate=="function"?setImmediate:function(){var a=[].slice.apply(arguments);a.splice(1,0,0),setTimeout.apply(null,a)}},{}]},{},[10])(10)})})($c);Object.defineProperty(to,"__esModule",{value:!0});to.default=void 0;var Rn=Be,rS=ro(Bi),Gc=ro(Tn),iS=ro(Qr),nS=ro($c.exports);function ro(s){return s&&s.__esModule?s:{default:s}}class aS{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new nS.default}catch(e){throw new Error("JSZip lib not loaded")}}open(e,r){return this.zip.loadAsync(e,{base64:r})}openUrl(e,r){return(0,rS.default)(e,"binary").then(function(i){return this.zip.loadAsync(i,{base64:r})}.bind(this))}request(e,r){var i=new Rn.defer,t,n=new iS.default(e);return r||(r=n.extension),r=="blob"?t=this.getBlob(e):t=this.getText(e),t?t.then(function(a){let o=this.handleResponse(a,r);i.resolve(o)}.bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,Rn.isXml)(r)?i=(0,Rn.parse)(e,"text/xml"):r=="xhtml"?i=(0,Rn.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,Rn.parse)(e,"text/html"):i=e,i}getBlob(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("uint8array").then(function(n){return new Blob([n],{type:r})})}getText(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return t.async("string").then(function(n){return n})}getBase64(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("base64").then(function(n){return"data:"+r+";base64,"+n})}createUrl(e,r){var i=new Rn.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){n=t.createObjectURL(l),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.zip=void 0,this.urlCache={}}}var sS=aS;to.default=sS;var io={},Yc={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(h,p){if(!t[h]){if(!i[h]){var u=typeof zr=="function"&&zr;if(!p&&u)return u(h,!0);if(o)return o(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var g=t[h]={exports:{}};i[h][0].call(g.exports,function(E){var S=i[h][1][E];return a(S||E)},g,g.exports,r,i,t,n)}return t[h].exports}for(var o=typeof zr=="function"&&zr,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var l=0,h=new a(E),p=n.document.createTextNode("");h.observe(p,{characterData:!0}),o=function(){p.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var u=new n.MessageChannel;u.port1.onmessage=E,o=function(){u.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var _=n.document.createElement("script");_.onreadystatechange=function(){E(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},n.document.documentElement.appendChild(_)}:o=function(){setTimeout(E,0)};var f,g=[];function E(){f=!0;for(var _,m,c=g.length;c;){for(m=g,g=[],_=-1;++_<c;)m[_]();c=g.length}f=!1}i.exports=S;function S(_){g.push(_)===1&&!f&&o()}}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(r,i,t){var n=r(1);function a(){}var o={},l=["REJECTED"],h=["FULFILLED"],p=["PENDING"];i.exports=u;function u(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,d!==a&&S(this,d)}u.prototype.catch=function(d){return this.then(null,d)},u.prototype.then=function(d,x){if(typeof d!="function"&&this.state===h||typeof x!="function"&&this.state===l)return this;var b=new this.constructor(a);if(this.state!==p){var T=this.state===h?d:x;g(b,T,this.outcome)}else this.queue.push(new f(b,d,x));return b};function f(d,x,b){this.promise=d,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(d){o.resolve(this.promise,d)},f.prototype.otherCallFulfilled=function(d){g(this.promise,this.onFulfilled,d)},f.prototype.callRejected=function(d){o.reject(this.promise,d)},f.prototype.otherCallRejected=function(d){g(this.promise,this.onRejected,d)};function g(d,x,b){n(function(){var T;try{T=x(b)}catch(A){return o.reject(d,A)}T===d?o.reject(d,new TypeError("Cannot resolve promise with itself")):o.resolve(d,T)})}o.resolve=function(d,x){var b=_(E,x);if(b.status==="error")return o.reject(d,b.value);var T=b.value;if(T)S(d,T);else{d.state=h,d.outcome=x;for(var A=-1,L=d.queue.length;++A<L;)d.queue[A].callFulfilled(x)}return d},o.reject=function(d,x){d.state=l,d.outcome=x;for(var b=-1,T=d.queue.length;++b<T;)d.queue[b].callRejected(x);return d};function E(d){var x=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof x=="function")return function(){x.apply(d,arguments)}}function S(d,x){var b=!1;function T(w){b||(b=!0,o.reject(d,w))}function A(w){b||(b=!0,o.resolve(d,w))}function L(){x(A,T)}var R=_(L);R.status==="error"&&T(R.value)}function _(d,x){var b={};try{b.value=d(x),b.status="success"}catch(T){b.status="error",b.value=T}return b}u.resolve=m;function m(d){return d instanceof this?d:o.resolve(new this(a),d)}u.reject=c;function c(d){var x=new this(a);return o.reject(x,d)}u.all=v;function v(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=d.length,T=!1;if(!b)return this.resolve([]);for(var A=new Array(b),L=0,R=-1,w=new this(a);++R<b;)O(d[R],R);return w;function O(I,D){x.resolve(I).then(C,function(P){T||(T=!0,o.reject(w,P))});function C(P){A[D]=P,++L===b&&!T&&(T=!0,o.resolve(w,A))}}}u.race=y;function y(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=d.length,T=!1;if(!b)return this.resolve([]);for(var A=-1,L=new this(a);++A<b;)R(d[A]);return L;function R(w){x.resolve(w).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{"1":1}],3:[function(r,i,t){(function(n){typeof n.Promise!="function"&&(n.Promise=r(2))}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(r,i,t){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H};function a(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(H){return}}var l=o();function h(){try{if(!l||!l.open)return!1;var H=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Q=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!H||Q)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch($){return!1}}function p(H,Q){H=H||[],Q=Q||{};try{return new Blob(H,Q)}catch(ee){if(ee.name!=="TypeError")throw ee;for(var $=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,te=new $,re=0;re<H.length;re+=1)te.append(H[re]);return te.getBlob(Q.type)}}typeof Promise=="undefined"&&r(3);var u=Promise;function f(H,Q){Q&&H.then(function($){Q(null,$)},function($){Q($)})}function g(H,Q,$){typeof Q=="function"&&H.then(Q),typeof $=="function"&&H.catch($)}function E(H){return typeof H!="string"&&(console.warn(H+" used as a key, but it is not a string."),H=String(H)),H}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var _="local-forage-detect-blob-support",m=void 0,c={},v=Object.prototype.toString,y="readonly",d="readwrite";function x(H){for(var Q=H.length,$=new ArrayBuffer(Q),te=new Uint8Array($),re=0;re<Q;re++)te[re]=H.charCodeAt(re);return $}function b(H){return new u(function(Q){var $=H.transaction(_,d),te=p([""]);$.objectStore(_).put(te,"key"),$.onabort=function(re){re.preventDefault(),re.stopPropagation(),Q(!1)},$.oncomplete=function(){var re=navigator.userAgent.match(/Chrome\/(\d+)/),ee=navigator.userAgent.match(/Edge\//);Q(ee||!re||parseInt(re[1],10)>=43)}}).catch(function(){return!1})}function T(H){return typeof m=="boolean"?u.resolve(m):b(H).then(function(Q){return m=Q,m})}function A(H){var Q=c[H.name],$={};$.promise=new u(function(te,re){$.resolve=te,$.reject=re}),Q.deferredOperations.push($),Q.dbReady?Q.dbReady=Q.dbReady.then(function(){return $.promise}):Q.dbReady=$.promise}function L(H){var Q=c[H.name],$=Q.deferredOperations.pop();if($)return $.resolve(),$.promise}function R(H,Q){var $=c[H.name],te=$.deferredOperations.pop();if(te)return te.reject(Q),te.promise}function w(H,Q){return new u(function($,te){if(c[H.name]=c[H.name]||F(),H.db)if(Q)A(H),H.db.close();else return $(H.db);var re=[H.name];Q&&re.push(H.version);var ee=l.open.apply(l,re);Q&&(ee.onupgradeneeded=function(ve){var Te=ee.result;try{Te.createObjectStore(H.storeName),ve.oldVersion<=1&&Te.createObjectStore(_)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+H.name+'" has been upgraded from version '+ve.oldVersion+" to version "+ve.newVersion+', but the storage "'+H.storeName+'" already exists.');else throw Oe}}),ee.onerror=function(ve){ve.preventDefault(),te(ee.error)},ee.onsuccess=function(){var ve=ee.result;ve.onversionchange=function(Te){Te.target.close()},$(ve),L(H)}})}function O(H){return w(H,!1)}function I(H){return w(H,!0)}function D(H,Q){if(!H.db)return!0;var $=!H.db.objectStoreNames.contains(H.storeName),te=H.version<H.db.version,re=H.version>H.db.version;if(te&&(H.version!==Q&&console.warn('The database "'+H.name+`" can't be downgraded from version `+H.db.version+" to version "+H.version+"."),H.version=H.db.version),re||$){if($){var ee=H.db.version+1;ee>H.version&&(H.version=ee)}return!0}return!1}function C(H){return new u(function(Q,$){var te=new FileReader;te.onerror=$,te.onloadend=function(re){var ee=btoa(re.target.result||"");Q({__local_forage_encoded_blob:!0,data:ee,type:H.type})},te.readAsBinaryString(H)})}function P(H){var Q=x(atob(H.data));return p([Q],{type:H.type})}function M(H){return H&&H.__local_forage_encoded_blob}function N(H){var Q=this,$=Q._initReady().then(function(){var te=c[Q._dbInfo.name];if(te&&te.dbReady)return te.dbReady});return g($,H,H),$}function B(H){A(H);for(var Q=c[H.name],$=Q.forages,te=0;te<$.length;te++){var re=$[te];re._dbInfo.db&&(re._dbInfo.db.close(),re._dbInfo.db=null)}return H.db=null,O(H).then(function(ee){return H.db=ee,D(H)?I(H):ee}).then(function(ee){H.db=Q.db=ee;for(var ve=0;ve<$.length;ve++)$[ve]._dbInfo.db=ee}).catch(function(ee){throw R(H,ee),ee})}function U(H,Q,$,te){te===void 0&&(te=1);try{var re=H.db.transaction(H.storeName,Q);$(null,re)}catch(ee){if(te>0&&(!H.db||ee.name==="InvalidStateError"||ee.name==="NotFoundError"))return u.resolve().then(function(){if(!H.db||ee.name==="NotFoundError"&&!H.db.objectStoreNames.contains(H.storeName)&&H.version<=H.db.version)return H.db&&(H.version=H.db.version+1),I(H)}).then(function(){return B(H).then(function(){U(H,Q,$,te-1)})}).catch($);$(ee)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function j(H){var Q=this,$={db:null};if(H)for(var te in H)$[te]=H[te];var re=c[$.name];re||(re=F(),c[$.name]=re),re.forages.push(Q),Q._initReady||(Q._initReady=Q.ready,Q.ready=N);var ee=[];function ve(){return u.resolve()}for(var Te=0;Te<re.forages.length;Te++){var Oe=re.forages[Te];Oe!==Q&&ee.push(Oe._initReady().catch(ve))}var Le=re.forages.slice(0);return u.all(ee).then(function(){return $.db=re.db,O($)}).then(function(De){return $.db=De,D($,Q._defaultConfig.version)?I($):De}).then(function(De){$.db=re.db=De,Q._dbInfo=$;for(var Ve=0;Ve<Le.length;Ve++){var it=Le[Ve];it!==Q&&(it._dbInfo.db=$.db,it._dbInfo.version=$.version)}})}function V(H,Q){var $=this;H=E(H);var te=new u(function(re,ee){$.ready().then(function(){U($._dbInfo,y,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore($._dbInfo.storeName),Le=Oe.get(H);Le.onsuccess=function(){var De=Le.result;De===void 0&&(De=null),M(De)&&(De=P(De)),re(De)},Le.onerror=function(){ee(Le.error)}}catch(De){ee(De)}})}).catch(ee)});return f(te,Q),te}function G(H,Q){var $=this,te=new u(function(re,ee){$.ready().then(function(){U($._dbInfo,y,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore($._dbInfo.storeName),Le=Oe.openCursor(),De=1;Le.onsuccess=function(){var Ve=Le.result;if(Ve){var it=Ve.value;M(it)&&(it=P(it));var ft=H(it,Ve.key,De++);ft!==void 0?re(ft):Ve.continue()}else re()},Le.onerror=function(){ee(Le.error)}}catch(Ve){ee(Ve)}})}).catch(ee)});return f(te,Q),te}function Y(H,Q,$){var te=this;H=E(H);var re=new u(function(ee,ve){var Te;te.ready().then(function(){return Te=te._dbInfo,v.call(Q)==="[object Blob]"?T(Te.db).then(function(Oe){return Oe?Q:C(Q)}):Q}).then(function(Oe){U(te._dbInfo,d,function(Le,De){if(Le)return ve(Le);try{var Ve=De.objectStore(te._dbInfo.storeName);Oe===null&&(Oe=void 0);var it=Ve.put(Oe,H);De.oncomplete=function(){Oe===void 0&&(Oe=null),ee(Oe)},De.onabort=De.onerror=function(){var ft=it.error?it.error:it.transaction.error;ve(ft)}}catch(ft){ve(ft)}})}).catch(ve)});return f(re,$),re}function X(H,Q){var $=this;H=E(H);var te=new u(function(re,ee){$.ready().then(function(){U($._dbInfo,d,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore($._dbInfo.storeName),Le=Oe.delete(H);Te.oncomplete=function(){re()},Te.onerror=function(){ee(Le.error)},Te.onabort=function(){var De=Le.error?Le.error:Le.transaction.error;ee(De)}}catch(De){ee(De)}})}).catch(ee)});return f(te,Q),te}function ie(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){U(Q._dbInfo,d,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.clear();ve.oncomplete=function(){te()},ve.onabort=ve.onerror=function(){var Le=Oe.error?Oe.error:Oe.transaction.error;re(Le)}}catch(Le){re(Le)}})}).catch(re)});return f($,H),$}function he(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){U(Q._dbInfo,y,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.count();Oe.onsuccess=function(){te(Oe.result)},Oe.onerror=function(){re(Oe.error)}}catch(Le){re(Le)}})}).catch(re)});return f($,H),$}function de(H,Q){var $=this,te=new u(function(re,ee){if(H<0){re(null);return}$.ready().then(function(){U($._dbInfo,y,function(ve,Te){if(ve)return ee(ve);try{var Oe=Te.objectStore($._dbInfo.storeName),Le=!1,De=Oe.openKeyCursor();De.onsuccess=function(){var Ve=De.result;if(!Ve){re(null);return}H===0||Le?re(Ve.key):(Le=!0,Ve.advance(H))},De.onerror=function(){ee(De.error)}}catch(Ve){ee(Ve)}})}).catch(ee)});return f(te,Q),te}function Ae(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){U(Q._dbInfo,y,function(ee,ve){if(ee)return re(ee);try{var Te=ve.objectStore(Q._dbInfo.storeName),Oe=Te.openKeyCursor(),Le=[];Oe.onsuccess=function(){var De=Oe.result;if(!De){te(Le);return}Le.push(De.key),De.continue()},Oe.onerror=function(){re(Oe.error)}}catch(De){re(De)}})}).catch(re)});return f($,H),$}function pe(H,Q){Q=S.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var te=this,re;if(!H.name)re=u.reject("Invalid arguments");else{var ee=H.name===$.name&&te._dbInfo.db,ve=ee?u.resolve(te._dbInfo.db):O(H).then(function(Te){var Oe=c[H.name],Le=Oe.forages;Oe.db=Te;for(var De=0;De<Le.length;De++)Le[De]._dbInfo.db=Te;return Te});H.storeName?re=ve.then(function(Te){if(!!Te.objectStoreNames.contains(H.storeName)){var Oe=Te.version+1;A(H);var Le=c[H.name],De=Le.forages;Te.close();for(var Ve=0;Ve<De.length;Ve++){var it=De[Ve];it._dbInfo.db=null,it._dbInfo.version=Oe}var ft=new u(function(ct,It){var wt=l.open(H.name,Oe);wt.onerror=function(mr){var Pn=wt.result;Pn.close(),It(mr)},wt.onupgradeneeded=function(){var mr=wt.result;mr.deleteObjectStore(H.storeName)},wt.onsuccess=function(){var mr=wt.result;mr.close(),ct(mr)}});return ft.then(function(ct){Le.db=ct;for(var It=0;It<De.length;It++){var wt=De[It];wt._dbInfo.db=ct,L(wt._dbInfo)}}).catch(function(ct){throw(R(H,ct)||u.resolve()).catch(function(){}),ct})}}):re=ve.then(function(Te){A(H);var Oe=c[H.name],Le=Oe.forages;Te.close();for(var De=0;De<Le.length;De++){var Ve=Le[De];Ve._dbInfo.db=null}var it=new u(function(ft,ct){var It=l.deleteDatabase(H.name);It.onerror=function(){var wt=It.result;wt&&wt.close(),ct(It.error)},It.onblocked=function(){console.warn('dropInstance blocked for database "'+H.name+'" until all open connections are closed')},It.onsuccess=function(){var wt=It.result;wt&&wt.close(),ft(wt)}});return it.then(function(ft){Oe.db=ft;for(var ct=0;ct<Le.length;ct++){var It=Le[ct];L(It._dbInfo)}}).catch(function(ft){throw(R(H,ft)||u.resolve()).catch(function(){}),ft})})}return f(re,Q),re}var le={_driver:"asyncStorage",_initStorage:j,_support:h(),iterate:G,getItem:V,setItem:Y,removeItem:X,clear:ie,length:he,key:de,keys:Ae,dropInstance:pe};function Ie(){return typeof openDatabase=="function"}var Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ue="~~local_forage_type~",Me=/^~~local_forage_type~([^~]+)~/,ze="__lfsc__:",Ge=ze.length,$e="arbf",He="blob",Fe="si08",Se="ui08",Xe="uic8",st="si16",et="si32",ot="ur16",nt="ui32",dt="fl32",ne="fl64",Ee=Ge+$e.length,xe=Object.prototype.toString;function we(H){var Q=H.length*.75,$=H.length,te,re=0,ee,ve,Te,Oe;H[H.length-1]==="="&&(Q--,H[H.length-2]==="="&&Q--);var Le=new ArrayBuffer(Q),De=new Uint8Array(Le);for(te=0;te<$;te+=4)ee=Ce.indexOf(H[te]),ve=Ce.indexOf(H[te+1]),Te=Ce.indexOf(H[te+2]),Oe=Ce.indexOf(H[te+3]),De[re++]=ee<<2|ve>>4,De[re++]=(ve&15)<<4|Te>>2,De[re++]=(Te&3)<<6|Oe&63;return Le}function be(H){var Q=new Uint8Array(H),$="",te;for(te=0;te<Q.length;te+=3)$+=Ce[Q[te]>>2],$+=Ce[(Q[te]&3)<<4|Q[te+1]>>4],$+=Ce[(Q[te+1]&15)<<2|Q[te+2]>>6],$+=Ce[Q[te+2]&63];return Q.length%3==2?$=$.substring(0,$.length-1)+"=":Q.length%3==1&&($=$.substring(0,$.length-2)+"=="),$}function je(H,Q){var $="";if(H&&($=xe.call(H)),H&&($==="[object ArrayBuffer]"||H.buffer&&xe.call(H.buffer)==="[object ArrayBuffer]")){var te,re=ze;H instanceof ArrayBuffer?(te=H,re+=$e):(te=H.buffer,$==="[object Int8Array]"?re+=Fe:$==="[object Uint8Array]"?re+=Se:$==="[object Uint8ClampedArray]"?re+=Xe:$==="[object Int16Array]"?re+=st:$==="[object Uint16Array]"?re+=ot:$==="[object Int32Array]"?re+=et:$==="[object Uint32Array]"?re+=nt:$==="[object Float32Array]"?re+=dt:$==="[object Float64Array]"?re+=ne:Q(new Error("Failed to get type for BinaryArray"))),Q(re+be(te))}else if($==="[object Blob]"){var ee=new FileReader;ee.onload=function(){var ve=Ue+H.type+"~"+be(this.result);Q(ze+He+ve)},ee.readAsArrayBuffer(H)}else try{Q(JSON.stringify(H))}catch(ve){console.error("Couldn't convert value into a JSON string: ",H),Q(null,ve)}}function K(H){if(H.substring(0,Ge)!==ze)return JSON.parse(H);var Q=H.substring(Ee),$=H.substring(Ge,Ee),te;if($===He&&Me.test(Q)){var re=Q.match(Me);te=re[1],Q=Q.substring(re[0].length)}var ee=we(Q);switch($){case $e:return ee;case He:return p([ee],{type:te});case Fe:return new Int8Array(ee);case Se:return new Uint8Array(ee);case Xe:return new Uint8ClampedArray(ee);case st:return new Int16Array(ee);case ot:return new Uint16Array(ee);case et:return new Int32Array(ee);case nt:return new Uint32Array(ee);case dt:return new Float32Array(ee);case ne:return new Float64Array(ee);default:throw new Error("Unkown type: "+$)}}var ce={serialize:je,deserialize:K,stringToBuffer:we,bufferToString:be};function _e(H,Q,$,te){H.executeSql("CREATE TABLE IF NOT EXISTS "+Q.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],$,te)}function Re(H){var Q=this,$={db:null};if(H)for(var te in H)$[te]=typeof H[te]!="string"?H[te].toString():H[te];var re=new u(function(ee,ve){try{$.db=openDatabase($.name,String($.version),$.description,$.size)}catch(Te){return ve(Te)}$.db.transaction(function(Te){_e(Te,$,function(){Q._dbInfo=$,ee()},function(Oe,Le){ve(Le)})},ve)});return $.serializer=ce,re}function Z(H,Q,$,te,re,ee){H.executeSql($,te,re,function(ve,Te){Te.code===Te.SYNTAX_ERR?ve.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Q.storeName],function(Oe,Le){Le.rows.length?ee(Oe,Te):_e(Oe,Q,function(){Oe.executeSql($,te,re,ee)},ee)},ee):ee(ve,Te)},ee)}function ue(H,Q){var $=this;H=E(H);var te=new u(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT * FROM "+ve.storeName+" WHERE key = ? LIMIT 1",[H],function(Oe,Le){var De=Le.rows.length?Le.rows.item(0).value:null;De&&(De=ve.serializer.deserialize(De)),re(De)},function(Oe,Le){ee(Le)})})}).catch(ee)});return f(te,Q),te}function W(H,Q){var $=this,te=new u(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT * FROM "+ve.storeName,[],function(Oe,Le){for(var De=Le.rows,Ve=De.length,it=0;it<Ve;it++){var ft=De.item(it),ct=ft.value;if(ct&&(ct=ve.serializer.deserialize(ct)),ct=H(ct,ft.key,it+1),ct!==void 0){re(ct);return}}re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return f(te,Q),te}function me(H,Q,$,te){var re=this;H=E(H);var ee=new u(function(ve,Te){re.ready().then(function(){Q===void 0&&(Q=null);var Oe=Q,Le=re._dbInfo;Le.serializer.serialize(Q,function(De,Ve){Ve?Te(Ve):Le.db.transaction(function(it){Z(it,Le,"INSERT OR REPLACE INTO "+Le.storeName+" (key, value) VALUES (?, ?)",[H,De],function(){ve(Oe)},function(ft,ct){Te(ct)})},function(it){if(it.code===it.QUOTA_ERR){if(te>0){ve(me.apply(re,[H,Oe,$,te-1]));return}Te(it)}})})}).catch(Te)});return f(ee,$),ee}function Ke(H,Q,$){return me.apply(this,[H,Q,$,1])}function k(H,Q){var $=this;H=E(H);var te=new u(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"DELETE FROM "+ve.storeName+" WHERE key = ?",[H],function(){re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return f(te,Q),te}function oe(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"DELETE FROM "+ee.storeName,[],function(){te()},function(Te,Oe){re(Oe)})})}).catch(re)});return f($,H),$}function fe(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT COUNT(key) as c FROM "+ee.storeName,[],function(Te,Oe){var Le=Oe.rows.item(0).c;te(Le)},function(Te,Oe){re(Oe)})})}).catch(re)});return f($,H),$}function z(H,Q){var $=this,te=new u(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Te){Z(Te,ve,"SELECT key FROM "+ve.storeName+" WHERE id = ? LIMIT 1",[H+1],function(Oe,Le){var De=Le.rows.length?Le.rows.item(0).key:null;re(De)},function(Oe,Le){ee(Le)})})}).catch(ee)});return f(te,Q),te}function J(H){var Q=this,$=new u(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT key FROM "+ee.storeName,[],function(Te,Oe){for(var Le=[],De=0;De<Oe.rows.length;De++)Le.push(Oe.rows.item(De).key);te(Le)},function(Te,Oe){re(Oe)})})}).catch(re)});return f($,H),$}function ae(H){return new u(function(Q,$){H.transaction(function(te){te.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(re,ee){for(var ve=[],Te=0;Te<ee.rows.length;Te++)ve.push(ee.rows.item(Te).name);Q({db:H,storeNames:ve})},function(re,ee){$(ee)})},function(te){$(te)})})}function We(H,Q){Q=S.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var te=this,re;return H.name?re=new u(function(ee){var ve;H.name===$.name?ve=te._dbInfo.db:ve=openDatabase(H.name,"","",0),H.storeName?ee({db:ve,storeNames:[H.storeName]}):ee(ae(ve))}).then(function(ee){return new u(function(ve,Te){ee.db.transaction(function(Oe){function Le(ft){return new u(function(ct,It){Oe.executeSql("DROP TABLE IF EXISTS "+ft,[],function(){ct()},function(wt,mr){It(mr)})})}for(var De=[],Ve=0,it=ee.storeNames.length;Ve<it;Ve++)De.push(Le(ee.storeNames[Ve]));u.all(De).then(function(){ve()}).catch(function(ft){Te(ft)})},function(Oe){Te(Oe)})})}):re=u.reject("Invalid arguments"),f(re,Q),re}var ke={_driver:"webSQLStorage",_initStorage:Re,_support:Ie(),iterate:W,getItem:ue,setItem:Ke,removeItem:k,clear:oe,length:fe,key:z,keys:J,dropInstance:We};function Ne(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(H){return!1}}function rt(H,Q){var $=H.name+"/";return H.storeName!==Q.storeName&&($+=H.storeName+"/"),$}function nr(){var H="_localforage_support_test";try{return localStorage.setItem(H,!0),localStorage.removeItem(H),!1}catch(Q){return!0}}function vt(){return!nr()||localStorage.length>0}function at(H){var Q=this,$={};if(H)for(var te in H)$[te]=H[te];return $.keyPrefix=rt(H,Q._defaultConfig),vt()?(Q._dbInfo=$,$.serializer=ce,u.resolve()):u.reject()}function At(H){var Q=this,$=Q.ready().then(function(){for(var te=Q._dbInfo.keyPrefix,re=localStorage.length-1;re>=0;re--){var ee=localStorage.key(re);ee.indexOf(te)===0&&localStorage.removeItem(ee)}});return f($,H),$}function Pt(H,Q){var $=this;H=E(H);var te=$.ready().then(function(){var re=$._dbInfo,ee=localStorage.getItem(re.keyPrefix+H);return ee&&(ee=re.serializer.deserialize(ee)),ee});return f(te,Q),te}function jt(H,Q){var $=this,te=$.ready().then(function(){for(var re=$._dbInfo,ee=re.keyPrefix,ve=ee.length,Te=localStorage.length,Oe=1,Le=0;Le<Te;Le++){var De=localStorage.key(Le);if(De.indexOf(ee)===0){var Ve=localStorage.getItem(De);if(Ve&&(Ve=re.serializer.deserialize(Ve)),Ve=H(Ve,De.substring(ve),Oe++),Ve!==void 0)return Ve}}});return f(te,Q),te}function $i(H,Q){var $=this,te=$.ready().then(function(){var re=$._dbInfo,ee;try{ee=localStorage.key(H)}catch(ve){ee=null}return ee&&(ee=ee.substring(re.keyPrefix.length)),ee});return f(te,Q),te}function Gi(H){var Q=this,$=Q.ready().then(function(){for(var te=Q._dbInfo,re=localStorage.length,ee=[],ve=0;ve<re;ve++){var Te=localStorage.key(ve);Te.indexOf(te.keyPrefix)===0&&ee.push(Te.substring(te.keyPrefix.length))}return ee});return f($,H),$}function xt(H){var Q=this,$=Q.keys().then(function(te){return te.length});return f($,H),$}function qt(H,Q){var $=this;H=E(H);var te=$.ready().then(function(){var re=$._dbInfo;localStorage.removeItem(re.keyPrefix+H)});return f(te,Q),te}function Dt(H,Q,$){var te=this;H=E(H);var re=te.ready().then(function(){Q===void 0&&(Q=null);var ee=Q;return new u(function(ve,Te){var Oe=te._dbInfo;Oe.serializer.serialize(Q,function(Le,De){if(De)Te(De);else try{localStorage.setItem(Oe.keyPrefix+H,Le),ve(ee)}catch(Ve){(Ve.name==="QuotaExceededError"||Ve.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Te(Ve),Te(Ve)}})})});return f(re,$),re}function Dr(H,Q){if(Q=S.apply(this,arguments),H=typeof H!="function"&&H||{},!H.name){var $=this.config();H.name=H.name||$.name,H.storeName=H.storeName||$.storeName}var te=this,re;return H.name?re=new u(function(ee){H.storeName?ee(rt(H,te._defaultConfig)):ee(H.name+"/")}).then(function(ee){for(var ve=localStorage.length-1;ve>=0;ve--){var Te=localStorage.key(ve);Te.indexOf(ee)===0&&localStorage.removeItem(Te)}}):re=u.reject("Invalid arguments"),f(re,Q),re}var gr={_driver:"localStorageWrapper",_initStorage:at,_support:Ne(),iterate:jt,getItem:Pt,setItem:Dt,removeItem:qt,clear:At,length:xt,key:$i,keys:Gi,dropInstance:Dr},Ia=function(Q,$){return Q===$||typeof Q=="number"&&typeof $=="number"&&isNaN(Q)&&isNaN($)},Mh=function(Q,$){for(var te=Q.length,re=0;re<te;){if(Ia(Q[re],$))return!0;re++}return!1},ou=Array.isArray||function(H){return Object.prototype.toString.call(H)==="[object Array]"},Cn={},lu={},Yi={INDEXEDDB:le,WEBSQL:ke,LOCALSTORAGE:gr},kh=[Yi.INDEXEDDB._driver,Yi.WEBSQL._driver,Yi.LOCALSTORAGE._driver],Ra=["dropInstance"],po=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ra),Nh={description:"",driver:kh.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fh(H,Q){H[Q]=function(){var $=arguments;return H.ready().then(function(){return H[Q].apply(H,$)})}}function vo(){for(var H=1;H<arguments.length;H++){var Q=arguments[H];if(Q)for(var $ in Q)Q.hasOwnProperty($)&&(ou(Q[$])?arguments[0][$]=Q[$].slice():arguments[0][$]=Q[$])}return arguments[0]}var Bh=function(){function H(Q){a(this,H);for(var $ in Yi)if(Yi.hasOwnProperty($)){var te=Yi[$],re=te._driver;this[$]=re,Cn[re]||this.defineDriver(te)}this._defaultConfig=vo({},Nh),this._config=vo({},this._defaultConfig,Q),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return H.prototype.config=function($){if((typeof $=="undefined"?"undefined":n($))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var te in $){if(te==="storeName"&&($[te]=$[te].replace(/\W/g,"_")),te==="version"&&typeof $[te]!="number")return new Error("Database version must be a number.");this._config[te]=$[te]}return"driver"in $&&$.driver?this.setDriver(this._config.driver):!0}else return typeof $=="string"?this._config[$]:this._config},H.prototype.defineDriver=function($,te,re){var ee=new u(function(ve,Te){try{var Oe=$._driver,Le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!$._driver){Te(Le);return}for(var De=po.concat("_initStorage"),Ve=0,it=De.length;Ve<it;Ve++){var ft=De[Ve],ct=!Mh(Ra,ft);if((ct||$[ft])&&typeof $[ft]!="function"){Te(Le);return}}var It=function(){for(var Pn=function(Wh){return function(){var zh=new Error("Method "+Wh+" is not implemented by the current driver"),uu=u.reject(zh);return f(uu,arguments[arguments.length-1]),uu}},go=0,jh=Ra.length;go<jh;go++){var mo=Ra[go];$[mo]||($[mo]=Pn(mo))}};It();var wt=function(Pn){Cn[Oe]&&console.info("Redefining LocalForage driver: "+Oe),Cn[Oe]=$,lu[Oe]=Pn,ve()};"_support"in $?$._support&&typeof $._support=="function"?$._support().then(wt,Te):wt(!!$._support):wt(!0)}catch(mr){Te(mr)}});return g(ee,te,re),ee},H.prototype.driver=function(){return this._driver||null},H.prototype.getDriver=function($,te,re){var ee=Cn[$]?u.resolve(Cn[$]):u.reject(new Error("Driver not found."));return g(ee,te,re),ee},H.prototype.getSerializer=function($){var te=u.resolve(ce);return g(te,$),te},H.prototype.ready=function($){var te=this,re=te._driverSet.then(function(){return te._ready===null&&(te._ready=te._initDriver()),te._ready});return g(re,$,$),re},H.prototype.setDriver=function($,te,re){var ee=this;ou($)||($=[$]);var ve=this._getSupportedDrivers($);function Te(){ee._config.driver=ee.driver()}function Oe(Ve){return ee._extend(Ve),Te(),ee._ready=ee._initStorage(ee._config),ee._ready}function Le(Ve){return function(){var it=0;function ft(){for(;it<Ve.length;){var ct=Ve[it];return it++,ee._dbInfo=null,ee._ready=null,ee.getDriver(ct).then(Oe).catch(ft)}Te();var It=new Error("No available storage method found.");return ee._driverSet=u.reject(It),ee._driverSet}return ft()}}var De=this._driverSet!==null?this._driverSet.catch(function(){return u.resolve()}):u.resolve();return this._driverSet=De.then(function(){var Ve=ve[0];return ee._dbInfo=null,ee._ready=null,ee.getDriver(Ve).then(function(it){ee._driver=it._driver,Te(),ee._wrapLibraryMethodsWithReady(),ee._initDriver=Le(ve)})}).catch(function(){Te();var Ve=new Error("No available storage method found.");return ee._driverSet=u.reject(Ve),ee._driverSet}),g(this._driverSet,te,re),this._driverSet},H.prototype.supports=function($){return!!lu[$]},H.prototype._extend=function($){vo(this,$)},H.prototype._getSupportedDrivers=function($){for(var te=[],re=0,ee=$.length;re<ee;re++){var ve=$[re];this.supports(ve)&&te.push(ve)}return te},H.prototype._wrapLibraryMethodsWithReady=function(){for(var $=0,te=po.length;$<te;$++)Fh(this,po[$])},H.prototype.createInstance=function($){return new H($)},H}(),Uh=new Bh;i.exports=Uh},{"3":3}]},{},[4])(4)})})(Yc);Object.defineProperty(io,"__esModule",{value:!0});io.default=void 0;var li=Be,oS=Aa(Bi),Gl=Aa(Tn),lS=Aa(Qr),uS=Aa(Ar.exports),Xc=Aa(Yc.exports);function Aa(s){return s&&s.__esModule?s:{default:s}}class Zc{constructor(e,r,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=r||oS.default,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Xc.default=="undefined"&&(e=Xc.default),this.storage=e.createInstance({name:this.name})}catch(e){throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let r=navigator.onLine;this.online=r,r?this.emit("online",this):this.emit("offline",this)}add(e,r){let i=e.resources.map(t=>{let{href:n}=t,a=this.resolver(n),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||r?this.requester(a,"binary").then(h=>this.storage.setItem(o,h)):l)});return Promise.all(i)}put(e,r,i){let t=window.encodeURIComponent(e);return this.storage.getItem(t).then(n=>n||this.requester(e,"binary",r,i).then(a=>this.storage.setItem(t,a)))}request(e,r,i,t){return this.online?this.requester(e,r,i,t).then(n=>(this.put(e),n)):this.retrieve(e,r)}retrieve(e,r){new li.defer;var i,t=new lS.default(e);return r||(r=t.extension),r=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(n=>{var a=new li.defer,o;return n?(o=this.handleResponse(n,r),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,li.isXml)(r)?i=(0,li.parse)(e,"text/xml"):r=="xhtml"?i=(0,li.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,li.parse)(e,"text/html"):i=e,i}getBlob(e,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(t){if(!!t)return r=r||Gl.default.lookup(e),new Blob([t],{type:r})})}getText(e,r){let i=window.encodeURIComponent(e);return r=r||Gl.default.lookup(e),this.storage.getItem(i).then(function(t){var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsText(o,r),n.promise})}getBase64(e,r){let i=window.encodeURIComponent(e);return r=r||Gl.default.lookup(e),this.storage.getItem(i).then(t=>{var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsDataURL(o,r),n.promise})}createUrl(e,r){var i=new li.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){n=t.createObjectURL(l),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.urlCache={},this.removeListeners()}}(0,uS.default)(Zc.prototype);var fS=Zc;io.default=fS;var no={};Object.defineProperty(no,"__esModule",{value:!0});no.default=void 0;var Qc=Be;class dS{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const r=(0,Qc.qs)(e,"display_options");return r?((0,Qc.qsa)(r,"option").forEach(t=>{let n="";switch(t.childNodes.length&&(n=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":this.interactive=n;break;case"fixed-layout":this.fixedLayout=n;break;case"open-to-spread":this.openToSpread=n;break;case"orientation-lock":this.orientationLock=n;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var cS=dS;no.default=cS;Object.defineProperty(ta,"__esModule",{value:!0});ta.default=void 0;var hS=Xt(Ar.exports),Ur=Be,Si=Xt(ki),Jc=Xt(Qr),pS=Xt(Ms),vS=Xt(Ns),gS=Xt(Bs),qc=Xt(Us),Yl=Xt(js),mS=Xt(Ws),Xl=Xt(Vs),yS=Xt(An),ES=Xt(to),eh=Xt(Bi),_S=Xt(Qt),xS=Xt(io),Zl=Xt(no),th=Nt;function Xt(s){return s&&s.__esModule?s:{default:s}}const rh="META-INF/container.xml",bS="META-INF/com.apple.ibooks.display-options.xml",jr={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ih{constructor(e,r){typeof r=="undefined"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(r=e,e=void 0),this.settings=(0,Ur.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,Ur.extend)(this.settings,r),this.opening=new Ur.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Ur.defer,spine:new Ur.defer,metadata:new Ur.defer,cover:new Ur.defer,navigation:new Ur.defer,pageList:new Ur.defer,resources:new Ur.defer,displayOptions:new Ur.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||eh.default,this.spine=new pS.default,this.locations=new vS.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var t=new Error("Cannot load book at "+e);this.emit(th.EVENTS.BOOK.OPEN_FAILED,t)})}open(e,r){var i,t=r||this.determineType(e);return t===jr.BINARY?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e)):t===jr.BASE64?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e,t)):t===jr.EPUB?(this.archived=!0,this.url=new Si.default("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):t==jr.OPF?(this.url=new Si.default(e),i=this.openPackaging(this.url.Path.toString())):t==jr.MANIFEST?(this.url=new Si.default(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Si.default(e),i=this.openContainer(rh).then(this.openPackaging.bind(this))),i}openEpub(e,r){return this.unarchive(e,r||this.settings.encoding).then(()=>this.openContainer(rh)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(r=>(this.container=new gS.default(r),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default(r),this.unpack(this.packaging)))}openManifest(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default,this.packaging.load(r),this.unpack(this.packaging)))}load(e){var r=this.resolve(e);return this.archived?this.archive.request(r):this.request(r,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,r){if(!!e){var i=e,t=e.indexOf("://")>-1;return t?e:(this.path&&(i=this.path.resolve(e)),r!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var r=e;return e?(this.settings.canonical?r=this.settings.canonical(e):r=this.resolve(e,!0),r):""}determineType(e){var r,i,t;if(this.settings.encoding==="base64")return jr.BASE64;if(typeof e!="string")return jr.BINARY;if(r=new Si.default(e),i=r.path(),t=i.extension,t&&(t=t.replace(/\?.*$/,"")),!t)return jr.DIRECTORY;if(t==="epub")return jr.EPUB;if(t==="opf")return jr.OPF;if(t==="json")return jr.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(bS)).then(r=>{this.displayOptions=new Zl.default(r),this.loading.displayOptions.resolve(this.displayOptions)}).catch(r=>{this.displayOptions=new Zl.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Zl.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new mS.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(r=>{console.error(r)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let r=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((t,n)=>{this.navigation=new Yl.default(i),e.pageList&&(this.pageList=new Xl.default(e.pageList)),t(this.navigation)}):r?this.load(r,"xml").then(t=>(this.navigation=new Yl.default(t),this.pageList=new Xl.default(t),this.navigation)):new Promise((t,n)=>{this.navigation=new Yl.default,this.pageList=new Xl.default,t(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,r){return this.rendition=new yS.default(this,r),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,r){return this.archive=new ES.default,this.archive.open(e,r)}store(e){let r=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,t=this.settings.requestMethod||eh.default.bind(this);return this.storage=new xS.default(e,t,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=r||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Si.default("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,r)=>{r.output=this.resources.substitute(e,r.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var r=new _S.default(e),i=this.spine.get(r.spinePos),t=this.load.bind(this);return i?i.load(t).then(function(n){var a=r.toRange(i.document);return a}):new Promise((n,a)=>{a("CFI could not be found")})}key(e){var r=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${th.EPUBJS_VERSION}:${r}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,hS.default)(ih.prototype);var SS=ih;ta.default=SS;var ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.default=void 0;var nh=Vi(ta),TS=Vi(An),AS=Vi(Qt),wS=Vi(ji),OS=LS(Be),ah=Nt;Vi(Ea);Vi(On);Vi(Sa);function sh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(sh=function(i){return i?r:e})(s)}function LS(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||typeof s!="object"&&typeof s!="function")return{default:s};var r=sh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Vi(s){return s&&s.__esModule?s:{default:s}}function Ki(s,e){return new nh.default(s,e)}Ki.VERSION=ah.EPUBJS_VERSION;typeof Wt!="undefined"&&(Wt.EPUBJS_VERSION=ah.EPUBJS_VERSION);Ki.Book=nh.default;Ki.Rendition=TS.default;Ki.Contents=wS.default;Ki.CFI=AS.default;Ki.utils=OS;var IS=Ki;ao.default=IS;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"Contents",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(s,"EpubCFI",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"Layout",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(s,"Rendition",{enumerable:!0,get:function(){return i.default}}),s.default=void 0;var e=o(ta),r=o(Qt),i=o(An),t=o(ji),n=o(ma),a=o(ao);function o(h){return h&&h.__esModule?h:{default:h}}var l=a.default;s.default=l})(ed);var wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.default=void 0;var RS={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}},DS=RS;wa.default=DS;function so(s){return so=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},so(s)}Object.defineProperty(xs,"__esModule",{value:!0});xs.default=void 0;var oo=MS(Ye.exports),Jt=Ql(gl.exports),CS=Ql(ed),PS=Ql(wa);function Ql(s){return s&&s.__esModule?s:{default:s}}function oh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(oh=function(t){return t?r:e})(s)}function MS(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||so(s)!=="object"&&typeof s!="function")return{default:s};var r=oh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function lh(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function kS(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lh(Object(r),!0).forEach(function(i){eu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):lh(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function NS(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function uh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function FS(s,e,r){return e&&uh(s.prototype,e),r&&uh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function BS(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Jl(s,e)}function Jl(s,e){return Jl=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},Jl(s,e)}function US(s){var e=WS();return function(){var i=lo(s),t;if(e){var n=lo(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return jS(this,t)}}function jS(s,e){if(e&&(so(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ql(s)}function ql(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function WS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function lo(s){return lo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},lo(s)}function eu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var tu=function(s){BS(r,s);var e=US(r);function r(i){var t;return NS(this,r),t=e.call(this,i),eu(ql(t),"onLocationChange",function(n){var a=t.props,o=a.location,l=a.locationChanged,h=n&&n.start;o!==h&&(t.location=h,l&&l(h))}),eu(ql(t),"handleKeyPress",function(n){var a=n.key;a&&a==="ArrowRight"&&t.nextPage(),a&&a==="ArrowLeft"&&t.prevPage()}),t.state={isLoaded:!1,toc:[]},t.viewerRef=oo.default.createRef(),t.location=i.location,t.book=t.rendition=t.prevPage=t.nextPage=null,t}return FS(r,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var t=this,n=this.props,a=n.url,o=n.tocChanged,l=n.epubInitOptions;this.book&&this.book.destroy(),this.book=new CS.default(a,l),this.book.loaded.navigation.then(function(h){var p=h.toc;t.setState({isLoaded:!0,toc:p},function(){o&&o(p),t.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(t){return!this.state.isLoaded||t.location!==this.props.location||t.location!==this.props.location}},{key:"componentDidUpdate",value:function(t){t.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),t.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var t=this,n=this.state.toc,a=this.props,o=a.location,l=a.epubOptions,h=a.getRendition,p=this.viewerRef.current;this.rendition=this.book.renderTo(p,kS({contained:!0,width:"100%",height:"100%"},l)),this.prevPage=function(){t.rendition.prev()},this.nextPage=function(){t.rendition.next()},this.registerEvents(),h&&h(this.rendition),typeof o=="string"||typeof o=="number"?this.rendition.display(o):n.length>0&&n[0].href?this.rendition.display(n[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var t=this.props,n=t.handleKeyPress,a=t.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",n||this.handleKeyPress),a&&this.rendition.on("selected",a)}},{key:"renderBook",value:function(){var t=this.props.styles;return oo.default.createElement("div",{ref:this.viewerRef,style:t.view})}},{key:"render",value:function(){var t=this.state.isLoaded,n=this.props,a=n.loadingView,o=n.styles;return oo.default.createElement("div",{style:o.viewHolder},t&&this.renderBook()||a)}}]),r}(oo.Component);tu.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,styles:PS.default,epubOptions:{},epubInitOptions:{}};tu.propTypes={url:Jt.default.oneOfType([Jt.default.string,Jt.default.instanceOf(ArrayBuffer)]),loadingView:Jt.default.element,location:Jt.default.oneOfType([Jt.default.string,Jt.default.number]),locationChanged:Jt.default.func,tocChanged:Jt.default.func,styles:Jt.default.object,epubInitOptions:Jt.default.object,epubOptions:Jt.default.object,getRendition:Jt.default.func,handleKeyPress:Jt.default.func,handleTextSelected:Jt.default.func};var zS=tu;xs.default=zS;var uo={};function Wr(){return Wr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Wr.apply(this,arguments)}var fh="Left",dh="Right",ch="Up",hh="Down",ru={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},iu={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ph="mousemove",vh="mouseup",VS="touchend",KS="touchmove",HS="touchstart";function $S(s,e,r,i){return s>e?r>0?dh:fh:i>0?hh:ch}function gh(s,e){if(e===0)return s;var r=Math.PI/180*e,i=s[0]*Math.cos(r)+s[1]*Math.sin(r),t=s[1]*Math.cos(r)-s[0]*Math.sin(r);return[i,t]}function GS(s,e){var r=function(u){u&&"touches"in u&&u.touches.length>1||s(function(f,g){g.trackMouse&&(document.addEventListener(ph,i),document.addEventListener(vh,a));var E="touches"in u?u.touches[0]:u,S=E.clientX,_=E.clientY,m=gh([S,_],g.rotationAngle);return Wr({},f,iu,{initial:[].concat(m),xy:m,start:u.timeStamp||0})})},i=function(u){s(function(f,g){if("touches"in u&&u.touches.length>1)return f;var E="touches"in u?u.touches[0]:u,S=E.clientX,_=E.clientY,m=gh([S,_],g.rotationAngle),c=m[0],v=m[1],y=c-f.xy[0],d=v-f.xy[1],x=Math.abs(y),b=Math.abs(d),T=(u.timeStamp||0)-f.start,A=Math.sqrt(x*x+b*b)/(T||1),L=[y/(T||1),d/(T||1)],R=$S(x,b,y,d),w=typeof g.delta=="number"?g.delta:g.delta[R.toLowerCase()]||ru.delta;if(x<w&&b<w&&!f.swiping)return f;var O={absX:x,absY:b,deltaX:y,deltaY:d,dir:R,event:u,first:f.first,initial:f.initial,velocity:A,vxvy:L};O.first&&g.onSwipeStart&&g.onSwipeStart(O),g.onSwiping&&g.onSwiping(O);var I=!1;return(g.onSwiping||g.onSwiped||"onSwiped"+R in g)&&(I=!0),I&&g.preventDefaultTouchmoveEvent&&g.trackTouch&&u.cancelable&&u.preventDefault(),Wr({},f,{first:!1,eventData:O,swiping:!0})})},t=function(u){s(function(f,g){var E;if(f.swiping&&f.eventData){E=Wr({},f.eventData,{event:u}),g.onSwiped&&g.onSwiped(E);var S=g["onSwiped"+E.dir];S&&S(E)}else g.onTap&&g.onTap({event:u});return Wr({},f,iu,{eventData:E})})},n=function(){document.removeEventListener(ph,i),document.removeEventListener(vh,a)},a=function(u){n(),t(u)},o=function(u,f){var g=function(){};if(u&&u.addEventListener){var E=[[HS,r],[KS,i],[VS,t]];E.forEach(function(S){var _=S[0],m=S[1];return u.addEventListener(_,m,{passive:f})}),g=function(){return E.forEach(function(_){var m=_[0],c=_[1];return u.removeEventListener(m,c)})}}return g},l=function(u){u!==null&&s(function(f,g){if(f.el===u)return f;var E={};return f.el&&f.el!==u&&f.cleanUpTouch&&(f.cleanUpTouch(),E.cleanUpTouch=void 0),g.trackTouch&&u&&(E.cleanUpTouch=o(u,!g.preventDefaultTouchmoveEvent)),Wr({},f,{el:u},E)})},h={ref:l};return e.trackMouse&&(h.onMouseDown=r),[h,o]}function YS(s,e,r){var i={};return!e.trackTouch&&s.cleanUpTouch?(s.cleanUpTouch(),i.cleanUpTouch=void 0):e.trackTouch&&!s.cleanUpTouch&&s.el&&(i.cleanUpTouch=r(s.el,!e.preventDefaultTouchmoveEvent)),Wr({},s,i)}function XS(s){var e=s.trackMouse,r=Ye.exports.useRef(Wr({},iu)),i=Ye.exports.useRef(Wr({},ru));i.current=Wr({},ru,s);var t=Ye.exports.useMemo(function(){return GS(function(o){return r.current=o(r.current,i.current)},{trackMouse:e})},[e]),n=t[0],a=t[1];return r.current=YS(r.current,i.current,a),n}var ZS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DOWN:hh,LEFT:fh,RIGHT:dh,UP:ch,useSwipeable:XS}),QS=yo(ZS),Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.default=void 0;var JS={container:{overflow:"hidden",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}},qS=JS;Oa.default=qS;function fo(s){return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fo(s)}Object.defineProperty(uo,"__esModule",{value:!0});uo.default=void 0;var _t=nT(Ye.exports),Rr=yh(gl.exports),eT=QS,tT=vl,mh=yh(Oa),rT=["children"],iT=["title","showToc","loadingView","styles","locationChanged","swipeable","epubViewStyles"];function yh(s){return s&&s.__esModule?s:{default:s}}function Eh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Eh=function(t){return t?r:e})(s)}function nT(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||fo(s)!=="object"&&typeof s!="function")return{default:s};var r=Eh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function co(){return co=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},co.apply(this,arguments)}function _h(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function xh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function bh(s,e,r){return e&&xh(s.prototype,e),r&&xh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function Sh(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&nu(s,e)}function nu(s,e){return nu=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},nu(s,e)}function Th(s){var e=sT();return function(){var i=ho(s),t;if(e){var n=ho(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return aT(this,t)}}function aT(s,e){if(e&&(fo(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hi(s)}function Hi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function sT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function ho(s){return ho=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(s)}function Dn(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Ah(s,e){if(s==null)return{};var r=oT(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function oT(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}var lT=function(e){var r=e.children,i=Ah(e,rT),t=(0,eT.useSwipeable)(i);return _t.default.createElement("div",t,r)},wh=function(s){Sh(r,s);var e=Th(r);function r(){var i;_h(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),Dn(Hi(i),"setLocation",function(){i.props.setLocation(i.props.href)}),i}return bh(r,[{key:"render",value:function(){var t=this.props,n=t.label,a=t.styles;return _t.default.createElement("button",{onClick:this.setLocation,style:a},n)}}]),r}(_t.PureComponent);wh.propTypes={label:Rr.default.string,href:Rr.default.string,setLocation:Rr.default.func,styles:Rr.default.object};var au=function(s){Sh(r,s);var e=Th(r);function r(i){var t;return _h(this,r),t=e.call(this,i),Dn(Hi(t),"toggleToc",function(){t.setState({expandedToc:!t.state.expandedToc})}),Dn(Hi(t),"next",function(){var n=t.readerRef.current;n.nextPage()}),Dn(Hi(t),"prev",function(){var n=t.readerRef.current;n.prevPage()}),Dn(Hi(t),"onTocChange",function(n){var a=t.props.tocChanged;t.setState({toc:n},function(){return a&&a(n)})}),Dn(Hi(t),"setLocation",function(n){var a=t.props.locationChanged;t.setState({expandedToc:!1},function(){return a&&a(n)})}),t.readerRef=_t.default.createRef(),t.state={expandedToc:!1,toc:!1},t}return bh(r,[{key:"renderToc",value:function(){var t=this,n=this.state,a=n.toc,o=n.expandedToc,l=this.props.styles;return _t.default.createElement("div",null,_t.default.createElement("div",{style:l.tocArea},_t.default.createElement("div",{style:l.toc},a.map(function(h,p){return _t.default.createElement(wh,co({},h,{key:p,setLocation:t.setLocation,styles:l.tocAreaButton}))}))),o&&_t.default.createElement("div",{style:l.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var t=this.state.expandedToc,n=this.props.styles;return _t.default.createElement("button",{style:Object.assign({},n.tocButton,t?n.tocButtonExpanded:{}),onClick:this.toggleToc},_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBarTop)}),_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBottom)}))}},{key:"render",value:function(){var t=this.props,n=t.title,a=t.showToc,o=t.loadingView,l=t.styles,h=t.locationChanged,p=t.swipeable,u=t.epubViewStyles,f=Ah(t,iT),g=this.state,E=g.toc,S=g.expandedToc;return _t.default.createElement("div",{style:l.container},_t.default.createElement("div",{style:Object.assign({},l.readerArea,S?l.containerExpanded:{})},a&&this.renderTocToggle(),_t.default.createElement("div",{style:l.titleArea},n),_t.default.createElement(lT,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},_t.default.createElement("div",{style:l.reader},_t.default.createElement(tT.EpubView,co({ref:this.readerRef,loadingView:o,styles:u},f,{tocChanged:this.onTocChange,locationChanged:h})),p&&_t.default.createElement("div",{style:l.swipeWrapper}))),_t.default.createElement("button",{style:Object.assign({},l.arrow,l.prev),onClick:this.prev},"\u2039"),_t.default.createElement("button",{style:Object.assign({},l.arrow,l.next),onClick:this.next},"\u203A")),a&&E&&this.renderToc())}}]),r}(_t.PureComponent);au.defaultProps={loadingView:_t.default.createElement("div",{style:mh.default.loadingView},"Loading\u2026"),locationChanged:null,tocChanged:null,showToc:!0,styles:mh.default};au.propTypes={title:Rr.default.string,loadingView:Rr.default.element,showToc:Rr.default.bool,locationChanged:Rr.default.func,tocChanged:Rr.default.func,styles:Rr.default.object,epubViewStyles:Rr.default.object,swipeable:Rr.default.bool};var uT=au;uo.default=uT;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"EpubViewStyle",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"ReactReader",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"ReactReaderStyle",{enumerable:!0,get:function(){return t.default}});var e=n(xs),r=n(wa),i=n(uo),t=n(Oa);function n(a){return a&&a.__esModule?a:{default:a}}})(vl);const Oh=(s=!0)=>{const{setShowUnfold:e,unfold:r}=Ye.exports.useContext(Vr);return Ye.exports.useEffect(()=>(s&&e(!0),()=>{e(!1)}),[]),{unfold:r,setShowUnfold:e}},fT=-1,dT=["epub"],cT=({file:s})=>{const[e,r]=Ye.exports.useState(void 0),i=a=>{r(a)},{unfold:t}=Oh(!0),n=ui();return q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"epub-box"},q.createElement(vl.ReactReader,{location:e,locationChanged:i,url:n()}))};var hT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:fT,exts:dT,default:cT});const pT=6,vT=[],gT=({file:s})=>{const e=ui(),[r,i]=Ye.exports.useState(""),{getSetting:t,password:n}=Ye.exports.useContext(Vr);return Ye.exports.useEffect(()=>{i(e(s))},[]),q.createElement(Zi,{className:"image-box",w:"full"},q.createElement(Xh,{maxH:"75vh",fallback:q.createElement(Zh,{color:t("icon color")||"#1890ff",size:"xl"}),rounded:"lg",src:r}))};var mT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:pT,exts:vT,default:gT});let su="/";su==="/"&&(su=window.location.origin+"/");const yT=su,ET=-1,_T=["ipa"],xT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(Vr),r=s.name.split(".").pop()||"",i=ui(),{t}=kn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(Eo,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Ca(s.type,r)}),q.createElement(Da,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(Er,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(_o,{href:`itms-services://?action=download-manifest&url=${yT}i/${btoa(n).replaceAll("/","_").replaceAll("=","-")}/ipa.plist`},q.createElement(Er,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var bT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:ET,exts:_T,default:xT});const ST=-1,TT=[],Lh=({url:s,unfold:e})=>{const{getSetting:r}=Ye.exports.useContext(Vr),i=r("pdf viewer url")||"https://alist-org.github.io/pdf.js/web/viewer.html?file=$url";return q.createElement(Zi,{w:"full",h:"full",className:"pdf-preview-box"},q.createElement("iframe",{title:"pdf-viewer",width:"100%",height:"100%",src:i.replace("$url",s)}))};var AT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:ST,exts:TT,default:Lh});const wT=2,OT=[],LT=({file:s})=>{const{pathname:e}=Qh(),{password:r}=Ye.exports.useContext(Vr);let i=ui(!1,!1);const{unfold:t,setShowUnfold:n}=Oh(!1),[a,o]=q.useState(""),[l,h]=q.useState(""),p=i(),[u,f]=q.useState("office"),g=[{name:"office",url:`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(p)}`},{name:"google",url:`https://docs.google.com/gview?url=${encodeURIComponent(p)}&embedded=true`}],E=()=>{s.driver==="AliDrive"?dp.post("preview",{path:e,password:r}).then(S=>{const _=S.data;if(_.code!==200)return;aliyun.config({mount:document.querySelector("#office-preview"),url:_.data.preview_url}).setToken({token:_.data.access_token})}):(s.name.endsWith(".pdf")?(h(i()),o("pdf")):o("office"),n(!0))};return Ye.exports.useEffect(()=>{E()},[]),q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",id:"office-preview",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"office-preview-box"},a==="office"&&q.createElement(Xi,{w:"full",h:"full"},q.createElement(Jh,{m:"1",onChange:f,value:u},q.createElement(qh,{direction:"row"},g.map(S=>q.createElement(ep,{value:S.name,key:S.name},S.name)))),g.map(S=>S.name===u&&q.createElement("iframe",{key:S.name,width:"100%",style:{height:"calc(100% - 24px - 0.25rem)"},src:S.url,frameBorder:"0"}))),a==="pdf"&&q.createElement(Lh,{url:l,unfold:t||!1}))};var IT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:wT,exts:OT,default:LT});const RT=-1,DT=["plist"],CT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(Vr),r=s.name.split(".").pop()||"",i=ui(),{t}=kn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(Eo,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Ca(s.type,r)}),q.createElement(Da,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(Er,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(_o,{href:"itms-services://?action=download-manifest&url="+n},q.createElement(Er,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var PT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:RT,exts:DT,default:CT}),Ih={exports:{}};/*!
 * artplayer.js v4.4.3
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(s,e){(function(r,i,t,n,a){var o=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Wt!="undefined"?Wt:{},l=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0,h=l.cache||{},p=typeof zr=="function"&&zr.bind(s);function u(E,S){if(!h[E]){if(!r[E]){var _=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0;if(!S&&_)return _(E,!0);if(l)return l(E,!0);if(p&&typeof E=="string")return p(E);var m=new Error("Cannot find module '"+E+"'");throw m.code="MODULE_NOT_FOUND",m}v.resolve=function(y){var d=r[E][1][y];return d!=null?d:y},v.cache={};var c=h[E]=new u.Module(E);r[E][0].call(c.exports,v,c,c.exports,this)}return h[E].exports;function v(y){var d=v.resolve(y);return d===!1?{}:u(d)}}u.isParcelRequire=!0,u.Module=function(E){this.id=E,this.bundle=u,this.exports={}},u.modules=r,u.cache=h,u.parent=l,u.register=function(E,S){r[E]=[function(_,m){m.exports=S},{}]},Object.defineProperty(u,"root",{get:function(){return o.parcelRequire4dc0}}),o.parcelRequire4dc0=u;for(var f=0;f<i.length;f++)u(i[f]);var g=u(t);s.exports=g})({"6SN6P":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("bundle-text:./style/index.less"),o=n.interopDefault(a),l=r("option-validator"),h=n.interopDefault(l),p=r("./utils/emitter"),u=n.interopDefault(p),f=r("./utils"),g=r("./scheme"),E=n.interopDefault(g),S=r("./config"),_=n.interopDefault(S),m=r("./whitelist"),c=n.interopDefault(m),v=r("./template"),y=n.interopDefault(v),d=r("./i18n"),x=n.interopDefault(d),b=r("./player"),T=n.interopDefault(b),A=r("./control"),L=n.interopDefault(A),R=r("./contextmenu"),w=n.interopDefault(R),O=r("./info"),I=n.interopDefault(O),D=r("./subtitle"),C=n.interopDefault(D),P=r("./events"),M=n.interopDefault(P),N=r("./hotkey"),B=n.interopDefault(N),U=r("./layer"),F=n.interopDefault(U),j=r("./loading"),V=n.interopDefault(j),G=r("./notice"),Y=n.interopDefault(G),X=r("./mask"),ie=n.interopDefault(X),he=r("./icons"),de=n.interopDefault(he),Ae=r("./setting"),pe=n.interopDefault(Ae),le=r("./storage"),Ie=n.interopDefault(le),Ce=r("./plugins"),Ue=n.interopDefault(Ce),Me=r("./ads"),ze=n.interopDefault(Me),Ge=r("./mobile"),$e=n.interopDefault(Ge);let He=0;const Fe=[];class Se extends u.default{constructor(st,et){super(),this.id=++He;const ot=f.mergeDeep(Se.option,st);this.option=h.default(ot,E.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new c.default(this),this.template=new y.default(this),this.events=new M.default(this),this.whitelist.state?(this.storage=new Ie.default(this),this.icons=new de.default(this),this.i18n=new x.default(this),this.notice=new Y.default(this),this.player=new T.default(this),this.layers=new F.default(this),this.controls=new L.default(this),this.contextmenu=new w.default(this),this.subtitle=new C.default(this),this.ads=new ze.default(this),this.info=new I.default(this),this.loading=new V.default(this),this.hotkey=new B.default(this),this.mask=new ie.default(this),this.setting=new pe.default(this),this.plugins=new Ue.default(this)):this.mobile=new $e.default(this),typeof et=="function"&&this.on("ready",()=>et.call(this)),Fe.push(this)}static get instances(){return Fe}static get version(){return"4.4.3"}static get env(){return"production"}static get build(){return"1653543392822"}static get config(){return _.default}static get utils(){return f}static get scheme(){return E.default}static get Emitter(){return u.default}static get validator(){return h.default}static get kindOf(){return h.default.kindOf}static get html(){return y.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,ads:[],layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:f.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(st=!0){this.events.destroy(),this.template.destroy(st),Fe.splice(Fe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(t.default=Se,Se.NOTICE_TIME=2e3,Se.SETTING_WIDTH=250,Se.SETTING_ITEM_WIDTH=200,Se.SETTING_ITEM_HEIGHT=35,Se.INDICATOR_SIZE=14,Se.INDICATOR_SIZE_ICON=16,Se.INDICATOR_SIZE_MOBILE=18,Se.INDICATOR_SIZE_MOBILE_ICON=20,Se.VOLUME_PANEL_WIDTH=60,Se.VOLUME_HANDLE_WIDTH=12,Se.RESIZE_TIME=500,Se.SCROLL_TIME=200,Se.SCROLL_GAP=50,Se.AUTO_PLAYBACK_MAX=10,Se.RECONNECT_TIME_MAX=5,Se.RECONNECT_SLEEP_TIME=1e3,Se.CONTROL_HIDE_TIME=3e3,Se.DB_CLICE_TIME=300,Se.MOBILE_AUTO_PLAYBACKRATE=3,Se.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,Se.MOBILE_AUTO_ORIENTATION_TIME=200,Se.INFO_LOOP_TIME=1e3,Se.FAST_FORWARD_VALUE=3,Se.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const Xe=document.createElement("style");Xe.id="artplayer-style",Xe.textContent=o.default,document.head.appendChild(Xe)}typeof window!="undefined"&&(window.Artplayer=Se),console.log(`%c ArtPlayer %c ${Se.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"hqjoJ","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./ads":"aafSd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(r,i,t){i.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:0}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:0}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000000;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],hqjoJ:[function(r,i,t){i.exports=function(){function n(f){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(f)}var a=Object.prototype.toString,o=function(f){if(f===void 0)return"undefined";if(f===null)return"null";var g=n(f);if(g==="boolean")return"boolean";if(g==="string")return"string";if(g==="number")return"number";if(g==="symbol")return"symbol";if(g==="function")return function(E){return l(E)==="GeneratorFunction"}(f)?"generatorfunction":"function";if(function(E){return Array.isArray?Array.isArray(E):E instanceof Array}(f))return"array";if(function(E){return!(!E.constructor||typeof E.constructor.isBuffer!="function")&&E.constructor.isBuffer(E)}(f))return"buffer";if(function(E){try{if(typeof E.length=="number"&&typeof E.callee=="function")return!0}catch(S){if(S.message.indexOf("callee")!==-1)return!0}return!1}(f))return"arguments";if(function(E){return E instanceof Date||typeof E.toDateString=="function"&&typeof E.getDate=="function"&&typeof E.setDate=="function"}(f))return"date";if(function(E){return E instanceof Error||typeof E.message=="string"&&E.constructor&&typeof E.constructor.stackTraceLimit=="number"}(f))return"error";if(function(E){return E instanceof RegExp||typeof E.flags=="string"&&typeof E.ignoreCase=="boolean"&&typeof E.multiline=="boolean"&&typeof E.global=="boolean"}(f))return"regexp";switch(l(f)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(E){return typeof E.throw=="function"&&typeof E.return=="function"&&typeof E.next=="function"}(f))return"generator";switch(g=a.call(f)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return g.slice(8,-1).toLowerCase().replace(/\s/g,"")};function l(f){return f.constructor?f.constructor.name:null}function h(f,g){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return p(f,g,E),u(f,g,E),function(S,_,m){var c=o(_),v=o(S);if(c==="object"){if(v!=="object")throw new Error("[Type Error]: '".concat(m.join("."),"' require 'object' type, but got '").concat(v,"'"));Object.keys(_).forEach(function(y){var d=S[y],x=_[y],b=m.slice();b.push(y),p(d,x,b),u(d,x,b),h(d,x,b)})}if(c==="array"){if(v!=="array")throw new Error("[Type Error]: '".concat(m.join("."),"' require 'array' type, but got '").concat(v,"'"));S.forEach(function(y,d){var x=S[d],b=_[d]||_[0],T=m.slice();T.push(d),p(x,b,T),u(x,b,T),h(x,b,T)})}}(f,g,E),f}function p(f,g,E){if(o(g)==="string"){var S=o(f);if(g[0]==="?"&&(g=g.slice(1)+"|undefined"),!(-1<g.indexOf("|")?g.split("|").map(function(_){return _.toLowerCase().trim()}).filter(Boolean).some(function(_){return S===_}):g.toLowerCase().trim()===S))throw new Error("[Type Error]: '".concat(E.join("."),"' require '").concat(g,"' type, but got '").concat(S,"'"))}}function u(f,g,E){if(o(g)==="function"){var S=g(f,o(f),E);if(S!==!0){var _=o(S);throw _==="string"?new Error(S):_==="error"?S:new Error("[Validator Error]: The scheme for '".concat(E.join("."),"' validator require return true, but got '").concat(S,"'"))}}}return h.kindOf=o,h}()},{}],"7pHuB":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{on(n,a,o){const l=this.e||(this.e={});return(l[n]||(l[n]=[])).push({fn:a,ctx:o}),this}once(n,a,o){const l=this;function h(...p){l.off(n,h),a.apply(o,p)}return h._=a,this.on(n,h,o)}emit(n,...a){const o=((this.e||(this.e={}))[n]||[]).slice();for(let l=0;l<o.length;l+=1)o[l].fn.apply(o[l].ctx,a);return this}off(n,a){const o=this.e||(this.e={}),l=o[n],h=[];if(l&&a)for(let p=0,u=l.length;p<u;p+=1)l[p].fn!==a&&l[p].fn._!==a&&h.push(l[p]);return h.length?o[n]=h:delete o[n],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(r,i,t){t.interopDefault=function(n){return n&&n.__esModule?n:{default:n}},t.defineInteropFlag=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.exportAll=function(n,a){return Object.keys(n).forEach(function(o){o==="default"||o==="__esModule"||a.hasOwnProperty(o)||Object.defineProperty(a,o,{enumerable:!0,get:function(){return n[o]}})}),a},t.export=function(n,a,o){Object.defineProperty(n,a,{enumerable:!0,get:o})}},{}],geSvU:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom");n.exportAll(a,t);var o=r("./error");n.exportAll(o,t);var l=r("./subtitle");n.exportAll(l,t);var h=r("./file");n.exportAll(h,t);var p=r("./property");n.exportAll(p,t);var u=r("./time");n.exportAll(u,t);var f=r("./format");n.exportAll(f,t);var g=r("./compatibility");n.exportAll(g,t)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"query",()=>o),n.export(t,"queryAll",()=>l),n.export(t,"addClass",()=>h),n.export(t,"removeClass",()=>p),n.export(t,"hasClass",()=>u),n.export(t,"append",()=>f),n.export(t,"remove",()=>g),n.export(t,"setStyle",()=>E),n.export(t,"setStyles",()=>S),n.export(t,"getStyle",()=>_),n.export(t,"sublings",()=>m),n.export(t,"inverseClass",()=>c),n.export(t,"tooltip",()=>v),n.export(t,"isInViewport",()=>y),n.export(t,"includeFromEvent",()=>d),n.export(t,"replaceElement",()=>x);var a=r("./compatibility");function o(b,T=document){return T.querySelector(b)}function l(b,T=document){return Array.from(T.querySelectorAll(b))}function h(b,T){return b.classList.add(T)}function p(b,T){return b.classList.remove(T)}function u(b,T){return b.classList.contains(T)}function f(b,T){return T instanceof Element?b.appendChild(T):b.insertAdjacentHTML("beforeend",String(T)),b.lastElementChild||b.lastChild}function g(b){return b.parentNode.removeChild(b)}function E(b,T,A){return b.style[T]=A,b}function S(b,T){return Object.keys(T).forEach(A=>{E(b,A,T[A])}),b}function _(b,T,A=!0){const L=window.getComputedStyle(b,null).getPropertyValue(T);return A?parseFloat(L):L}function m(b){return Array.from(b.parentElement.children).filter(T=>T!==b)}function c(b,T){m(b).forEach(A=>p(A,T)),h(b,T)}function v(b,T,A="top"){a.isMobile||(b.setAttribute("aria-label",T),h(b,"hint--rounded"),h(b,`hint--${A}`))}function y(b,T=0){const A=b.getBoundingClientRect(),L=window.innerHeight||document.documentElement.clientHeight,R=window.innerWidth||document.documentElement.clientWidth,w=A.top-T<=L&&A.top+A.height+T>=0,O=A.left-T<=R+T&&A.left+A.width+T>=0;return w&&O}function d(b,T){return b.composedPath&&b.composedPath().indexOf(T)>-1}function x(b,T){return T.parentNode.replaceChild(b,T),b}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"userAgent",()=>a),n.export(t,"isMobile",()=>o),n.export(t,"isSafari",()=>l),n.export(t,"isWechat",()=>h),n.export(t,"isIE",()=>p),n.export(t,"isAndroid",()=>u),n.export(t,"isIOS",()=>f);const a=typeof window!="undefined"?window.navigator.userAgent:"",o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),l=/^((?!chrome|android).)*safari/i.test(a),h=/MicroMessenger/i.test(a),p=/MSIE|Trident/i.test(a),u=/android/i.test(a),f=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ArtPlayerError",()=>a),n.export(t,"errorHandle",()=>o);class a extends Error{constructor(h,p){super(h),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,p||this.constructor),this.name="ArtPlayerError"}}function o(l,h){if(!l)throw new a(h);return l}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h){return`WEBVTT \r
\r
`.concat((p=h,p.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(u,f,g)=>{let E=g.slice(0,3);return g.length===1&&(E=g+"00"),g.length===2&&(E=g+"0"),`${f},${E}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var p}function o(h){return URL.createObjectURL(new Blob([h],{type:"text/vtt"}))}function l(h){const p=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function u(f=""){return f.split(/[:.]/).map((g,E,S)=>{if(E===S.length-1){if(g.length===1)return`.${g}00`;if(g.length===2)return`.${g}0`}else if(g.length===1)return(E===0?"0":":0")+g;return E===0?g:E===S.length-1?`.${g}`:`:${g}`}).join("")}return`WEBVTT

${h.split(/\r?\n/).map(f=>{const g=f.match(p);return g?{start:u(g[1].trim()),end:u(g[2].trim()),text:g[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(E=>E.trim()).join(`
`)}:null}).filter(f=>f).map((f,g)=>f?`${g+1}
${f.start} --> ${f.end}
${f.text}`:"").filter(f=>f.trim()).join(`

`)}`}n.defineInteropFlag(t),n.export(t,"srtToVtt",()=>a),n.export(t,"vttToBlob",()=>o),n.export(t,"assToVtt",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return l.includes("?")?a(l.split("?")[0]):l.includes("#")?a(l.split("#")[0]):l.trim().toLowerCase().split(".").pop()}function o(l,h){const p=document.createElement("a");p.style.display="none",p.href=l,p.download=h,document.body.appendChild(p),p.click(),document.body.removeChild(p)}n.defineInteropFlag(t),n.export(t,"getExt",()=>a),n.export(t,"download",()=>o)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"def",()=>a),n.export(t,"has",()=>l),n.export(t,"get",()=>h),n.export(t,"mergeDeep",()=>p);const a=Object.defineProperty,{hasOwnProperty:o}=Object.prototype;function l(u,f){return o.call(u,f)}function h(u,f){return Object.getOwnPropertyDescriptor(u,f)}function p(...u){const f=g=>g&&typeof g=="object"&&!Array.isArray(g);return u.reduce((g,E)=>(Object.keys(E).forEach(S=>{const _=g[S],m=E[S];Array.isArray(_)&&Array.isArray(m)?g[S]=_.concat(...m):!f(_)||!f(m)||m instanceof Element?g[S]=m:g[S]=p(_,m)}),g),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h=0){return new Promise(p=>setTimeout(p,h))}function o(h,p,u){let f;function g(...E){clearTimeout(f),f=setTimeout(function(){f=null,h.apply(u,E)},p)}return g.clearTimeout=function(){clearTimeout(f)},g}function l(h,p){let u,f,g=!1;return function E(...S){if(g)return u=S,void(f=this);g=!0,h.apply(this,S),setTimeout(()=>{g=!1,u&&(E.apply(f,u),u=null,f=null)},p)}}n.defineInteropFlag(t),n.export(t,"sleep",()=>a),n.export(t,"debounce",()=>o),n.export(t,"throttle",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(h,p,u){return Math.max(Math.min(h,Math.max(p,u)),Math.min(p,u))}function o(h){const p=Math.floor(h/3600),u=Math.floor((h-3600*p)/60),f=Math.floor(h-3600*p-60*u);return(p>0?[p,u,f]:[u,f]).map(g=>g<10?`0${g}`:String(g)).join(":")}function l(h){return h.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}n.defineInteropFlag(t),n.export(t,"clamp",()=>a),n.export(t,"secondToTime",()=>o),n.export(t,"escape",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ComponentOption",()=>E);var a=r("../utils");const o="array",l="boolean",h="string",p="number",u="object",f="function";function g(S,_,m){return a.errorHandle(_===h||_===p||S instanceof Element,`${m.join(".")} require '${h}' or 'Element' type`)}const E={html:g,disable:`?${l}`,name:`?${h}`,index:`?${p}`,style:`?${u}`,click:`?${f}`,mounted:`?${f}`,tooltip:`?${h}|${p}`,width:`?${p}`,selector:`?${o}`,onSelect:`?${f}`,switch:`?${l}`,onSwitch:`?${f}`,range:`?${o}`,onRange:`?${f}`};t.default={container:g,url:h,poster:h,title:h,type:h,theme:h,lang:h,volume:p,isLive:l,muted:l,autoplay:l,autoSize:l,autoMini:l,loop:l,flip:l,playbackRate:l,aspectRatio:l,screenshot:l,setting:l,hotkey:l,pip:l,mutex:l,backdrop:l,fullscreen:l,fullscreenWeb:l,subtitleOffset:l,miniProgressBar:l,useSSR:l,playsInline:l,lock:l,fastForward:l,autoPlayback:l,autoOrientation:l,ads:[{url:h}],plugins:[f],whitelist:[`${h}|${f}|regexp`],layers:[E],contextmenu:[E],settings:[E],controls:[Ot(yt({},E),{position:(S,_,m)=>{const c=["top","left","right"];return a.errorHandle(c.includes(S),`${m.join(".")} only accept ${c.toString()} as parameters`)}})],quality:[{default:`?${l}`,html:h,url:h}],highlight:[{time:p,text:h}],thumbnails:{url:h,number:p,column:p},subtitle:{url:h,type:h,style:u,encoding:h},moreVideoAttr:u,icons:u,customType:u}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a}get state(){const{option:a,constructor:{kindOf:o}}=this.art;return!n.isMobile||a.whitelist.some(l=>{switch(o(l)){case"string":return l==="*"||n.userAgent.indexOf(l)>-1;case"function":return l(n.userAgent);case"regexp":return l.test(n.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");class a{constructor(l){this.art=l;const{option:h,constructor:p,whitelist:u}=l;h.container instanceof Element?this.$container=h.container:(this.$container=n.query(h.container),n.errorHandle(this.$container,`No container element found by ${h.container}`));const f=this.$container.tagName.toLowerCase();n.errorHandle(f==="div",`Unsupported container element type, only support 'div' but got '${f}'`),n.errorHandle(p.instances.every(g=>g.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=l.id,this.$original=this.$container.cloneNode(!0),u.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.4.3</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(l){return n.query(l,this.$container)}desktop(){const{option:l}=this.art;l.useSSR||(this.$container.innerHTML=a.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),l.backdrop&&(n.addClass(this.$setting,"art-backdrop-filter"),n.addClass(this.$contextmenu,"art-backdrop-filter"),n.addClass(this.$info,"art-backdrop-filter")),n.isMobile&&n.addClass(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(l){l?n.replaceElement(this.$original,this.$container):n.addClass(this.$player,"art-destroy")}}t.default=a},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./zh-cn.json"),l=n.interopDefault(o),h=r("./zh-tw.json"),p=n.interopDefault(h),u=r("./pl.json"),f=n.interopDefault(u),g=r("./cs.json"),E=n.interopDefault(g);t.default=class{constructor(S){this.art=S,this.languages={"zh-cn":l.default,"zh-tw":p.default,pl:f.default,cs:E.default},this.init()}init(){const S=this.art.option.lang.toLowerCase();this.language=this.languages[S]||{}}get(S){return this.language[S]||S}update(S){this.languages=a.mergeDeep(this.languages,S),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./pl.json":"3cd1e","./cs.json":"an7cR"}],e7BQ4:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u4E3A\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"5kFyN":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u70BA\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"3cd1e":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Auto playback at":"Automatyczne odtwarzanie za"}')},{}],an7cR:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Auto playback at":"Automatick\xE9 p\u0159ehr\xE1v\xE1n\xED za"}')},{}],fzROd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./urlMix"),o=n.interopDefault(a),l=r("./attrMix"),h=n.interopDefault(l),p=r("./playMix"),u=n.interopDefault(p),f=r("./pauseMix"),g=n.interopDefault(f),E=r("./toggleMix"),S=n.interopDefault(E),_=r("./seekMix"),m=n.interopDefault(_),c=r("./volumeMix"),v=n.interopDefault(c),y=r("./currentTimeMix"),d=n.interopDefault(y),x=r("./durationMix"),b=n.interopDefault(x),T=r("./switchMix"),A=n.interopDefault(T),L=r("./playbackRateMix"),R=n.interopDefault(L),w=r("./aspectRatioMix"),O=n.interopDefault(w),I=r("./screenshotMix"),D=n.interopDefault(I),C=r("./fullscreenMix"),P=n.interopDefault(C),M=r("./fullscreenWebMix"),N=n.interopDefault(M),B=r("./pipMix"),U=n.interopDefault(B),F=r("./loadedMix"),j=n.interopDefault(F),V=r("./playedMix"),G=n.interopDefault(V),Y=r("./playingMix"),X=n.interopDefault(Y),ie=r("./autoSizeMix"),he=n.interopDefault(ie),de=r("./rectMix"),Ae=n.interopDefault(de),pe=r("./flipMix"),le=n.interopDefault(pe),Ie=r("./miniMix"),Ce=n.interopDefault(Ie),Ue=r("./loopMix"),Me=n.interopDefault(Ue),ze=r("./posterMix"),Ge=n.interopDefault(ze),$e=r("./autoHeightMix"),He=n.interopDefault($e),Fe=r("./themeMix"),Se=n.interopDefault(Fe),Xe=r("./titleMix"),st=n.interopDefault(Xe),et=r("./normalSizeMix"),ot=n.interopDefault(et),nt=r("./subtitleOffsetMix"),dt=n.interopDefault(nt),ne=r("./optionInit"),Ee=n.interopDefault(ne),xe=r("./eventInit"),we=n.interopDefault(xe);t.default=class{constructor(be){o.default(be),h.default(be),u.default(be),g.default(be),S.default(be),m.default(be),v.default(be),d.default(be),b.default(be),A.default(be),R.default(be),O.default(be),D.default(be),P.default(be),N.default(be),U.default(be),j.default(be),G.default(be),X.default(be),he.default(be),Ae.default(be),le.default(be),Ce.default(be),Me.default(be),Ge.default(be),He.default(be),Se.default(be),st.default(be),ot.default(be),dt.default(be),we.default(be),Ee.default(be)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./normalSizeMix":"iEQHG"}],cChak:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$video:l}}=a;n.def(a,"url",{get:()=>l.currentSrc,set(h){return yr(this,null,function*(){const p=o.type||n.getExt(h),u=o.customType[p];p&&u?(yield n.sleep(),a.loading.show=!0,u.call(a,l,h,a)):(a.url&&a.url!==h&&a.once("video:canplay",()=>{a.isReady&&a.emit("restart")}),l.src=h,a.option.url=h,a.emit("url",h))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o}}=a;n.def(a,"attr",{value(l,h){if(h===void 0)return o[l];o[l]=h}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:l,option:h,constructor:{instances:p},template:{$video:u}}=a;n.def(a,"play",{value(){const f=u.play();if(f&&f.then&&f.then().catch(g=>{throw l.show=g,g}),h.mutex)for(let g=0;g<p.length;g++){const E=p[g];E!==a&&E.pause()}return l.show=o.get("Play"),a.emit("play"),f}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:h}=a;n.def(a,"pause",{value(){const p=o.pause();return h.show=l.get("Pause"),a.emit("pause"),p}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"toggle",{value:()=>a.playing?a.pause():a.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o}=a;n.def(a,"seek",{set(l){a.currentTime=l,a.emit("seek",a.currentTime),a.duration&&(o.show=`${n.secondToTime(a.currentTime)} / ${n.secondToTime(a.duration)}`)}}),n.def(a,"forward",{set(l){a.seek=a.currentTime+l}}),n.def(a,"backward",{set(l){a.seek=a.currentTime-l}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:h,storage:p}=a;n.def(a,"volume",{get:()=>o.volume||0,set:u=>{o.volume=n.clamp(u,0,1),h.show=`${l.get("Volume")}: ${parseInt(100*o.volume,10)}`,o.volume!==0&&p.set("volume",o.volume),a.emit("volume",o.volume)}}),n.def(a,"muted",{get:()=>o.muted,set:u=>{o.muted=u,a.emit("volume",o.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"currentTime",{get:()=>o.currentTime||0,set:l=>{l=parseFloat(l),Number.isNaN(l)||(o.currentTime=n.clamp(l,0,a.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"duration",{get:()=>{const{duration:o}=a.template.$video;return o===1/0?0:o||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:l,notice:h}=a;function p(u,f,g){return new Promise(E=>{if(u===a.url)return E(u);const{playing:S}=a;a.pause(),URL.revokeObjectURL(a.url),a.url=u,a.once("video:canplay",()=>{a.playbackRate=!1,a.aspectRatio=!1,a.flip="normal",a.autoSize=l.autoSize,a.currentTime=g,a.notice.show="",S&&a.play(),f&&(h.show=`${o.get("Switch Video")}: ${f}`),a.emit("switch",u),E(u)})})}n.def(a,"switchQuality",{value:(u,f)=>p(u,f,a.currentTime)}),n.def(a,"switchUrl",{value:(u,f)=>p(u,f,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:h}=a;n.def(a,"playbackRate",{get:()=>o.playbackRate,set(p){if(p){if(p===o.playbackRate)return;const u=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];n.errorHandle(u.includes(p),`'playbackRate' only accept ${u.toString()} as parameters`),o.playbackRate=p,h.show=`${l.get("Rate")}: ${p===1?l.get("Normal"):`${p}x`}`,a.emit("playbackRate",p)}else a.playbackRate=1,a.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o,$player:l},i18n:h,notice:p}=a;n.def(a,"aspectRatio",{get:()=>l.dataset.aspectRatio||"default",set(u){u||(u="default");const f=["default","4:3","16:9"];if(n.errorHandle(f.includes(u),`'aspectRatio' only accept ${f.toString()} as parameters`),u==="default")n.setStyle(o,"width",null),n.setStyle(o,"height",null),n.setStyle(o,"padding",null),delete l.dataset.aspectRatio;else{const g=u.split(":").map(Number),{videoWidth:E,videoHeight:S}=o,{clientWidth:_,clientHeight:m}=l,c=E/S,v=g[0]/g[1];if(c>v){const y=v*S/E;n.setStyle(o,"width",100*y+"%"),n.setStyle(o,"height","100%"),n.setStyle(o,"padding",`0 ${(_-_*y)/2}px`)}else{const y=E/v/S;n.setStyle(o,"width","100%"),n.setStyle(o,"height",100*y+"%"),n.setStyle(o,"padding",(m-m*y)/2+"px 0")}l.dataset.aspectRatio=u}p.show=`${h.get("Aspect Ratio")}: ${u==="default"?h.get("Default"):u}`,a.emit("aspectRatio",u)}}),n.def(a,"aspectRatioReset",{set(u){if(u){const{aspectRatio:f}=a;a.aspectRatio=f}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,notice:l,template:{$video:h}}=a,p=document.createElement("canvas");n.def(a,"getDataURL",{value:()=>new Promise((u,f)=>{try{p.width=h.videoWidth,p.height=h.videoHeight,p.getContext("2d").drawImage(h,0,0),u(p.toDataURL("image/png"))}catch(g){l.show=g,f(g)}})}),n.def(a,"getBlobUrl",{value:()=>new Promise((u,f)=>{try{p.width=h.videoWidth,p.height=h.videoHeight,p.getContext("2d").drawImage(h,0,0),p.toBlob(g=>{u(URL.createObjectURL(g))})}catch(g){l.show=g,f(g)}})}),n.def(a,"screenshot",{value:()=>yr(this,null,function*(){const u=yield a.getDataURL();return n.download(u,`${o.title||"artplayer"}_${n.secondToTime(h.currentTime)}.png`),a.emit("screenshot",u),u})})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../libs/screenfull"),o=n.interopDefault(a),l=r("../utils");t.default=function(h){const{i18n:p,notice:u,template:{$video:f,$player:g}}=h,E=o.default();h.once("video:loadedmetadata",()=>{var S;E.isEnabled?(S=h,E.on("change",()=>S.emit("fullscreen",E.isFullscreen)),l.def(S,"fullscreen",{get:()=>E.isFullscreen,set(_){return yr(this,null,function*(){_?(S.normalSize="fullscreen",S.aspectRatioReset=!0,S.autoSize=!1,yield E.request(g),l.addClass(g,"art-fullscreen"),S.emit("resize"),S.emit("fullscreen",!0),u.show=""):(S.aspectRatioReset=!0,S.autoSize=S.option.autoSize,yield E.exit(),l.removeClass(g,"art-fullscreen"),S.emit("resize"),S.emit("fullscreen"),u.show="")})}})):document.fullscreenEnabled||f.webkitSupportsFullscreen?(_=>{l.def(_,"fullscreen",{get:()=>f.webkitDisplayingFullscreen,set(m){m?(_.normalSize="fullscreen",f.webkitEnterFullscreen(),_.emit("fullscreen",!0),u.show=""):(f.webkitExitFullscreen(),_.emit("fullscreen"),u.show="")}})})(h):l.def(h,"fullscreen",{get:()=>!1,set(){u.show=p.get("Fullscreen Not Supported")}}),l.def(h,"fullscreen",l.get(h,"fullscreen"))})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","../libs/screenfull":"aPwar"}],aPwar:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(){const n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{const h=n[0],p={};for(const u of n)if(u[1]in document){for(const[f,g]of u.entries())p[h[f]]=g;return p}return!1})(),o={change:a.fullscreenchange,error:a.fullscreenerror};let l={request:(h=document.documentElement,p)=>new Promise((u,f)=>{const g=()=>{l.off("change",g),u()};l.on("change",g);const E=h[a.requestFullscreen](p);E instanceof Promise&&E.then(g).catch(f)}),exit:()=>new Promise((h,p)=>{if(!l.isFullscreen)return void h();const u=()=>{l.off("change",u),h()};l.on("change",u);const f=document[a.exitFullscreen]();f instanceof Promise&&f.then(u).catch(p)}),toggle:(h,p)=>l.isFullscreen?l.exit():l.request(h,p),onchange(h){l.on("change",h)},onerror(h){l.on("error",h)},on(h,p){const u=o[h];u&&document.addEventListener(u,p,!1)},off(h,p){const u=o[h];u&&document.removeEventListener(u,p,!1)},raw:a};return Object.defineProperties(l,{isFullscreen:{get:()=>Boolean(document[a.fullscreenElement])},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[a.fullscreenEnabled])}}),a||(l={isEnabled:!1}),l}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o,template:{$player:l}}=a;n.def(a,"fullscreenWeb",{get:()=>n.hasClass(l,"art-fullscreen-web"),set(h){h?(a.normalSize="fullscreenWeb",n.addClass(l,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=!1,a.emit("resize"),a.emit("fullscreenWeb",!0),o.show=""):(n.removeClass(l,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=a.option.autoSize,a.emit("resize"),a.emit("fullscreenWeb"),o.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:l,template:{$video:h}}=a;document.pictureInPictureEnabled?function(p){const{template:{$video:u},events:{proxy:f},notice:g}=p;u.disablePictureInPicture=!1,n.def(p,"pip",{get:()=>document.pictureInPictureElement,set(E){E?(p.normalSize="pip",u.requestPictureInPicture().catch(S=>{throw g.show=S,S})):document.exitPictureInPicture().catch(S=>{throw g.show=S,S})}}),f(u,"enterpictureinpicture",()=>{p.emit("pip",!0)}),f(u,"leavepictureinpicture",()=>{p.emit("pip")})}(a):h.webkitSupportsPresentationMode?function(p){const{$video:u}=p.template;u.webkitSetPresentationMode("inline"),n.def(p,"pip",{get:()=>u.webkitPresentationMode==="picture-in-picture",set(f){f?(p.normalSize="pip",u.webkitSetPresentationMode("picture-in-picture"),p.emit("pip",!0)):(u.webkitSetPresentationMode("inline"),p.emit("pip"))}})}(a):n.def(a,"pip",{get:()=>!1,set(){l.show=o.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"loaded",{get:()=>a.loadedTime/o.duration}),n.def(a,"loadedTime",{get:()=>o.buffered.length?o.buffered.end(o.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"played",{get:()=>a.currentTime/a.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"playing",{get:()=>o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$container:o,$player:l,$video:h}=a.template;n.def(a,"autoSize",{get:()=>n.hasClass(o,"art-auto-size"),set(p){if(p){const{videoWidth:u,videoHeight:f}=h,{width:g,height:E}=o.getBoundingClientRect(),S=u/f,_=g/E;if(n.addClass(o,"art-auto-size"),_>S){const m=E*S/g*100;n.setStyle(l,"width",`${m}%`),n.setStyle(l,"height","100%")}else{const m=g/S/E*100;n.setStyle(l,"width","100%"),n.setStyle(l,"height",`${m}%`)}a.emit("autoSize",{width:a.width,height:a.height})}else n.removeClass(o,"art-auto-size"),n.setStyle(l,"width",null),n.setStyle(l,"height",null),a.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"rect",{get:()=>a.template.$player.getBoundingClientRect()});const o=["bottom","height","left","right","top","width"];for(let l=0;l<o.length;l++){const h=o[l];n.def(a,h,{get:()=>a.rect[h]})}n.def(a,"x",{get:()=>a.left+window.pageXOffset}),n.def(a,"y",{get:()=>a.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$player:o},i18n:l,notice:h}=a;n.def(a,"flip",{get:()=>o.dataset.flip||"normal",set(p){p||(p="normal");const u=["normal","horizontal","vertical"];n.errorHandle(u.includes(p),`'flip' only accept ${u.toString()} as parameters`),p==="normal"?delete o.dataset.flip:o.dataset.flip=p;const f=p.replace(p[0],p[0].toUpperCase());h.show=`${l.get("Video Flip")}: ${l.get(f)}`,a.emit("flip",p)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:l,storage:h,events:{proxy:p},template:{$player:u,$miniClose:f,$miniTitle:g,$miniHeader:E}}=a;let S="",_=!1,m=0,c=0,v=0,y=0;p(E,"mousedown",d=>{_=!0,m=d.pageX,c=d.pageY,v=a.left,y=a.top}),p(document,"mousemove",d=>{if(_){n.addClass(u,"art-is-dragging");const x=y+d.pageY-c,b=v+d.pageX-m;n.setStyle(u,"top",`${x}px`),n.setStyle(u,"left",`${b}px`),h.set("top",x),h.set("left",b)}}),p(document,"mouseup",()=>{_=!1,n.removeClass(u,"art-is-dragging")}),p(f,"click",()=>{a.mini=!1,_=!1,n.removeClass(u,"art-is-dragging")}),n.append(g,l.title||o.get("Mini Player")),n.def(a,"mini",{get:()=>n.hasClass(u,"art-mini"),set(d){if(d){a.normalSize="mini",a.autoSize=!1,S=u.style.cssText,n.addClass(u,"art-mini");const x=h.get("top"),b=h.get("left");if(x&&b)n.setStyle(u,"top",`${x}px`),n.setStyle(u,"left",`${b}px`),n.isInViewport(E)||(h.del("top"),h.del("left"),a.mini=!0);else{const T=window.innerHeight-a.height-50,A=window.innerWidth-a.width-50;h.set("top",T),h.set("left",A),n.setStyle(u,"top",`${T}px`),n.setStyle(u,"left",`${A}px`)}a.aspectRatio=!1,a.playbackRate=!1,a.notice.show="",a.emit("mini",!0)}else u.style.cssText=S,n.removeClass(u,"art-mini"),n.setStyle(u,"top",null),n.setStyle(u,"left",null),a.aspectRatio=!1,a.playbackRate=!1,a.autoSize=l.autoSize,a.notice.show="",a.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){let o=[];n.def(a,"loop",{get:()=>o,set:l=>{if(Array.isArray(l)&&typeof l[0]=="number"&&typeof l[1]=="number"){const h=n.clamp(l[0],0,Math.min(l[1],a.duration)),p=n.clamp(l[1],h,a.duration);p-h>=1?(o=[h,p],a.emit("loop",o)):(o=[],a.emit("loop"))}else o=[],a.emit("loop")}}),a.on("video:timeupdate",()=>{o.length&&(a.currentTime<o[0]||a.currentTime>o[1])&&(a.seek=o[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$poster:l}}=a;n.def(a,"poster",{get:()=>o.poster,set(h){o.poster=h,n.setStyle(l,"backgroundImage",`url(${h})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$container:l,$video:h}}=a,p=l.style.height;n.def(a,"autoHeight",{get:()=>n.hasClass(l,"art-auto-height"),set(u){if(u){const{clientWidth:f}=l,{videoHeight:g,videoWidth:E}=h,S=g*(f/E);n.setStyle(l,"height",S+"px"),n.addClass(l,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight",S)}else n.setStyle(l,"height",p),n.removeClass(l,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$player:l}}=a;n.def(a,"theme",{get:()=>getComputedStyle(l).getPropertyValue("--theme"),set(h){o.theme=h,l.style.setProperty("--theme",h)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"title",{get:()=>a.option.title,set(o){a.option.title=o}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{clamp:o}=a.constructor.utils,{notice:l,template:h,i18n:p}=a;let u=0,f=[];a.on("subtitle:switch",()=>{f=[]}),n.def(a,"subtitleOffset",{get:()=>u,set(g){if(h.$track&&h.$track.track){const E=Array.from(h.$track.track.cues);u=o(g,-5,5);for(let S=0;S<E.length;S++){const _=E[S];f[S]||(f[S]={startTime:_.startTime,endTime:_.endTime}),_.startTime=o(f[S].startTime+u,0,a.duration),_.endTime=o(f[S].endTime+u,0,a.duration)}a.subtitle.update(),l.show=`${p.get("Subtitle Offset")}: ${g}s`,a.emit("subtitleOffset",g)}else a.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,storage:l,template:{$video:h,$poster:p}}=a;Object.keys(o.moreVideoAttr).forEach(f=>{a.attr(f,o.moreVideoAttr[f])}),o.muted&&(a.muted=o.muted),o.volume&&(h.volume=n.clamp(o.volume,0,1));const u=l.get("volume");typeof u=="number"&&(h.volume=n.clamp(u,0,1)),o.poster&&n.setStyle(p,"backgroundImage",`url(${o.poster})`),o.autoplay&&(h.autoplay=o.autoplay),o.playsInline&&(h.playsInline=!0,h["webkit-playsinline"]=!0),o.theme&&(a.theme=o.theme),o.ads.length===0&&(a.url=o.url)}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../config"),o=n.interopDefault(a),l=r("../utils");t.default=function(h){const{i18n:p,notice:u,option:f,constructor:g,events:{proxy:E},template:{$player:S,$video:_,$poster:m}}=h;let c=0;for(let v=0;v<o.default.events.length;v++)E(_,o.default.events[v],y=>{h.emit(`video:${y.type}`,y)});h.on("video:canplay",()=>{c=0,h.loading.show=!1}),h.once("video:canplay",()=>{h.loading.show=!1,h.controls.show=!0,h.mask.show=!0,h.isReady=!0,h.emit("ready")}),h.on("video:ended",()=>{f.loop?(h.seek=0,h.play(),h.controls.show=!1,h.mask.show=!1):(h.controls.show=!0,h.mask.show=!0)}),h.on("video:error",()=>yr(this,null,function*(){c<g.RECONNECT_TIME_MAX?(yield l.sleep(g.RECONNECT_SLEEP_TIME),c+=1,h.url=f.url,u.show=`${p.get("Reconnect")}: ${c}`,h.emit("error",c)):(h.mask.show=!0,h.loading.show=!1,h.controls.show=!0,l.addClass(S,"art-error"),yield l.sleep(g.RECONNECT_SLEEP_TIME),u.show=p.get("Video Load Failed"),h.destroy(!1))})),h.on("video:loadedmetadata",()=>{h.autoSize=f.autoSize,l.isMobile&&(h.loading.show=!1,h.controls.show=!0,h.mask.show=!0)}),h.on("video:loadstart",()=>{h.loading.show=!0,h.mask.show=!1,h.controls.show=!0}),h.on("video:pause",()=>{h.controls.show=!0,h.mask.show=!0}),h.on("video:play",()=>{h.mask.show=!1,l.setStyle(m,"display","none")}),h.on("video:playing",()=>{h.mask.show=!1}),h.on("video:seeked",()=>{h.loading.show=!1}),h.on("video:seeking",()=>{h.loading.show=!0,h.mask.show=!1}),h.on("video:timeupdate",()=>{h.mask.show=!1}),h.on("video:waiting",()=>{h.loading.show=!0,h.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const o=["mini","pip","fullscreen","fullscreenWeb"];n.def(a,"normalSize",{get:()=>o.every(l=>!a[l]),set(l){o.filter(h=>h!==l).forEach(h=>{a[h]&&(a[h]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),l=n.interopDefault(o),h=r("./fullscreen"),p=n.interopDefault(h),u=r("./fullscreenWeb"),f=n.interopDefault(u),g=r("./pip"),E=n.interopDefault(g),S=r("./playAndPause"),_=n.interopDefault(S),m=r("./progress"),c=n.interopDefault(m),v=r("./time"),y=n.interopDefault(v),d=r("./volume"),x=n.interopDefault(d),b=r("./setting"),T=n.interopDefault(b),A=r("./thumbnails"),L=n.interopDefault(A),R=r("./screenshot"),w=n.interopDefault(R),O=r("./quality"),I=n.interopDefault(O),D=r("./loop"),C=n.interopDefault(D);class P extends l.default{constructor(N){super(N),this.name="control";const{constructor:B,events:{proxy:U},template:{$player:F}}=N;let j=Date.now();U(F,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,a.removeClass(F,"art-hide-cursor"),a.addClass(F,"art-hover"),j=Date.now()}),N.on("video:timeupdate",()=>{!N.isInput&&N.playing&&this.show&&Date.now()-j>=B.CONTROL_HIDE_TIME&&(this.show=!1,a.addClass(F,"art-hide-cursor"),a.removeClass(F,"art-hover"))}),this.init()}init(){const{option:N}=this.art;this.add(c.default({name:"progress",disable:N.isLive,position:"top",index:10})),this.add(L.default({name:"thumbnails",disable:!N.thumbnails.url||N.isLive||a.isMobile,position:"top",index:20})),this.add(C.default({name:"loop",disable:!1,position:"top",index:30})),this.add(_.default({name:"playAndPause",disable:!1,position:"left",index:10})),this.add(x.default({name:"volume",disable:!1,position:"left",index:20})),this.add(y.default({name:"time",disable:N.isLive,position:"left",index:30})),this.add(I.default({name:"quality",disable:N.quality.length===0,position:"right",index:10})),this.add(w.default({name:"screenshot",disable:!N.screenshot||a.isMobile,position:"right",index:20})),this.add(T.default({name:"setting",disable:!N.setting,position:"right",index:30})),this.add(E.default({name:"pip",disable:!N.pip,position:"right",index:40})),this.add(f.default({name:"fullscreenWeb",disable:!N.fullscreenWeb,position:"right",index:50})),this.add(p.default({name:"fullscreen",disable:!N.fullscreen,position:"right",index:60}));for(let B=0;B<N.controls.length;B++)this.add(N.controls[B])}add(N){const B=typeof N=="function"?N(this.art):N,{$progress:U,$controlsLeft:F,$controlsRight:j}=this.art.template;switch(B.position){case"top":this.$parent=U;break;case"left":this.$parent=F;break;case"right":this.$parent=j;break;default:a.errorHandle(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(B)}}t.default=P},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom"),o=r("option-validator"),l=n.interopDefault(o),h=r("../scheme"),p=r("./property"),u=r("./error");t.default=class{constructor(f){this.id=0,this.art=f,this.add=this.add.bind(this)}get show(){return a.hasClass(this.art.template.$player,`art-${this.name}-show`)}set show(f){const{$player:g}=this.art.template,E=`art-${this.name}-show`;f?a.addClass(g,E):a.removeClass(g,E),this.art.emit(this.name,f)}set toggle(f){f&&(this.show=!this.show)}add(f){const g=typeof f=="function"?f(this.art):f;if(g.html=g.html||"",l.default(g,h.ComponentOption),!this.$parent||!this.name||g.disable)return;const E=g.name||`${this.name}${this.id}`;u.errorHandle(!p.has(this,E),`Cannot add an existing name [${E}] to the [${this.name}]`),this.id+=1;const S=document.createElement("div");a.addClass(S,`art-${this.name}`),a.addClass(S,`art-${this.name}-${E}`);const _=Array.from(this.$parent.children);S.dataset.index=g.index||this.id;const m=_.find(c=>Number(c.dataset.index)>=Number(S.dataset.index));return m?m.insertAdjacentElement("beforebegin",S):a.append(this.$parent,S),g.html&&a.append(S,g.html),g.style&&a.setStyles(S,g.style),g.tooltip&&a.tooltip(S,g.tooltip),g.click&&this.art.events.proxy(S,"click",c=>{c.preventDefault(),g.click.call(this.art,this,c)}),g.selector&&["left","right"].includes(g.position)&&this.selector(g,S),g.mounted&&g.mounted.call(this.art,S),S.childNodes.length===1&&S.childNodes[0].nodeType===3&&a.addClass(S,"art-control-onlyText"),p.def(this,E,{value:S}),S}selector(f,g){const{hover:E,proxy:S}=this.art.events;a.addClass(g,"art-control-selector");const _=document.createElement("div");a.addClass(_,"art-selector-value"),a.append(_,f.html),g.innerText="",a.append(g,_);const m=f.selector.map((y,d)=>`<div class="art-selector-item ${y.default?"art-current":""}" data-index="${d}">${y.html}</div>`).join(""),c=document.createElement("div");a.addClass(c,"art-selector-list"),a.append(c,m),a.append(g,c);const v=()=>{const y=a.getStyle(g,"width")/2-a.getStyle(c,"width")/2;c.style.left=`${y}px`};E(g,v),S(c,"click",y=>yr(this,null,function*(){const d=(y.composedPath()||[]).find(T=>a.hasClass(T,"art-selector-item"));if(!d)return;a.inverseClass(d,"art-current");const x=Number(d.dataset.index),b=f.selector[x]||{};if(_.innerText=d.innerText,f.onSelect){const T=yield f.onSelect.call(this.art,b,d,y);typeof T!="string"&&typeof T!="number"||(_.innerHTML=T)}v(),this.art.emit("selector",b,d)}))}}},{"./dom":"ff6Hs","option-validator":"hqjoJ","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Fullscreen"),mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o,f=n.append(l,p.fullscreenOn),g=n.append(l,p.fullscreenOff);n.setStyle(g,"display","none"),h(l,"click",()=>{o.fullscreen=!o.fullscreen}),o.on("fullscreen",E=>{E?(n.tooltip(l,u.get("Exit Fullscreen")),n.setStyle(f,"display","none"),n.setStyle(g,"display","inline-flex")):(n.tooltip(l,u.get("Fullscreen")),n.setStyle(f,"display","inline-flex"),n.setStyle(g,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Web Fullscreen"),mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o,f=n.append(l,p.fullscreenWebOn),g=n.append(l,p.fullscreenWebOff);n.setStyle(g,"display","none"),h(l,"click",()=>{o.fullscreenWeb=!o.fullscreenWeb}),o.on("fullscreenWeb",E=>{E?(n.tooltip(l,u.get("Exit Web Fullscreen")),n.setStyle(f,"display","none"),n.setStyle(g,"display","inline-flex")):(n.tooltip(l,u.get("Web Fullscreen")),n.setStyle(f,"display","inline-flex"),n.setStyle(g,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("PIP Mode"),mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o;n.append(l,p.pip),h(l,"click",()=>{o.pip=!o.pip}),o.on("pip",f=>{n.tooltip(l,u.get(f?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o,f=n.append(l,p.play),g=n.append(l,p.pause);function E(){n.setStyle(f,"display","flex"),n.setStyle(g,"display","none")}function S(){n.setStyle(f,"display","none"),n.setStyle(g,"display","flex")}n.tooltip(f,u.get("Play")),n.tooltip(g,u.get("Pause")),h(f,"click",()=>{o.play()}),h(g,"click",()=>{o.pause()}),o.playing?S():E(),o.on("video:playing",()=>{S()}),o.on("video:pause",()=>{E()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"getPosFromEvent",()=>o);var a=r("../utils");function o(l,h){const{$progress:p}=l.template,{left:u}=p.getBoundingClientRect(),f=h.pageX,g=a.clamp(f-u,0,p.clientWidth),E=g/p.clientWidth*l.duration;return{second:E,time:a.secondToTime(E),width:g,percentage:a.clamp(g/p.clientWidth,0,1)}}t.default=function(l){return h=>{const{icons:p,option:u,events:{proxy:f}}=h;return Ot(yt({},l),{html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:g=>{let E=!1;const S=a.query(".art-progress-loaded",g),_=a.query(".art-progress-played",g),m=a.query(".art-progress-highlight",g),c=a.query(".art-progress-indicator",g),v=a.query(".art-progress-tip",g);a.setStyle(_,"backgroundColor","var(--theme)");let y=h.constructor.INDICATOR_SIZE;function d(x,b){x==="loaded"&&a.setStyle(S,"width",100*b+"%"),x==="played"&&(a.setStyle(_,"width",100*b+"%"),a.setStyle(c,"left",`calc(${100*b}% - ${y/2}px)`))}p.indicator?(y=h.constructor.INDICATOR_SIZE_ICON,a.append(c,p.indicator)):a.setStyles(c,{backgroundColor:"var(--theme)"}),a.isMobile&&(y=h.constructor.INDICATOR_SIZE_MOBILE,p.indicator&&(y=h.constructor.INDICATOR_SIZE_MOBILE_ICON)),a.setStyles(c,{left:`-${y/2}px`,width:`${y}px`,height:`${y}px`}),h.on("video:loadedmetadata",()=>{for(let x=0;x<u.highlight.length;x++){const b=u.highlight[x],T=a.clamp(b.time,0,h.duration)/h.duration*100;a.append(m,`<span data-text="${b.text}" data-time="${b.time}" style="left: ${T}%"></span>`)}}),d("loaded",h.loaded),h.on("setBar",(x,b)=>{d(x,b)}),h.on("video:progress",()=>{d("loaded",h.loaded)}),h.on("video:timeupdate",()=>{d("played",h.played)}),h.on("video:ended",()=>{d("played",1)}),a.isMobile||(f(g,"click",x=>{if(x.target!==c){const{second:b,percentage:T}=o(h,x);d("played",T),h.seek=b}}),f(g,"mousemove",x=>{a.setStyle(v,"display","block"),a.includeFromEvent(x,m)?function(b){const{width:T}=o(h,b),{text:A}=b.target.dataset;v.innerHTML=A;const L=v.clientWidth;T<=L/2?a.setStyle(v,"left",0):T>g.clientWidth-L/2?a.setStyle(v,"left",g.clientWidth-L+"px"):a.setStyle(v,"left",T-L/2+"px")}(x):function(b){const{width:T,time:A}=o(h,b);v.innerHTML=A;const L=v.clientWidth;T<=L/2?a.setStyle(v,"left",0):T>g.clientWidth-L/2?a.setStyle(v,"left",g.clientWidth-L+"px"):a.setStyle(v,"left",T-L/2+"px")}(x)}),f(g,"mouseout",()=>{a.setStyle(v,"display","none")}),f(c,"mousedown",()=>{E=!0}),f(document,"mousemove",x=>{if(E){const{second:b,percentage:T}=o(h,x);d("played",T),h.seek=b}}),f(document,"mouseup",()=>{E&&(E=!1)}))}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{style:{cursor:"auto"},mounted:l=>{function h(){const u=`${n.secondToTime(o.currentTime)} / ${n.secondToTime(o.duration)}`;u!==l.innerText&&(l.innerText=u)}h();const p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let u=0;u<p.length;u++)o.on(p[u],h)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o;let f=!1;const g=o.constructor.VOLUME_PANEL_WIDTH,E=o.constructor.VOLUME_HANDLE_WIDTH,S=n.append(l,p.volume),_=n.append(l,p.volumeClose),m=n.append(l,'<div class="art-volume-panel"></div>'),c=n.append(m,'<div class="art-volume-slider-handle"></div>');function v(d){const{left:x}=m.getBoundingClientRect();return n.clamp(d.pageX-x-E/2,0,g-E/2)/(g-E)}function y(d=.7){if(o.muted||d===0)n.setStyle(S,"display","none"),n.setStyle(_,"display","flex"),n.setStyle(c,"left","0");else{const x=(g-E)*d;n.setStyle(S,"display","flex"),n.setStyle(_,"display","none"),n.setStyle(c,"left",`${x}px`)}}n.tooltip(S,u.get("Mute")),n.setStyle(_,"display","none"),n.isMobile&&n.setStyle(m,"display","none"),y(o.volume),o.on("video:volumechange",()=>{y(o.volume)}),h(S,"click",()=>{o.muted=!0}),h(_,"click",()=>{o.muted=!1}),h(m,"click",d=>{o.muted=!1,o.volume=v(d)}),h(c,"mousedown",()=>{f=!0}),h(l,"mousemove",d=>{f&&(o.muted=!1,o.volume=v(d))}),h(document,"mouseup",()=>{f&&(f=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Show Setting"),mounted:l=>{const{events:{proxy:h},icons:p,i18n:u}=o;n.append(l,p.setting),h(l,"click",()=>{o.setting.toggle=!0}),o.on("setting",f=>{n.tooltip(l,u.get(f?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils"),a=r("./progress");t.default=function(o){return l=>Ot(yt({},o),{mounted:h=>{const{option:p,template:{$progress:u,$video:f},events:{proxy:g,loadImg:E}}=l;let S=null,_=!1,m=!1;g(u,"mousemove",c=>yr(this,null,function*(){_||(_=!0,S=yield E(p.thumbnails.url),m=!0),m&&(n.setStyle(h,"display","block"),function(v){const{width:y}=a.getPosFromEvent(l,v),{url:d,number:x,column:b}=p.thumbnails,T=S.naturalWidth/b,A=T/(f.videoWidth/f.videoHeight),L=u.clientWidth/x,R=Math.floor(y/L),w=Math.ceil(R/b)-1,O=R%b||b-1;n.setStyle(h,"backgroundImage",`url(${d})`),n.setStyle(h,"height",`${A}px`),n.setStyle(h,"width",`${T}px`),n.setStyle(h,"backgroundPosition",`-${O*T}px -${w*A}px`),y<=T/2?n.setStyle(h,"left",0):y>u.clientWidth-T/2?n.setStyle(h,"left",u.clientWidth-T+"px"):n.setStyle(h,"left",y-T/2+"px")}(c))})),g(u,"mouseout",()=>{n.setStyle(h,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Screenshot"),mounted:l=>{const{events:{proxy:h},icons:p}=o;n.append(l,p.screenshot),h(l,"click",()=>{o.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>{const o=a.option.quality,l=o.find(h=>h.default)||o[0];return Ot(yt({},n),{html:l?l.html:"",selector:o,onSelect(h){a.switchQuality(h.url,h.html)}})}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const h=n.append(l,'<span class="art-loop-point"></span>'),p=n.append(l,'<span class="art-loop-point"></span>');o.on("loop",u=>{u?(n.setStyle(l,"display","block"),n.setStyle(h,"left",`calc(${u[0]/o.duration*100}% - ${h.clientWidth}px)`),n.setStyle(p,"left",u[1]/o.duration*100+"%")):n.setStyle(l,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),l=n.interopDefault(o),h=r("./playbackRate"),p=n.interopDefault(h),u=r("./aspectRatio"),f=n.interopDefault(u),g=r("./flip"),E=n.interopDefault(g),S=r("./info"),_=n.interopDefault(S),m=r("./version"),c=n.interopDefault(m),v=r("./close"),y=n.interopDefault(v);class d extends l.default{constructor(b){super(b),this.name="contextmenu",this.$parent=b.template.$contextmenu,a.isMobile||this.init()}init(){const{option:b,template:{$player:T,$contextmenu:A},events:{proxy:L}}=this.art;this.add(p.default({disable:!b.playbackRate,name:"playbackRate",index:10})),this.add(f.default({disable:!b.aspectRatio,name:"aspectRatio",index:20})),this.add(E.default({disable:!b.flip,name:"flip",index:30})),this.add(_.default({disable:!1,name:"info",index:40})),this.add(c.default({disable:!1,name:"version",index:50})),this.add(y.default({disable:!1,name:"close",index:60}));for(let R=0;R<b.contextmenu.length;R++)this.add(b.contextmenu[R]);L(T,"contextmenu",R=>{R.preventDefault(),this.show=!0;const w=R.clientX,O=R.clientY,{height:I,width:D,left:C,top:P}=T.getBoundingClientRect(),{height:M,width:N}=A.getBoundingClientRect();let B=w-C,U=O-P;w+N>C+D&&(B=D-N),O+M>P+I&&(U=I-M),a.setStyles(A,{top:`${U}px`,left:`${B}px`})}),L(T,"click",R=>{a.includeFromEvent(R,A)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}t.default=d},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${l.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(h,p)=>{const{value:u}=p.target.dataset;u&&(o.playbackRate=Number(u),h.show=!1)},mounted:h=>{o.on("playbackRate",p=>{const u=n.queryAll("span",h).find(f=>Number(f.dataset.value)===p);u&&n.inverseClass(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Aspect Ratio")}:<span data-value="default" class="art-current">${l.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(h,p)=>{const{value:u}=p.target.dataset;u&&(o.aspectRatio=u,h.show=!1)},mounted:h=>{o.on("aspectRatio",p=>{const u=n.queryAll("span",h).find(f=>f.dataset.value===p);u&&n.inverseClass(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Video Flip")}:<span data-value="normal" class="art-current">${l.get("Normal")}</span><span data-value="horizontal">${l.get("Horizontal")}</span><span data-value="vertical">${l.get("Vertical")}</span>`,click:(h,p)=>{const{value:u}=p.target.dataset;u&&(o.flip=u,h.show=!1)},mounted:h=>{o.on("flip",p=>{const u=n.queryAll("span",h).find(f=>f.dataset.value===p);u&&n.inverseClass(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>Ot(yt({},n),{html:a.i18n.get("Video Info"),click:o=>{a.info.show=!0,o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return Ot(yt({},n),{html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.4.3</a>'})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>Ot(yt({},n),{html:a.i18n.get("Close"),click:o=>{o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class h extends l.default{constructor(u){super(u),this.name="info",a.isMobile||this.init()}init(){const{constructor:u,events:{proxy:f},template:{$infoPanel:g,$infoClose:E,$video:S}}=this.art;f(E,"click",()=>{this.show=!1});let _=null;const m=a.queryAll("[data-video]",g)||[];this.art.on("destroy",()=>{clearTimeout(_)}),function c(){for(let v=0;v<m.length;v++){const y=m[v],d=S[y.dataset.video],x=typeof d=="number"?d.toFixed(2):d;y.innerText!==x&&(y.innerText=x)}_=setTimeout(c,u.INFO_LOOP_TIME)}()}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o),h=r("option-validator"),p=n.interopDefault(h),u=r("./scheme"),f=n.interopDefault(u);class g extends l.default{constructor(S){super(S),this.name="subtitle",this.init(S.option.subtitle)}get url(){return this.art.template.$track.src}set url(S){this.switch(S)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(S,_){const{$subtitle:m}=this.art.template;return typeof S=="object"?a.setStyles(m,S):a.setStyle(m,S,_)}update(){const{$subtitle:S}=this.art.template;S.innerHTML="",this.activeCue&&(S.innerHTML=this.activeCue.text.split(/\r?\n/).map(_=>`<p>${a.escape(_)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}switch(m){return yr(this,arguments,function*(S,_={}){const{i18n:c,notice:v,option:y}=this.art,d=Ot(yt(yt({},y.subtitle),_),{url:S}),x=yield this.init(d);return _.name&&(v.show=`${c.get("Switch Subtitle")}: ${_.name}`),x})}init(S){if(p.default(S,f.default.subtitle),!S.url)return;const{notice:_,events:{proxy:m},template:{$subtitle:c,$video:v,$track:y}}=this.art;if(!y){const d=document.createElement("track");d.default=!0,d.kind="metadata",v.appendChild(d),this.art.template.$track=d,m(this.textTrack,"cuechange",this.update.bind(this))}return this.style(S.style),a.errorHandle(window.fetch,"fetch not support"),fetch(S.url).then(d=>d.arrayBuffer()).then(d=>{a.errorHandle(window.TextDecoder,"TextDecoder not support");const x=new TextDecoder(S.encoding).decode(d);switch(this.art.emit("subtitleLoad",S.url),S.type||a.getExt(S.url)){case"srt":return a.vttToBlob(a.srtToVtt(x));case"ass":return a.vttToBlob(a.assToVtt(x));case"vtt":return a.vttToBlob(x);default:return S.url}}).then(d=>(c.innerHTML="",this.url===d||(URL.revokeObjectURL(this.url),this.art.template.$track.src=d,this.art.emit("subtitleSwitch",d)),d)).catch(d=>{throw _.show=d,d})}}t.default=g},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"hqjoJ","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils/error"),o=r("./clickInit"),l=n.interopDefault(o),h=r("./hoverInit"),p=n.interopDefault(h),u=r("./mousemoveInit"),f=n.interopDefault(u),g=r("./resizeInit"),E=n.interopDefault(g),S=r("./gestureInit"),_=n.interopDefault(S),m=r("./viewInit"),c=n.interopDefault(m);t.default=class{constructor(v){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),v.whitelist.state&&(l.default(v,this),p.default(v,this),f.default(v,this),E.default(v,this),_.default(v,this),c.default(v,this))}proxy(v,y,d,x={}){if(Array.isArray(y))return y.map(T=>this.proxy(v,T,d,x));v.addEventListener(y,d,x);const b=()=>v.removeEventListener(y,d,x);return this.destroyEvents.push(b),b}hover(v,y,d){y&&this.proxy(v,"mouseenter",y),d&&this.proxy(v,"mouseleave",d)}loadImg(v){return new Promise((y,d)=>{let x;if(v instanceof HTMLImageElement)x=v;else{if(typeof v!="string")return d(new a.ArtPlayerError("Unable to get Image"));x=new Image,x.src=v}if(x.complete)return y(x);this.proxy(x,"load",()=>y(x)),this.proxy(x,"error",()=>d(new a.ArtPlayerError(`Failed to load Image: ${x.src}`)))})}destroy(){for(let v=0;v<this.destroyEvents.length;v++)this.destroyEvents[v]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{constructor:l,template:{$player:h,$video:p}}=a;o.proxy(document,["click","contextmenu"],f=>{n.includeFromEvent(f,h)?(a.isInput=f.target.tagName==="INPUT",a.isFocus=!0,a.emit("focus")):(a.isInput=!1,a.isFocus=!1,a.emit("blur"))});let u=0;o.proxy(p,"click",()=>{const f=Date.now();f-u<=l.DB_CLICE_TIME?(a.emit("dblclick"),n.isMobile?a.isLock||a.toggle():a.fullscreen=!a.fullscreen):(a.emit("click"),n.isMobile||a.toggle()),u=f})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{$player:l}=a.template;o.hover(l,()=>{n.addClass(l,"art-hover"),a.emit("hover",!0)},()=>{n.removeClass(l,"art-hover"),a.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n,a){const{$player:o}=n.template;a.proxy(o,"mousemove",l=>{n.emit("mousemove",l)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{option:l}=a,h=n.throttle(()=>{a.normalSize&&(a.autoSize=l.autoSize),a.aspectRatioReset=!0,a.notice.show="",a.emit("resize")},a.constructor.RESIZE_TIME);o.proxy(window,["orientationchange","resize"],()=>{h()}),screen&&screen.orientation&&screen.orientation.onchange&&o.proxy(screen.orientation,"change",()=>{h()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){if(n.isMobile&&!a.option.isLive){const{$video:l,$bottom:h,$controls:p}=a.template;let u=!1,f=0,g=0,E=0;const S=c=>{if(c.touches.length===1&&!a.isLock){u=!0;const{clientX:v,clientY:y}=c.touches[0];f=v,g=y,E=a.currentTime}},_=c=>{if(c.touches.length===1&&u&&a.duration){const v=a.plugins.autoOrientation&&a.plugins.autoOrientation.state,{clientX:y,clientY:d}=c.touches[0],x=n.clamp((y-f)/a.width,-1,1),b=n.clamp((d-g)/a.height,-1,1),T=v?b:x,A=n.clamp(E+a.duration*T/2,0,a.duration);a.seek=A,a.emit("setBar","played",n.clamp(A/a.duration,0,1)),a.notice.show=`${n.secondToTime(A)} / ${n.secondToTime(a.duration)}`}},m=()=>{u&&(f=0,g=0,E=0,u=!1)};o.proxy(h,"touchstart",c=>{n.includeFromEvent(c,p)||S(c)}),o.proxy(h,"touchmove",_),o.proxy(l,"touchstart",S),o.proxy(l,"touchmove",_),o.proxy(document,"touchend",m)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{option:l,constructor:h,template:{$container:p}}=a,u=n.throttle(()=>{a.emit("view",n.isInViewport(p,h.SCROLL_GAP))},h.SCROLL_TIME);o.proxy(window,"scroll",()=>{u()}),a.on("view",f=>{l.autoMini&&(a.mini=!f)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.keys={},a.option.hotkey&&!n.isMobile&&this.init()}init(){const{proxy:a}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),a(window,"keydown",o=>{if(this.art.isFocus){const l=document.activeElement.tagName.toUpperCase(),h=document.activeElement.getAttribute("contenteditable");if(l!=="INPUT"&&l!=="TEXTAREA"&&h!==""&&h!=="true"){const p=this.keys[o.keyCode];if(p){o.preventDefault();for(let u=0;u<p.length;u++)p[u].call(this.art,o);this.art.emit("hotkey",o)}}}})}add(a,o){return this.keys[a]?this.keys[a].push(o):this.keys[a]=[o],this}remove(a,o){if(this.keys[a]){const l=this.keys[a].indexOf(o);l!==-1&&this.keys[a].splice(l,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils/component"),o=n.interopDefault(a);class l extends o.default{constructor(p){super(p);const{option:u,template:{$layer:f}}=p;this.name="layer",this.$parent=f;for(let g=0;g<u.layers.length;g++)this.add(u.layers[g])}}t.default=l},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class h extends l.default{constructor(u){super(u),this.name="loading",a.append(u.template.$loading,u.icons.loading)}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.timer=null}set show(a){const{constructor:o,template:{$player:l,$noticeInner:h}}=this.art;a?(h.innerText=a instanceof Error?a.message.trim():a,n.addClass(l,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{h.innerText="",n.removeClass(l,"art-notice-show")},o.NOTICE_TIME)):n.removeClass(l,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class h extends l.default{constructor(u){super(u),this.name="mask";const{template:f,icons:g,events:E}=u,S=a.append(f.$state,g.state),_=a.append(f.$state,g.error);a.setStyle(_,"display","none"),u.on("destroy",()=>{a.setStyle(S,"display","none"),a.setStyle(_,"display",null)}),E.proxy(f.$state,"click",()=>u.play())}}t.default=h},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("bundle-text:./loading.svg"),l=n.interopDefault(o),h=r("bundle-text:./state.svg"),p=n.interopDefault(h),u=r("bundle-text:./check.svg"),f=n.interopDefault(u),g=r("bundle-text:./play.svg"),E=n.interopDefault(g),S=r("bundle-text:./pause.svg"),_=n.interopDefault(S),m=r("bundle-text:./volume.svg"),c=n.interopDefault(m),v=r("bundle-text:./volume-close.svg"),y=n.interopDefault(v),d=r("bundle-text:./screenshot.svg"),x=n.interopDefault(d),b=r("bundle-text:./setting.svg"),T=n.interopDefault(b),A=r("bundle-text:./arrow-left.svg"),L=n.interopDefault(A),R=r("bundle-text:./arrow-right.svg"),w=n.interopDefault(R),O=r("bundle-text:./playback-rate.svg"),I=n.interopDefault(O),D=r("bundle-text:./aspect-ratio.svg"),C=n.interopDefault(D),P=r("bundle-text:./config.svg"),M=n.interopDefault(P),N=r("bundle-text:./pip.svg"),B=n.interopDefault(N),U=r("bundle-text:./lock.svg"),F=n.interopDefault(U),j=r("bundle-text:./unlock.svg"),V=n.interopDefault(j),G=r("bundle-text:./fullscreen-off.svg"),Y=n.interopDefault(G),X=r("bundle-text:./fullscreen-on.svg"),ie=n.interopDefault(X),he=r("bundle-text:./fullscreen-web-off.svg"),de=n.interopDefault(he),Ae=r("bundle-text:./fullscreen-web-on.svg"),pe=n.interopDefault(Ae),le=r("bundle-text:./switch-on.svg"),Ie=n.interopDefault(le),Ce=r("bundle-text:./switch-off.svg"),Ue=n.interopDefault(Ce),Me=r("bundle-text:./flip.svg"),ze=n.interopDefault(Me),Ge=r("bundle-text:./error.svg"),$e=n.interopDefault(Ge);t.default=class{constructor(He){const Fe=yt({loading:l.default,state:p.default,play:E.default,pause:_.default,check:f.default,volume:c.default,volumeClose:y.default,screenshot:x.default,setting:T.default,pip:B.default,arrowLeft:L.default,arrowRight:w.default,playbackRate:I.default,aspectRatio:C.default,config:M.default,lock:F.default,flip:ze.default,unlock:V.default,fullscreenOff:Y.default,fullscreenOn:ie.default,fullscreenWebOff:de.default,fullscreenWebOn:pe.default,switchOn:Ie.default,switchOff:Ue.default,error:$e.default},He.option.icons);Object.keys(Fe).forEach(Se=>{a.def(this,Se,{get:()=>{const Xe=document.createElement("i");return a.addClass(Xe,"art-icon"),a.addClass(Xe,`art-icon-${Se}`),a.append(Xe,Fe[Se]),Xe}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ"}],hX0lQ:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(r,i,t){i.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(r,i,t){i.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],d5XKP:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./flip"),o=n.interopDefault(a),l=r("./aspectRatio"),h=n.interopDefault(l),p=r("./playbackRate"),u=n.interopDefault(p),f=r("./subtitleOffset"),g=n.interopDefault(f),E=r("../utils/component"),S=n.interopDefault(E),_=r("../utils");function m(y,d,x){for(let b=0;b<y.length;b++){const T=y[b];T.$parentItem=d,T.$parentList=x,T.selector&&m(T.selector,T,y)}return y}function c(y){return["string","number"].includes(typeof y)}class v extends S.default{constructor(d){super(d);const{option:x,events:{proxy:b},template:{$setting:T,$player:A}}=d;if(this.name="setting",this.$parent=T,this.option=[],this.events=[],this.cache=new Map,x.setting){x.playbackRate&&this.option.push(u.default(d)),x.aspectRatio&&this.option.push(h.default(d)),x.flip&&this.option.push(o.default(d)),x.subtitleOffset&&this.option.push(g.default(d));for(let L=0;L<x.settings.length;L++)this.option.push(x.settings[L]);this.option=m(this.option),this.init(this.option),d.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),b(A,"click",L=>{!this.show||_.includeFromEvent(L,d.controls.setting)||_.includeFromEvent(L,this.$parent)||(this.show=!1,this.init(this.option))})}}add(d){typeof d=="function"?this.option.push(d(this.art)):this.option.push(d),this.cache=new Map,this.events.forEach(x=>x()),this.events=[],this.$parent.innerHTML="",this.option=m(this.option),this.init(this.option)}creatHeader(d){const{icons:x,events:{proxy:b}}=this.art,T=document.createElement("div");_.addClass(T,"art-setting-item"),_.addClass(T,"art-setting-item-back");const A=_.append(T,'<div class="art-setting-item-left"></div>'),L=document.createElement("div");_.addClass(L,"art-setting-item-left-icon"),_.append(L,x.arrowLeft),_.append(A,L),_.append(A,d.$parentItem.html);const R=b(T,"click",()=>{this.init(d.$parentList)});return this.events.push(R),T}creatItem(d,x){const{icons:b,events:{proxy:T}}=this.art,A=document.createElement("div");_.addClass(A,"art-setting-item"),c(x.name)&&(A.dataset.name=x.name),c(x.value)&&(A.dataset.value=x.value);const L=_.append(A,'<div class="art-setting-item-left"></div>'),R=_.append(A,'<div class="art-setting-item-right"></div>'),w=document.createElement("div");switch(_.addClass(w,"art-setting-item-left-icon"),d){case"switch":case"range":_.append(w,c(x.icon)||x.icon instanceof Element?x.icon:b.config);break;case"selector":x.selector&&x.selector.length?_.append(w,c(x.icon)||x.icon instanceof Element?x.icon:b.config):_.append(w,b.check)}_.append(L,w),x.$icon=w,_.def(x,"icon",{configurable:!0,get:()=>w.innerHTML,set(D){c(D)&&(w.innerHTML=D)}});const O=document.createElement("div");_.addClass(O,"art-setting-item-left-text"),_.append(O,x.html||""),_.append(L,O),x.$html=O,_.def(x,"html",{configurable:!0,get:()=>O.innerHTML,set(D){c(D)&&(O.innerHTML=D)}});const I=document.createElement("div");switch(_.addClass(I,"art-setting-item-right-tooltip"),_.append(I,x.tooltip||""),_.append(R,I),x.$tooltip=I,_.def(x,"tooltip",{configurable:!0,get:()=>I.innerHTML,set(D){c(D)&&(I.innerHTML=D)}}),d){case"switch":{const D=document.createElement("div");_.addClass(D,"art-setting-item-right-icon");const C=_.append(D,b.switchOn),P=_.append(D,b.switchOff);_.setStyle(x.switch?P:C,"display","none"),_.append(R,D),x.$switch=x.switch,_.def(x,"switch",{configurable:!0,get:()=>x.$switch,set(M){x.$switch=M,M?(_.setStyle(P,"display","none"),_.setStyle(C,"display",null)):(_.setStyle(P,"display",null),_.setStyle(C,"display","none"))}});break}case"range":{const D=document.createElement("div");_.addClass(D,"art-setting-item-right-icon");const C=_.append(D,'<input type="range">');C.value=x.range[0]||0,C.min=x.range[1]||0,C.max=x.range[2]||10,C.step=x.range[3]||1,_.addClass(C,"art-setting-range"),_.append(R,D),x.$range=C,_.def(x,"range",{configurable:!0,get:()=>C.valueAsNumber,set(P){C.value=Number(P)}})}break;case"selector":if(x.selector&&x.selector.length){const D=document.createElement("div");_.addClass(D,"art-setting-item-right-icon"),_.append(D,b.arrowRight),_.append(R,D)}}switch(d){case"switch":if(x.onSwitch){const D=T(A,"click",C=>yr(this,null,function*(){x.switch=yield x.onSwitch.call(this.art,x,A,C)}));this.events.push(D)}break;case"range":if(x.onRange&&x.$range){const D=T(x.$range,"change",C=>yr(this,null,function*(){x.tooltip=yield x.onRange.call(this.art,x,A,C)}));this.events.push(D)}break;case"selector":{const D=T(A,"click",C=>yr(this,null,function*(){if(x.selector&&x.selector.length)this.init(x.selector,x.width);else if(_.inverseClass(A,"art-current"),x.$parentList&&this.init(x.$parentList),x.$parentItem&&x.$parentItem.onSelect){const P=yield x.$parentItem.onSelect.call(this.art,x,A,C);x.$parentItem.$tooltip&&c(P)&&(x.$parentItem.$tooltip.innerHTML=P)}}));this.events.push(D),x.default&&_.addClass(A,"art-current")}}return A}init(d,x){const{constructor:b}=this.art;if(this.cache.has(d)){const T=this.cache.get(d);_.inverseClass(T,"art-current"),_.setStyle(this.$parent,"width",`${T.dataset.width}px`),_.setStyle(this.$parent,"height",`${T.dataset.height}px`)}else{const T=document.createElement("div");_.addClass(T,"art-setting-panel"),T.dataset.width=x||b.SETTING_WIDTH,T.dataset.height=d.length*b.SETTING_ITEM_HEIGHT,d[0]&&d[0].$parentItem&&(_.append(T,this.creatHeader(d[0])),T.dataset.height=Number(T.dataset.height)+b.SETTING_ITEM_HEIGHT);for(let A=0;A<d.length;A++){const L=d[A];_.has(L,"switch")?_.append(T,this.creatItem("switch",L)):_.has(L,"range")?_.append(T,this.creatItem("range",L)):_.append(T,this.creatItem("selector",L))}_.append(this.$parent,T),this.cache.set(d,T),_.inverseClass(T,"art-current"),_.setStyle(this.$parent,"width",`${T.dataset.width}px`),_.setStyle(this.$parent,"height",`${T.dataset.height}px`),d[0]&&d[0].$parentItem&&d[0].$parentItem.mounted&&d[0].$parentItem.mounted.call(this.art,T,d[0].$parentItem)}}}t.default=v},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:h}=a,p={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function u(f,g,E){g&&(g.innerText=o.get(p[E]));const S=n.queryAll(".art-setting-item",f).find(_=>_.dataset.value===E);S&&n.inverseClass(S,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Video Flip"),tooltip:o.get(p[a.flip]),icon:l.flip,selector:Object.keys(p).map(f=>({value:f,default:f===a.flip,html:o.get(p[f])})),onSelect(f){a.flip=f.value},mounted:(f,g)=>{u(f,g.$tooltip,a.flip),a.on("flip",()=>{u(f,g.$tooltip,a.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:h}=a;function p(f){return f==="default"?o.get("Default"):f}function u(f,g,E){g&&(g.innerText=p(E));const S=n.queryAll(".art-setting-item",f).find(_=>_.dataset.value===E);S&&n.inverseClass(S,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Aspect Ratio"),icon:l.aspectRatio,tooltip:p(a.aspectRatio),selector:["default","4:3","16:9"].map(f=>({value:f,default:f===a.aspectRatio,html:p(f)})),onSelect(f){a.aspectRatio=f.value},mounted:(f,g)=>{u(f,g.$tooltip,a.aspectRatio),a.on("aspectRatio",()=>{u(f,g.$tooltip,a.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:h}=a;function p(f){return f===1?o.get("Normal"):f}function u(f,g,E){g&&(g.innerText=p(E));const S=n.queryAll(".art-setting-item",f).find(_=>Number(_.dataset.value)===E);S&&n.inverseClass(S,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Play Speed"),tooltip:p(a.playbackRate),icon:l.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(f=>({value:f,default:f===a.playbackRate,html:p(f)})),onSelect(f){a.playbackRate=f.value},mounted:(f,g)=>{u(f,g.$tooltip,a.playbackRate),a.on("playbackRate",()=>{u(f,g.$tooltip,a.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:h}=a;function p(f){return f===0?o.get("Normal"):f}function u(f,g,E){g&&(g.innerText=p(E));const S=n.queryAll(".art-setting-item",f).find(_=>Number(_.dataset.value)===E);S&&n.inverseClass(S,"art-current")}return{width:h.SETTING_ITEM_WIDTH,html:o.get("Subtitle Offset"),tooltip:p(a.subtitleOffset),icon:l.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(f=>({value:f,default:f===a.subtitleOffset,html:p(f)})),onSelect(f){a.subtitleOffset=f.value},mounted:(f,g)=>{u(f,g.$tooltip,a.subtitleOffset),a.on("subtitleOffset",()=>{u(f,g.$tooltip,a.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(n){try{const a=JSON.parse(window.localStorage.getItem(this.name))||{};return n?a[n]:a}catch(a){return n?this.settings[n]:this.settings}}set(n,a){try{const o=Object.assign({},this.get(),{[n]:a});window.localStorage.setItem(this.name,JSON.stringify(o))}catch(o){this.settings[n]=a}}del(n){try{const a=this.get();delete a[n],window.localStorage.setItem(this.name,JSON.stringify(a))}catch(a){delete this.settings[n]}}clear(){try{window.localStorage.removeItem(this.name)}catch(n){this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./miniProgressBar"),l=n.interopDefault(o),h=r("./autoOrientation"),p=n.interopDefault(h),u=r("./autoPlayback"),f=n.interopDefault(u),g=r("./fastForward"),E=n.interopDefault(g),S=r("./lock"),_=n.interopDefault(S);t.default=class{constructor(m){this.art=m,this.id=0;const{option:c}=m;c.miniProgressBar&&!c.isLive&&this.add(l.default),c.lock&&a.isMobile&&this.add(_.default),c.autoPlayback&&this.add(f.default),c.autoOrientation&&a.isMobile&&this.add(p.default),c.fastForward&&a.isMobile&&!c.isLive&&this.add(E.default);for(let v=0;v<c.plugins.length;v++)this.add(c.plugins[v])}add(m){this.id+=1;const c=m.call(this,this.art),v=c&&c.name||m.name||`plugin${this.id}`;return a.errorHandle(!a.has(this,v),`Cannot add a plugin that already has the same name: ${v}`),a.def(this,v,{value:c}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return n.on("ready",()=>{n.layers.add({name:"miniProgressBar",mounted(a){n.on("destroy",()=>{a.style.display="none"}),n.on("video:timeupdate",()=>{a.style.width=100*n.played+"%"}),n.on("setBar",(o,l)=>{o==="played"&&(a.style.width=100*l+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,constructor:l,template:{$player:h,$video:p}}=a;return a.on("fullscreenWeb",u=>{if(u){const{videoWidth:f,videoHeight:g}=p,{clientWidth:E,clientHeight:S}=document.documentElement;(f>g&&E<S||f<g&&E>S)&&setTimeout(()=>{n.setStyle(h,"width",`${S}px`),n.setStyle(h,"height",`${E}px`),n.setStyle(h,"transform-origin","0 0"),n.setStyle(h,"transform",`rotate(90deg) translate(0, -${E}px)`),n.addClass(h,"art-auto-orientation"),a.emit("resize")},l.MOBILE_AUTO_ORIENTATION_TIME)}else n.hasClass(h,"art-auto-orientation")&&(n.setStyle(h,"width",null),n.setStyle(h,"height",null),n.setStyle(h,"transform",null),n.setStyle(h,"transform-origin",null),n.removeClass(h,"art-auto-orientation"),a.aspectRatioReset=!0,a.autoSize=o.autoSize,a.notice.show="",a.emit("resize"))}),a.on("fullscreen",u=>yr(this,null,function*(){const f=screen.orientation.type;if(u){const{videoWidth:g,videoHeight:E}=p,{clientWidth:S,clientHeight:_}=document.documentElement;if(g>E&&S<_||g<E&&S>_){const m=f.startsWith("portrait")?"landscape":"portrait";yield screen.orientation.lock(m),n.addClass(h,"art-auto-orientation-fullscreen")}}else n.hasClass(h,"art-auto-orientation-fullscreen")&&(yield screen.orientation.lock(f),n.removeClass(h,"art-auto-orientation-fullscreen"))})),{name:"autoOrientation",get state(){return n.hasClass(h,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,storage:l,constructor:h,template:{$poster:p}}=a;return a.on("video:timeupdate",()=>{const u=l.get("times")||{},f=Object.keys(u);f.length>h.AUTO_PLAYBACK_MAX&&delete u[f[0]],u[a.option.url]=a.currentTime,l.set("times",u)}),a.on("ready",()=>{const u=(l.get("times")||{})[a.option.url];u&&(a.seek=u,n.setStyle(p,"display","none"),a.notice.show=`${o.get("Auto playback at")} ${n.secondToTime(u)}`)}),{name:"autoPlayback",get times(){return l.get("times")||{}},clear:()=>l.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{constructor:o,events:{proxy:l},template:{$player:h,$video:p}}=a;let u=null,f=!1;const g=()=>{clearTimeout(u),f&&(f=!1,a.playbackRate=1,n.removeClass(h,"art-fast-forward"))};return l(p,"touchstart",E=>{E.touches.length===1&&a.playing&&!a.isLock&&(u=setTimeout(()=>{f=!0,a.playbackRate=o.FAST_FORWARD_VALUE,n.addClass(h,"art-fast-forward")},o.FAST_FORWARD_TIME))}),l(document,"touchmove",g),l(document,"touchend",g),{name:"fastForward",get state(){return n.hasClass(h,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{layers:o,icons:l,template:{$player:h}}=a;return o.add({name:"lock",mounted(p){const u=n.append(p,l.lock),f=n.append(p,l.unlock);n.setStyle(u,"display","none"),a.on("lock",g=>{g?(n.setStyle(u,"display","inline-flex"),n.setStyle(f,"display","none")):(n.setStyle(u,"display","none"),n.setStyle(f,"display","inline-flex"))})},click(){n.hasClass(h,"art-lock")?(n.removeClass(h,"art-lock"),this.isLock=!1,a.emit("lock",!1)):(n.addClass(h,"art-lock"),this.isLock=!0,a.emit("lock",!0))}}),{name:"lock",get state(){return n.hasClass(h,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aafSd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(n){this.art=n,this.init()}get current(){return this.art.option.ads[this.index]}get prev(){return this.art.option.ads[this.index-1]}get next(){return this.art.option.ads[this.index+1]}init(){this.index=0,this.isEnd=!1,this.playing=!1,this.urlCache=this.art.option.url,this.current&&(this.playing=!0,this.play(this.current))}play(n={}){this.isEnd||(this.art.switchUrl(n.url),this.art.once("video:timeupdate",()=>{this.art.emit("ads:start",n)}),this.art.once("video:ended",()=>{const a=this.next;a?(this.index+=1,this.play(a)):this.end()}))}end(){this.isEnd||(this.isEnd=!0,this.playing=!1,this.art.option.url=this.urlCache,this.art.switchUrl(this.urlCache),this.art.emit("ads:end"))}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./config"),o=n.interopDefault(a),l=r("./utils");t.default=class{constructor(h){const{option:p,events:{proxy:u},template:{$video:f}}=h;for(let S=0;S<o.default.events.length;S++)u(f,o.default.events[S],_=>{h.emit(`video:${_.type}`,_)});Object.keys(p.moreVideoAttr).forEach(S=>{f[S]=p.moreVideoAttr[S]}),p.muted&&(f.muted=p.muted),p.volume&&(f.volume=l.clamp(p.volume,0,1)),p.poster&&(f.poster=p.poster),p.autoplay&&(f.autoplay=p.autoplay),p.playsInline&&(f.playsInline=!0,f["webkit-playsinline"]=!0);const g=p.type||l.getExt(p.url),E=p.customType[g];g&&E?(E(f,p.url,h),h.emit("customType",g)):(f.src=p.url,h.emit("url",f.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Ih);var MT=xo(Ih.exports),Rh={exports:{}};(function(s,e){(function(i,t){s.exports=t()})(self,function(){return function(){var r={"./node_modules/es6-promise/dist/es6-promise.js":function(a,o,l){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(h,p){a.exports=p()})(this,function(){function h(ne){var Ee=typeof ne;return ne!==null&&(Ee==="object"||Ee==="function")}function p(ne){return typeof ne=="function"}var u=void 0;Array.isArray?u=Array.isArray:u=function(ne){return Object.prototype.toString.call(ne)==="[object Array]"};var f=u,g=0,E=void 0,S=void 0,_=function(Ee,xe){O[g]=Ee,O[g+1]=xe,g+=2,g===2&&(S?S(I):C())};function m(ne){S=ne}function c(ne){_=ne}var v=typeof window!="undefined"?window:void 0,y=v||{},d=y.MutationObserver||y.WebKitMutationObserver,x=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",b=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function T(){return function(){return process.nextTick(I)}}function A(){return typeof E!="undefined"?function(){E(I)}:w()}function L(){var ne=0,Ee=new d(I),xe=document.createTextNode("");return Ee.observe(xe,{characterData:!0}),function(){xe.data=ne=++ne%2}}function R(){var ne=new MessageChannel;return ne.port1.onmessage=I,function(){return ne.port2.postMessage(0)}}function w(){var ne=setTimeout;return function(){return ne(I,1)}}var O=new Array(1e3);function I(){for(var ne=0;ne<g;ne+=2){var Ee=O[ne],xe=O[ne+1];Ee(xe),O[ne]=void 0,O[ne+1]=void 0}g=0}function D(){try{var ne=Function("return this")().require("vertx");return E=ne.runOnLoop||ne.runOnContext,A()}catch(Ee){return w()}}var C=void 0;x?C=T():d?C=L():b?C=R():v===void 0?C=D():C=w();function P(ne,Ee){var xe=this,we=new this.constructor(B);we[N]===void 0&&$e(we);var be=xe._state;if(be){var je=arguments[be-1];_(function(){return Ue(be,we,je,xe._result)})}else Ie(xe,we,ne,Ee);return we}function M(ne){var Ee=this;if(ne&&typeof ne=="object"&&ne.constructor===Ee)return ne;var xe=new Ee(B);return de(xe,ne),xe}var N=Math.random().toString(36).substring(2);function B(){}var U=void 0,F=1,j=2;function V(){return new TypeError("You cannot resolve a promise with itself")}function G(){return new TypeError("A promises callback cannot return that same promise.")}function Y(ne,Ee,xe,we){try{ne.call(Ee,xe,we)}catch(be){return be}}function X(ne,Ee,xe){_(function(we){var be=!1,je=Y(xe,Ee,function(K){be||(be=!0,Ee!==K?de(we,K):pe(we,K))},function(K){be||(be=!0,le(we,K))},"Settle: "+(we._label||" unknown promise"));!be&&je&&(be=!0,le(we,je))},ne)}function ie(ne,Ee){Ee._state===F?pe(ne,Ee._result):Ee._state===j?le(ne,Ee._result):Ie(Ee,void 0,function(xe){return de(ne,xe)},function(xe){return le(ne,xe)})}function he(ne,Ee,xe){Ee.constructor===ne.constructor&&xe===P&&Ee.constructor.resolve===M?ie(ne,Ee):xe===void 0?pe(ne,Ee):p(xe)?X(ne,Ee,xe):pe(ne,Ee)}function de(ne,Ee){if(ne===Ee)le(ne,V());else if(h(Ee)){var xe=void 0;try{xe=Ee.then}catch(we){le(ne,we);return}he(ne,Ee,xe)}else pe(ne,Ee)}function Ae(ne){ne._onerror&&ne._onerror(ne._result),Ce(ne)}function pe(ne,Ee){ne._state===U&&(ne._result=Ee,ne._state=F,ne._subscribers.length!==0&&_(Ce,ne))}function le(ne,Ee){ne._state===U&&(ne._state=j,ne._result=Ee,_(Ae,ne))}function Ie(ne,Ee,xe,we){var be=ne._subscribers,je=be.length;ne._onerror=null,be[je]=Ee,be[je+F]=xe,be[je+j]=we,je===0&&ne._state&&_(Ce,ne)}function Ce(ne){var Ee=ne._subscribers,xe=ne._state;if(Ee.length!==0){for(var we=void 0,be=void 0,je=ne._result,K=0;K<Ee.length;K+=3)we=Ee[K],be=Ee[K+xe],we?Ue(xe,we,be,je):be(je);ne._subscribers.length=0}}function Ue(ne,Ee,xe,we){var be=p(xe),je=void 0,K=void 0,ce=!0;if(be){try{je=xe(we)}catch(_e){ce=!1,K=_e}if(Ee===je){le(Ee,G());return}}else je=we;Ee._state!==U||(be&&ce?de(Ee,je):ce===!1?le(Ee,K):ne===F?pe(Ee,je):ne===j&&le(Ee,je))}function Me(ne,Ee){try{Ee(function(we){de(ne,we)},function(we){le(ne,we)})}catch(xe){le(ne,xe)}}var ze=0;function Ge(){return ze++}function $e(ne){ne[N]=ze++,ne._state=void 0,ne._result=void 0,ne._subscribers=[]}function He(){return new Error("Array Methods must be provided an Array")}var Fe=function(){function ne(Ee,xe){this._instanceConstructor=Ee,this.promise=new Ee(B),this.promise[N]||$e(this.promise),f(xe)?(this.length=xe.length,this._remaining=xe.length,this._result=new Array(this.length),this.length===0?pe(this.promise,this._result):(this.length=this.length||0,this._enumerate(xe),this._remaining===0&&pe(this.promise,this._result))):le(this.promise,He())}return ne.prototype._enumerate=function(xe){for(var we=0;this._state===U&&we<xe.length;we++)this._eachEntry(xe[we],we)},ne.prototype._eachEntry=function(xe,we){var be=this._instanceConstructor,je=be.resolve;if(je===M){var K=void 0,ce=void 0,_e=!1;try{K=xe.then}catch(Z){_e=!0,ce=Z}if(K===P&&xe._state!==U)this._settledAt(xe._state,we,xe._result);else if(typeof K!="function")this._remaining--,this._result[we]=xe;else if(be===nt){var Re=new be(B);_e?le(Re,ce):he(Re,xe,K),this._willSettleAt(Re,we)}else this._willSettleAt(new be(function(Z){return Z(xe)}),we)}else this._willSettleAt(je(xe),we)},ne.prototype._settledAt=function(xe,we,be){var je=this.promise;je._state===U&&(this._remaining--,xe===j?le(je,be):this._result[we]=be),this._remaining===0&&pe(je,this._result)},ne.prototype._willSettleAt=function(xe,we){var be=this;Ie(xe,void 0,function(je){return be._settledAt(F,we,je)},function(je){return be._settledAt(j,we,je)})},ne}();function Se(ne){return new Fe(this,ne).promise}function Xe(ne){var Ee=this;return f(ne)?new Ee(function(xe,we){for(var be=ne.length,je=0;je<be;je++)Ee.resolve(ne[je]).then(xe,we)}):new Ee(function(xe,we){return we(new TypeError("You must pass an array to race."))})}function st(ne){var Ee=this,xe=new Ee(B);return le(xe,ne),xe}function et(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ot(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nt=function(){function ne(Ee){this[N]=Ge(),this._result=this._state=void 0,this._subscribers=[],B!==Ee&&(typeof Ee!="function"&&et(),this instanceof ne?Me(this,Ee):ot())}return ne.prototype.catch=function(xe){return this.then(null,xe)},ne.prototype.finally=function(xe){var we=this,be=we.constructor;return p(xe)?we.then(function(je){return be.resolve(xe()).then(function(){return je})},function(je){return be.resolve(xe()).then(function(){throw je})}):we.then(xe,xe)},ne}();nt.prototype.then=P,nt.all=Se,nt.race=Xe,nt.resolve=M,nt.reject=st,nt._setScheduler=m,nt._setAsap=c,nt._asap=_;function dt(){var ne=void 0;if(typeof l.g!="undefined")ne=l.g;else if(typeof self!="undefined")ne=self;else try{ne=Function("return this")()}catch(we){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ee=ne.Promise;if(Ee){var xe=null;try{xe=Object.prototype.toString.call(Ee.resolve())}catch(we){}if(xe==="[object Promise]"&&!Ee.cast)return}ne.Promise=nt}return nt.polyfill=dt,nt.Promise=nt,nt})},"./node_modules/events/events.js":function(a){var o=typeof Reflect=="object"?Reflect:null,l=o&&typeof o.apply=="function"?o.apply:function(w,O,I){return Function.prototype.apply.call(w,O,I)},h;o&&typeof o.ownKeys=="function"?h=o.ownKeys:Object.getOwnPropertySymbols?h=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:h=function(w){return Object.getOwnPropertyNames(w)};function p(R){console&&console.warn&&console.warn(R)}var u=Number.isNaN||function(w){return w!==w};function f(){f.init.call(this)}a.exports=f,a.exports.once=T,f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var g=10;function E(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(R){if(typeof R!="number"||R<0||u(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");g=R}}),f.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||u(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function S(R){return R._maxListeners===void 0?f.defaultMaxListeners:R._maxListeners}f.prototype.getMaxListeners=function(){return S(this)},f.prototype.emit=function(w){for(var O=[],I=1;I<arguments.length;I++)O.push(arguments[I]);var D=w==="error",C=this._events;if(C!==void 0)D=D&&C.error===void 0;else if(!D)return!1;if(D){var P;if(O.length>0&&(P=O[0]),P instanceof Error)throw P;var M=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw M.context=P,M}var N=C[w];if(N===void 0)return!1;if(typeof N=="function")l(N,this,O);else for(var B=N.length,U=d(N,B),I=0;I<B;++I)l(U[I],this,O);return!0};function _(R,w,O,I){var D,C,P;if(E(O),C=R._events,C===void 0?(C=R._events=Object.create(null),R._eventsCount=0):(C.newListener!==void 0&&(R.emit("newListener",w,O.listener?O.listener:O),C=R._events),P=C[w]),P===void 0)P=C[w]=O,++R._eventsCount;else if(typeof P=="function"?P=C[w]=I?[O,P]:[P,O]:I?P.unshift(O):P.push(O),D=S(R),D>0&&P.length>D&&!P.warned){P.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=R,M.type=w,M.count=P.length,p(M)}return R}f.prototype.addListener=function(w,O){return _(this,w,O,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(w,O){return _(this,w,O,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(R,w,O){var I={fired:!1,wrapFn:void 0,target:R,type:w,listener:O},D=m.bind(I);return D.listener=O,I.wrapFn=D,D}f.prototype.once=function(w,O){return E(O),this.on(w,c(this,w,O)),this},f.prototype.prependOnceListener=function(w,O){return E(O),this.prependListener(w,c(this,w,O)),this},f.prototype.removeListener=function(w,O){var I,D,C,P,M;if(E(O),D=this._events,D===void 0)return this;if(I=D[w],I===void 0)return this;if(I===O||I.listener===O)--this._eventsCount==0?this._events=Object.create(null):(delete D[w],D.removeListener&&this.emit("removeListener",w,I.listener||O));else if(typeof I!="function"){for(C=-1,P=I.length-1;P>=0;P--)if(I[P]===O||I[P].listener===O){M=I[P].listener,C=P;break}if(C<0)return this;C===0?I.shift():x(I,C),I.length===1&&(D[w]=I[0]),D.removeListener!==void 0&&this.emit("removeListener",w,M||O)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(w){var O,I,D;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[w]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete I[w]),this;if(arguments.length===0){var C=Object.keys(I),P;for(D=0;D<C.length;++D)P=C[D],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=I[w],typeof O=="function")this.removeListener(w,O);else if(O!==void 0)for(D=O.length-1;D>=0;D--)this.removeListener(w,O[D]);return this};function v(R,w,O){var I=R._events;if(I===void 0)return[];var D=I[w];return D===void 0?[]:typeof D=="function"?O?[D.listener||D]:[D]:O?b(D):d(D,D.length)}f.prototype.listeners=function(w){return v(this,w,!0)},f.prototype.rawListeners=function(w){return v(this,w,!1)},f.listenerCount=function(R,w){return typeof R.listenerCount=="function"?R.listenerCount(w):y.call(R,w)},f.prototype.listenerCount=y;function y(R){var w=this._events;if(w!==void 0){var O=w[R];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}f.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function d(R,w){for(var O=new Array(w),I=0;I<w;++I)O[I]=R[I];return O}function x(R,w){for(;w+1<R.length;w++)R[w]=R[w+1];R.pop()}function b(R){for(var w=new Array(R.length),O=0;O<w.length;++O)w[O]=R[O].listener||R[O];return w}function T(R,w){return new Promise(function(O,I){function D(P){R.removeListener(w,C),I(P)}function C(){typeof R.removeListener=="function"&&R.removeListener("error",D),O([].slice.call(arguments))}L(R,w,C,{once:!0}),w!=="error"&&A(R,D,{once:!0})})}function A(R,w,O){typeof R.on=="function"&&L(R,"error",w,O)}function L(R,w,O,I){if(typeof R.on=="function")I.once?R.once(w,O):R.on(w,O);else if(typeof R.addEventListener=="function")R.addEventListener(w,function D(C){I.once&&R.removeEventListener(w,D),O(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R)}},"./node_modules/webworkify-webpack/index.js":function(a,o,l){function h(m){var c={};function v(d){if(c[d])return c[d].exports;var x=c[d]={i:d,l:!1,exports:{}};return m[d].call(x.exports,x,x.exports,v),x.l=!0,x.exports}v.m=m,v.c=c,v.i=function(d){return d},v.d=function(d,x,b){v.o(d,x)||Object.defineProperty(d,x,{configurable:!1,enumerable:!0,get:b})},v.r=function(d){Object.defineProperty(d,"__esModule",{value:!0})},v.n=function(d){var x=d&&d.__esModule?function(){return d.default}:function(){return d};return v.d(x,"a",x),x},v.o=function(d,x){return Object.prototype.hasOwnProperty.call(d,x)},v.p="/",v.oe=function(d){throw console.error(d),d};var y=v(v.s=ENTRY_MODULE);return y.default||y}var p="[\\.|\\-|\\+|\\w|/|@]+",u="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function f(m){return(m+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function g(m){return!isNaN(1*m)}function E(m,c,v){var y={};y[v]=[];var d=c.toString(),x=d.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!x)return y;for(var b=x[1],T=new RegExp("(\\\\n|\\W)"+f(b)+u,"g"),A;A=T.exec(d);)A[3]!=="dll-reference"&&y[v].push(A[3]);for(T=new RegExp("\\("+f(b)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+u,"g");A=T.exec(d);)m[A[2]]||(y[v].push(A[1]),m[A[2]]=l(A[1]).m),y[A[2]]=y[A[2]]||[],y[A[2]].push(A[4]);for(var L=Object.keys(y),R=0;R<L.length;R++)for(var w=0;w<y[L[R]].length;w++)g(y[L[R]][w])&&(y[L[R]][w]=1*y[L[R]][w]);return y}function S(m){var c=Object.keys(m);return c.reduce(function(v,y){return v||m[y].length>0},!1)}function _(m,c){for(var v={main:[c]},y={main:[]},d={main:{}};S(v);)for(var x=Object.keys(v),b=0;b<x.length;b++){var T=x[b],A=v[T],L=A.pop();if(d[T]=d[T]||{},!(d[T][L]||!m[T][L])){d[T][L]=!0,y[T]=y[T]||[],y[T].push(L);for(var R=E(m,m[T][L],T),w=Object.keys(R),O=0;O<w.length;O++)v[w[O]]=v[w[O]]||[],v[w[O]]=v[w[O]].concat(R[w[O]])}}return y}a.exports=function(m,c){c=c||{};var v={main:l.m},y=c.all?{main:Object.keys(v.main)}:_(v,m),d="";Object.keys(y).filter(function(L){return L!=="main"}).forEach(function(L){for(var R=0;y[L][R];)R++;y[L].push(R),v[L][R]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+L+" = ("+h.toString().replace("ENTRY_MODULE",JSON.stringify(R))+")({"+y[L].map(function(w){return""+JSON.stringify(w)+": "+v[L][w].toString()}).join(",")+`});
`}),d=d+"new (("+h.toString().replace("ENTRY_MODULE",JSON.stringify(m))+")({"+y.main.map(function(L){return""+JSON.stringify(L)+": "+v.main[L].toString()}).join(",")+"}))(self);";var x=new window.Blob([d],{type:"text/javascript"});if(c.bare)return x;var b=window.URL||window.webkitURL||window.mozURL||window.msURL,T=b.createObjectURL(x),A=new window.Worker(T);return A.objectURL=T,A}},"./src/config.js":function(a,o,l){l.r(o),l.d(o,{defaultConfig:function(){return h},createDefaultConfig:function(){return p}});var h={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function p(){return Object.assign({},h)}},"./src/core/features.js":function(a,o,l){l.r(o);var h=l("./src/io/io-controller.js"),p=l("./src/config.js"),u=function(){function f(){}return f.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},f.supportNetworkStreamIO=function(){var g=new h.default({},(0,p.createDefaultConfig)()),E=g.loaderType;return g.destroy(),E=="fetch-stream-loader"||E=="xhr-moz-chunked-loader"},f.getNetworkLoaderTypeName=function(){var g=new h.default({},(0,p.createDefaultConfig)()),E=g.loaderType;return g.destroy(),E},f.supportNativeMediaPlayback=function(g){f.videoElement==null&&(f.videoElement=window.document.createElement("video"));var E=f.videoElement.canPlayType(g);return E==="probably"||E=="maybe"},f.getFeatureList=function(){var g={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return g.mseFlvPlayback=f.supportMSEH264Playback(),g.networkStreamIO=f.supportNetworkStreamIO(),g.networkLoaderName=f.getNetworkLoaderTypeName(),g.mseLiveFlvPlayback=g.mseFlvPlayback&&g.networkStreamIO,g.nativeMP4H264Playback=f.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),g.nativeWebmVP8Playback=f.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),g.nativeWebmVP9Playback=f.supportNativeMediaPlayback('video/webm; codecs="vp9"'),g},f}();o.default=u},"./src/core/media-info.js":function(a,o,l){l.r(o);var h=function(){function p(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return p.prototype.isComplete=function(){var u=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,f=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&u&&f},p.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},p.prototype.getNearestKeyframe=function(u){if(this.keyframesIndex==null)return null;var f=this.keyframesIndex,g=this._search(f.times,u);return{index:g,milliseconds:f.times[g],fileposition:f.filepositions[g]}},p.prototype._search=function(u,f){var g=0,E=u.length-1,S=0,_=0,m=E;for(f<u[0]&&(g=0,_=m+1);_<=m;)if(S=_+Math.floor((m-_)/2),S===E||f>=u[S]&&f<u[S+1]){g=S;break}else u[S]<f?_=S+1:m=S-1;return g},p}();o.default=h},"./src/core/media-segment-info.js":function(a,o,l){l.r(o),l.d(o,{SampleInfo:function(){return h},MediaSegmentInfo:function(){return p},IDRSampleList:function(){return u},MediaSegmentInfoList:function(){return f}});var h=function(){function g(E,S,_,m,c){this.dts=E,this.pts=S,this.duration=_,this.originalDts=m,this.isSyncPoint=c,this.fileposition=null}return g}(),p=function(){function g(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return g.prototype.appendSyncPoint=function(E){E.isSyncPoint=!0,this.syncPoints.push(E)},g}(),u=function(){function g(){this._list=[]}return g.prototype.clear=function(){this._list=[]},g.prototype.appendArray=function(E){var S=this._list;E.length!==0&&(S.length>0&&E[0].originalDts<S[S.length-1].originalDts&&this.clear(),Array.prototype.push.apply(S,E))},g.prototype.getLastSyncPointBeforeDts=function(E){if(this._list.length==0)return null;var S=this._list,_=0,m=S.length-1,c=0,v=0,y=m;for(E<S[0].dts&&(_=0,v=y+1);v<=y;)if(c=v+Math.floor((y-v)/2),c===m||E>=S[c].dts&&E<S[c+1].dts){_=c;break}else S[c].dts<E?v=c+1:y=c-1;return this._list[_]},g}(),f=function(){function g(E){this._type=E,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),g.prototype.isEmpty=function(){return this._list.length===0},g.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},g.prototype._searchNearestSegmentBefore=function(E){var S=this._list;if(S.length===0)return-2;var _=S.length-1,m=0,c=0,v=_,y=0;if(E<S[0].originalBeginDts)return y=-1,y;for(;c<=v;)if(m=c+Math.floor((v-c)/2),m===_||E>S[m].lastSample.originalDts&&E<S[m+1].originalBeginDts){y=m;break}else S[m].originalBeginDts<E?c=m+1:v=m-1;return y},g.prototype._searchNearestSegmentAfter=function(E){return this._searchNearestSegmentBefore(E)+1},g.prototype.append=function(E){var S=this._list,_=E,m=this._lastAppendLocation,c=0;m!==-1&&m<S.length&&_.originalBeginDts>=S[m].lastSample.originalDts&&(m===S.length-1||m<S.length-1&&_.originalBeginDts<S[m+1].originalBeginDts)?c=m+1:S.length>0&&(c=this._searchNearestSegmentBefore(_.originalBeginDts)+1),this._lastAppendLocation=c,this._list.splice(c,0,_)},g.prototype.getLastSegmentBefore=function(E){var S=this._searchNearestSegmentBefore(E);return S>=0?this._list[S]:null},g.prototype.getLastSampleBefore=function(E){var S=this.getLastSegmentBefore(E);return S!=null?S.lastSample:null},g.prototype.getLastSyncPointBefore=function(E){for(var S=this._searchNearestSegmentBefore(E),_=this._list[S].syncPoints;_.length===0&&S>0;)S--,_=this._list[S].syncPoints;return _.length>0?_[_.length-1]:null},g}()},"./src/core/mse-controller.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./src/utils/logger.js"),f=l("./src/utils/browser.js"),g=l("./src/core/mse-events.js"),E=l("./src/core/media-segment-info.js"),S=l("./src/utils/exception.js"),_=function(){function m(c){this.TAG="MSEController",this._config=c,this._emitter=new(p()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new E.IDRSampleList}return m.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},m.prototype.on=function(c,v){this._emitter.addListener(c,v)},m.prototype.off=function(c,v){this._emitter.removeListener(c,v)},m.prototype.attachMediaElement=function(c){if(this._mediaSource)throw new S.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var v=this._mediaSource=new window.MediaSource;v.addEventListener("sourceopen",this.e.onSourceOpen),v.addEventListener("sourceended",this.e.onSourceEnded),v.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=c,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),c.src=this._mediaSourceObjectURL},m.prototype.detachMediaElement=function(){if(this._mediaSource){var c=this._mediaSource;for(var v in this._sourceBuffers){var y=this._pendingSegments[v];y.splice(0,y.length),this._pendingSegments[v]=null,this._pendingRemoveRanges[v]=null,this._lastInitSegments[v]=null;var d=this._sourceBuffers[v];if(d){if(c.readyState!=="closed"){try{c.removeSourceBuffer(d)}catch(x){u.default.e(this.TAG,x.message)}d.removeEventListener("error",this.e.onSourceBufferError),d.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[v]=null,this._sourceBuffers[v]=null}}if(c.readyState==="open")try{c.endOfStream()}catch(x){u.default.e(this.TAG,x.message)}c.removeEventListener("sourceopen",this.e.onSourceOpen),c.removeEventListener("sourceended",this.e.onSourceEnded),c.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},m.prototype.appendInitSegment=function(c,v){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(c),this._pendingSegments[c.type].push(c);return}var y=c,d=""+y.container;y.codec&&y.codec.length>0&&(d+=";codecs="+y.codec);var x=!1;if(u.default.v(this.TAG,"Received Initialization Segment, mimeType: "+d),this._lastInitSegments[y.type]=y,d!==this._mimeTypes[y.type]){if(this._mimeTypes[y.type])u.default.v(this.TAG,"Notice: "+y.type+" mimeType changed, origin: "+this._mimeTypes[y.type]+", target: "+d);else{x=!0;try{var b=this._sourceBuffers[y.type]=this._mediaSource.addSourceBuffer(d);b.addEventListener("error",this.e.onSourceBufferError),b.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(T){u.default.e(this.TAG,T.message),this._emitter.emit(g.default.ERROR,{code:T.code,msg:T.message});return}}this._mimeTypes[y.type]=d}v||this._pendingSegments[y.type].push(y),x||this._sourceBuffers[y.type]&&!this._sourceBuffers[y.type].updating&&this._doAppendSegments(),f.default.safari&&y.container==="audio/mpeg"&&y.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=y.mediaDuration/1e3,this._updateMediaSourceDuration())},m.prototype.appendMediaSegment=function(c){var v=c;this._pendingSegments[v.type].push(v),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var y=this._sourceBuffers[v.type];y&&!y.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},m.prototype.seek=function(c){for(var v in this._sourceBuffers)if(!!this._sourceBuffers[v]){var y=this._sourceBuffers[v];if(this._mediaSource.readyState==="open")try{y.abort()}catch(L){u.default.e(this.TAG,L.message)}this._idrList.clear();var d=this._pendingSegments[v];if(d.splice(0,d.length),this._mediaSource.readyState!=="closed"){for(var x=0;x<y.buffered.length;x++){var b=y.buffered.start(x),T=y.buffered.end(x);this._pendingRemoveRanges[v].push({start:b,end:T})}if(y.updating||this._doRemoveRanges(),f.default.safari){var A=this._lastInitSegments[v];A&&(this._pendingSegments[v].push(A),y.updating||this._doAppendSegments())}}}},m.prototype.endOfStream=function(){var c=this._mediaSource,v=this._sourceBuffers;if(!c||c.readyState!=="open"){c&&c.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}v.video&&v.video.updating||v.audio&&v.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,c.endOfStream())},m.prototype.getNearestKeyframe=function(c){return this._idrList.getLastSyncPointBeforeDts(c)},m.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var c=this._mediaElement.currentTime;for(var v in this._sourceBuffers){var y=this._sourceBuffers[v];if(y){var d=y.buffered;if(d.length>=1&&c-d.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},m.prototype._doCleanupSourceBuffer=function(){var c=this._mediaElement.currentTime;for(var v in this._sourceBuffers){var y=this._sourceBuffers[v];if(y){for(var d=y.buffered,x=!1,b=0;b<d.length;b++){var T=d.start(b),A=d.end(b);if(T<=c&&c<A+3){if(c-T>=this._config.autoCleanupMaxBackwardDuration){x=!0;var L=c-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[v].push({start:T,end:L})}}else A<c&&(x=!0,this._pendingRemoveRanges[v].push({start:T,end:A}))}x&&!y.updating&&this._doRemoveRanges()}}},m.prototype._updateMediaSourceDuration=function(){var c=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(c.video&&c.video.updating||c.audio&&c.audio.updating)){var v=this._mediaSource.duration,y=this._pendingMediaDuration;y>0&&(isNaN(v)||y>v)&&(u.default.v(this.TAG,"Update MediaSource duration from "+v+" to "+y),this._mediaSource.duration=y),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},m.prototype._doRemoveRanges=function(){for(var c in this._pendingRemoveRanges)if(!(!this._sourceBuffers[c]||this._sourceBuffers[c].updating))for(var v=this._sourceBuffers[c],y=this._pendingRemoveRanges[c];y.length&&!v.updating;){var d=y.shift();v.remove(d.start,d.end)}},m.prototype._doAppendSegments=function(){var c=this._pendingSegments;for(var v in c)if(!(!this._sourceBuffers[v]||this._sourceBuffers[v].updating)&&c[v].length>0){var y=c[v].shift();if(y.timestampOffset){var d=this._sourceBuffers[v].timestampOffset,x=y.timestampOffset/1e3,b=Math.abs(d-x);b>.1&&(u.default.v(this.TAG,"Update MPEG audio timestampOffset from "+d+" to "+x),this._sourceBuffers[v].timestampOffset=x),delete y.timestampOffset}if(!y.data||y.data.byteLength===0)continue;try{this._sourceBuffers[v].appendBuffer(y.data),this._isBufferFull=!1,v==="video"&&y.hasOwnProperty("info")&&this._idrList.appendArray(y.info.syncPoints)}catch(T){this._pendingSegments[v].unshift(y),T.code===22?(this._isBufferFull||this._emitter.emit(g.default.BUFFER_FULL),this._isBufferFull=!0):(u.default.e(this.TAG,T.message),this._emitter.emit(g.default.ERROR,{code:T.code,msg:T.message}))}}},m.prototype._onSourceOpen=function(){if(u.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var c=this._pendingSourceBufferInit;c.length;){var v=c.shift();this.appendInitSegment(v,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(g.default.SOURCE_OPEN)},m.prototype._onSourceEnded=function(){u.default.v(this.TAG,"MediaSource onSourceEnded")},m.prototype._onSourceClose=function(){u.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},m.prototype._hasPendingSegments=function(){var c=this._pendingSegments;return c.video.length>0||c.audio.length>0},m.prototype._hasPendingRemoveRanges=function(){var c=this._pendingRemoveRanges;return c.video.length>0||c.audio.length>0},m.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(g.default.UPDATE_END)},m.prototype._onSourceBufferError=function(c){u.default.e(this.TAG,"SourceBuffer Error: "+c)},m}();o.default=_},"./src/core/mse-events.js":function(a,o,l){l.r(o);var h={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};o.default=h},"./src/core/transmuxer.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./node_modules/webworkify-webpack/index.js"),f=l.n(u),g=l("./src/utils/logger.js"),E=l("./src/utils/logging-control.js"),S=l("./src/core/transmuxing-controller.js"),_=l("./src/core/transmuxing-events.js"),m=l("./src/core/media-info.js"),c=function(){function v(y,d){if(this.TAG="Transmuxer",this._emitter=new(p()),d.enableWorker&&typeof Worker!="undefined")try{this._worker=f()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[y,d]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},E.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:E.default.getConfig()})}catch(b){g.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new S.default(y,d)}else this._controller=new S.default(y,d);if(this._controller){var x=this._controller;x.on(_.default.IO_ERROR,this._onIOError.bind(this)),x.on(_.default.DEMUX_ERROR,this._onDemuxError.bind(this)),x.on(_.default.INIT_SEGMENT,this._onInitSegment.bind(this)),x.on(_.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),x.on(_.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),x.on(_.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),x.on(_.default.MEDIA_INFO,this._onMediaInfo.bind(this)),x.on(_.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),x.on(_.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),x.on(_.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),x.on(_.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return v.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),E.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(y,d){this._emitter.addListener(y,d)},v.prototype.off=function(y,d){this._emitter.removeListener(y,d)},v.prototype.hasWorker=function(){return this._worker!=null},v.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},v.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},v.prototype.seek=function(y){this._worker?this._worker.postMessage({cmd:"seek",param:y}):this._controller.seek(y)},v.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},v.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},v.prototype._onInitSegment=function(y,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.INIT_SEGMENT,y,d)})},v.prototype._onMediaSegment=function(y,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.MEDIA_SEGMENT,y,d)})},v.prototype._onLoadingComplete=function(){var y=this;Promise.resolve().then(function(){y._emitter.emit(_.default.LOADING_COMPLETE)})},v.prototype._onRecoveredEarlyEof=function(){var y=this;Promise.resolve().then(function(){y._emitter.emit(_.default.RECOVERED_EARLY_EOF)})},v.prototype._onMediaInfo=function(y){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.MEDIA_INFO,y)})},v.prototype._onMetaDataArrived=function(y){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.METADATA_ARRIVED,y)})},v.prototype._onScriptDataArrived=function(y){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.SCRIPTDATA_ARRIVED,y)})},v.prototype._onStatisticsInfo=function(y){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.STATISTICS_INFO,y)})},v.prototype._onIOError=function(y,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.IO_ERROR,y,d)})},v.prototype._onDemuxError=function(y,d){var x=this;Promise.resolve().then(function(){x._emitter.emit(_.default.DEMUX_ERROR,y,d)})},v.prototype._onRecommendSeekpoint=function(y){var d=this;Promise.resolve().then(function(){d._emitter.emit(_.default.RECOMMEND_SEEKPOINT,y)})},v.prototype._onLoggingConfigChanged=function(y){this._worker&&this._worker.postMessage({cmd:"logging_config",param:y})},v.prototype._onWorkerMessage=function(y){var d=y.data,x=d.data;if(d.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(d.msg){case _.default.INIT_SEGMENT:case _.default.MEDIA_SEGMENT:this._emitter.emit(d.msg,x.type,x.data);break;case _.default.LOADING_COMPLETE:case _.default.RECOVERED_EARLY_EOF:this._emitter.emit(d.msg);break;case _.default.MEDIA_INFO:Object.setPrototypeOf(x,m.default.prototype),this._emitter.emit(d.msg,x);break;case _.default.METADATA_ARRIVED:case _.default.SCRIPTDATA_ARRIVED:case _.default.STATISTICS_INFO:this._emitter.emit(d.msg,x);break;case _.default.IO_ERROR:case _.default.DEMUX_ERROR:this._emitter.emit(d.msg,x.type,x.info);break;case _.default.RECOMMEND_SEEKPOINT:this._emitter.emit(d.msg,x);break;case"logcat_callback":g.default.emitter.emit("log",x.type,x.logcat);break}},v}();o.default=c},"./src/core/transmuxing-controller.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./src/utils/logger.js"),f=l("./src/utils/browser.js"),g=l("./src/core/media-info.js"),E=l("./src/demux/flv-demuxer.js"),S=l("./src/remux/mp4-remuxer.js"),_=l("./src/demux/demux-errors.js"),m=l("./src/io/io-controller.js"),c=l("./src/core/transmuxing-events.js"),v=function(){function y(d,x){this.TAG="TransmuxingController",this._emitter=new(p()),this._config=x,d.segments||(d.segments=[{duration:d.duration,filesize:d.filesize,url:d.url}]),typeof d.cors!="boolean"&&(d.cors=!0),typeof d.withCredentials!="boolean"&&(d.withCredentials=!1),this._mediaDataSource=d,this._currentSegmentIndex=0;var b=0;this._mediaDataSource.segments.forEach(function(T){T.timestampBase=b,b+=T.duration,T.cors=d.cors,T.withCredentials=d.withCredentials,x.referrerPolicy&&(T.referrerPolicy=x.referrerPolicy)}),!isNaN(b)&&this._mediaDataSource.duration!==b&&(this._mediaDataSource.duration=b),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return y.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},y.prototype.on=function(d,x){this._emitter.addListener(d,x)},y.prototype.off=function(d,x){this._emitter.removeListener(d,x)},y.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},y.prototype._loadSegment=function(d,x){this._currentSegmentIndex=d;var b=this._mediaDataSource.segments[d],T=this._ioctl=new m.default(b,this._config,d);T.onError=this._onIOException.bind(this),T.onSeeked=this._onIOSeeked.bind(this),T.onComplete=this._onIOComplete.bind(this),T.onRedirect=this._onIORedirect.bind(this),T.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),x?this._demuxer.bindDataSource(this._ioctl):T.onDataArrival=this._onInitChunkArrival.bind(this),T.open(x)},y.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},y.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},y.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},y.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},y.prototype.seek=function(d){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var x=this._searchSegmentIndexContains(d);if(x===this._currentSegmentIndex){var b=this._mediaInfo.segments[x];if(b==null)this._pendingSeekTime=d;else{var T=b.getNearestKeyframe(d);this._remuxer.seek(T.milliseconds),this._ioctl.seek(T.fileposition),this._pendingResolveSeekPoint=T.milliseconds}}else{var A=this._mediaInfo.segments[x];if(A==null)this._pendingSeekTime=d,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(x);else{var T=A.getNearestKeyframe(d);this._internalAbort(),this._remuxer.seek(d),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[x].timestampBase,this._loadSegment(x,T.fileposition),this._pendingResolveSeekPoint=T.milliseconds,this._reportSegmentMediaInfo(x)}}this._enableStatisticsReporter()}},y.prototype._searchSegmentIndexContains=function(d){for(var x=this._mediaDataSource.segments,b=x.length-1,T=0;T<x.length;T++)if(d<x[T].timestampBase){b=T-1;break}return b},y.prototype._onInitChunkArrival=function(d,x){var b=this,T=null,A=0;if(x>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,A=this._demuxer.parseChunks(d,x);else if((T=E.default.probe(d)).match){this._demuxer=new E.default(T,this._config),this._remuxer||(this._remuxer=new S.default(this._config));var L=this._mediaDataSource;L.duration!=null&&!isNaN(L.duration)&&(this._demuxer.overridedDuration=L.duration),typeof L.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=L.hasAudio),typeof L.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=L.hasVideo),this._demuxer.timestampBase=L.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),A=this._demuxer.parseChunks(d,x)}else T=null,u.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){b._internalAbort()}),this._emitter.emit(c.default.DEMUX_ERROR,_.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),A=0;return A},y.prototype._onMediaInfo=function(d){var x=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},d),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,g.default.prototype));var b=Object.assign({},d);Object.setPrototypeOf(b,g.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=b,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var T=x._pendingSeekTime;x._pendingSeekTime=null,x.seek(T)})},y.prototype._onMetaDataArrived=function(d){this._emitter.emit(c.default.METADATA_ARRIVED,d)},y.prototype._onScriptDataArrived=function(d){this._emitter.emit(c.default.SCRIPTDATA_ARRIVED,d)},y.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},y.prototype._onIOComplete=function(d){var x=d,b=x+1;b<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(b)):(this._remuxer.flushStashedSamples(),this._emitter.emit(c.default.LOADING_COMPLETE),this._disableStatisticsReporter())},y.prototype._onIORedirect=function(d){var x=this._ioctl.extraData;this._mediaDataSource.segments[x].redirectedURL=d},y.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(c.default.RECOVERED_EARLY_EOF)},y.prototype._onIOException=function(d,x){u.default.e(this.TAG,"IOException: type = "+d+", code = "+x.code+", msg = "+x.msg),this._emitter.emit(c.default.IO_ERROR,d,x),this._disableStatisticsReporter()},y.prototype._onDemuxException=function(d,x){u.default.e(this.TAG,"DemuxException: type = "+d+", info = "+x),this._emitter.emit(c.default.DEMUX_ERROR,d,x)},y.prototype._onRemuxerInitSegmentArrival=function(d,x){this._emitter.emit(c.default.INIT_SEGMENT,d,x)},y.prototype._onRemuxerMediaSegmentArrival=function(d,x){if(this._pendingSeekTime==null&&(this._emitter.emit(c.default.MEDIA_SEGMENT,d,x),this._pendingResolveSeekPoint!=null&&d==="video")){var b=x.info.syncPoints,T=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,f.default.safari&&b.length>0&&b[0].originalDts===T&&(T=b[0].pts),this._emitter.emit(c.default.RECOMMEND_SEEKPOINT,T)}},y.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},y.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},y.prototype._reportSegmentMediaInfo=function(d){var x=this._mediaInfo.segments[d],b=Object.assign({},x);b.duration=this._mediaInfo.duration,b.segmentCount=this._mediaInfo.segmentCount,delete b.segments,delete b.keyframesIndex,this._emitter.emit(c.default.MEDIA_INFO,b)},y.prototype._reportStatisticsInfo=function(){var d={};d.url=this._ioctl.currentURL,d.hasRedirect=this._ioctl.hasRedirect,d.hasRedirect&&(d.redirectedURL=this._ioctl.currentRedirectedURL),d.speed=this._ioctl.currentSpeed,d.loaderType=this._ioctl.loaderType,d.currentSegmentIndex=this._currentSegmentIndex,d.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(c.default.STATISTICS_INFO,d)},y}();o.default=v},"./src/core/transmuxing-events.js":function(a,o,l){l.r(o);var h={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};o.default=h},"./src/core/transmuxing-worker.js":function(a,o,l){l.r(o);var h=l("./src/utils/logging-control.js"),p=l("./src/utils/polyfill.js"),u=l("./src/core/transmuxing-controller.js"),f=l("./src/core/transmuxing-events.js"),g=function(E){var S=null,_=w.bind(this);p.default.install(),E.addEventListener("message",function(O){switch(O.data.cmd){case"init":S=new u.default(O.data.param[0],O.data.param[1]),S.on(f.default.IO_ERROR,A.bind(this)),S.on(f.default.DEMUX_ERROR,L.bind(this)),S.on(f.default.INIT_SEGMENT,m.bind(this)),S.on(f.default.MEDIA_SEGMENT,c.bind(this)),S.on(f.default.LOADING_COMPLETE,v.bind(this)),S.on(f.default.RECOVERED_EARLY_EOF,y.bind(this)),S.on(f.default.MEDIA_INFO,d.bind(this)),S.on(f.default.METADATA_ARRIVED,x.bind(this)),S.on(f.default.SCRIPTDATA_ARRIVED,b.bind(this)),S.on(f.default.STATISTICS_INFO,T.bind(this)),S.on(f.default.RECOMMEND_SEEKPOINT,R.bind(this));break;case"destroy":S&&(S.destroy(),S=null),E.postMessage({msg:"destroyed"});break;case"start":S.start();break;case"stop":S.stop();break;case"seek":S.seek(O.data.param);break;case"pause":S.pause();break;case"resume":S.resume();break;case"logging_config":{var I=O.data.param;h.default.applyConfig(I),I.enableCallback===!0?h.default.addLogListener(_):h.default.removeLogListener(_);break}}});function m(O,I){var D={msg:f.default.INIT_SEGMENT,data:{type:O,data:I}};E.postMessage(D,[I.data])}function c(O,I){var D={msg:f.default.MEDIA_SEGMENT,data:{type:O,data:I}};E.postMessage(D,[I.data])}function v(){var O={msg:f.default.LOADING_COMPLETE};E.postMessage(O)}function y(){var O={msg:f.default.RECOVERED_EARLY_EOF};E.postMessage(O)}function d(O){var I={msg:f.default.MEDIA_INFO,data:O};E.postMessage(I)}function x(O){var I={msg:f.default.METADATA_ARRIVED,data:O};E.postMessage(I)}function b(O){var I={msg:f.default.SCRIPTDATA_ARRIVED,data:O};E.postMessage(I)}function T(O){var I={msg:f.default.STATISTICS_INFO,data:O};E.postMessage(I)}function A(O,I){E.postMessage({msg:f.default.IO_ERROR,data:{type:O,info:I}})}function L(O,I){E.postMessage({msg:f.default.DEMUX_ERROR,data:{type:O,info:I}})}function R(O){E.postMessage({msg:f.default.RECOMMEND_SEEKPOINT,data:O})}function w(O,I){E.postMessage({msg:"logcat_callback",data:{type:O,logcat:I}})}};o.default=g},"./src/demux/amf-parser.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/utils/utf8-conv.js"),u=l("./src/utils/exception.js"),f=function(){var E=new ArrayBuffer(2);return new DataView(E).setInt16(0,256,!0),new Int16Array(E)[0]===256}(),g=function(){function E(){}return E.parseScriptData=function(S,_,m){var c={};try{var v=E.parseValue(S,_,m),y=E.parseValue(S,_+v.size,m-v.size);c[v.data]=y.data}catch(d){h.default.e("AMF",d.toString())}return c},E.parseObject=function(S,_,m){if(m<3)throw new u.IllegalStateException("Data not enough when parse ScriptDataObject");var c=E.parseString(S,_,m),v=E.parseValue(S,_+c.size,m-c.size),y=v.objectEnd;return{data:{name:c.data,value:v.data},size:c.size+v.size,objectEnd:y}},E.parseVariable=function(S,_,m){return E.parseObject(S,_,m)},E.parseString=function(S,_,m){if(m<2)throw new u.IllegalStateException("Data not enough when parse String");var c=new DataView(S,_,m),v=c.getUint16(0,!f),y;return v>0?y=(0,p.default)(new Uint8Array(S,_+2,v)):y="",{data:y,size:2+v}},E.parseLongString=function(S,_,m){if(m<4)throw new u.IllegalStateException("Data not enough when parse LongString");var c=new DataView(S,_,m),v=c.getUint32(0,!f),y;return v>0?y=(0,p.default)(new Uint8Array(S,_+4,v)):y="",{data:y,size:4+v}},E.parseDate=function(S,_,m){if(m<10)throw new u.IllegalStateException("Data size invalid when parse Date");var c=new DataView(S,_,m),v=c.getFloat64(0,!f),y=c.getInt16(8,!f);return v+=y*60*1e3,{data:new Date(v),size:8+2}},E.parseValue=function(S,_,m){if(m<1)throw new u.IllegalStateException("Data not enough when parse Value");var c=new DataView(S,_,m),v=1,y=c.getUint8(0),d,x=!1;try{switch(y){case 0:d=c.getFloat64(1,!f),v+=8;break;case 1:{var b=c.getUint8(1);d=!!b,v+=1;break}case 2:{var T=E.parseString(S,_+1,m-1);d=T.data,v+=T.size;break}case 3:{d={};var A=0;for((c.getUint32(m-4,!f)&16777215)==9&&(A=3);v<m-4;){var L=E.parseObject(S,_+v,m-v-A);if(L.objectEnd)break;d[L.data.name]=L.data.value,v+=L.size}if(v<=m-3){var R=c.getUint32(v-1,!f)&16777215;R===9&&(v+=3)}break}case 8:{d={},v+=4;var A=0;for((c.getUint32(m-4,!f)&16777215)==9&&(A=3);v<m-8;){var w=E.parseVariable(S,_+v,m-v-A);if(w.objectEnd)break;d[w.data.name]=w.data.value,v+=w.size}if(v<=m-3){var R=c.getUint32(v-1,!f)&16777215;R===9&&(v+=3)}break}case 9:d=void 0,v=1,x=!0;break;case 10:{d=[];var O=c.getUint32(1,!f);v+=4;for(var I=0;I<O;I++){var D=E.parseValue(S,_+v,m-v);d.push(D.data),v+=D.size}break}case 11:{var C=E.parseDate(S,_+1,m-1);d=C.data,v+=C.size;break}case 12:{var P=E.parseString(S,_+1,m-1);d=P.data,v+=P.size;break}default:v=m,h.default.w("AMF","Unsupported AMF value type "+y)}}catch(M){h.default.e("AMF",M.toString())}return{data:d,size:v,objectEnd:x}},E}();o.default=g},"./src/demux/demux-errors.js":function(a,o,l){l.r(o);var h={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};o.default=h},"./src/demux/exp-golomb.js":function(a,o,l){l.r(o);var h=l("./src/utils/exception.js"),p=function(){function u(f){this.TAG="ExpGolomb",this._buffer=f,this._buffer_index=0,this._total_bytes=f.byteLength,this._total_bits=f.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return u.prototype.destroy=function(){this._buffer=null},u.prototype._fillCurrentWord=function(){var f=this._total_bytes-this._buffer_index;if(f<=0)throw new h.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var g=Math.min(4,f),E=new Uint8Array(4);E.set(this._buffer.subarray(this._buffer_index,this._buffer_index+g)),this._current_word=new DataView(E.buffer).getUint32(0,!1),this._buffer_index+=g,this._current_word_bits_left=g*8},u.prototype.readBits=function(f){if(f>32)throw new h.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(f<=this._current_word_bits_left){var g=this._current_word>>>32-f;return this._current_word<<=f,this._current_word_bits_left-=f,g}var E=this._current_word_bits_left?this._current_word:0;E=E>>>32-this._current_word_bits_left;var S=f-this._current_word_bits_left;this._fillCurrentWord();var _=Math.min(S,this._current_word_bits_left),m=this._current_word>>>32-_;return this._current_word<<=_,this._current_word_bits_left-=_,E=E<<_|m,E},u.prototype.readBool=function(){return this.readBits(1)===1},u.prototype.readByte=function(){return this.readBits(8)},u.prototype._skipLeadingZero=function(){var f;for(f=0;f<this._current_word_bits_left;f++)if((this._current_word&2147483648>>>f)!=0)return this._current_word<<=f,this._current_word_bits_left-=f,f;return this._fillCurrentWord(),f+this._skipLeadingZero()},u.prototype.readUEG=function(){var f=this._skipLeadingZero();return this.readBits(f+1)-1},u.prototype.readSEG=function(){var f=this.readUEG();return f&1?f+1>>>1:-1*(f>>>1)},u}();o.default=p},"./src/demux/flv-demuxer.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/demux/amf-parser.js"),u=l("./src/demux/sps-parser.js"),f=l("./src/demux/demux-errors.js"),g=l("./src/core/media-info.js"),E=l("./src/utils/exception.js");function S(m,c){return m[c]<<24|m[c+1]<<16|m[c+2]<<8|m[c+3]}var _=function(){function m(c,v){this.TAG="FLVDemuxer",this._config=v,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=c.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=c.hasAudioTrack,this._hasVideo=c.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new g.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var y=new ArrayBuffer(2);return new DataView(y).setInt16(0,256,!0),new Int16Array(y)[0]===256}()}return m.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},m.probe=function(c){var v=new Uint8Array(c),y={match:!1};if(v[0]!==70||v[1]!==76||v[2]!==86||v[3]!==1)return y;var d=(v[4]&4)>>>2!=0,x=(v[4]&1)!=0,b=S(v,5);return b<9?y:{match:!0,consumed:b,dataOffset:b,hasAudioTrack:d,hasVideoTrack:x}},m.prototype.bindDataSource=function(c){return c.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(m.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(c){this._onTrackMetadata=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(c){this._onMediaInfo=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(c){this._onMetaDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(c){this._onScriptDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onError",{get:function(){return this._onError},set:function(c){this._onError=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(c){this._onDataAvailable=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(c){this._timestampBase=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedDuration",{get:function(){return this._duration},set:function(c){this._durationOverrided=!0,this._duration=c,this._mediaInfo.duration=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedHasAudio",{set:function(c){this._hasAudioFlagOverrided=!0,this._hasAudio=c,this._mediaInfo.hasAudio=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedHasVideo",{set:function(c){this._hasVideoFlagOverrided=!0,this._hasVideo=c,this._mediaInfo.hasVideo=c},enumerable:!1,configurable:!0}),m.prototype.resetMediaInfo=function(){this._mediaInfo=new g.default},m.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},m.prototype.parseChunks=function(c,v){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new E.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var y=0,d=this._littleEndian;if(v===0)if(c.byteLength>13){var x=m.probe(c);y=x.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,v+y!==this._dataOffset&&h.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var b=new DataView(c,y),T=b.getUint32(0,!d);T!==0&&h.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),y+=4}for(;y<c.byteLength;){this._dispatch=!0;var b=new DataView(c,y);if(y+11+4>c.byteLength)break;var A=b.getUint8(0),L=b.getUint32(0,!d)&16777215;if(y+11+L+4>c.byteLength)break;if(A!==8&&A!==9&&A!==18){h.default.w(this.TAG,"Unsupported tag type "+A+", skipped"),y+=11+L+4;continue}var R=b.getUint8(4),w=b.getUint8(5),O=b.getUint8(6),I=b.getUint8(7),D=O|w<<8|R<<16|I<<24,C=b.getUint32(7,!d)&16777215;C!==0&&h.default.w(this.TAG,"Meet tag which has StreamID != 0!");var P=y+11;switch(A){case 8:this._parseAudioData(c,P,L,D);break;case 9:this._parseVideoData(c,P,L,D,v+y);break;case 18:this._parseScriptData(c,P,L);break}var M=b.getUint32(11+L,!d);M!==11+L&&h.default.w(this.TAG,"Invalid PrevTagSize "+M),y+=11+L+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),y},m.prototype._parseScriptData=function(c,v,y){var d=p.default.parseScriptData(c,v,y);if(d.hasOwnProperty("onMetaData")){if(d.onMetaData==null||typeof d.onMetaData!="object"){h.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&h.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=d;var x=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},x)),typeof x.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=x.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof x.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=x.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof x.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=x.audiodatarate),typeof x.videodatarate=="number"&&(this._mediaInfo.videoDataRate=x.videodatarate),typeof x.width=="number"&&(this._mediaInfo.width=x.width),typeof x.height=="number"&&(this._mediaInfo.height=x.height),typeof x.duration=="number"){if(!this._durationOverrided){var b=Math.floor(x.duration*this._timescale);this._duration=b,this._mediaInfo.duration=b}}else this._mediaInfo.duration=0;if(typeof x.framerate=="number"){var T=Math.floor(x.framerate*1e3);if(T>0){var A=T/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=A,this._referenceFrameRate.fps_num=T,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=A}}if(typeof x.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var L=x.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(L),x.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=x,h.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(d).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},d))},m.prototype._parseKeyframesIndex=function(c){for(var v=[],y=[],d=1;d<c.times.length;d++){var x=this._timestampBase+Math.floor(c.times[d]*1e3);v.push(x),y.push(c.filepositions[d])}return{times:v,filepositions:y}},m.prototype._parseAudioData=function(c,v,y,d){if(y<=1){h.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var x=new DataView(c,v,y),b=x.getUint8(0),T=b>>>4;if(T!==2&&T!==10){this._onError(f.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+T);return}var A=0,L=(b&12)>>>2;if(L>=0&&L<=4)A=this._flvSoundRateTable[L];else{this._onError(f.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+L);return}var R=b&1,w=this._audioMetadata,O=this._audioTrack;if(w||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),w=this._audioMetadata={},w.type="audio",w.id=O.id,w.timescale=this._timescale,w.duration=this._duration,w.audioSampleRate=A,w.channelCount=R===0?1:2),T===10){var I=this._parseAACAudioData(c,v+1,y-1);if(I==null)return;if(I.packetType===0){w.config&&h.default.w(this.TAG,"Found another AudioSpecificConfig!");var D=I.data;w.audioSampleRate=D.samplingRate,w.channelCount=D.channelCount,w.codec=D.codec,w.originalCodec=D.originalCodec,w.config=D.config,w.refSampleDuration=1024/w.audioSampleRate*w.timescale,h.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",w);var C=this._mediaInfo;C.audioCodec=w.originalCodec,C.audioSampleRate=w.audioSampleRate,C.audioChannelCount=w.channelCount,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}else if(I.packetType===1){var P=this._timestampBase+d,M={unit:I.data,length:I.data.byteLength,dts:P,pts:P};O.samples.push(M),O.length+=I.data.length}else h.default.e(this.TAG,"Flv: Unsupported AAC data type "+I.packetType)}else if(T===2){if(!w.codec){var D=this._parseMP3AudioData(c,v+1,y-1,!0);if(D==null)return;w.audioSampleRate=D.samplingRate,w.channelCount=D.channelCount,w.codec=D.codec,w.originalCodec=D.originalCodec,w.refSampleDuration=1152/w.audioSampleRate*w.timescale,h.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",w);var C=this._mediaInfo;C.audioCodec=w.codec,C.audioSampleRate=w.audioSampleRate,C.audioChannelCount=w.channelCount,C.audioDataRate=D.bitRate,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}var N=this._parseMP3AudioData(c,v+1,y-1,!1);if(N==null)return;var P=this._timestampBase+d,B={unit:N,length:N.byteLength,dts:P,pts:P};O.samples.push(B),O.length+=N.length}}},m.prototype._parseAACAudioData=function(c,v,y){if(y<=1){h.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var d={},x=new Uint8Array(c,v,y);return d.packetType=x[0],x[0]===0?d.data=this._parseAACAudioSpecificConfig(c,v+1,y-1):d.data=x.subarray(1),d},m.prototype._parseAACAudioSpecificConfig=function(c,v,y){var d=new Uint8Array(c,v,y),x=null,b=0,T=0,A=0,L=null;if(b=T=d[0]>>>3,A=(d[0]&7)<<1|d[1]>>>7,A<0||A>=this._mpegSamplingRates.length){this._onError(f.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var R=this._mpegSamplingRates[A],w=(d[1]&120)>>>3;if(w<0||w>=8){this._onError(f.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}b===5&&(L=(d[1]&7)<<1|d[2]>>>7,(d[2]&124)>>>2);var O=self.navigator.userAgent.toLowerCase();return O.indexOf("firefox")!==-1?A>=6?(b=5,x=new Array(4),L=A-3):(b=2,x=new Array(2),L=A):O.indexOf("android")!==-1?(b=2,x=new Array(2),L=A):(b=5,L=A,x=new Array(4),A>=6?L=A-3:w===1&&(b=2,x=new Array(2),L=A)),x[0]=b<<3,x[0]|=(A&15)>>>1,x[1]=(A&15)<<7,x[1]|=(w&15)<<3,b===5&&(x[1]|=(L&15)>>>1,x[2]=(L&1)<<7,x[2]|=2<<2,x[3]=0),{config:x,samplingRate:R,channelCount:w,codec:"mp4a.40."+b,originalCodec:"mp4a.40."+T}},m.prototype._parseMP3AudioData=function(c,v,y,d){if(y<4){h.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var x=new Uint8Array(c,v,y),b=null;if(d){if(x[0]!==255)return;var T=x[1]>>>3&3,A=(x[1]&6)>>1,L=(x[2]&240)>>>4,R=(x[2]&12)>>>2,w=x[3]>>>6&3,O=w!==3?2:1,I=0,D=0,C="mp3";switch(T){case 0:I=this._mpegAudioV25SampleRateTable[R];break;case 2:I=this._mpegAudioV20SampleRateTable[R];break;case 3:I=this._mpegAudioV10SampleRateTable[R];break}switch(A){case 1:L<this._mpegAudioL3BitRateTable.length&&(D=this._mpegAudioL3BitRateTable[L]);break;case 2:L<this._mpegAudioL2BitRateTable.length&&(D=this._mpegAudioL2BitRateTable[L]);break;case 3:L<this._mpegAudioL1BitRateTable.length&&(D=this._mpegAudioL1BitRateTable[L]);break}b={bitRate:D,samplingRate:I,channelCount:O,codec:C,originalCodec:C}}else b=x;return b},m.prototype._parseVideoData=function(c,v,y,d,x){if(y<=1){h.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var b=new Uint8Array(c,v,y)[0],T=(b&240)>>>4,A=b&15;if(A!==7){this._onError(f.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+A);return}this._parseAVCVideoPacket(c,v+1,y-1,d,x,T)}},m.prototype._parseAVCVideoPacket=function(c,v,y,d,x,b){if(y<4){h.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var T=this._littleEndian,A=new DataView(c,v,y),L=A.getUint8(0),R=A.getUint32(0,!T)&16777215,w=R<<8>>8;if(L===0)this._parseAVCDecoderConfigurationRecord(c,v+4,y-4);else if(L===1)this._parseAVCVideoData(c,v+4,y-4,d,x,b,w);else if(L!==2){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid video packet type "+L);return}},m.prototype._parseAVCDecoderConfigurationRecord=function(c,v,y){if(y<7){h.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var d=this._videoMetadata,x=this._videoTrack,b=this._littleEndian,T=new DataView(c,v,y);d?typeof d.avcc!="undefined"&&h.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),d=this._videoMetadata={},d.type="video",d.id=x.id,d.timescale=this._timescale,d.duration=this._duration);var A=T.getUint8(0),L=T.getUint8(1);if(T.getUint8(2),T.getUint8(3),A!==1||L===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(T.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(f.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var R=T.getUint8(5)&31;if(R===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else R>1&&h.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+R);for(var w=6,O=0;O<R;O++){var I=T.getUint16(w,!b);if(w+=2,I!==0){var D=new Uint8Array(c,v+w,I);w+=I;var C=u.default.parseSPS(D);if(O===0){d.codecWidth=C.codec_size.width,d.codecHeight=C.codec_size.height,d.presentWidth=C.present_size.width,d.presentHeight=C.present_size.height,d.profile=C.profile_string,d.level=C.level_string,d.bitDepth=C.bit_depth,d.chromaFormat=C.chroma_format,d.sarRatio=C.sar_ratio,d.frameRate=C.frame_rate,(C.frame_rate.fixed===!1||C.frame_rate.fps_num===0||C.frame_rate.fps_den===0)&&(d.frameRate=this._referenceFrameRate);var P=d.frameRate.fps_den,M=d.frameRate.fps_num;d.refSampleDuration=d.timescale*(P/M);for(var N=D.subarray(1,4),B="avc1.",U=0;U<3;U++){var F=N[U].toString(16);F.length<2&&(F="0"+F),B+=F}d.codec=B;var j=this._mediaInfo;j.width=d.codecWidth,j.height=d.codecHeight,j.fps=d.frameRate.fps,j.profile=d.profile,j.level=d.level,j.refFrames=C.ref_frames,j.chromaFormat=C.chroma_format_string,j.sarNum=d.sarRatio.width,j.sarDen=d.sarRatio.height,j.videoCodec=B,j.hasAudio?j.audioCodec!=null&&(j.mimeType='video/x-flv; codecs="'+j.videoCodec+","+j.audioCodec+'"'):j.mimeType='video/x-flv; codecs="'+j.videoCodec+'"',j.isComplete()&&this._onMediaInfo(j)}}}var V=T.getUint8(w);if(V===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else V>1&&h.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+V);w++;for(var O=0;O<V;O++){var I=T.getUint16(w,!b);w+=2,I!==0&&(w+=I)}d.avcc=new Uint8Array(y),d.avcc.set(new Uint8Array(c,v,y),0),h.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",d)},m.prototype._parseAVCVideoData=function(c,v,y,d,x,b,T){for(var A=this._littleEndian,L=new DataView(c,v,y),R=[],w=0,O=0,I=this._naluLengthSize,D=this._timestampBase+d,C=b===1;O<y;){if(O+4>=y){h.default.w(this.TAG,"Malformed Nalu near timestamp "+D+", offset = "+O+", dataSize = "+y);break}var P=L.getUint32(O,!A);if(I===3&&(P>>>=8),P>y-I){h.default.w(this.TAG,"Malformed Nalus near timestamp "+D+", NaluSize > DataSize!");return}var M=L.getUint8(O+I)&31;M===5&&(C=!0);var N=new Uint8Array(c,v+O,I+P),B={type:M,data:N};R.push(B),w+=N.byteLength,O+=I+P}if(R.length){var U=this._videoTrack,F={units:R,length:w,isKeyframe:C,dts:D,cts:T,pts:D+T};C&&(F.fileposition=x),U.samples.push(F),U.length+=w}},m}();o.default=_},"./src/demux/sps-parser.js":function(a,o,l){l.r(o);var h=l("./src/demux/exp-golomb.js"),p=function(){function u(){}return u._ebsp2rbsp=function(f){for(var g=f,E=g.byteLength,S=new Uint8Array(E),_=0,m=0;m<E;m++)m>=2&&g[m]===3&&g[m-1]===0&&g[m-2]===0||(S[_]=g[m],_++);return new Uint8Array(S.buffer,0,_)},u.parseSPS=function(f){var g=u._ebsp2rbsp(f),E=new h.default(g);E.readByte();var S=E.readByte();E.readByte();var _=E.readByte();E.readUEG();var m=u.getProfileString(S),c=u.getLevelString(_),v=1,y=420,d=[0,420,422,444],x=8;if((S===100||S===110||S===122||S===244||S===44||S===83||S===86||S===118||S===128||S===138||S===144)&&(v=E.readUEG(),v===3&&E.readBits(1),v<=3&&(y=d[v]),x=E.readUEG()+8,E.readUEG(),E.readBits(1),E.readBool()))for(var b=v!==3?8:12,T=0;T<b;T++)E.readBool()&&(T<6?u._skipScalingList(E,16):u._skipScalingList(E,64));E.readUEG();var A=E.readUEG();if(A===0)E.readUEG();else if(A===1){E.readBits(1),E.readSEG(),E.readSEG();for(var L=E.readUEG(),T=0;T<L;T++)E.readSEG()}var R=E.readUEG();E.readBits(1);var w=E.readUEG(),O=E.readUEG(),I=E.readBits(1);I===0&&E.readBits(1),E.readBits(1);var D=0,C=0,P=0,M=0,N=E.readBool();N&&(D=E.readUEG(),C=E.readUEG(),P=E.readUEG(),M=E.readUEG());var B=1,U=1,F=0,j=!0,V=0,G=0,Y=E.readBool();if(Y){if(E.readBool()){var X=E.readByte(),ie=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],he=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];X>0&&X<16?(B=ie[X-1],U=he[X-1]):X===255&&(B=E.readByte()<<8|E.readByte(),U=E.readByte()<<8|E.readByte())}if(E.readBool()&&E.readBool(),E.readBool()&&(E.readBits(4),E.readBool()&&E.readBits(24)),E.readBool()&&(E.readUEG(),E.readUEG()),E.readBool()){var de=E.readBits(32),Ae=E.readBits(32);j=E.readBool(),V=Ae,G=de*2,F=V/G}}var pe=1;(B!==1||U!==1)&&(pe=B/U);var le=0,Ie=0;if(v===0)le=1,Ie=2-I;else{var Ce=v===3?1:2,Ue=v===1?2:1;le=Ce,Ie=Ue*(2-I)}var Me=(w+1)*16,ze=(2-I)*((O+1)*16);Me-=(D+C)*le,ze-=(P+M)*Ie;var Ge=Math.ceil(Me*pe);return E.destroy(),E=null,{profile_string:m,level_string:c,bit_depth:x,ref_frames:R,chroma_format:y,chroma_format_string:u.getChromaFormatString(y),frame_rate:{fixed:j,fps:F,fps_den:G,fps_num:V},sar_ratio:{width:B,height:U},codec_size:{width:Me,height:ze},present_size:{width:Ge,height:ze}}},u._skipScalingList=function(f,g){for(var E=8,S=8,_=0,m=0;m<g;m++)S!==0&&(_=f.readSEG(),S=(E+_+256)%256),E=S===0?E:S},u.getProfileString=function(f){switch(f){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},u.getLevelString=function(f){return(f/10).toFixed(1)},u.getChromaFormatString=function(f){switch(f){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},u}();o.default=p},"./src/flv.js":function(a,o,l){l.r(o);var h=l("./src/utils/polyfill.js"),p=l("./src/core/features.js"),u=l("./src/io/loader.js"),f=l("./src/player/flv-player.js"),g=l("./src/player/native-player.js"),E=l("./src/player/player-events.js"),S=l("./src/player/player-errors.js"),_=l("./src/utils/logging-control.js"),m=l("./src/utils/exception.js");h.default.install();function c(x,b){var T=x;if(T==null||typeof T!="object")throw new m.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!T.hasOwnProperty("type"))throw new m.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(T.type){case"flv":return new f.default(T,b);default:return new g.default(T,b)}}function v(){return p.default.supportMSEH264Playback()}function y(){return p.default.getFeatureList()}var d={};d.createPlayer=c,d.isSupported=v,d.getFeatureList=y,d.BaseLoader=u.BaseLoader,d.LoaderStatus=u.LoaderStatus,d.LoaderErrors=u.LoaderErrors,d.Events=E.default,d.ErrorTypes=S.ErrorTypes,d.ErrorDetails=S.ErrorDetails,d.FlvPlayer=f.default,d.NativePlayer=g.default,d.LoggingControl=_.default,Object.defineProperty(d,"version",{enumerable:!0,get:function(){return"1.6.2"}}),o.default=d},"./src/index.js":function(a,o,l){a.exports=l("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(a,o,l){l.r(o);var h=l("./src/utils/browser.js"),p=l("./src/io/loader.js"),u=l("./src/utils/exception.js"),f=function(){var E=function(S,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(m[v]=c[v])},E(S,_)};return function(S,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");E(S,_);function m(){this.constructor=S}S.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),g=function(E){f(S,E);function S(_,m){var c=E.call(this,"fetch-stream-loader")||this;return c.TAG="FetchStreamLoader",c._seekHandler=_,c._config=m,c._needStash=!0,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return S.isSupported=function(){try{var _=h.default.msedge&&h.default.version.minor>=15048,m=h.default.msedge?_:!0;return self.fetch&&self.ReadableStream&&m}catch(c){return!1}},S.prototype.destroy=function(){this.isWorking()&&this.abort(),E.prototype.destroy.call(this)},S.prototype.open=function(_,m){var c=this;this._dataSource=_,this._range=m;var v=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(v=_.redirectedURL);var y=this._seekHandler.getConfig(v,m),d=new self.Headers;if(typeof y.headers=="object"){var x=y.headers;for(var b in x)x.hasOwnProperty(b)&&d.append(b,x[b])}var T={method:"GET",headers:d,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var b in this._config.headers)d.append(b,this._config.headers[b]);_.cors===!1&&(T.mode="same-origin"),_.withCredentials&&(T.credentials="include"),_.referrerPolicy&&(T.referrerPolicy=_.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,T.signal=this._abortController.signal),this._status=p.LoaderStatus.kConnecting,self.fetch(y.url,T).then(function(A){if(c._requestAbort){c._status=p.LoaderStatus.kIdle,A.body.cancel();return}if(A.ok&&A.status>=200&&A.status<=299){if(A.url!==y.url&&c._onURLRedirect){var L=c._seekHandler.removeURLParameters(A.url);c._onURLRedirect(L)}var R=A.headers.get("Content-Length");return R!=null&&(c._contentLength=parseInt(R),c._contentLength!==0&&c._onContentLengthKnown&&c._onContentLengthKnown(c._contentLength)),c._pump.call(c,A.body.getReader())}else if(c._status=p.LoaderStatus.kError,c._onError)c._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:A.status,msg:A.statusText});else throw new u.RuntimeException("FetchStreamLoader: Http code invalid, "+A.status+" "+A.statusText)}).catch(function(A){if(!(c._abortController&&c._abortController.signal.aborted))if(c._status=p.LoaderStatus.kError,c._onError)c._onError(p.LoaderErrors.EXCEPTION,{code:-1,msg:A.message});else throw A})},S.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==p.LoaderStatus.kBuffering||!h.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(_){}},S.prototype._pump=function(_){var m=this;return _.read().then(function(c){if(c.done)if(m._contentLength!==null&&m._receivedLength<m._contentLength){m._status=p.LoaderStatus.kError;var v=p.LoaderErrors.EARLY_EOF,y={code:-1,msg:"Fetch stream meet Early-EOF"};if(m._onError)m._onError(v,y);else throw new u.RuntimeException(y.msg)}else m._status=p.LoaderStatus.kComplete,m._onComplete&&m._onComplete(m._range.from,m._range.from+m._receivedLength-1);else{if(m._abortController&&m._abortController.signal.aborted){m._status=p.LoaderStatus.kComplete;return}else if(m._requestAbort===!0)return m._status=p.LoaderStatus.kComplete,_.cancel();m._status=p.LoaderStatus.kBuffering;var d=c.value.buffer,x=m._range.from+m._receivedLength;m._receivedLength+=d.byteLength,m._onDataArrival&&m._onDataArrival(d,x,m._receivedLength),m._pump(_)}}).catch(function(c){if(m._abortController&&m._abortController.signal.aborted){m._status=p.LoaderStatus.kComplete;return}if(!(c.code===11&&h.default.msedge)){m._status=p.LoaderStatus.kError;var v=0,y=null;if((c.code===19||c.message==="network error")&&(m._contentLength===null||m._contentLength!==null&&m._receivedLength<m._contentLength)?(v=p.LoaderErrors.EARLY_EOF,y={code:c.code,msg:"Fetch stream meet Early-EOF"}):(v=p.LoaderErrors.EXCEPTION,y={code:c.code,msg:c.message}),m._onError)m._onError(v,y);else throw new u.RuntimeException(y.msg)}})},S}(p.BaseLoader);o.default=g},"./src/io/io-controller.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/io/speed-sampler.js"),u=l("./src/io/loader.js"),f=l("./src/io/fetch-stream-loader.js"),g=l("./src/io/xhr-moz-chunked-loader.js"),E=l("./src/io/xhr-range-loader.js"),S=l("./src/io/websocket-loader.js"),_=l("./src/io/range-seek-handler.js"),m=l("./src/io/param-seek-handler.js"),c=l("./src/utils/exception.js"),v=function(){function y(d,x,b){this.TAG="IOController",this._config=x,this._extraData=b,this._stashInitialSize=1024*384,x.stashInitialSize!=null&&x.stashInitialSize>0&&(this._stashInitialSize=x.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,x.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=d,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(d.url),this._refTotalLength=d.filesize?d.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return y.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},y.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},y.prototype.isPaused=function(){return this._paused},Object.defineProperty(y.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"extraData",{get:function(){return this._extraData},set:function(d){this._extraData=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(d){this._onDataArrival=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(d){this._onSeeked=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onError",{get:function(){return this._onError},set:function(d){this._onError=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onComplete",{get:function(){return this._onComplete},set:function(d){this._onComplete=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(d){this._onRedirect=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(d){this._onRecoveredEarlyEof=d},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentSpeed",{get:function(){return this._loaderClass===E.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),y.prototype._selectSeekHandler=function(){var d=this._config;if(d.seekType==="range")this._seekHandler=new _.default(this._config.rangeLoadZeroStart);else if(d.seekType==="param"){var x=d.seekParamStart||"bstart",b=d.seekParamEnd||"bend";this._seekHandler=new m.default(x,b)}else if(d.seekType==="custom"){if(typeof d.customSeekHandler!="function")throw new c.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new d.customSeekHandler}else throw new c.InvalidArgumentException("Invalid seekType in config: "+d.seekType)},y.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=S.default;else if(f.default.isSupported())this._loaderClass=f.default;else if(g.default.isSupported())this._loaderClass=g.default;else if(E.default.isSupported())this._loaderClass=E.default;else throw new c.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},y.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},y.prototype.open=function(d){this._currentRange={from:0,to:-1},d&&(this._currentRange.from=d),this._speedSampler.reset(),d||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},y.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},y.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},y.prototype.resume=function(){if(this._paused){this._paused=!1;var d=this._resumeFrom;this._resumeFrom=0,this._internalSeek(d,!0)}},y.prototype.seek=function(d){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(d,!0)},y.prototype._internalSeek=function(d,x){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(x),this._loader.destroy(),this._loader=null;var b={from:d,to:-1};this._currentRange={from:b.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,b),this._onSeeked&&this._onSeeked()},y.prototype.updateUrl=function(d){if(!d||typeof d!="string"||d.length===0)throw new c.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=d},y.prototype._expandBuffer=function(d){for(var x=this._stashSize;x+1024*1024*1<d;)x*=2;if(x+=1024*1024*1,x!==this._bufferSize){var b=new ArrayBuffer(x);if(this._stashUsed>0){var T=new Uint8Array(this._stashBuffer,0,this._stashUsed),A=new Uint8Array(b,0,x);A.set(T,0)}this._stashBuffer=b,this._bufferSize=x}},y.prototype._normalizeSpeed=function(d){var x=this._speedNormalizeList,b=x.length-1,T=0,A=0,L=b;if(d<x[0])return x[0];for(;A<=L;){if(T=A+Math.floor((L-A)/2),T===b||d>=x[T]&&d<x[T+1])return x[T];x[T]<d?A=T+1:L=T-1}},y.prototype._adjustStashSize=function(d){var x=0;this._config.isLive||d<512?x=d:d>=512&&d<=1024?x=Math.floor(d*1.5):x=d*2,x>8192&&(x=8192);var b=x*1024+1024*1024*1;this._bufferSize<b&&this._expandBuffer(b),this._stashSize=x*1024},y.prototype._dispatchChunks=function(d,x){return this._currentRange.to=x+d.byteLength-1,this._onDataArrival(d,x)},y.prototype._onURLRedirect=function(d){this._redirectedURL=d,this._onRedirect&&this._onRedirect(d)},y.prototype._onContentLengthKnown=function(d){d&&this._fullRequestFlag&&(this._totalLength=d,this._fullRequestFlag=!1)},y.prototype._onLoaderChunkArrival=function(d,x,b){if(!this._onDataArrival)throw new c.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(d.byteLength);var T=this._speedSampler.lastSecondKBps;if(T!==0){var A=this._normalizeSpeed(T);this._speedNormalized!==A&&(this._speedNormalized=A,this._adjustStashSize(A))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=x),this._stashUsed+d.byteLength<=this._stashSize){var w=new Uint8Array(this._stashBuffer,0,this._stashSize);w.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength}else{var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var I=this._stashBuffer.slice(0,this._stashUsed),L=this._dispatchChunks(I,this._stashByteStart);if(L<I.byteLength){if(L>0){var O=new Uint8Array(I,L);w.set(O,0),this._stashUsed=O.byteLength,this._stashByteStart+=L}}else this._stashUsed=0,this._stashByteStart+=L;this._stashUsed+d.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+d.byteLength),w=new Uint8Array(this._stashBuffer,0,this._bufferSize)),w.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength}else{var L=this._dispatchChunks(d,x);if(L<d.byteLength){var R=d.byteLength-L;R>this._bufferSize&&(this._expandBuffer(R),w=new Uint8Array(this._stashBuffer,0,this._bufferSize)),w.set(new Uint8Array(d,L),0),this._stashUsed+=R,this._stashByteStart=x+L}}}else if(this._stashUsed===0){var L=this._dispatchChunks(d,x);if(L<d.byteLength){var R=d.byteLength-L;R>this._bufferSize&&this._expandBuffer(R);var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);w.set(new Uint8Array(d,L),0),this._stashUsed+=R,this._stashByteStart=x+L}}else{this._stashUsed+d.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+d.byteLength);var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);w.set(new Uint8Array(d),this._stashUsed),this._stashUsed+=d.byteLength;var L=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(L<this._stashUsed&&L>0){var O=new Uint8Array(this._stashBuffer,L);w.set(O,0)}this._stashUsed-=L,this._stashByteStart+=L}}},y.prototype._flushStashBuffer=function(d){if(this._stashUsed>0){var x=this._stashBuffer.slice(0,this._stashUsed),b=this._dispatchChunks(x,this._stashByteStart),T=x.byteLength-b;if(b<x.byteLength)if(d)h.default.w(this.TAG,T+" bytes unconsumed data remain when flush buffer, dropped");else{if(b>0){var A=new Uint8Array(this._stashBuffer,0,this._bufferSize),L=new Uint8Array(x,b);A.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=b}return 0}return this._stashUsed=0,this._stashByteStart=0,T}return 0},y.prototype._onLoaderComplete=function(d,x){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},y.prototype._onLoaderError=function(d,x){switch(h.default.e(this.TAG,"Loader error, code = "+x.code+", msg = "+x.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,d=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF),d){case u.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var b=this._currentRange.to+1;b<this._totalLength&&(h.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(b,!1));return}d=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case u.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case u.LoaderErrors.CONNECTING_TIMEOUT:case u.LoaderErrors.HTTP_STATUS_CODE_INVALID:case u.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(d,x);else throw new c.RuntimeException("IOException: "+x.msg)},y}();o.default=v},"./src/io/loader.js":function(a,o,l){l.r(o),l.d(o,{LoaderStatus:function(){return p},LoaderErrors:function(){return u},BaseLoader:function(){return f}});var h=l("./src/utils/exception.js"),p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},u={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},f=function(){function g(E){this._type=E||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return g.prototype.destroy=function(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},g.prototype.isWorking=function(){return this._status===p.kConnecting||this._status===p.kBuffering},Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(E){this._onContentLengthKnown=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(E){this._onURLRedirect=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(E){this._onDataArrival=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(E){this._onError=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onComplete",{get:function(){return this._onComplete},set:function(E){this._onComplete=E},enumerable:!1,configurable:!0}),g.prototype.open=function(E,S){throw new h.NotImplementedException("Unimplemented abstract function!")},g.prototype.abort=function(){throw new h.NotImplementedException("Unimplemented abstract function!")},g}()},"./src/io/param-seek-handler.js":function(a,o,l){l.r(o);var h=function(){function p(u,f){this._startName=u,this._endName=f}return p.prototype.getConfig=function(u,f){var g=u;if(f.from!==0||f.to!==-1){var E=!0;g.indexOf("?")===-1&&(g+="?",E=!1),E&&(g+="&"),g+=this._startName+"="+f.from.toString(),f.to!==-1&&(g+="&"+this._endName+"="+f.to.toString())}return{url:g,headers:{}}},p.prototype.removeURLParameters=function(u){var f=u.split("?")[0],g=void 0,E=u.indexOf("?");E!==-1&&(g=u.substring(E+1));var S="";if(g!=null&&g.length>0)for(var _=g.split("&"),m=0;m<_.length;m++){var c=_[m].split("="),v=m>0;c[0]!==this._startName&&c[0]!==this._endName&&(v&&(S+="&"),S+=_[m])}return S.length===0?f:f+"?"+S},p}();o.default=h},"./src/io/range-seek-handler.js":function(a,o,l){l.r(o);var h=function(){function p(u){this._zeroStart=u||!1}return p.prototype.getConfig=function(u,f){var g={};if(f.from!==0||f.to!==-1){var E=void 0;f.to!==-1?E="bytes="+f.from.toString()+"-"+f.to.toString():E="bytes="+f.from.toString()+"-",g.Range=E}else this._zeroStart&&(g.Range="bytes=0-");return{url:u,headers:g}},p.prototype.removeURLParameters=function(u){return u},p}();o.default=h},"./src/io/speed-sampler.js":function(a,o,l){l.r(o);var h=function(){function p(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return p.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},p.prototype.addBytes=function(u){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=u,this._totalBytes+=u):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=u,this._totalBytes+=u):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=u,this._totalBytes+=u,this._lastCheckpoint=this._now())},Object.defineProperty(p.prototype,"currentKBps",{get:function(){this.addBytes(0);var u=(this._now()-this._lastCheckpoint)/1e3;return u==0&&(u=1),this._intervalBytes/u/1024},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"averageKBps",{get:function(){var u=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/u/1024},enumerable:!1,configurable:!0}),p}();o.default=h},"./src/io/websocket-loader.js":function(a,o,l){l.r(o);var h=l("./src/io/loader.js"),p=l("./src/utils/exception.js"),u=function(){var g=function(E,S){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var c in m)Object.prototype.hasOwnProperty.call(m,c)&&(_[c]=m[c])},g(E,S)};return function(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");g(E,S);function _(){this.constructor=E}E.prototype=S===null?Object.create(S):(_.prototype=S.prototype,new _)}}(),f=function(g){u(E,g);function E(){var S=g.call(this,"websocket-loader")||this;return S.TAG="WebSocketLoader",S._needStash=!0,S._ws=null,S._requestAbort=!1,S._receivedLength=0,S}return E.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(S){return!1}},E.prototype.destroy=function(){this._ws&&this.abort(),g.prototype.destroy.call(this)},E.prototype.open=function(S){try{var _=this._ws=new self.WebSocket(S.url);_.binaryType="arraybuffer",_.onopen=this._onWebSocketOpen.bind(this),_.onclose=this._onWebSocketClose.bind(this),_.onmessage=this._onWebSocketMessage.bind(this),_.onerror=this._onWebSocketError.bind(this),this._status=h.LoaderStatus.kConnecting}catch(c){this._status=h.LoaderStatus.kError;var m={code:c.code,msg:c.message};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,m);else throw new p.RuntimeException(m.msg)}},E.prototype.abort=function(){var S=this._ws;S&&(S.readyState===0||S.readyState===1)&&(this._requestAbort=!0,S.close()),this._ws=null,this._status=h.LoaderStatus.kComplete},E.prototype._onWebSocketOpen=function(S){this._status=h.LoaderStatus.kBuffering},E.prototype._onWebSocketClose=function(S){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=h.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},E.prototype._onWebSocketMessage=function(S){var _=this;if(S.data instanceof ArrayBuffer)this._dispatchArrayBuffer(S.data);else if(S.data instanceof Blob){var m=new FileReader;m.onload=function(){_._dispatchArrayBuffer(m.result)},m.readAsArrayBuffer(S.data)}else{this._status=h.LoaderStatus.kError;var c={code:-1,msg:"Unsupported WebSocket message type: "+S.data.constructor.name};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,c);else throw new p.RuntimeException(c.msg)}},E.prototype._dispatchArrayBuffer=function(S){var _=S,m=this._receivedLength;this._receivedLength+=_.byteLength,this._onDataArrival&&this._onDataArrival(_,m,this._receivedLength)},E.prototype._onWebSocketError=function(S){this._status=h.LoaderStatus.kError;var _={code:S.code,msg:S.message};if(this._onError)this._onError(h.LoaderErrors.EXCEPTION,_);else throw new p.RuntimeException(_.msg)},E}(h.BaseLoader);o.default=f},"./src/io/xhr-moz-chunked-loader.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/io/loader.js"),u=l("./src/utils/exception.js"),f=function(){var E=function(S,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(m[v]=c[v])},E(S,_)};return function(S,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");E(S,_);function m(){this.constructor=S}S.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),g=function(E){f(S,E);function S(_,m){var c=E.call(this,"xhr-moz-chunked-loader")||this;return c.TAG="MozChunkedLoader",c._seekHandler=_,c._config=m,c._needStash=!0,c._xhr=null,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return S.isSupported=function(){try{var _=new XMLHttpRequest;return _.open("GET","https://example.com",!0),_.responseType="moz-chunked-arraybuffer",_.responseType==="moz-chunked-arraybuffer"}catch(m){return h.default.w("MozChunkedLoader",m.message),!1}},S.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),E.prototype.destroy.call(this)},S.prototype.open=function(_,m){this._dataSource=_,this._range=m;var c=_.url;this._config.reuseRedirectedURL&&_.redirectedURL!=null&&(c=_.redirectedURL);var v=this._seekHandler.getConfig(c,m);this._requestURL=v.url;var y=this._xhr=new XMLHttpRequest;if(y.open("GET",v.url,!0),y.responseType="moz-chunked-arraybuffer",y.onreadystatechange=this._onReadyStateChange.bind(this),y.onprogress=this._onProgress.bind(this),y.onloadend=this._onLoadEnd.bind(this),y.onerror=this._onXhrError.bind(this),_.withCredentials&&(y.withCredentials=!0),typeof v.headers=="object"){var d=v.headers;for(var x in d)d.hasOwnProperty(x)&&y.setRequestHeader(x,d[x])}if(typeof this._config.headers=="object"){var d=this._config.headers;for(var x in d)d.hasOwnProperty(x)&&y.setRequestHeader(x,d[x])}this._status=p.LoaderStatus.kConnecting,y.send()},S.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.LoaderStatus.kComplete},S.prototype._onReadyStateChange=function(_){var m=_.target;if(m.readyState===2){if(m.responseURL!=null&&m.responseURL!==this._requestURL&&this._onURLRedirect){var c=this._seekHandler.removeURLParameters(m.responseURL);this._onURLRedirect(c)}if(m.status!==0&&(m.status<200||m.status>299))if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:m.status,msg:m.statusText});else throw new u.RuntimeException("MozChunkedLoader: Http code invalid, "+m.status+" "+m.statusText);else this._status=p.LoaderStatus.kBuffering}},S.prototype._onProgress=function(_){if(this._status!==p.LoaderStatus.kError){this._contentLength===null&&_.total!==null&&_.total!==0&&(this._contentLength=_.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var m=_.target.response,c=this._range.from+this._receivedLength;this._receivedLength+=m.byteLength,this._onDataArrival&&this._onDataArrival(m,c,this._receivedLength)}},S.prototype._onLoadEnd=function(_){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===p.LoaderStatus.kError)return;this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},S.prototype._onXhrError=function(_){this._status=p.LoaderStatus.kError;var m=0,c=null;if(this._contentLength&&_.loaded<this._contentLength?(m=p.LoaderErrors.EARLY_EOF,c={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(m=p.LoaderErrors.EXCEPTION,c={code:-1,msg:_.constructor.name+" "+_.type}),this._onError)this._onError(m,c);else throw new u.RuntimeException(c.msg)},S}(p.BaseLoader);o.default=g},"./src/io/xhr-range-loader.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/io/speed-sampler.js"),u=l("./src/io/loader.js"),f=l("./src/utils/exception.js"),g=function(){var S=function(_,m){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,v){c.__proto__=v}||function(c,v){for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(c[y]=v[y])},S(_,m)};return function(_,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");S(_,m);function c(){this.constructor=_}_.prototype=m===null?Object.create(m):(c.prototype=m.prototype,new c)}}(),E=function(S){g(_,S);function _(m,c){var v=S.call(this,"xhr-range-loader")||this;return v.TAG="RangeLoader",v._seekHandler=m,v._config=c,v._needStash=!1,v._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],v._currentChunkSizeKB=384,v._currentSpeedNormalized=0,v._zeroSpeedChunkCount=0,v._xhr=null,v._speedSampler=new p.default,v._requestAbort=!1,v._waitForTotalLength=!1,v._totalLengthReceived=!1,v._currentRequestURL=null,v._currentRedirectedURL=null,v._currentRequestRange=null,v._totalLength=null,v._contentLength=null,v._receivedLength=0,v._lastTimeLoaded=0,v}return _.isSupported=function(){try{var m=new XMLHttpRequest;return m.open("GET","https://example.com",!0),m.responseType="arraybuffer",m.responseType==="arraybuffer"}catch(c){return h.default.w("RangeLoader",c.message),!1}},_.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),S.prototype.destroy.call(this)},Object.defineProperty(_.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),_.prototype.open=function(m,c){this._dataSource=m,this._range=c,this._status=u.LoaderStatus.kConnecting;var v=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(v=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!v?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},_.prototype._openSubRange=function(){var m=this._currentChunkSizeKB*1024,c=this._range.from+this._receivedLength,v=c+m;this._contentLength!=null&&v-this._range.from>=this._contentLength&&(v=this._range.from+this._contentLength-1),this._currentRequestRange={from:c,to:v},this._internalOpen(this._dataSource,this._currentRequestRange)},_.prototype._internalOpen=function(m,c){this._lastTimeLoaded=0;var v=m.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?v=this._currentRedirectedURL:m.redirectedURL!=null&&(v=m.redirectedURL));var y=this._seekHandler.getConfig(v,c);this._currentRequestURL=y.url;var d=this._xhr=new XMLHttpRequest;if(d.open("GET",y.url,!0),d.responseType="arraybuffer",d.onreadystatechange=this._onReadyStateChange.bind(this),d.onprogress=this._onProgress.bind(this),d.onload=this._onLoad.bind(this),d.onerror=this._onXhrError.bind(this),m.withCredentials&&(d.withCredentials=!0),typeof y.headers=="object"){var x=y.headers;for(var b in x)x.hasOwnProperty(b)&&d.setRequestHeader(b,x[b])}if(typeof this._config.headers=="object"){var x=this._config.headers;for(var b in x)x.hasOwnProperty(b)&&d.setRequestHeader(b,x[b])}d.send()},_.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=u.LoaderStatus.kComplete},_.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},_.prototype._onReadyStateChange=function(m){var c=m.target;if(c.readyState===2){if(c.responseURL!=null){var v=this._seekHandler.removeURLParameters(c.responseURL);c.responseURL!==this._currentRequestURL&&v!==this._currentRedirectedURL&&(this._currentRedirectedURL=v,this._onURLRedirect&&this._onURLRedirect(v))}if(c.status>=200&&c.status<=299){if(this._waitForTotalLength)return;this._status=u.LoaderStatus.kBuffering}else if(this._status=u.LoaderStatus.kError,this._onError)this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText});else throw new f.RuntimeException("RangeLoader: Http code invalid, "+c.status+" "+c.statusText)}},_.prototype._onProgress=function(m){if(this._status!==u.LoaderStatus.kError){if(this._contentLength===null){var c=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,c=!0;var v=m.total;this._internalAbort(),v!=null&v!==0&&(this._totalLength=v)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,c){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var y=m.loaded-this._lastTimeLoaded;this._lastTimeLoaded=m.loaded,this._speedSampler.addBytes(y)}},_.prototype._normalizeSpeed=function(m){var c=this._chunkSizeKBList,v=c.length-1,y=0,d=0,x=v;if(m<c[0])return c[0];for(;d<=x;){if(y=d+Math.floor((x-d)/2),y===v||m>=c[y]&&m<c[y+1])return c[y];c[y]<m?d=y+1:x=y-1}},_.prototype._onLoad=function(m){if(this._status!==u.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var c=this._speedSampler.lastSecondKBps;if(c===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(c=this._speedSampler.currentKBps)),c!==0){var v=this._normalizeSpeed(c);this._currentSpeedNormalized!==v&&(this._currentSpeedNormalized=v,this._currentChunkSizeKB=v)}var y=m.target.response,d=this._range.from+this._receivedLength;this._receivedLength+=y.byteLength;var x=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():x=!0,this._onDataArrival&&this._onDataArrival(y,d,this._receivedLength),x&&(this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},_.prototype._onXhrError=function(m){this._status=u.LoaderStatus.kError;var c=0,v=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(c=u.LoaderErrors.EARLY_EOF,v={code:-1,msg:"RangeLoader meet Early-Eof"}):(c=u.LoaderErrors.EXCEPTION,v={code:-1,msg:m.constructor.name+" "+m.type}),this._onError)this._onError(c,v);else throw new f.RuntimeException(v.msg)},_}(u.BaseLoader);o.default=E},"./src/player/flv-player.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./src/utils/logger.js"),f=l("./src/utils/browser.js"),g=l("./src/player/player-events.js"),E=l("./src/core/transmuxer.js"),S=l("./src/core/transmuxing-events.js"),_=l("./src/core/mse-controller.js"),m=l("./src/core/mse-events.js"),c=l("./src/player/player-errors.js"),v=l("./src/config.js"),y=l("./src/utils/exception.js"),d=function(){function x(b,T){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(p()),this._config=(0,v.createDefaultConfig)(),typeof T=="object"&&Object.assign(this._config,T),b.type.toLowerCase()!=="flv")throw new y.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");b.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=b,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var A=f.default.chrome&&(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661);this._alwaysSeekKeyframe=!!(A||f.default.msedge||f.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return x.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},x.prototype.on=function(b,T){var A=this;b===g.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){A._emitter.emit(g.default.MEDIA_INFO,A.mediaInfo)}):b===g.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){A._emitter.emit(g.default.STATISTICS_INFO,A.statisticsInfo)}),this._emitter.addListener(b,T)},x.prototype.off=function(b,T){this._emitter.removeListener(b,T)},x.prototype.attachMediaElement=function(b){var T=this;if(this._mediaElement=b,b.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),b.addEventListener("seeking",this.e.onvSeeking),b.addEventListener("canplay",this.e.onvCanPlay),b.addEventListener("stalled",this.e.onvStalled),b.addEventListener("progress",this.e.onvProgress),this._msectl=new _.default(this._config),this._msectl.on(m.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(m.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(m.default.SOURCE_OPEN,function(){T._mseSourceOpened=!0,T._hasPendingLoad&&(T._hasPendingLoad=!1,T.load())}),this._msectl.on(m.default.ERROR,function(A){T._emitter.emit(g.default.ERROR,c.ErrorTypes.MEDIA_ERROR,c.ErrorDetails.MEDIA_MSE_ERROR,A)}),this._msectl.attachMediaElement(b),this._pendingSeekTime!=null)try{b.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(A){}},x.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},x.prototype.load=function(){var b=this;if(!this._mediaElement)throw new y.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new y.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new E.default(this._mediaDataSource,this._config),this._transmuxer.on(S.default.INIT_SEGMENT,function(T,A){b._msectl.appendInitSegment(A)}),this._transmuxer.on(S.default.MEDIA_SEGMENT,function(T,A){if(b._msectl.appendMediaSegment(A),b._config.lazyLoad&&!b._config.isLive){var L=b._mediaElement.currentTime;A.info.endDts>=(L+b._config.lazyLoadMaxDuration)*1e3&&b._progressChecker==null&&(u.default.v(b.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),b._suspendTransmuxer())}}),this._transmuxer.on(S.default.LOADING_COMPLETE,function(){b._msectl.endOfStream(),b._emitter.emit(g.default.LOADING_COMPLETE)}),this._transmuxer.on(S.default.RECOVERED_EARLY_EOF,function(){b._emitter.emit(g.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(S.default.IO_ERROR,function(T,A){b._emitter.emit(g.default.ERROR,c.ErrorTypes.NETWORK_ERROR,T,A)}),this._transmuxer.on(S.default.DEMUX_ERROR,function(T,A){b._emitter.emit(g.default.ERROR,c.ErrorTypes.MEDIA_ERROR,T,{code:-1,msg:A})}),this._transmuxer.on(S.default.MEDIA_INFO,function(T){b._mediaInfo=T,b._emitter.emit(g.default.MEDIA_INFO,Object.assign({},T))}),this._transmuxer.on(S.default.METADATA_ARRIVED,function(T){b._emitter.emit(g.default.METADATA_ARRIVED,T)}),this._transmuxer.on(S.default.SCRIPTDATA_ARRIVED,function(T){b._emitter.emit(g.default.SCRIPTDATA_ARRIVED,T)}),this._transmuxer.on(S.default.STATISTICS_INFO,function(T){b._statisticsInfo=b._fillStatisticsInfo(T),b._emitter.emit(g.default.STATISTICS_INFO,Object.assign({},b._statisticsInfo))}),this._transmuxer.on(S.default.RECOMMEND_SEEKPOINT,function(T){b._mediaElement&&!b._config.accurateSeek&&(b._requestSetTime=!0,b._mediaElement.currentTime=T/1e3)}),this._transmuxer.open()}},x.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},x.prototype.play=function(){return this._mediaElement.play()},x.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(x.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(b){this._mediaElement.volume=b},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(b){this._mediaElement.muted=b},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(b){this._mediaElement?this._internalSeek(b):this._pendingSeekTime=b},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),x.prototype._fillStatisticsInfo=function(b){if(b.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return b;var T=!0,A=0,L=0;if(this._mediaElement.getVideoPlaybackQuality){var R=this._mediaElement.getVideoPlaybackQuality();A=R.totalVideoFrames,L=R.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(A=this._mediaElement.webkitDecodedFrameCount,L=this._mediaElement.webkitDroppedFrameCount):T=!1;return T&&(b.decodedFrames=A,b.droppedFrames=L),b},x.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var b=this._mediaElement.buffered,T=this._mediaElement.currentTime,A=0,L=0;L<b.length;L++){var R=b.start(L),w=b.end(L);if(R<=T&&T<w){A=w;break}}A>=T+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(u.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},x.prototype._onmseBufferFull=function(){u.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},x.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},x.prototype._checkProgressAndResume=function(){for(var b=this._mediaElement.currentTime,T=this._mediaElement.buffered,A=!1,L=0;L<T.length;L++){var R=T.start(L),w=T.end(L);if(b>=R&&b<w){b>=w-this._config.lazyLoadRecoverDuration&&(A=!0);break}}A&&(window.clearInterval(this._progressChecker),this._progressChecker=null,A&&(u.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},x.prototype._isTimepointBuffered=function(b){for(var T=this._mediaElement.buffered,A=0;A<T.length;A++){var L=T.start(A),R=T.end(A);if(b>=L&&b<R)return!0}return!1},x.prototype._internalSeek=function(b){var T=this._isTimepointBuffered(b),A=!1,L=0;if(b<1&&this._mediaElement.buffered.length>0){var R=this._mediaElement.buffered.start(0);(R<1&&b<R||f.default.safari)&&(A=!0,L=f.default.safari?.1:R)}if(A)this._requestSetTime=!0,this._mediaElement.currentTime=L;else if(T){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=b;else{var w=this._msectl.getNearestKeyframe(Math.floor(b*1e3));this._requestSetTime=!0,w!=null?this._mediaElement.currentTime=w.dts/1e3:this._mediaElement.currentTime=b}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(b),this._transmuxer.seek(Math.floor(b*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=b)},x.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var b=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(b)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(b),this._transmuxer.seek(Math.floor(b*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=b))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},x.prototype._checkAndResumeStuckPlayback=function(b){var T=this._mediaElement;if(b||!this._receivedCanPlay||T.readyState<2){var A=T.buffered;A.length>0&&T.currentTime<A.start(0)&&(u.default.w(this.TAG,"Playback seems stuck at "+T.currentTime+", seek to "+A.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=A.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},x.prototype._onvLoadedMetadata=function(b){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},x.prototype._onvSeeking=function(b){var T=this._mediaElement.currentTime,A=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(T<1&&A.length>0){var L=A.start(0);if(L<1&&T<L||f.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=f.default.safari?.1:L;return}}if(this._isTimepointBuffered(T)){if(this._alwaysSeekKeyframe){var R=this._msectl.getNearestKeyframe(Math.floor(T*1e3));R!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=R.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:T,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},x.prototype._onvCanPlay=function(b){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},x.prototype._onvStalled=function(b){this._checkAndResumeStuckPlayback(!0)},x.prototype._onvProgress=function(b){this._checkAndResumeStuckPlayback()},x}();o.default=d},"./src/player/native-player.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./src/player/player-events.js"),f=l("./src/config.js"),g=l("./src/utils/exception.js"),E=function(){function S(_,m){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(p()),this._config=(0,f.createDefaultConfig)(),typeof m=="object"&&Object.assign(this._config,m),_.type.toLowerCase()==="flv")throw new g.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(_.hasOwnProperty("segments"))throw new g.InvalidArgumentException("NativePlayer("+_.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=_,this._mediaElement=null}return S.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},S.prototype.on=function(_,m){var c=this;_===u.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(u.default.MEDIA_INFO,c.mediaInfo)}):_===u.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(u.default.STATISTICS_INFO,c.statisticsInfo)}),this._emitter.addListener(_,m)},S.prototype.off=function(_,m){this._emitter.removeListener(_,m)},S.prototype.attachMediaElement=function(_){if(this._mediaElement=_,_.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{_.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(m){}},S.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},S.prototype.load=function(){if(!this._mediaElement)throw new g.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},S.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},S.prototype.play=function(){return this._mediaElement.play()},S.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(S.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(_){this._mediaElement.volume=_},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(_){this._mediaElement.muted=_},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(_){this._mediaElement?this._mediaElement.currentTime=_:this._pendingSeekTime=_},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"mediaInfo",{get:function(){var _=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",m={mimeType:_+this._mediaDataSource.type};return this._mediaElement&&(m.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(m.width=this._mediaElement.videoWidth,m.height=this._mediaElement.videoHeight)),m},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"statisticsInfo",{get:function(){var _={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return _;var m=!0,c=0,v=0;if(this._mediaElement.getVideoPlaybackQuality){var y=this._mediaElement.getVideoPlaybackQuality();c=y.totalVideoFrames,v=y.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(c=this._mediaElement.webkitDecodedFrameCount,v=this._mediaElement.webkitDroppedFrameCount):m=!1;return m&&(_.decodedFrames=c,_.droppedFrames=v),_},enumerable:!1,configurable:!0}),S.prototype._onvLoadedMetadata=function(_){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(u.default.MEDIA_INFO,this.mediaInfo)},S.prototype._reportStatisticsInfo=function(){this._emitter.emit(u.default.STATISTICS_INFO,this.statisticsInfo)},S}();o.default=E},"./src/player/player-errors.js":function(a,o,l){l.r(o),l.d(o,{ErrorTypes:function(){return u},ErrorDetails:function(){return f}});var h=l("./src/io/loader.js"),p=l("./src/demux/demux-errors.js"),u={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},f={NETWORK_EXCEPTION:h.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:h.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:h.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:h.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:p.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:p.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:p.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(a,o,l){l.r(o);var h={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};o.default=h},"./src/remux/aac-silent.js":function(a,o,l){l.r(o);var h=function(){function p(){}return p.getSilentFrame=function(u,f){if(u==="mp4a.40.2"){if(f===1)return new Uint8Array([0,200,0,128,35,128]);if(f===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(f===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(f===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(f===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(f===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(f===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},p}();o.default=h},"./src/remux/mp4-generator.js":function(a,o,l){l.r(o);var h=function(){function p(){}return p.init=function(){p.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var u in p.types)p.types.hasOwnProperty(u)&&(p.types[u]=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)]);var f=p.constants={};f.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),f.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),f.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),f.STSC=f.STCO=f.STTS,f.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),f.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),f.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),f.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),f.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},p.box=function(u){for(var f=8,g=null,E=Array.prototype.slice.call(arguments,1),S=E.length,_=0;_<S;_++)f+=E[_].byteLength;g=new Uint8Array(f),g[0]=f>>>24&255,g[1]=f>>>16&255,g[2]=f>>>8&255,g[3]=f&255,g.set(u,4);for(var m=8,_=0;_<S;_++)g.set(E[_],m),m+=E[_].byteLength;return g},p.generateInitSegment=function(u){var f=p.box(p.types.ftyp,p.constants.FTYP),g=p.moov(u),E=new Uint8Array(f.byteLength+g.byteLength);return E.set(f,0),E.set(g,f.byteLength),E},p.moov=function(u){var f=p.mvhd(u.timescale,u.duration),g=p.trak(u),E=p.mvex(u);return p.box(p.types.moov,f,g,E)},p.mvhd=function(u,f){return p.box(p.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},p.trak=function(u){return p.box(p.types.trak,p.tkhd(u),p.mdia(u))},p.tkhd=function(u){var f=u.id,g=u.duration,E=u.presentWidth,S=u.presentHeight;return p.box(p.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,E>>>8&255,E&255,0,0,S>>>8&255,S&255,0,0]))},p.mdia=function(u){return p.box(p.types.mdia,p.mdhd(u),p.hdlr(u),p.minf(u))},p.mdhd=function(u){var f=u.timescale,g=u.duration;return p.box(p.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,85,196,0,0]))},p.hdlr=function(u){var f=null;return u.type==="audio"?f=p.constants.HDLR_AUDIO:f=p.constants.HDLR_VIDEO,p.box(p.types.hdlr,f)},p.minf=function(u){var f=null;return u.type==="audio"?f=p.box(p.types.smhd,p.constants.SMHD):f=p.box(p.types.vmhd,p.constants.VMHD),p.box(p.types.minf,f,p.dinf(),p.stbl(u))},p.dinf=function(){var u=p.box(p.types.dinf,p.box(p.types.dref,p.constants.DREF));return u},p.stbl=function(u){var f=p.box(p.types.stbl,p.stsd(u),p.box(p.types.stts,p.constants.STTS),p.box(p.types.stsc,p.constants.STSC),p.box(p.types.stsz,p.constants.STSZ),p.box(p.types.stco,p.constants.STCO));return f},p.stsd=function(u){return u.type==="audio"?u.codec==="mp3"?p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp3(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp4a(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.avc1(u))},p.mp3=function(u){var f=u.channelCount,g=u.audioSampleRate,E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return p.box(p.types[".mp3"],E)},p.mp4a=function(u){var f=u.channelCount,g=u.audioSampleRate,E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return p.box(p.types.mp4a,E,p.esds(u))},p.esds=function(u){var f=u.config||[],g=f.length,E=new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(f).concat([6,1,2]));return p.box(p.types.esds,E)},p.avc1=function(u){var f=u.avcc,g=u.codecWidth,E=u.codecHeight,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>>8&255,g&255,E>>>8&255,E&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return p.box(p.types.avc1,S,p.box(p.types.avcC,f))},p.mvex=function(u){return p.box(p.types.mvex,p.trex(u))},p.trex=function(u){var f=u.id,g=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return p.box(p.types.trex,g)},p.moof=function(u,f){return p.box(p.types.moof,p.mfhd(u.sequenceNumber),p.traf(u,f))},p.mfhd=function(u){var f=new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255]);return p.box(p.types.mfhd,f)},p.traf=function(u,f){var g=u.id,E=p.box(p.types.tfhd,new Uint8Array([0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255])),S=p.box(p.types.tfdt,new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255])),_=p.sdtp(u),m=p.trun(u,_.byteLength+16+16+8+16+8+8);return p.box(p.types.traf,E,S,m,_)},p.sdtp=function(u){for(var f=u.samples||[],g=f.length,E=new Uint8Array(4+g),S=0;S<g;S++){var _=f[S].flags;E[S+4]=_.isLeading<<6|_.dependsOn<<4|_.isDependedOn<<2|_.hasRedundancy}return p.box(p.types.sdtp,E)},p.trun=function(u,f){var g=u.samples||[],E=g.length,S=12+16*E,_=new Uint8Array(S);f+=8+S,_.set([0,0,15,1,E>>>24&255,E>>>16&255,E>>>8&255,E&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255],0);for(var m=0;m<E;m++){var c=g[m].duration,v=g[m].size,y=g[m].flags,d=g[m].cts;_.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,y.isLeading<<2|y.dependsOn,y.isDependedOn<<6|y.hasRedundancy<<4|y.isNonSync,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*m)}return p.box(p.types.trun,_)},p.mdat=function(u){return p.box(p.types.mdat,u)},p}();h.init(),o.default=h},"./src/remux/mp4-remuxer.js":function(a,o,l){l.r(o);var h=l("./src/utils/logger.js"),p=l("./src/remux/mp4-generator.js"),u=l("./src/remux/aac-silent.js"),f=l("./src/utils/browser.js"),g=l("./src/core/media-segment-info.js"),E=l("./src/utils/exception.js"),S=function(){function _(m){this.TAG="MP4Remuxer",this._config=m,this._isLive=m.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new g.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new g.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(f.default.chrome&&(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661)),this._fillSilentAfterSeek=f.default.msedge||f.default.msie,this._mp3UseMpegAudio=!f.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return _.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},_.prototype.bindDataSource=function(m){return m.onDataAvailable=this.remux.bind(this),m.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(_.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(m){this._onInitSegment=m},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(m){this._onMediaSegment=m},enumerable:!1,configurable:!0}),_.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},_.prototype.seek=function(m){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},_.prototype.remux=function(m,c){if(!this._onMediaSegment)throw new E.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(m,c),this._remuxVideo(c),this._remuxAudio(m)},_.prototype._onTrackMetadataReceived=function(m,c){var v=null,y="mp4",d=c.codec;if(m==="audio")this._audioMeta=c,c.codec==="mp3"&&this._mp3UseMpegAudio?(y="mpeg",d="",v=new Uint8Array):v=p.default.generateInitSegment(c);else if(m==="video")this._videoMeta=c,v=p.default.generateInitSegment(c);else return;if(!this._onInitSegment)throw new E.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(m,{type:m,data:v.buffer,codec:d,container:m+"/"+y,mediaDuration:c.duration})},_.prototype._calculateDtsBase=function(m,c){this._dtsBaseInited||(m.samples&&m.samples.length&&(this._audioDtsBase=m.samples[0].dts),c.samples&&c.samples.length&&(this._videoDtsBase=c.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},_.prototype.flushStashedSamples=function(){var m=this._videoStashedLastSample,c=this._audioStashedLastSample,v={type:"video",id:1,sequenceNumber:0,samples:[],length:0};m!=null&&(v.samples.push(m),v.length=m.length);var y={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};c!=null&&(y.samples.push(c),y.length=c.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(v,!0),this._remuxAudio(y,!0)},_.prototype._remuxAudio=function(m,c){if(this._audioMeta!=null){var v=m,y=v.samples,d=void 0,x=-1,b=-1,T=this._audioMeta.refSampleDuration,A=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,L=this._dtsBaseInited&&this._audioNextDts===void 0,R=!1;if(!(!y||y.length===0)&&!(y.length===1&&!c)){var w=0,O=null,I=0;A?(w=0,I=v.length):(w=8,I=8+v.length);var D=null;if(y.length>1&&(D=y.pop(),I-=D.length),this._audioStashedLastSample!=null){var C=this._audioStashedLastSample;this._audioStashedLastSample=null,y.unshift(C),I+=C.length}D!=null&&(this._audioStashedLastSample=D);var P=y[0].dts-this._dtsBase;if(this._audioNextDts)d=P-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())d=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(R=!0);else{var M=this._audioSegmentInfoList.getLastSampleBefore(P);if(M!=null){var N=P-(M.originalDts+M.duration);N<=3&&(N=0);var B=M.dts+M.duration+N;d=P-B}else d=0}if(R){var U=P-d,F=this._videoSegmentInfoList.getLastSegmentBefore(P);if(F!=null&&F.beginDts<U){var j=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(j){var V=F.beginDts,G=U-F.beginDts;h.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+V+", duration: "+G),y.unshift({unit:j,dts:V,pts:V}),I+=j.byteLength}}else R=!1}for(var Y=[],X=0;X<y.length;X++){var C=y[X],ie=C.unit,he=C.dts-this._dtsBase,V=he,de=!1,Ae=null,pe=0;if(!(he<-.001)){if(this._audioMeta.codec!=="mp3"){var le=he,Ie=3;if(this._audioNextDts&&(le=this._audioNextDts),d=he-le,d<=-Ie*T){h.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+he+" ms ,curRefDts: "+le+" ms)  due to dtsCorrection: "+d+" ms overlap.");continue}else if(d>=Ie*T&&this._fillAudioTimestampGap&&!f.default.safari){de=!0;var Ce=Math.floor(d/T);h.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+he+" ms, curRefDts: "+le+" ms, ")+("dtsCorrection: "+Math.round(d)+" ms, generate: "+Ce+" frames")),V=Math.floor(le),pe=Math.floor(le+T)-V;var j=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);j==null&&(h.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),j=ie),Ae=[];for(var Ue=0;Ue<Ce;Ue++){le=le+T;var Me=Math.floor(le),ze=Math.floor(le+T)-Me,Ge={dts:Me,pts:Me,cts:0,unit:j,size:j.byteLength,duration:ze,originalDts:he,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ae.push(Ge),I+=Ge.size}this._audioNextDts=le+T}else V=Math.floor(le),pe=Math.floor(le+T)-V,this._audioNextDts=le+T}else{if(V=he-d,X!==y.length-1){var $e=y[X+1].dts-this._dtsBase-d;pe=$e-V}else if(D!=null){var $e=D.dts-this._dtsBase-d;pe=$e-V}else Y.length>=1?pe=Y[Y.length-1].duration:pe=Math.floor(T);this._audioNextDts=V+pe}x===-1&&(x=V),Y.push({dts:V,pts:V,cts:0,unit:C.unit,size:C.unit.byteLength,duration:pe,originalDts:he,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),de&&Y.push.apply(Y,Ae)}}if(Y.length===0){v.samples=[],v.length=0;return}A?O=new Uint8Array(I):(O=new Uint8Array(I),O[0]=I>>>24&255,O[1]=I>>>16&255,O[2]=I>>>8&255,O[3]=I&255,O.set(p.default.types.mdat,4));for(var X=0;X<Y.length;X++){var ie=Y[X].unit;O.set(ie,w),w+=ie.byteLength}var He=Y[Y.length-1];b=He.dts+He.duration;var Fe=new g.MediaSegmentInfo;Fe.beginDts=x,Fe.endDts=b,Fe.beginPts=x,Fe.endPts=b,Fe.originalBeginDts=Y[0].originalDts,Fe.originalEndDts=He.originalDts+He.duration,Fe.firstSample=new g.SampleInfo(Y[0].dts,Y[0].pts,Y[0].duration,Y[0].originalDts,!1),Fe.lastSample=new g.SampleInfo(He.dts,He.pts,He.duration,He.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Fe),v.samples=Y,v.sequenceNumber++;var Se=null;A?Se=new Uint8Array:Se=p.default.moof(v,x),v.samples=[],v.length=0;var Xe={type:"audio",data:this._mergeBoxes(Se,O).buffer,sampleCount:Y.length,info:Fe};A&&L&&(Xe.timestampOffset=x),this._onMediaSegment("audio",Xe)}}},_.prototype._remuxVideo=function(m,c){if(this._videoMeta!=null){var v=m,y=v.samples,d=void 0,x=-1,b=-1,T=-1,A=-1;if(!(!y||y.length===0)&&!(y.length===1&&!c)){var L=8,R=null,w=8+m.length,O=null;if(y.length>1&&(O=y.pop(),w-=O.length),this._videoStashedLastSample!=null){var I=this._videoStashedLastSample;this._videoStashedLastSample=null,y.unshift(I),w+=I.length}O!=null&&(this._videoStashedLastSample=O);var D=y[0].dts-this._dtsBase;if(this._videoNextDts)d=D-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())d=0;else{var C=this._videoSegmentInfoList.getLastSampleBefore(D);if(C!=null){var P=D-(C.originalDts+C.duration);P<=3&&(P=0);var M=C.dts+C.duration+P;d=D-M}else d=0}for(var N=new g.MediaSegmentInfo,B=[],U=0;U<y.length;U++){var I=y[U],F=I.dts-this._dtsBase,j=I.isKeyframe,V=F-d,G=I.cts,Y=V+G;x===-1&&(x=V,T=Y);var X=0;if(U!==y.length-1){var ie=y[U+1].dts-this._dtsBase-d;X=ie-V}else if(O!=null){var ie=O.dts-this._dtsBase-d;X=ie-V}else B.length>=1?X=B[B.length-1].duration:X=Math.floor(this._videoMeta.refSampleDuration);if(j){var he=new g.SampleInfo(V,Y,X,I.dts,!0);he.fileposition=I.fileposition,N.appendSyncPoint(he)}B.push({dts:V,pts:Y,cts:G,units:I.units,size:I.length,isKeyframe:j,duration:X,originalDts:F,flags:{isLeading:0,dependsOn:j?2:1,isDependedOn:j?1:0,hasRedundancy:0,isNonSync:j?0:1}})}R=new Uint8Array(w),R[0]=w>>>24&255,R[1]=w>>>16&255,R[2]=w>>>8&255,R[3]=w&255,R.set(p.default.types.mdat,4);for(var U=0;U<B.length;U++)for(var de=B[U].units;de.length;){var Ae=de.shift(),pe=Ae.data;R.set(pe,L),L+=pe.byteLength}var le=B[B.length-1];if(b=le.dts+le.duration,A=le.pts+le.duration,this._videoNextDts=b,N.beginDts=x,N.endDts=b,N.beginPts=T,N.endPts=A,N.originalBeginDts=B[0].originalDts,N.originalEndDts=le.originalDts+le.duration,N.firstSample=new g.SampleInfo(B[0].dts,B[0].pts,B[0].duration,B[0].originalDts,B[0].isKeyframe),N.lastSample=new g.SampleInfo(le.dts,le.pts,le.duration,le.originalDts,le.isKeyframe),this._isLive||this._videoSegmentInfoList.append(N),v.samples=B,v.sequenceNumber++,this._forceFirstIDR){var Ie=B[0].flags;Ie.dependsOn=2,Ie.isNonSync=0}var Ce=p.default.moof(v,x);v.samples=[],v.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ce,R).buffer,sampleCount:B.length,info:N})}}},_.prototype._mergeBoxes=function(m,c){var v=new Uint8Array(m.byteLength+c.byteLength);return v.set(m,0),v.set(c,m.byteLength),v},_}();o.default=S},"./src/utils/browser.js":function(a,o,l){l.r(o);var h={};function p(){var u=self.navigator.userAgent.toLowerCase(),f=/(edge)\/([\w.]+)/.exec(u)||/(opr)[\/]([\w.]+)/.exec(u)||/(chrome)[ \/]([\w.]+)/.exec(u)||/(iemobile)[\/]([\w.]+)/.exec(u)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(u)||[],g=/(ipad)/.exec(u)||/(ipod)/.exec(u)||/(windows phone)/.exec(u)||/(iphone)/.exec(u)||/(kindle)/.exec(u)||/(android)/.exec(u)||/(windows)/.exec(u)||/(mac)/.exec(u)||/(linux)/.exec(u)||/(cros)/.exec(u)||[],E={browser:f[5]||f[3]||f[1]||"",version:f[2]||f[4]||"0",majorVersion:f[4]||f[2]||"0",platform:g[0]||""},S={};if(E.browser){S[E.browser]=!0;var _=E.majorVersion.split(".");S.version={major:parseInt(E.majorVersion,10),string:E.version},_.length>1&&(S.version.minor=parseInt(_[1],10)),_.length>2&&(S.version.build=parseInt(_[2],10))}if(E.platform&&(S[E.platform]=!0),(S.chrome||S.opr||S.safari)&&(S.webkit=!0),S.rv||S.iemobile){S.rv&&delete S.rv;var m="msie";E.browser=m,S[m]=!0}if(S.edge){delete S.edge;var c="msedge";E.browser=c,S[c]=!0}if(S.opr){var v="opera";E.browser=v,S[v]=!0}if(S.safari&&S.android){var y="android";E.browser=y,S[y]=!0}S.name=E.browser,S.platform=E.platform;for(var d in h)h.hasOwnProperty(d)&&delete h[d];Object.assign(h,S)}p(),o.default=h},"./src/utils/exception.js":function(a,o,l){l.r(o),l.d(o,{RuntimeException:function(){return p},IllegalStateException:function(){return u},InvalidArgumentException:function(){return f},NotImplementedException:function(){return g}});var h=function(){var E=function(S,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(m[v]=c[v])},E(S,_)};return function(S,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");E(S,_);function m(){this.constructor=S}S.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),p=function(){function E(S){this._message=S}return Object.defineProperty(E.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),E.prototype.toString=function(){return this.name+": "+this.message},E}(),u=function(E){h(S,E);function S(_){return E.call(this,_)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),S}(p),f=function(E){h(S,E);function S(_){return E.call(this,_)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),S}(p),g=function(E){h(S,E);function S(_){return E.call(this,_)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),S}(p)},"./src/utils/logger.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=function(){function f(){}return f.e=function(g,E){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var S="["+g+"] > "+E;f.ENABLE_CALLBACK&&f.emitter.emit("log","error",S),!!f.ENABLE_ERROR&&(console.error?console.error(S):console.warn?console.warn(S):console.log(S))},f.i=function(g,E){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var S="["+g+"] > "+E;f.ENABLE_CALLBACK&&f.emitter.emit("log","info",S),!!f.ENABLE_INFO&&(console.info?console.info(S):console.log(S))},f.w=function(g,E){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var S="["+g+"] > "+E;f.ENABLE_CALLBACK&&f.emitter.emit("log","warn",S),!!f.ENABLE_WARN&&(console.warn?console.warn(S):console.log(S))},f.d=function(g,E){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var S="["+g+"] > "+E;f.ENABLE_CALLBACK&&f.emitter.emit("log","debug",S),!!f.ENABLE_DEBUG&&(console.debug?console.debug(S):console.log(S))},f.v=function(g,E){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var S="["+g+"] > "+E;f.ENABLE_CALLBACK&&f.emitter.emit("log","verbose",S),!!f.ENABLE_VERBOSE&&console.log(S)},f}();u.GLOBAL_TAG="flv.js",u.FORCE_GLOBAL_TAG=!1,u.ENABLE_ERROR=!0,u.ENABLE_INFO=!0,u.ENABLE_WARN=!0,u.ENABLE_DEBUG=!0,u.ENABLE_VERBOSE=!0,u.ENABLE_CALLBACK=!1,u.emitter=new(p()),o.default=u},"./src/utils/logging-control.js":function(a,o,l){l.r(o);var h=l("./node_modules/events/events.js"),p=l.n(h),u=l("./src/utils/logger.js"),f=function(){function g(){}return Object.defineProperty(g,"forceGlobalTag",{get:function(){return u.default.FORCE_GLOBAL_TAG},set:function(E){u.default.FORCE_GLOBAL_TAG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"globalTag",{get:function(){return u.default.GLOBAL_TAG},set:function(E){u.default.GLOBAL_TAG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableAll",{get:function(){return u.default.ENABLE_VERBOSE&&u.default.ENABLE_DEBUG&&u.default.ENABLE_INFO&&u.default.ENABLE_WARN&&u.default.ENABLE_ERROR},set:function(E){u.default.ENABLE_VERBOSE=E,u.default.ENABLE_DEBUG=E,u.default.ENABLE_INFO=E,u.default.ENABLE_WARN=E,u.default.ENABLE_ERROR=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableDebug",{get:function(){return u.default.ENABLE_DEBUG},set:function(E){u.default.ENABLE_DEBUG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableVerbose",{get:function(){return u.default.ENABLE_VERBOSE},set:function(E){u.default.ENABLE_VERBOSE=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableInfo",{get:function(){return u.default.ENABLE_INFO},set:function(E){u.default.ENABLE_INFO=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableWarn",{get:function(){return u.default.ENABLE_WARN},set:function(E){u.default.ENABLE_WARN=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableError",{get:function(){return u.default.ENABLE_ERROR},set:function(E){u.default.ENABLE_ERROR=E,g._notifyChange()},enumerable:!1,configurable:!0}),g.getConfig=function(){return{globalTag:u.default.GLOBAL_TAG,forceGlobalTag:u.default.FORCE_GLOBAL_TAG,enableVerbose:u.default.ENABLE_VERBOSE,enableDebug:u.default.ENABLE_DEBUG,enableInfo:u.default.ENABLE_INFO,enableWarn:u.default.ENABLE_WARN,enableError:u.default.ENABLE_ERROR,enableCallback:u.default.ENABLE_CALLBACK}},g.applyConfig=function(E){u.default.GLOBAL_TAG=E.globalTag,u.default.FORCE_GLOBAL_TAG=E.forceGlobalTag,u.default.ENABLE_VERBOSE=E.enableVerbose,u.default.ENABLE_DEBUG=E.enableDebug,u.default.ENABLE_INFO=E.enableInfo,u.default.ENABLE_WARN=E.enableWarn,u.default.ENABLE_ERROR=E.enableError,u.default.ENABLE_CALLBACK=E.enableCallback},g._notifyChange=function(){var E=g.emitter;if(E.listenerCount("change")>0){var S=g.getConfig();E.emit("change",S)}},g.registerListener=function(E){g.emitter.addListener("change",E)},g.removeListener=function(E){g.emitter.removeListener("change",E)},g.addLogListener=function(E){u.default.emitter.addListener("log",E),u.default.emitter.listenerCount("log")>0&&(u.default.ENABLE_CALLBACK=!0,g._notifyChange())},g.removeLogListener=function(E){u.default.emitter.removeListener("log",E),u.default.emitter.listenerCount("log")===0&&(u.default.ENABLE_CALLBACK=!1,g._notifyChange())},g}();f.emitter=new(p()),o.default=f},"./src/utils/polyfill.js":function(a,o,l){l.r(o);var h=function(){function p(){}return p.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u},Object.assign=Object.assign||function(u){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var f=Object(u),g=1;g<arguments.length;g++){var E=arguments[g];if(E!=null)for(var S in E)E.hasOwnProperty(S)&&(f[S]=E[S])}return f},typeof self.Promise!="function"&&l("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},p}();h.install(),o.default=h},"./src/utils/utf8-conv.js":function(a,o,l){l.r(o);function h(u,f,g){var E=u;if(f+g<E.length){for(;g--;)if((E[++f]&192)!=128)return!1;return!0}else return!1}function p(u){for(var f=[],g=u,E=0,S=u.length;E<S;){if(g[E]<128){f.push(String.fromCharCode(g[E])),++E;continue}else if(!(g[E]<192)){if(g[E]<224){if(h(g,E,1)){var _=(g[E]&31)<<6|g[E+1]&63;if(_>=128){f.push(String.fromCharCode(_&65535)),E+=2;continue}}}else if(g[E]<240){if(h(g,E,2)){var _=(g[E]&15)<<12|(g[E+1]&63)<<6|g[E+2]&63;if(_>=2048&&(_&63488)!=55296){f.push(String.fromCharCode(_&65535)),E+=3;continue}}}else if(g[E]<248&&h(g,E,3)){var _=(g[E]&7)<<18|(g[E+1]&63)<<12|(g[E+2]&63)<<6|g[E+3]&63;if(_>65536&&_<1114112){_-=65536,f.push(String.fromCharCode(_>>>10|55296)),f.push(String.fromCharCode(_&1023|56320)),E+=4;continue}}}f.push(String.fromCharCode(65533)),++E}return f.join("")}o.default=p}},i={};function t(a){var o=i[a];if(o!==void 0)return o.exports;var l=i[a]={exports:{}};return r[a].call(l.exports,l,l.exports,t),l.exports}t.m=r,function(){t.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(o,{a:o}),o}}(),function(){t.d=function(a,o){for(var l in o)t.o(o,l)&&!t.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})}}(),function(){t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(a){if(typeof window=="object")return window}}()}(),function(){t.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)}}(),function(){t.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}();var n=t("./src/index.js");return n}()})})(Rh);var kT=xo(Rh.exports);const La=typeof window!="undefined"?window.navigator.userAgent:"",NT=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(La);/^((?!chrome|android).)*safari/i.test(La);/MicroMessenger/i.test(La);/MSIE|Trident/i.test(La);var Dh={exports:{}};(function(s,e){typeof window!="undefined"&&function(i,t){s.exports=t()}(Wt,function(){return function(r){var i={};function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=r,t.c=i,t.d=function(n,a,o){t.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:o})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,a){if(a&1&&(n=t(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var l in n)t.d(o,l,function(h){return n[h]}.bind(null,l));return o},t.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(a,"a",a),a},t.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},t.p="/dist/",t(t.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(r,i,t){var n=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(f,g,E){this.fn=f,this.context=g,this.once=E||!1}function h(f,g,E,S,_){if(typeof E!="function")throw new TypeError("The listener must be a function");var m=new l(E,S||f,_),c=a?a+g:g;return f._events[c]?f._events[c].fn?f._events[c]=[f._events[c],m]:f._events[c].push(m):(f._events[c]=m,f._eventsCount++),f}function p(f,g){--f._eventsCount==0?f._events=new o:delete f._events[g]}function u(){this._events=new o,this._eventsCount=0}u.prototype.eventNames=function(){var g=[],E,S;if(this._eventsCount===0)return g;for(S in E=this._events)n.call(E,S)&&g.push(a?S.slice(1):S);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(E)):g},u.prototype.listeners=function(g){var E=a?a+g:g,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var _=0,m=S.length,c=new Array(m);_<m;_++)c[_]=S[_].fn;return c},u.prototype.listenerCount=function(g){var E=a?a+g:g,S=this._events[E];return S?S.fn?1:S.length:0},u.prototype.emit=function(g,E,S,_,m,c){var v=a?a+g:g;if(!this._events[v])return!1;var y=this._events[v],d=arguments.length,x,b;if(y.fn){switch(y.once&&this.removeListener(g,y.fn,void 0,!0),d){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,E),!0;case 3:return y.fn.call(y.context,E,S),!0;case 4:return y.fn.call(y.context,E,S,_),!0;case 5:return y.fn.call(y.context,E,S,_,m),!0;case 6:return y.fn.call(y.context,E,S,_,m,c),!0}for(b=1,x=new Array(d-1);b<d;b++)x[b-1]=arguments[b];y.fn.apply(y.context,x)}else{var T=y.length,A;for(b=0;b<T;b++)switch(y[b].once&&this.removeListener(g,y[b].fn,void 0,!0),d){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,E);break;case 3:y[b].fn.call(y[b].context,E,S);break;case 4:y[b].fn.call(y[b].context,E,S,_);break;default:if(!x)for(A=1,x=new Array(d-1);A<d;A++)x[A-1]=arguments[A];y[b].fn.apply(y[b].context,x)}}return!0},u.prototype.on=function(g,E,S){return h(this,g,E,S,!1)},u.prototype.once=function(g,E,S){return h(this,g,E,S,!0)},u.prototype.removeListener=function(g,E,S,_){var m=a?a+g:g;if(!this._events[m])return this;if(!E)return p(this,m),this;var c=this._events[m];if(c.fn)c.fn===E&&(!_||c.once)&&(!S||c.context===S)&&p(this,m);else{for(var v=0,y=[],d=c.length;v<d;v++)(c[v].fn!==E||_&&!c[v].once||S&&c[v].context!==S)&&y.push(c[v]);y.length?this._events[m]=y.length===1?y[0]:y:p(this,m)}return this},u.prototype.removeAllListeners=function(g){var E;return g?(E=a?a+g:g,this._events[E]&&p(this,E)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=a,u.EventEmitter=u,r.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(r,i,t){(function(n){var a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,o=/^([^\/?#]*)([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(u,f,g){if(g=g||{},u=u.trim(),f=f.trim(),!f){if(!g.alwaysNormalize)return u;var E=p.parseURL(u);if(!E)throw new Error("Error trying to parse base URL.");return E.path=p.normalizePath(E.path),p.buildURLFromParts(E)}var S=p.parseURL(f);if(!S)throw new Error("Error trying to parse relative URL.");if(S.scheme)return g.alwaysNormalize?(S.path=p.normalizePath(S.path),p.buildURLFromParts(S)):f;var _=p.parseURL(u);if(!_)throw new Error("Error trying to parse base URL.");if(!_.netLoc&&_.path&&_.path[0]!=="/"){var m=o.exec(_.path);_.netLoc=m[1],_.path=m[2]}_.netLoc&&!_.path&&(_.path="/");var c={scheme:_.scheme,netLoc:S.netLoc,path:null,params:S.params,query:S.query,fragment:S.fragment};if(!S.netLoc&&(c.netLoc=_.netLoc,S.path[0]!=="/"))if(!S.path)c.path=_.path,S.params||(c.params=_.params,S.query||(c.query=_.query));else{var v=_.path,y=v.substring(0,v.lastIndexOf("/")+1)+S.path;c.path=p.normalizePath(y)}return c.path===null&&(c.path=g.alwaysNormalize?p.normalizePath(S.path):S.path),p.buildURLFromParts(c)},parseURL:function(u){var f=a.exec(u);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(l,"");u.length!==(u=u.replace(h,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};r.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(r,i,t){function n(g){var E={};function S(m){if(E[m])return E[m].exports;var c=E[m]={i:m,l:!1,exports:{}};return g[m].call(c.exports,c,c.exports,S),c.l=!0,c.exports}S.m=g,S.c=E,S.i=function(m){return m},S.d=function(m,c,v){S.o(m,c)||Object.defineProperty(m,c,{configurable:!1,enumerable:!0,get:v})},S.r=function(m){Object.defineProperty(m,"__esModule",{value:!0})},S.n=function(m){var c=m&&m.__esModule?function(){return m.default}:function(){return m};return S.d(c,"a",c),c},S.o=function(m,c){return Object.prototype.hasOwnProperty.call(m,c)},S.p="/",S.oe=function(m){throw console.error(m),m};var _=S(S.s=ENTRY_MODULE);return _.default||_}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+a+").*?\\)";function l(g){return(g+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function h(g){return!isNaN(1*g)}function p(g,E,S){var _={};_[S]=[];var m=E.toString(),c=m.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return _;for(var v=c[1],y=new RegExp("(\\\\n|\\W)"+l(v)+o,"g"),d;d=y.exec(m);)d[3]!=="dll-reference"&&_[S].push(d[3]);for(y=new RegExp("\\("+l(v)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");d=y.exec(m);)g[d[2]]||(_[S].push(d[1]),g[d[2]]=t(d[1]).m),_[d[2]]=_[d[2]]||[],_[d[2]].push(d[4]);for(var x=Object.keys(_),b=0;b<x.length;b++)for(var T=0;T<_[x[b]].length;T++)h(_[x[b]][T])&&(_[x[b]][T]=1*_[x[b]][T]);return _}function u(g){var E=Object.keys(g);return E.reduce(function(S,_){return S||g[_].length>0},!1)}function f(g,E){for(var S={main:[E]},_={main:[]},m={main:{}};u(S);)for(var c=Object.keys(S),v=0;v<c.length;v++){var y=c[v],d=S[y],x=d.pop();if(m[y]=m[y]||{},!(m[y][x]||!g[y][x])){m[y][x]=!0,_[y]=_[y]||[],_[y].push(x);for(var b=p(g,g[y][x],y),T=Object.keys(b),A=0;A<T.length;A++)S[T[A]]=S[T[A]]||[],S[T[A]]=S[T[A]].concat(b[T[A]])}}return _}r.exports=function(g,E){E=E||{};var S={main:t.m},_=E.all?{main:Object.keys(S.main)}:f(S,g),m="";Object.keys(_).filter(function(x){return x!=="main"}).forEach(function(x){for(var b=0;_[x][b];)b++;_[x].push(b),S[x][b]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",m=m+"var "+x+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(b))+")({"+_[x].map(function(T){return""+JSON.stringify(T)+": "+S[x][T].toString()}).join(",")+`});
`}),m=m+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(g))+")({"+_.main.map(function(x){return""+JSON.stringify(x)+": "+S.main[x].toString()}).join(",")+"}))(self);";var c=new window.Blob([m],{type:"text/javascript"});if(E.bare)return c;var v=window.URL||window.webkitURL||window.mozURL||window.msURL,y=v.createObjectURL(c),d=new window.Worker(y);return d.objectURL=y,d}},"./src/config.ts":function(r,i,t){t.r(i),t.d(i,"hlsDefaultConfig",function(){return A}),t.d(i,"mergeConfig",function(){return R}),t.d(i,"enableStreamingMode",function(){return w});var n=t("./src/controller/abr-controller.ts"),a=t("./src/controller/audio-stream-controller.ts"),o=t("./src/controller/audio-track-controller.ts"),l=t("./src/controller/subtitle-stream-controller.ts"),h=t("./src/controller/subtitle-track-controller.ts"),p=t("./src/controller/buffer-controller.ts"),u=t("./src/controller/timeline-controller.ts"),f=t("./src/controller/cap-level-controller.ts"),g=t("./src/controller/fps-controller.ts"),E=t("./src/controller/eme-controller.ts"),S=t("./src/controller/cmcd-controller.ts"),_=t("./src/utils/xhr-loader.ts"),m=t("./src/utils/fetch-loader.ts"),c=t("./src/utils/cues.ts"),v=t("./src/utils/mediakeys-helper.ts"),y=t("./src/utils/logger.ts");function d(){return d=Object.assign||function(O){for(var I=1;I<arguments.length;I++){var D=arguments[I];for(var C in D)Object.prototype.hasOwnProperty.call(D,C)&&(O[C]=D[C])}return O},d.apply(this,arguments)}function x(O,I){var D=Object.keys(O);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(O);I&&(C=C.filter(function(P){return Object.getOwnPropertyDescriptor(O,P).enumerable})),D.push.apply(D,C)}return D}function b(O){for(var I=1;I<arguments.length;I++){var D=arguments[I]!=null?arguments[I]:{};I%2?x(Object(D),!0).forEach(function(C){T(O,C,D[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(D)):x(Object(D)).forEach(function(C){Object.defineProperty(O,C,Object.getOwnPropertyDescriptor(D,C))})}return O}function T(O,I,D){return I in O?Object.defineProperty(O,I,{value:D,enumerable:!0,configurable:!0,writable:!0}):O[I]=D,O}var A=b(b({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:_.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n.default,bufferController:p.default,capLevelController:f.default,fpsController:g.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:v.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},L()),{},{subtitleStreamController:l.SubtitleStreamController,subtitleTrackController:h.default,timelineController:u.TimelineController,audioStreamController:a.default,audioTrackController:o.default,emeController:E.default,cmcdController:S.default});function L(){return{cueHandler:c.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function R(O,I){if((I.liveSyncDurationCount||I.liveMaxLatencyDurationCount)&&(I.liveSyncDuration||I.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(I.liveMaxLatencyDurationCount!==void 0&&(I.liveSyncDurationCount===void 0||I.liveMaxLatencyDurationCount<=I.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(I.liveMaxLatencyDuration!==void 0&&(I.liveSyncDuration===void 0||I.liveMaxLatencyDuration<=I.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return d({},O,I)}function w(O){var I=O.loader;if(I!==m.default&&I!==_.default)y.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),O.progressive=!1;else{var D=Object(m.fetchSupported)();D&&(O.loader=m.default,O.progressive=!0,O.enableSoftwareAES=!0,y.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/ewma-bandwidth-estimator.ts"),o=t("./src/events.ts"),l=t("./src/utils/buffer-helper.ts"),h=t("./src/errors.ts"),p=t("./src/types/loader.ts"),u=t("./src/utils/logger.ts");function f(S,_){for(var m=0;m<_.length;m++){var c=_[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function g(S,_,m){return _&&f(S.prototype,_),m&&f(S,m),S}var E=function(){function S(m){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=m;var c=m.config;this.bwEstimator=new a.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var _=S.prototype;return _.registerListeners=function(){var c=this.hls;c.on(o.Events.FRAG_LOADING,this.onFragLoading,this),c.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(o.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var c=this.hls;c.off(o.Events.FRAG_LOADING,this.onFragLoading,this),c.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(o.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},_.onFragLoading=function(c,v){var y=v.frag;if(y.type===p.PlaylistLevelType.MAIN&&!this.timer){var d;this.fragCurrent=y,this.partCurrent=(d=v.part)!=null?d:null,this.timer=self.setInterval(this.onCheck,100)}},_.onLevelLoaded=function(c,v){var y=this.hls.config;v.details.live?this.bwEstimator.update(y.abrEwmaSlowLive,y.abrEwmaFastLive):this.bwEstimator.update(y.abrEwmaSlowVoD,y.abrEwmaFastVoD)},_._abandonRulesCheck=function(){var c=this.fragCurrent,v=this.partCurrent,y=this.hls,d=y.autoLevelEnabled,x=y.config,b=y.media;if(!(!c||!b)){var T=v?v.stats:c.stats,A=v?v.duration:c.duration;if(T.aborted){u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!d||b.paused||!b.playbackRate||!b.readyState)){var L=performance.now()-T.loading.start,R=Math.abs(b.playbackRate);if(!(L<=500*A/R)){var w=y.levels,O=y.minAutoLevel,I=w[c.level],D=T.total||Math.max(T.loaded,Math.round(A*I.maxBitrate/8)),C=Math.max(1,T.bwEstimate?T.bwEstimate/8:T.loaded*1e3/L),P=(D-T.loaded)/C,M=b.currentTime,N=(l.BufferHelper.bufferInfo(b,M,x.maxBufferHole).end-M)/R;if(!(N>=2*A/R||P<=N)){var B=Number.POSITIVE_INFINITY,U;for(U=c.level-1;U>O;U--){var F=w[U].maxBitrate;if(B=A*F/(8*.8*C),B<N)break}if(!(B>=P)){var j=this.bwEstimator.getEstimate();u.logger.warn("Fragment "+c.sn+(v?" part "+v.index:"")+" of level "+c.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+U+`
      Current BW estimate: `+(Object(n.isFiniteNumber)(j)?(j/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+P.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+N.toFixed(3)+" s"),y.nextLoadLevel=U,this.bwEstimator.sample(L,T.loaded),this.clearTimer(),c.loader&&(this.fragCurrent=this.partCurrent=null,c.loader.abort()),y.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,part:v,stats:T})}}}}}},_.onFragLoaded=function(c,v){var y=v.frag,d=v.part;if(y.type===p.PlaylistLevelType.MAIN&&Object(n.isFiniteNumber)(y.sn)){var x=d?d.stats:y.stats,b=d?d.duration:y.duration;if(this.clearTimer(),this.lastLoadedFragLevel=y.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var T=this.hls.levels[y.level],A=(T.loaded?T.loaded.bytes:0)+x.loaded,L=(T.loaded?T.loaded.duration:0)+b;T.loaded={bytes:A,duration:L},T.realBitrate=Math.round(8*A/L)}if(y.bitrateTest){var R={stats:x,frag:y,part:d,id:y.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,R),y.bitrateTest=!1}}},_.onFragBuffered=function(c,v){var y=v.frag,d=v.part,x=d?d.stats:y.stats;if(!x.aborted&&!(y.type!==p.PlaylistLevelType.MAIN||y.sn==="initSegment")){var b=x.parsing.end-x.loading.start;this.bwEstimator.sample(b,x.loaded),x.bwEstimate=this.bwEstimator.getEstimate(),y.bitrateTest?this.bitrateTestDelay=b/1e3:this.bitrateTestDelay=0}},_.onError=function(c,v){switch(v.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},_.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},_.getNextABRAutoLevel=function(){var c=this.fragCurrent,v=this.partCurrent,y=this.hls,d=y.maxAutoLevel,x=y.config,b=y.minAutoLevel,T=y.media,A=v?v.duration:c?c.duration:0,L=T?T.currentTime:0,R=T&&T.playbackRate!==0?Math.abs(T.playbackRate):1,w=this.bwEstimator?this.bwEstimator.getEstimate():x.abrEwmaDefaultEstimate,O=(l.BufferHelper.bufferInfo(T,L,x.maxBufferHole).end-L)/R,I=this.findBestLevel(w,b,d,O,x.abrBandWidthFactor,x.abrBandWidthUpFactor);if(I>=0)return I;u.logger.trace((O?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var D=A?Math.min(A,x.maxStarvationDelay):x.maxStarvationDelay,C=x.abrBandWidthFactor,P=x.abrBandWidthUpFactor;if(!O){var M=this.bitrateTestDelay;if(M){var N=A?Math.min(A,x.maxLoadingDelay):x.maxLoadingDelay;D=N-M,u.logger.trace("bitrate test took "+Math.round(1e3*M)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*D)+" ms"),C=P=1}}return I=this.findBestLevel(w,b,d,O+D,C,P),Math.max(I,0)},_.findBestLevel=function(c,v,y,d,x,b){for(var T,A=this.fragCurrent,L=this.partCurrent,R=this.lastLoadedFragLevel,w=this.hls.levels,O=w[R],I=!!(O!=null&&(T=O.details)!==null&&T!==void 0&&T.live),D=O==null?void 0:O.codecSet,C=L?L.duration:A?A.duration:0,P=y;P>=v;P--){var M=w[P];if(!(!M||D&&M.codecSet!==D)){var N=M.details,B=(L?N==null?void 0:N.partTarget:N==null?void 0:N.averagetargetduration)||C,U=void 0;P<=R?U=x*c:U=b*c;var F=w[P].maxBitrate,j=F*B/U;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+P+"/"+Math.round(U)+"/"+F+"/"+B+"/"+d+"/"+j),U>F&&(!j||I&&!this.bitrateTestDelay||j<d))return P}}return-1},g(S,[{key:"nextAutoLevel",get:function(){var c=this._nextAutoLevel,v=this.bwEstimator;if(c!==-1&&(!v||!v.canEstimate()))return c;var y=this.getNextABRAutoLevel();return c!==-1&&(y=Math.min(c,y)),y},set:function(c){this._nextAutoLevel=c}}]),S}();i.default=E},"./src/controller/audio-stream-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/events.ts"),l=t("./src/utils/buffer-helper.ts"),h=t("./src/controller/fragment-tracker.ts"),p=t("./src/types/level.ts"),u=t("./src/types/loader.ts"),f=t("./src/loader/fragment.ts"),g=t("./src/demux/chunk-cache.ts"),E=t("./src/demux/transmuxer-interface.ts"),S=t("./src/types/transmuxer.ts"),_=t("./src/controller/fragment-finders.ts"),m=t("./src/utils/discontinuities.ts"),c=t("./src/errors.ts"),v=t("./src/utils/logger.ts");function y(){return y=Object.assign||function(A){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var w in R)Object.prototype.hasOwnProperty.call(R,w)&&(A[w]=R[w])}return A},y.apply(this,arguments)}function d(A,L){A.prototype=Object.create(L.prototype),A.prototype.constructor=A,x(A,L)}function x(A,L){return x=Object.setPrototypeOf||function(w,O){return w.__proto__=O,w},x(A,L)}var b=100,T=function(A){d(L,A);function L(w,O){var I;return I=A.call(this,w,O,"[audio-stream-controller]")||this,I.videoBuffer=null,I.videoTrackCC=-1,I.waitingVideoCC=-1,I.audioSwitch=!1,I.trackId=-1,I.waitingData=null,I.mainDetails=null,I.bufferFlushed=!1,I._registerListeners(),I}var R=L.prototype;return R.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},R._registerListeners=function(){var O=this.hls;O.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.on(o.Events.ERROR,this.onError,this),O.on(o.Events.BUFFER_RESET,this.onBufferReset,this),O.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R._unregisterListeners=function(){var O=this.hls;O.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.off(o.Events.ERROR,this.onError,this),O.off(o.Events.BUFFER_RESET,this.onBufferReset,this),O.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R.onInitPtsFound=function(O,I){var D=I.frag,C=I.id,P=I.initPTS;if(C==="main"){var M=D.cc;this.initPTS[D.cc]=P,this.log("InitPTS for cc: "+M+" found from main: "+P),this.videoTrackCC=M,this.state===a.State.WAITING_INIT_PTS&&this.tick()}},R.startLoad=function(O){if(!this.levels){this.startPosition=O,this.state=a.State.STOPPED;return}var I=this.lastCurrentTime;this.stopLoad(),this.setInterval(b),this.fragLoadError=0,I>0&&O===-1?(this.log("Override startPosition with lastCurrentTime @"+I.toFixed(3)),this.state=a.State.IDLE):(this.loadedmetadata=!1,this.state=a.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=O,this.tick()},R.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_TRACK:{var O,I=this.levels,D=this.trackId,C=I==null||(O=I[D])===null||O===void 0?void 0:O.details;if(C){if(this.waitForCdnTuneIn(C))break;this.state=a.State.WAITING_INIT_PTS}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var P,M=performance.now(),N=this.retryDate;(!N||M>=N||(P=this.media)!==null&&P!==void 0&&P.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=a.State.IDLE);break}case a.State.WAITING_INIT_PTS:{var B=this.waitingData;if(B){var U=B.frag,F=B.part,j=B.cache,V=B.complete;if(this.initPTS[U.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.FRAG_LOADING;var G=j.flush(),Y={frag:U,part:F,payload:G,networkDetails:null};this._handleFragmentLoadProgress(Y),V&&A.prototype._handleFragmentLoadComplete.call(this,Y)}else if(this.videoTrackCC!==this.waitingVideoCC)v.logger.log("Waiting fragment cc ("+U.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var X=this.getLoadPosition(),ie=l.BufferHelper.bufferInfo(this.mediaBuffer,X,this.config.maxBufferHole),he=Object(_.fragmentWithinToleranceTest)(ie.end,this.config.maxFragLookUpTolerance,U);he<0&&(v.logger.log("Waiting fragment cc ("+U.cc+") @ "+U.start+" cancelled because another fragment at "+ie.end+" is needed"),this.clearWaitingFragment())}}else this.state=a.State.IDLE}}this.onTickEnd()},R.clearWaitingFragment=function(){var O=this.waitingData;O&&(this.fragmentTracker.removeFragment(O.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.IDLE)},R.onTickEnd=function(){var O=this.media;if(!(!O||!O.readyState)){var I=this.mediaBuffer?this.mediaBuffer:O,D=I.buffered;!this.loadedmetadata&&D.length&&(this.loadedmetadata=!0),this.lastCurrentTime=O.currentTime}},R.doTickIdle=function(){var O,I,D=this.hls,C=this.levels,P=this.media,M=this.trackId,N=D.config;if(!(!C||!C[M])&&!(!P&&(this.startFragRequested||!N.startFragPrefetch))){var B=C[M],U=B.details;if(!U||U.live&&this.levelLastLoaded!==M||this.waitForCdnTuneIn(U)){this.state=a.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,f.ElementaryStreamTypes.AUDIO,u.PlaylistLevelType.AUDIO));var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,u.PlaylistLevelType.AUDIO);if(F!==null){var j=F.len,V=this.getMaxBufferLength(),G=this.audioSwitch;if(!(j>=V&&!G)){if(!G&&this._streamEnded(F,U)){D.trigger(o.Events.BUFFER_EOS,{type:"audio"}),this.state=a.State.ENDED;return}var Y=U.fragments,X=Y[0].start,ie=F.end;if(G){var he=this.getLoadPosition();ie=he,U.PTSKnown&&he<X&&(F.end>X||F.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),P.currentTime=X+.05)}var de=this.getNextFragment(ie,U);if(!de){this.bufferFlushed=!0;return}((O=de.decryptdata)===null||O===void 0?void 0:O.keyFormat)==="identity"&&!((I=de.decryptdata)!==null&&I!==void 0&&I.key)?this.loadKey(de,U):this.loadFragment(de,U,ie)}}}},R.getMaxBufferLength=function(){var O=A.prototype.getMaxBufferLength.call(this),I=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,u.PlaylistLevelType.MAIN);return I===null?O:Math.max(O,I.len)},R.onMediaDetaching=function(){this.videoBuffer=null,A.prototype.onMediaDetaching.call(this)},R.onAudioTracksUpdated=function(O,I){var D=I.audioTracks;this.resetTransmuxer(),this.levels=D.map(function(C){return new p.Level(C)})},R.onAudioTrackSwitching=function(O,I){var D=!!I.url;this.trackId=I.id;var C=this.fragCurrent;C!=null&&C.loader&&C.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),D?this.setInterval(b):this.resetTransmuxer(),D?(this.audioSwitch=!0,this.state=a.State.IDLE):this.state=a.State.STOPPED,this.tick()},R.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},R.onLevelLoaded=function(O,I){this.mainDetails=I.details},R.onAudioTrackLoaded=function(O,I){var D,C=this.levels,P=I.details,M=I.id;if(!C){this.warn("Audio tracks were reset while loading level "+M);return}this.log("Track "+M+" loaded ["+P.startSN+","+P.endSN+"],duration:"+P.totalduration);var N=C[M],B=0;if(P.live||(D=N.details)!==null&&D!==void 0&&D.live){var U=this.mainDetails;if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed||!U)return;!N.details&&P.hasProgramDateTime&&U.hasProgramDateTime?(Object(m.alignMediaPlaylistByPDT)(P,U),B=P.fragments[0].start):B=this.alignPlaylists(P,N.details)}N.details=P,this.levelLastLoaded=M,!this.startFragRequested&&(this.mainDetails||!P.live)&&this.setStartPosition(N.details,B),this.state===a.State.WAITING_TRACK&&!this.waitForCdnTuneIn(P)&&(this.state=a.State.IDLE),this.tick()},R._handleFragmentLoadProgress=function(O){var I,D=O.frag,C=O.part,P=O.payload,M=this.config,N=this.trackId,B=this.levels;if(!B){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+D.sn+" of level "+D.level+" will not be buffered");return}var U=B[N];console.assert(U,"Audio track is defined on fragment load progress");var F=U.details;console.assert(F,"Audio track details are defined on fragment load progress");var j=M.defaultAudioCodec||U.audioCodec||"mp4a.40.2",V=this.transmuxer;V||(V=this.transmuxer=new E.default(this.hls,u.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var G=this.initPTS[D.cc],Y=(I=D.initSegment)===null||I===void 0?void 0:I.data;if(G!==void 0){var X=!1,ie=C?C.index:-1,he=ie!==-1,de=new S.ChunkMetadata(D.level,D.sn,D.stats.chunkCount,P.byteLength,ie,he);V.push(P,Y,j,"",D,C,F.totalduration,X,de,G)}else{v.logger.log("Unknown video PTS for cc "+D.cc+", waiting for video PTS before demuxing audio frag "+D.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+N);var Ae=this.waitingData=this.waitingData||{frag:D,part:C,cache:new g.default,complete:!1},pe=Ae.cache;pe.push(new Uint8Array(P)),this.waitingVideoCC=this.videoTrackCC,this.state=a.State.WAITING_INIT_PTS}},R._handleFragmentLoadComplete=function(O){if(this.waitingData){this.waitingData.complete=!0;return}A.prototype._handleFragmentLoadComplete.call(this,O)},R.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},R.onBufferCreated=function(O,I){var D=I.tracks.audio;D&&(this.mediaBuffer=D.buffer),I.tracks.video&&(this.videoBuffer=I.tracks.video.buffer)},R.onFragBuffered=function(O,I){var D=I.frag,C=I.part;if(D.type===u.PlaylistLevelType.AUDIO){if(this.fragContextChanged(D)){this.warn("Fragment "+D.sn+(C?" p: "+C.index:"")+" of level "+D.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}D.sn!=="initSegment"&&(this.fragPrevious=D,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(D,C)}},R.onError=function(O,I){switch(I.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.AUDIO,I);break;case c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==a.State.ERROR&&this.state!==a.State.STOPPED&&(this.state=I.fatal?a.State.ERROR:a.State.IDLE,this.warn(I.details+" while loading frag, switching to "+this.state+" state"));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(I.parent==="audio"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var D=!0,C=this.getFwdBufferInfo(this.mediaBuffer,u.PlaylistLevelType.AUDIO);C&&C.len>.5&&(D=!this.reduceMaxBufferLength(C.len)),D&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,A.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},R.onBufferFlushed=function(O,I){var D=I.type;D===f.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},R._handleTransmuxComplete=function(O){var I,D="audio",C=this.hls,P=O.remuxResult,M=O.chunkMeta,N=this.getCurrentContext(M);if(!N){this.warn("The loading context changed while buffering fragment "+M.sn+" of level "+M.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(M.level);return}var B=N.frag,U=N.part,F=P.audio,j=P.text,V=P.id3,G=P.initSegment;if(!this.fragContextChanged(B)){if(this.state=a.State.PARSING,this.audioSwitch&&F&&this.completeAudioSwitch(),G!=null&&G.tracks&&(this._bufferInitSegment(G.tracks,B,M),C.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:D,tracks:G.tracks})),F){var Y=F.startPTS,X=F.endPTS,ie=F.startDTS,he=F.endDTS;U&&(U.elementaryStreams[f.ElementaryStreamTypes.AUDIO]={startPTS:Y,endPTS:X,startDTS:ie,endDTS:he}),B.setElementaryStreamInfo(f.ElementaryStreamTypes.AUDIO,Y,X,ie,he),this.bufferFragmentData(F,B,U,M)}if(V!=null&&(I=V.samples)!==null&&I!==void 0&&I.length){var de=y({frag:B,id:D},V);C.trigger(o.Events.FRAG_PARSING_METADATA,de)}if(j){var Ae=y({frag:B,id:D},j);C.trigger(o.Events.FRAG_PARSING_USERDATA,Ae)}}},R._bufferInitSegment=function(O,I,D){if(this.state===a.State.PARSING){O.video&&delete O.video;var C=O.audio;if(!!C){C.levelCodec=C.codec,C.id="audio",this.log("Init audio buffer, container:"+C.container+", codecs[parsed]=["+C.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,O);var P=C.initSegment;if(P!=null&&P.byteLength){var M={type:"audio",frag:I,part:null,chunkMeta:D,parent:I.type,data:P};this.hls.trigger(o.Events.BUFFER_APPENDING,M)}this.tick()}}},R.loadFragment=function(O,I,D){var C=this.fragmentTracker.getState(O);this.fragCurrent=O,(this.audioSwitch||C===h.FragmentState.NOT_LOADED||C===h.FragmentState.PARTIAL)&&(O.sn==="initSegment"?this._loadInitSegment(O):I.live&&!Object(n.isFiniteNumber)(this.initPTS[O.cc])?(this.log("Waiting for video PTS in continuity counter "+O.cc+" of live stream before loading audio fragment "+O.sn+" of level "+this.trackId),this.state=a.State.WAITING_INIT_PTS):(this.startFragRequested=!0,A.prototype.loadFragment.call(this,O,I,D)))},R.completeAudioSwitch=function(){var O=this.hls,I=this.media,D=this.trackId;I&&(this.log("Switching audio track : flushing all audio"),A.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,O.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:D})},L}(a.default);i.default=T},"./src/controller/audio-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/controller/base-playlist-controller.ts"),l=t("./src/types/loader.ts");function h(E,S){for(var _=0;_<S.length;_++){var m=S[_];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(E,m.key,m)}}function p(E,S,_){return S&&h(E.prototype,S),_&&h(E,_),E}function u(E,S){E.prototype=Object.create(S.prototype),E.prototype.constructor=E,f(E,S)}function f(E,S){return f=Object.setPrototypeOf||function(m,c){return m.__proto__=c,m},f(E,S)}var g=function(E){u(S,E);function S(m){var c;return c=E.call(this,m,"[audio-track-controller]")||this,c.tracks=[],c.groupId=null,c.tracksInGroup=[],c.trackId=-1,c.trackName="",c.selectDefaultTrack=!0,c.registerListeners(),c}var _=S.prototype;return _.registerListeners=function(){var c=this.hls;c.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(n.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var c=this.hls;c.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(n.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,E.prototype.destroy.call(this)},_.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},_.onManifestParsed=function(c,v){this.tracks=v.audioTracks||[]},_.onAudioTrackLoaded=function(c,v){var y=v.id,d=v.details,x=this.tracksInGroup[y];if(!x){this.warn("Invalid audio track id "+y);return}var b=x.details;x.details=v.details,this.log("audioTrack "+y+" loaded ["+d.startSN+"-"+d.endSN+"]"),y===this.trackId&&(this.retryCount=0,this.playlistLoaded(y,v,b))},_.onLevelLoading=function(c,v){this.switchLevel(v.level)},_.onLevelSwitching=function(c,v){this.switchLevel(v.level)},_.switchLevel=function(c){var v=this.hls.levels[c];if(!!(v!=null&&v.audioGroupIds)){var y=v.audioGroupIds[v.urlId];if(this.groupId!==y){this.groupId=y;var d=this.tracks.filter(function(b){return!y||b.groupId===y});this.selectDefaultTrack&&!d.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=d;var x={audioTracks:d};this.log("Updating audio tracks, "+d.length+' track(s) found in "'+y+'" group-id'),this.hls.trigger(n.Events.AUDIO_TRACKS_UPDATED,x),this.selectInitialTrack()}}},_.onError=function(c,v){E.prototype.onError.call(this,c,v),!(v.fatal||!v.context)&&v.context.type===l.PlaylistContextType.AUDIO_TRACK&&v.context.id===this.trackId&&v.context.groupId===this.groupId&&this.retryLoadingOrFail(v)},_.setAudioTrack=function(c){var v=this.tracksInGroup;if(c<0||c>=v.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var y=v[this.trackId];this.log("Now switching to audio-track index "+c);var d=v[c],x=d.id,b=d.groupId,T=b===void 0?"":b,A=d.name,L=d.type,R=d.url;if(this.trackId=c,this.trackName=A,this.selectDefaultTrack=!1,this.hls.trigger(n.Events.AUDIO_TRACK_SWITCHING,{id:x,groupId:T,name:A,type:L,url:R}),!(d.details&&!d.details.live)){var w=this.switchParams(d.url,y==null?void 0:y.details);this.loadPlaylist(w)}},_.selectInitialTrack=function(){var c=this.tracksInGroup;console.assert(c.length,"Initial audio track should be selected when tracks are known");var v=this.trackName,y=this.findTrackId(v)||this.findTrackId();y!==-1?this.setAudioTrack(y):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},_.findTrackId=function(c){for(var v=this.tracksInGroup,y=0;y<v.length;y++){var d=v[y];if((!this.selectDefaultTrack||d.default)&&(!c||c===d.name))return d.id}return-1},_.loadPlaylist=function(c){var v=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(v)){var y=v.id,d=v.groupId,x=v.url;if(c)try{x=c.addDirectives(x)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+y),this.clearTimer(),this.hls.trigger(n.Events.AUDIO_TRACK_LOADING,{url:x,id:y,groupId:d,deliveryDirectives:c||null})}},p(S,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1,this.setAudioTrack(c)}}]),S}(o.default);i.default=g},"./src/controller/base-playlist-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return p});var n=t("./src/polyfills/number.ts"),a=t("./src/types/level.ts"),o=t("./src/controller/level-helper.ts"),l=t("./src/utils/logger.ts"),h=t("./src/errors.ts"),p=function(){function u(g,E){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=l.logger.log.bind(l.logger,E+":"),this.warn=l.logger.warn.bind(l.logger,E+":"),this.hls=g}var f=u.prototype;return f.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},f.onError=function(E,S){S.fatal&&S.type===h.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},f.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},f.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},f.stopLoad=function(){this.canLoad=!1,this.clearTimer()},f.switchParams=function(E,S){var _=S==null?void 0:S.renditionReports;if(_)for(var m=0;m<_.length;m++){var c=_[m],v=""+c.URI;if(v===E.substr(-v.length)){var y=parseInt(c["LAST-MSN"]),d=parseInt(c["LAST-PART"]);if(S&&this.hls.config.lowLatencyMode){var x=Math.min(S.age-S.partTarget,S.targetduration);d!==void 0&&x>S.partTarget&&(d+=1)}if(Object(n.isFiniteNumber)(y))return new a.HlsUrlParameters(y,Object(n.isFiniteNumber)(d)?d:void 0,a.HlsSkip.No)}}},f.loadPlaylist=function(E){},f.shouldLoadTrack=function(E){return this.canLoad&&E&&!!E.url&&(!E.details||E.details.live)},f.playlistLoaded=function(E,S,_){var m=this,c=S.details,v=S.stats,y=v.loading.end?Math.max(0,self.performance.now()-v.loading.end):0;if(c.advancedDateTime=Date.now()-y,c.live||_!=null&&_.live){if(c.reloaded(_),_&&this.log("live playlist "+E+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),_&&c.fragments.length>0&&Object(o.mergeDetails)(_,c),!this.canLoad||!c.live)return;var d,x=void 0,b=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var T=this.hls.config.lowLatencyMode,A=c.lastPartSn,L=c.endSN,R=c.lastPartIndex,w=R!==-1,O=A===L,I=T?0:R;w?(x=O?L+1:A,b=O?I:R+1):x=L+1;var D=c.age,C=D+c.ageHeader,P=Math.min(C-c.partTarget,c.targetduration*1.5);if(P>0){if(_&&P>_.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+_.tuneInGoal+" to: "+P+" with playlist age: "+c.age),P=0;else{var M=Math.floor(P/c.targetduration);if(x+=M,b!==void 0){var N=Math.round(P%c.targetduration/c.partTarget);b+=N}this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+D.toFixed(2)+"s goal: "+P+" skip sn "+M+" to part "+b)}c.tuneInGoal=P}if(d=this.getDeliveryDirectives(c,S.deliveryDirectives,x,b),T||!O){this.loadPlaylist(d);return}}else d=this.getDeliveryDirectives(c,S.deliveryDirectives,x,b);var B=Object(o.computeReloadInterval)(c,v);x!==void 0&&c.canBlockReload&&(B-=c.partTarget||1),this.log("reload live playlist "+E+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return m.loadPlaylist(d)},B)}else this.clearTimer()},f.getDeliveryDirectives=function(E,S,_,m){var c=Object(a.getSkipValue)(E,_);return S!=null&&S.skip&&E.deltaUpdateFailed&&(_=S.msn,m=S.part,c=a.HlsSkip.No),new a.HlsUrlParameters(_,m,c)},f.retryLoadingOrFail=function(E){var S=this,_=this.hls.config,m=this.retryCount<_.levelLoadingMaxRetry;if(m){var c;if(this.retryCount++,E.details.indexOf("LoadTimeOut")>-1&&(c=E.context)!==null&&c!==void 0&&c.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+E.details+'"'),this.loadPlaylist();else{var v=Math.min(Math.pow(2,this.retryCount)*_.levelLoadingRetryDelay,_.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return S.loadPlaylist()},v),this.warn("retry playlist loading #"+this.retryCount+" in "+v+' ms after "'+E.details+'"')}}else this.warn('cannot recover from error "'+E.details+'"'),this.clearTimer(),E.fatal=!0;return m},u}()},"./src/controller/base-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"State",function(){return L}),t.d(i,"default",function(){return R});var n=t("./src/polyfills/number.ts"),a=t("./src/task-loop.ts"),o=t("./src/controller/fragment-tracker.ts"),l=t("./src/utils/buffer-helper.ts"),h=t("./src/utils/logger.ts"),p=t("./src/events.ts"),u=t("./src/errors.ts"),f=t("./src/types/transmuxer.ts"),g=t("./src/utils/mp4-tools.ts"),E=t("./src/utils/discontinuities.ts"),S=t("./src/controller/fragment-finders.ts"),_=t("./src/controller/level-helper.ts"),m=t("./src/loader/fragment-loader.ts"),c=t("./src/crypt/decrypter.ts"),v=t("./src/utils/time-ranges.ts"),y=t("./src/types/loader.ts");function d(w,O){for(var I=0;I<O.length;I++){var D=O[I];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(w,D.key,D)}}function x(w,O,I){return O&&d(w.prototype,O),I&&d(w,I),w}function b(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function T(w,O){w.prototype=Object.create(O.prototype),w.prototype.constructor=w,A(w,O)}function A(w,O){return A=Object.setPrototypeOf||function(D,C){return D.__proto__=C,D},A(w,O)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},R=function(w){T(O,w);function O(D,C,P){var M;return M=w.call(this)||this,M.hls=void 0,M.fragPrevious=null,M.fragCurrent=null,M.fragmentTracker=void 0,M.transmuxer=null,M._state=L.STOPPED,M.media=void 0,M.mediaBuffer=void 0,M.config=void 0,M.bitrateTest=!1,M.lastCurrentTime=0,M.nextLoadPosition=0,M.startPosition=0,M.loadedmetadata=!1,M.fragLoadError=0,M.retryDate=0,M.levels=null,M.fragmentLoader=void 0,M.levelLastLoaded=null,M.startFragRequested=!1,M.decrypter=void 0,M.initPTS=[],M.onvseeking=null,M.onvended=null,M.logPrefix="",M.log=void 0,M.warn=void 0,M.logPrefix=P,M.log=h.logger.log.bind(h.logger,P+":"),M.warn=h.logger.warn.bind(h.logger,P+":"),M.hls=D,M.fragmentLoader=new m.default(D.config),M.fragmentTracker=C,M.config=D.config,M.decrypter=new c.default(D,D.config),D.on(p.Events.KEY_LOADED,M.onKeyLoaded,b(M)),M}var I=O.prototype;return I.doTick=function(){this.onTickEnd()},I.onTickEnd=function(){},I.startLoad=function(C){},I.stopLoad=function(){this.fragmentLoader.abort();var C=this.fragCurrent;C&&this.fragmentTracker.removeFragment(C),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},I._streamEnded=function(C,P){var M=this.fragCurrent,N=this.fragmentTracker;if(!P.live&&M&&M.sn>=P.endSN&&!C.nextStart){var B=P.partList;if(B!=null&&B.length){var U=B[B.length-1],F=l.BufferHelper.isBuffered(this.media,U.start+U.duration/2);return F}var j=N.getState(M);return j===o.FragmentState.PARTIAL||j===o.FragmentState.OK}return!1},I.onMediaAttached=function(C,P){var M=this.media=this.mediaBuffer=P.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),M.addEventListener("seeking",this.onvseeking),M.addEventListener("ended",this.onvended);var N=this.config;this.levels&&N.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(N.startPosition)},I.onMediaDetaching=function(){var C=this.media;C!=null&&C.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),C&&(C.removeEventListener("seeking",this.onvseeking),C.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},I.onMediaSeeking=function(){var C=this.config,P=this.fragCurrent,M=this.media,N=this.mediaBuffer,B=this.state,U=M?M.currentTime:0,F=l.BufferHelper.bufferInfo(N||M,U,C.maxBufferHole);if(this.log("media seeking to "+(Object(n.isFiniteNumber)(U)?U.toFixed(3):U)+", state: "+B),B===L.ENDED)this.resetLoadingState();else if(P&&!F.len){var j=C.maxFragLookUpTolerance,V=P.start-j,G=P.start+P.duration+j,Y=U>G;(U<V||Y)&&(Y&&P.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),P.loader.abort()),this.resetLoadingState())}M&&(this.lastCurrentTime=U),!this.loadedmetadata&&!F.len&&(this.nextLoadPosition=this.startPosition=U),this.tickImmediate()},I.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},I.onKeyLoaded=function(C,P){if(!(this.state!==L.KEY_LOADING||P.frag!==this.fragCurrent||!this.levels)){this.state=L.IDLE;var M=this.levels[P.frag.level].details;M&&this.loadFragment(P.frag,M,P.frag.start)}},I.onHandlerDestroying=function(){this.stopLoad(),w.prototype.onHandlerDestroying.call(this)},I.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(p.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,w.prototype.onHandlerDestroyed.call(this)},I.loadKey=function(C,P){this.log("Loading key for "+C.sn+" of ["+P.startSN+"-"+P.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level),this.state=L.KEY_LOADING,this.fragCurrent=C,this.hls.trigger(p.Events.KEY_LOADING,{frag:C})},I.loadFragment=function(C,P,M){this._loadFragForPlayback(C,P,M)},I._loadFragForPlayback=function(C,P,M){var N=this,B=function(F){if(N.fragContextChanged(C)){N.warn("Fragment "+C.sn+(F.part?" p: "+F.part.index:"")+" of level "+C.level+" was dropped during download."),N.fragmentTracker.removeFragment(C);return}C.stats.chunkCount++,N._handleFragmentLoadProgress(F)};this._doFragLoad(C,P,M,B).then(function(U){if(!!U){N.fragLoadError=0;var F=N.state;if(N.fragContextChanged(C)){(F===L.FRAG_LOADING||F===L.BACKTRACKING||!N.fragCurrent&&F===L.PARSING)&&(N.fragmentTracker.removeFragment(C),N.state=L.IDLE);return}if("payload"in U&&(N.log("Loaded fragment "+C.sn+" of level "+C.level),N.hls.trigger(p.Events.FRAG_LOADED,U),N.state===L.BACKTRACKING)){N.fragmentTracker.backtrack(C,U),N.resetFragmentLoading(C);return}N._handleFragmentLoadComplete(U)}}).catch(function(U){N.warn(U),N.resetFragmentLoading(C)})},I.flushMainBuffer=function(C,P,M){if(M===void 0&&(M=null),!!(C-P)){var N={startOffset:C,endOffset:P,type:M};this.fragLoadError=0,this.hls.trigger(p.Events.BUFFER_FLUSHING,N)}},I._loadInitSegment=function(C){var P=this;this._doFragLoad(C).then(function(M){if(!M||P.fragContextChanged(C)||!P.levels)throw new Error("init load aborted");return M}).then(function(M){var N=P.hls,B=M.payload,U=C.decryptdata;if(B&&B.byteLength>0&&U&&U.key&&U.iv&&U.method==="AES-128"){var F=self.performance.now();return P.decrypter.webCryptoDecrypt(new Uint8Array(B),U.key.buffer,U.iv.buffer).then(function(j){var V=self.performance.now();return N.trigger(p.Events.FRAG_DECRYPTED,{frag:C,payload:j,stats:{tstart:F,tdecrypt:V}}),M.payload=j,M})}return M}).then(function(M){var N=P.fragCurrent,B=P.hls,U=P.levels;if(!U)throw new Error("init load aborted, missing levels");var F=U[C.level].details;console.assert(F,"Level details are defined when init segment is loaded");var j=C.stats;P.state=L.IDLE,P.fragLoadError=0,C.data=new Uint8Array(M.payload),j.parsing.start=j.buffering.start=self.performance.now(),j.parsing.end=j.buffering.end=self.performance.now(),M.frag===N&&B.trigger(p.Events.FRAG_BUFFERED,{stats:j,frag:N,part:null,id:C.type}),P.tick()}).catch(function(M){P.warn(M),P.resetFragmentLoading(C)})},I.fragContextChanged=function(C){var P=this.fragCurrent;return!C||!P||C.level!==P.level||C.sn!==P.sn||C.urlId!==P.urlId},I.fragBufferedComplete=function(C,P){var M=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+C.type+" sn: "+C.sn+(P?" part: "+P.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level+" "+v.default.toString(l.BufferHelper.getBuffered(M))),this.state=L.IDLE,this.tick()},I._handleFragmentLoadComplete=function(C){var P=this.transmuxer;if(!!P){var M=C.frag,N=C.part,B=C.partsLoaded,U=!B||B.length===0||B.some(function(j){return!j}),F=new f.ChunkMetadata(M.level,M.sn,M.stats.chunkCount+1,0,N?N.index:-1,!U);P.flush(F)}},I._handleFragmentLoadProgress=function(C){},I._doFragLoad=function(C,P,M,N){var B=this;if(M===void 0&&(M=null),!this.levels)throw new Error("frag load aborted, missing levels");if(M=Math.max(C.start,M||0),this.config.lowLatencyMode&&P){var U=P.partList;if(U&&N){M>C.end&&P.fragmentHint&&(C=P.fragmentHint);var F=this.getNextPart(U,C,M);if(F>-1){var j=U[F];return this.log("Loading part sn: "+C.sn+" p: "+j.index+" cc: "+C.cc+" of playlist ["+P.startSN+"-"+P.endSN+"] parts [0-"+F+"-"+(U.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),this.nextLoadPosition=j.start+j.duration,this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:C,part:U[F],targetBufferTime:M}),this.doFragPartsLoad(C,U,F,N).catch(function(V){return B.handleFragLoadError(V)})}else if(!C.url||this.loadedEndOfParts(U,M))return Promise.resolve(null)}}return this.log("Loading fragment "+C.sn+" cc: "+C.cc+" "+(P?"of ["+P.startSN+"-"+P.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),Object(n.isFiniteNumber)(C.sn)&&!this.bitrateTest&&(this.nextLoadPosition=C.start+C.duration),this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:C,targetBufferTime:M}),this.fragmentLoader.load(C,N).catch(function(V){return B.handleFragLoadError(V)})},I.doFragPartsLoad=function(C,P,M,N){var B=this;return new Promise(function(U,F){var j=[],V=function G(Y){var X=P[Y];B.fragmentLoader.loadPart(C,X,N).then(function(ie){j[X.index]=ie;var he=ie.part;B.hls.trigger(p.Events.FRAG_LOADED,ie);var de=P[Y+1];if(de&&de.fragment===C)G(Y+1);else return U({frag:C,part:he,partsLoaded:j})}).catch(F)};V(M)})},I.handleFragLoadError=function(C){var P=C.data;return P&&P.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(P.frag,P.part):this.hls.trigger(p.Events.ERROR,P),null},I._handleTransmuxerFlush=function(C){var P=this.getCurrentContext(C);if(!P||this.state!==L.PARSING){this.fragCurrent||(this.state=L.IDLE);return}var M=P.frag,N=P.part,B=P.level,U=self.performance.now();M.stats.parsing.end=U,N&&(N.stats.parsing.end=U),this.updateLevelTiming(M,N,B,C.partial)},I.getCurrentContext=function(C){var P=this.levels,M=C.level,N=C.sn,B=C.part;if(!P||!P[M])return this.warn("Levels object was unset while buffering fragment "+N+" of level "+M+". The current chunk will not be buffered."),null;var U=P[M],F=B>-1?Object(_.getPartWith)(U,N,B):null,j=F?F.fragment:Object(_.getFragmentWithSN)(U,N,this.fragCurrent);return j?{frag:j,part:F,level:U}:null},I.bufferFragmentData=function(C,P,M,N){if(!(!C||this.state!==L.PARSING)){var B=C.data1,U=C.data2,F=B;if(B&&U&&(F=Object(g.appendUint8Array)(B,U)),!(!F||!F.length)){var j={type:C.type,frag:P,part:M,chunkMeta:N,parent:P.type,data:F};this.hls.trigger(p.Events.BUFFER_APPENDING,j),C.dropped&&C.independent&&!M&&this.flushBufferGap(P)}}},I.flushBufferGap=function(C){var P=this.media;if(!!P){if(!l.BufferHelper.isBuffered(P,P.currentTime)){this.flushMainBuffer(0,C.start);return}var M=P.currentTime,N=l.BufferHelper.bufferInfo(P,M,0),B=C.duration,U=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),F=Math.max(Math.min(C.start-U,N.end-U),M+U);C.start-F>U&&this.flushMainBuffer(F,C.start)}},I.getFwdBufferInfo=function(C,P){var M=this.config,N=this.getLoadPosition();if(!Object(n.isFiniteNumber)(N))return null;var B=l.BufferHelper.bufferInfo(C,N,M.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var U=this.fragmentTracker.getBufferedFrag(N,P);if(U&&B.nextStart<U.end)return l.BufferHelper.bufferInfo(C,N,Math.max(B.nextStart,M.maxBufferHole))}return B},I.getMaxBufferLength=function(C){var P=this.config,M;return C?M=Math.max(8*P.maxBufferSize/C,P.maxBufferLength):M=P.maxBufferLength,Math.min(M,P.maxMaxBufferLength)},I.reduceMaxBufferLength=function(C){var P=this.config,M=C||P.maxBufferLength;return P.maxMaxBufferLength>=M?(P.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+P.maxMaxBufferLength+"s"),!0):!1},I.getNextFragment=function(C,P){var M,N,B=P.fragments,U=B.length;if(!U)return null;var F=this.config,j=B[0].start,V;if(P.live){var G=F.initialLiveManifestSize;if(U<G)return this.warn("Not enough fragments to start playback (have: "+U+", need: "+G+")"),null;!P.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(V=this.getInitialLiveFragment(P,B),this.startPosition=V?this.hls.liveSyncPosition||V.start:C)}else C<=j&&(V=B[0]);if(!V){var Y=F.lowLatencyMode?P.partEnd:P.fragmentEnd;V=this.getFragmentAtPosition(C,Y,P)}return(M=V)!==null&&M!==void 0&&M.initSegment&&!((N=V)!==null&&N!==void 0&&N.initSegment.data)&&!this.bitrateTest&&(V=V.initSegment),V},I.getNextPart=function(C,P,M){for(var N=-1,B=!1,U=!0,F=0,j=C.length;F<j;F++){var V=C[F];if(U=U&&!V.independent,N>-1&&M<V.start)break;var G=V.loaded;!G&&(B||V.independent||U)&&V.fragment===P&&(N=F),B=G}return N},I.loadedEndOfParts=function(C,P){var M=C[C.length-1];return M&&P>M.start&&M.loaded},I.getInitialLiveFragment=function(C,P){var M=this.fragPrevious,N=null;if(M){if(C.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+M.programDateTime),N=Object(S.findFragmentByPDT)(P,M.endProgramDateTime,this.config.maxFragLookUpTolerance)),!N){var B=M.sn+1;if(B>=C.startSN&&B<=C.endSN){var U=P[B-C.startSN];M.cc===U.cc&&(N=U,this.log("Live playlist, switching playlist, load frag with next SN: "+N.sn))}N||(N=Object(S.findFragWithCC)(P,M.cc),N&&this.log("Live playlist, switching playlist, load frag with same CC: "+N.sn))}}else{var F=this.hls.liveSyncPosition;F!==null&&(N=this.getFragmentAtPosition(F,this.bitrateTest?C.fragmentEnd:C.edge,C))}return N},I.getFragmentAtPosition=function(C,P,M){var N=this.config,B=this.fragPrevious,U=M.fragments,F=M.endSN,j=M.fragmentHint,V=N.maxFragLookUpTolerance,G=!!(N.lowLatencyMode&&M.partList&&j);G&&j&&!this.bitrateTest&&(U=U.concat(j),F=j.sn);var Y;if(C<P){var X=C>P-V?0:V;Y=Object(S.findFragmentByPTS)(B,U,C,X)}else Y=U[U.length-1];if(Y){var ie=Y.sn-M.startSN,he=B&&Y.level===B.level,de=U[ie+1],Ae=this.fragmentTracker.getState(Y);if(Ae===o.FragmentState.BACKTRACKED){Y=null;for(var pe=ie;U[pe]&&this.fragmentTracker.getState(U[pe])===o.FragmentState.BACKTRACKED;)B?Y=U[pe--]:Y=U[--pe];Y||(Y=de)}else B&&Y.sn===B.sn&&!G&&he&&(Y.sn<F&&this.fragmentTracker.getState(de)!==o.FragmentState.OK?(this.log("SN "+Y.sn+" just loaded, load next one: "+de.sn),Y=de):Y=null)}return Y},I.synchronizeToLiveEdge=function(C){var P=this.config,M=this.media;if(!!M){var N=this.hls.liveSyncPosition,B=M.currentTime,U=C.fragments[0].start,F=C.edge,j=B>=U-P.maxFragLookUpTolerance&&B<=F;if(N!==null&&M.duration>N&&(B<N||!j)){var V=P.liveMaxLatencyDuration!==void 0?P.liveMaxLatencyDuration:P.liveMaxLatencyDurationCount*C.targetduration;(!j&&M.readyState<4||B<F-V)&&(this.loadedmetadata||(this.nextLoadPosition=N),M.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+F+", reset currentTime to : "+N.toFixed(3)),M.currentTime=N))}}},I.alignPlaylists=function(C,P){var M=this.levels,N=this.levelLastLoaded,B=this.fragPrevious,U=N!==null?M[N]:null,F=C.fragments.length;if(!F)return this.warn("No fragments in live playlist"),0;var j=C.fragments[0].start,V=!P,G=C.alignedSliding&&Object(n.isFiniteNumber)(j);if(V||!G&&!j){Object(E.alignStream)(B,U,C);var Y=C.fragments[0].start;return this.log("Live playlist sliding: "+Y.toFixed(2)+" start-sn: "+(P?P.startSN:"na")+"->"+C.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+F),Y}return j},I.waitForCdnTuneIn=function(C){var P=3;return C.live&&C.canBlockReload&&C.tuneInGoal>Math.max(C.partHoldBack,C.partTarget*P)},I.setStartPosition=function(C,P){var M=this.startPosition;if(M<P&&(M=-1),M===-1||this.lastCurrentTime===-1){var N=C.startTimeOffset;Object(n.isFiniteNumber)(N)?(M=P+N,N<0&&(M+=C.totalduration),M=Math.min(Math.max(P,M),P+C.totalduration),this.log("Start time offset "+N+" found in playlist, adjust startPosition to "+M),this.startPosition=M):C.live?M=this.hls.liveSyncPosition||P:this.startPosition=M=0,this.lastCurrentTime=M}this.nextLoadPosition=M},I.getLoadPosition=function(){var C=this.media,P=0;return this.loadedmetadata&&C?P=C.currentTime:this.nextLoadPosition&&(P=this.nextLoadPosition),P},I.handleFragLoadAborted=function(C,P){this.transmuxer&&C.sn!=="initSegment"&&C.stats.aborted&&(this.warn("Fragment "+C.sn+(P?" part"+P.index:"")+" of level "+C.level+" was aborted"),this.resetFragmentLoading(C))},I.resetFragmentLoading=function(C){(!this.fragCurrent||!this.fragContextChanged(C))&&(this.state=L.IDLE)},I.onFragmentOrKeyLoadError=function(C,P){if(!P.fatal){var M=P.frag;if(!(!M||M.type!==C)){var N=this.fragCurrent;console.assert(N&&M.sn===N.sn&&M.level===N.level&&M.urlId===N.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(M.level))return;var U=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+M.sn+" of "+C+" "+M.level+" failed to load, retrying in "+U+"ms"),this.retryDate=self.performance.now()+U,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else P.levelRetry?(C===y.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(h.logger.error(P.details+" reaches max retry, redispatch as fatal ..."),P.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},I.afterBufferFlushed=function(C,P,M){if(!!C){var N=l.BufferHelper.getBuffered(C);this.fragmentTracker.detectEvictedFragments(P,N,M),this.state===L.ENDED&&this.resetLoadingState()}},I.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},I.resetLiveStartWhenNotLoaded=function(C){if(!this.loadedmetadata){this.startFragRequested=!1;var P=this.levels?this.levels[C].details:null;if(P!=null&&P.live)return this.startPosition=-1,this.setStartPosition(P,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},I.updateLevelTiming=function(C,P,M,N){var B=this,U=M.details;console.assert(!!U,"level.details must be defined");var F=Object.keys(C.elementaryStreams).reduce(function(j,V){var G=C.elementaryStreams[V];if(G){var Y=G.endPTS-G.startPTS;if(Y<=0)return B.warn("Could not parse fragment "+C.sn+" "+V+" duration reliably ("+Y+") resetting transmuxer to fallback to playlist timing"),B.resetTransmuxer(),j||!1;var X=N?0:Object(_.updateFragPTSDTS)(U,C,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return B.hls.trigger(p.Events.LEVEL_PTS_UPDATED,{details:U,level:M,drift:X,type:V,frag:C,start:G.startPTS,end:G.endPTS}),!0}return j},!1);F?(this.state=L.PARSED,this.hls.trigger(p.Events.FRAG_PARSED,{frag:C,part:P})):this.resetLoadingState()},I.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},x(O,[{key:"state",get:function(){return this._state},set:function(C){var P=this._state;P!==C&&(this._state=C,this.log(P+"->"+C))}}]),O}(a.default)},"./src/controller/buffer-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),l=t("./src/errors.ts"),h=t("./src/utils/buffer-helper.ts"),p=t("./src/utils/mediasource-helper.ts"),u=t("./src/loader/fragment.ts"),f=t("./src/controller/buffer-operation-queue.ts"),g=Object(p.getMediaSource)(),E=/([ha]vc.)(?:\.[^.,]+)+/,S=function(){function _(c){var v=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var y=v.hls,d=v.media,x=v.mediaSource;o.logger.log("[buffer-controller]: Media source opened"),d&&(v.updateMediaElementDuration(),y.trigger(a.Events.MEDIA_ATTACHED,{media:d})),x&&x.removeEventListener("sourceopen",v._onMediaSourceOpen),v.checkPendingTracks()},this._onMediaSourceClose=function(){o.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){o.logger.log("[buffer-controller]: Media source ended")},this.hls=c,this._initSourceBuffer(),this.registerListeners()}var m=_.prototype;return m.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},m.destroy=function(){this.unregisterListeners(),this.details=null},m.registerListeners=function(){var v=this.hls;v.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(a.Events.BUFFER_RESET,this.onBufferReset,this),v.on(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),v.on(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.on(a.Events.BUFFER_EOS,this.onBufferEos,this),v.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),v.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),v.on(a.Events.FRAG_PARSED,this.onFragParsed,this),v.on(a.Events.FRAG_CHANGED,this.onFragChanged,this)},m.unregisterListeners=function(){var v=this.hls;v.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(a.Events.BUFFER_RESET,this.onBufferReset,this),v.off(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),v.off(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.off(a.Events.BUFFER_EOS,this.onBufferEos,this),v.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),v.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),v.off(a.Events.FRAG_PARSED,this.onFragParsed,this),v.off(a.Events.FRAG_CHANGED,this.onFragChanged,this)},m._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new f.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},m.onManifestParsed=function(v,y){var d=2;(y.audio&&!y.video||!y.altAudio)&&(d=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=d,this.details=null,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},m.onMediaAttaching=function(v,y){var d=this.media=y.media;if(d&&g){var x=this.mediaSource=new g;x.addEventListener("sourceopen",this._onMediaSourceOpen),x.addEventListener("sourceended",this._onMediaSourceEnded),x.addEventListener("sourceclose",this._onMediaSourceClose),d.src=self.URL.createObjectURL(x),this._objectUrl=d.src}},m.onMediaDetaching=function(){var v=this.media,y=this.mediaSource,d=this._objectUrl;if(y){if(o.logger.log("[buffer-controller]: media source detaching"),y.readyState==="open")try{y.endOfStream()}catch(x){o.logger.warn("[buffer-controller]: onMediaDetaching: "+x.message+" while calling endOfStream")}this.onBufferReset(),y.removeEventListener("sourceopen",this._onMediaSourceOpen),y.removeEventListener("sourceended",this._onMediaSourceEnded),y.removeEventListener("sourceclose",this._onMediaSourceClose),v&&(d&&self.URL.revokeObjectURL(d),v.src===d?(v.removeAttribute("src"),v.load()):o.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(a.Events.MEDIA_DETACHED,void 0)},m.onBufferReset=function(){var v=this;this.getSourceBufferTypes().forEach(function(y){var d=v.sourceBuffer[y];try{d&&(v.removeBufferListeners(y),v.mediaSource&&v.mediaSource.removeSourceBuffer(d),v.sourceBuffer[y]=void 0)}catch(x){o.logger.warn("[buffer-controller]: Failed to reset the "+y+" buffer",x)}}),this._initSourceBuffer()},m.onBufferCodecs=function(v,y){var d=this,x=this.getSourceBufferTypes().length;Object.keys(y).forEach(function(b){if(x){var T=d.tracks[b];if(T&&typeof T.buffer.changeType=="function"){var A=y[b],L=A.codec,R=A.levelCodec,w=A.container,O=(T.levelCodec||T.codec).replace(E,"$1"),I=(R||L).replace(E,"$1");if(O!==I){var D=w+";codecs="+(R||L);d.appendChangeType(b,D)}}}else d.pendingTracks[b]=y[b]}),!x&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},m.appendChangeType=function(v,y){var d=this,x=this.operationQueue,b={execute:function(){var A=d.sourceBuffer[v];A&&(o.logger.log("[buffer-controller]: changing "+v+" sourceBuffer type to "+y),A.changeType(y)),x.shiftAndExecuteNext(v)},onStart:function(){},onComplete:function(){},onError:function(A){o.logger.warn("[buffer-controller]: Failed to change "+v+" SourceBuffer type",A)}};x.append(b,v)},m.onBufferAppending=function(v,y){var d=this,x=this.hls,b=this.operationQueue,T=this.tracks,A=y.data,L=y.type,R=y.frag,w=y.part,O=y.chunkMeta,I=O.buffering[L],D=self.performance.now();I.start=D;var C=R.stats.buffering,P=w?w.stats.buffering:null;C.start===0&&(C.start=D),P&&P.start===0&&(P.start=D);var M=T.audio,N=L==="audio"&&O.id===1&&(M==null?void 0:M.container)==="audio/mpeg",B={execute:function(){if(I.executeStart=self.performance.now(),N){var F=d.sourceBuffer[L];if(F){var j=R.start-F.timestampOffset;Math.abs(j)>=.1&&(o.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+R.start+" (delta: "+j+") sn: "+R.sn+")"),F.timestampOffset=R.start)}}d.appendExecutor(A,L)},onStart:function(){},onComplete:function(){var F=self.performance.now();I.executeEnd=I.end=F,C.first===0&&(C.first=F),P&&P.first===0&&(P.first=F);var j=d.sourceBuffer,V={};for(var G in j)V[G]=h.BufferHelper.getBuffered(j[G]);d.appendError=0,d.hls.trigger(a.Events.BUFFER_APPENDED,{type:L,frag:R,part:w,chunkMeta:O,parent:R.type,timeRanges:V})},onError:function(F){o.logger.error("[buffer-controller]: Error encountered while trying to append to the "+L+" SourceBuffer",F);var j={type:l.ErrorTypes.MEDIA_ERROR,parent:R.type,details:l.ErrorDetails.BUFFER_APPEND_ERROR,err:F,fatal:!1};F.code===DOMException.QUOTA_EXCEEDED_ERR?j.details=l.ErrorDetails.BUFFER_FULL_ERROR:(d.appendError++,j.details=l.ErrorDetails.BUFFER_APPEND_ERROR,d.appendError>x.config.appendErrorMaxRetry&&(o.logger.error("[buffer-controller]: Failed "+x.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),j.fatal=!0)),x.trigger(a.Events.ERROR,j)}};b.append(B,L)},m.onBufferFlushing=function(v,y){var d=this,x=this.operationQueue,b=function(A){return{execute:d.removeExecutor.bind(d,A,y.startOffset,y.endOffset),onStart:function(){},onComplete:function(){d.hls.trigger(a.Events.BUFFER_FLUSHED,{type:A})},onError:function(R){o.logger.warn("[buffer-controller]: Failed to remove from "+A+" SourceBuffer",R)}}};y.type?x.append(b(y.type),y.type):this.getSourceBufferTypes().forEach(function(T){x.append(b(T),T)})},m.onFragParsed=function(v,y){var d=this,x=y.frag,b=y.part,T=[],A=b?b.elementaryStreams:x.elementaryStreams;A[u.ElementaryStreamTypes.AUDIOVIDEO]?T.push("audiovideo"):(A[u.ElementaryStreamTypes.AUDIO]&&T.push("audio"),A[u.ElementaryStreamTypes.VIDEO]&&T.push("video"));var L=function(){var w=self.performance.now();x.stats.buffering.end=w,b&&(b.stats.buffering.end=w);var O=b?b.stats:x.stats;d.hls.trigger(a.Events.FRAG_BUFFERED,{frag:x,part:b,stats:O,id:x.type})};T.length===0&&o.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+x.type+" level: "+x.level+" sn: "+x.sn),this.blockBuffers(L,T)},m.onFragChanged=function(v,y){this.flushBackBuffer()},m.onBufferEos=function(v,y){var d=this,x=this.getSourceBufferTypes().reduce(function(b,T){var A=d.sourceBuffer[T];return(!y.type||y.type===T)&&A&&!A.ended&&(A.ended=!0,o.logger.log("[buffer-controller]: "+T+" sourceBuffer now EOS")),b&&!!(!A||A.ended)},!0);x&&this.blockBuffers(function(){var b=d.mediaSource;!b||b.readyState!=="open"||b.endOfStream()})},m.onLevelUpdated=function(v,y){var d=y.details;!d.fragments.length||(this.details=d,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},m.flushBackBuffer=function(){var v=this.hls,y=this.details,d=this.media,x=this.sourceBuffer;if(!(!d||y===null)){var b=this.getSourceBufferTypes();if(!!b.length){var T=y.live&&v.config.liveBackBufferLength!==null?v.config.liveBackBufferLength:v.config.backBufferLength;if(!(!Object(n.isFiniteNumber)(T)||T<0)){var A=d.currentTime,L=y.levelTargetDuration,R=Math.max(T,L),w=Math.floor(A/L)*L-R;b.forEach(function(O){var I=x[O];if(I){var D=h.BufferHelper.getBuffered(I);D.length>0&&w>D.start(0)&&(v.trigger(a.Events.BACK_BUFFER_REACHED,{bufferEnd:w}),y.live&&v.trigger(a.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:w}),v.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:w,type:O}))}})}}}},m.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var v=this.details,y=this.hls,d=this.media,x=this.mediaSource,b=v.fragments[0].start+v.totalduration,T=d.duration,A=Object(n.isFiniteNumber)(x.duration)?x.duration:0;v.live&&y.config.liveDurationInfinity?(o.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),x.duration=1/0,this.updateSeekableRange(v)):(b>A&&b>T||!Object(n.isFiniteNumber)(T))&&(o.logger.log("[buffer-controller]: Updating Media Source duration to "+b.toFixed(3)),x.duration=b)}},m.updateSeekableRange=function(v){var y=this.mediaSource,d=v.fragments,x=d.length;if(x&&v.live&&y!==null&&y!==void 0&&y.setLiveSeekableRange){var b=Math.max(0,d[0].start),T=Math.max(b,b+v.totalduration);y.setLiveSeekableRange(b,T)}},m.checkPendingTracks=function(){var v=this.bufferCodecEventsExpected,y=this.operationQueue,d=this.pendingTracks,x=Object.keys(d).length;if(x&&!v||x===2){this.createSourceBuffers(d),this.pendingTracks={};var b=this.getSourceBufferTypes();if(b.length===0){this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}b.forEach(function(T){y.executeNext(T)})}},m.createSourceBuffers=function(v){var y=this.sourceBuffer,d=this.mediaSource;if(!d)throw Error("createSourceBuffers called when mediaSource was null");var x=0;for(var b in v)if(!y[b]){var T=v[b];if(!T)throw Error("source buffer exists for track "+b+", however track does not");var A=T.levelCodec||T.codec,L=T.container+";codecs="+A;o.logger.log("[buffer-controller]: creating sourceBuffer("+L+")");try{var R=y[b]=d.addSourceBuffer(L),w=b;this.addBufferListener(w,"updatestart",this._onSBUpdateStart),this.addBufferListener(w,"updateend",this._onSBUpdateEnd),this.addBufferListener(w,"error",this._onSBUpdateError),this.tracks[b]={buffer:R,codec:A,container:T.container,levelCodec:T.levelCodec,id:T.id},x++}catch(O){o.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+O.message),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:O,mimeType:L})}}x&&this.hls.trigger(a.Events.BUFFER_CREATED,{tracks:this.tracks})},m._onSBUpdateStart=function(v){var y=this.operationQueue,d=y.current(v);d.onStart()},m._onSBUpdateEnd=function(v){var y=this.operationQueue,d=y.current(v);d.onComplete(),y.shiftAndExecuteNext(v)},m._onSBUpdateError=function(v,y){o.logger.error("[buffer-controller]: "+v+" SourceBuffer error",y),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var d=this.operationQueue.current(v);d&&d.onError(y)},m.removeExecutor=function(v,y,d){var x=this.media,b=this.mediaSource,T=this.operationQueue,A=this.sourceBuffer,L=A[v];if(!x||!b||!L){o.logger.warn("[buffer-controller]: Attempting to remove from the "+v+" SourceBuffer, but it does not exist"),T.shiftAndExecuteNext(v);return}var R=Object(n.isFiniteNumber)(x.duration)?x.duration:1/0,w=Object(n.isFiniteNumber)(b.duration)?b.duration:1/0,O=Math.max(0,y),I=Math.min(d,R,w);I>O?(o.logger.log("[buffer-controller]: Removing ["+O+","+I+"] from the "+v+" SourceBuffer"),console.assert(!L.updating,v+" sourceBuffer must not be updating"),L.remove(O,I)):T.shiftAndExecuteNext(v)},m.appendExecutor=function(v,y){var d=this.operationQueue,x=this.sourceBuffer,b=x[y];if(!b){o.logger.warn("[buffer-controller]: Attempting to append to the "+y+" SourceBuffer, but it does not exist"),d.shiftAndExecuteNext(y);return}b.ended=!1,console.assert(!b.updating,y+" sourceBuffer must not be updating"),b.appendBuffer(v)},m.blockBuffers=function(v,y){var d=this;if(y===void 0&&(y=this.getSourceBufferTypes()),!y.length){o.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(v);return}var x=this.operationQueue,b=y.map(function(T){return x.appendBlocker(T)});Promise.all(b).then(function(){v(),y.forEach(function(T){var A=d.sourceBuffer[T];(!A||!A.updating)&&x.shiftAndExecuteNext(T)})})},m.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},m.addBufferListener=function(v,y,d){var x=this.sourceBuffer[v];if(!!x){var b=d.bind(this,v);this.listeners[v].push({event:y,listener:b}),x.addEventListener(y,b)}},m.removeBufferListeners=function(v){var y=this.sourceBuffer[v];!y||this.listeners[v].forEach(function(d){y.removeEventListener(d.event,d.listener)})},_}()},"./src/controller/buffer-operation-queue.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return a});var n=t("./src/utils/logger.ts"),a=function(){function o(h){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=h}var l=o.prototype;return l.append=function(p,u){var f=this.queues[u];f.push(p),f.length===1&&this.buffers[u]&&this.executeNext(u)},l.insertAbort=function(p,u){var f=this.queues[u];f.unshift(p),this.executeNext(u)},l.appendBlocker=function(p){var u,f=new Promise(function(E){u=E}),g={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(g,p),f},l.executeNext=function(p){var u=this.buffers,f=this.queues,g=u[p],E=f[p];if(E.length){var S=E[0];try{S.execute()}catch(_){n.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),S.onError(_),(!g||!g.updating)&&(E.shift(),this.executeNext(p))}}},l.shiftAndExecuteNext=function(p){this.queues[p].shift(),this.executeNext(p)},l.current=function(p){return this.queues[p][0]},o}()},"./src/controller/cap-level-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts");function a(h,p){for(var u=0;u<p.length;u++){var f=p[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(h,f.key,f)}}function o(h,p,u){return p&&a(h.prototype,p),u&&a(h,u),h}var l=function(){function h(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var p=h.prototype;return p.setStreamController=function(f){this.streamController=f},p.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},p.registerListeners=function(){var f=this.hls;f.on(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),f.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.unregisterListener=function(){var f=this.hls;f.off(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),f.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.onFpsDropLevelCapping=function(f,g){h.isLevelAllowed(g.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(g.droppedLevel)},p.onMediaAttaching=function(f,g){this.media=g.media instanceof HTMLVideoElement?g.media:null},p.onManifestParsed=function(f,g){var E=this.hls;this.restrictedLevels=[],this.firstLevel=g.firstLevel,E.config.capLevelToPlayerSize&&g.video&&this.startCapping()},p.onBufferCodecs=function(f,g){var E=this.hls;E.config.capLevelToPlayerSize&&g.video&&this.startCapping()},p.onMediaDetaching=function(){this.stopCapping()},p.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var f=this.hls.levels;if(f.length){var g=this.hls;g.autoLevelCapping=this.getMaxLevel(f.length-1),g.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=g.autoLevelCapping}}},p.getMaxLevel=function(f){var g=this,E=this.hls.levels;if(!E.length)return-1;var S=E.filter(function(_,m){return h.isLevelAllowed(m,g.restrictedLevels)&&m<=f});return this.clientRect=null,h.getMaxLevelByMediaSize(S,this.mediaWidth,this.mediaHeight)},p.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},p.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},p.getDimensions=function(){if(this.clientRect)return this.clientRect;var f=this.media,g={width:0,height:0};if(f){var E=f.getBoundingClientRect();g.width=E.width,g.height=E.height,!g.width&&!g.height&&(g.width=E.right-E.left||f.width||0,g.height=E.bottom-E.top||f.height||0)}return this.clientRect=g,g},h.isLevelAllowed=function(f,g){return g===void 0&&(g=[]),g.indexOf(f)===-1},h.getMaxLevelByMediaSize=function(f,g,E){if(!f||!f.length)return-1;for(var S=function(y,d){return d?y.width!==d.width||y.height!==d.height:!0},_=f.length-1,m=0;m<f.length;m+=1){var c=f[m];if((c.width>=g||c.height>=E)&&S(c,f[m+1])){_=m;break}}return _},o(h,[{key:"mediaWidth",get:function(){return this.getDimensions().width*h.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*h.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var f=1;try{f=self.devicePixelRatio}catch(g){}return f}}]),h}();i.default=l},"./src/controller/cmcd-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S});var n=t("./src/events.ts"),a=t("./src/types/cmcd.ts"),o=t("./src/utils/buffer-helper.ts"),l=t("./src/utils/logger.ts");function h(_,m){for(var c=0;c<m.length;c++){var v=m[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(_,v.key,v)}}function p(_,m,c){return m&&h(_.prototype,m),c&&h(_,c),_}function u(_,m){var c=typeof Symbol!="undefined"&&_[Symbol.iterator]||_["@@iterator"];if(c)return(c=c.call(_)).next.bind(c);if(Array.isArray(_)||(c=f(_))||m&&_&&typeof _.length=="number"){c&&(_=c);var v=0;return function(){return v>=_.length?{done:!0}:{done:!1,value:_[v++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f(_,m){if(!!_){if(typeof _=="string")return g(_,m);var c=Object.prototype.toString.call(_).slice(8,-1);if(c==="Object"&&_.constructor&&(c=_.constructor.name),c==="Map"||c==="Set")return Array.from(_);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return g(_,m)}}function g(_,m){(m==null||m>_.length)&&(m=_.length);for(var c=0,v=new Array(m);c<m;c++)v[c]=_[c];return v}function E(){return E=Object.assign||function(_){for(var m=1;m<arguments.length;m++){var c=arguments[m];for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(_[v]=c[v])}return _},E.apply(this,arguments)}var S=function(){function _(c){var v=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){v.initialized&&(v.starved=!0),v.buffering=!0},this.onPlaying=function(){v.initialized||(v.initialized=!0),v.buffering=!1},this.applyPlaylistData=function(x){try{v.apply(x,{ot:a.CMCDObjectType.MANIFEST,su:!v.initialized})}catch(b){l.logger.warn("Could not generate manifest CMCD data.",b)}},this.applyFragmentData=function(x){try{var b=x.frag,T=v.hls.levels[b.level],A=v.getObjectType(b),L={d:b.duration*1e3,ot:A};(A===a.CMCDObjectType.VIDEO||A===a.CMCDObjectType.AUDIO||A==a.CMCDObjectType.MUXED)&&(L.br=T.bitrate/1e3,L.tb=v.getTopBandwidth(A)/1e3,L.bl=v.getBufferLength(A)),v.apply(x,L)}catch(R){l.logger.warn("Could not generate segment CMCD data.",R)}},this.hls=c;var y=this.config=c.config,d=y.cmcd;d!=null&&(y.pLoader=this.createPlaylistLoader(),y.fLoader=this.createFragmentLoader(),this.sid=d.sessionId||_.uuid(),this.cid=d.contentId,this.useHeaders=d.useHeaders===!0,this.registerListeners())}var m=_.prototype;return m.registerListeners=function(){var v=this.hls;v.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),v.on(n.Events.BUFFER_CREATED,this.onBufferCreated,this)},m.unregisterListeners=function(){var v=this.hls;v.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),v.off(n.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},m.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},m.onMediaAttached=function(v,y){this.media=y.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},m.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},m.onBufferCreated=function(v,y){var d,x;this.audioBuffer=(d=y.tracks.audio)===null||d===void 0?void 0:d.buffer,this.videoBuffer=(x=y.tracks.video)===null||x===void 0?void 0:x.buffer},m.createData=function(){var v;return{v:a.CMCDVersion,sf:a.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(v=this.media)===null||v===void 0?void 0:v.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},m.apply=function(v,y){y===void 0&&(y={}),E(y,this.createData());var d=y.ot===a.CMCDObjectType.INIT||y.ot===a.CMCDObjectType.VIDEO||y.ot===a.CMCDObjectType.MUXED;if(this.starved&&d&&(y.bs=!0,y.su=!0,this.starved=!1),y.su==null&&(y.su=this.buffering),this.useHeaders){var x=_.toHeaders(y);if(!Object.keys(x).length)return;v.headers||(v.headers={}),E(v.headers,x)}else{var b=_.toQuery(y);if(!b)return;v.url=_.appendQueryToUri(v.url,b)}},m.getObjectType=function(v){var y=v.type;if(y==="subtitle")return a.CMCDObjectType.TIMED_TEXT;if(v.sn==="initSegment")return a.CMCDObjectType.INIT;if(y==="audio")return a.CMCDObjectType.AUDIO;if(y==="main")return this.hls.audioTracks.length?a.CMCDObjectType.VIDEO:a.CMCDObjectType.MUXED},m.getTopBandwidth=function(v){var y=0,d,x=this.hls;if(v===a.CMCDObjectType.AUDIO)d=x.audioTracks;else{var b=x.maxAutoLevel,T=b>-1?b+1:x.levels.length;d=x.levels.slice(0,T)}for(var A=u(d),L;!(L=A()).done;){var R=L.value;R.bitrate>y&&(y=R.bitrate)}return y>0?y:NaN},m.getBufferLength=function(v){var y=this.hls.media,d=v===a.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!d||!y)return NaN;var x=o.BufferHelper.bufferInfo(d,y.currentTime,this.config.maxBufferHole);return x.len*1e3},m.createPlaylistLoader=function(){var v=this.config.pLoader,y=this.applyPlaylistData,d=v||this.config.loader;return function(){function x(T){this.loader=void 0,this.loader=new d(T)}var b=x.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(A,L,R){y(A),this.loader.load(A,L,R)},p(x,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),x}()},m.createFragmentLoader=function(){var v=this.config.fLoader,y=this.applyFragmentData,d=v||this.config.loader;return function(){function x(T){this.loader=void 0,this.loader=new d(T)}var b=x.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(A,L,R){y(A),this.loader.load(A,L,R)},p(x,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),x}()},_.uuid=function(){var v=URL.createObjectURL(new Blob),y=v.toString();return URL.revokeObjectURL(v),y.substr(y.lastIndexOf("/")+1)},_.serialize=function(v){for(var y=[],d=function(N){return!Number.isNaN(N)&&N!=null&&N!==""&&N!==!1},x=function(N){return Math.round(N)},b=function(N){return x(N/100)*100},T=function(N){return encodeURIComponent(N)},A={br:x,d:x,bl:b,dl:b,mtp:b,nor:T,rtp:b,tb:x},L=Object.keys(v||{}).sort(),R=u(L),w;!(w=R()).done;){var O=w.value,I=v[O];if(!!d(I)&&!(O==="v"&&I===1)&&!(O=="pr"&&I===1)){var D=A[O];D&&(I=D(I));var C=typeof I,P=void 0;O==="ot"||O==="sf"||O==="st"?P=O+"="+I:C==="boolean"?P=O:C==="number"?P=O+"="+I:P=O+"="+JSON.stringify(I),y.push(P)}}return y.join(",")},_.toHeaders=function(v){for(var y=Object.keys(v),d={},x=["Object","Request","Session","Status"],b=[{},{},{},{}],T={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},A=0,L=y;A<L.length;A++){var R=L[A],w=T[R]!=null?T[R]:1;b[w][R]=v[R]}for(var O=0;O<b.length;O++){var I=_.serialize(b[O]);I&&(d["CMCD-"+x[O]]=I)}return d},_.toQuery=function(v){return"CMCD="+encodeURIComponent(_.serialize(v))},_.appendQueryToUri=function(v,y){if(!y)return v;var d=v.includes("?")?"&":"?";return""+v+d+y},_}()},"./src/controller/eme-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),l=t("./src/utils/mediakeys-helper.ts");function h(S,_){for(var m=0;m<_.length;m++){var c=_[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function p(S,_,m){return _&&h(S.prototype,_),m&&h(S,m),S}var u=3,f=function(_,m,c){var v={audioCapabilities:[],videoCapabilities:[]};return _.forEach(function(y){v.audioCapabilities.push({contentType:'audio/mp4; codecs="'+y+'"',robustness:c.audioRobustness||""})}),m.forEach(function(y){v.videoCapabilities.push({contentType:'video/mp4; codecs="'+y+'"',robustness:c.videoRobustness||""})}),[v]},g=function(_,m,c,v){switch(_){case l.KeySystems.WIDEVINE:return f(m,c,v);default:throw new Error("Unknown key-system: "+_)}},E=function(){function S(m){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=m,this._config=m.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var _=S.prototype;return _.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},_._registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_._unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_.getLicenseServerUrl=function(c){switch(c){case l.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+c+'"')},_._attemptKeySystemAccess=function(c,v,y){var d=this,x=g(c,v,y,this._drmSystemOptions);o.logger.log("Requesting encrypted media key-system access");var b=this.requestMediaKeySystemAccess(c,x);this.mediaKeysPromise=b.then(function(T){return d._onMediaKeySystemAccessObtained(c,T)}),b.catch(function(T){o.logger.error('Failed to obtain key-system "'+c+'" access:',T)})},_._onMediaKeySystemAccessObtained=function(c,v){var y=this;o.logger.log('Access for key-system "'+c+'" obtained');var d={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:v,mediaKeySystemDomain:c};this._mediaKeysList.push(d);var x=Promise.resolve().then(function(){return v.createMediaKeys()}).then(function(b){return d.mediaKeys=b,o.logger.log('Media-keys created for key-system "'+c+'"'),y._onMediaKeysCreated(),b});return x.catch(function(b){o.logger.error("Failed to create media-keys:",b)}),x},_._onMediaKeysCreated=function(){var c=this;this._mediaKeysList.forEach(function(v){v.mediaKeysSession||(v.mediaKeysSession=v.mediaKeys.createSession(),c._onNewMediaKeySession(v.mediaKeysSession))})},_._onNewMediaKeySession=function(c){var v=this;o.logger.log("New key-system session "+c.sessionId),c.addEventListener("message",function(y){v._onKeySessionMessage(c,y.message)},!1)},_._onKeySessionMessage=function(c,v){o.logger.log("Got EME message event, creating license request"),this._requestLicense(v,function(y){o.logger.log("Received license data (length: "+(y&&y.byteLength)+"), updating key-session"),c.update(y)})},_.onMediaEncrypted=function(c){var v=this;if(o.logger.log('Media is encrypted using "'+c.initDataType+'" init data type'),!this.mediaKeysPromise){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var y=function(x){!v._media||(v._attemptSetMediaKeys(x),v._generateRequestWithPreferredKeySession(c.initDataType,c.initData))};this.mediaKeysPromise.then(y).catch(y)},_._attemptSetMediaKeys=function(c){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var v=this._mediaKeysList[0];if(!v||!v.mediaKeys){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}o.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(v.mediaKeys),this._hasSetMediaKeys=!0}},_._generateRequestWithPreferredKeySession=function(c,v){var y=this,d=this._mediaKeysList[0];if(!d){o.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(d.mediaKeysSessionInitialized){o.logger.warn("Key-Session already initialized but requested again");return}var x=d.mediaKeysSession;if(!x){o.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!v){o.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}o.logger.log('Generating key-session request for "'+c+'" init data type'),d.mediaKeysSessionInitialized=!0,x.generateRequest(c,v).then(function(){o.logger.debug("Key-session generation succeeded")}).catch(function(b){o.logger.error("Error generating key-session request:",b),y.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},_._createLicenseXhr=function(c,v,y){var d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,d,c,v,y);var x=this._licenseXhrSetup;if(x)try{x.call(this.hls,d,c),x=void 0}catch(b){o.logger.error(b)}try{d.readyState||d.open("POST",c,!0),x&&x.call(this.hls,d,c)}catch(b){throw new Error("issue setting up KeySystem license XHR "+b)}return d},_._onLicenseRequestReadyStageChange=function(c,v,y,d){switch(c.readyState){case 4:if(c.status===200){this._requestLicenseFailureCount=0,o.logger.log("License request succeeded");var x=c.response,b=this._licenseResponseCallback;if(b)try{x=b.call(this.hls,c,v)}catch(A){o.logger.error(A)}d(x)}else{if(o.logger.error("License Request XHR failed ("+v+"). Status: "+c.status+" ("+c.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u){this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var T=u-this._requestLicenseFailureCount+1;o.logger.warn("Retrying license request, "+T+" attempts left"),this._requestLicense(y,d)}break}},_._generateLicenseRequestChallenge=function(c,v){switch(c.mediaKeySystemDomain){case l.KeySystems.WIDEVINE:return v}throw new Error("unsupported key-system: "+c.mediaKeySystemDomain)},_._requestLicense=function(c,v){o.logger.log("Requesting content license for key-system");var y=this._mediaKeysList[0];if(!y){o.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var d=this.getLicenseServerUrl(y.mediaKeySystemDomain),x=this._createLicenseXhr(d,c,v);o.logger.log("Sending license request to URL: "+d);var b=this._generateLicenseRequestChallenge(y,c);x.send(b)}catch(T){o.logger.error("Failure requesting DRM license: "+T),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},_.onMediaAttached=function(c,v){if(!!this._emeEnabled){var y=v.media;this._media=y,y.addEventListener("encrypted",this._onMediaEncrypted)}},_.onMediaDetached=function(){var c=this._media,v=this._mediaKeysList;!c||(c.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(v.map(function(y){if(y.mediaKeysSession)return y.mediaKeysSession.close().catch(function(){})})).then(function(){return c.setMediaKeys(null)}).catch(function(){}))},_.onManifestParsed=function(c,v){if(!!this._emeEnabled){var y=v.levels.map(function(x){return x.audioCodec}).filter(function(x){return!!x}),d=v.levels.map(function(x){return x.videoCodec}).filter(function(x){return!!x});this._attemptKeySystemAccess(l.KeySystems.WIDEVINE,y,d)}},p(S,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),S}();i.default=E},"./src/controller/fps-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/logger.ts"),o=function(){function l(p){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=p,this.registerListeners()}var h=l.prototype;return h.setStreamController=function(u){this.streamController=u},h.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},h.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching)},h.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},h.onMediaAttaching=function(u,f){var g=this.hls.config;if(g.capLevelOnFPSDrop){var E=f.media instanceof self.HTMLVideoElement?f.media:null;this.media=E,E&&typeof E.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),g.fpsDroppedMonitoringPeriod)}},h.checkFPS=function(u,f,g){var E=performance.now();if(f){if(this.lastTime){var S=E-this.lastTime,_=g-this.lastDroppedFrames,m=f-this.lastDecodedFrames,c=1e3*_/S,v=this.hls;if(v.trigger(n.Events.FPS_DROP,{currentDropped:_,currentDecoded:m,totalDroppedFrames:g}),c>0&&_>v.config.fpsDroppedMonitoringThreshold*m){var y=v.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+y),y>0&&(v.autoLevelCapping===-1||v.autoLevelCapping>=y)&&(y=y-1,v.trigger(n.Events.FPS_DROP_LEVEL_CAPPING,{level:y,droppedLevel:v.currentLevel}),v.autoLevelCapping=y,this.streamController.nextLevelSwitch())}}this.lastTime=E,this.lastDroppedFrames=g,this.lastDecodedFrames=f}},h.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var f=u.getVideoPlaybackQuality();this.checkFPS(u,f.totalVideoFrames,f.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},l}();i.default=o},"./src/controller/fragment-finders.ts":function(r,i,t){t.r(i),t.d(i,"findFragmentByPDT",function(){return o}),t.d(i,"findFragmentByPTS",function(){return l}),t.d(i,"fragmentWithinToleranceTest",function(){return h}),t.d(i,"pdtWithinToleranceTest",function(){return p}),t.d(i,"findFragWithCC",function(){return u});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/binary-search.ts");function o(f,g,E){if(g===null||!Array.isArray(f)||!f.length||!Object(n.isFiniteNumber)(g))return null;var S=f[0].programDateTime;if(g<(S||0))return null;var _=f[f.length-1].endProgramDateTime;if(g>=(_||0))return null;E=E||0;for(var m=0;m<f.length;++m){var c=f[m];if(p(g,E,c))return c}return null}function l(f,g,E,S){E===void 0&&(E=0),S===void 0&&(S=0);var _=null;if(f?_=g[f.sn-g[0].sn+1]||null:E===0&&g[0].start===0&&(_=g[0]),_&&h(E,S,_)===0)return _;var m=a.default.search(g,h.bind(null,E,S));return m||_}function h(f,g,E){f===void 0&&(f=0),g===void 0&&(g=0);var S=Math.min(g,E.duration+(E.deltaPTS?E.deltaPTS:0));return E.start+E.duration-S<=f?1:E.start-S>f&&E.start?-1:0}function p(f,g,E){var S=Math.min(g,E.duration+(E.deltaPTS?E.deltaPTS:0))*1e3,_=E.endProgramDateTime||0;return _-S>f}function u(f,g){return a.default.search(f,function(E){return E.cc<g?1:E.cc>g?-1:0})}},"./src/controller/fragment-tracker.ts":function(r,i,t){t.r(i),t.d(i,"FragmentState",function(){return o}),t.d(i,"FragmentTracker",function(){return l});var n=t("./src/events.ts"),a=t("./src/types/loader.ts"),o;(function(u){u.NOT_LOADED="NOT_LOADED",u.BACKTRACKED="BACKTRACKED",u.APPENDING="APPENDING",u.PARTIAL="PARTIAL",u.OK="OK"})(o||(o={}));var l=function(){function u(g){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=g,this._registerListeners()}var f=u.prototype;return f._registerListeners=function(){var E=this.hls;E.on(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.on(n.Events.FRAG_LOADED,this.onFragLoaded,this)},f._unregisterListeners=function(){var E=this.hls;E.off(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.off(n.Events.FRAG_LOADED,this.onFragLoaded,this)},f.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},f.getAppendedFrag=function(E,S){if(S===a.PlaylistLevelType.MAIN){var _=this.activeFragment,m=this.activeParts;if(!_)return null;if(m)for(var c=m.length;c--;){var v=m[c],y=v?v.end:_.appendedPTS;if(v.start<=E&&y!==void 0&&E<=y)return c>9&&(this.activeParts=m.slice(c-9)),v}else if(_.start<=E&&_.appendedPTS!==void 0&&E<=_.appendedPTS)return _}return this.getBufferedFrag(E,S)},f.getBufferedFrag=function(E,S){for(var _=this.fragments,m=Object.keys(_),c=m.length;c--;){var v=_[m[c]];if((v==null?void 0:v.body.type)===S&&v.buffered){var y=v.body;if(y.start<=E&&E<=y.end)return y}}return null},f.detectEvictedFragments=function(E,S,_){var m=this;Object.keys(this.fragments).forEach(function(c){var v=m.fragments[c];if(!!v){if(!v.buffered){v.body.type===_&&m.removeFragment(v.body);return}var y=v.range[E];!y||y.time.some(function(d){var x=!m.isTimeBuffered(d.startPTS,d.endPTS,S);return x&&m.removeFragment(v.body),x})}})},f.detectPartialFragments=function(E){var S=this,_=this.timeRanges,m=E.frag,c=E.part;if(!(!_||m.sn==="initSegment")){var v=p(m),y=this.fragments[v];!y||(Object.keys(_).forEach(function(d){var x=m.elementaryStreams[d];if(!!x){var b=_[d],T=c!==null||x.partial===!0;y.range[d]=S.getBufferedTimes(m,c,T,b)}}),y.backtrack=y.loaded=null,Object.keys(y.range).length?y.buffered=!0:this.removeFragment(y.body))}},f.fragBuffered=function(E){var S=p(E),_=this.fragments[S];_&&(_.backtrack=_.loaded=null,_.buffered=!0)},f.getBufferedTimes=function(E,S,_,m){for(var c={time:[],partial:_},v=S?S.start:E.start,y=S?S.end:E.end,d=E.minEndPTS||y,x=E.maxStartPTS||v,b=0;b<m.length;b++){var T=m.start(b)-this.bufferPadding,A=m.end(b)+this.bufferPadding;if(x>=T&&d<=A){c.time.push({startPTS:Math.max(v,m.start(b)),endPTS:Math.min(y,m.end(b))});break}else if(v<A&&y>T)c.partial=!0,c.time.push({startPTS:Math.max(v,m.start(b)),endPTS:Math.min(y,m.end(b))});else if(y<=T)break}return c},f.getPartialFragment=function(E){var S=null,_,m,c,v=0,y=this.bufferPadding,d=this.fragments;return Object.keys(d).forEach(function(x){var b=d[x];!b||h(b)&&(m=b.body.start-y,c=b.body.end+y,E>=m&&E<=c&&(_=Math.min(E-m,c-E),v<=_&&(S=b.body,v=_)))}),S},f.getState=function(E){var S=p(E),_=this.fragments[S];return _?_.buffered?h(_)?o.PARTIAL:o.OK:_.backtrack?o.BACKTRACKED:o.APPENDING:o.NOT_LOADED},f.backtrack=function(E,S){var _=p(E),m=this.fragments[_];if(!m||m.backtrack)return null;var c=m.backtrack=S||m.loaded;return m.loaded=null,c},f.getBacktrackData=function(E){var S=p(E),_=this.fragments[S];if(_){var m,c=_.backtrack;if(c!=null&&(m=c.payload)!==null&&m!==void 0&&m.byteLength)return c;this.removeFragment(E)}return null},f.isTimeBuffered=function(E,S,_){for(var m,c,v=0;v<_.length;v++){if(m=_.start(v)-this.bufferPadding,c=_.end(v)+this.bufferPadding,E>=m&&S<=c)return!0;if(S<=m)return!1}return!1},f.onFragLoaded=function(E,S){var _=S.frag,m=S.part;if(!(_.sn==="initSegment"||_.bitrateTest||m)){var c=p(_);this.fragments[c]={body:_,loaded:S,backtrack:null,buffered:!1,range:Object.create(null)}}},f.onBufferAppended=function(E,S){var _=this,m=S.frag,c=S.part,v=S.timeRanges;if(m.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=m,c){var y=this.activeParts;y||(this.activeParts=y=[]),y.push(c)}else this.activeParts=null;this.timeRanges=v,Object.keys(v).forEach(function(d){var x=v[d];if(_.detectEvictedFragments(d,x),!c)for(var b=0;b<x.length;b++)m.appendedPTS=Math.max(x.end(b),m.appendedPTS||0)})},f.onFragBuffered=function(E,S){this.detectPartialFragments(S)},f.hasFragment=function(E){var S=p(E);return!!this.fragments[S]},f.removeFragmentsInRange=function(E,S,_){var m=this;Object.keys(this.fragments).forEach(function(c){var v=m.fragments[c];if(!!v&&v.buffered){var y=v.body;y.type===_&&y.start<S&&y.end>E&&m.removeFragment(y)}})},f.removeFragment=function(E){var S=p(E);E.stats.loaded=0,E.clearElementaryStreamInfo(),delete this.fragments[S]},f.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},u}();function h(u){var f,g;return u.buffered&&(((f=u.range.video)===null||f===void 0?void 0:f.partial)||((g=u.range.audio)===null||g===void 0?void 0:g.partial))}function p(u){return u.type+"_"+u.level+"_"+u.urlId+"_"+u.sn}},"./src/controller/gap-controller.ts":function(r,i,t){t.r(i),t.d(i,"STALL_MINIMUM_DURATION_MS",function(){return h}),t.d(i,"MAX_START_GAP_JUMP",function(){return p}),t.d(i,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return u}),t.d(i,"SKIP_BUFFER_RANGE_START",function(){return f}),t.d(i,"default",function(){return g});var n=t("./src/utils/buffer-helper.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts"),l=t("./src/utils/logger.ts"),h=250,p=2,u=.1,f=.05,g=function(){function E(_,m,c,v){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=_,this.media=m,this.fragmentTracker=c,this.hls=v}var S=E.prototype;return S.destroy=function(){this.hls=this.fragmentTracker=this.media=null},S.poll=function(m){var c=this.config,v=this.media,y=this.stalled,d=v.currentTime,x=v.seeking,b=this.seeking&&!x,T=!this.seeking&&x;if(this.seeking=x,d!==m){if(this.moved=!0,y!==null){if(this.stallReported){var A=self.performance.now()-y;l.logger.warn("playback not stuck anymore @"+d+", after "+Math.round(A)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((T||b)&&(this.stalled=null),!(v.paused||v.ended||v.playbackRate===0||!n.BufferHelper.getBuffered(v).length)){var L=n.BufferHelper.bufferInfo(v,d,0),R=L.len>0,w=L.nextStart||0;if(!(!R&&!w)){if(x){var O=L.len>p,I=!w||w-d>p&&!this.fragmentTracker.getPartialFragment(d);if(O||I)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var D,C=Math.max(w,L.start||0)-d,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,M=P==null||(D=P.details)===null||D===void 0?void 0:D.live,N=M?P.details.targetduration*2:p;if(C>0&&C<=N){this._trySkipBufferHole(null);return}}var B=self.performance.now();if(y===null){this.stalled=B;return}var U=B-y;!x&&U>=h&&this._reportStall(L.len);var F=n.BufferHelper.bufferInfo(v,d,c.maxBufferHole);this._tryFixBufferStall(F,U)}}},S._tryFixBufferStall=function(m,c){var v=this.config,y=this.fragmentTracker,d=this.media,x=d.currentTime,b=y.getPartialFragment(x);if(b){var T=this._trySkipBufferHole(b);if(T)return}m.len>v.maxBufferHole&&c>v.highBufferWatchdogPeriod*1e3&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},S._reportStall=function(m){var c=this.hls,v=this.media,y=this.stallReported;y||(this.stallReported=!0,l.logger.warn("Playback stalling at @"+v.currentTime+" due to low buffer (buffer="+m+")"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m}))},S._trySkipBufferHole=function(m){for(var c=this.config,v=this.hls,y=this.media,d=y.currentTime,x=0,b=n.BufferHelper.getBuffered(y),T=0;T<b.length;T++){var A=b.start(T);if(d+c.maxBufferHole>=x&&d<A){var L=Math.max(A+f,y.currentTime+u);return l.logger.warn("skipping hole, adjusting currentTime from "+d+" to "+L),this.moved=!0,this.stalled=null,y.currentTime=L,m&&v.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+d+" to "+L,frag:m}),L}x=b.end(T)}return 0},S._tryNudgeBuffer=function(){var m=this.config,c=this.hls,v=this.media,y=v.currentTime,d=(this.nudgeRetry||0)+1;if(this.nudgeRetry=d,d<m.nudgeMaxRetry){var x=y+d*m.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+y+" to "+x),v.currentTime=x,c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+y+" after "+m.nudgeMaxRetry+" nudges"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},E}()},"./src/controller/id3-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/demux/id3.ts"),l=.25,h=function(){function p(f){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=f,this._registerListeners()}var u=p.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var g=this.hls;g.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.on(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),g.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var g=this.hls;g.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.off(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),g.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(g,E){this.media=E.media},u.onMediaDetaching=function(){!this.id3Track||(Object(a.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(g){if(!!this.media){for(var E=0;E<g.length;E++){var S=g[E];if(S.kind==="metadata"&&S.label==="id3")return Object(a.sendAddTrackEvent)(S,this.media),S}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(g,E){if(!!this.media){var S=E.frag,_=E.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var m=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,c=0;c<_.length;c++){var v=o.getID3Frames(_[c].data);if(v){var y=_[c].pts,d=c<_.length-1?_[c+1].pts:S.end,x=d-y;x<=0&&(d=y+l);for(var b=0;b<v.length;b++){var T=v[b];if(!o.isTimeStampFrame(T)){var A=new m(y,d,"");A.value=T,this.id3Track.addCue(A)}}}}}},u.onBufferFlushing=function(g,E){var S=E.startOffset,_=E.endOffset,m=E.type;if(!m||m==="audio"){var c=this.id3Track;c&&Object(a.removeCuesInRange)(c,S,_)}},p}();i.default=h},"./src/controller/latency-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return p});var n=t("./src/errors.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts");function l(u,f){for(var g=0;g<f.length;g++){var E=f[g];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(u,E.key,E)}}function h(u,f,g){return f&&l(u.prototype,f),g&&l(u,g),u}var p=function(){function u(g){var E=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return E.timeupdate()},this.hls=g,this.config=g.config,this.registerListeners()}var f=u.prototype;return f.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},f.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},f.onMediaAttached=function(E,S){this.media=S.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},f.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},f.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},f.onLevelUpdated=function(E,S){var _=S.details;this.levelDetails=_,_.advanced&&this.timeupdate(),!_.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},f.onError=function(E,S){S.details===n.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,o.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},f.timeupdate=function(){var E=this.media,S=this.levelDetails;if(!(!E||!S)){this.currentTime=E.currentTime;var _=this.computeLatency();if(_!==null){this._latency=_;var m=this.config,c=m.lowLatencyMode,v=m.maxLiveSyncPlaybackRate;if(!(!c||v===1)){var y=this.targetLatency;if(y!==null){var d=_-y,x=Math.min(this.maxLatency,y+S.targetduration),b=d<x;if(S.live&&b&&d>.05&&this.forwardBufferLength>1){var T=Math.min(2,Math.max(1,v)),A=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20;E.playbackRate=Math.min(T,Math.max(1,A))}else E.playbackRate!==1&&E.playbackRate!==0&&(E.playbackRate=1)}}}}},f.estimateLiveEdge=function(){var E=this.levelDetails;return E===null?null:E.edge+E.age},f.computeLatency=function(){var E=this.estimateLiveEdge();return E===null?null:E-this.currentTime},h(u,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var E=this.config,S=this.levelDetails;return E.liveMaxLatencyDuration!==void 0?E.liveMaxLatencyDuration:S?E.liveMaxLatencyDurationCount*S.targetduration:0}},{key:"targetLatency",get:function(){var E=this.levelDetails;if(E===null)return null;var S=E.holdBack,_=E.partHoldBack,m=E.targetduration,c=this.config,v=c.liveSyncDuration,y=c.liveSyncDurationCount,d=c.lowLatencyMode,x=this.hls.userConfig,b=d&&_||S;(x.liveSyncDuration||x.liveSyncDurationCount||b===0)&&(b=v!==void 0?v:y*m);var T=m,A=1;return b+Math.min(this.stallCount*A,T)}},{key:"liveSyncPosition",get:function(){var E=this.estimateLiveEdge(),S=this.targetLatency,_=this.levelDetails;if(E===null||S===null||_===null)return null;var m=_.edge,c=E-S-this.edgeStalled,v=m-_.totalduration,y=m-(this.config.lowLatencyMode&&_.partTarget||_.targetduration);return Math.min(Math.max(v,c),y)}},{key:"drift",get:function(){var E=this.levelDetails;return E===null?1:E.drift}},{key:"edgeStalled",get:function(){var E=this.levelDetails;if(E===null)return 0;var S=(this.config.lowLatencyMode&&E.partTarget||E.targetduration)*3;return Math.max(E.age-S,0)}},{key:"forwardBufferLength",get:function(){var E=this.media,S=this.levelDetails;if(!E||!S)return 0;var _=E.buffered.length;return _?E.buffered.end(_-1):S.edge-this.currentTime}}]),u}()},"./src/controller/level-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return c});var n=t("./src/types/level.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),l=t("./src/utils/codecs.ts"),h=t("./src/controller/level-helper.ts"),p=t("./src/controller/base-playlist-controller.ts"),u=t("./src/types/loader.ts");function f(){return f=Object.assign||function(v){for(var y=1;y<arguments.length;y++){var d=arguments[y];for(var x in d)Object.prototype.hasOwnProperty.call(d,x)&&(v[x]=d[x])}return v},f.apply(this,arguments)}function g(v,y){for(var d=0;d<y.length;d++){var x=y[d];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(v,x.key,x)}}function E(v,y,d){return y&&g(v.prototype,y),d&&g(v,d),v}function S(v,y){v.prototype=Object.create(y.prototype),v.prototype.constructor=v,_(v,y)}function _(v,y){return _=Object.setPrototypeOf||function(x,b){return x.__proto__=b,x},_(v,y)}var m=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(v){S(y,v);function y(x){var b;return b=v.call(this,x,"[level-controller]")||this,b._levels=[],b._firstLevel=-1,b._startLevel=void 0,b.currentLevelIndex=-1,b.manualLevelIndex=-1,b.onParsedComplete=void 0,b._registerListeners(),b}var d=y.prototype;return d._registerListeners=function(){var b=this.hls;b.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),b.on(a.Events.ERROR,this.onError,this)},d._unregisterListeners=function(){var b=this.hls;b.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),b.off(a.Events.ERROR,this.onError,this)},d.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,v.prototype.destroy.call(this)},d.startLoad=function(){var b=this._levels;b.forEach(function(T){T.loadError=0}),v.prototype.startLoad.call(this)},d.onManifestLoaded=function(b,T){var A=[],L=[],R=[],w,O={},I,D=!1,C=!1,P=!1;if(T.levels.forEach(function(U){var F=U.attrs;D=D||!!(U.width&&U.height),C=C||!!U.videoCodec,P=P||!!U.audioCodec,m&&U.audioCodec&&U.audioCodec.indexOf("mp4a.40.34")!==-1&&(U.audioCodec=void 0);var j=U.bitrate+"-"+U.attrs.RESOLUTION+"-"+U.attrs.CODECS;I=O[j],I?I.url.push(U.url):(I=new n.Level(U),O[j]=I,A.push(I)),F&&(F.AUDIO&&Object(h.addGroupId)(I,"audio",F.AUDIO),F.SUBTITLES&&Object(h.addGroupId)(I,"text",F.SUBTITLES))}),(D||C)&&P&&(A=A.filter(function(U){var F=U.videoCodec,j=U.width,V=U.height;return!!F||!!(j&&V)})),A=A.filter(function(U){var F=U.audioCodec,j=U.videoCodec;return(!F||Object(l.isCodecSupportedInMp4)(F,"audio"))&&(!j||Object(l.isCodecSupportedInMp4)(j,"video"))}),T.audioTracks&&(L=T.audioTracks.filter(function(U){return!U.audioCodec||Object(l.isCodecSupportedInMp4)(U.audioCodec,"audio")}),Object(h.assignTrackIdsByGroup)(L)),T.subtitles&&(R=T.subtitles,Object(h.assignTrackIdsByGroup)(R)),A.length>0){w=A[0].bitrate,A.sort(function(U,F){return U.bitrate-F.bitrate}),this._levels=A;for(var M=0;M<A.length;M++)if(A[M].bitrate===w){this._firstLevel=M,this.log("manifest loaded, "+A.length+" level(s) found, first bitrate: "+w);break}var N=P&&!C,B={levels:A,audioTracks:L,subtitleTracks:R,firstLevel:this._firstLevel,stats:T.stats,audio:P,video:C,altAudio:!N&&L.some(function(U){return!!U.url})};this.hls.trigger(a.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:T.url,reason:"no level with compatible codecs found in manifest"})},d.onError=function(b,T){if(v.prototype.onError.call(this,b,T),!T.fatal){var A=T.context,L=this._levels[this.currentLevelIndex];if(A&&(A.type===u.PlaylistContextType.AUDIO_TRACK&&L.audioGroupIds&&A.groupId===L.audioGroupIds[L.urlId]||A.type===u.PlaylistContextType.SUBTITLE_TRACK&&L.textGroupIds&&A.groupId===L.textGroupIds[L.urlId])){this.redundantFailover(this.currentLevelIndex);return}var R=!1,w=!0,O;switch(T.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(T.frag){var I=this._levels[T.frag.level];I?(I.fragmentError++,I.fragmentError>this.hls.config.fragLoadingMaxRetry&&(O=T.frag.level)):O=T.frag.level}break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:A&&(A.deliveryDirectives&&(w=!1),O=A.level),R=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:O=T.level,R=!0;break}O!==void 0&&this.recoverLevel(T,O,R,w)}},d.recoverLevel=function(b,T,A,L){var R=b.details,w=this._levels[T];if(w.loadError++,A){var O=this.retryLoadingOrFail(b);if(O)b.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(L){var I=w.url.length;if(I>1&&w.loadError<I)b.levelRetry=!0,this.redundantFailover(T);else if(this.manualLevelIndex===-1){var D=T===0?this._levels.length-1:T-1;this.currentLevelIndex!==D&&this._levels[D].loadError===0&&(this.warn(R+": switch to "+D),b.levelRetry=!0,this.hls.nextAutoLevel=D)}}},d.redundantFailover=function(b){var T=this._levels[b],A=T.url.length;if(A>1){var L=(T.urlId+1)%A;this.warn("Switching to redundant URL-id "+L),this._levels.forEach(function(R){R.urlId=L}),this.level=b}},d.onFragLoaded=function(b,T){var A=T.frag;if(A!==void 0&&A.type===u.PlaylistLevelType.MAIN){var L=this._levels[A.level];L!==void 0&&(L.fragmentError=0,L.loadError=0)}},d.onLevelLoaded=function(b,T){var A,L=T.level,R=T.details,w=this._levels[L];if(!w){var O;this.warn("Invalid level index "+L),(O=T.deliveryDirectives)!==null&&O!==void 0&&O.skip&&(R.deltaUpdateFailed=!0);return}L===this.currentLevelIndex?(w.fragmentError===0&&(w.loadError=0,this.retryCount=0),this.playlistLoaded(L,T,w.details)):(A=T.deliveryDirectives)!==null&&A!==void 0&&A.skip&&(R.deltaUpdateFailed=!0)},d.onAudioTrackSwitched=function(b,T){var A=this.hls.levels[this.currentLevelIndex];if(!!A&&A.audioGroupIds){for(var L=-1,R=this.hls.audioTracks[T.id].groupId,w=0;w<A.audioGroupIds.length;w++)if(A.audioGroupIds[w]===R){L=w;break}L!==A.urlId&&(A.urlId=L,this.startLoad())}},d.loadPlaylist=function(b){var T=this.currentLevelIndex,A=this._levels[T];if(this.canLoad&&A&&A.url.length>0){var L=A.urlId,R=A.url[L];if(b)try{R=b.addDirectives(R)}catch(w){this.warn("Could not construct new URL with HLS Delivery Directives: "+w)}this.log("Attempt loading level index "+T+(b?" at sn "+b.msn+" part "+b.part:"")+" with URL-id "+L+" "+R),this.clearTimer(),this.hls.trigger(a.Events.LEVEL_LOADING,{url:R,level:T,id:L,deliveryDirectives:b||null})}},d.removeLevel=function(b,T){var A=function(w,O){return O!==T},L=this._levels.filter(function(R,w){return w!==b?!0:R.url.length>1&&T!==void 0?(R.url=R.url.filter(A),R.audioGroupIds&&(R.audioGroupIds=R.audioGroupIds.filter(A)),R.textGroupIds&&(R.textGroupIds=R.textGroupIds.filter(A)),R.urlId=0,!0):!1}).map(function(R,w){var O=R.details;return O!=null&&O.fragments&&O.fragments.forEach(function(I){I.level=w}),R});this._levels=L,this.hls.trigger(a.Events.LEVELS_UPDATED,{levels:L})},E(y,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(b){var T,A=this._levels;if(A.length!==0&&!(this.currentLevelIndex===b&&(T=A[b])!==null&&T!==void 0&&T.details)){if(b<0||b>=A.length){var L=b<0;if(this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:b,fatal:L,reason:"invalid level idx"}),L)return;b=Math.min(b,A.length-1)}this.clearTimer();var R=this.currentLevelIndex,w=A[R],O=A[b];this.log("switching to level "+b+" from "+R),this.currentLevelIndex=b;var I=f({},O,{level:b,maxBitrate:O.maxBitrate,uri:O.uri,urlId:O.urlId});delete I._urlId,this.hls.trigger(a.Events.LEVEL_SWITCHING,I);var D=O.details;if(!D||D.live){var C=this.switchParams(O.uri,w==null?void 0:w.details);this.loadPlaylist(C)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(b){this.manualLevelIndex=b,this._startLevel===void 0&&(this._startLevel=b),b!==-1&&(this.level=b)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(b){this._firstLevel=b}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var b=this.hls.config.startLevel;return b!==void 0?b:this._firstLevel}else return this._startLevel},set:function(b){this._startLevel=b}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(b){this.level=b,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=b)}}]),y}(p.default)},"./src/controller/level-helper.ts":function(r,i,t){t.r(i),t.d(i,"addGroupId",function(){return o}),t.d(i,"assignTrackIdsByGroup",function(){return l}),t.d(i,"updatePTS",function(){return h}),t.d(i,"updateFragPTSDTS",function(){return u}),t.d(i,"mergeDetails",function(){return f}),t.d(i,"mapPartIntersection",function(){return g}),t.d(i,"mapFragmentIntersection",function(){return E}),t.d(i,"adjustSliding",function(){return S}),t.d(i,"addSliding",function(){return _}),t.d(i,"computeReloadInterval",function(){return m}),t.d(i,"getFragmentWithSN",function(){return c}),t.d(i,"getPartWith",function(){return v});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts");function o(y,d,x){switch(d){case"audio":y.audioGroupIds||(y.audioGroupIds=[]),y.audioGroupIds.push(x);break;case"text":y.textGroupIds||(y.textGroupIds=[]),y.textGroupIds.push(x);break}}function l(y){var d={};y.forEach(function(x){var b=x.groupId||"";x.id=d[b]=d[b]||0,d[b]++})}function h(y,d,x){var b=y[d],T=y[x];p(b,T)}function p(y,d){var x=d.startPTS;if(Object(n.isFiniteNumber)(x)){var b=0,T;d.sn>y.sn?(b=x-y.start,T=y):(b=y.start-x,T=d),T.duration!==b&&(T.duration=b)}else if(d.sn>y.sn){var A=y.cc===d.cc;A&&y.minEndPTS?d.start=y.start+(y.minEndPTS-y.start):d.start=y.start+y.duration}else d.start=Math.max(y.start-d.duration,0)}function u(y,d,x,b,T,A){var L=b-x;L<=0&&(a.logger.warn("Fragment should have a positive duration",d),b=x+d.duration,A=T+d.duration);var R=x,w=b,O=d.startPTS,I=d.endPTS;if(Object(n.isFiniteNumber)(O)){var D=Math.abs(O-x);Object(n.isFiniteNumber)(d.deltaPTS)?d.deltaPTS=Math.max(D,d.deltaPTS):d.deltaPTS=D,R=Math.max(x,O),x=Math.min(x,O),T=Math.min(T,d.startDTS),w=Math.min(b,I),b=Math.max(b,I),A=Math.max(A,d.endDTS)}d.duration=b-x;var C=x-d.start;d.appendedPTS=b,d.start=d.startPTS=x,d.maxStartPTS=R,d.startDTS=T,d.endPTS=b,d.minEndPTS=w,d.endDTS=A;var P=d.sn;if(!y||P<y.startSN||P>y.endSN)return 0;var M,N=P-y.startSN,B=y.fragments;for(B[N]=d,M=N;M>0;M--)p(B[M],B[M-1]);for(M=N;M<B.length-1;M++)p(B[M],B[M+1]);return y.fragmentHint&&p(B[B.length-1],y.fragmentHint),y.PTSKnown=y.alignedSliding=!0,C}function f(y,d){for(var x=null,b=y.fragments,T=b.length-1;T>=0;T--){var A=b[T].initSegment;if(A){x=A;break}}y.fragmentHint&&delete y.fragmentHint.endPTS;var L=0,R;if(E(y,d,function(M,N){M.relurl&&(L=M.cc-N.cc),Object(n.isFiniteNumber)(M.startPTS)&&Object(n.isFiniteNumber)(M.endPTS)&&(N.start=N.startPTS=M.startPTS,N.startDTS=M.startDTS,N.appendedPTS=M.appendedPTS,N.maxStartPTS=M.maxStartPTS,N.endPTS=M.endPTS,N.endDTS=M.endDTS,N.minEndPTS=M.minEndPTS,N.duration=M.endPTS-M.startPTS,N.duration&&(R=N),d.PTSKnown=d.alignedSliding=!0),N.elementaryStreams=M.elementaryStreams,N.loader=M.loader,N.stats=M.stats,N.urlId=M.urlId,M.initSegment&&(N.initSegment=M.initSegment,x=M.initSegment)}),x){var w=d.fragmentHint?d.fragments.concat(d.fragmentHint):d.fragments;w.forEach(function(M){var N;(!M.initSegment||M.initSegment.relurl===((N=x)===null||N===void 0?void 0:N.relurl))&&(M.initSegment=x)})}if(d.skippedSegments&&(d.deltaUpdateFailed=d.fragments.some(function(M){return!M}),d.deltaUpdateFailed)){a.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var O=d.skippedSegments;O--;)d.fragments.shift();d.startSN=d.fragments[0].sn,d.startCC=d.fragments[0].cc}var I=d.fragments;if(L){a.logger.warn("discontinuity sliding from playlist, take drift into account");for(var D=0;D<I.length;D++)I[D].cc+=L}d.skippedSegments&&(d.startCC=d.fragments[0].cc),g(y.partList,d.partList,function(M,N){N.elementaryStreams=M.elementaryStreams,N.stats=M.stats}),R?u(d,R,R.startPTS,R.endPTS,R.startDTS,R.endDTS):S(y,d),I.length&&(d.totalduration=d.edge-I[0].start),d.driftStartTime=y.driftStartTime,d.driftStart=y.driftStart;var C=d.advancedDateTime;if(d.advanced&&C){var P=d.edge;d.driftStart||(d.driftStartTime=C,d.driftStart=P),d.driftEndTime=C,d.driftEnd=P}else d.driftEndTime=y.driftEndTime,d.driftEnd=y.driftEnd,d.advancedDateTime=y.advancedDateTime}function g(y,d,x){if(y&&d)for(var b=0,T=0,A=y.length;T<=A;T++){var L=y[T],R=d[T+b];L&&R&&L.index===R.index&&L.fragment.sn===R.fragment.sn?x(L,R):b--}}function E(y,d,x){for(var b=d.skippedSegments,T=Math.max(y.startSN,d.startSN)-d.startSN,A=(y.fragmentHint?1:0)+(b?d.endSN:Math.min(y.endSN,d.endSN))-d.startSN,L=d.startSN-y.startSN,R=d.fragmentHint?d.fragments.concat(d.fragmentHint):d.fragments,w=y.fragmentHint?y.fragments.concat(y.fragmentHint):y.fragments,O=T;O<=A;O++){var I=w[L+O],D=R[O];b&&!D&&O<b&&(D=d.fragments[O]=I),I&&D&&x(I,D)}}function S(y,d){var x=d.startSN+d.skippedSegments-y.startSN,b=y.fragments;x<0||x>=b.length||_(d,b[x].start)}function _(y,d){if(d){for(var x=y.fragments,b=y.skippedSegments;b<x.length;b++)x[b].start+=d;y.fragmentHint&&(y.fragmentHint.start+=d)}}function m(y,d){var x=1e3*y.levelTargetDuration,b=x/2,T=y.age,A=T>0&&T<x*3,L=d.loading.end-d.loading.start,R,w=y.availabilityDelay;if(y.updated===!1)if(A){var O=333*y.misses;R=Math.max(Math.min(b,L*2),O),y.availabilityDelay=(y.availabilityDelay||0)+R}else R=b;else A?(w=Math.min(w||x/2,T),y.availabilityDelay=w,R=w+x-T):R=x-L;return Math.round(R)}function c(y,d,x){if(!y||!y.details)return null;var b=y.details,T=b.fragments[d-b.startSN];return T||(T=b.fragmentHint,T&&T.sn===d)?T:d<b.startSN&&x&&x.sn===d?x:null}function v(y,d,x){if(!y||!y.details)return null;var b=y.details.partList;if(b)for(var T=b.length;T--;){var A=b[T];if(A.index===x&&A.fragment.sn===d)return A}return null}},"./src/controller/stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return b});var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/is-supported.ts"),l=t("./src/events.ts"),h=t("./src/utils/buffer-helper.ts"),p=t("./src/controller/fragment-tracker.ts"),u=t("./src/types/loader.ts"),f=t("./src/loader/fragment.ts"),g=t("./src/demux/transmuxer-interface.ts"),E=t("./src/types/transmuxer.ts"),S=t("./src/controller/gap-controller.ts"),_=t("./src/errors.ts"),m=t("./src/utils/logger.ts");function c(T,A){for(var L=0;L<A.length;L++){var R=A[L];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(T,R.key,R)}}function v(T,A,L){return A&&c(T.prototype,A),L&&c(T,L),T}function y(T,A){T.prototype=Object.create(A.prototype),T.prototype.constructor=T,d(T,A)}function d(T,A){return d=Object.setPrototypeOf||function(R,w){return R.__proto__=w,R},d(T,A)}var x=100,b=function(T){y(A,T);function A(R,w){var O;return O=T.call(this,R,w,"[stream-controller]")||this,O.audioCodecSwap=!1,O.gapController=null,O.level=-1,O._forceStartLoad=!1,O.altAudio=!1,O.audioOnly=!1,O.fragPlaying=null,O.onvplaying=null,O.onvseeked=null,O.fragLastKbps=0,O.stalled=!1,O.couldBacktrack=!1,O.audioCodecSwitch=!1,O.videoBuffer=null,O._registerListeners(),O}var L=A.prototype;return L._registerListeners=function(){var w=this.hls;w.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),w.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),w.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),w.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),w.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this),w.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),w.on(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),w.on(l.Events.ERROR,this.onError,this),w.on(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),w.on(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),w.on(l.Events.BUFFER_CREATED,this.onBufferCreated,this),w.on(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),w.on(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),w.on(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var w=this.hls;w.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),w.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),w.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),w.off(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),w.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),w.off(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),w.off(l.Events.ERROR,this.onError,this),w.off(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),w.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),w.off(l.Events.BUFFER_CREATED,this.onBufferCreated,this),w.off(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),w.off(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),w.off(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},L.startLoad=function(w){if(this.levels){var O=this.lastCurrentTime,I=this.hls;if(this.stopLoad(),this.setInterval(x),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var D=I.startLevel;D===-1&&(I.config.testBandwidth?(D=0,this.bitrateTest=!0):D=I.nextAutoLevel),this.level=I.nextLoadLevel=D,this.loadedmetadata=!1}O>0&&w===-1&&(this.log("Override startPosition with lastCurrentTime @"+O.toFixed(3)),w=O),this.state=a.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=w,this.tick()}else this._forceStartLoad=!0,this.state=a.State.STOPPED},L.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},L.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_LEVEL:{var w,O=this.levels,I=this.level,D=O==null||(w=O[I])===null||w===void 0?void 0:w.details;if(D&&(!D.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(D))break;this.state=a.State.IDLE;break}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var C,P=self.performance.now(),M=this.retryDate;(!M||P>=M||(C=this.media)!==null&&C!==void 0&&C.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=a.State.IDLE)}break}this.onTickEnd()},L.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},L.doTickIdle=function(){var w,O,I=this.hls,D=this.levelLastLoaded,C=this.levels,P=this.media,M=I.config,N=I.nextLoadLevel;if(!(D===null||!P&&(this.startFragRequested||!M.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!C||!C[N])){var B=C[N];this.level=I.nextLoadLevel=N;var U=B.details;if(!U||this.state===a.State.WAITING_LEVEL||U.live&&this.levelLastLoaded!==N){this.state=a.State.WAITING_LEVEL;return}var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:P,u.PlaylistLevelType.MAIN);if(F!==null){var j=F.len,V=this.getMaxBufferLength(B.maxBitrate);if(!(j>=V)){if(this._streamEnded(F,U)){var G={};this.altAudio&&(G.type="video"),this.hls.trigger(l.Events.BUFFER_EOS,G),this.state=a.State.ENDED;return}var Y=F.end,X=this.getNextFragment(Y,U);if(this.couldBacktrack&&!this.fragPrevious&&X&&X.sn!=="initSegment"){var ie=X.sn-U.startSN;ie>1&&(X=U.fragments[ie-1],this.fragmentTracker.removeFragment(X))}if(X&&this.fragmentTracker.getState(X)===p.FragmentState.OK&&this.nextLoadPosition>Y){var he=this.audioOnly&&!this.altAudio?f.ElementaryStreamTypes.AUDIO:f.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(P,he,u.PlaylistLevelType.MAIN),X=this.getNextFragment(this.nextLoadPosition,U)}!X||(X.initSegment&&!X.initSegment.data&&!this.bitrateTest&&(X=X.initSegment),((w=X.decryptdata)===null||w===void 0?void 0:w.keyFormat)==="identity"&&!((O=X.decryptdata)!==null&&O!==void 0&&O.key)?this.loadKey(X,U):this.loadFragment(X,U,Y))}}}},L.loadFragment=function(w,O,I){var D,C=this.fragmentTracker.getState(w);if(this.fragCurrent=w,C===p.FragmentState.BACKTRACKED){var P=this.fragmentTracker.getBacktrackData(w);if(P){this._handleFragmentLoadProgress(P),this._handleFragmentLoadComplete(P);return}else C=p.FragmentState.NOT_LOADED}C===p.FragmentState.NOT_LOADED||C===p.FragmentState.PARTIAL?w.sn==="initSegment"?this._loadInitSegment(w):this.bitrateTest?(w.bitrateTest=!0,this.log("Fragment "+w.sn+" of level "+w.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(w)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,w,O,I)):C===p.FragmentState.APPENDING?this.reduceMaxBufferLength(w.duration)&&this.fragmentTracker.removeFragment(w):((D=this.media)===null||D===void 0?void 0:D.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},L.getAppendedFrag=function(w){var O=this.fragmentTracker.getAppendedFrag(w,u.PlaylistLevelType.MAIN);return O&&"fragment"in O?O.fragment:O},L.getBufferedFrag=function(w){return this.fragmentTracker.getBufferedFrag(w,u.PlaylistLevelType.MAIN)},L.followingBufferedFrag=function(w){return w?this.getBufferedFrag(w.end+.5):null},L.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},L.nextLevelSwitch=function(){var w=this.levels,O=this.media;if(O!=null&&O.readyState){var I,D=this.getAppendedFrag(O.currentTime);if(D&&D.start>1&&this.flushMainBuffer(0,D.start-1),!O.paused&&w){var C=this.hls.nextLoadLevel,P=w[C],M=this.fragLastKbps;M&&this.fragCurrent?I=this.fragCurrent.duration*P.maxBitrate/(1e3*M)+1:I=0}else I=0;var N=this.getBufferedFrag(O.currentTime+I);if(N){var B=this.followingBufferedFrag(N);if(B){this.abortCurrentFrag();var U=B.maxStartPTS?B.maxStartPTS:B.start,F=B.duration,j=Math.max(N.end,U+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,F*.5),F*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},L.abortCurrentFrag=function(){var w=this.fragCurrent;this.fragCurrent=null,w!=null&&w.loader&&w.loader.abort(),this.state===a.State.KEY_LOADING&&(this.state=a.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},L.flushMainBuffer=function(w,O){T.prototype.flushMainBuffer.call(this,w,O,this.altAudio?"video":null)},L.onMediaAttached=function(w,O){T.prototype.onMediaAttached.call(this,w,O);var I=O.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),I.addEventListener("playing",this.onvplaying),I.addEventListener("seeked",this.onvseeked),this.gapController=new S.default(this.config,I,this.fragmentTracker,this.hls)},L.onMediaDetaching=function(){var w=this.media;w&&(w.removeEventListener("playing",this.onvplaying),w.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},L.onMediaPlaying=function(){this.tick()},L.onMediaSeeked=function(){var w=this.media,O=w?w.currentTime:null;Object(n.isFiniteNumber)(O)&&this.log("Media seeked to "+O.toFixed(3)),this.tick()},L.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(l.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},L.onManifestParsed=function(w,O){var I=!1,D=!1,C;O.levels.forEach(function(P){C=P.audioCodec,C&&(C.indexOf("mp4a.40.2")!==-1&&(I=!0),C.indexOf("mp4a.40.5")!==-1&&(D=!0))}),this.audioCodecSwitch=I&&D&&!Object(o.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=O.levels,this.startFragRequested=!1},L.onLevelLoading=function(w,O){var I=this.levels;if(!(!I||this.state!==a.State.IDLE)){var D=I[O.level];(!D.details||D.details.live&&this.levelLastLoaded!==O.level||this.waitForCdnTuneIn(D.details))&&(this.state=a.State.WAITING_LEVEL)}},L.onLevelLoaded=function(w,O){var I,D=this.levels,C=O.level,P=O.details,M=P.totalduration;if(!D){this.warn("Levels were reset while loading level "+C);return}this.log("Level "+C+" loaded ["+P.startSN+","+P.endSN+"], cc ["+P.startCC+", "+P.endCC+"] duration:"+M);var N=this.fragCurrent;N&&(this.state===a.State.FRAG_LOADING||this.state===a.State.FRAG_LOADING_WAITING_RETRY)&&N.level!==O.level&&N.loader&&(this.state=a.State.IDLE,N.loader.abort());var B=D[C],U=0;if(P.live||(I=B.details)!==null&&I!==void 0&&I.live){if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed)return;U=this.alignPlaylists(P,B.details)}if(B.details=P,this.levelLastLoaded=C,this.hls.trigger(l.Events.LEVEL_UPDATED,{details:P,level:C}),this.state===a.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(P))return;this.state=a.State.IDLE}this.startFragRequested?P.live&&this.synchronizeToLiveEdge(P):this.setStartPosition(P,U),this.tick()},L._handleFragmentLoadProgress=function(w){var O,I=w.frag,D=w.part,C=w.payload,P=this.levels;if(!P){this.warn("Levels were reset while fragment load was in progress. Fragment "+I.sn+" of level "+I.level+" will not be buffered");return}var M=P[I.level],N=M.details;if(!N){this.warn("Dropping fragment "+I.sn+" of level "+I.level+" after level details were reset");return}var B=M.videoCodec,U=N.PTSKnown||!N.live,F=(O=I.initSegment)===null||O===void 0?void 0:O.data,j=this._getAudioCodec(M),V=this.transmuxer=this.transmuxer||new g.default(this.hls,u.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=D?D.index:-1,Y=G!==-1,X=new E.ChunkMetadata(I.level,I.sn,I.stats.chunkCount,C.byteLength,G,Y),ie=this.initPTS[I.cc];V.push(C,F,j,B,I,D,N.totalduration,U,X,ie)},L.onAudioTrackSwitching=function(w,O){var I=this.altAudio,D=!!O.url,C=O.id;if(!D){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var P=this.fragCurrent;P!=null&&P.loader&&(this.log("Switching to main audio track, cancel main fragment load"),P.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var M=this.hls;I&&M.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),M.trigger(l.Events.AUDIO_TRACK_SWITCHED,{id:C})}},L.onAudioTrackSwitched=function(w,O){var I=O.id,D=!!this.hls.audioTracks[I].url;if(D){var C=this.videoBuffer;C&&this.mediaBuffer!==C&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=C)}this.altAudio=D,this.tick()},L.onBufferCreated=function(w,O){var I=O.tracks,D,C,P=!1;for(var M in I){var N=I[M];if(N.id==="main"){if(C=M,D=N,M==="video"){var B=I[M];B&&(this.videoBuffer=B.buffer)}}else P=!0}P&&D?(this.log("Alternate track found, use "+C+".buffered to schedule main fragment loading"),this.mediaBuffer=D.buffer):this.mediaBuffer=this.media},L.onFragBuffered=function(w,O){var I=O.frag,D=O.part;if(!(I&&I.type!==u.PlaylistLevelType.MAIN)){if(this.fragContextChanged(I)){this.warn("Fragment "+I.sn+(D?" p: "+D.index:"")+" of level "+I.level+" finished buffering, but was aborted. state: "+this.state),this.state===a.State.PARSED&&(this.state=a.State.IDLE);return}var C=D?D.stats:I.stats;this.fragLastKbps=Math.round(8*C.total/(C.buffering.end-C.loading.first)),I.sn!=="initSegment"&&(this.fragPrevious=I),this.fragBufferedComplete(I,D)}},L.onError=function(w,O){switch(O.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:case _.ErrorDetails.KEY_LOAD_ERROR:case _.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.MAIN,O);break;case _.ErrorDetails.LEVEL_LOAD_ERROR:case _.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==a.State.ERROR&&(O.fatal?(this.warn(""+O.details),this.state=a.State.ERROR):!O.levelRetry&&this.state===a.State.WAITING_LEVEL&&(this.state=a.State.IDLE));break;case _.ErrorDetails.BUFFER_FULL_ERROR:if(O.parent==="main"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var I=!0,D=this.getFwdBufferInfo(this.media,u.PlaylistLevelType.MAIN);D&&D.len>.5&&(I=!this.reduceMaxBufferLength(D.len)),I&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},L.checkBuffer=function(){var w=this.media,O=this.gapController;if(!(!w||!O||!w.readyState)){var I=h.BufferHelper.getBuffered(w);!this.loadedmetadata&&I.length?(this.loadedmetadata=!0,this.seekToStartPos()):O.poll(this.lastCurrentTime),this.lastCurrentTime=w.currentTime}},L.onFragLoadEmergencyAborted=function(){this.state=a.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},L.onBufferFlushed=function(w,O){var I=O.type;if(I!==f.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var D=(I===f.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(D,I,u.PlaylistLevelType.MAIN)}},L.onLevelsUpdated=function(w,O){this.levels=O.levels},L.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},L.seekToStartPos=function(){var w=this.media,O=w.currentTime,I=this.startPosition;if(I>=0&&O<I){if(w.seeking){m.logger.log("could not seek to "+I+", already seeking at "+O);return}var D=h.BufferHelper.getBuffered(w),C=D.length?D.start(0):0,P=C-I;P>0&&(P<this.config.maxBufferHole||P<this.config.maxFragLookUpTolerance)&&(m.logger.log("adjusting start position by "+P+" to match buffer start"),I+=P,this.startPosition=I),this.log("seek to target start position "+I+" from current time "+O),w.currentTime=I}},L._getAudioCodec=function(w){var O=this.config.defaultAudioCodec||w.audioCodec;return this.audioCodecSwap&&O&&(this.log("Swapping audio codec"),O.indexOf("mp4a.40.5")!==-1?O="mp4a.40.2":O="mp4a.40.5"),O},L._loadBitrateTestFrag=function(w){var O=this;this._doFragLoad(w).then(function(I){var D=O.hls;if(!(!I||D.nextLoadLevel||O.fragContextChanged(w))){O.fragLoadError=0,O.state=a.State.IDLE,O.startFragRequested=!1,O.bitrateTest=!1;var C=w.stats;C.parsing.start=C.parsing.end=C.buffering.start=C.buffering.end=self.performance.now(),D.trigger(l.Events.FRAG_LOADED,I)}})},L._handleTransmuxComplete=function(w){var O,I="main",D=this.hls,C=w.remuxResult,P=w.chunkMeta,M=this.getCurrentContext(P);if(!M){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(P.level);return}var N=M.frag,B=M.part,U=M.level,F=C.video,j=C.text,V=C.id3,G=C.initSegment,Y=this.altAudio?void 0:C.audio;if(!this.fragContextChanged(N)){if(this.state=a.State.PARSING,G){G.tracks&&(this._bufferInitSegment(U,G.tracks,N,P),D.trigger(l.Events.FRAG_PARSING_INIT_SEGMENT,{frag:N,id:I,tracks:G.tracks}));var X=G.initPTS,ie=G.timescale;Object(n.isFiniteNumber)(X)&&(this.initPTS[N.cc]=X,D.trigger(l.Events.INIT_PTS_FOUND,{frag:N,id:I,initPTS:X,timescale:ie}))}if(F&&C.independent!==!1){if(U.details){var he=F.startPTS,de=F.endPTS,Ae=F.startDTS,pe=F.endDTS;if(B)B.elementaryStreams[F.type]={startPTS:he,endPTS:de,startDTS:Ae,endDTS:pe};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){var le=this.getLoadPosition()+this.config.maxBufferHole;if(le<he){this.backtrack(N);return}N.setElementaryStreamInfo(F.type,N.start,de,N.start,pe,!0)}N.setElementaryStreamInfo(F.type,he,de,Ae,pe),this.bufferFragmentData(F,N,B,P)}}else if(C.independent===!1){this.backtrack(N);return}if(Y){var Ie=Y.startPTS,Ce=Y.endPTS,Ue=Y.startDTS,Me=Y.endDTS;B&&(B.elementaryStreams[f.ElementaryStreamTypes.AUDIO]={startPTS:Ie,endPTS:Ce,startDTS:Ue,endDTS:Me}),N.setElementaryStreamInfo(f.ElementaryStreamTypes.AUDIO,Ie,Ce,Ue,Me),this.bufferFragmentData(Y,N,B,P)}if(V!=null&&(O=V.samples)!==null&&O!==void 0&&O.length){var ze={frag:N,id:I,samples:V.samples};D.trigger(l.Events.FRAG_PARSING_METADATA,ze)}if(j){var Ge={frag:N,id:I,samples:j.samples};D.trigger(l.Events.FRAG_PARSING_USERDATA,Ge)}}},L._bufferInitSegment=function(w,O,I,D){var C=this;if(this.state===a.State.PARSING){this.audioOnly=!!O.audio&&!O.video,this.altAudio&&!this.audioOnly&&delete O.audio;var P=O.audio,M=O.video,N=O.audiovideo;if(P){var B=w.audioCodec,U=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),P.metadata.channelCount!==1&&U.indexOf("firefox")===-1&&(B="mp4a.40.5")),U.indexOf("android")!==-1&&P.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),w.audioCodec&&w.audioCodec!==B&&this.log('Swapping manifest audio codec "'+w.audioCodec+'" for "'+B+'"'),P.levelCodec=B,P.id="main",this.log("Init audio buffer, container:"+P.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(w.audioCodec||"")+"/"+P.codec+"]")}M&&(M.levelCodec=w.videoCodec,M.id="main",this.log("Init video buffer, container:"+M.container+", codecs[level/parsed]=["+(w.videoCodec||"")+"/"+M.codec+"]")),N&&this.log("Init audiovideo buffer, container:"+N.container+", codecs[level/parsed]=["+(w.attrs.CODECS||"")+"/"+N.codec+"]"),this.hls.trigger(l.Events.BUFFER_CODECS,O),Object.keys(O).forEach(function(F){var j=O[F],V=j.initSegment;V!=null&&V.byteLength&&C.hls.trigger(l.Events.BUFFER_APPENDING,{type:F,data:V,frag:I,part:null,chunkMeta:D,parent:I.type})}),this.tick()}},L.backtrack=function(w){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(w);var O=this.fragmentTracker.backtrack(w);this.fragPrevious=null,this.nextLoadPosition=w.start,O?this.resetFragmentLoading(w):this.state=a.State.BACKTRACKING},L.checkFragmentChanged=function(){var w=this.media,O=null;if(w&&w.readyState>1&&w.seeking===!1){var I=w.currentTime;if(h.BufferHelper.isBuffered(w,I)?O=this.getAppendedFrag(I):h.BufferHelper.isBuffered(w,I+.1)&&(O=this.getAppendedFrag(I+.1)),O){var D=this.fragPlaying,C=O.level;(!D||O.sn!==D.sn||D.level!==C||O.urlId!==D.urlId)&&(this.hls.trigger(l.Events.FRAG_CHANGED,{frag:O}),(!D||D.level!==C)&&this.hls.trigger(l.Events.LEVEL_SWITCHED,{level:C}),this.fragPlaying=O)}}},v(A,[{key:"nextLevel",get:function(){var w=this.nextBufferedFrag;return w?w.level:-1}},{key:"currentLevel",get:function(){var w=this.media;if(w){var O=this.getAppendedFrag(w.currentTime);if(O)return O.level}return-1}},{key:"nextBufferedFrag",get:function(){var w=this.media;if(w){var O=this.getAppendedFrag(w.currentTime);return this.followingBufferedFrag(O)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),A}(a.default)},"./src/controller/subtitle-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"SubtitleStreamController",function(){return v});var n=t("./src/events.ts"),a=t("./src/utils/buffer-helper.ts"),o=t("./src/controller/fragment-finders.ts"),l=t("./src/utils/discontinuities.ts"),h=t("./src/controller/level-helper.ts"),p=t("./src/controller/fragment-tracker.ts"),u=t("./src/controller/base-stream-controller.ts"),f=t("./src/types/loader.ts"),g=t("./src/types/level.ts");function E(y,d){for(var x=0;x<d.length;x++){var b=d[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}function S(y,d,x){return d&&E(y.prototype,d),x&&E(y,x),y}function _(y,d){y.prototype=Object.create(d.prototype),y.prototype.constructor=y,m(y,d)}function m(y,d){return m=Object.setPrototypeOf||function(b,T){return b.__proto__=T,b},m(y,d)}var c=500,v=function(y){_(d,y);function d(b,T){var A;return A=y.call(this,b,T,"[subtitle-stream-controller]")||this,A.levels=[],A.currentTrackId=-1,A.tracksBuffered=[],A.mainDetails=null,A._registerListeners(),A}var x=d.prototype;return x.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},x._registerListeners=function(){var T=this.hls;T.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(n.Events.ERROR,this.onError,this),T.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.on(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.on(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},x._unregisterListeners=function(){var T=this.hls;T.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(n.Events.ERROR,this.onError,this),T.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.off(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.off(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},x.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE,this.setInterval(c),this.tick()},x.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},x.onLevelLoaded=function(T,A){this.mainDetails=A.details},x.onSubtitleFragProcessed=function(T,A){var L=A.frag,R=A.success;if(this.fragPrevious=L,this.state=u.State.IDLE,!!R){var w=this.tracksBuffered[this.currentTrackId];if(!!w){for(var O,I=L.start,D=0;D<w.length;D++)if(I>=w[D].start&&I<=w[D].end){O=w[D];break}var C=L.start+L.duration;O?O.end=C:(O={start:I,end:C},w.push(O)),this.fragmentTracker.fragBuffered(L)}}},x.onBufferFlushing=function(T,A){var L=A.startOffset,R=A.endOffset;if(L===0&&R!==Number.POSITIVE_INFINITY){var w=this.currentTrackId,O=this.levels;if(!O.length||!O[w]||!O[w].details)return;var I=O[w].details,D=I.targetduration,C=R-D;if(C<=0)return;A.endOffsetSubtitles=Math.max(0,C),this.tracksBuffered.forEach(function(P){for(var M=0;M<P.length;){if(P[M].end<=C){P.shift();continue}else if(P[M].start<C)P[M].start=C;else break;M++}}),this.fragmentTracker.removeFragmentsInRange(L,C,f.PlaylistLevelType.SUBTITLE)}},x.onError=function(T,A){var L,R=A.frag;!R||R.type!==f.PlaylistLevelType.SUBTITLE||((L=this.fragCurrent)!==null&&L!==void 0&&L.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},x.onSubtitleTracksUpdated=function(T,A){var L=this,R=A.subtitleTracks;this.tracksBuffered=[],this.levels=R.map(function(w){return new g.Level(w)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(w){L.tracksBuffered[w.id]=[]}),this.mediaBuffer=null},x.onSubtitleTrackSwitch=function(T,A){if(this.currentTrackId=A.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var L=this.levels[this.currentTrackId];L!=null&&L.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,L&&this.setInterval(c)},x.onSubtitleTrackLoaded=function(T,A){var L,R=A.details,w=A.id,O=this.currentTrackId,I=this.levels;if(!!I.length){var D=I[O];if(!(w>=I.length||w!==O||!D)){if(this.mediaBuffer=this.mediaBufferTimeRanges,R.live||(L=D.details)!==null&&L!==void 0&&L.live){var C=this.mainDetails;if(R.deltaUpdateFailed||!C)return;var P=C.fragments[0];if(!D.details)R.hasProgramDateTime&&C.hasProgramDateTime?Object(l.alignMediaPlaylistByPDT)(R,C):P&&Object(h.addSliding)(R,P.start);else{var M=this.alignPlaylists(R,D.details);M===0&&P&&Object(h.addSliding)(R,P.start)}}if(D.details=R,this.levelLastLoaded=w,this.tick(),R.live&&!this.fragCurrent&&this.media&&this.state===u.State.IDLE){var N=Object(o.findFragmentByPTS)(null,R.fragments,this.media.currentTime,0);N||(this.warn("Subtitle playlist not aligned with playback"),D.details=void 0)}}}},x._handleFragmentLoadComplete=function(T){var A=T.frag,L=T.payload,R=A.decryptdata,w=this.hls;if(!this.fragContextChanged(A)&&L&&L.byteLength>0&&R&&R.key&&R.iv&&R.method==="AES-128"){var O=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(L),R.key.buffer,R.iv.buffer).then(function(I){var D=performance.now();w.trigger(n.Events.FRAG_DECRYPTED,{frag:A,payload:I,stats:{tstart:O,tdecrypt:D}})})}},x.doTick=function(){if(!this.media){this.state=u.State.IDLE;return}if(this.state===u.State.IDLE){var T,A=this.currentTrackId,L=this.levels;if(!L.length||!L[A]||!L[A].details)return;var R=L[A].details,w=R.targetduration,O=this.config,I=this.media,D=a.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,I.currentTime-w,O.maxBufferHole),C=D.end,P=D.len,M=this.getMaxBufferLength()+w;if(P>M)return;console.assert(R,"Subtitle track details are defined on idle subtitle stream controller tick");var N=R.fragments,B=N.length,U=R.edge,F,j=this.fragPrevious;if(C<U){var V=O.maxFragLookUpTolerance;F=Object(o.findFragmentByPTS)(j,N,C,V),!F&&j&&j.start<N[0].start&&(F=N[0])}else F=N[B-1];(T=F)!==null&&T!==void 0&&T.encrypted?this.loadKey(F,R):F&&this.fragmentTracker.getState(F)===p.FragmentState.NOT_LOADED&&this.loadFragment(F,R,C)}},x.loadFragment=function(T,A,L){this.fragCurrent=T,y.prototype.loadFragment.call(this,T,A,L)},S(d,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),d}(u.default)},"./src/controller/subtitle-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/controller/base-playlist-controller.ts"),l=t("./src/types/loader.ts");function h(S,_){for(var m=0;m<_.length;m++){var c=_[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function p(S,_,m){return _&&h(S.prototype,_),m&&h(S,m),S}function u(S,_){S.prototype=Object.create(_.prototype),S.prototype.constructor=S,f(S,_)}function f(S,_){return f=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c},f(S,_)}var g=function(S){u(_,S);function _(c){var v;return v=S.call(this,c,"[subtitle-track-controller]")||this,v.media=null,v.tracks=[],v.groupId=null,v.tracksInGroup=[],v.trackId=-1,v.selectDefaultTrack=!0,v.queuedDefaultTrack=-1,v.trackChangeListener=function(){return v.onTextTracksChanged()},v.asyncPollTrackChange=function(){return v.pollTrackChange(0)},v.useTextTrackPolling=!1,v.subtitlePollingInterval=-1,v.subtitleDisplay=!0,v.registerListeners(),v}var m=_.prototype;return m.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,S.prototype.destroy.call(this)},m.registerListeners=function(){var v=this.hls;v.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),v.on(n.Events.ERROR,this.onError,this)},m.unregisterListeners=function(){var v=this.hls;v.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),v.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),v.off(n.Events.ERROR,this.onError,this)},m.onMediaAttached=function(v,y){this.media=y.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},m.pollTrackChange=function(v){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,v)},m.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var v=E(this.media.textTracks);v.forEach(function(y){Object(a.clearCurrentCues)(y)}),this.subtitleTrack=-1,this.media=null}},m.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},m.onManifestParsed=function(v,y){this.tracks=y.subtitleTracks},m.onSubtitleTrackLoaded=function(v,y){var d=y.id,x=y.details,b=this.trackId,T=this.tracksInGroup[b];if(!T){this.warn("Invalid subtitle track id "+d);return}var A=T.details;T.details=y.details,this.log("subtitle track "+d+" loaded ["+x.startSN+"-"+x.endSN+"]"),d===this.trackId&&(this.retryCount=0,this.playlistLoaded(d,y,A))},m.onLevelLoading=function(v,y){this.switchLevel(y.level)},m.onLevelSwitching=function(v,y){this.switchLevel(y.level)},m.switchLevel=function(v){var y=this.hls.levels[v];if(!!(y!=null&&y.textGroupIds)){var d=y.textGroupIds[y.urlId];if(this.groupId!==d){var x=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,b=this.tracks.filter(function(L){return!d||L.groupId===d});this.tracksInGroup=b;var T=this.findTrackId(x==null?void 0:x.name)||this.findTrackId();this.groupId=d;var A={subtitleTracks:b};this.log("Updating subtitle tracks, "+b.length+' track(s) found in "'+d+'" group-id'),this.hls.trigger(n.Events.SUBTITLE_TRACKS_UPDATED,A),T!==-1&&this.setSubtitleTrack(T,x)}}},m.findTrackId=function(v){for(var y=this.tracksInGroup,d=0;d<y.length;d++){var x=y[d];if((!this.selectDefaultTrack||x.default)&&(!v||v===x.name))return x.id}return-1},m.onError=function(v,y){S.prototype.onError.call(this,v,y),!(y.fatal||!y.context)&&y.context.type===l.PlaylistContextType.SUBTITLE_TRACK&&y.context.id===this.trackId&&y.context.groupId===this.groupId&&this.retryLoadingOrFail(y)},m.loadPlaylist=function(v){var y=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(y)){var d=y.id,x=y.groupId,b=y.url;if(v)try{b=v.addDirectives(b)}catch(T){this.warn("Could not construct new URL with HLS Delivery Directives: "+T)}this.log("Loading subtitle playlist for id "+d),this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADING,{url:b,id:d,groupId:x,deliveryDirectives:v||null})}},m.toggleTrackModes=function(v){var y=this,d=this.media,x=this.subtitleDisplay,b=this.trackId;if(!!d){var T=E(d.textTracks),A=T.filter(function(w){return w.groupId===y.groupId});if(v===-1)[].slice.call(T).forEach(function(w){w.mode="disabled"});else{var L=A[b];L&&(L.mode="disabled")}var R=A[v];R&&(R.mode=x?"showing":"hidden")}},m.setSubtitleTrack=function(v,y){var d,x=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=v;return}if(this.trackId!==v&&this.toggleTrackModes(v),!(this.trackId===v&&(v===-1||(d=x[v])!==null&&d!==void 0&&d.details)||v<-1||v>=x.length)){this.clearTimer();var b=x[v];if(this.log("Switching to subtitle track "+v),this.trackId=v,b){var T=b.id,A=b.groupId,L=A===void 0?"":A,R=b.name,w=b.type,O=b.url;this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:T,groupId:L,name:R,type:w,url:O});var I=this.switchParams(b.url,y==null?void 0:y.details);this.loadPlaylist(I)}else this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:v})}},m.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var v=-1,y=E(this.media.textTracks),d=0;d<y.length;d++)if(y[d].mode==="hidden")v=d;else if(y[d].mode==="showing"){v=d;break}this.subtitleTrack!==v&&(this.subtitleTrack=v)}},p(_,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(v){this.selectDefaultTrack=!1;var y=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(v,y)}}]),_}(o.default);function E(S){for(var _=[],m=0;m<S.length;m++){var c=S[m];c.kind==="subtitles"&&c.label&&_.push(S[m])}return _}i.default=g},"./src/controller/timeline-controller.ts":function(r,i,t){t.r(i),t.d(i,"TimelineController",function(){return E});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/cea-608-parser.ts"),l=t("./src/utils/output-filter.ts"),h=t("./src/utils/webvtt-parser.ts"),p=t("./src/utils/texttrack-utils.ts"),u=t("./src/utils/imsc1-ttml-parser.ts"),f=t("./src/types/loader.ts"),g=t("./src/utils/logger.ts"),E=function(){function c(y){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m(),this.captionsProperties=void 0,this.hls=y,this.config=y.config,this.Cues=y.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var d=new l.default(this,"textTrack1"),x=new l.default(this,"textTrack2"),b=new l.default(this,"textTrack3"),T=new l.default(this,"textTrack4");this.cea608Parser1=new o.default(1,d,x),this.cea608Parser2=new o.default(3,b,T)}y.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),y.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),y.on(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),y.on(a.Events.FRAG_LOADING,this.onFragLoading,this),y.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),y.on(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),y.on(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),y.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),y.on(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),y.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var v=c.prototype;return v.destroy=function(){var d=this.hls;d.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),d.off(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),d.off(a.Events.FRAG_LOADING,this.onFragLoading,this),d.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),d.off(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),d.off(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),d.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),d.off(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),d.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},v.addCues=function(d,x,b,T,A){for(var L=!1,R=A.length;R--;){var w=A[R],O=_(w[0],w[1],x,b);if(O>=0&&(w[0]=Math.min(w[0],x),w[1]=Math.max(w[1],b),L=!0,O/(b-x)>.5))return}if(L||A.push([x,b]),this.config.renderTextTracksNatively){var I=this.captionsTracks[d];this.Cues.newCue(I,x,b,T)}else{var D=this.Cues.newCue(null,x,b,T);this.hls.trigger(a.Events.CUES_PARSED,{type:"captions",cues:D,track:d})}},v.onInitPtsFound=function(d,x){var b=this,T=x.frag,A=x.id,L=x.initPTS,R=x.timescale,w=this.unparsedVttFrags;A==="main"&&(this.initPTS[T.cc]=L,this.timescale[T.cc]=R),w.length&&(this.unparsedVttFrags=[],w.forEach(function(O){b.onFragLoaded(a.Events.FRAG_LOADED,O)}))},v.getExistingTrack=function(d){var x=this.media;if(x)for(var b=0;b<x.textTracks.length;b++){var T=x.textTracks[b];if(T[d])return T}return null},v.createCaptionsTrack=function(d){this.config.renderTextTracksNatively?this.createNativeTrack(d):this.createNonNativeTrack(d)},v.createNativeTrack=function(d){if(!this.captionsTracks[d]){var x=this.captionsProperties,b=this.captionsTracks,T=this.media,A=x[d],L=A.label,R=A.languageCode,w=this.getExistingTrack(d);if(w)b[d]=w,Object(p.clearCurrentCues)(b[d]),Object(p.sendAddTrackEvent)(b[d],T);else{var O=this.createTextTrack("captions",L,R);O&&(O[d]=!0,b[d]=O)}}},v.createNonNativeTrack=function(d){if(!this.nonNativeCaptionsTracks[d]){var x=this.captionsProperties[d];if(!!x){var b=x.label,T={_id:d,label:b,kind:"captions",default:x.media?!!x.media.default:!1,closedCaptions:x.media};this.nonNativeCaptionsTracks[d]=T,this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[T]})}}},v.createTextTrack=function(d,x,b){var T=this.media;if(!!T)return T.addTextTrack(d,x,b)},v.onMediaAttaching=function(d,x){this.media=x.media,this._cleanTracks()},v.onMediaDetaching=function(){var d=this.captionsTracks;Object.keys(d).forEach(function(x){Object(p.clearCurrentCues)(d[x]),delete d[x]}),this.nonNativeCaptionsTracks={}},v.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},v._cleanTracks=function(){var d=this.media;if(!!d){var x=d.textTracks;if(x)for(var b=0;b<x.length;b++)Object(p.clearCurrentCues)(x[b])}},v.onSubtitleTracksUpdated=function(d,x){var b=this;this.textTracks=[];var T=x.subtitleTracks||[],A=T.some(function(O){return O.textCodec===u.IMSC1_CODEC});if(this.config.enableWebVTT||A&&this.config.enableIMSC1){var L=this.tracks&&T&&this.tracks.length===T.length;if(this.tracks=T||[],this.config.renderTextTracksNatively){var R=this.media?this.media.textTracks:[];this.tracks.forEach(function(O,I){var D;if(I<R.length){for(var C=null,P=0;P<R.length;P++)if(S(R[P],O)){C=R[P];break}C&&(D=C)}D?Object(p.clearCurrentCues)(D):(D=b.createTextTrack("subtitles",O.name,O.lang),D&&(D.mode="disabled")),D&&(D.groupId=O.groupId,b.textTracks.push(D))})}else if(!L&&this.tracks&&this.tracks.length){var w=this.tracks.map(function(O){return{label:O.name,kind:O.type.toLowerCase(),default:O.default,subtitleTrack:O}});this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:w})}}},v.onManifestLoaded=function(d,x){var b=this;this.config.enableCEA708Captions&&x.captions&&x.captions.forEach(function(T){var A=/(?:CC|SERVICE)([1-4])/.exec(T.instreamId);if(!!A){var L="textTrack"+A[1],R=b.captionsProperties[L];!R||(R.label=T.name,T.lang&&(R.languageCode=T.lang),R.media=T)}})},v.onFragLoading=function(d,x){var b=this.cea608Parser1,T=this.cea608Parser2,A=this.lastSn,L=this.lastPartIndex;if(!(!this.enabled||!(b&&T))&&x.frag.type===f.PlaylistLevelType.MAIN){var R,w,O=x.frag.sn,I=(R=x==null||(w=x.part)===null||w===void 0?void 0:w.index)!=null?R:-1;O===A+1||O===A&&I===L+1||(b.reset(),T.reset()),this.lastSn=O,this.lastPartIndex=I}},v.onFragLoaded=function(d,x){var b=x.frag,T=x.payload,A=this.initPTS,L=this.unparsedVttFrags;if(b.type===f.PlaylistLevelType.SUBTITLE)if(T.byteLength){if(!Object(n.isFiniteNumber)(A[b.cc])){L.push(x),A.length&&this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Missing initial subtitle PTS")});return}var R=b.decryptdata,w="stats"in x;if(R==null||R.key==null||R.method!=="AES-128"||w){var O=this.tracks[b.level],I=this.vttCCs;I[b.cc]||(I[b.cc]={start:b.start,prevCC:this.prevCC,new:!0},this.prevCC=b.cc),O&&O.textCodec===u.IMSC1_CODEC?this._parseIMSC1(b,T):this._parseVTTs(b,T,I)}}else this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Empty subtitle payload")})},v._parseIMSC1=function(d,x){var b=this,T=this.hls;Object(u.parseIMSC1)(x,this.initPTS[d.cc],this.timescale[d.cc],function(A){b._appendCues(A,d.level),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(A){g.logger.log("Failed to parse IMSC1: "+A),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:A})})},v._parseVTTs=function(d,x,b){var T=this,A=this.hls;Object(h.parseWebVTT)(x,this.initPTS[d.cc],this.timescale[d.cc],b,d.cc,d.start,function(L){T._appendCues(L,d.level),A.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(L){T._fallbackToIMSC1(d,x),g.logger.log("Failed to parse VTT cue: "+L),A.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:L})})},v._fallbackToIMSC1=function(d,x){var b=this,T=this.tracks[d.level];T.textCodec||Object(u.parseIMSC1)(x,this.initPTS[d.cc],this.timescale[d.cc],function(){T.textCodec=u.IMSC1_CODEC,b._parseIMSC1(d,x)},function(){T.textCodec="wvtt"})},v._appendCues=function(d,x){var b=this.hls;if(this.config.renderTextTracksNatively){var T=this.textTracks[x];if(T.mode==="disabled")return;d.forEach(function(R){return Object(p.addCueToTrack)(T,R)})}else{var A=this.tracks[x],L=A.default?"default":"subtitles"+x;b.trigger(a.Events.CUES_PARSED,{type:"subtitles",cues:d,track:L})}},v.onFragDecrypted=function(d,x){var b=x.frag;if(b.type===f.PlaylistLevelType.SUBTITLE){if(!Object(n.isFiniteNumber)(this.initPTS[b.cc])){this.unparsedVttFrags.push(x);return}this.onFragLoaded(a.Events.FRAG_LOADED,x)}},v.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},v.onFragParsingUserdata=function(d,x){var b=this.cea608Parser1,T=this.cea608Parser2;if(!(!this.enabled||!(b&&T)))for(var A=0;A<x.samples.length;A++){var L=x.samples[A].bytes;if(L){var R=this.extractCea608Data(L);b.addData(x.samples[A].pts,R[0]),T.addData(x.samples[A].pts,R[1])}}},v.onBufferFlushing=function(d,x){var b=x.startOffset,T=x.endOffset,A=x.endOffsetSubtitles,L=x.type,R=this.media;if(!(!R||R.currentTime<T)){if(!L||L==="video"){var w=this.captionsTracks;Object.keys(w).forEach(function(I){return Object(p.removeCuesInRange)(w[I],b,T)})}if(this.config.renderTextTracksNatively&&b===0&&A!==void 0){var O=this.textTracks;Object.keys(O).forEach(function(I){return Object(p.removeCuesInRange)(O[I],b,A)})}}},v.extractCea608Data=function(d){for(var x=d[0]&31,b=2,T=[[],[]],A=0;A<x;A++){var L=d[b++],R=127&d[b++],w=127&d[b++],O=(4&L)!=0,I=3&L;R===0&&w===0||O&&(I===0||I===1)&&(T[I].push(R),T[I].push(w))}return T},c}();function S(c,v){return c&&c.label===v.name&&!(c.textTrack1||c.textTrack2)}function _(c,v,y,d){return Math.min(v,d)-Math.max(c,y)}function m(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,h){this.subtle=void 0,this.aesIV=void 0,this.subtle=l,this.aesIV=h}var o=a.prototype;return o.decrypt=function(h,p){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},p,h)},a}()},"./src/crypt/aes-decryptor.ts":function(r,i,t){t.r(i),t.d(i,"removePadding",function(){return a}),t.d(i,"default",function(){return o});var n=t("./src/utils/typed-array.ts");function a(l){var h=l.byteLength,p=h&&new DataView(l.buffer).getUint8(h-1);return p?Object(n.sliceUint8)(l,0,h-p):l}var o=function(){function l(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var h=l.prototype;return h.uint8ArrayToUint32Array_=function(u){for(var f=new DataView(u),g=new Uint32Array(4),E=0;E<4;E++)g[E]=f.getUint32(E*4);return g},h.initTable=function(){var u=this.sBox,f=this.invSBox,g=this.subMix,E=g[0],S=g[1],_=g[2],m=g[3],c=this.invSubMix,v=c[0],y=c[1],d=c[2],x=c[3],b=new Uint32Array(256),T=0,A=0,L=0;for(L=0;L<256;L++)L<128?b[L]=L<<1:b[L]=L<<1^283;for(L=0;L<256;L++){var R=A^A<<1^A<<2^A<<3^A<<4;R=R>>>8^R&255^99,u[T]=R,f[R]=T;var w=b[T],O=b[w],I=b[O],D=b[R]*257^R*16843008;E[T]=D<<24|D>>>8,S[T]=D<<16|D>>>16,_[T]=D<<8|D>>>24,m[T]=D,D=I*16843009^O*65537^w*257^T*16843008,v[R]=D<<24|D>>>8,y[R]=D<<16|D>>>16,d[R]=D<<8|D>>>24,x[R]=D,T?(T=w^b[b[b[I^w]]],A^=b[b[A]]):T=A=1}},h.expandKey=function(u){for(var f=this.uint8ArrayToUint32Array_(u),g=!0,E=0;E<f.length&&g;)g=f[E]===this.key[E],E++;if(!g){this.key=f;var S=this.keySize=f.length;if(S!==4&&S!==6&&S!==8)throw new Error("Invalid aes key size="+S);var _=this.ksRows=(S+6+1)*4,m,c,v=this.keySchedule=new Uint32Array(_),y=this.invKeySchedule=new Uint32Array(_),d=this.sBox,x=this.rcon,b=this.invSubMix,T=b[0],A=b[1],L=b[2],R=b[3],w,O;for(m=0;m<_;m++){if(m<S){w=v[m]=f[m];continue}O=w,m%S==0?(O=O<<8|O>>>24,O=d[O>>>24]<<24|d[O>>>16&255]<<16|d[O>>>8&255]<<8|d[O&255],O^=x[m/S|0]<<24):S>6&&m%S==4&&(O=d[O>>>24]<<24|d[O>>>16&255]<<16|d[O>>>8&255]<<8|d[O&255]),v[m]=w=(v[m-S]^O)>>>0}for(c=0;c<_;c++)m=_-c,c&3?O=v[m]:O=v[m-4],c<4||m<=4?y[c]=O:y[c]=T[d[O>>>24]]^A[d[O>>>16&255]]^L[d[O>>>8&255]]^R[d[O&255]],y[c]=y[c]>>>0}},h.networkToHostOrderSwap=function(u){return u<<24|(u&65280)<<8|(u&16711680)>>8|u>>>24},h.decrypt=function(u,f,g){for(var E=this.keySize+6,S=this.invKeySchedule,_=this.invSBox,m=this.invSubMix,c=m[0],v=m[1],y=m[2],d=m[3],x=this.uint8ArrayToUint32Array_(g),b=x[0],T=x[1],A=x[2],L=x[3],R=new Int32Array(u),w=new Int32Array(R.length),O,I,D,C,P,M,N,B,U,F,j,V,G,Y,X=this.networkToHostOrderSwap;f<R.length;){for(U=X(R[f]),F=X(R[f+1]),j=X(R[f+2]),V=X(R[f+3]),P=U^S[0],M=V^S[1],N=j^S[2],B=F^S[3],G=4,Y=1;Y<E;Y++)O=c[P>>>24]^v[M>>16&255]^y[N>>8&255]^d[B&255]^S[G],I=c[M>>>24]^v[N>>16&255]^y[B>>8&255]^d[P&255]^S[G+1],D=c[N>>>24]^v[B>>16&255]^y[P>>8&255]^d[M&255]^S[G+2],C=c[B>>>24]^v[P>>16&255]^y[M>>8&255]^d[N&255]^S[G+3],P=O,M=I,N=D,B=C,G=G+4;O=_[P>>>24]<<24^_[M>>16&255]<<16^_[N>>8&255]<<8^_[B&255]^S[G],I=_[M>>>24]<<24^_[N>>16&255]<<16^_[B>>8&255]<<8^_[P&255]^S[G+1],D=_[N>>>24]<<24^_[B>>16&255]<<16^_[P>>8&255]<<8^_[M&255]^S[G+2],C=_[B>>>24]<<24^_[P>>16&255]<<16^_[M>>8&255]<<8^_[N&255]^S[G+3],w[f]=X(O^b),w[f+1]=X(C^T),w[f+2]=X(D^A),w[f+3]=X(I^L),b=U,T=F,A=j,L=V,f=f+4}return w.buffer},l}()},"./src/crypt/decrypter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return f});var n=t("./src/crypt/aes-crypto.ts"),a=t("./src/crypt/fast-aes-key.ts"),o=t("./src/crypt/aes-decryptor.ts"),l=t("./src/utils/logger.ts"),h=t("./src/utils/mp4-tools.ts"),p=t("./src/utils/typed-array.ts"),u=16,f=function(){function g(S,_,m){var c=m===void 0?{}:m,v=c.removePKCS7Padding,y=v===void 0?!0:v;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=S,this.config=_,this.removePKCS7Padding=y,y)try{var d=self.crypto;d&&(this.subtle=d.subtle||d.webkitSubtle)}catch(x){}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var E=g.prototype;return E.destroy=function(){this.observer=null},E.isSync=function(){return this.config.enableSoftwareAES},E.flush=function(){var _=this.currentResult;if(!_){this.reset();return}var m=new Uint8Array(_);return this.reset(),this.removePKCS7Padding?Object(o.removePadding)(m):m},E.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},E.decrypt=function(_,m,c,v){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(_),m,c);var y=this.flush();y&&v(y.buffer)}else this.webCryptoDecrypt(new Uint8Array(_),m,c).then(v)},E.softwareDecrypt=function(_,m,c){var v=this.currentIV,y=this.currentResult,d=this.remainderData;this.logOnce("JS AES decrypt"),d&&(_=Object(h.appendUint8Array)(d,_),this.remainderData=null);var x=this.getValidChunk(_);if(!x.length)return null;v&&(c=v);var b=this.softwareDecrypter;b||(b=this.softwareDecrypter=new o.default),b.expandKey(m);var T=y;return this.currentResult=b.decrypt(x.buffer,0,c),this.currentIV=Object(p.sliceUint8)(x,-16).buffer,T||null},E.webCryptoDecrypt=function(_,m,c){var v=this,y=this.subtle;return(this.key!==m||!this.fastAesKey)&&(this.key=m,this.fastAesKey=new a.default(y,m)),this.fastAesKey.expandKey().then(function(d){if(!y)return Promise.reject(new Error("web crypto not initialized"));var x=new n.default(y,c);return x.decrypt(_.buffer,d)}).catch(function(d){return v.onWebCryptoError(d,_,m,c)})},E.onWebCryptoError=function(_,m,c,v){return l.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",_),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(m,c,v)},E.getValidChunk=function(_){var m=_,c=_.length-_.length%u;return c!==_.length&&(m=Object(p.sliceUint8)(_,0,c),this.remainderData=Object(p.sliceUint8)(_,c)),m},E.logOnce=function(_){!this.logEnabled||(l.logger.log("[decrypter.ts]: "+_),this.logEnabled=!1)},g}()},"./src/crypt/fast-aes-key.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,h){this.subtle=void 0,this.key=void 0,this.subtle=l,this.key=h}var o=a.prototype;return o.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},a}()},"./src/demux/aacdemuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/adts.ts"),o=t("./src/utils/logger.ts"),l=t("./src/demux/id3.ts");function h(f,g){f.prototype=Object.create(g.prototype),f.prototype.constructor=f,p(f,g)}function p(f,g){return p=Object.setPrototypeOf||function(S,_){return S.__proto__=_,S},p(f,g)}var u=function(f){h(g,f);function g(S,_){var m;return m=f.call(this)||this,m.observer=void 0,m.config=void 0,m.observer=S,m.config=_,m}var E=g.prototype;return E.resetInitSegment=function(_,m,c){f.prototype.resetInitSegment.call(this,_,m,c),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:_,duration:c,inputTimeScale:9e4,dropped:0}},g.probe=function(_){if(!_)return!1;for(var m=l.getID3Data(_,0)||[],c=m.length,v=_.length;c<v;c++)if(a.probe(_,c))return o.logger.log("ADTS sync word found !"),!0;return!1},E.canParse=function(_,m){return a.canParse(_,m)},E.appendFrame=function(_,m,c){a.initTrackConfig(_,this.observer,m,c,_.manifestCodec);var v=a.appendFrame(_,m,c,this.initPTS,this.frameIndex);if(v&&v.missing===0)return v},g}(n.default);u.minProbeByteLength=9,i.default=u},"./src/demux/adts.ts":function(r,i,t){t.r(i),t.d(i,"getAudioConfig",function(){return l}),t.d(i,"isHeaderPattern",function(){return h}),t.d(i,"getHeaderLength",function(){return p}),t.d(i,"getFullFrameLength",function(){return u}),t.d(i,"canGetFrameLength",function(){return f}),t.d(i,"isHeader",function(){return g}),t.d(i,"canParse",function(){return E}),t.d(i,"probe",function(){return S}),t.d(i,"initTrackConfig",function(){return _}),t.d(i,"getFrameDuration",function(){return m}),t.d(i,"parseFrameHeader",function(){return c}),t.d(i,"appendFrame",function(){return v});var n=t("./src/utils/logger.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts");function l(y,d,x,b){var T,A,L,R,w=navigator.userAgent.toLowerCase(),O=b,I=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];T=((d[x+2]&192)>>>6)+1;var D=(d[x+2]&60)>>>2;if(D>I.length-1){y.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+D});return}return L=(d[x+2]&1)<<2,L|=(d[x+3]&192)>>>6,n.logger.log("manifest codec:"+b+", ADTS type:"+T+", samplingIndex:"+D),/firefox/i.test(w)?D>=6?(T=5,R=new Array(4),A=D-3):(T=2,R=new Array(2),A=D):w.indexOf("android")!==-1?(T=2,R=new Array(2),A=D):(T=5,R=new Array(4),b&&(b.indexOf("mp4a.40.29")!==-1||b.indexOf("mp4a.40.5")!==-1)||!b&&D>=6?A=D-3:((b&&b.indexOf("mp4a.40.2")!==-1&&(D>=6&&L===1||/vivaldi/i.test(w))||!b&&L===1)&&(T=2,R=new Array(2)),A=D)),R[0]=T<<3,R[0]|=(D&14)>>1,R[1]|=(D&1)<<7,R[1]|=L<<3,T===5&&(R[1]|=(A&14)>>1,R[2]=(A&1)<<7,R[2]|=2<<2,R[3]=0),{config:R,samplerate:I[D],channelCount:L,codec:"mp4a.40."+T,manifestCodec:O}}function h(y,d){return y[d]===255&&(y[d+1]&246)==240}function p(y,d){return y[d+1]&1?7:9}function u(y,d){return(y[d+3]&3)<<11|y[d+4]<<3|(y[d+5]&224)>>>5}function f(y,d){return d+5<y.length}function g(y,d){return d+1<y.length&&h(y,d)}function E(y,d){return f(y,d)&&h(y,d)&&u(y,d)<=y.length-d}function S(y,d){if(g(y,d)){var x=p(y,d);if(d+x>=y.length)return!1;var b=u(y,d);if(b<=x)return!1;var T=d+b;return T===y.length||g(y,T)}return!1}function _(y,d,x,b,T){if(!y.samplerate){var A=l(d,x,b,T);if(!A)return;y.config=A.config,y.samplerate=A.samplerate,y.channelCount=A.channelCount,y.codec=A.codec,y.manifestCodec=A.manifestCodec,n.logger.log("parsed codec:"+y.codec+", rate:"+A.samplerate+", channels:"+A.channelCount)}}function m(y){return 1024*9e4/y}function c(y,d,x,b,T){var A=p(y,d),L=u(y,d);if(L-=A,L>0){var R=x+b*T;return{headerLength:A,frameLength:L,stamp:R}}}function v(y,d,x,b,T){var A=m(y.samplerate),L=c(d,x,b,T,A);if(L){var R=L.frameLength,w=L.headerLength,O=L.stamp,I=w+R,D=Math.max(0,x+I-d.length),C;D?(C=new Uint8Array(I-w),C.set(d.subarray(x+w,d.length),0)):C=d.subarray(x+w,x+I);var P={unit:C,pts:O};return D||y.samples.push(P),{sample:P,length:I,missing:D}}}},"./src/demux/base-audio-demuxer.ts":function(r,i,t){t.r(i),t.d(i,"initPTSFn",function(){return u});var n=t("./src/polyfills/number.ts"),a=t("./src/demux/id3.ts"),o=t("./src/demux/dummy-demuxed-track.ts"),l=t("./src/utils/mp4-tools.ts"),h=t("./src/utils/typed-array.ts"),p=function(){function f(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var g=f.prototype;return g.resetInitSegment=function(S,_,m){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},g.resetTimeStamp=function(){},g.resetContiguity=function(){},g.canParse=function(S,_){return!1},g.appendFrame=function(S,_,m){},g.demux=function(S,_){this.cachedData&&(S=Object(l.appendUint8Array)(this.cachedData,S),this.cachedData=null);var m=a.getID3Data(S,0),c=m?m.length:0,v,y,d=this._audioTrack,x=this._id3Track,b=m?a.getTimeStamp(m):void 0,T=S.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=u(b,_)),m&&m.length>0&&x.samples.push({pts:this.initPTS,dts:this.initPTS,data:m}),y=this.initPTS;c<T;){if(this.canParse(S,c)){var A=this.appendFrame(d,S,c);A?(this.frameIndex++,y=A.sample.pts,c+=A.length,v=c):c=T}else a.canParse(S,c)?(m=a.getID3Data(S,c),x.samples.push({pts:y,dts:y,data:m}),c+=m.length,v=c):c++;if(c===T&&v!==T){var L=Object(h.sliceUint8)(S,v);this.cachedData?this.cachedData=Object(l.appendUint8Array)(this.cachedData,L):this.cachedData=L}}return{audioTrack:d,avcTrack:Object(o.dummyTrack)(),id3Track:x,textTrack:Object(o.dummyTrack)()}},g.demuxSampleAes=function(S,_,m){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},g.flush=function(S){var _=this.cachedData;return _&&(this.cachedData=null,this.demux(_,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(o.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(o.dummyTrack)()}},g.destroy=function(){},f}(),u=function(g,E){return Object(n.isFiniteNumber)(g)?g*90:E*9e4};i.default=p},"./src/demux/chunk-cache.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function o(){this.chunks=[],this.dataLength=0}var l=o.prototype;return l.push=function(p){this.chunks.push(p),this.dataLength+=p.length},l.flush=function(){var p=this.chunks,u=this.dataLength,f;if(p.length)p.length===1?f=p[0]:f=a(p,u);else return new Uint8Array(0);return this.reset(),f},l.reset=function(){this.chunks.length=0,this.dataLength=0},o}();function a(o,l){for(var h=new Uint8Array(l),p=0,u=0;u<o.length;u++){var f=o[u];h.set(f,p),p+=f.length}return h}},"./src/demux/dummy-demuxed-track.ts":function(r,i,t){t.r(i),t.d(i,"dummyTrack",function(){return n});function n(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=function(){function o(h){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=h,this.bytesAvailable=h.byteLength,this.word=0,this.bitsAvailable=0}var l=o.prototype;return l.loadWord=function(){var p=this.data,u=this.bytesAvailable,f=p.byteLength-u,g=new Uint8Array(4),E=Math.min(4,u);if(E===0)throw new Error("no bytes available");g.set(p.subarray(f,f+E)),this.word=new DataView(g.buffer).getUint32(0),this.bitsAvailable=E*8,this.bytesAvailable-=E},l.skipBits=function(p){var u;this.bitsAvailable>p?(this.word<<=p,this.bitsAvailable-=p):(p-=this.bitsAvailable,u=p>>3,p-=u>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=p,this.bitsAvailable-=p)},l.readBits=function(p){var u=Math.min(this.bitsAvailable,p),f=this.word>>>32-u;return p>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),u=p-u,u>0&&this.bitsAvailable?f<<u|this.readBits(u):f},l.skipLZ=function(){var p;for(p=0;p<this.bitsAvailable;++p)if((this.word&2147483648>>>p)!=0)return this.word<<=p,this.bitsAvailable-=p,p;return this.loadWord(),p+this.skipLZ()},l.skipUEG=function(){this.skipBits(1+this.skipLZ())},l.skipEG=function(){this.skipBits(1+this.skipLZ())},l.readUEG=function(){var p=this.skipLZ();return this.readBits(p+1)-1},l.readEG=function(){var p=this.readUEG();return 1&p?1+p>>>1:-1*(p>>>1)},l.readBoolean=function(){return this.readBits(1)===1},l.readUByte=function(){return this.readBits(8)},l.readUShort=function(){return this.readBits(16)},l.readUInt=function(){return this.readBits(32)},l.skipScalingList=function(p){for(var u=8,f=8,g,E=0;E<p;E++)f!==0&&(g=this.readEG(),f=(u+g+256)%256),u=f===0?u:f},l.readSPS=function(){var p=0,u=0,f=0,g=0,E,S,_,m=this.readUByte.bind(this),c=this.readBits.bind(this),v=this.readUEG.bind(this),y=this.readBoolean.bind(this),d=this.skipBits.bind(this),x=this.skipEG.bind(this),b=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);m();var A=m();if(c(5),d(3),m(),b(),A===100||A===110||A===122||A===244||A===44||A===83||A===86||A===118||A===128){var L=v();if(L===3&&d(1),b(),b(),d(1),y())for(S=L!==3?8:12,_=0;_<S;_++)y()&&(_<6?T(16):T(64))}b();var R=v();if(R===0)v();else if(R===1)for(d(1),x(),x(),E=v(),_=0;_<E;_++)x();b(),d(1);var w=v(),O=v(),I=c(1);I===0&&d(1),d(1),y()&&(p=v(),u=v(),f=v(),g=v());var D=[1,1];if(y()&&y()){var C=m();switch(C){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[m()<<8|m(),m()<<8|m()];break}}}return{width:Math.ceil((w+1)*16-p*2-u*2),height:(2-I)*(O+1)*16-(I?2:4)*(f+g),pixelRatio:D}},l.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o}();i.default=a},"./src/demux/id3.ts":function(r,i,t){t.r(i),t.d(i,"isHeader",function(){return n}),t.d(i,"isFooter",function(){return a}),t.d(i,"getID3Data",function(){return o}),t.d(i,"canParse",function(){return h}),t.d(i,"getTimeStamp",function(){return p}),t.d(i,"isTimeStampFrame",function(){return u}),t.d(i,"getID3Frames",function(){return g}),t.d(i,"decodeFrame",function(){return E}),t.d(i,"utf8ArrayToStr",function(){return v}),t.d(i,"testables",function(){return y});var n=function(T,A){return A+10<=T.length&&T[A]===73&&T[A+1]===68&&T[A+2]===51&&T[A+3]<255&&T[A+4]<255&&T[A+6]<128&&T[A+7]<128&&T[A+8]<128&&T[A+9]<128},a=function(T,A){return A+10<=T.length&&T[A]===51&&T[A+1]===68&&T[A+2]===73&&T[A+3]<255&&T[A+4]<255&&T[A+6]<128&&T[A+7]<128&&T[A+8]<128&&T[A+9]<128},o=function(T,A){for(var L=A,R=0;n(T,A);){R+=10;var w=l(T,A+6);R+=w,a(T,A+10)&&(R+=10),A+=R}if(R>0)return T.subarray(L,L+R)},l=function(T,A){var L=0;return L=(T[A]&127)<<21,L|=(T[A+1]&127)<<14,L|=(T[A+2]&127)<<7,L|=T[A+3]&127,L},h=function(T,A){return n(T,A)&&l(T,A+6)+10<=T.length-A},p=function(T){for(var A=g(T),L=0;L<A.length;L++){var R=A[L];if(u(R))return c(R)}},u=function(T){return T&&T.key==="PRIV"&&T.info==="com.apple.streaming.transportStreamTimestamp"},f=function(T){var A=String.fromCharCode(T[0],T[1],T[2],T[3]),L=l(T,4),R=10;return{type:A,size:L,data:T.subarray(R,R+L)}},g=function(T){for(var A=0,L=[];n(T,A);){var R=l(T,A+6);A+=10;for(var w=A+R;A+8<w;){var O=f(T.subarray(A)),I=E(O);I&&L.push(I),A+=O.size+10}a(T,A)&&(A+=10)}return L},E=function(T){return T.type==="PRIV"?S(T):T.type[0]==="W"?m(T):_(T)},S=function(T){if(!(T.size<2)){var A=v(T.data,!0),L=new Uint8Array(T.data.subarray(A.length+1));return{key:T.type,info:A,data:L.buffer}}},_=function(T){if(!(T.size<2)){if(T.type==="TXXX"){var A=1,L=v(T.data.subarray(A),!0);A+=L.length+1;var R=v(T.data.subarray(A));return{key:T.type,info:L,data:R}}var w=v(T.data.subarray(1));return{key:T.type,data:w}}},m=function(T){if(T.type==="WXXX"){if(T.size<2)return;var A=1,L=v(T.data.subarray(A),!0);A+=L.length+1;var R=v(T.data.subarray(A));return{key:T.type,info:L,data:R}}var w=v(T.data);return{key:T.type,data:w}},c=function(T){if(T.data.byteLength===8){var A=new Uint8Array(T.data),L=A[3]&1,R=(A[4]<<23)+(A[5]<<15)+(A[6]<<7)+A[7];return R/=45,L&&(R+=4772185884e-2),Math.round(R)}},v=function(T,A){A===void 0&&(A=!1);var L=x();if(L){var R=L.decode(T);if(A){var w=R.indexOf("\0");return w!==-1?R.substring(0,w):R}return R.replace(/\0/g,"")}for(var O=T.length,I,D,C,P="",M=0;M<O;){if(I=T[M++],I===0&&A)return P;if(I===0||I===3)continue;switch(I>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:P+=String.fromCharCode(I);break;case 12:case 13:D=T[M++],P+=String.fromCharCode((I&31)<<6|D&63);break;case 14:D=T[M++],C=T[M++],P+=String.fromCharCode((I&15)<<12|(D&63)<<6|(C&63)<<0);break}}return P},y={decodeTextFrame:_},d;function x(){return!d&&typeof self.TextDecoder!="undefined"&&(d=new self.TextDecoder("utf-8")),d}},"./src/demux/mp3demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/id3.ts"),o=t("./src/utils/logger.ts"),l=t("./src/demux/mpegaudio.ts");function h(f,g){f.prototype=Object.create(g.prototype),f.prototype.constructor=f,p(f,g)}function p(f,g){return p=Object.setPrototypeOf||function(S,_){return S.__proto__=_,S},p(f,g)}var u=function(f){h(g,f);function g(){return f.apply(this,arguments)||this}var E=g.prototype;return E.resetInitSegment=function(_,m,c){f.prototype.resetInitSegment.call(this,_,m,c),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:_,duration:c,inputTimeScale:9e4,dropped:0}},g.probe=function(_){if(!_)return!1;for(var m=a.getID3Data(_,0)||[],c=m.length,v=_.length;c<v;c++)if(l.probe(_,c))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},E.canParse=function(_,m){return l.canParse(_,m)},E.appendFrame=function(_,m,c){if(this.initPTS!==null)return l.appendFrame(_,m,c,this.initPTS,this.frameIndex)},g}(n.default);u.minProbeByteLength=4,i.default=u},"./src/demux/mp4demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/utils/mp4-tools.ts"),a=t("./src/demux/dummy-demuxed-track.ts"),o=function(){function l(p,u){this.remainderData=null,this.config=void 0,this.config=u}var h=l.prototype;return h.resetTimeStamp=function(){},h.resetInitSegment=function(){},h.resetContiguity=function(){},l.probe=function(u){return Object(n.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},h.demux=function(u){var f=u,g=Object(a.dummyTrack)();if(this.config.progressive){this.remainderData&&(f=Object(n.appendUint8Array)(this.remainderData,u));var E=Object(n.segmentValidRange)(f);this.remainderData=E.remainder,g.samples=E.valid||new Uint8Array}else g.samples=f;return{audioTrack:Object(a.dummyTrack)(),avcTrack:g,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},h.flush=function(){var u=Object(a.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(a.dummyTrack)(),avcTrack:u,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},h.demuxSampleAes=function(u,f,g){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},h.destroy=function(){},l}();o.minProbeByteLength=1024,i.default=o},"./src/demux/mpegaudio.ts":function(r,i,t){t.r(i),t.d(i,"appendFrame",function(){return p}),t.d(i,"parseHeader",function(){return u}),t.d(i,"isHeaderPattern",function(){return f}),t.d(i,"isHeader",function(){return g}),t.d(i,"canParse",function(){return E}),t.d(i,"probe",function(){return S});var n=null,a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],l=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],h=[0,1,1,4];function p(_,m,c,v,y){if(!(c+24>m.length)){var d=u(m,c);if(d&&c+d.frameLength<=m.length){var x=d.samplesPerFrame*9e4/d.sampleRate,b=v+y*x,T={unit:m.subarray(c,c+d.frameLength),pts:b,dts:b};return _.config=[],_.channelCount=d.channelCount,_.samplerate=d.sampleRate,_.samples.push(T),{sample:T,length:d.frameLength,missing:0}}}}function u(_,m){var c=_[m+1]>>3&3,v=_[m+1]>>1&3,y=_[m+2]>>4&15,d=_[m+2]>>2&3;if(c!==1&&y!==0&&y!==15&&d!==3){var x=_[m+2]>>1&1,b=_[m+3]>>6,T=c===3?3-v:v===3?3:4,A=a[T*14+y-1]*1e3,L=c===3?0:c===2?1:2,R=o[L*3+d],w=b===3?1:2,O=l[c][v],I=h[v],D=O*8*I,C=Math.floor(O*A/R+x)*I;if(n===null){var P=navigator.userAgent||"",M=P.match(/Chrome\/(\d+)/i);n=M?parseInt(M[1]):0}var N=!!n&&n<=87;return N&&v===2&&A>=224e3&&b===0&&(_[m+3]=_[m+3]|128),{sampleRate:R,channelCount:w,frameLength:C,samplesPerFrame:D}}}function f(_,m){return _[m]===255&&(_[m+1]&224)==224&&(_[m+1]&6)!=0}function g(_,m){return m+1<_.length&&f(_,m)}function E(_,m){var c=4;return f(_,m)&&c<=_.length-m}function S(_,m){if(m+1<_.length&&f(_,m)){var c=4,v=u(_,m),y=c;v!=null&&v.frameLength&&(y=v.frameLength);var d=m+y;return d===_.length||g(_,d)}return!1}},"./src/demux/sample-aes.ts":function(r,i,t){t.r(i);var n=t("./src/crypt/decrypter.ts"),a=t("./src/demux/tsdemuxer.ts"),o=function(){function l(p,u,f){this.keyData=void 0,this.decrypter=void 0,this.keyData=f,this.decrypter=new n.default(p,u,{removePKCS7Padding:!1})}var h=l.prototype;return h.decryptBuffer=function(u,f){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,f)},h.decryptAacSample=function(u,f,g,E){var S=u[f].unit,_=S.subarray(16,S.length-S.length%16),m=_.buffer.slice(_.byteOffset,_.byteOffset+_.length),c=this;this.decryptBuffer(m,function(v){var y=new Uint8Array(v);S.set(y,16),E||c.decryptAacSamples(u,f+1,g)})},h.decryptAacSamples=function(u,f,g){for(;;f++){if(f>=u.length){g();return}if(!(u[f].unit.length<32)){var E=this.decrypter.isSync();if(this.decryptAacSample(u,f,g,E),!E)return}}},h.getAvcEncryptedData=function(u){for(var f=Math.floor((u.length-48)/160)*16+16,g=new Int8Array(f),E=0,S=32;S<u.length-16;S+=160,E+=16)g.set(u.subarray(S,S+16),E);return g},h.getAvcDecryptedUnit=function(u,f){for(var g=new Uint8Array(f),E=0,S=32;S<u.length-16;S+=160,E+=16)u.set(g.subarray(E,E+16),S);return u},h.decryptAvcSample=function(u,f,g,E,S,_){var m=Object(a.discardEPB)(S.data),c=this.getAvcEncryptedData(m),v=this;this.decryptBuffer(c.buffer,function(y){S.data=v.getAvcDecryptedUnit(m,y),_||v.decryptAvcSamples(u,f,g+1,E)})},h.decryptAvcSamples=function(u,f,g,E){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;f++,g=0){if(f>=u.length){E();return}for(var S=u[f].units;!(g>=S.length);g++){var _=S[g];if(!(_.data.length<=48||_.type!==1&&_.type!==5)){var m=this.decrypter.isSync();if(this.decryptAvcSample(u,f,g,E,_,m),!m)return}}}},l}();i.default=o},"./src/demux/transmuxer-interface.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return g});var n=t("./node_modules/webworkify-webpack/index.js"),a=t("./src/events.ts"),o=t("./src/demux/transmuxer.ts"),l=t("./src/utils/logger.ts"),h=t("./src/errors.ts"),p=t("./src/utils/mediasource-helper.ts"),u=t("./node_modules/eventemitter3/index.js"),f=Object(p.getMediaSource)()||{isTypeSupported:function(){return!1}},g=function(){function E(_,m,c,v){var y=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=_,this.id=m,this.onTransmuxComplete=c,this.onFlush=v;var d=_.config,x=function(R,w){w=w||{},w.frag=y.frag,w.id=y.id,_.trigger(R,w)};this.observer=new u.EventEmitter,this.observer.on(a.Events.FRAG_DECRYPTED,x),this.observer.on(a.Events.ERROR,x);var b={mp4:f.isTypeSupported("video/mp4"),mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"')},T=navigator.vendor;if(d.enableWorker&&typeof Worker!="undefined"){l.logger.log("demuxing in webworker");var A;try{A=this.worker=n("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),A.addEventListener("message",this.onwmsg),A.onerror=function(L){_.trigger(a.Events.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(L.message+"  ("+L.filename+":"+L.lineno+")")})},A.postMessage({cmd:"init",typeSupported:b,vendor:T,id:m,config:JSON.stringify(d)})}catch(L){l.logger.warn("Error in worker:",L),l.logger.error("Error while initializing DemuxerWorker, fallback to inline"),A&&self.URL.revokeObjectURL(A.objectURL),this.transmuxer=new o.default(this.observer,b,d,T,m),this.worker=null}}else this.transmuxer=new o.default(this.observer,b,d,T,m)}var S=E.prototype;return S.destroy=function(){var m=this.worker;if(m)m.removeEventListener("message",this.onwmsg),m.terminate(),this.worker=null;else{var c=this.transmuxer;c&&(c.destroy(),this.transmuxer=null)}var v=this.observer;v&&v.removeAllListeners(),this.observer=null},S.push=function(m,c,v,y,d,x,b,T,A,L){var R,w,O=this;A.transmuxing.start=self.performance.now();var I=this.transmuxer,D=this.worker,C=x?x.start:d.start,P=d.decryptdata,M=this.frag,N=!(M&&d.cc===M.cc),B=!(M&&A.level===M.level),U=M?A.sn-M.sn:-1,F=this.part?A.part-this.part.index:1,j=!B&&(U===1||U===0&&F===1),V=self.performance.now();(B||U||d.stats.parsing.start===0)&&(d.stats.parsing.start=V),x&&(F||!j)&&(x.stats.parsing.start=V);var G=!(M&&((R=d.initSegment)===null||R===void 0?void 0:R.url)===((w=M.initSegment)===null||w===void 0?void 0:w.url)),Y=new o.TransmuxState(N,j,T,B,C,G);if(!j||N||G){l.logger.log("[transmuxer-interface, "+d.type+"]: Starting new transmux session for sn: "+A.sn+" p: "+A.part+" level: "+A.level+" id: "+A.id+`
        discontinuity: `+N+`
        trackSwitch: `+B+`
        contiguous: `+j+`
        accurateTimeOffset: `+T+`
        timeOffset: `+C+`
        initSegmentChange: `+G);var X=new o.TransmuxConfig(v,y,c,b,L);this.configureTransmuxer(X)}if(this.frag=d,this.part=x,D)D.postMessage({cmd:"demux",data:m,decryptdata:P,chunkMeta:A,state:Y},m instanceof ArrayBuffer?[m]:[]);else if(I){var ie=I.push(m,P,A,Y);Object(o.isPromise)(ie)?ie.then(function(he){O.handleTransmuxComplete(he)}):this.handleTransmuxComplete(ie)}},S.flush=function(m){var c=this;m.transmuxing.start=self.performance.now();var v=this.transmuxer,y=this.worker;if(y)y.postMessage({cmd:"flush",chunkMeta:m});else if(v){var d=v.flush(m);Object(o.isPromise)(d)?d.then(function(x){c.handleFlushResult(x,m)}):this.handleFlushResult(d,m)}},S.handleFlushResult=function(m,c){var v=this;m.forEach(function(y){v.handleTransmuxComplete(y)}),this.onFlush(c)},S.onWorkerMessage=function(m){var c=m.data,v=this.hls;switch(c.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.id=this.id,v.trigger(c.event,c.data);break}}},S.configureTransmuxer=function(m){var c=this.worker,v=this.transmuxer;c?c.postMessage({cmd:"configure",config:m}):v&&v.configure(m)},S.handleTransmuxComplete=function(m){m.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(m)},E}()},"./src/demux/transmuxer-worker.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return h});var n=t("./src/demux/transmuxer.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),l=t("./node_modules/eventemitter3/index.js");function h(E){var S=new l.EventEmitter,_=function(c,v){E.postMessage({event:c,data:v})};S.on(a.Events.FRAG_DECRYPTED,_),S.on(a.Events.ERROR,_),E.addEventListener("message",function(m){var c=m.data;switch(c.cmd){case"init":{var v=JSON.parse(c.config);E.transmuxer=new n.default(S,c.typeSupported,v,c.vendor,c.id),Object(o.enableLogs)(v.debug),_("init",null);break}case"configure":{E.transmuxer.configure(c.config);break}case"demux":{var y=E.transmuxer.push(c.data,c.decryptdata,c.chunkMeta,c.state);Object(n.isPromise)(y)?y.then(function(b){p(E,b)}):p(E,y);break}case"flush":{var d=c.chunkMeta,x=E.transmuxer.flush(d);Object(n.isPromise)(x)?x.then(function(b){f(E,b,d)}):f(E,x,d);break}}})}function p(E,S){if(!g(S.remuxResult)){var _=[],m=S.remuxResult,c=m.audio,v=m.video;c&&u(_,c),v&&u(_,v),E.postMessage({event:"transmuxComplete",data:S},_)}}function u(E,S){S.data1&&E.push(S.data1.buffer),S.data2&&E.push(S.data2.buffer)}function f(E,S,_){S.forEach(function(m){p(E,m)}),E.postMessage({event:"flush",data:_})}function g(E){return!E.audio&&!E.video&&!E.text&&!E.id3&&!E.initSegment}},"./src/demux/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return y}),t.d(i,"isPromise",function(){return b}),t.d(i,"TransmuxConfig",function(){return T}),t.d(i,"TransmuxState",function(){return A});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/crypt/decrypter.ts"),l=t("./src/demux/aacdemuxer.ts"),h=t("./src/demux/mp4demuxer.ts"),p=t("./src/demux/tsdemuxer.ts"),u=t("./src/demux/mp3demuxer.ts"),f=t("./src/remux/mp4-remuxer.ts"),g=t("./src/remux/passthrough-remuxer.ts"),E=t("./src/demux/chunk-cache.ts"),S=t("./src/utils/mp4-tools.ts"),_=t("./src/utils/logger.ts"),m;try{m=self.performance.now.bind(self.performance)}catch(L){_.logger.debug("Unable to use Performance API on this environment"),m=self.Date.now}var c=[{demux:p.default,remux:f.default},{demux:h.default,remux:g.default},{demux:l.default,remux:f.default},{demux:u.default,remux:f.default}],v=1024;c.forEach(function(L){var R=L.demux;v=Math.max(v,R.minProbeByteLength)});var y=function(){function L(w,O,I,D,C){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new E.default,this.observer=w,this.typeSupported=O,this.config=I,this.vendor=D,this.id=C}var R=L.prototype;return R.configure=function(O){this.transmuxConfig=O,this.decrypter&&this.decrypter.reset()},R.push=function(O,I,D,C){var P=this,M=D.transmuxing;M.executeStart=m();var N=new Uint8Array(O),B=this.cache,U=this.config,F=this.currentTransmuxState,j=this.transmuxConfig;C&&(this.currentTransmuxState=C);var V=d(N,I);if(V&&V.method==="AES-128"){var G=this.getDecrypter();if(U.enableSoftwareAES){var Y=G.softwareDecrypt(N,V.key.buffer,V.iv.buffer);if(!Y)return M.executeEnd=m(),x(D);N=new Uint8Array(Y)}else return this.decryptionPromise=G.webCryptoDecrypt(N,V.key.buffer,V.iv.buffer).then(function(Fe){var Se=P.push(Fe,null,D);return P.decryptionPromise=null,Se}),this.decryptionPromise}var X=C||F,ie=X.contiguous,he=X.discontinuity,de=X.trackSwitch,Ae=X.accurateTimeOffset,pe=X.timeOffset,le=X.initSegmentChange,Ie=j.audioCodec,Ce=j.videoCodec,Ue=j.defaultInitPts,Me=j.duration,ze=j.initSegmentData;if((he||de||le)&&this.resetInitSegment(ze,Ie,Ce,Me),(he||le)&&this.resetInitialTimestamp(Ue),ie||this.resetContiguity(),this.needsProbing(N,he,de)){if(B.dataLength){var Ge=B.flush();N=Object(S.appendUint8Array)(Ge,N)}this.configureTransmuxer(N,j)}var $e=this.transmux(N,V,pe,Ae,D),He=this.currentTransmuxState;return He.contiguous=!0,He.discontinuity=!1,He.trackSwitch=!1,M.executeEnd=m(),$e},R.flush=function(O){var I=this,D=O.transmuxing;D.executeStart=m();var C=this.decrypter,P=this.cache,M=this.currentTransmuxState,N=this.decryptionPromise;if(N)return N.then(function(){return I.flush(O)});var B=[],U=M.timeOffset;if(C){var F=C.flush();F&&B.push(this.push(F,null,O))}var j=P.dataLength;P.reset();var V=this.demuxer,G=this.remuxer;if(!V||!G)return j>=v&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),D.executeEnd=m(),[x(O)];var Y=V.flush(U);return b(Y)?Y.then(function(X){return I.flushRemux(B,X,O),B}):(this.flushRemux(B,Y,O),B)},R.flushRemux=function(O,I,D){var C=I.audioTrack,P=I.avcTrack,M=I.id3Track,N=I.textTrack,B=this.currentTransmuxState,U=B.accurateTimeOffset,F=B.timeOffset;_.logger.log("[transmuxer.ts]: Flushed fragment "+D.sn+(D.part>-1?" p: "+D.part:"")+" of level "+D.level);var j=this.remuxer.remux(C,P,M,N,F,U,!0,this.id);O.push({remuxResult:j,chunkMeta:D}),D.transmuxing.executeEnd=m()},R.resetInitialTimestamp=function(O){var I=this.demuxer,D=this.remuxer;!I||!D||(I.resetTimeStamp(O),D.resetTimeStamp(O))},R.resetContiguity=function(){var O=this.demuxer,I=this.remuxer;!O||!I||(O.resetContiguity(),I.resetNextTimestamp())},R.resetInitSegment=function(O,I,D,C){var P=this.demuxer,M=this.remuxer;!P||!M||(P.resetInitSegment(I,D,C),M.resetInitSegment(O,I,D))},R.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},R.transmux=function(O,I,D,C,P){var M;return I&&I.method==="SAMPLE-AES"?M=this.transmuxSampleAes(O,I,D,C,P):M=this.transmuxUnencrypted(O,D,C,P),M},R.transmuxUnencrypted=function(O,I,D,C){var P=this.demuxer.demux(O,I,!1,!this.config.progressive),M=P.audioTrack,N=P.avcTrack,B=P.id3Track,U=P.textTrack,F=this.remuxer.remux(M,N,B,U,I,D,!1,this.id);return{remuxResult:F,chunkMeta:C}},R.transmuxSampleAes=function(O,I,D,C,P){var M=this;return this.demuxer.demuxSampleAes(O,I,D).then(function(N){var B=M.remuxer.remux(N.audioTrack,N.avcTrack,N.id3Track,N.textTrack,D,C,!1,M.id);return{remuxResult:B,chunkMeta:P}})},R.configureTransmuxer=function(O,I){for(var D=this.config,C=this.observer,P=this.typeSupported,M=this.vendor,N=I.audioCodec,B=I.defaultInitPts,U=I.duration,F=I.initSegmentData,j=I.videoCodec,V,G=0,Y=c.length;G<Y;G++)if(c[G].demux.probe(O)){V=c[G];break}V||(_.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),V={demux:h.default,remux:g.default});var X=this.demuxer,ie=this.remuxer,he=V.remux,de=V.demux;(!ie||!(ie instanceof he))&&(this.remuxer=new he(C,D,P,M)),(!X||!(X instanceof de))&&(this.demuxer=new de(C,D,P),this.probe=de.probe),this.resetInitSegment(F,N,j,U),this.resetInitialTimestamp(B)},R.needsProbing=function(O,I,D){return!this.demuxer||!this.remuxer||I||D},R.getDecrypter=function(){var O=this.decrypter;return O||(O=this.decrypter=new o.default(this.observer,this.config)),O},L}();function d(L,R){var w=null;return L.byteLength>0&&R!=null&&R.key!=null&&R.iv!==null&&R.method!=null&&(w=R),w}var x=function(R){return{remuxResult:{},chunkMeta:R}};function b(L){return"then"in L&&L.then instanceof Function}var T=function(R,w,O,I,D){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=R,this.videoCodec=w,this.initSegmentData=O,this.duration=I,this.defaultInitPts=D},A=function(R,w,O,I,D,C){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=R,this.contiguous=w,this.accurateTimeOffset=O,this.trackSwitch=I,this.timeOffset=D,this.initSegmentChange=C}},"./src/demux/tsdemuxer.ts":function(r,i,t){t.r(i),t.d(i,"discardEPB",function(){return x});var n=t("./src/demux/adts.ts"),a=t("./src/demux/mpegaudio.ts"),o=t("./src/demux/exp-golomb.ts"),l=t("./src/demux/id3.ts"),h=t("./src/demux/sample-aes.ts"),p=t("./src/events.ts"),u=t("./src/utils/mp4-tools.ts"),f=t("./src/utils/logger.ts"),g=t("./src/errors.ts"),E={video:1,audio:2,id3:3,text:4},S=function(){function b(A,L,R){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=A,this.config=L,this.typeSupported=R}b.probe=function(L){var R=b.syncOffset(L);return R<0?!1:(R&&f.logger.warn("MPEG2-TS detected but first sync word found @ offset "+R+", junk ahead ?"),!0)},b.syncOffset=function(L){for(var R=Math.min(1e3,L.length-3*188),w=0;w<R;){if(L[w]===71&&L[w+188]===71&&L[w+2*188]===71)return w;w++}return-1},b.createTrack=function(L,R){return{container:L==="video"||L==="audio"?"video/mp2t":void 0,type:L,id:E[L],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:L==="audio"?R:void 0}};var T=b.prototype;return T.resetInitSegment=function(L,R,w){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=b.createTrack("video",w),this._audioTrack=b.createTrack("audio",w),this._id3Track=b.createTrack("id3",w),this._txtTrack=b.createTrack("text",w),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=L,this.videoCodec=R,this._duration=w},T.resetTimeStamp=function(){},T.resetContiguity=function(){var L=this._audioTrack,R=this._avcTrack,w=this._id3Track;L&&(L.pesData=null),R&&(R.pesData=null),w&&(w.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},T.demux=function(L,R,w,O){w===void 0&&(w=!1),O===void 0&&(O=!1),w||(this.sampleAes=null);var I,D=this._avcTrack,C=this._audioTrack,P=this._id3Track,M=D.pid,N=D.pesData,B=C.pid,U=P.pid,F=C.pesData,j=P.pesData,V=!1,G=this.pmtParsed,Y=this._pmtId,X=L.length;if(this.remainderData&&(L=Object(u.appendUint8Array)(this.remainderData,L),X=L.length,this.remainderData=null),X<188&&!O)return this.remainderData=L,{audioTrack:C,avcTrack:D,id3Track:P,textTrack:this._txtTrack};var ie=Math.max(0,b.syncOffset(L));X-=(X+ie)%188,X<L.byteLength&&!O&&(this.remainderData=new Uint8Array(L.buffer,X,L.buffer.byteLength-X));for(var he=0,de=ie;de<X;de+=188)if(L[de]===71){var Ae=!!(L[de+1]&64),pe=((L[de+1]&31)<<8)+L[de+2],le=(L[de+3]&48)>>4,Ie=void 0;if(le>1){if(Ie=de+5+L[de+4],Ie===de+188)continue}else Ie=de+4;switch(pe){case M:Ae&&(N&&(I=v(N))&&this.parseAVCPES(I,!1),N={data:[],size:0}),N&&(N.data.push(L.subarray(Ie,de+188)),N.size+=de+188-Ie);break;case B:Ae&&(F&&(I=v(F))&&(C.isAAC?this.parseAACPES(I):this.parseMPEGPES(I)),F={data:[],size:0}),F&&(F.data.push(L.subarray(Ie,de+188)),F.size+=de+188-Ie);break;case U:Ae&&(j&&(I=v(j))&&this.parseID3PES(I),j={data:[],size:0}),j&&(j.data.push(L.subarray(Ie,de+188)),j.size+=de+188-Ie);break;case 0:Ae&&(Ie+=L[Ie]+1),Y=this._pmtId=m(L,Ie);break;case Y:{Ae&&(Ie+=L[Ie]+1);var Ce=c(L,Ie,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,w);M=Ce.avc,M>0&&(D.pid=M),B=Ce.audio,B>0&&(C.pid=B,C.isAAC=Ce.isAAC),U=Ce.id3,U>0&&(P.pid=U),V&&!G&&(f.logger.log("reparse from beginning"),V=!1,de=ie-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:V=!0;break}}else he++;he>0&&this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+he+" TS packet/s that do not start with 0x47"}),D.pesData=N,C.pesData=F,P.pesData=j;var Ue={audioTrack:C,avcTrack:D,id3Track:P,textTrack:this._txtTrack};return O&&this.extractRemainingSamples(Ue),Ue},T.flush=function(){var L=this.remainderData;this.remainderData=null;var R;return L?R=this.demux(L,-1,!1,!0):R={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(R),this.sampleAes?this.decrypt(R,this.sampleAes):R},T.extractRemainingSamples=function(L){var R=L.audioTrack,w=L.avcTrack,O=L.id3Track,I=w.pesData,D=R.pesData,C=O.pesData,P;I&&(P=v(I))?(this.parseAVCPES(P,!0),w.pesData=null):w.pesData=I,D&&(P=v(D))?(R.isAAC?this.parseAACPES(P):this.parseMPEGPES(P),R.pesData=null):(D!=null&&D.size&&f.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=D),C&&(P=v(C))?(this.parseID3PES(P),O.pesData=null):O.pesData=C},T.demuxSampleAes=function(L,R,w){var O=this.demux(L,w,!0,!this.config.progressive),I=this.sampleAes=new h.default(this.observer,this.config,R);return this.decrypt(O,I)},T.decrypt=function(L,R){return new Promise(function(w){var O=L.audioTrack,I=L.avcTrack;O.samples&&O.isAAC?R.decryptAacSamples(O.samples,0,function(){I.samples?R.decryptAvcSamples(I.samples,0,0,function(){w(L)}):w(L)}):I.samples&&R.decryptAvcSamples(I.samples,0,0,function(){w(L)})})},T.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},T.parseAVCPES=function(L,R){var w=this,O=this._avcTrack,I=this.parseAVCNALu(L.data),D=this.avcSample,C,P=!1;L.data=null,D&&I.length&&!O.audFound&&(y(D,O),D=this.avcSample=_(!1,L.pts,L.dts,"")),I.forEach(function(M){switch(M.type){case 1:{C=!0,D||(D=w.avcSample=_(!0,L.pts,L.dts,"")),D.frame=!0;var N=M.data;if(P&&N.length>4){var B=new o.default(N).readSliceType();(B===2||B===4||B===7||B===9)&&(D.key=!0)}break}case 5:C=!0,D||(D=w.avcSample=_(!0,L.pts,L.dts,"")),D.key=!0,D.frame=!0;break;case 6:{C=!0;var U=new o.default(x(M.data));U.readUByte();for(var F=0,j=0,V=!1,G=0;!V&&U.bytesAvailable>1;){F=0;do G=U.readUByte(),F+=G;while(G===255);j=0;do G=U.readUByte(),j+=G;while(G===255);if(F===4&&U.bytesAvailable!==0){V=!0;var Y=U.readUByte();if(Y===181){var X=U.readUShort();if(X===49){var ie=U.readUInt();if(ie===1195456820){var he=U.readUByte();if(he===3){for(var de=U.readUByte(),Ae=U.readUByte(),pe=31&de,le=[de,Ae],Ie=0;Ie<pe;Ie++)le.push(U.readUByte()),le.push(U.readUByte()),le.push(U.readUByte());d(w._txtTrack.samples,{type:3,pts:L.pts,bytes:le})}}}}}else if(F===5&&U.bytesAvailable!==0){if(V=!0,j>16){for(var Ce=[],Ue=0;Ue<16;Ue++)Ce.push(U.readUByte().toString(16)),(Ue===3||Ue===5||Ue===7||Ue===9)&&Ce.push("-");for(var Me=j-16,ze=new Uint8Array(Me),Ge=0;Ge<Me;Ge++)ze[Ge]=U.readUByte();d(w._txtTrack.samples,{pts:L.pts,payloadType:F,uuid:Ce.join(""),userData:Object(l.utf8ArrayToStr)(ze),userDataBytes:ze})}}else if(j<U.bytesAvailable)for(var $e=0;$e<j;$e++)U.readUByte()}break}case 7:if(C=!0,P=!0,!O.sps){var He=new o.default(M.data),Fe=He.readSPS();O.width=Fe.width,O.height=Fe.height,O.pixelRatio=Fe.pixelRatio,O.sps=[M.data],O.duration=w._duration;for(var Se=M.data.subarray(1,4),Xe="avc1.",st=0;st<3;st++){var et=Se[st].toString(16);et.length<2&&(et="0"+et),Xe+=et}O.codec=Xe}break;case 8:C=!0,O.pps||(O.pps=[M.data]);break;case 9:C=!1,O.audFound=!0,D&&y(D,O),D=w.avcSample=_(!1,L.pts,L.dts,"");break;case 12:C=!1;break;default:C=!1,D&&(D.debug+="unknown NAL "+M.type+" ");break}if(D&&C){var ot=D.units;ot.push(M)}}),R&&D&&(y(D,O),this.avcSample=null)},T.getLastNalUnit=function(){var L,R=this.avcSample,w;if(!R||R.units.length===0){var O=this._avcTrack.samples;R=O[O.length-1]}if((L=R)!==null&&L!==void 0&&L.units){var I=R.units;w=I[I.length-1]}return w},T.parseAVCNALu=function(L){var R=L.byteLength,w=this._avcTrack,O=w.naluState||0,I=O,D=[],C=0,P,M,N,B=-1,U=0;for(O===-1&&(B=0,U=L[0]&31,O=0,C=1);C<R;){if(P=L[C++],!O){O=P?0:1;continue}if(O===1){O=P?0:2;continue}if(!P)O=3;else if(P===1){if(B>=0){var F={data:L.subarray(B,C-O-1),type:U};D.push(F)}else{var j=this.getLastNalUnit();if(j&&(I&&C<=4-I&&j.state&&(j.data=j.data.subarray(0,j.data.byteLength-I)),M=C-O-1,M>0)){var V=new Uint8Array(j.data.byteLength+M);V.set(j.data,0),V.set(L.subarray(0,M),j.data.byteLength),j.data=V,j.state=0}}C<R?(N=L[C]&31,B=C,U=N,O=0):O=-1}else O=0}if(B>=0&&O>=0){var G={data:L.subarray(B,R),type:U,state:O};D.push(G)}if(D.length===0){var Y=this.getLastNalUnit();if(Y){var X=new Uint8Array(Y.data.byteLength+L.byteLength);X.set(Y.data,0),X.set(L,Y.data.byteLength),Y.data=X}}return w.naluState=O,D},T.parseAACPES=function(L){var R=0,w=this._audioTrack,O=this.aacOverFlow,I=L.data;if(O){this.aacOverFlow=null;var D=O.sample.unit.byteLength,C=Math.min(O.missing,D),P=D-C;O.sample.unit.set(I.subarray(0,C),P),w.samples.push(O.sample),R=O.missing}var M,N;for(M=R,N=I.length;M<N-1&&!n.isHeader(I,M);M++);if(M!==R){var B,U;if(M<N-1?(B="AAC PES did not start with ADTS header,offset:"+M,U=!1):(B="no ADTS header found in AAC PES",U=!0),f.logger.warn("parsing error:"+B),this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.FRAG_PARSING_ERROR,fatal:U,reason:B}),U)return}n.initTrackConfig(w,this.observer,I,M,this.audioCodec);var F;if(L.pts!==void 0)F=L.pts;else if(O){var j=n.getFrameDuration(w.samplerate);F=O.sample.pts+j}else{f.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var V=0;M<N;)if(n.isHeader(I,M)){if(M+5<N){var G=n.appendFrame(w,I,M,F,V);if(G)if(G.missing)this.aacOverFlow=G;else{M+=G.length,V++;continue}}break}else M++},T.parseMPEGPES=function(L){var R=L.data,w=R.length,O=0,I=0,D=L.pts;if(D===void 0){f.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;I<w;)if(a.isHeader(R,I)){var C=a.appendFrame(this._audioTrack,R,I,D,O);if(C)I+=C.length,O++;else break}else I++},T.parseID3PES=function(L){if(L.pts===void 0){f.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(L)},b}();S.minProbeByteLength=188;function _(b,T,A,L){return{key:b,frame:!1,pts:T,dts:A,units:[],debug:L,length:0}}function m(b,T){return(b[T+10]&31)<<8|b[T+11]}function c(b,T,A,L){var R={audio:-1,avc:-1,id3:-1,isAAC:!0},w=(b[T+1]&15)<<8|b[T+2],O=T+3+w-4,I=(b[T+10]&15)<<8|b[T+11];for(T+=12+I;T<O;){var D=(b[T+1]&31)<<8|b[T+2];switch(b[T]){case 207:if(!L){f.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:R.audio===-1&&(R.audio=D);break;case 21:R.id3===-1&&(R.id3=D);break;case 219:if(!L){f.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:R.avc===-1&&(R.avc=D);break;case 3:case 4:A?R.audio===-1&&(R.audio=D,R.isAAC=!1):f.logger.log("MPEG audio found, not supported in this browser");break;case 36:f.logger.warn("Unsupported HEVC stream type found");break}T+=((b[T+3]&15)<<8|b[T+4])+5}return R}function v(b){var T=0,A,L,R,w,O,I=b.data;if(!b||b.size===0)return null;for(;I[0].length<19&&I.length>1;){var D=new Uint8Array(I[0].length+I[1].length);D.set(I[0]),D.set(I[1],I[0].length),I[0]=D,I.splice(1,1)}A=I[0];var C=(A[0]<<16)+(A[1]<<8)+A[2];if(C===1){if(L=(A[4]<<8)+A[5],L&&L>b.size-6)return null;var P=A[7];P&192&&(w=(A[9]&14)*536870912+(A[10]&255)*4194304+(A[11]&254)*16384+(A[12]&255)*128+(A[13]&254)/2,P&64?(O=(A[14]&14)*536870912+(A[15]&255)*4194304+(A[16]&254)*16384+(A[17]&255)*128+(A[18]&254)/2,w-O>60*9e4&&(f.logger.warn(Math.round((w-O)/9e4)+"s delta between PTS and DTS, align them"),w=O)):O=w),R=A[8];var M=R+9;if(b.size<=M)return null;b.size-=M;for(var N=new Uint8Array(b.size),B=0,U=I.length;B<U;B++){A=I[B];var F=A.byteLength;if(M)if(M>F){M-=F;continue}else A=A.subarray(M),F-=M,M=0;N.set(A,T),T+=F}return L&&(L-=R+3),{data:N,pts:w,dts:O,len:L}}return null}function y(b,T){if(b.units.length&&b.frame){if(b.pts===void 0){var A=T.samples,L=A.length;if(L){var R=A[L-1];b.pts=R.pts,b.dts=R.dts}else{T.dropped++;return}}T.samples.push(b)}b.debug.length&&f.logger.log(b.pts+"/"+b.dts+":"+b.debug)}function d(b,T){var A=b.length;if(A>0){if(T.pts>=b[A-1].pts)b.push(T);else for(var L=A-1;L>=0;L--)if(T.pts<b[L].pts){b.splice(L,0,T);break}}else b.push(T)}function x(b){for(var T=b.byteLength,A=[],L=1;L<T-2;)b[L]===0&&b[L+1]===0&&b[L+2]===3?(A.push(L+2),L+=2):L++;if(A.length===0)return b;var R=T-A.length,w=new Uint8Array(R),O=0;for(L=0;L<R;O++,L++)O===A[0]&&(O++,A.shift()),w[L]=b[O];return w}i.default=S},"./src/errors.ts":function(r,i,t){t.r(i),t.d(i,"ErrorTypes",function(){return n}),t.d(i,"ErrorDetails",function(){return a});var n;(function(o){o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError"})(n||(n={}));var a;(function(o){o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown"})(a||(a={}))},"./src/events.ts":function(r,i,t){t.r(i),t.d(i,"Events",function(){return n});var n;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(n||(n={}))},"./src/hls.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return d});var n=t("./node_modules/url-toolkit/src/url-toolkit.js"),a=t("./src/loader/playlist-loader.ts"),o=t("./src/loader/key-loader.ts"),l=t("./src/controller/id3-track-controller.ts"),h=t("./src/controller/latency-controller.ts"),p=t("./src/controller/level-controller.ts"),u=t("./src/controller/fragment-tracker.ts"),f=t("./src/controller/stream-controller.ts"),g=t("./src/is-supported.ts"),E=t("./src/utils/logger.ts"),S=t("./src/config.ts"),_=t("./node_modules/eventemitter3/index.js"),m=t("./src/events.ts"),c=t("./src/errors.ts");function v(x,b){for(var T=0;T<b.length;T++){var A=b[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(x,A.key,A)}}function y(x,b,T){return b&&v(x.prototype,b),T&&v(x,T),x}var d=function(){x.isSupported=function(){return Object(g.isSupported)()};function x(T){T===void 0&&(T={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new _.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var A=this.config=Object(S.mergeConfig)(x.DefaultConfig,T);this.userConfig=T,Object(E.enableLogs)(A.debug),this._autoLevelCapping=-1,A.progressive&&Object(S.enableStreamingMode)(A);var L=A.abrController,R=A.bufferController,w=A.capLevelController,O=A.fpsController,I=this.abrController=new L(this),D=this.bufferController=new R(this),C=this.capLevelController=new w(this),P=new O(this),M=new a.default(this),N=new o.default(this),B=new l.default(this),U=this.levelController=new p.default(this),F=new u.FragmentTracker(this),j=this.streamController=new f.default(this,F);C.setStreamController(j),P.setStreamController(j);var V=[U,j];this.networkControllers=V;var G=[M,N,I,D,C,P,B,F];this.audioTrackController=this.createController(A.audioTrackController,null,V),this.createController(A.audioStreamController,F,V),this.subtitleTrackController=this.createController(A.subtitleTrackController,null,V),this.createController(A.subtitleStreamController,F,V),this.createController(A.timelineController,null,G),this.emeController=this.createController(A.emeController,null,G),this.cmcdController=this.createController(A.cmcdController,null,G),this.latencyController=this.createController(h.default,null,G),this.coreComponents=G}var b=x.prototype;return b.createController=function(A,L,R){if(A){var w=L?new A(this,L):new A(this);return R&&R.push(w),w}return null},b.on=function(A,L,R){R===void 0&&(R=this),this._emitter.on(A,L,R)},b.once=function(A,L,R){R===void 0&&(R=this),this._emitter.once(A,L,R)},b.removeAllListeners=function(A){this._emitter.removeAllListeners(A)},b.off=function(A,L,R,w){R===void 0&&(R=this),this._emitter.off(A,L,R,w)},b.listeners=function(A){return this._emitter.listeners(A)},b.emit=function(A,L,R){return this._emitter.emit(A,L,R)},b.trigger=function(A,L){if(this.config.debug)return this.emit(A,A,L);try{return this.emit(A,A,L)}catch(R){E.logger.error("An internal error happened while handling event "+A+'. Error message: "'+R.message+'". Here is a stacktrace:',R),this.trigger(m.Events.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:A,error:R})}return!1},b.listenerCount=function(A){return this._emitter.listenerCount(A)},b.destroy=function(){E.logger.log("destroy"),this.trigger(m.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(A){return A.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(A){return A.destroy()}),this.coreComponents.length=0},b.attachMedia=function(A){E.logger.log("attachMedia"),this._media=A,this.trigger(m.Events.MEDIA_ATTACHING,{media:A})},b.detachMedia=function(){E.logger.log("detachMedia"),this.trigger(m.Events.MEDIA_DETACHING,void 0),this._media=null},b.loadSource=function(A){this.stopLoad();var L=this.media,R=this.url,w=this.url=n.buildAbsoluteURL(self.location.href,A,{alwaysNormalize:!0});E.logger.log("loadSource:"+w),L&&R&&R!==w&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(L)),this.trigger(m.Events.MANIFEST_LOADING,{url:A})},b.startLoad=function(A){A===void 0&&(A=-1),E.logger.log("startLoad("+A+")"),this.networkControllers.forEach(function(L){L.startLoad(A)})},b.stopLoad=function(){E.logger.log("stopLoad"),this.networkControllers.forEach(function(A){A.stopLoad()})},b.swapAudioCodec=function(){E.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},b.recoverMediaError=function(){E.logger.log("recoverMediaError");var A=this._media;this.detachMedia(),A&&this.attachMedia(A)},b.removeLevel=function(A,L){L===void 0&&(L=0),this.levelController.removeLevel(A,L)},y(x,[{key:"levels",get:function(){var A=this.levelController.levels;return A||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(A){E.logger.log("set currentLevel:"+A),this.loadLevel=A,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(A){E.logger.log("set nextLevel:"+A),this.levelController.manualLevel=A,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(A){E.logger.log("set loadLevel:"+A),this.levelController.manualLevel=A}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(A){this.levelController.nextLoadLevel=A}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(A){E.logger.log("set firstLevel:"+A),this.levelController.firstLevel=A}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(A){E.logger.log("set startLevel:"+A),A!==-1&&(A=Math.max(A,this.minAutoLevel)),this.levelController.startLevel=A}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(A){var L=!!A;L!==this.config.capLevelToPlayerSize&&(L?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=L)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(A){this._autoLevelCapping!==A&&(E.logger.log("set autoLevelCapping:"+A),this._autoLevelCapping=A)}},{key:"bandwidthEstimate",get:function(){var A=this.abrController.bwEstimator;return A?A.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var A=this.levels,L=this.config.minAutoBitrate;if(!A)return 0;for(var R=A.length,w=0;w<R;w++)if(A[w].maxBitrate>L)return w;return 0}},{key:"maxAutoLevel",get:function(){var A=this.levels,L=this.autoLevelCapping,R;return L===-1&&A&&A.length?R=A.length-1:R=L,R}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(A){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,A)}},{key:"audioTracks",get:function(){var A=this.audioTrackController;return A?A.audioTracks:[]}},{key:"audioTrack",get:function(){var A=this.audioTrackController;return A?A.audioTrack:-1},set:function(A){var L=this.audioTrackController;L&&(L.audioTrack=A)}},{key:"subtitleTracks",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTrack:-1},set:function(A){var L=this.subtitleTrackController;L&&(L.subtitleTrack=A)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var A=this.subtitleTrackController;return A?A.subtitleDisplay:!1},set:function(A){var L=this.subtitleTrackController;L&&(L.subtitleDisplay=A)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(A){this.config.lowLatencyMode=A}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return m.Events}},{key:"ErrorTypes",get:function(){return c.ErrorTypes}},{key:"ErrorDetails",get:function(){return c.ErrorDetails}},{key:"DefaultConfig",get:function(){return x.defaultConfig?x.defaultConfig:S.hlsDefaultConfig},set:function(A){x.defaultConfig=A}}]),x}();d.defaultConfig=void 0},"./src/is-supported.ts":function(r,i,t){t.r(i),t.d(i,"isSupported",function(){return o}),t.d(i,"changeTypeSupported",function(){return l});var n=t("./src/utils/mediasource-helper.ts");function a(){return self.SourceBuffer||self.WebKitSourceBuffer}function o(){var h=Object(n.getMediaSource)();if(!h)return!1;var p=a(),u=h&&typeof h.isTypeSupported=="function"&&h.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),f=!p||p.prototype&&typeof p.prototype.appendBuffer=="function"&&typeof p.prototype.remove=="function";return!!u&&!!f}function l(){var h,p=a();return typeof(p==null||(h=p.prototype)===null||h===void 0?void 0:h.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S}),t.d(i,"LoadError",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./src/errors.ts");function o(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,f(c,v)}function l(c){var v=typeof Map=="function"?new Map:void 0;return l=function(d){if(d===null||!u(d))return d;if(typeof d!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(d))return v.get(d);v.set(d,x)}function x(){return h(d,arguments,g(this).constructor)}return x.prototype=Object.create(d.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),f(x,d)},l(c)}function h(c,v,y){return p()?h=Reflect.construct:h=function(x,b,T){var A=[null];A.push.apply(A,b);var L=Function.bind.apply(x,A),R=new L;return T&&f(R,T.prototype),R},h.apply(null,arguments)}function p(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function u(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function f(c,v){return f=Object.setPrototypeOf||function(d,x){return d.__proto__=x,d},f(c,v)}function g(c){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(y){return y.__proto__||Object.getPrototypeOf(y)},g(c)}var E=Math.pow(2,17),S=function(){function c(y){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=y}var v=c.prototype;return v.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},v.abort=function(){this.loader&&this.loader.abort()},v.load=function(d,x){var b=this,T=d.url;if(!T)return Promise.reject(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,networkDetails:null},"Fragment does not have a "+(T?"part list":"url")));this.abort();var A=this.config,L=A.fLoader,R=A.loader;return new Promise(function(w,O){b.loader&&b.loader.destroy();var I=b.loader=d.loader=L?new L(A):new R(A),D=_(d),C={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:E};d.stats=I.stats,I.load(D,C,{onSuccess:function(M,N,B,U){b.resetLoader(d,I),w({frag:d,part:null,payload:M.data,networkDetails:U})},onError:function(M,N,B){b.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,response:M,networkDetails:B}))},onAbort:function(M,N,B){b.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:d,networkDetails:B}))},onTimeout:function(M,N,B){b.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:d,networkDetails:B}))},onProgress:function(M,N,B,U){x&&x({frag:d,part:null,payload:B,networkDetails:U})}})})},v.loadPart=function(d,x,b){var T=this;this.abort();var A=this.config,L=A.fLoader,R=A.loader;return new Promise(function(w,O){T.loader&&T.loader.destroy();var I=T.loader=d.loader=L?new L(A):new R(A),D=_(d,x),C={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:E};x.stats=I.stats,I.load(D,C,{onSuccess:function(M,N,B,U){T.resetLoader(d,I),T.updateStatsFromPart(d,x);var F={frag:d,part:x,payload:M.data,networkDetails:U};b(F),w(F)},onError:function(M,N,B){T.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:d,part:x,response:M,networkDetails:B}))},onAbort:function(M,N,B){d.stats.aborted=x.stats.aborted,T.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:d,part:x,networkDetails:B}))},onTimeout:function(M,N,B){T.resetLoader(d,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:d,part:x,networkDetails:B}))}})})},v.updateStatsFromPart=function(d,x){var b=d.stats,T=x.stats,A=T.total;if(b.loaded+=T.loaded,A){var L=Math.round(d.duration/x.duration),R=Math.min(Math.round(b.loaded/A),L),w=L-R,O=w*Math.round(b.loaded/R);b.total=b.loaded+O}else b.total=Math.max(b.loaded,b.total);var I=b.loading,D=T.loading;I.start?I.first+=D.first-D.start:(I.start=D.start,I.first=D.first),I.end=D.end},v.resetLoader=function(d,x){d.loader=null,this.loader===x&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),x.destroy()},c}();function _(c,v){v===void 0&&(v=null);var y=v||c,d={frag:c,part:v,responseType:"arraybuffer",url:y.url,headers:{},rangeStart:0,rangeEnd:0},x=y.byteRangeStartOffset,b=y.byteRangeEndOffset;return Object(n.isFiniteNumber)(x)&&Object(n.isFiniteNumber)(b)&&(d.rangeStart=x,d.rangeEnd=b),d}var m=function(c){o(v,c);function v(y){for(var d,x=arguments.length,b=new Array(x>1?x-1:0),T=1;T<x;T++)b[T-1]=arguments[T];return d=c.call.apply(c,[this].concat(b))||this,d.data=void 0,d.data=y,d}return v}(l(Error))},"./src/loader/fragment.ts":function(r,i,t){t.r(i),t.d(i,"ElementaryStreamTypes",function(){return E}),t.d(i,"BaseSegment",function(){return S}),t.d(i,"Fragment",function(){return _}),t.d(i,"Part",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/utils/logger.ts"),l=t("./src/loader/level-key.ts"),h=t("./src/loader/load-stats.ts");function p(c,v){c.prototype=Object.create(v.prototype),c.prototype.constructor=c,u(c,v)}function u(c,v){return u=Object.setPrototypeOf||function(d,x){return d.__proto__=x,d},u(c,v)}function f(c,v){for(var y=0;y<v.length;y++){var d=v[y];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function g(c,v,y){return v&&f(c.prototype,v),y&&f(c,y),c}var E;(function(c){c.AUDIO="audio",c.VIDEO="video",c.AUDIOVIDEO="audiovideo"})(E||(E={}));var S=function(){function c(y){var d;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(d={},d[E.AUDIO]=null,d[E.VIDEO]=null,d[E.AUDIOVIDEO]=null,d),this.baseurl=y}var v=c.prototype;return v.setByteRange=function(d,x){var b=d.split("@",2),T=[];b.length===1?T[0]=x?x.byteRangeEndOffset:0:T[0]=parseInt(b[1]),T[1]=parseInt(b[0])+T[0],this._byteRange=T},g(c,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(d){this._url=d}}]),c}(),_=function(c){p(v,c);function v(d,x){var b;return b=c.call(this,x)||this,b._decryptdata=null,b.rawProgramDateTime=null,b.programDateTime=null,b.tagList=[],b.duration=0,b.sn=0,b.levelkey=void 0,b.type=void 0,b.loader=null,b.level=-1,b.cc=0,b.startPTS=void 0,b.endPTS=void 0,b.appendedPTS=void 0,b.startDTS=void 0,b.endDTS=void 0,b.start=0,b.deltaPTS=void 0,b.maxStartPTS=void 0,b.minEndPTS=void 0,b.stats=new h.LoadStats,b.urlId=0,b.data=void 0,b.bitrateTest=!1,b.title=null,b.initSegment=null,b.type=d,b}var y=v.prototype;return y.createInitializationVector=function(x){for(var b=new Uint8Array(16),T=12;T<16;T++)b[T]=x>>8*(15-T)&255;return b},y.setDecryptDataFromLevelKey=function(x,b){var T=x;return(x==null?void 0:x.method)==="AES-128"&&x.uri&&!x.iv&&(T=l.LevelKey.fromURI(x.uri),T.method=x.method,T.iv=this.createInitializationVector(b),T.keyFormat="identity"),T},y.setElementaryStreamInfo=function(x,b,T,A,L,R){R===void 0&&(R=!1);var w=this.elementaryStreams,O=w[x];if(!O){w[x]={startPTS:b,endPTS:T,startDTS:A,endDTS:L,partial:R};return}O.startPTS=Math.min(O.startPTS,b),O.endPTS=Math.max(O.endPTS,T),O.startDTS=Math.min(O.startDTS,A),O.endDTS=Math.max(O.endDTS,L)},y.clearElementaryStreamInfo=function(){var x=this.elementaryStreams;x[E.AUDIO]=null,x[E.VIDEO]=null,x[E.AUDIOVIDEO]=null},g(v,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var x=this.sn;typeof x!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),x=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,x)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(n.isFiniteNumber)(this.programDateTime))return null;var x=Object(n.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+x*1e3}},{key:"encrypted",get:function(){var x;return!!((x=this.decryptdata)!==null&&x!==void 0&&x.keyFormat&&this.decryptdata.uri)}}]),v}(S),m=function(c){p(v,c);function v(y,d,x,b,T){var A;A=c.call(this,x)||this,A.fragOffset=0,A.duration=0,A.gap=!1,A.independent=!1,A.relurl=void 0,A.fragment=void 0,A.index=void 0,A.stats=new h.LoadStats,A.duration=y.decimalFloatingPoint("DURATION"),A.gap=y.bool("GAP"),A.independent=y.bool("INDEPENDENT"),A.relurl=y.enumeratedString("URI"),A.fragment=d,A.index=b;var L=y.enumeratedString("BYTERANGE");return L&&A.setByteRange(L,T),T&&(A.fragOffset=T.fragOffset+T.duration),A}return g(v,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var d=this.elementaryStreams;return!!(d.audio||d.video||d.audiovideo)}}]),v}(S)},"./src/loader/key-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return l});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),l=function(){function h(u){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=u,this._registerListeners()}var p=h.prototype;return p._registerListeners=function(){this.hls.on(n.Events.KEY_LOADING,this.onKeyLoading,this)},p._unregisterListeners=function(){this.hls.off(n.Events.KEY_LOADING,this.onKeyLoading)},p.destroy=function(){this._unregisterListeners();for(var f in this.loaders){var g=this.loaders[f];g&&g.destroy()}this.loaders={}},p.onKeyLoading=function(f,g){var E=g.frag,S=E.type,_=this.loaders[S];if(!E.decryptdata){o.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var m=E.decryptdata.uri;if(m!==this.decrypturl||this.decryptkey===null){var c=this.hls.config;if(_&&(o.logger.warn("abort previous key loader for type:"+S),_.abort()),!m){o.logger.warn("key uri is falsy");return}var v=c.loader,y=E.loader=this.loaders[S]=new v(c);this.decrypturl=m,this.decryptkey=null;var d={url:m,frag:E,responseType:"arraybuffer"},x={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:0},b={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};y.load(d,x,b)}else this.decryptkey&&(E.decryptdata.key=this.decryptkey,this.hls.trigger(n.Events.KEY_LOADED,{frag:E}))},p.loadsuccess=function(f,g,E){var S=E.frag;if(!S.decryptdata){o.logger.error("after key load, decryptdata unset");return}this.decryptkey=S.decryptdata.key=new Uint8Array(f.data),S.loader=null,delete this.loaders[S.type],this.hls.trigger(n.Events.KEY_LOADED,{frag:S})},p.loaderror=function(f,g){var E=g.frag,S=E.loader;S&&S.abort(),delete this.loaders[E.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:E,response:f})},p.loadtimeout=function(f,g){var E=g.frag,S=E.loader;S&&S.abort(),delete this.loaders[E.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:E})},h}()},"./src/loader/level-details.ts":function(r,i,t){t.r(i),t.d(i,"LevelDetails",function(){return h});var n=t("./src/polyfills/number.ts");function a(p,u){for(var f=0;f<u.length;f++){var g=u[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}function o(p,u,f){return u&&a(p.prototype,u),f&&a(p,f),p}var l=10,h=function(){function p(f){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=f}var u=p.prototype;return u.reloaded=function(g){if(!g){this.advanced=!0,this.updated=!0;return}var E=this.lastPartSn-g.lastPartSn,S=this.lastPartIndex-g.lastPartIndex;this.updated=this.endSN!==g.endSN||!!S||!!E,this.advanced=this.endSN>g.endSN||E>0||E===0&&S>0,this.updated||this.advanced?this.misses=Math.floor(g.misses*.6):this.misses=g.misses+1,this.availabilityDelay=g.availabilityDelay},o(p,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(n.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||l}},{key:"drift",get:function(){var g=this.driftEndTime-this.driftStartTime;if(g>0){var E=this.driftEnd-this.driftStart;return E*1e3/g}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var g;return(g=this.fragments)!==null&&g!==void 0&&g.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),p}()},"./src/loader/level-key.ts":function(r,i,t){t.r(i),t.d(i,"LevelKey",function(){return l});var n=t("./node_modules/url-toolkit/src/url-toolkit.js");function a(h,p){for(var u=0;u<p.length;u++){var f=p[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(h,f.key,f)}}function o(h,p,u){return p&&a(h.prototype,p),u&&a(h,u),h}var l=function(){h.fromURL=function(u,f){return new h(u,f)},h.fromURI=function(u){return new h(u)};function h(p,u){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,u?this._uri=Object(n.buildAbsoluteURL)(p,u,{alwaysNormalize:!0}):this._uri=p}return o(h,[{key:"uri",get:function(){return this._uri}}]),h}()},"./src/loader/load-stats.ts":function(r,i,t){t.r(i),t.d(i,"LoadStats",function(){return n});var n=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return v});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/loader/fragment.ts"),l=t("./src/loader/level-details.ts"),h=t("./src/loader/level-key.ts"),p=t("./src/utils/attr-list.ts"),u=t("./src/utils/logger.ts"),f=t("./src/utils/codecs.ts"),g=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,E=/#EXT-X-MEDIA:(.*)/g,S=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),_=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),m=/\.(mp4|m4s|m4v|m4a)$/i;function c(T){var A,L;return m.test((A=(L=a.parseURL(T))===null||L===void 0?void 0:L.path)!=null?A:"")}var v=function(){function T(){}return T.findGroup=function(L,R){for(var w=0;w<L.length;w++){var O=L[w];if(O.id===R)return O}},T.convertAVC1ToAVCOTI=function(L){var R=L.split(".");if(R.length>2){var w=R.shift()+".";return w+=parseInt(R.shift()).toString(16),w+=("000"+parseInt(R.shift()).toString(16)).substr(-4),w}return L},T.resolve=function(L,R){return a.buildAbsoluteURL(R,L,{alwaysNormalize:!0})},T.parseMasterPlaylist=function(L,R){var w=[],O={},I=!1;g.lastIndex=0;for(var D;(D=g.exec(L))!=null;)if(D[1]){var C=new p.AttrList(D[1]),P={attrs:C,bitrate:C.decimalInteger("AVERAGE-BANDWIDTH")||C.decimalInteger("BANDWIDTH"),name:C.NAME,url:T.resolve(D[2],R)},M=C.decimalResolution("RESOLUTION");M&&(P.width=M.width,P.height=M.height),y((C.CODECS||"").split(/[ ,]+/).filter(function(B){return B}),P),P.videoCodec&&P.videoCodec.indexOf("avc1")!==-1&&(P.videoCodec=T.convertAVC1ToAVCOTI(P.videoCodec)),w.push(P)}else if(D[3]){var N=new p.AttrList(D[3]);N["DATA-ID"]&&(I=!0,O[N["DATA-ID"]]=N)}return{levels:w,sessionData:I?O:null}},T.parseMasterPlaylistMedia=function(L,R,w,O){O===void 0&&(O=[]);var I,D=[],C=0;for(E.lastIndex=0;(I=E.exec(L))!==null;){var P=new p.AttrList(I[1]);if(P.TYPE===w){var M={attrs:P,bitrate:0,id:C++,groupId:P["GROUP-ID"],instreamId:P["INSTREAM-ID"],name:P.NAME||P.LANGUAGE||"",type:w,default:P.bool("DEFAULT"),autoselect:P.bool("AUTOSELECT"),forced:P.bool("FORCED"),lang:P.LANGUAGE,url:P.URI?T.resolve(P.URI,R):""};if(O.length){var N=T.findGroup(O,M.groupId)||O[0];d(M,N,"audioCodec"),d(M,N,"textCodec")}D.push(M)}}return D},T.parseLevelPlaylist=function(L,R,w,O,I){var D=new l.LevelDetails(R),C=D.fragments,P=null,M=0,N=0,B=0,U=0,F=null,j=new o.Fragment(O,R),V,G,Y,X=-1,ie=!1;for(S.lastIndex=0,D.m3u8=L;(V=S.exec(L))!==null;){ie&&(ie=!1,j=new o.Fragment(O,R),j.start=B,j.sn=M,j.cc=U,j.level=w,P&&(j.initSegment=P,j.rawProgramDateTime=P.rawProgramDateTime));var he=V[1];if(he){j.duration=parseFloat(he);var de=(" "+V[2]).slice(1);j.title=de||null,j.tagList.push(de?["INF",he,de]:["INF",he])}else if(V[3])Object(n.isFiniteNumber)(j.duration)&&(j.start=B,Y&&(j.levelkey=Y),j.sn=M,j.level=w,j.cc=U,j.urlId=I,C.push(j),j.relurl=(" "+V[3]).slice(1),b(j,F),F=j,B+=j.duration,M++,N=0,ie=!0);else if(V[4]){var Ae=(" "+V[4]).slice(1);F?j.setByteRange(Ae,F):j.setByteRange(Ae)}else if(V[5])j.rawProgramDateTime=(" "+V[5]).slice(1),j.tagList.push(["PROGRAM-DATE-TIME",j.rawProgramDateTime]),X===-1&&(X=C.length);else{if(V=V[0].match(_),!V){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<V.length&&typeof V[G]=="undefined";G++);var pe=(" "+V[G]).slice(1),le=(" "+V[G+1]).slice(1),Ie=V[G+2]?(" "+V[G+2]).slice(1):"";switch(pe){case"PLAYLIST-TYPE":D.type=le.toUpperCase();break;case"MEDIA-SEQUENCE":M=D.startSN=parseInt(le);break;case"SKIP":{var Ce=new p.AttrList(le),Ue=Ce.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(Ue)){D.skippedSegments=Ue;for(var Me=Ue;Me--;)C.unshift(null);M+=Ue}var ze=Ce.enumeratedString("RECENTLY-REMOVED-DATERANGES");ze&&(D.recentlyRemovedDateranges=ze.split("	"));break}case"TARGETDURATION":D.targetduration=parseFloat(le);break;case"VERSION":D.version=parseInt(le);break;case"EXTM3U":break;case"ENDLIST":D.live=!1;break;case"#":(le||Ie)&&j.tagList.push(Ie?[le,Ie]:[le]);break;case"DIS":U++;case"GAP":j.tagList.push([pe]);break;case"BITRATE":j.tagList.push([pe,le]);break;case"DISCONTINUITY-SEQ":U=parseInt(le);break;case"KEY":{var Ge,$e=new p.AttrList(le),He=$e.enumeratedString("METHOD"),Fe=$e.URI,Se=$e.hexadecimalInteger("IV"),Xe=$e.enumeratedString("KEYFORMATVERSIONS"),st=$e.enumeratedString("KEYID"),et=(Ge=$e.enumeratedString("KEYFORMAT"))!=null?Ge:"identity",ot=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(ot.indexOf(et)>-1){u.logger.warn("Keyformat "+et+" is not supported from the manifest");continue}else if(et!=="identity")continue;He&&(Y=h.LevelKey.fromURL(R,Fe),Fe&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(He)>=0&&(Y.method=He,Y.keyFormat=et,st&&(Y.keyID=st),Xe&&(Y.keyFormatVersions=Xe),Y.iv=Se));break}case"START":{var nt=new p.AttrList(le),dt=nt.decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(dt)&&(D.startTimeOffset=dt);break}case"MAP":{var ne=new p.AttrList(le);j.relurl=ne.URI,ne.BYTERANGE&&j.setByteRange(ne.BYTERANGE),j.level=w,j.sn="initSegment",Y&&(j.levelkey=Y),j.initSegment=null,P=j,ie=!0;break}case"SERVER-CONTROL":{var Ee=new p.AttrList(le);D.canBlockReload=Ee.bool("CAN-BLOCK-RELOAD"),D.canSkipUntil=Ee.optionalFloat("CAN-SKIP-UNTIL",0),D.canSkipDateRanges=D.canSkipUntil>0&&Ee.bool("CAN-SKIP-DATERANGES"),D.partHoldBack=Ee.optionalFloat("PART-HOLD-BACK",0),D.holdBack=Ee.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var xe=new p.AttrList(le);D.partTarget=xe.decimalFloatingPoint("PART-TARGET");break}case"PART":{var we=D.partList;we||(we=D.partList=[]);var be=N>0?we[we.length-1]:void 0,je=N++,K=new o.Part(new p.AttrList(le),j,R,je,be);we.push(K),j.duration+=K.duration;break}case"PRELOAD-HINT":{var ce=new p.AttrList(le);D.preloadHint=ce;break}case"RENDITION-REPORT":{var _e=new p.AttrList(le);D.renditionReports=D.renditionReports||[],D.renditionReports.push(_e);break}default:u.logger.warn("line parsed but not handled: "+V);break}}}F&&!F.relurl?(C.pop(),B-=F.duration,D.partList&&(D.fragmentHint=F)):D.partList&&(b(j,F),j.cc=U,D.fragmentHint=j);var Re=C.length,Z=C[0],ue=C[Re-1];if(B+=D.skippedSegments*D.targetduration,B>0&&Re&&ue){D.averagetargetduration=B/Re;var W=ue.sn;D.endSN=W!=="initSegment"?W:0,Z&&(D.startCC=Z.cc,Z.initSegment||D.fragments.every(function(me){return me.relurl&&c(me.relurl)})&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),j=new o.Fragment(O,R),j.relurl=ue.relurl,j.level=w,j.sn="initSegment",Z.initSegment=j,D.needSidxRanges=!0))}else D.endSN=0,D.startCC=0;return D.fragmentHint&&(B+=D.fragmentHint.duration),D.totalduration=B,D.endCC=U,X>0&&x(C,X),D},T}();function y(T,A){["video","audio","text"].forEach(function(L){var R=T.filter(function(O){return Object(f.isCodecType)(O,L)});if(R.length){var w=R.filter(function(O){return O.lastIndexOf("avc1",0)===0||O.lastIndexOf("mp4a",0)===0});A[L+"Codec"]=w.length>0?w[0]:R[0],T=T.filter(function(O){return R.indexOf(O)===-1})}}),A.unknownCodecs=T}function d(T,A,L){var R=A[L];R&&(T[L]=R)}function x(T,A){for(var L=T[A],R=A;R--;){var w=T[R];if(!w)return;w.programDateTime=L.programDateTime-w.duration*1e3,L=w}}function b(T,A){T.rawProgramDateTime?T.programDateTime=Date.parse(T.rawProgramDateTime):A!=null&&A.programDateTime&&(T.programDateTime=A.endProgramDateTime),Object(n.isFiniteNumber)(T.programDateTime)||(T.programDateTime=null,T.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),l=t("./src/utils/logger.ts"),h=t("./src/utils/mp4-tools.ts"),p=t("./src/loader/m3u8-parser.ts"),u=t("./src/types/loader.ts"),f=t("./src/utils/attr-list.ts");function g(_){var m=_.type;switch(m){case u.PlaylistContextType.AUDIO_TRACK:return u.PlaylistLevelType.AUDIO;case u.PlaylistContextType.SUBTITLE_TRACK:return u.PlaylistLevelType.SUBTITLE;default:return u.PlaylistLevelType.MAIN}}function E(_,m){var c=_.url;return(c===void 0||c.indexOf("data:")===0)&&(c=m.url),c}var S=function(){function _(c){this.hls=void 0,this.loaders=Object.create(null),this.hls=c,this.registerListeners()}var m=_.prototype;return m.registerListeners=function(){var v=this.hls;v.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),v.on(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},m.unregisterListeners=function(){var v=this.hls;v.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(a.Events.LEVEL_LOADING,this.onLevelLoading,this),v.off(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),v.off(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},m.createInternalLoader=function(v){var y=this.hls.config,d=y.pLoader,x=y.loader,b=d||x,T=new b(y);return v.loader=T,this.loaders[v.type]=T,T},m.getInternalLoader=function(v){return this.loaders[v.type]},m.resetInternalLoader=function(v){this.loaders[v]&&delete this.loaders[v]},m.destroyInternalLoaders=function(){for(var v in this.loaders){var y=this.loaders[v];y&&y.destroy(),this.resetInternalLoader(v)}},m.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},m.onManifestLoading=function(v,y){var d=y.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:u.PlaylistContextType.MANIFEST,url:d,deliveryDirectives:null})},m.onLevelLoading=function(v,y){var d=y.id,x=y.level,b=y.url,T=y.deliveryDirectives;this.load({id:d,groupId:null,level:x,responseType:"text",type:u.PlaylistContextType.LEVEL,url:b,deliveryDirectives:T})},m.onAudioTrackLoading=function(v,y){var d=y.id,x=y.groupId,b=y.url,T=y.deliveryDirectives;this.load({id:d,groupId:x,level:null,responseType:"text",type:u.PlaylistContextType.AUDIO_TRACK,url:b,deliveryDirectives:T})},m.onSubtitleTrackLoading=function(v,y){var d=y.id,x=y.groupId,b=y.url,T=y.deliveryDirectives;this.load({id:d,groupId:x,level:null,responseType:"text",type:u.PlaylistContextType.SUBTITLE_TRACK,url:b,deliveryDirectives:T})},m.load=function(v){var y,d=this.hls.config,x=this.getInternalLoader(v);if(x){var b=x.context;if(b&&b.url===v.url){l.logger.trace("[playlist-loader]: playlist request ongoing");return}l.logger.log("[playlist-loader]: aborting previous loader for type: "+v.type),x.abort()}var T,A,L,R;switch(v.type){case u.PlaylistContextType.MANIFEST:T=d.manifestLoadingMaxRetry,A=d.manifestLoadingTimeOut,L=d.manifestLoadingRetryDelay,R=d.manifestLoadingMaxRetryTimeout;break;case u.PlaylistContextType.LEVEL:case u.PlaylistContextType.AUDIO_TRACK:case u.PlaylistContextType.SUBTITLE_TRACK:T=0,A=d.levelLoadingTimeOut;break;default:T=d.levelLoadingMaxRetry,A=d.levelLoadingTimeOut,L=d.levelLoadingRetryDelay,R=d.levelLoadingMaxRetryTimeout;break}if(x=this.createInternalLoader(v),(y=v.deliveryDirectives)!==null&&y!==void 0&&y.part){var w;if(v.type===u.PlaylistContextType.LEVEL&&v.level!==null?w=this.hls.levels[v.level].details:v.type===u.PlaylistContextType.AUDIO_TRACK&&v.id!==null?w=this.hls.audioTracks[v.id].details:v.type===u.PlaylistContextType.SUBTITLE_TRACK&&v.id!==null&&(w=this.hls.subtitleTracks[v.id].details),w){var O=w.partTarget,I=w.targetduration;O&&I&&(A=Math.min(Math.max(O*3,I*.8)*1e3,A))}}var D={timeout:A,maxRetry:T,retryDelay:L,maxRetryDelay:R,highWaterMark:0},C={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};x.load(v,D,C)},m.loadsuccess=function(v,y,d,x){if(x===void 0&&(x=null),d.isSidxRequest){this.handleSidxRequest(v,d),this.handlePlaylistLoaded(v,y,d,x);return}this.resetInternalLoader(d.type);var b=v.data;if(b.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(v,d,"no EXTM3U delimiter",x);return}y.parsing.start=performance.now(),b.indexOf("#EXTINF:")>0||b.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(v,y,d,x):this.handleMasterPlaylist(v,y,d,x)},m.loaderror=function(v,y,d){d===void 0&&(d=null),this.handleNetworkError(y,d,!1,v)},m.loadtimeout=function(v,y,d){d===void 0&&(d=null),this.handleNetworkError(y,d,!0)},m.handleMasterPlaylist=function(v,y,d,x){var b=this.hls,T=v.data,A=E(v,d),L=p.default.parseMasterPlaylist(T,A),R=L.levels,w=L.sessionData;if(!R.length){this.handleManifestParsingError(v,d,"no level found in manifest",x);return}var O=R.map(function(N){return{id:N.attrs.AUDIO,audioCodec:N.audioCodec}}),I=R.map(function(N){return{id:N.attrs.SUBTITLES,textCodec:N.textCodec}}),D=p.default.parseMasterPlaylistMedia(T,A,"AUDIO",O),C=p.default.parseMasterPlaylistMedia(T,A,"SUBTITLES",I),P=p.default.parseMasterPlaylistMedia(T,A,"CLOSED-CAPTIONS");if(D.length){var M=D.some(function(N){return!N.url});!M&&R[0].audioCodec&&!R[0].attrs.AUDIO&&(l.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),D.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new f.AttrList({}),bitrate:0,url:""}))}b.trigger(a.Events.MANIFEST_LOADED,{levels:R,audioTracks:D,subtitles:C,captions:P,url:A,stats:y,networkDetails:x,sessionData:w})},m.handleTrackOrLevelPlaylist=function(v,y,d,x){var b=this.hls,T=d.id,A=d.level,L=d.type,R=E(v,d),w=Object(n.isFiniteNumber)(T)?T:0,O=Object(n.isFiniteNumber)(A)?A:w,I=g(d),D=p.default.parseLevelPlaylist(v.data,R,O,I,w);if(!D.fragments.length){b.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:R,reason:"no fragments found in level",level:typeof d.level=="number"?d.level:void 0});return}if(L===u.PlaylistContextType.MANIFEST){var C={attrs:new f.AttrList({}),bitrate:0,details:D,name:"",url:R};b.trigger(a.Events.MANIFEST_LOADED,{levels:[C],audioTracks:[],url:R,stats:y,networkDetails:x,sessionData:null})}if(y.parsing.end=performance.now(),D.needSidxRanges){var P,M=(P=D.fragments[0].initSegment)===null||P===void 0?void 0:P.url;this.load({url:M,isSidxRequest:!0,type:L,level:A,levelDetails:D,id:T,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}d.levelDetails=D,this.handlePlaylistLoaded(v,y,d,x)},m.handleSidxRequest=function(v,y){var d=Object(h.parseSegmentIndex)(new Uint8Array(v.data));if(!!d){var x=d.references,b=y.levelDetails;x.forEach(function(T,A){var L=T.info,R=b.fragments[A];R.byteRange.length===0&&R.setByteRange(String(1+L.end-L.start)+"@"+String(L.start)),R.initSegment&&R.initSegment.setByteRange(String(d.moovEndOffset)+"@0")})}},m.handleManifestParsingError=function(v,y,d,x){this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:y.type===u.PlaylistContextType.MANIFEST,url:v.url,reason:d,response:v,context:y,networkDetails:x})},m.handleNetworkError=function(v,y,d,x){d===void 0&&(d=!1),l.logger.warn("[playlist-loader]: A network "+(d?"timeout":"error")+" occurred while loading "+v.type+" level: "+v.level+" id: "+v.id+' group-id: "'+v.groupId+'"');var b=o.ErrorDetails.UNKNOWN,T=!1,A=this.getInternalLoader(v);switch(v.type){case u.PlaylistContextType.MANIFEST:b=d?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,T=!0;break;case u.PlaylistContextType.LEVEL:b=d?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,T=!1;break;case u.PlaylistContextType.AUDIO_TRACK:b=d?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,T=!1;break;case u.PlaylistContextType.SUBTITLE_TRACK:b=d?o.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:o.ErrorDetails.SUBTITLE_LOAD_ERROR,T=!1;break}A&&this.resetInternalLoader(v.type);var L={type:o.ErrorTypes.NETWORK_ERROR,details:b,fatal:T,url:v.url,loader:A,context:v,networkDetails:y};x&&(L.response=x),this.hls.trigger(a.Events.ERROR,L)},m.handlePlaylistLoaded=function(v,y,d,x){var b=d.type,T=d.level,A=d.id,L=d.groupId,R=d.loader,w=d.levelDetails,O=d.deliveryDirectives;if(!(w!=null&&w.targetduration)){this.handleManifestParsingError(v,d,"invalid target duration",x);return}if(!!R)switch(w.live&&(R.getCacheAge&&(w.ageHeader=R.getCacheAge()||0),(!R.getCacheAge||isNaN(w.ageHeader))&&(w.ageHeader=0)),b){case u.PlaylistContextType.MANIFEST:case u.PlaylistContextType.LEVEL:this.hls.trigger(a.Events.LEVEL_LOADED,{details:w,level:T||0,id:A||0,stats:y,networkDetails:x,deliveryDirectives:O});break;case u.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(a.Events.AUDIO_TRACK_LOADED,{details:w,id:A||0,groupId:L||"",stats:y,networkDetails:x,deliveryDirectives:O});break;case u.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(a.Events.SUBTITLE_TRACK_LOADED,{details:w,id:A||0,groupId:L||"",stats:y,networkDetails:x,deliveryDirectives:O});break}},_}();i.default=S},"./src/polyfills/number.ts":function(r,i,t){t.r(i),t.d(i,"isFiniteNumber",function(){return n}),t.d(i,"MAX_SAFE_INTEGER",function(){return a});var n=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(r,i,t){t.r(i);var n=function(){function a(){}return a.getSilentFrame=function(l,h){switch(l){case"mp4a.40.2":if(h===1)return new Uint8Array([0,200,0,128,35,128]);if(h===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(h===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(h===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(h===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(h===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(h===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(h===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},a}();i.default=n},"./src/remux/mp4-generator.ts":function(r,i,t){t.r(i);var n=Math.pow(2,32)-1,a=function(){function o(){}return o.init=function(){o.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var h;for(h in o.types)o.types.hasOwnProperty(h)&&(o.types[h]=[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]);var p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);o.HDLR_TYPES={video:p,audio:u};var f=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),g=new Uint8Array([0,0,0,0,0,0,0,0]);o.STTS=o.STSC=o.STCO=g,o.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),o.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),o.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),o.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var E=new Uint8Array([105,115,111,109]),S=new Uint8Array([97,118,99,49]),_=new Uint8Array([0,0,0,1]);o.FTYP=o.box(o.types.ftyp,E,_,E,S),o.DINF=o.box(o.types.dinf,o.box(o.types.dref,f))},o.box=function(h){for(var p=8,u=arguments.length,f=new Array(u>1?u-1:0),g=1;g<u;g++)f[g-1]=arguments[g];for(var E=f.length,S=E;E--;)p+=f[E].byteLength;var _=new Uint8Array(p);for(_[0]=p>>24&255,_[1]=p>>16&255,_[2]=p>>8&255,_[3]=p&255,_.set(h,4),E=0,p=8;E<S;E++)_.set(f[E],p),p+=f[E].byteLength;return _},o.hdlr=function(h){return o.box(o.types.hdlr,o.HDLR_TYPES[h])},o.mdat=function(h){return o.box(o.types.mdat,h)},o.mdhd=function(h,p){p*=h;var u=Math.floor(p/(n+1)),f=Math.floor(p%(n+1));return o.box(o.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,h&255,u>>24,u>>16&255,u>>8&255,u&255,f>>24,f>>16&255,f>>8&255,f&255,85,196,0,0]))},o.mdia=function(h){return o.box(o.types.mdia,o.mdhd(h.timescale,h.duration),o.hdlr(h.type),o.minf(h))},o.mfhd=function(h){return o.box(o.types.mfhd,new Uint8Array([0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255]))},o.minf=function(h){return h.type==="audio"?o.box(o.types.minf,o.box(o.types.smhd,o.SMHD),o.DINF,o.stbl(h)):o.box(o.types.minf,o.box(o.types.vmhd,o.VMHD),o.DINF,o.stbl(h))},o.moof=function(h,p,u){return o.box(o.types.moof,o.mfhd(h),o.traf(u,p))},o.moov=function(h){for(var p=h.length,u=[];p--;)u[p]=o.trak(h[p]);return o.box.apply(null,[o.types.moov,o.mvhd(h[0].timescale,h[0].duration)].concat(u).concat(o.mvex(h)))},o.mvex=function(h){for(var p=h.length,u=[];p--;)u[p]=o.trex(h[p]);return o.box.apply(null,[o.types.mvex].concat(u))},o.mvhd=function(h,p){p*=h;var u=Math.floor(p/(n+1)),f=Math.floor(p%(n+1)),g=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,h&255,u>>24,u>>16&255,u>>8&255,u&255,f>>24,f>>16&255,f>>8&255,f&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o.box(o.types.mvhd,g)},o.sdtp=function(h){var p=h.samples||[],u=new Uint8Array(4+p.length),f,g;for(f=0;f<p.length;f++)g=p[f].flags,u[f+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return o.box(o.types.sdtp,u)},o.stbl=function(h){return o.box(o.types.stbl,o.stsd(h),o.box(o.types.stts,o.STTS),o.box(o.types.stsc,o.STSC),o.box(o.types.stsz,o.STSZ),o.box(o.types.stco,o.STCO))},o.avc1=function(h){var p=[],u=[],f,g,E;for(f=0;f<h.sps.length;f++)g=h.sps[f],E=g.byteLength,p.push(E>>>8&255),p.push(E&255),p=p.concat(Array.prototype.slice.call(g));for(f=0;f<h.pps.length;f++)g=h.pps[f],E=g.byteLength,u.push(E>>>8&255),u.push(E&255),u=u.concat(Array.prototype.slice.call(g));var S=o.box(o.types.avcC,new Uint8Array([1,p[3],p[4],p[5],252|3,224|h.sps.length].concat(p).concat([h.pps.length]).concat(u))),_=h.width,m=h.height,c=h.pixelRatio[0],v=h.pixelRatio[1];return o.box(o.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>8&255,_&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),S,o.box(o.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),o.box(o.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,v>>24,v>>16&255,v>>8&255,v&255])))},o.esds=function(h){var p=h.config.length;return new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(h.config).concat([6,1,2]))},o.mp4a=function(h){var p=h.samplerate;return o.box(o.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]),o.box(o.types.esds,o.esds(h)))},o.mp3=function(h){var p=h.samplerate;return o.box(o.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,h.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]))},o.stsd=function(h){return h.type==="audio"?!h.isAAC&&h.codec==="mp3"?o.box(o.types.stsd,o.STSD,o.mp3(h)):o.box(o.types.stsd,o.STSD,o.mp4a(h)):o.box(o.types.stsd,o.STSD,o.avc1(h))},o.tkhd=function(h){var p=h.id,u=h.duration*h.timescale,f=h.width,g=h.height,E=Math.floor(u/(n+1)),S=Math.floor(u%(n+1));return o.box(o.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,p>>24&255,p>>16&255,p>>8&255,p&255,0,0,0,0,E>>24,E>>16&255,E>>8&255,E&255,S>>24,S>>16&255,S>>8&255,S&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,f>>8&255,f&255,0,0,g>>8&255,g&255,0,0]))},o.traf=function(h,p){var u=o.sdtp(h),f=h.id,g=Math.floor(p/(n+1)),E=Math.floor(p%(n+1));return o.box(o.types.traf,o.box(o.types.tfhd,new Uint8Array([0,0,0,0,f>>24,f>>16&255,f>>8&255,f&255])),o.box(o.types.tfdt,new Uint8Array([1,0,0,0,g>>24,g>>16&255,g>>8&255,g&255,E>>24,E>>16&255,E>>8&255,E&255])),o.trun(h,u.length+16+20+8+16+8+8),u)},o.trak=function(h){return h.duration=h.duration||4294967295,o.box(o.types.trak,o.tkhd(h),o.mdia(h))},o.trex=function(h){var p=h.id;return o.box(o.types.trex,new Uint8Array([0,0,0,0,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},o.trun=function(h,p){var u=h.samples||[],f=u.length,g=12+16*f,E=new Uint8Array(g),S,_,m,c,v,y;for(p+=8+g,E.set([0,0,15,1,f>>>24&255,f>>>16&255,f>>>8&255,f&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255],0),S=0;S<f;S++)_=u[S],m=_.duration,c=_.size,v=_.flags,y=_.cts,E.set([m>>>24&255,m>>>16&255,m>>>8&255,m&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,v.isLeading<<2|v.dependsOn,v.isDependedOn<<6|v.hasRedundancy<<4|v.paddingValue<<1|v.isNonSync,v.degradPrio&240<<8,v.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*S);return o.box(o.types.trun,E)},o.initSegment=function(h){o.types||o.init();var p=o.moov(h),u=new Uint8Array(o.FTYP.byteLength+p.byteLength);return u.set(o.FTYP),u.set(p,o.FTYP.byteLength),u},o}();a.types=void 0,a.HDLR_TYPES=void 0,a.STTS=void 0,a.STSC=void 0,a.STCO=void 0,a.STSZ=void 0,a.VMHD=void 0,a.SMHD=void 0,a.STSD=void 0,a.FTYP=void 0,a.DINF=void 0,i.default=a},"./src/remux/mp4-remuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return y}),t.d(i,"normalizePts",function(){return d});var n=t("./src/polyfills/number.ts"),a=t("./src/remux/aac-helper.ts"),o=t("./src/remux/mp4-generator.ts"),l=t("./src/events.ts"),h=t("./src/errors.ts"),p=t("./src/utils/logger.ts"),u=t("./src/types/loader.ts"),f=t("./src/utils/timescale-conversion.ts");function g(){return g=Object.assign||function(A){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var w in R)Object.prototype.hasOwnProperty.call(R,w)&&(A[w]=R[w])}return A},g.apply(this,arguments)}var E=10*1e3,S=1024,_=1152,m=null,c=null,v=!1,y=function(){function A(R,w,O,I){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=R,this.config=w,this.typeSupported=O,this.ISGenerated=!1,m===null){var D=navigator.userAgent||"",C=D.match(/Chrome\/(\d+)/i);m=C?parseInt(C[1]):0}if(c===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);c=P?parseInt(P[1]):0}v=!!m&&m<75||!!c&&c<600}var L=A.prototype;return L.destroy=function(){},L.resetTimeStamp=function(w){p.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=w},L.resetNextTimestamp=function(){p.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},L.resetInitSegment=function(){p.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},L.getVideoStartPts=function(w){var O=!1,I=w.reduce(function(D,C){var P=C.pts-D;return P<-4294967296?(O=!0,d(D,C.pts)):P>0?D:C.pts},w[0].pts);return O&&p.logger.debug("PTS rollover detected"),I},L.remux=function(w,O,I,D,C,P,M,N){var B,U,F,j,V,G,Y=C,X=C,ie=w.pid>-1,he=O.pid>-1,de=O.samples.length,Ae=w.samples.length>0,pe=de>1,le=(!ie||Ae)&&(!he||pe)||this.ISGenerated||M;if(le){this.ISGenerated||(F=this.generateIS(w,O,C));var Ie=this.isVideoContiguous,Ce=-1;if(pe&&(Ce=x(O.samples),!Ie&&this.config.forceKeyFrameOnDiscontinuity))if(G=!0,Ce>0){p.logger.warn("[mp4-remuxer]: Dropped "+Ce+" out of "+de+" video samples due to a missing keyframe");var Ue=this.getVideoStartPts(O.samples);O.samples=O.samples.slice(Ce),O.dropped+=Ce,X+=(O.samples[0].pts-Ue)/(O.timescale||9e4)}else Ce===-1&&(p.logger.warn("[mp4-remuxer]: No keyframe found out of "+de+" video samples"),G=!1);if(this.ISGenerated){if(Ae&&pe){var Me=this.getVideoStartPts(O.samples),ze=d(w.samples[0].pts,Me)-Me,Ge=ze/O.inputTimeScale;Y+=Math.max(0,Ge),X+=Math.max(0,-Ge)}if(Ae){if(w.samplerate||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),F=this.generateIS(w,O,C)),U=this.remuxAudio(w,Y,this.isAudioContiguous,P,he||pe||N===u.PlaylistLevelType.AUDIO?X:void 0),pe){var $e=U?U.endPTS-U.startPTS:0;O.inputTimeScale||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),F=this.generateIS(w,O,C)),B=this.remuxVideo(O,X,Ie,$e)}}else pe&&(B=this.remuxVideo(O,X,Ie,0));B&&(B.firstKeyFrame=Ce,B.independent=Ce!==-1)}}return this.ISGenerated&&(I.samples.length&&(V=this.remuxID3(I,C)),D.samples.length&&(j=this.remuxText(D,C))),{audio:U,video:B,initSegment:F,independent:G,text:j,id3:V}},L.generateIS=function(w,O,I){var D=w.samples,C=O.samples,P=this.typeSupported,M={},N=!Object(n.isFiniteNumber)(this._initPTS),B="audio/mp4",U,F,j;if(N&&(U=F=1/0),w.config&&D.length&&(w.timescale=w.samplerate,w.isAAC||(P.mpeg?(B="audio/mpeg",w.codec=""):P.mp3&&(w.codec="mp3")),M.audio={id:"audio",container:B,codec:w.codec,initSegment:!w.isAAC&&P.mpeg?new Uint8Array(0):o.default.initSegment([w]),metadata:{channelCount:w.channelCount}},N&&(j=w.inputTimeScale,U=F=D[0].pts-Math.round(j*I))),O.sps&&O.pps&&C.length&&(O.timescale=O.inputTimeScale,M.video={id:"main",container:"video/mp4",codec:O.codec,initSegment:o.default.initSegment([O]),metadata:{width:O.width,height:O.height}},N)){j=O.inputTimeScale;var V=this.getVideoStartPts(C),G=Math.round(j*I);F=Math.min(F,d(C[0].dts,V)-G),U=Math.min(U,V-G)}if(Object.keys(M).length)return this.ISGenerated=!0,N&&(this._initPTS=U,this._initDTS=F),{tracks:M,initPTS:U,timescale:j}},L.remuxVideo=function(w,O,I,D){var C=w.inputTimeScale,P=w.samples,M=[],N=P.length,B=this._initPTS,U=this.nextAvcDts,F=8,j,V,G,Y=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,ie=0,he=!1;if(!I||U===null){var de=O*C,Ae=P[0].pts-d(P[0].dts,P[0].pts);U=de-Ae}for(var pe=0;pe<N;pe++){var le=P[pe];if(le.pts=d(le.pts-B,U),le.dts=d(le.dts-B,U),le.dts>le.pts){var Ie=9e4*.2;ie=Math.max(Math.min(ie,le.pts-le.dts),-1*Ie)}le.dts<P[pe>0?pe-1:pe].dts&&(he=!0)}he&&P.sort(function(ke,Ne){var rt=ke.dts-Ne.dts,nr=ke.pts-Ne.pts;return rt||nr}),V=P[0].dts,G=P[P.length-1].dts;var Ce=Math.round((G-V)/(N-1));if(ie<0){if(ie<Ce*-2){p.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(f.toMsFromMpegTsClock)(-Ce,!0)+" ms");for(var Ue=ie,Me=0;Me<N;Me++)P[Me].dts=Ue=Math.max(Ue,P[Me].pts-Ce),P[Me].pts=Math.max(Ue,P[Me].pts)}else{p.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(f.toMsFromMpegTsClock)(ie,!0)+" ms to overcome this issue");for(var ze=0;ze<N;ze++)P[ze].dts=P[ze].dts+ie}V=P[0].dts}if(I){var Ge=V-U,$e=Ge>Ce,He=Ge<-1;if($e||He){$e?p.logger.warn("AVC: "+Object(f.toMsFromMpegTsClock)(Ge,!0)+" ms ("+Ge+"dts) hole between fragments detected, filling it"):p.logger.warn("AVC: "+Object(f.toMsFromMpegTsClock)(-Ge,!0)+" ms ("+Ge+"dts) overlapping between fragments detected"),V=U;var Fe=P[0].pts-Ge;P[0].dts=V,P[0].pts=Fe,p.logger.log("Video: First PTS/DTS adjusted: "+Object(f.toMsFromMpegTsClock)(Fe,!0)+"/"+Object(f.toMsFromMpegTsClock)(V,!0)+", delta: "+Object(f.toMsFromMpegTsClock)(Ge,!0)+" ms")}}v&&(V=Math.max(0,V));for(var Se=0,Xe=0,st=0;st<N;st++){for(var et=P[st],ot=et.units,nt=ot.length,dt=0,ne=0;ne<nt;ne++)dt+=ot[ne].data.length;Xe+=dt,Se+=nt,et.length=dt,et.dts=Math.max(et.dts,V),et.pts=Math.max(et.pts,et.dts,0),Y=Math.min(et.pts,Y),X=Math.max(et.pts,X)}G=P[N-1].dts;var Ee=Xe+4*Se+8,xe;try{xe=new Uint8Array(Ee)}catch(ke){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ee,reason:"fail allocating video mdat "+Ee});return}var we=new DataView(xe.buffer);we.setUint32(0,Ee),xe.set(o.default.types.mdat,4);for(var be=0;be<N;be++){for(var je=P[be],K=je.units,ce=0,_e=0,Re=K.length;_e<Re;_e++){var Z=K[_e],ue=Z.data,W=Z.data.byteLength;we.setUint32(F,W),F+=4,xe.set(ue,F),F+=W,ce+=4+W}if(be<N-1)j=P[be+1].dts-je.dts;else{var me=this.config,Ke=je.dts-P[be>0?be-1:be].dts;if(me.stretchShortVideoTrack&&this.nextAudioPts!==null){var k=Math.floor(me.maxBufferHole*C),oe=(D?Y+D*C:this.nextAudioPts)-je.pts;oe>k?(j=oe-Ke,j<0&&(j=Ke),p.logger.log("[mp4-remuxer]: It is approximately "+oe/90+" ms to the next segment; using duration "+j/90+" ms for the last video frame.")):j=Ke}else j=Ke}var fe=Math.round(je.pts-je.dts);M.push(new b(je.key,j,ce,fe))}if(M.length&&m&&m<70){var z=M[0].flags;z.dependsOn=2,z.isNonSync=0}console.assert(j!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=U=G+j,this.isVideoContiguous=!0;var J=o.default.moof(w.sequenceNumber++,V,g({},w,{samples:M})),ae="video",We={data1:J,data2:xe,startPTS:Y/C,endPTS:(X+j)/C,startDTS:V/C,endDTS:U/C,type:ae,hasAudio:!1,hasVideo:!0,nb:M.length,dropped:w.dropped};return w.samples=[],w.dropped=0,console.assert(xe.length,"MDAT length must not be zero"),We},L.remuxAudio=function(w,O,I,D,C){var P=w.inputTimeScale,M=w.samplerate?w.samplerate:P,N=P/M,B=w.isAAC?S:_,U=B*N,F=this._initPTS,j=!w.isAAC&&this.typeSupported.mpeg,V=[],G=w.samples,Y=j?0:8,X=this.nextAudioPts||-1,ie=O*P;if(this.isAudioContiguous=I=I||G.length&&X>0&&(D&&Math.abs(ie-X)<9e3||Math.abs(d(G[0].pts-F,ie)-X)<20*U),G.forEach(function(ue){ue.pts=d(ue.pts-F,ie)}),!I||X<0){if(G=G.filter(function(ue){return ue.pts>=0}),!G.length)return;C===0?X=0:D?X=Math.max(0,ie):X=G[0].pts}if(w.isAAC)for(var he=C!==void 0,de=this.config.maxAudioFramesDrift,Ae=0,pe=X;Ae<G.length;Ae++){var le=G[Ae],Ie=le.pts,Ce=Ie-pe,Ue=Math.abs(1e3*Ce/P);if(Ce<=-de*U&&he)Ae===0&&(p.logger.warn("Audio frame @ "+(Ie/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Ce/P)+" ms."),this.nextAudioPts=X=pe=Ie);else if(Ce>=de*U&&Ue<E&&he){var Me=Math.round(Ce/U);pe=Ie-Me*U,pe<0&&(Me--,pe+=U),Ae===0&&(this.nextAudioPts=X=pe),p.logger.warn("[mp4-remuxer]: Injecting "+Me+" audio frame @ "+(pe/P).toFixed(3)+"s due to "+Math.round(1e3*Ce/P)+" ms gap.");for(var ze=0;ze<Me;ze++){var Ge=Math.max(pe,0),$e=a.default.getSilentFrame(w.manifestCodec||w.codec,w.channelCount);$e||(p.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),$e=le.unit.subarray()),G.splice(Ae,0,{unit:$e,pts:Ge}),pe+=U,Ae++}}le.pts=pe,pe+=U}for(var He=null,Fe=null,Se,Xe=0,st=G.length;st--;)Xe+=G[st].unit.byteLength;for(var et=0,ot=G.length;et<ot;et++){var nt=G[et],dt=nt.unit,ne=nt.pts;if(Fe!==null){var Ee=V[et-1];Ee.duration=Math.round((ne-Fe)/N)}else if(I&&w.isAAC&&(ne=X),He=ne,Xe>0){Xe+=Y;try{Se=new Uint8Array(Xe)}catch(ue){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Xe,reason:"fail allocating audio mdat "+Xe});return}if(!j){var xe=new DataView(Se.buffer);xe.setUint32(0,Xe),Se.set(o.default.types.mdat,4)}}else return;Se.set(dt,Y);var we=dt.byteLength;Y+=we,V.push(new b(!0,B,we,0)),Fe=ne}var be=V.length;if(!!be){var je=V[V.length-1];this.nextAudioPts=X=Fe+N*je.duration;var K=j?new Uint8Array(0):o.default.moof(w.sequenceNumber++,He/N,g({},w,{samples:V}));w.samples=[];var ce=He/P,_e=X/P,Re="audio",Z={data1:K,data2:Se,startPTS:ce,endPTS:_e,startDTS:ce,endDTS:_e,type:Re,hasAudio:!0,hasVideo:!1,nb:be};return this.isAudioContiguous=!0,console.assert(Se.length,"MDAT length must not be zero"),Z}},L.remuxEmptyAudio=function(w,O,I,D){var C=w.inputTimeScale,P=w.samplerate?w.samplerate:C,M=C/P,N=this.nextAudioPts,B=(N!==null?N:D.startDTS*C)+this._initDTS,U=D.endDTS*C+this._initDTS,F=M*S,j=Math.ceil((U-B)/F),V=a.default.getSilentFrame(w.manifestCodec||w.codec,w.channelCount);if(p.logger.warn("[mp4-remuxer]: remux empty Audio"),!V){p.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var G=[],Y=0;Y<j;Y++){var X=B+Y*F;G.push({unit:V,pts:X,dts:X})}return w.samples=G,this.remuxAudio(w,O,I,!1)},L.remuxID3=function(w,O){var I=w.samples.length;if(!!I){for(var D=w.inputTimeScale,C=this._initPTS,P=this._initDTS,M=0;M<I;M++){var N=w.samples[M];N.pts=d(N.pts-C,O*D)/D,N.dts=d(N.dts-P,O*D)/D}var B=w.samples;return w.samples=[],{samples:B}}},L.remuxText=function(w,O){var I=w.samples.length;if(!!I){for(var D=w.inputTimeScale,C=this._initPTS,P=0;P<I;P++){var M=w.samples[P];M.pts=d(M.pts-C,O*D)/D}w.samples.sort(function(B,U){return B.pts-U.pts});var N=w.samples;return w.samples=[],{samples:N}}},A}();function d(A,L){var R;if(L===null)return A;for(L<A?R=-8589934592:R=8589934592;Math.abs(A-L)>4294967296;)A+=R;return A}function x(A){for(var L=0;L<A.length;L++)if(A[L].key)return L;return-1}var b=function(L,R,w,O){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=R,this.size=w,this.cts=O,this.flags=new T(L)},T=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},"./src/remux/passthrough-remuxer.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/mp4-tools.ts"),o=t("./src/loader/fragment.ts"),l=t("./src/utils/logger.ts"),h=function(){function f(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var g=f.prototype;return g.destroy=function(){},g.resetTimeStamp=function(S){this.initPTS=S,this.lastEndDTS=null},g.resetNextTimestamp=function(){this.lastEndDTS=null},g.resetInitSegment=function(S,_,m){this.audioCodec=_,this.videoCodec=m,this.generateInitSegment(S),this.emitInitSegment=!0},g.generateInitSegment=function(S){var _=this.audioCodec,m=this.videoCodec;if(!S||!S.byteLength){this.initTracks=void 0,this.initData=void 0;return}var c=this.initData=Object(a.parseInitSegment)(S);_||(_=u(c.audio,o.ElementaryStreamTypes.AUDIO)),m||(m=u(c.video,o.ElementaryStreamTypes.VIDEO));var v={};c.audio&&c.video?v.audiovideo={container:"video/mp4",codec:_+","+m,initSegment:S,id:"main"}:c.audio?v.audio={container:"audio/mp4",codec:_,initSegment:S,id:"audio"}:c.video?v.video={container:"video/mp4",codec:m,initSegment:S,id:"main"}:l.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=v},g.remux=function(S,_,m,c,v){var y=this.initPTS,d=this.lastEndDTS,x={audio:void 0,video:void 0,text:c,id3:m,initSegment:void 0};Object(n.isFiniteNumber)(d)||(d=this.lastEndDTS=v||0);var b=_.samples;if(!b||!b.length)return x;var T={initPTS:void 0,timescale:1},A=this.initData;if((!A||!A.length)&&(this.generateInitSegment(b),A=this.initData),!A||!A.length)return l.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),x;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1),Object(n.isFiniteNumber)(y)||(this.initPTS=T.initPTS=y=p(A,b,d));var L=Object(a.getDuration)(b,A),R=d,w=L+R;Object(a.offsetStartDTS)(A,b,y),L>0?this.lastEndDTS=w:(l.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var O=!!A.audio,I=!!A.video,D="";O&&(D+="audio"),I&&(D+="video");var C={data1:b,startPTS:R,startDTS:R,endPTS:w,endDTS:w,type:D,hasAudio:O,hasVideo:I,nb:1,dropped:0};return x.audio=C.type==="audio"?C:void 0,x.video=C.type!=="audio"?C:void 0,x.text=c,x.id3=m,x.initSegment=T,x},f}(),p=function(g,E,S){return Object(a.getStartDTS)(g,E)-S};function u(f,g){var E=f==null?void 0:f.codec;return E&&E.length>4?E:E==="hvc1"?"hvc1.1.c.L120.90":E==="av01"?"av01.0.04M.08":E==="avc1"||g===o.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}i.default=h},"./src/task-loop.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=a.prototype;return o.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function(){},o.hasInterval=function(){return!!this._tickInterval},o.hasNextTick=function(){return!!this._tickTimer},o.setInterval=function(h){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,h),!0)},o.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},o.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},o.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function(){},a}()},"./src/types/cmcd.ts":function(r,i,t){t.r(i),t.d(i,"CMCDVersion",function(){return n}),t.d(i,"CMCDObjectType",function(){return a}),t.d(i,"CMCDStreamingFormat",function(){return o}),t.d(i,"CMCDStreamType",function(){return l});var n=1,a;(function(h){h.MANIFEST="m",h.AUDIO="a",h.VIDEO="v",h.MUXED="av",h.INIT="i",h.CAPTION="c",h.TIMED_TEXT="tt",h.KEY="k",h.OTHER="o"})(a||(a={}));var o;(function(h){h.DASH="d",h.HLS="h",h.SMOOTH="s",h.OTHER="o"})(o||(o={}));var l;(function(h){h.VOD="v",h.LIVE="l"})(l||(l={}))},"./src/types/level.ts":function(r,i,t){t.r(i),t.d(i,"HlsSkip",function(){return o}),t.d(i,"getSkipValue",function(){return l}),t.d(i,"HlsUrlParameters",function(){return h}),t.d(i,"Level",function(){return p});function n(u,f){for(var g=0;g<f.length;g++){var E=f[g];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(u,E.key,E)}}function a(u,f,g){return f&&n(u.prototype,f),g&&n(u,g),u}var o;(function(u){u.No="",u.Yes="YES",u.v2="v2"})(o||(o={}));function l(u,f){var g=u.canSkipUntil,E=u.canSkipDateRanges,S=u.endSN,_=f!==void 0?f-S:0;return g&&_<g?E?o.v2:o.Yes:o.No}var h=function(){function u(g,E,S){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=g,this.part=E,this.skip=S}var f=u.prototype;return f.addDirectives=function(E){var S=new self.URL(E);return this.msn!==void 0&&S.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&S.searchParams.set("_HLS_part",this.part.toString()),this.skip&&S.searchParams.set("_HLS_skip",this.skip),S.toString()},u}(),p=function(){function u(f){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[f.url],this.attrs=f.attrs,this.bitrate=f.bitrate,f.details&&(this.details=f.details),this.id=f.id||0,this.name=f.name,this.width=f.width||0,this.height=f.height||0,this.audioCodec=f.audioCodec,this.videoCodec=f.videoCodec,this.unknownCodecs=f.unknownCodecs,this.codecSet=[f.videoCodec,f.audioCodec].filter(function(g){return g}).join(",").replace(/\.[^.,]+/g,"")}return a(u,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(g){var E=g%this.url.length;this._urlId!==E&&(this.details=void 0,this._urlId=E)}}]),u}()},"./src/types/loader.ts":function(r,i,t){t.r(i),t.d(i,"PlaylistContextType",function(){return n}),t.d(i,"PlaylistLevelType",function(){return a});var n;(function(o){o.MANIFEST="manifest",o.LEVEL="level",o.AUDIO_TRACK="audioTrack",o.SUBTITLE_TRACK="subtitleTrack"})(n||(n={}));var a;(function(o){o.MAIN="main",o.AUDIO="audio",o.SUBTITLE="subtitle"})(a||(a={}))},"./src/types/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"ChunkMetadata",function(){return n});var n=function(l,h,p,u,f,g){u===void 0&&(u=0),f===void 0&&(f=-1),g===void 0&&(g=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=a(),this.buffering={audio:a(),video:a(),audiovideo:a()},this.level=l,this.sn=h,this.id=p,this.size=u,this.part=f,this.partial=g};function a(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(r,i,t){t.r(i),t.d(i,"AttrList",function(){return o});var n=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function l(p){typeof p=="string"&&(p=l.parseAttrList(p));for(var u in p)p.hasOwnProperty(u)&&(this[u]=p[u])}var h=l.prototype;return h.decimalInteger=function(u){var f=parseInt(this[u],10);return f>Number.MAX_SAFE_INTEGER?1/0:f},h.hexadecimalInteger=function(u){if(this[u]){var f=(this[u]||"0x").slice(2);f=(f.length&1?"0":"")+f;for(var g=new Uint8Array(f.length/2),E=0;E<f.length/2;E++)g[E]=parseInt(f.slice(E*2,E*2+2),16);return g}else return null},h.hexadecimalIntegerAsNumber=function(u){var f=parseInt(this[u],16);return f>Number.MAX_SAFE_INTEGER?1/0:f},h.decimalFloatingPoint=function(u){return parseFloat(this[u])},h.optionalFloat=function(u,f){var g=this[u];return g?parseFloat(g):f},h.enumeratedString=function(u){return this[u]},h.bool=function(u){return this[u]==="YES"},h.decimalResolution=function(u){var f=n.exec(this[u]);if(f!==null)return{width:parseInt(f[1],10),height:parseInt(f[2],10)}},l.parseAttrList=function(u){var f,g={},E='"';for(a.lastIndex=0;(f=a.exec(u))!==null;){var S=f[2];S.indexOf(E)===0&&S.lastIndexOf(E)===S.length-1&&(S=S.slice(1,-1)),g[f[1]]=S}return g},l}()},"./src/utils/binary-search.ts":function(r,i,t){t.r(i);var n={search:function(o,l){for(var h=0,p=o.length-1,u=null,f=null;h<=p;){u=(h+p)/2|0,f=o[u];var g=l(f);if(g>0)h=u+1;else if(g<0)p=u-1;else return f}return null}};i.default=n},"./src/utils/buffer-helper.ts":function(r,i,t){t.r(i),t.d(i,"BufferHelper",function(){return o});var n=t("./src/utils/logger.ts"),a={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function l(){}return l.isBuffered=function(p,u){try{if(p){for(var f=l.getBuffered(p),g=0;g<f.length;g++)if(u>=f.start(g)&&u<=f.end(g))return!0}}catch(E){}return!1},l.bufferInfo=function(p,u,f){try{if(p){var g=l.getBuffered(p),E=[],S;for(S=0;S<g.length;S++)E.push({start:g.start(S),end:g.end(S)});return this.bufferedInfo(E,u,f)}}catch(_){}return{len:0,start:u,end:u,nextStart:void 0}},l.bufferedInfo=function(p,u,f){u=Math.max(0,u),p.sort(function(T,A){var L=T.start-A.start;return L||A.end-T.end});var g=[];if(f)for(var E=0;E<p.length;E++){var S=g.length;if(S){var _=g[S-1].end;p[E].start-_<f?p[E].end>_&&(g[S-1].end=p[E].end):g.push(p[E])}else g.push(p[E])}else g=p;for(var m=0,c,v=u,y=u,d=0;d<g.length;d++){var x=g[d].start,b=g[d].end;if(u+f>=x&&u<b)v=x,y=b,m=y-u;else if(u+f<x){c=x;break}}return{len:m,start:v||0,end:y||0,nextStart:c}},l.getBuffered=function(p){try{return p.buffered}catch(u){return n.logger.log("failed to get media.buffered",u),a}},l}()},"./src/utils/cea-608-parser.ts":function(r,i,t){t.r(i),t.d(i,"Row",function(){return y}),t.d(i,"CaptionScreen",function(){return d});var n=t("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(w){var O=w;return a.hasOwnProperty(w)&&(O=a[w]),String.fromCharCode(O)},l=15,h=100,p={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},f={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},g={25:2,26:4,29:6,30:8,31:10,27:13,28:15},E=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],S;(function(R){R[R.ERROR=0]="ERROR",R[R.TEXT=1]="TEXT",R[R.WARNING=2]="WARNING",R[R.INFO=2]="INFO",R[R.DEBUG=3]="DEBUG",R[R.DATA=3]="DATA"})(S||(S={}));var _=function(){function R(){this.time=null,this.verboseLevel=S.ERROR}var w=R.prototype;return w.log=function(I,D){this.verboseLevel>=I&&n.logger.log(this.time+" ["+I+"] "+D)},R}(),m=function(w){for(var O=[],I=0;I<w.length;I++)O.push(w[I].toString(16));return O},c=function(){function R(O,I,D,C,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=O||"white",this.underline=I||!1,this.italics=D||!1,this.background=C||"black",this.flash=P||!1}var w=R.prototype;return w.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},w.setStyles=function(I){for(var D=["foreground","underline","italics","background","flash"],C=0;C<D.length;C++){var P=D[C];I.hasOwnProperty(P)&&(this[P]=I[P])}},w.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},w.equals=function(I){return this.foreground===I.foreground&&this.underline===I.underline&&this.italics===I.italics&&this.background===I.background&&this.flash===I.flash},w.copy=function(I){this.foreground=I.foreground,this.underline=I.underline,this.italics=I.italics,this.background=I.background,this.flash=I.flash},w.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},R}(),v=function(){function R(O,I,D,C,P,M){this.uchar=void 0,this.penState=void 0,this.uchar=O||" ",this.penState=new c(I,D,C,P,M)}var w=R.prototype;return w.reset=function(){this.uchar=" ",this.penState.reset()},w.setChar=function(I,D){this.uchar=I,this.penState.copy(D)},w.setPenState=function(I){this.penState.copy(I)},w.equals=function(I){return this.uchar===I.uchar&&this.penState.equals(I.penState)},w.copy=function(I){this.uchar=I.uchar,this.penState.copy(I.penState)},w.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},R}(),y=function(){function R(O){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var I=0;I<h;I++)this.chars.push(new v);this.logger=O,this.pos=0,this.currPenState=new c}var w=R.prototype;return w.equals=function(I){for(var D=!0,C=0;C<h;C++)if(!this.chars[C].equals(I.chars[C])){D=!1;break}return D},w.copy=function(I){for(var D=0;D<h;D++)this.chars[D].copy(I.chars[D])},w.isEmpty=function(){for(var I=!0,D=0;D<h;D++)if(!this.chars[D].isEmpty()){I=!1;break}return I},w.setCursor=function(I){this.pos!==I&&(this.pos=I),this.pos<0?(this.logger.log(S.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>h&&(this.logger.log(S.DEBUG,"Too large cursor position "+this.pos),this.pos=h)},w.moveCursor=function(I){var D=this.pos+I;if(I>1)for(var C=this.pos+1;C<D+1;C++)this.chars[C].setPenState(this.currPenState);this.setCursor(D)},w.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},w.insertChar=function(I){I>=144&&this.backSpace();var D=o(I);if(this.pos>=h){this.logger.log(S.ERROR,"Cannot insert "+I.toString(16)+" ("+D+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(D,this.currPenState),this.moveCursor(1)},w.clearFromPos=function(I){var D;for(D=I;D<h;D++)this.chars[D].reset()},w.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},w.clearToEndOfRow=function(){this.clearFromPos(this.pos)},w.getTextString=function(){for(var I=[],D=!0,C=0;C<h;C++){var P=this.chars[C].uchar;P!==" "&&(D=!1),I.push(P)}return D?"":I.join("")},w.setPenStyles=function(I){this.currPenState.setStyles(I);var D=this.chars[this.pos];D.setPenState(this.currPenState)},R}(),d=function(){function R(O){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var I=0;I<l;I++)this.rows.push(new y(O));this.logger=O,this.currRow=l-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var w=R.prototype;return w.reset=function(){for(var I=0;I<l;I++)this.rows[I].clear();this.currRow=l-1},w.equals=function(I){for(var D=!0,C=0;C<l;C++)if(!this.rows[C].equals(I.rows[C])){D=!1;break}return D},w.copy=function(I){for(var D=0;D<l;D++)this.rows[D].copy(I.rows[D])},w.isEmpty=function(){for(var I=!0,D=0;D<l;D++)if(!this.rows[D].isEmpty()){I=!1;break}return I},w.backSpace=function(){var I=this.rows[this.currRow];I.backSpace()},w.clearToEndOfRow=function(){var I=this.rows[this.currRow];I.clearToEndOfRow()},w.insertChar=function(I){var D=this.rows[this.currRow];D.insertChar(I)},w.setPen=function(I){var D=this.rows[this.currRow];D.setPenStyles(I)},w.moveCursor=function(I){var D=this.rows[this.currRow];D.moveCursor(I)},w.setCursor=function(I){this.logger.log(S.INFO,"setCursor: "+I);var D=this.rows[this.currRow];D.setCursor(I)},w.setPAC=function(I){this.logger.log(S.INFO,"pacData = "+JSON.stringify(I));var D=I.row-1;if(this.nrRollUpRows&&D<this.nrRollUpRows-1&&(D=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==D){for(var C=0;C<l;C++)this.rows[C].clear();var P=this.currRow+1-this.nrRollUpRows,M=this.lastOutputScreen;if(M){var N=M.rows[P].cueStartTime,B=this.logger.time;if(N&&B!==null&&N<B)for(var U=0;U<this.nrRollUpRows;U++)this.rows[D-this.nrRollUpRows+U+1].copy(M.rows[P+U])}}this.currRow=D;var F=this.rows[this.currRow];if(I.indent!==null){var j=I.indent,V=Math.max(j-1,0);F.setCursor(I.indent),I.color=F.chars[V].penState.foreground}var G={foreground:I.color,underline:I.underline,italics:I.italics,background:"black",flash:!1};this.setPen(G)},w.setBkgData=function(I){this.logger.log(S.INFO,"bkgData = "+JSON.stringify(I)),this.backSpace(),this.setPen(I),this.insertChar(32)},w.setRollUpRows=function(I){this.nrRollUpRows=I},w.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(S.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(S.TEXT,this.getDisplayText());var I=this.currRow+1-this.nrRollUpRows,D=this.rows.splice(I,1)[0];D.clear(),this.rows.splice(this.currRow,0,D),this.logger.log(S.INFO,"Rolling up")},w.getDisplayText=function(I){I=I||!1;for(var D=[],C="",P=-1,M=0;M<l;M++){var N=this.rows[M].getTextString();N&&(P=M+1,I?D.push("Row "+P+": '"+N+"'"):D.push(N.trim()))}return D.length>0&&(I?C="["+D.join(" | ")+"]":C=D.join(`
`)),C},w.getTextAndFormat=function(){return this.rows},R}(),x=function(){function R(O,I,D){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=O,this.outputFilter=I,this.mode=null,this.verbose=0,this.displayedMemory=new d(D),this.nonDisplayedMemory=new d(D),this.lastOutputScreen=new d(D),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=D}var w=R.prototype;return w.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},w.getHandler=function(){return this.outputFilter},w.setHandler=function(I){this.outputFilter=I},w.setPAC=function(I){this.writeScreen.setPAC(I)},w.setBkgData=function(I){this.writeScreen.setBkgData(I)},w.setMode=function(I){I!==this.mode&&(this.mode=I,this.logger.log(S.INFO,"MODE="+I),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=I)},w.insertChars=function(I){for(var D=0;D<I.length;D++)this.writeScreen.insertChar(I[D]);var C=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(S.INFO,C+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(S.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},w.ccRCL=function(){this.logger.log(S.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},w.ccBS=function(){this.logger.log(S.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},w.ccAOF=function(){},w.ccAON=function(){},w.ccDER=function(){this.logger.log(S.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},w.ccRU=function(I){this.logger.log(S.INFO,"RU("+I+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(I)},w.ccFON=function(){this.logger.log(S.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},w.ccRDC=function(){this.logger.log(S.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},w.ccTR=function(){this.logger.log(S.INFO,"TR"),this.setMode("MODE_TEXT")},w.ccRTD=function(){this.logger.log(S.INFO,"RTD"),this.setMode("MODE_TEXT")},w.ccEDM=function(){this.logger.log(S.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},w.ccCR=function(){this.logger.log(S.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},w.ccENM=function(){this.logger.log(S.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},w.ccEOC=function(){if(this.logger.log(S.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var I=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=I,this.writeScreen=this.nonDisplayedMemory,this.logger.log(S.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},w.ccTO=function(I){this.logger.log(S.INFO,"TO("+I+") - Tab Offset"),this.writeScreen.moveCursor(I)},w.ccMIDROW=function(I){var D={flash:!1};if(D.underline=I%2==1,D.italics=I>=46,D.italics)D.foreground="white";else{var C=Math.floor(I/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];D.foreground=P[C]}this.logger.log(S.INFO,"MIDROW: "+JSON.stringify(D)),this.writeScreen.setPen(D)},w.outputDataUpdate=function(I){I===void 0&&(I=!1);var D=this.logger.time;D!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=D:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,D,this.lastOutputScreen),I&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:D),this.lastOutputScreen.copy(this.displayedMemory))},w.cueSplitAtTime=function(I){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,I,this.displayedMemory),this.cueStartTime=I))},R}(),b=function(){function R(O,I,D){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var C=new _;this.channels=[null,new x(O,I,C),new x(O+1,D,C)],this.cmdHistory=L(),this.logger=C}var w=R.prototype;return w.getHandler=function(I){return this.channels[I].getHandler()},w.setHandler=function(I,D){this.channels[I].setHandler(D)},w.addData=function(I,D){var C,P,M,N=!1;this.logger.time=I;for(var B=0;B<D.length;B+=2)if(P=D[B]&127,M=D[B+1]&127,!(P===0&&M===0)){if(this.logger.log(S.DATA,"["+m([D[B],D[B+1]])+"] -> ("+m([P,M])+")"),C=this.parseCmd(P,M),C||(C=this.parseMidrow(P,M)),C||(C=this.parsePAC(P,M)),C||(C=this.parseBackgroundAttributes(P,M)),!C&&(N=this.parseChars(P,M),N)){var U=this.currentChannel;if(U&&U>0){var F=this.channels[U];F.insertChars(N)}else this.logger.log(S.WARNING,"No channel found yet. TEXT-MODE?")}!C&&!N&&this.logger.log(S.WARNING,"Couldn't parse cleaned data "+m([P,M])+" orig: "+m([D[B],D[B+1]]))}},w.parseCmd=function(I,D){var C=this.cmdHistory,P=(I===20||I===28||I===21||I===29)&&D>=32&&D<=47,M=(I===23||I===31)&&D>=33&&D<=35;if(!(P||M))return!1;if(A(I,D,C))return T(null,null,C),this.logger.log(S.DEBUG,"Repeated command ("+m([I,D])+") is dropped"),!0;var N=I===20||I===21||I===23?1:2,B=this.channels[N];return I===20||I===21||I===28||I===29?D===32?B.ccRCL():D===33?B.ccBS():D===34?B.ccAOF():D===35?B.ccAON():D===36?B.ccDER():D===37?B.ccRU(2):D===38?B.ccRU(3):D===39?B.ccRU(4):D===40?B.ccFON():D===41?B.ccRDC():D===42?B.ccTR():D===43?B.ccRTD():D===44?B.ccEDM():D===45?B.ccCR():D===46?B.ccENM():D===47&&B.ccEOC():B.ccTO(D-32),T(I,D,C),this.currentChannel=N,!0},w.parseMidrow=function(I,D){var C=0;if((I===17||I===25)&&D>=32&&D<=47){if(I===17?C=1:C=2,C!==this.currentChannel)return this.logger.log(S.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[C];return P?(P.ccMIDROW(D),this.logger.log(S.DEBUG,"MIDROW ("+m([I,D])+")"),!0):!1}return!1},w.parsePAC=function(I,D){var C,P=this.cmdHistory,M=(I>=17&&I<=23||I>=25&&I<=31)&&D>=64&&D<=127,N=(I===16||I===24)&&D>=64&&D<=95;if(!(M||N))return!1;if(A(I,D,P))return T(null,null,P),!0;var B=I<=23?1:2;D>=64&&D<=95?C=B===1?p[I]:f[I]:C=B===1?u[I]:g[I];var U=this.channels[B];return U?(U.setPAC(this.interpretPAC(C,D)),T(I,D,P),this.currentChannel=B,!0):!1},w.interpretPAC=function(I,D){var C,P={color:null,italics:!1,indent:null,underline:!1,row:I};return D>95?C=D-96:C=D-64,P.underline=(C&1)==1,C<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((C-16)/2)*4,P},w.parseChars=function(I,D){var C,P=null,M=null;if(I>=25?(C=2,M=I-8):(C=1,M=I),M>=17&&M<=19){var N;M===17?N=D+80:M===18?N=D+112:N=D+144,this.logger.log(S.INFO,"Special char '"+o(N)+"' in channel "+C),P=[N]}else I>=32&&I<=127&&(P=D===0?[I]:[I,D]);if(P){var B=m(P);this.logger.log(S.DEBUG,"Char codes =  "+B.join(",")),T(I,D,this.cmdHistory)}return P},w.parseBackgroundAttributes=function(I,D){var C=(I===16||I===24)&&D>=32&&D<=47,P=(I===23||I===31)&&D>=45&&D<=47;if(!(C||P))return!1;var M,N={};I===16||I===24?(M=Math.floor((D-32)/2),N.background=E[M],D%2==1&&(N.background=N.background+"_semi")):D===45?N.background="transparent":(N.foreground="black",D===47&&(N.underline=!0));var B=I<=23?1:2,U=this.channels[B];return U.setBkgData(N),T(I,D,this.cmdHistory),!0},w.reset=function(){for(var I=0;I<Object.keys(this.channels).length;I++){var D=this.channels[I];D&&D.reset()}this.cmdHistory=L()},w.cueSplitAtTime=function(I){for(var D=0;D<this.channels.length;D++){var C=this.channels[D];C&&C.cueSplitAtTime(I)}},R}();function T(R,w,O){O.a=R,O.b=w}function A(R,w,O){return O.a===R&&O.b===w}function L(){return{a:null,b:null}}i.default=b},"./src/utils/codecs.ts":function(r,i,t){t.r(i),t.d(i,"isCodecType",function(){return a}),t.d(i,"isCodecSupportedInMp4",function(){return o});var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function a(l,h){var p=n[h];return!!p&&p[l.slice(0,4)]===!0}function o(l,h){return MediaSource.isTypeSupported((h||"video")+'/mp4;codecs="'+l+'"')}},"./src/utils/cues.ts":function(r,i,t){t.r(i);var n=t("./src/utils/vttparser.ts"),a=t("./src/utils/webvtt-parser.ts"),o=t("./src/utils/texttrack-utils.ts"),l=/\s/,h={newCue:function(u,f,g,E){for(var S=[],_,m,c,v,y,d=self.VTTCue||self.TextTrackCue,x=0;x<E.rows.length;x++)if(_=E.rows[x],c=!0,v=0,y="",!_.isEmpty()){for(var b=0;b<_.chars.length;b++)l.test(_.chars[b].uchar)&&c?v++:(y+=_.chars[b].uchar,c=!1);_.cueStartTime=f,f===g&&(g+=1e-4),v>=16?v--:v++;var T=Object(n.fixLineBreaks)(y.trim()),A=Object(a.generateCueId)(f,g,T);(!u||!u.cues||!u.cues.getCueById(A))&&(m=new d(f,g,T),m.id=A,m.line=x+1,m.align="left",m.position=10+Math.min(80,Math.floor(v*8/32)*10),S.push(m))}return u&&S.length&&(S.sort(function(L,R){return L.line==="auto"||R.line==="auto"?0:L.line>8&&R.line>8?R.line-L.line:L.line-R.line}),S.forEach(function(L){return Object(o.addCueToTrack)(u,L)})),S}};i.default=h},"./src/utils/discontinuities.ts":function(r,i,t){t.r(i),t.d(i,"findFirstFragWithCC",function(){return l}),t.d(i,"shouldAlignOnDiscontinuities",function(){return h}),t.d(i,"findDiscontinuousReferenceFrag",function(){return p}),t.d(i,"adjustSlidingStart",function(){return f}),t.d(i,"alignStream",function(){return g}),t.d(i,"alignPDT",function(){return S}),t.d(i,"alignFragmentByPDTDelta",function(){return _}),t.d(i,"alignMediaPlaylistByPDT",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts"),o=t("./src/controller/level-helper.ts");function l(c,v){for(var y=null,d=0,x=c.length;d<x;d++){var b=c[d];if(b&&b.cc===v){y=b;break}}return y}function h(c,v,y){return!!(v.details&&(y.endCC>y.startCC||c&&c.cc<y.startCC))}function p(c,v){var y=c.fragments,d=v.fragments;if(!d.length||!y.length){a.logger.log("No fragments to align");return}var x=l(y,d[0].cc);if(!x||x&&!x.startPTS){a.logger.log("No frag in previous level to align on");return}return x}function u(c,v){if(c){var y=c.start+v;c.start=c.startPTS=y,c.endPTS=y+c.duration}}function f(c,v){for(var y=v.fragments,d=0,x=y.length;d<x;d++)u(y[d],c);v.fragmentHint&&u(v.fragmentHint,c),v.alignedSliding=!0}function g(c,v,y){!v||(E(c,y,v),!y.alignedSliding&&v.details&&S(y,v.details),!y.alignedSliding&&v.details&&!y.skippedSegments&&Object(o.adjustSliding)(v.details,y))}function E(c,v,y){if(h(c,y,v)){var d=p(y.details,v);d&&Object(n.isFiniteNumber)(d.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+v.url),f(d.start,v))}}function S(c,v){if(!(!v.fragments.length||!c.hasProgramDateTime||!v.hasProgramDateTime)){var y=v.fragments[0].programDateTime,d=c.fragments[0].programDateTime,x=(d-y)/1e3+v.fragments[0].start;x&&Object(n.isFiniteNumber)(x)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(d-y)+"ms, sliding:"+x.toFixed(3)+" "+c.url+" "),f(x,c))}}function _(c,v){var y=c.programDateTime;if(!!y){var d=(y-v)/1e3;c.start=c.startPTS=d,c.endPTS=d+c.duration}}function m(c,v){if(!(!v.fragments.length||!c.hasProgramDateTime||!v.hasProgramDateTime)){var y=v.fragments[0].programDateTime,d=v.fragments[0].start,x=y-d*1e3;c.fragments.forEach(function(b){_(b,x)}),c.fragmentHint&&_(c.fragmentHint,x),c.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(r,i,t){t.r(i);var n=t("./src/utils/ewma.ts"),a=function(){function o(h,p,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(h),this.fast_=new n.default(p)}var l=o.prototype;return l.update=function(p,u){var f=this.slow_,g=this.fast_;this.slow_.halfLife!==p&&(this.slow_=new n.default(p,f.getEstimate(),f.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new n.default(u,g.getEstimate(),g.getTotalWeight()))},l.sample=function(p,u){p=Math.max(p,this.minDelayMs_);var f=8*u,g=p/1e3,E=f/g;this.fast_.sample(g,E),this.slow_.sample(g,E)},l.canEstimate=function(){var p=this.fast_;return p&&p.getTotalWeight()>=this.minWeight_},l.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},l.destroy=function(){},o}();i.default=a},"./src/utils/ewma.ts":function(r,i,t){t.r(i);var n=function(){function a(l,h,p){h===void 0&&(h=0),p===void 0&&(p=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=l,this.alpha_=l?Math.exp(Math.log(.5)/l):0,this.estimate_=h,this.totalWeight_=p}var o=a.prototype;return o.sample=function(h,p){var u=Math.pow(this.alpha_,h);this.estimate_=p*(1-u)+u*this.estimate_,this.totalWeight_+=h},o.getTotalWeight=function(){return this.totalWeight_},o.getEstimate=function(){if(this.alpha_){var h=1-Math.pow(this.alpha_,this.totalWeight_);if(h)return this.estimate_/h}return this.estimate_},a}();i.default=n},"./src/utils/fetch-loader.ts":function(r,i,t){t.r(i),t.d(i,"fetchSupported",function(){return _});var n=t("./src/polyfills/number.ts"),a=t("./src/loader/load-stats.ts"),o=t("./src/demux/chunk-cache.ts");function l(d,x){d.prototype=Object.create(x.prototype),d.prototype.constructor=d,g(d,x)}function h(d){var x=typeof Map=="function"?new Map:void 0;return h=function(T){if(T===null||!f(T))return T;if(typeof T!="function")throw new TypeError("Super expression must either be null or a function");if(typeof x!="undefined"){if(x.has(T))return x.get(T);x.set(T,A)}function A(){return p(T,arguments,E(this).constructor)}return A.prototype=Object.create(T.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),g(A,T)},h(d)}function p(d,x,b){return u()?p=Reflect.construct:p=function(A,L,R){var w=[null];w.push.apply(w,L);var O=Function.bind.apply(A,w),I=new O;return R&&g(I,R.prototype),I},p.apply(null,arguments)}function u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(d){return!1}}function f(d){return Function.toString.call(d).indexOf("[native code]")!==-1}function g(d,x){return g=Object.setPrototypeOf||function(T,A){return T.__proto__=A,T},g(d,x)}function E(d){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)},E(d)}function S(){return S=Object.assign||function(d){for(var x=1;x<arguments.length;x++){var b=arguments[x];for(var T in b)Object.prototype.hasOwnProperty.call(b,T)&&(d[T]=b[T])}return d},S.apply(this,arguments)}function _(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(d){}return!1}var m=function(){function d(b){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=b.fetchSetup||v,this.controller=new self.AbortController,this.stats=new a.LoadStats}var x=d.prototype;return x.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},x.abortInternal=function(){var T=this.response;(!T||!T.ok)&&(this.stats.aborted=!0,this.controller.abort())},x.abort=function(){var T;this.abortInternal(),(T=this.callbacks)!==null&&T!==void 0&&T.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},x.load=function(T,A,L){var R=this,w=this.stats;if(w.loading.start)throw new Error("Loader can only be used once.");w.loading.start=self.performance.now();var O=c(T,this.controller.signal),I=L.onProgress,D=T.responseType==="arraybuffer",C=D?"byteLength":"length";this.context=T,this.config=A,this.callbacks=L,this.request=this.fetchSetup(T,O),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){R.abortInternal(),L.onTimeout(w,T,R.response)},A.timeout),self.fetch(this.request).then(function(P){if(R.response=R.loader=P,!P.ok){var M=P.status,N=P.statusText;throw new y(N||"fetch, bad network response",M,P)}return w.loading.first=Math.max(self.performance.now(),w.loading.start),w.total=parseInt(P.headers.get("Content-Length")||"0"),I&&Object(n.isFiniteNumber)(A.highWaterMark)?R.loadProgressively(P,w,T,A.highWaterMark,I):D?P.arrayBuffer():P.text()}).then(function(P){var M=R.response;self.clearTimeout(R.requestTimeout),w.loading.end=Math.max(self.performance.now(),w.loading.first),w.loaded=w.total=P[C];var N={url:M.url,data:P};I&&!Object(n.isFiniteNumber)(A.highWaterMark)&&I(w,T,P,M),L.onSuccess(N,w,T,M)}).catch(function(P){if(self.clearTimeout(R.requestTimeout),!w.aborted){var M=P.code||0;L.onError({code:M,text:P.message},T,P.details)}})},x.getCacheAge=function(){var T=null;if(this.response){var A=this.response.headers.get("age");T=A?parseFloat(A):null}return T},x.loadProgressively=function(T,A,L,R,w){R===void 0&&(R=0);var O=new o.default,I=T.body.getReader(),D=function C(){return I.read().then(function(P){if(P.done)return O.dataLength&&w(A,L,O.flush(),T),Promise.resolve(new ArrayBuffer(0));var M=P.value,N=M.length;return A.loaded+=N,N<R||O.dataLength?(O.push(M),O.dataLength>=R&&w(A,L,O.flush(),T)):w(A,L,M,T),C()}).catch(function(){return Promise.reject()})};return D()},d}();function c(d,x){var b={method:"GET",mode:"cors",credentials:"same-origin",signal:x,headers:new self.Headers(S({},d.headers))};return d.rangeEnd&&b.headers.set("Range","bytes="+d.rangeStart+"-"+String(d.rangeEnd-1)),b}function v(d,x){return new self.Request(d.url,x)}var y=function(d){l(x,d);function x(b,T,A){var L;return L=d.call(this,b)||this,L.code=void 0,L.details=void 0,L.code=T,L.details=A,L}return x}(h(Error));i.default=m},"./src/utils/imsc1-ttml-parser.ts":function(r,i,t){t.r(i),t.d(i,"IMSC1_CODEC",function(){return f}),t.d(i,"parseIMSC1",function(){return _});var n=t("./src/utils/mp4-tools.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/utils/vttcue.ts"),l=t("./src/demux/id3.ts"),h=t("./src/utils/timescale-conversion.ts"),p=t("./src/utils/webvtt-parser.ts");function u(){return u=Object.assign||function(R){for(var w=1;w<arguments.length;w++){var O=arguments[w];for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(R[I]=O[I])}return R},u.apply(this,arguments)}var f="stpp.ttml.im1t",g=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,E=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,S={left:"start",center:"center",right:"end",start:"start",end:"end"};function _(R,w,O,I,D){var C=Object(n.findBox)(new Uint8Array(R),["mdat"]);if(C.length===0){D(new Error("Could not parse IMSC1 mdat"));return}var P=C[0],M=Object(l.utf8ArrayToStr)(new Uint8Array(R,P.start,P.end-P.start)),N=Object(h.toTimescaleFromScale)(w,1,O);try{I(m(M,N))}catch(B){D(B)}}function m(R,w){var O=new DOMParser,I=O.parseFromString(R,"text/xml"),D=I.getElementsByTagName("tt")[0];if(!D)throw new Error("Invalid ttml");var C={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(C).reduce(function(F,j){return F[j]=D.getAttribute("ttp:"+j)||C[j],F},{}),M=D.getAttribute("xml:space")!=="preserve",N=v(c(D,"styling","style")),B=v(c(D,"layout","region")),U=c(D,"body","[begin]");return[].map.call(U,function(F){var j=y(F,M);if(!j||!F.hasAttribute("begin"))return null;var V=T(F.getAttribute("begin"),P),G=T(F.getAttribute("dur"),P),Y=T(F.getAttribute("end"),P);if(V===null)throw b(F);if(Y===null){if(G===null)throw b(F);Y=V+G}var X=new o.default(V-w,Y-w,j);X.id=Object(p.generateCueId)(X.startTime,X.endTime,X.text);var ie=B[F.getAttribute("region")],he=N[F.getAttribute("style")];X.position=10,X.size=80;var de=d(ie,he),Ae=de.textAlign;if(Ae){var pe=S[Ae];pe&&(X.lineAlign=pe),X.align=Ae}return u(X,de),X}).filter(function(F){return F!==null})}function c(R,w,O){var I=R.getElementsByTagName(w)[0];return I?[].slice.call(I.querySelectorAll(O)):[]}function v(R){return R.reduce(function(w,O){var I=O.getAttribute("xml:id");return I&&(w[I]=O),w},{})}function y(R,w){return[].slice.call(R.childNodes).reduce(function(O,I,D){var C;return I.nodeName==="br"&&D?O+`
`:(C=I.childNodes)!==null&&C!==void 0&&C.length?y(I,w):w?O+I.textContent.trim().replace(/\s+/g," "):O+I.textContent},"")}function d(R,w){var O="http://www.w3.org/ns/ttml#styling",I=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return I.reduce(function(D,C){var P=x(w,O,C)||x(R,O,C);return P&&(D[C]=P),D},{})}function x(R,w,O){return R.hasAttributeNS(w,O)?R.getAttributeNS(w,O):null}function b(R){return new Error("Could not parse ttml timestamp "+R)}function T(R,w){if(!R)return null;var O=Object(a.parseTimeStamp)(R);return O===null&&(g.test(R)?O=A(R,w):E.test(R)&&(O=L(R,w))),O}function A(R,w){var O=g.exec(R),I=(O[4]|0)+(O[5]|0)/w.subFrameRate;return(O[1]|0)*3600+(O[2]|0)*60+(O[3]|0)+I/w.frameRate}function L(R,w){var O=E.exec(R),I=Number(O[1]),D=O[2];switch(D){case"h":return I*3600;case"m":return I*60;case"ms":return I*1e3;case"f":return I/w.frameRate;case"t":return I/w.tickRate}return I}},"./src/utils/logger.ts":function(r,i,t){t.r(i),t.d(i,"enableLogs",function(){return p}),t.d(i,"logger",function(){return u});var n=function(){},a={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=a;function l(f){var g=self.console[f];return g?g.bind(self.console,"["+f+"] >"):n}function h(f){for(var g=arguments.length,E=new Array(g>1?g-1:0),S=1;S<g;S++)E[S-1]=arguments[S];E.forEach(function(_){o[_]=f[_]?f[_].bind(f):l(_)})}function p(f){if(self.console&&f===!0||typeof f=="object"){h(f,"debug","log","info","warn","error");try{o.log()}catch(g){o=a}}else o=a}var u=o},"./src/utils/mediakeys-helper.ts":function(r,i,t){t.r(i),t.d(i,"KeySystems",function(){return n}),t.d(i,"requestMediaKeySystemAccess",function(){return a});var n;(function(o){o.WIDEVINE="com.widevine.alpha",o.PLAYREADY="com.microsoft.playready"})(n||(n={}));var a=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(r,i,t){t.r(i),t.d(i,"getMediaSource",function(){return n});function n(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(r,i,t){t.r(i),t.d(i,"bin2str",function(){return h}),t.d(i,"readUint16",function(){return p}),t.d(i,"readUint32",function(){return u}),t.d(i,"writeUint32",function(){return f}),t.d(i,"findBox",function(){return g}),t.d(i,"parseSegmentIndex",function(){return E}),t.d(i,"parseInitSegment",function(){return S}),t.d(i,"getStartDTS",function(){return _}),t.d(i,"getDuration",function(){return m}),t.d(i,"computeRawDurationFromSamples",function(){return c}),t.d(i,"offsetStartDTS",function(){return v}),t.d(i,"segmentValidRange",function(){return y}),t.d(i,"appendUint8Array",function(){return d});var n=t("./src/utils/typed-array.ts"),a=t("./src/loader/fragment.ts"),o=Math.pow(2,32)-1,l=[].push;function h(x){return String.fromCharCode.apply(null,x)}function p(x,b){"data"in x&&(b+=x.start,x=x.data);var T=x[b]<<8|x[b+1];return T<0?65536+T:T}function u(x,b){"data"in x&&(b+=x.start,x=x.data);var T=x[b]<<24|x[b+1]<<16|x[b+2]<<8|x[b+3];return T<0?4294967296+T:T}function f(x,b,T){"data"in x&&(b+=x.start,x=x.data),x[b]=T>>24,x[b+1]=T>>16&255,x[b+2]=T>>8&255,x[b+3]=T&255}function g(x,b){var T=[];if(!b.length)return T;var A,L,R;"data"in x?(A=x.data,L=x.start,R=x.end):(A=x,L=0,R=A.byteLength);for(var w=L;w<R;){var O=u(A,w),I=h(A.subarray(w+4,w+8)),D=O>1?w+O:R;if(I===b[0])if(b.length===1)T.push({data:A,start:w+8,end:D});else{var C=g({data:A,start:w+8,end:D},b.slice(1));C.length&&l.apply(T,C)}w=D}return T}function E(x){var b=g(x,["moov"]),T=b[0],A=T?T.end:null,L=g(x,["sidx"]);if(!L||!L[0])return null;var R=[],w=L[0],O=w.data[0],I=O===0?8:16,D=u(w,I);I+=4;var C=0,P=0;O===0?I+=8:I+=16,I+=2;var M=w.end+P,N=p(w,I);I+=2;for(var B=0;B<N;B++){var U=I,F=u(w,U);U+=4;var j=F&2147483647,V=(F&2147483648)>>>31;if(V===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var G=u(w,U);U+=4,R.push({referenceSize:j,subsegmentDuration:G,info:{duration:G/D,start:M,end:M+j-1}}),M+=j,U+=4,I=U}return{earliestPresentationTime:C,timescale:D,version:O,referencesCount:N,references:R,moovEndOffset:A}}function S(x){for(var b=[],T=g(x,["moov","trak"]),A=0;A<T.length;A++){var L=T[A],R=g(L,["tkhd"])[0];if(R){var w=R.data[R.start],O=w===0?12:20,I=u(R,O),D=g(L,["mdia","mdhd"])[0];if(D){w=D.data[D.start],O=w===0?12:20;var C=u(D,O),P=g(L,["mdia","hdlr"])[0];if(P){var M=h(P.data.subarray(P.start+8,P.start+12)),N={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[M];if(N){var B=g(L,["mdia","minf","stbl","stsd"])[0],U=void 0;B&&(U=h(B.data.subarray(B.start+12,B.start+16))),b[I]={timescale:C,type:N},b[N]={timescale:C,id:I,codec:U}}}}}}var F=g(x,["moov","mvex","trex"]);return F.forEach(function(j){var V=u(j,4),G=b[V];G&&(G.default={duration:u(j,12),flags:u(j,20)})}),b}function _(x,b){return g(b,["moof","traf"]).reduce(function(T,A){var L=g(A,["tfdt"])[0],R=L.data[L.start],w=g(A,["tfhd"]).reduce(function(O,I){var D=u(I,4),C=x[D];if(C){var P=u(L,4);R===1&&(P*=Math.pow(2,32),P+=u(L,8));var M=C.timescale||9e4,N=P/M;if(isFinite(N)&&(O===null||N<O))return N}return O},null);return w!==null&&isFinite(w)&&(T===null||w<T)?w:T},null)||0}function m(x,b){for(var T=0,A=0,L=0,R=g(x,["moof","traf"]),w=0;w<R.length;w++){var O=R[w],I=g(O,["tfhd"])[0],D=u(I,4),C=b[D];if(!!C){var P=C.default,M=u(I,0)|(P==null?void 0:P.flags),N=P==null?void 0:P.duration;M&8&&(M&2?N=u(I,12):N=u(I,8));for(var B=C.timescale||9e4,U=g(O,["trun"]),F=0;F<U.length;F++){if(T=c(U[F]),!T&&N){var j=u(U[F],4);T=N*j}C.type===a.ElementaryStreamTypes.VIDEO?A+=T/B:C.type===a.ElementaryStreamTypes.AUDIO&&(L+=T/B)}}}if(A===0&&L===0){var V=E(x);if(V!=null&&V.references)return V.references.reduce(function(G,Y){return G+Y.info.duration||0},0)}return A||L}function c(x){var b=u(x,0),T=8;b&1&&(T+=4),b&4&&(T+=4);for(var A=0,L=u(x,4),R=0;R<L;R++){if(b&256){var w=u(x,T);A+=w,T+=4}b&512&&(T+=4),b&1024&&(T+=4),b&2048&&(T+=4)}return A}function v(x,b,T){g(b,["moof","traf"]).forEach(function(A){g(A,["tfhd"]).forEach(function(L){var R=u(L,4),w=x[R];if(!!w){var O=w.timescale||9e4;g(A,["tfdt"]).forEach(function(I){var D=I.data[I.start],C=u(I,4);if(D===0)f(I,4,C-T*O);else{C*=Math.pow(2,32),C+=u(I,8),C-=T*O,C=Math.max(C,0);var P=Math.floor(C/(o+1)),M=Math.floor(C%(o+1));f(I,4,P),f(I,8,M)}})}})})}function y(x){var b={valid:null,remainder:null},T=g(x,["moof"]);if(T){if(T.length<2)return b.remainder=x,b}else return b;var A=T[T.length-1];return b.valid=Object(n.sliceUint8)(x,0,A.start-8),b.remainder=Object(n.sliceUint8)(x,A.start-8),b}function d(x,b){var T=new Uint8Array(x.length+b.length);return T.set(x),T.set(b,x.length),T}},"./src/utils/output-filter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,h){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=l,this.trackName=h}var o=a.prototype;return o.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function(h,p,u){(this.startTime===null||this.startTime>h)&&(this.startTime=h),this.endTime=p,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function(){this.cueRanges=[],this.startTime=null},a}()},"./src/utils/texttrack-utils.ts":function(r,i,t){t.r(i),t.d(i,"sendAddTrackEvent",function(){return a}),t.d(i,"addCueToTrack",function(){return o}),t.d(i,"clearCurrentCues",function(){return l}),t.d(i,"removeCuesInRange",function(){return h}),t.d(i,"getCuesInRange",function(){return u});var n=t("./src/utils/logger.ts");function a(f,g){var E;try{E=new Event("addtrack")}catch(S){E=document.createEvent("Event"),E.initEvent("addtrack",!1,!1)}E.track=f,g.dispatchEvent(E)}function o(f,g){var E=f.mode;if(E==="disabled"&&(f.mode="hidden"),f.cues&&!f.cues.getCueById(g.id))try{if(f.addCue(g),!f.cues.getCueById(g.id))throw new Error("addCue is failed for: "+g)}catch(_){n.logger.debug("[texttrack-utils]: "+_);var S=new self.TextTrackCue(g.startTime,g.endTime,g.text);S.id=g.id,f.addCue(S)}E==="disabled"&&(f.mode=E)}function l(f){var g=f.mode;if(g==="disabled"&&(f.mode="hidden"),f.cues)for(var E=f.cues.length;E--;)f.removeCue(f.cues[E]);g==="disabled"&&(f.mode=g)}function h(f,g,E){var S=f.mode;if(S==="disabled"&&(f.mode="hidden"),f.cues&&f.cues.length>0)for(var _=u(f.cues,g,E),m=0;m<_.length;m++)f.removeCue(_[m]);S==="disabled"&&(f.mode=S)}function p(f,g){if(g<f[0].startTime)return 0;var E=f.length-1;if(g>f[E].endTime)return-1;for(var S=0,_=E;S<=_;){var m=Math.floor((_+S)/2);if(g<f[m].startTime)_=m-1;else if(g>f[m].startTime&&S<E)S=m+1;else return m}return f[S].startTime-g<g-f[_].startTime?S:_}function u(f,g,E){var S=[],_=p(f,g);if(_>-1)for(var m=_,c=f.length;m<c;m++){var v=f[m];if(v.startTime>=g&&v.endTime<=E)S.push(v);else if(v.startTime>E)return S}return S}},"./src/utils/time-ranges.ts":function(r,i,t){t.r(i);var n={toString:function(o){for(var l="",h=o.length,p=0;p<h;p++)l+="["+o.start(p).toFixed(3)+","+o.end(p).toFixed(3)+"]";return l}};i.default=n},"./src/utils/timescale-conversion.ts":function(r,i,t){t.r(i),t.d(i,"toTimescaleFromBase",function(){return a}),t.d(i,"toTimescaleFromScale",function(){return o}),t.d(i,"toMsFromMpegTsClock",function(){return l}),t.d(i,"toMpegTsClockFromTimescale",function(){return h});var n=9e4;function a(p,u,f,g){f===void 0&&(f=1),g===void 0&&(g=!1);var E=p*u*f;return g?Math.round(E):E}function o(p,u,f,g){return f===void 0&&(f=1),g===void 0&&(g=!1),a(p,u,1/f,g)}function l(p,u){return u===void 0&&(u=!1),a(p,1e3,1/n,u)}function h(p,u){return u===void 0&&(u=1),a(p,n,1/u)}},"./src/utils/typed-array.ts":function(r,i,t){t.r(i),t.d(i,"sliceUint8",function(){return n});function n(a,o,l){return Uint8Array.prototype.slice?a.slice(o,l):new Uint8Array(Array.prototype.slice.call(a,o,l))}},"./src/utils/vttcue.ts":function(r,i,t){t.r(i),i.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var n=["","lr","rl"],a=["start","middle","end","left","right"];function o(f,g){if(typeof g!="string"||!Array.isArray(f))return!1;var E=g.toLowerCase();return~f.indexOf(E)?E:!1}function l(f){return o(n,f)}function h(f){return o(a,f)}function p(f){for(var g=arguments.length,E=new Array(g>1?g-1:0),S=1;S<g;S++)E[S-1]=arguments[S];for(var _=1;_<arguments.length;_++){var m=arguments[_];for(var c in m)f[c]=m[c]}return f}function u(f,g,E){var S=this,_={enumerable:!0};S.hasBeenReset=!1;var m="",c=!1,v=f,y=g,d=E,x=null,b="",T=!0,A="auto",L="start",R=50,w="middle",O=50,I="middle";Object.defineProperty(S,"id",p({},_,{get:function(){return m},set:function(C){m=""+C}})),Object.defineProperty(S,"pauseOnExit",p({},_,{get:function(){return c},set:function(C){c=!!C}})),Object.defineProperty(S,"startTime",p({},_,{get:function(){return v},set:function(C){if(typeof C!="number")throw new TypeError("Start time must be set to a number.");v=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"endTime",p({},_,{get:function(){return y},set:function(C){if(typeof C!="number")throw new TypeError("End time must be set to a number.");y=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"text",p({},_,{get:function(){return d},set:function(C){d=""+C,this.hasBeenReset=!0}})),Object.defineProperty(S,"region",p({},_,{get:function(){return x},set:function(C){x=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"vertical",p({},_,{get:function(){return b},set:function(C){var P=l(C);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"snapToLines",p({},_,{get:function(){return T},set:function(C){T=!!C,this.hasBeenReset=!0}})),Object.defineProperty(S,"line",p({},_,{get:function(){return A},set:function(C){if(typeof C!="number"&&C!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");A=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"lineAlign",p({},_,{get:function(){return L},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");L=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"position",p({},_,{get:function(){return R},set:function(C){if(C<0||C>100)throw new Error("Position must be between 0 and 100.");R=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"positionAlign",p({},_,{get:function(){return w},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");w=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"size",p({},_,{get:function(){return O},set:function(C){if(C<0||C>100)throw new Error("Size must be between 0 and 100.");O=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"align",p({},_,{get:function(){return I},set:function(C){var P=h(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");I=P,this.hasBeenReset=!0}})),S.displayState=void 0}return u.prototype.getCueAsHTML=function(){var f=self.WebVTT;return f.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(r,i,t){t.r(i),t.d(i,"parseTimeStamp",function(){return o}),t.d(i,"fixLineBreaks",function(){return g}),t.d(i,"VTTParser",function(){return E});var n=t("./src/utils/vttcue.ts"),a=function(){function S(){}var _=S.prototype;return _.decode=function(c,v){if(!c)return"";if(typeof c!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(c))},S}();function o(S){function _(c,v,y,d){return(c|0)*3600+(v|0)*60+(y|0)+parseFloat(d||0)}var m=S.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return m?parseFloat(m[2])>59?_(m[2],m[3],0,m[4]):_(m[1],m[2],m[3],m[4]):null}var l=function(){function S(){this.values=Object.create(null)}var _=S.prototype;return _.set=function(c,v){!this.get(c)&&v!==""&&(this.values[c]=v)},_.get=function(c,v,y){return y?this.has(c)?this.values[c]:v[y]:this.has(c)?this.values[c]:v},_.has=function(c){return c in this.values},_.alt=function(c,v,y){for(var d=0;d<y.length;++d)if(v===y[d]){this.set(c,v);break}},_.integer=function(c,v){/^-?\d+$/.test(v)&&this.set(c,parseInt(v,10))},_.percent=function(c,v){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(v)){var y=parseFloat(v);if(y>=0&&y<=100)return this.set(c,y),!0}return!1},S}();function h(S,_,m,c){var v=c?S.split(c):[S];for(var y in v)if(typeof v[y]=="string"){var d=v[y].split(m);if(d.length===2){var x=d[0],b=d[1];_(x,b)}}}var p=new n.default(0,0,""),u=p.align==="middle"?"middle":"center";function f(S,_,m){var c=S;function v(){var x=o(S);if(x===null)throw new Error("Malformed timestamp: "+c);return S=S.replace(/^[^\sa-zA-Z-]+/,""),x}function y(x,b){var T=new l;h(x,function(R,w){var O;switch(R){case"region":for(var I=m.length-1;I>=0;I--)if(m[I].id===w){T.set(R,m[I].region);break}break;case"vertical":T.alt(R,w,["rl","lr"]);break;case"line":O=w.split(","),T.integer(R,O[0]),T.percent(R,O[0])&&T.set("snapToLines",!1),T.alt(R,O[0],["auto"]),O.length===2&&T.alt("lineAlign",O[1],["start",u,"end"]);break;case"position":O=w.split(","),T.percent(R,O[0]),O.length===2&&T.alt("positionAlign",O[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":T.percent(R,w);break;case"align":T.alt(R,w,["start",u,"end","left","right"]);break}},/:/,/\s/),b.region=T.get("region",null),b.vertical=T.get("vertical","");var A=T.get("line","auto");A==="auto"&&p.line===-1&&(A=-1),b.line=A,b.lineAlign=T.get("lineAlign","start"),b.snapToLines=T.get("snapToLines",!0),b.size=T.get("size",100),b.align=T.get("align",u);var L=T.get("position","auto");L==="auto"&&p.position===50&&(L=b.align==="start"||b.align==="left"?0:b.align==="end"||b.align==="right"?100:50),b.position=L}function d(){S=S.replace(/^\s+/,"")}if(d(),_.startTime=v(),d(),S.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+c);S=S.substr(3),d(),_.endTime=v(),d(),y(S,_)}function g(S){return S.replace(/<br(?: \/)?>/gi,`
`)}var E=function(){function S(){this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var _=S.prototype;return _.parse=function(c){var v=this;c&&(v.buffer+=v.decoder.decode(c,{stream:!0}));function y(){var L=v.buffer,R=0;for(L=g(L);R<L.length&&L[R]!=="\r"&&L[R]!==`
`;)++R;var w=L.substr(0,R);return L[R]==="\r"&&++R,L[R]===`
`&&++R,v.buffer=L.substr(R),w}function d(L){h(L,function(R,w){},/:/)}try{var x="";if(v.state==="INITIAL"){if(!/\r\n|\n/.test(v.buffer))return this;x=y();var b=x.match(/^()?WEBVTT([ \t].*)?$/);if(!b||!b[0])throw new Error("Malformed WebVTT signature.");v.state="HEADER"}for(var T=!1;v.buffer;){if(!/\r\n|\n/.test(v.buffer))return this;switch(T?T=!1:x=y(),v.state){case"HEADER":/:/.test(x)?d(x):x||(v.state="ID");continue;case"NOTE":x||(v.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(x)){v.state="NOTE";break}if(!x)continue;if(v.cue=new n.default(0,0,""),v.state="CUE",x.indexOf("-->")===-1){v.cue.id=x;continue}case"CUE":if(!v.cue){v.state="BADCUE";continue}try{f(x,v.cue,v.regionList)}catch(L){v.cue=null,v.state="BADCUE";continue}v.state="CUETEXT";continue;case"CUETEXT":{var A=x.indexOf("-->")!==-1;if(!x||A&&(T=!0)){v.oncue&&v.cue&&v.oncue(v.cue),v.cue=null,v.state="ID";continue}if(v.cue===null)continue;v.cue.text&&(v.cue.text+=`
`),v.cue.text+=x}continue;case"BADCUE":x||(v.state="ID")}}}catch(L){v.state==="CUETEXT"&&v.cue&&v.oncue&&v.oncue(v.cue),v.cue=null,v.state=v.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},_.flush=function(){var c=this;try{if((c.cue||c.state==="HEADER")&&(c.buffer+=`

`,c.parse()),c.state==="INITIAL"||c.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(v){c.onparsingerror&&c.onparsingerror(v)}return c.onflush&&c.onflush(),this},S}()},"./src/utils/webvtt-parser.ts":function(r,i,t){t.r(i),t.d(i,"generateCueId",function(){return E}),t.d(i,"parseWebVTT",function(){return _});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/demux/id3.ts"),l=t("./src/utils/timescale-conversion.ts"),h=t("./src/remux/mp4-remuxer.ts"),p=/\r\n|\n\r|\n|\r/g,u=function(c,v,y){return y===void 0&&(y=0),c.substr(y,v.length)===v},f=function(c){var v=parseInt(c.substr(-3)),y=parseInt(c.substr(-6,2)),d=parseInt(c.substr(-9,2)),x=c.length>9?parseInt(c.substr(0,c.indexOf(":"))):0;if(!Object(n.isFiniteNumber)(v)||!Object(n.isFiniteNumber)(y)||!Object(n.isFiniteNumber)(d)||!Object(n.isFiniteNumber)(x))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+c);return v+=1e3*y,v+=60*1e3*d,v+=60*60*1e3*x,v},g=function(c){for(var v=5381,y=c.length;y;)v=v*33^c.charCodeAt(--y);return(v>>>0).toString()};function E(m,c,v){return g(m.toString())+g(c.toString())+g(v)}var S=function(c,v,y){var d=c[v],x=c[d.prevCC];if(!x||!x.new&&d.new){c.ccOffset=c.presentationOffset=d.start,d.new=!1;return}for(;(b=x)!==null&&b!==void 0&&b.new;){var b;c.ccOffset+=d.start-x.start,d.new=!1,d=x,x=c[d.prevCC]}c.presentationOffset=y};function _(m,c,v,y,d,x,b,T){var A=new a.VTTParser,L=Object(o.utf8ArrayToStr)(new Uint8Array(m)).trim().replace(p,`
`).split(`
`),R=[],w=Object(l.toMpegTsClockFromTimescale)(c,v),O="00:00.000",I=0,D=0,C,P=!0,M=!1;A.oncue=function(N){var B=y[d],U=y.ccOffset,F=(I-w)/9e4;if(B!=null&&B.new&&(D!==void 0?U=y.ccOffset=B.start:S(y,d,F)),F&&(U=F-y.presentationOffset),M){var j=N.endTime-N.startTime,V=Object(h.normalizePts)((N.startTime+U-D)*9e4,x*9e4)/9e4;N.startTime=V,N.endTime=V+j}var G=N.text.trim();N.text=decodeURIComponent(encodeURIComponent(G)),N.id||(N.id=E(N.startTime,N.endTime,G)),N.endTime>0&&R.push(N)},A.onparsingerror=function(N){C=N},A.onflush=function(){if(C){T(C);return}b(R)},L.forEach(function(N){if(P)if(u(N,"X-TIMESTAMP-MAP=")){P=!1,M=!0,N.substr(16).split(",").forEach(function(B){u(B,"LOCAL:")?O=B.substr(6):u(B,"MPEGTS:")&&(I=parseInt(B.substr(7)))});try{D=f(O)/1e3}catch(B){M=!1,C=B}return}else N===""&&(P=!1);A.parse(N+`
`)}),A.flush()}},"./src/utils/xhr-loader.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=t("./src/loader/load-stats.ts"),o=/^age:\s*[\d.]+\s*$/m,l=function(){function h(u){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=u?u.xhrSetup:null,this.stats=new a.LoadStats,this.retryDelay=0}var p=h.prototype;return p.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},p.abortInternal=function(){var f=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),f&&(f.onreadystatechange=null,f.onprogress=null,f.readyState!==4&&(this.stats.aborted=!0,f.abort()))},p.abort=function(){var f;this.abortInternal(),(f=this.callbacks)!==null&&f!==void 0&&f.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},p.load=function(f,g,E){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=f,this.config=g,this.callbacks=E,this.retryDelay=g.retryDelay,this.loadInternal()},p.loadInternal=function(){var f=this.config,g=this.context;if(!!f){var E=this.loader=new self.XMLHttpRequest,S=this.stats;S.loading.first=0,S.loaded=0;var _=this.xhrSetup;try{if(_)try{_(E,g.url)}catch(v){E.open("GET",g.url,!0),_(E,g.url)}E.readyState||E.open("GET",g.url,!0);var m=this.context.headers;if(m)for(var c in m)E.setRequestHeader(c,m[c])}catch(v){this.callbacks.onError({code:E.status,text:v.message},g,E);return}g.rangeEnd&&E.setRequestHeader("Range","bytes="+g.rangeStart+"-"+(g.rangeEnd-1)),E.onreadystatechange=this.readystatechange.bind(this),E.onprogress=this.loadprogress.bind(this),E.responseType=g.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),f.timeout),E.send()}},p.readystatechange=function(){var f=this.context,g=this.loader,E=this.stats;if(!(!f||!g)){var S=g.readyState,_=this.config;if(!E.aborted&&S>=2)if(self.clearTimeout(this.requestTimeout),E.loading.first===0&&(E.loading.first=Math.max(self.performance.now(),E.loading.start)),S===4){g.onreadystatechange=null,g.onprogress=null;var m=g.status;if(m>=200&&m<300){E.loading.end=Math.max(self.performance.now(),E.loading.first);var c,v;if(f.responseType==="arraybuffer"?(c=g.response,v=c.byteLength):(c=g.responseText,v=c.length),E.loaded=E.total=v,!this.callbacks)return;var y=this.callbacks.onProgress;if(y&&y(E,f,c,g),!this.callbacks)return;var d={url:g.responseURL,data:c};this.callbacks.onSuccess(d,E,f,g)}else E.retry>=_.maxRetry||m>=400&&m<499?(n.logger.error(m+" while loading "+f.url),this.callbacks.onError({code:m,text:g.statusText},f,g)):(n.logger.warn(m+" while loading "+f.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,_.maxRetryDelay),E.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),_.timeout)}},p.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url);var f=this.callbacks;f&&(this.abortInternal(),f.onTimeout(this.stats,this.context,this.loader))},p.loadprogress=function(f){var g=this.stats;g.loaded=f.loaded,f.lengthComputable&&(g.total=f.total)},p.getCacheAge=function(){var f=null;if(this.loader&&o.test(this.loader.getAllResponseHeaders())){var g=this.loader.getResponseHeader("age");f=g?parseFloat(g):null}return f},h}();i.default=l}}).default})})(Dh);var FT=xo(Dh.exports);const Ch=3,BT=["m3u8"],UT=({file:s})=>{const{getSetting:e,lastFiles:r}=Ye.exports.useContext(Vr),i=r.filter(f=>f.type===Ch),{i18n:t}=kn();let n=ui(),a=n();const o=hp(!0),l=s.name.endsWith(".m3u8")?a:s.url,h=tp();let p;const u=hu({base:"30px",md:"50px"});return Ye.exports.useEffect(()=>{let f={container:"#video-player",title:s.name,url:l,autoplay:e("autoplay video")==="true",autoMini:!0,autoSize:!1,playbackRate:!0,flip:!0,rotate:!0,aspectRatio:!0,fullscreen:!0,fullscreenWeb:!0,mutex:!0,light:!0,backdrop:!0,subtitleOffset:!0,miniProgressBar:!0,localVideo:!0,localSubtitle:!0,lang:t.language==="zh"?"zh-cn":"en",setting:!0,pip:!0,customType:{flv:function(m,c){const v=kT.createPlayer({type:"flv",url:c},{referrerPolicy:"no-referrer"});v.attachMediaElement(m),v.load()},m3u8:function(m,c){var v=new FT;v.loadSource(c),v.attachMedia(m)}},moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0}};s.name.toLowerCase().endsWith(".flv")&&(f.type="flv"),e("artplayer whitelist")?f.whitelist=e("artplayer whitelist").split(","):f.whitelist=[],!NT||f.whitelist.some(m=>m==="*"||La.indexOf(m)>-1)||(f.moreVideoAttr.controls=!0),e("artplayer autoSize")==="true"&&(f.autoSize=!0);const E=s.name.substring(0,s.name.lastIndexOf("."));let S="";const _=r.find(m=>{const c=m.name;if(!c.startsWith(E))return!1;for(const v of[".srt",".ass",".vtt"])if(c.endsWith(v))return!0;return!1});return _&&(o+""+_.name,f.subtitle={type:S,url:n(_),bilingual:!0,style:{color:"#03A9F4","font-size":u}}),p=new MT(f),p.on("video:ended",()=>{const m=i.findIndex(c=>c.name===s.name);m<i.length-1&&h.push(encodeURI(i[m+1].name))}),()=>{p&&p.destroy&&p.destroy()}},[]),q.createElement(Xi,{w:"full",className:"video-preview-box"},q.createElement(rp,null,q.createElement(ip,{rightIcon:q.createElement(Nn,{boxSize:6,as:cp}),w:"full",colorScheme:"gray",as:Er,mb:2},q.createElement(np,{w:"full",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},s.name)),q.createElement(ap,{w:"full",maxH:"65vh",overflowY:"auto",zIndex:999},i.map(f=>q.createElement(sp,{key:f.name,w:"full"},q.createElement(_o,{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxW:"85vw",w:"full",as:op,_hover:{textDecoration:"none"},to:encodeURI(f.name)},f.name))))),q.createElement(Xi,{w:"full",h:"60vh",id:"video-player"}),q.createElement(lp,{mt:"2",spacing:"2",justify:"center"},q.createElement(Er,{colorScheme:"purple",as:Qi.a,href:`iina://weblink?url=${a}`},"IINA"),q.createElement(Er,{colorScheme:"yellow",as:Qi.a,href:`potplayer://${a}`},"PotPlayer"),q.createElement(Er,{colorScheme:"orange",as:Qi.a,href:`vlc://${a}`},"VLC"),q.createElement(Er,{colorScheme:"teal",as:Qi.a,href:`nplayer-${a}`},"nPlayer"),q.createElement(Er,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.ad;S.title=${s.name};end`},"MXPlayer"),q.createElement(Er,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.pro;S.title=${s.name};end`},"MXPlayer Pro")))};var jT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",type:Ch,exts:BT,default:UT});const Ph={"../preview/audio.tsx":H0,"../preview/codeeditor.tsx":pp,"../preview/epub.tsx":hT,"../preview/image.tsx":mT,"../preview/ipa.tsx":bT,"../preview/markdown.tsx":vp,"../preview/office.tsx":IT,"../preview/pdf.tsx":AT,"../preview/plist.tsx":PT,"../preview/video.tsx":jT},WT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(Vr),r=s.name.split(".").pop()||"",i=ui(),{t}=kn();return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(Eo,{spacing:"8"},q.createElement(Nn,{color:e("icon color")||"#1890ff",boxSize:20,as:Ca(s.type,r)}),q.createElement(Da,{size:"md"},s.name),q.createElement(Er,{onClick:()=>{window.open(i(),"_blank")}},t("Download"))))},QT=()=>{const{files:s}=Ye.exports.useContext(Vr);gp(s[0].name);for(const e in Ph){const r=Ph[e],i=r.default;if(r.type===s[0].type||r.exts.includes(s[0].name.split(".").pop()))return q.createElement(i,{file:s[0]})}return q.createElement(WT,{file:s[0]})};export{QT as default};
